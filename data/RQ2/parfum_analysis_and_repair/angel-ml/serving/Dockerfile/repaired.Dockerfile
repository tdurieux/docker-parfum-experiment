########################################################################################################################
#                                                       JAVA DEV                                                        #
########################################################################################################################
FROM maven:3.6.1-jdk-8 as JAVA_DEV

########################################################################################################################
#                                                       JAVA BUILDER                                                       #
########################################################################################################################
FROM JAVA_DEV as JAVA_BUILDER

WORKDIR /app

COPY ./pom.xml /app/
COPY ./common/pom.xml /app/common/
COPY ./server/pom.xml /app/server/
COPY ./client/pom.xml /app/client/
COPY ./dist/pom.xml /app/dist/

RUN mvn -e -B dependency:resolve dependency:resolve-plugins

COPY . /app/

RUN mvn -e -B -Dmaven.test.skip=true package

########################################################################################################################
#                                                       Runtime                                                        #
########################################################################################################################