{
  "startTime": 1674256111047,
  "endTime": 1674256112032,
  "originalSmells": [
    {
      "rule": "tarSomethingRmTheSomething",
      "position": {
        "lineStart": 87,
        "lineEnd": 87,
        "columnStart": 4,
        "columnEnd": 38
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "FROM python:3.8-slim-buster\n\nENV PYTHONUNBUFFERED 1\nENV PIP_DISABLE_PIP_VERSION_CHECK=1\nENV PIP_NO_CACHE_DIR=1\n\nARG BUILD_DATE=now\nARG VCS_REF\nARG VERSION\n\nENV SERVER_VERSION=${VERSION}\nENV CLIENT_VERSION=8.5.1\nENV WEBUI_VERSION=8.7.0\n\nENV NGINX_WORKER_PROCESSES=1\nENV NGINX_WORKER_CONNECTIONS=1024\n\nENV UWSGI_PROCESSES=5\nENV UWSGI_LISTEN=100\nENV UWSGI_BUFFER_SIZE=8192\n\nENV HEARTBEAT_SEVERITY=major\nENV HK_EXPIRED_DELETE_HRS=2\nENV HK_INFO_DELETE_HRS=12\n\nLABEL maintainer=\"Nick Satterly <nick.satterly@gmail.com>\"\nLABEL org.label-schema.build-date=$BUILD_DATE \\\n      org.label-schema.url=\"https://alerta.io\" \\\n      org.label-schema.vcs-url=\"https://github.com/alerta/docker-alerta\" \\\n      org.label-schema.vcs-ref=$VCS_REF \\\n      org.label-schema.version=$VERSION \\\n      org.label-schema.schema-version=\"1.0.0-rc.1\"\n\nSHELL [\"/bin/bash\", \"-o\", \"pipefail\", \"-c\"]\n\nRUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get install -y --no-install-recommends \\\n    build-essential \\\n    curl \\\n    git \\\n    gnupg2 \\\n    libldap2-dev \\\n    libpq-dev \\\n    libsasl2-dev \\\n    postgresql-client \\\n    python3-dev \\\n    supervisor \\\n    xmlsec1 && \\\n    apt-get -y clean && \\\n    apt-get -y autoremove && \\\n    rm -rf /var/lib/apt/lists/*\n\nRUN curl -fsSL https://nginx.org/keys/nginx_signing.key | apt-key add - && \\\n    echo \"deb https://nginx.org/packages/debian/ buster nginx\" | tee /etc/apt/sources.list.d/nginx.list && \\\n    apt-get update && \\\n    apt-get install -y --no-install-recommends \\\n    nginx && \\\n    apt-get -y clean && \\\n    apt-get -y autoremove && \\\n    rm -rf /var/lib/apt/lists/*\n\n# hadolint ignore=DL3008\nRUN curl -fsSL https://www.mongodb.org/static/pgp/server-4.2.asc | apt-key add - && \\\n    echo \"deb https://repo.mongodb.org/apt/debian buster/mongodb-org/4.2 main\" | tee /etc/apt/sources.list.d/mongodb-org-4.2.list && \\\n    apt-get update && \\\n    apt-get install -y --no-install-recommends \\\n    mongodb-org-shell && \\\n    apt-get -y clean && \\\n    apt-get -y autoremove && \\\n    rm -rf /var/lib/apt/lists/*\n\nCOPY requirements*.txt /app/\n# hadolint ignore=DL3013\nRUN pip install --no-cache-dir pip virtualenv jinja2 && \\\n    python3 -m venv /venv && \\\n    /venv/bin/pip install --no-cache-dir --upgrade setuptools && \\\n    /venv/bin/pip install --no-cache-dir --requirement /app/requirements.txt && \\\n    /venv/bin/pip install --no-cache-dir --requirement /app/requirements-docker.txt\nENV PATH $PATH:/venv/bin\n\nRUN /venv/bin/pip install alerta==${CLIENT_VERSION} alerta-server==${SERVER_VERSION}\nCOPY install-plugins.sh /app/install-plugins.sh\nCOPY plugins.txt /app/plugins.txt\nRUN /app/install-plugins.sh\n\nADD https://github.com/alerta/alerta-webui/releases/download/v${WEBUI_VERSION}/alerta-webui.tar.gz /tmp/webui.tar.gz\nRUN tar zxvf /tmp/webui.tar.gz -C /tmp && \\\n    mv /tmp/dist /web && rm /tmp/webui.tar.gz\n\nENV ALERTA_SVR_CONF_FILE /app/alertad.conf\nENV ALERTA_CONF_FILE /app/alerta.conf\nENV ALERTA_WEB_CONF_FILE /web/config.json\n\nCOPY config/templates/app/ /app\nCOPY config/templates/web/ /web\n\nRUN ln -sf /dev/stdout /var/log/nginx/access.log \\\n    && ln -sf /dev/stderr /var/log/nginx/error.log\n\nRUN chgrp -R 0 /app /venv /web && \\\n    chmod -R g=u /app /venv /web && \\\n    useradd -u 1001 -g 0 -d /app alerta\n\nUSER 1001\n\nCOPY docker-entrypoint.sh /usr/local/bin/\n\nENTRYPOINT [\"docker-entrypoint.sh\"]\n\nEXPOSE 8080 1717\nCMD [\"supervisord\", \"-c\", \"/app/supervisord.conf\"]\n"
}