{
  "startTime": 1674215414723,
  "endTime": 1674215415798,
  "originalSmells": [
    {
      "rule": "configureShouldUseBuildFlag",
      "position": {
        "lineStart": 31,
        "lineEnd": 31,
        "columnStart": 4,
        "columnEnd": 15
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 3,
        "lineEnd": 6,
        "columnStart": 4,
        "columnEnd": 16
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 3,
        "lineEnd": 6,
        "columnStart": 4,
        "columnEnd": 16
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "FROM ubuntu:bionic\n\nRUN apt-get update && \\\n    apt-get install --no-install-recommends -y \\\n      sudo tmux screen emacs git gdb net-tools psmisc \\\n      build-essential autoconf automake libtool g++ \\\n      libssl-dev && rm -rf /var/lib/apt/lists/*;\n\nARG UID=1000\n\n# Create a non-root user account to run Libssh2.\nRUN adduser victim --disabled-password --uid $UID\n\n# Grant the 'victim' user sudo access. This is not used for the\n# demo, but it is often handy for installing extra packages.\nRUN adduser victim sudo\nRUN echo \"victim:x\" | chpasswd\nCOPY home/ /home/victim/\nRUN chown -R victim:victim /home/victim\n\n# Switch over to the 'victim' user, since root access is no longer required\nUSER victim\nWORKDIR /home/victim\n\n# Checkout and build libssh2-1.8.2 (commit 02ecf17a6d5f9837699e8fb3aad0c804caa67eeb).\n# Note: this PoC also works on commit 38bf7ce9ece3441dcf3a19f0befb5b491ed4adfa,\n# which is the commit which contained the bad implementation of _libssh2_check_length.\nRUN git clone https://github.com/libssh2/libssh2.git && \\\n    cd libssh2 && \\\n    git checkout 02ecf17a6d5f9837699e8fb3aad0c804caa67eeb && \\\n    ./buildconf && \\\n    ./configure --build=\"$(dpkg-architecture --query DEB_BUILD_GNU_TYPE)\" && \\\n    make -j4\n"
}