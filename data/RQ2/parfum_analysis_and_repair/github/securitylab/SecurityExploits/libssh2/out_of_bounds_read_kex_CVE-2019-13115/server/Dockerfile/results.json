{
  "startTime": 1674248018144,
  "endTime": 1674248019722,
  "originalSmells": [
    {
      "rule": "configureShouldUseBuildFlag",
      "position": {
        "lineStart": 37,
        "lineEnd": 37,
        "columnStart": 4,
        "columnEnd": 15
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 3,
        "lineEnd": 6,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 3,
        "lineEnd": 6,
        "columnStart": 4,
        "columnEnd": 27
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "FROM ubuntu:bionic\n\nRUN apt-get update && \\\n    apt-get install --no-install-recommends -y \\\n      sudo tmux screen emacs git gdb net-tools psmisc \\\n      build-essential autoconf g++ \\\n      libssl-dev zlib1g-dev && rm -rf /var/lib/apt/lists/*;\n\nARG UID=1000\n\n# Create a non-root user account to build openssh-server.\nRUN adduser hal --disabled-password --uid $UID\n\n# Grant the 'hal' user sudo access. This is not used for the demo,\n# but it is often handy for installing extra packages.\nRUN adduser hal sudo\nRUN echo \"hal:x\" | chpasswd\nCOPY home/ /home/hal/\nRUN chown -R hal:hal /home/hal\n\n# Create the sshd user\nRUN mkdir /var/empty && \\\n    chown root:sys /var/empty && \\\n    chmod 755 /var/empty && \\\n    groupadd sshd && \\\n    useradd -g sshd -c 'sshd privsep' -d /var/empty -s /bin/false sshd\n\n# Switch over to the 'hal' user, since root access is no longer required\nUSER hal\nWORKDIR /home/hal\n\n# Clone openssh, insert some malicious code, and built it.\nRUN git clone https://github.com/openssh/openssh-portable.git && \\\n    cd openssh-portable && \\\n    git checkout 21da87f439b48a85b951ef1518fe85ac0273e719 && \\\n    git apply /home/hal/diff.txt && \\\n    autoreconf && \\\n    ./configure --build=\"$(dpkg-architecture --query DEB_BUILD_GNU_TYPE)\" && \\\n    make\n\n# Install openssh.\nUSER root\nRUN cd /home/hal/openssh-portable && make install\nUSER hal\n"
}