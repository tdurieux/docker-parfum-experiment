{
  "startTime": 1674246734033,
  "endTime": 1674246735290,
  "originalSmells": [
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 20,
        "lineEnd": 20,
        "columnStart": 4,
        "columnEnd": 69
      }
    },
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 64,
        "lineEnd": 64,
        "columnStart": 4,
        "columnEnd": 30
      }
    },
    {
      "rule": "configureShouldUseBuildFlag",
      "position": {
        "lineStart": 53,
        "lineEnd": 53,
        "columnStart": 37,
        "columnEnd": 48
      }
    },
    {
      "rule": "gpgUseBatchFlag",
      "position": {
        "lineStart": 63,
        "lineEnd": 63,
        "columnStart": 4,
        "columnEnd": 219
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 7,
        "lineEnd": 7,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 8,
        "lineEnd": 8,
        "columnStart": 4,
        "columnEnd": 26
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 9,
        "lineEnd": 9,
        "columnStart": 4,
        "columnEnd": 35
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 10,
        "lineEnd": 10,
        "columnStart": 4,
        "columnEnd": 31
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 11,
        "lineEnd": 11,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 12,
        "lineEnd": 12,
        "columnStart": 4,
        "columnEnd": 29
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 15,
        "lineEnd": 15,
        "columnStart": 4,
        "columnEnd": 26
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 18,
        "lineEnd": 18,
        "columnStart": 4,
        "columnEnd": 36
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 23,
        "lineEnd": 23,
        "columnStart": 22,
        "columnEnd": 46
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 37,
        "lineEnd": 37,
        "columnStart": 4,
        "columnEnd": 38
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 47,
        "lineEnd": 47,
        "columnStart": 4,
        "columnEnd": 84
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 58,
        "lineEnd": 58,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 7,
        "lineEnd": 7,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 8,
        "lineEnd": 8,
        "columnStart": 4,
        "columnEnd": 26
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 9,
        "lineEnd": 9,
        "columnStart": 4,
        "columnEnd": 35
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 10,
        "lineEnd": 10,
        "columnStart": 4,
        "columnEnd": 31
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 11,
        "lineEnd": 11,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 12,
        "lineEnd": 12,
        "columnStart": 4,
        "columnEnd": 29
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 15,
        "lineEnd": 15,
        "columnStart": 4,
        "columnEnd": 26
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 18,
        "lineEnd": 18,
        "columnStart": 4,
        "columnEnd": 36
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 37,
        "lineEnd": 37,
        "columnStart": 4,
        "columnEnd": 38
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 47,
        "lineEnd": 47,
        "columnStart": 4,
        "columnEnd": 84
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 58,
        "lineEnd": 58,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 7,
        "lineEnd": 7,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 8,
        "lineEnd": 8,
        "columnStart": 4,
        "columnEnd": 26
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 9,
        "lineEnd": 9,
        "columnStart": 4,
        "columnEnd": 35
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 10,
        "lineEnd": 10,
        "columnStart": 4,
        "columnEnd": 31
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 11,
        "lineEnd": 11,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 12,
        "lineEnd": 12,
        "columnStart": 4,
        "columnEnd": 29
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 15,
        "lineEnd": 15,
        "columnStart": 4,
        "columnEnd": 26
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 18,
        "lineEnd": 18,
        "columnStart": 4,
        "columnEnd": 36
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 23,
        "lineEnd": 23,
        "columnStart": 22,
        "columnEnd": 46
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 37,
        "lineEnd": 37,
        "columnStart": 4,
        "columnEnd": 38
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 47,
        "lineEnd": 47,
        "columnStart": 4,
        "columnEnd": 84
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 58,
        "lineEnd": 58,
        "columnStart": 4,
        "columnEnd": 27
      }
    }
  ],
  "repairedSmells": [
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 7,
        "lineEnd": 7,
        "columnStart": 4,
        "columnEnd": 51
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 8,
        "lineEnd": 8,
        "columnStart": 4,
        "columnEnd": 50
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 9,
        "lineEnd": 9,
        "columnStart": 4,
        "columnEnd": 59
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 10,
        "lineEnd": 10,
        "columnStart": 4,
        "columnEnd": 55
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 11,
        "lineEnd": 11,
        "columnStart": 4,
        "columnEnd": 51
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 12,
        "lineEnd": 12,
        "columnStart": 4,
        "columnEnd": 53
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 15,
        "lineEnd": 15,
        "columnStart": 4,
        "columnEnd": 50
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 18,
        "lineEnd": 18,
        "columnStart": 4,
        "columnEnd": 60
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 37,
        "lineEnd": 37,
        "columnStart": 4,
        "columnEnd": 62
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 47,
        "lineEnd": 47,
        "columnStart": 4,
        "columnEnd": 108
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 58,
        "lineEnd": 58,
        "columnStart": 4,
        "columnEnd": 51
      }
    }
  ],
  "repairedDockerfile": "FROM ubuntu:16.04\nMAINTAINER nethsix <nethsix@gmail.com>\n\n# Update apt\nRUN apt-get update\n\n# Basic utilities\nRUN apt-get install --no-install-recommends -y curl && rm -rf /var/lib/apt/lists/*;\nRUN apt-get install --no-install-recommends -y vim && rm -rf /var/lib/apt/lists/*;\nRUN apt-get install --no-install-recommends -y iputils-ping && rm -rf /var/lib/apt/lists/*;\nRUN apt-get install --no-install-recommends -y dnsutils && rm -rf /var/lib/apt/lists/*;\nRUN apt-get install --no-install-recommends -y gawk && rm -rf /var/lib/apt/lists/*;\nRUN apt-get install --no-install-recommends -y gnupg2 && rm -rf /var/lib/apt/lists/*;\n\n# Required to get tensorflow, ruby-tensorflow, etc.\nRUN apt-get install --no-install-recommends -y git && rm -rf /var/lib/apt/lists/*;\n\n# Required for bazel\nRUN apt-get install --no-install-recommends -y openjdk-8-jdk && rm -rf /var/lib/apt/lists/*;\nRUN echo \"deb http://storage.googleapis.com/bazel-apt stable jdk1.8\" | tee /etc/apt/sources.list.d/bazel.list\nRUN curl -f https://storage.googleapis.com/bazel-apt/doc/apt-key.pub.gpg | apt-key add -\n\n# Install bazel\nRUN apt-get update && apt-get install --no-install-recommends -y bazel && rm -rf /var/lib/apt/lists/*;\nRUN apt-get upgrade -y bazel\n\n# Install tensorflow\nRUN /bin/mkdir /repos\nRUN cd /repos && git clone --recurse-submodules https://github.com/tensorflow/tensorflow\nRUN cd /repos/tensorflow && git checkout r1.3\n\n# We need gcc-4.8 otherwise we get segmentation fault\n# Error:\n# ./tensorflow/core/framework/tensor.h:574:6: internal compiler error: Segmentation fault\n#  void Tensor::FillDimsAndValidateCompatibleShape(\n#      ^\n# gcc: internal compiler error: Segmentation fault (program cc1plus)\nRUN apt-get install --no-install-recommends -y gcc-4.8 g++-4.8 && rm -rf /var/lib/apt/lists/*;\n# Set priority to use gcc-4.8\nRUN update-alternatives --install /usr/bin/gcc gcc /usr/bin/gcc-5 60 --slave /usr/bin/g++ g++ /usr/bin/g++-5\nRUN update-alternatives --install /usr/bin/gcc gcc /usr/bin/gcc-4.8 50 --slave /usr/bin/g++ g++ /usr/bin/g++-4.8\n\n# Required for tensorflow bazel build\n# NOTE: We cannot use python3 because later the ./configure script will\n#       it will use /usr/bin/python3 but some bazel stuff still\n#       calls /usr/bin/python, which does not link to anything\n# RUN apt-get install -y --fix-missing python3-numpy python3-dev python3-pip python3-wheel\nRUN apt-get install --no-install-recommends -y --fix-missing python-numpy python-dev python-pip python-wheel && rm -rf /var/lib/apt/lists/*;\n\n# For info about why '--jobs'\n# * https://github.com/tensorflow/tensorflow/issues/349\n# For why we use '--batch'\n# * https://github.com/bazelbuild/bazel/issues/418\nRUN cd /repos/tensorflow && yes \"\" | ./configure --build=\"$(dpkg-architecture --query DEB_BUILD_GNU_TYPE)\"\nRUN cd /repos/tensorflow && bazel --batch build -c opt --jobs=10 --spawn_strategy=standalone --genrule_strategy=standalone //tensorflow:libtensorflow.so\nRUN cp /repos/tensorflow/bazel-bin/tensorflow/libtensorflow.so /usr/lib/\n\n# Required by ruby-tensorflow\nRUN apt-get install --no-install-recommends -y swig && rm -rf /var/lib/apt/lists/*;\n\n# Ruby stuff\n# NOTE: keys.gnupg.net is a redirection thus using DNS to resolve\n#       that within Docker failse\nRUN gpg --batch --keyserver hkp://$(dig +short keys.gnupg.net | awk 'BEGIN { regex=\"^[0-9.]+$\"; ip=\"\" } { if (match($0, regex) && (ip == \"\")) { ip = $1 } } END { print ip }') --recv-keys 409B6B1796C275462A1703113804BB82D39DC0E3\nRUN curl -f -L https://get.rvm.io | bash -s stable\nRUN /bin/bash -l -c \"rvm requirements\"\nRUN /bin/bash -l -c \"rvm install 2.2.4\"\n# NOTE: Cannot find a good way to coordinate rvm and gem\n#       thus the belog gem install will end up installing bundler\n#       in systems\n# RUN /bin/bash -l -c \"rvm gemset use ruby-2.2.4@global && gem install bundler --no-rdoc --no-ri\"\n# Set ruby/gemset to be 2.2.4@global at '/' instead\nRUN cd / && /bin/bash -l -c \"rvm --ruby-version use 2.2.4@global\"\nRUN cd / && /bin/bash -l -c \"gem install bundler --no-rdoc --no-ri\"\n\nRUN echo 'source /etc/profile.d/rvm.sh' >> ~/.bashrc\n\nRUN /bin/bash -l -c \"gem install bundle --no-rdoc --no-ri\"\nRUN /bin/bash -l -c \"rvm gemset create ruby-tensorflow\"\n\n# Install ruby-tensorflow\nRUN cd /repos && git clone https://github.com/somaticio/tensorflow.rb\nRUN cd /repos/tensorflow.rb && /bin/bash -l -c \"rvm --ruby-version use 2.2.4@ruby-tensorflow\"\n\nRUN cd /repos/tensorflow.rb && /bin/bash -l -c \"bundle install\"\n\nRUN cd /repos/tensorflow.rb/ext/sciruby/tensorflow_c && /bin/bash -l -c \"ruby extconf.rb && make && make install\"\nRUN cd /repos/tensorflow.rb && /bin/bash -l -c \"bundle exec rake install\"\n"
}