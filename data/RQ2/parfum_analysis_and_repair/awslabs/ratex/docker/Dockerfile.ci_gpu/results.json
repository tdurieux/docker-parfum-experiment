{
  "startTime": 1674219834417,
  "endTime": 1674219835694,
  "originalSmells": [
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 11,
        "lineEnd": 11,
        "columnStart": 4,
        "columnEnd": 32
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 23,
        "lineEnd": 23,
        "columnStart": 4,
        "columnEnd": 60
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 11,
        "lineEnd": 11,
        "columnStart": 4,
        "columnEnd": 32
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 23,
        "lineEnd": 23,
        "columnStart": 4,
        "columnEnd": 60
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 11,
        "lineEnd": 11,
        "columnStart": 4,
        "columnEnd": 32
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 23,
        "lineEnd": 23,
        "columnStart": 4,
        "columnEnd": 60
      }
    }
  ],
  "repairedSmells": [
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 11,
        "lineEnd": 11,
        "columnStart": 4,
        "columnEnd": 56
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 23,
        "lineEnd": 23,
        "columnStart": 4,
        "columnEnd": 84
      }
    }
  ],
  "repairedDockerfile": "# Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n# SPDX-License-Identifier: Apache-2.0\nFROM nvidia/cuda:11.3.1-cudnn8-devel-ubuntu18.04\nARG PYTORCH_VERSION=nightly\n\n# Install basic dependencies.\nRUN apt-get update --fix-missing\nCOPY install/ubuntu_install_core.sh /install/ubuntu_install_core.sh\nRUN bash /install/ubuntu_install_core.sh\n\n# Install docker\nRUN apt-get install --no-install-recommends -y docker.io && rm -rf /var/lib/apt/lists/*;\n\n# Install Python packages.\nCOPY install/ubuntu_install_python.sh /install/ubuntu_install_python.sh\nRUN bash /install/ubuntu_install_python.sh\n\n# Install LLVM.\nCOPY install/ubuntu_install_llvm.sh /install/ubuntu_install_llvm.sh\nRUN bash /install/ubuntu_install_llvm.sh\n\n# AWS Batch setup\nCOPY batch/entry.sh /batch/entry.sh\nRUN DEBIAN_FRONTEND=noninteractive apt-get --no-install-recommends install -y awscli && rm -rf /var/lib/apt/lists/*;\nRUN python3 -m pip install --upgrade awscli\n\n# Environment variables\nENV PATH=/usr/local/cuda/bin:${PATH}\nENV C_INCLUDE_PATH=/usr/local/cuda/include:${C_INCLUDE_PATH}\nENV CPLUS_INCLUDE_PATH=/usr/local/cuda/include:${CPLUS_INCLUDE_PATH}\nENV LIBRARY_PATH=/usr/local/cuda/lib64:${LIBRARY_PATH}\nENV LD_LIBRARY_PATH=/usr/local/cuda/lib64:${LD_LIBRARY_PATH}\n\n# Install PyTorch with CUDA\nCOPY install/ubuntu_install_torch.sh /install/ubuntu_install_torch.sh\nRUN bash /install/ubuntu_install_torch.sh cu113 $PYTORCH_VERSION\nENV PYTORCH_SOURCE_PATH=/pytorch\n\n# Install apex\nCOPY install/ubuntu_install_apex.sh /install/ubuntu_install_apex.sh\nRUN bash /install/ubuntu_install_apex.sh\n\n# To prevent `black` command line errors caused by ASCII encoding\nENV LC_ALL=C.UTF-8\nENV LANG=C.UTF-8\n"
}