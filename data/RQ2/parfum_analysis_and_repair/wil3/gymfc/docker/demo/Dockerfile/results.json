{
  "startTime": 1674254867804,
  "endTime": 1674254868869,
  "originalSmells": [
    {
      "rule": "wgetUseHttpsUrl",
      "position": {
        "lineStart": 35,
        "lineEnd": 35,
        "columnStart": 7,
        "columnEnd": 61
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 7,
        "lineEnd": 7,
        "columnStart": 7,
        "columnEnd": 33
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 84,
        "lineEnd": 84,
        "columnStart": 4,
        "columnEnd": 23
      }
    },
    {
      "rule": "configureShouldUseBuildFlag",
      "position": {
        "lineStart": 22,
        "lineEnd": 22,
        "columnStart": 7,
        "columnEnd": 158
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 4,
        "lineEnd": 4,
        "columnStart": 7,
        "columnEnd": 60
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 8,
        "lineEnd": 8,
        "columnStart": 7,
        "columnEnd": 103
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 9,
        "lineEnd": 9,
        "columnStart": 7,
        "columnEnd": 77
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 17,
        "lineEnd": 17,
        "columnStart": 7,
        "columnEnd": 30
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 32,
        "lineEnd": 32,
        "columnStart": 4,
        "columnEnd": 68
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 44,
        "lineEnd": 44,
        "columnStart": 4,
        "columnEnd": 38
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 55,
        "lineEnd": 55,
        "columnStart": 4,
        "columnEnd": 49
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 66,
        "lineEnd": 66,
        "columnStart": 4,
        "columnEnd": 60
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 69,
        "lineEnd": 69,
        "columnStart": 7,
        "columnEnd": 62
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 17,
        "lineEnd": 17,
        "columnStart": 7,
        "columnEnd": 30
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 32,
        "lineEnd": 32,
        "columnStart": 4,
        "columnEnd": 68
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 44,
        "lineEnd": 44,
        "columnStart": 4,
        "columnEnd": 38
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 55,
        "lineEnd": 55,
        "columnStart": 4,
        "columnEnd": 49
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 66,
        "lineEnd": 66,
        "columnStart": 4,
        "columnEnd": 60
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 69,
        "lineEnd": 69,
        "columnStart": 7,
        "columnEnd": 62
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 4,
        "lineEnd": 4,
        "columnStart": 7,
        "columnEnd": 60
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 8,
        "lineEnd": 8,
        "columnStart": 7,
        "columnEnd": 103
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 9,
        "lineEnd": 9,
        "columnStart": 7,
        "columnEnd": 77
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 17,
        "lineEnd": 17,
        "columnStart": 7,
        "columnEnd": 30
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 32,
        "lineEnd": 32,
        "columnStart": 4,
        "columnEnd": 68
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 44,
        "lineEnd": 44,
        "columnStart": 4,
        "columnEnd": 38
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 55,
        "lineEnd": 55,
        "columnStart": 4,
        "columnEnd": 49
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 66,
        "lineEnd": 66,
        "columnStart": 4,
        "columnEnd": 60
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 69,
        "lineEnd": 69,
        "columnStart": 7,
        "columnEnd": 62
      }
    }
  ],
  "repairedSmells": [
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 17,
        "lineEnd": 17,
        "columnStart": 7,
        "columnEnd": 54
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 32,
        "lineEnd": 32,
        "columnStart": 4,
        "columnEnd": 92
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 44,
        "lineEnd": 44,
        "columnStart": 4,
        "columnEnd": 62
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 55,
        "lineEnd": 55,
        "columnStart": 4,
        "columnEnd": 73
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 66,
        "lineEnd": 66,
        "columnStart": 4,
        "columnEnd": 84
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 69,
        "lineEnd": 69,
        "columnStart": 7,
        "columnEnd": 86
      }
    }
  ],
  "repairedDockerfile": "FROM ubuntu:bionic\n\n# install python and dependencies for mesa\nRUN apt-get update \\\n    && apt-get install --no-install-recommends -y python3-pip python-pip python3-dev \\\n    && cd /usr/local/bin \\\n    && ln -s /usr/bin/python3 python \\\n    && pip3 install --no-cache-dir --upgrade pip \\\n    && apt-get install --no-install-recommends -y xvfb llvm-5.0-runtime x11-utils llvm-dev libxcb-dri2-0-dev libxcb-xfixes0-dev \\\n    && apt-get install --no-install-recommends -y libx11-xcb-dev zlib1g-dev xorg-dev xserver-xorg-dev && rm -rf /var/lib/apt/lists/*;\n\n# compile mesa to be able to use DRI with docker\n# enable graphic rendering in a docker container and allow it to forward it to a XHost outside the container.\n# The pre-installed mesa drives do not support DRI but Gazebo needs them. Hence we need to install new drivers.\n# This takes a while, make that the ADD/COPY commands come later so this layer can be cached by docker build.\nRUN mkdir -p /var/tmp/build \\\n    && cd /var/tmp/build \\\n    && apt-get install --no-install-recommends -y wget \\\n    && wget \"https://mesa.freedesktop.org/archive/mesa-18.0.1.tar.gz\" \\\n    && tar xfv mesa-18.0.1.tar.gz \\\n    && rm mesa-18.0.1.tar.gz \\\n    && cd mesa-18.0.1 \\\n    && ./configure --build=\"$(dpkg-architecture --query DEB_BUILD_GNU_TYPE)\" --enable-glx=gallium-xlib --with-gallium-drivers=swrast,swr --disable-dri --disable-gbm --disable-egl --enable-gallium-osmesa --prefix=/usr \\\n    && make -j4 \\\n    && make install \\\n    && cd .. \\\n    && rm -rf mesa-18.0.1 && rm -rf /var/lib/apt/lists/*;\n\nENV USER=gymfc\nRUN useradd -ms /bin/bash $USER && mkdir /home/$USER/local\n\n# prepare Gazebo and Dart build\nRUN apt-get install --no-install-recommends -y lsb-release gnupg2 software-properties-common \\\n    && apt-get remove '.*gazebo.*' '.*sdformat.*' '.*ignition-math.*' '.*ignition-msgs.*' '.*ignition-transport.*' \\\n    && sh -c 'echo \"deb http://packages.osrfoundation.org/gazebo/ubuntu-stable `lsb_release -cs` main\" > /etc/apt/sources.list.d/gazebo-stable.list' \\\n    && wget https://packages.osrfoundation.org/gazebo.key -O - | apt-key add - && apt-get update \\\n    && wget https://bitbucket.org/osrf/release-tools/raw/default/jenkins-scripts/lib/dependencies_archive.sh -O /tmp/dependencies.sh \\\n    && apt-get update && rm -rf /var/lib/apt/lists/*;\n\n# install Gazebo dependencies\nRUN /bin/bash -c \"GAZEBO_MAJOR_VERSION=10 ROS_DISTRO=dummy source /tmp/dependencies.sh && echo \\${BASE_DEPENDENCIES} \\${GAZEBO_BASE_DEPENDENCIES} \\${DART_DEPENDENCIES} | tr -d '\\\\' | xargs apt-get -y install\"\n\n# Build Dart\nARG DART_VERSION=v6.7.0\nRUN apt-get install --no-install-recommends -y ssh gdb vim git \\\n    && git clone \"https://github.com/dartsim/dart.git\" /tmp/dart \\\n    && cd /tmp/dart && git checkout $DART_VERSION \\\n    && mkdir build && cd build \\\n    && cmake .. \\\n    && make -j4 \\\n    && make install \\\n    && rm -rf /tmp/dart && rm -rf /var/lib/apt/lists/*;\n\nARG GAZEBO_VERSION=gazebo10_10.1.0\n# Build Gazebo\nRUN apt-get install --no-install-recommends -y mercurial libboost-all-dev \\\n    && hg clone https://bitbucket.org/osrf/gazebo /tmp/gazebo \\\n    && cd /tmp/gazebo \\\n    && hg up $GAZEBO_VERSION \\\n    && mkdir build && cd build \\\n    && cmake -DCMAKE_INSTALL_PREFIX=/home/$USER/local ../ \\\n    && make -j4 \\\n    && make install \\\n    && rm -rf /tmp/gazebo && rm -rf /var/lib/apt/lists/*;\n\n# Finalize mesa installation, remove default ubuntu mesa libs\nRUN DEBIAN_FRONTEND=noninteractive apt-get --no-install-recommends install -y tzdata \\\n    && ln -fs /usr/share/zoneinfo/Europe/Dublin /etc/localtime \\\n    && dpkg-reconfigure -f noninteractive tzdata \\\n    && apt-get install --no-install-recommends -y mesa-utils libopenmpi-dev python3-tk \\\n    && dpkg --force-depends -r libgl1 libglx0 va-driver-all libglx-mesa0 libgl1-mesa-dri && rm -rf /var/lib/apt/lists/*;\n\nENV XVFB_WHD=\"1920x1080x24\"\\\n    DISPLAY=\":0\" \\\n    LIBGL_ALWAYS_SOFTWARE=\"1\" \\\n    GALLIUM_DRIVER=\"llvmpipe\" \\\n    LP_NO_RAST=\"false\" \\\n    PKG_CONFIG_PATH=\"/usr/local/pkgconfig\" \\\n    PATH=\"/home/$USER/local/bin:${PATH}\" \\\n    LD_LIBRARY_PATH=\"/usr/local/lib:/home/$USER/local/lib:/usr/local/lib/python3.6/dist-packages/gymfc/envs/assets/gazebo/plugins/build/\"\n\n# Build gymfc\nADD setup.py gymfc.ini gen_pb.sh LICENSE.txt /gymfc/\nADD gymfc /gymfc/gymfc\nRUN pip3 install --no-cache-dir /gymfc\n\nADD tests /gymfc/tests\nADD images /gymfc/images\n\n# Download gymfc plugins, build plugins\nRUN git clone https://github.com/wil3/gymfc-aircraft-plugins.git /gymfc/demo/plugins \\\n    && mkdir /gymfc/demo/plugins/build \\\n    && cd /gymfc/demo/plugins/build \\\n    && cmake .. \\\n    && make -j4 \\\n    && mkdir -p /gymfc/demo/models/solo/plugins/build \\\n    && cp -r /gymfc/demo/plugins/build/*.so /gymfc/demo/models/solo/plugins/build \\\n    && rm -rf /gymfc/demo/plugins\n\nRUN chown $USER:$USER -R /gymfc\n\nUSER $USER\nWORKDIR /home/$USER\n\nENTRYPOINT [\"/bin/bash\", \"-c\"]"
}