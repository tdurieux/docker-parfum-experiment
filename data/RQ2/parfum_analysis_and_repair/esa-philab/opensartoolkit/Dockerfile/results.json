{
  "startTime": 1674250773007,
  "endTime": 1674250773755,
  "originalSmells": [
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 24,
        "lineEnd": 36,
        "columnStart": 22,
        "columnEnd": 11
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 24,
        "lineEnd": 36,
        "columnStart": 22,
        "columnEnd": 11
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "FROM ubuntu:20.04\n\nLABEL maintainer=\"Andreas Vollrath, FAO\"\nLABEL OpenSARToolkit='0.12.3'\n\n# set work directory to home and download snap\nWORKDIR /home/ost\n\n# copy the snap installation config file into the container\nCOPY snap.varfile $HOME\n\n# update variables\nENV OTB_VERSION=\"7.3.0\" \\\n    TBX_VERSION=\"8\" \\\n    TBX_SUBVERSION=\"0\"\nENV TBX=\"esa-snap_sentinel_unix_${TBX_VERSION}_${TBX_SUBVERSION}.sh\" \\\n    SNAP_URL=\"http://step.esa.int/downloads/${TBX_VERSION}.${TBX_SUBVERSION}/installers\" \\\n    OTB=OTB-${OTB_VERSION}-Linux64.run \\\n    HOME=/home/ost \\\n    PATH=$PATH:/home/ost/programs/snap/bin:/home/ost/programs/OTB-${OTB_VERSION}-Linux64/bin\n\n# install all dependencies\nRUN groupadd -r ost && \\\n    useradd -r -g ost ost && \\\n    apt-get update && DEBIAN_FRONTEND=noninteractive apt-get --no-install-recommends install -yq \\\n        python3 \\\n        python3-pip \\\n        git \\\n        libgdal-dev \\\n        python3-gdal \\\n        libspatialindex-dev \\\n        libgfortran3 \\\n        wget \\\n        unzip \\\n        imagemagick \\\n        nodejs \\\n        npm && rm -rf /var/lib/apt/lists/*;\n\nRUN alias python=python3 && \\\n    rm -rf /var/lib/apt/lists/*  && \\\n    python3 -m pip install jupyterlab && \\\n    mkdir /home/ost/programs && \\\n    wget $SNAP_URL/$TBX && \\    \n    chmod +x $TBX && \\\n    ./$TBX -q -varfile snap.varfile && \\\n    rm $TBX && \\\n    rm snap.varfile && \\\n    cd /home/ost/programs && \\\n    wget https://www.orfeo-toolbox.org/packages/${OTB} && \\ \n    chmod +x $OTB && \\\n    ./${OTB} && \\\n    rm -f OTB-${OTB_VERSION}-Linux64.run\n\n# update snap to latest version\nRUN /home/ost/programs/snap/bin/snap --nosplash --nogui --modules --update-all 2>&1 | while read -r line; do \\\n        echo \"$line\" && \\\n        [ \"$line\" = \"updates=0\" ] && sleep 2 && pkill -TERM -f \"snap/jre/bin/java\"; \\\n    done; exit 0\n\n# set usable memory to 12G\nRUN echo \"-Xmx12G\" > /home/ost/programs/snap/bin/gpt.vmoptions\n\n# get OST and tutorials\nRUN python3 -m pip install git+https://github.com/ESA-PhiLab/OpenSarToolkit.git && \\\n    git clone https://github.com/ESA-PhiLab/OST_Notebooks && \\\n    jupyter labextension install @jupyter-widgets/jupyterlab-manager && \\\n    jupyter nbextension enable --py widgetsnbextension\n\nEXPOSE 8888\nCMD jupyter lab --ip='0.0.0.0' --port=8888 --no-browser --allow-root\n"
}