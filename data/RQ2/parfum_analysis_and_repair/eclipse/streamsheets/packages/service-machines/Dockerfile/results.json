{
  "startTime": 1674246002326,
  "endTime": 1674246003085,
  "originalSmells": [
    {
      "rule": "npmCacheCleanAfterInstall",
      "position": {
        "lineStart": 5,
        "lineEnd": 5,
        "columnStart": 4,
        "columnEnd": 83
      }
    },
    {
      "rule": "yarnCacheCleanAfterInstall",
      "position": {
        "lineStart": 11,
        "lineEnd": 11,
        "columnStart": 4,
        "columnEnd": 41
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "ARG BASE_IMAGE=node:12.4.0-alpine\nFROM $BASE_IMAGE as builder\n\nRUN apk update && apk upgrade && \\\n    apk add --no-cache yarn bash make gcc g++ python curl libc6-compat openssl && \\\n    npm install -g webpack webpack-cli webpack-node-externals terser-webpack-plugin && npm cache clean --force;\n\n# copy all packages without source (only package.json)\nCOPY --from=contextholder:latest /build ./build\nWORKDIR /build\nRUN node workspace-util.js prune @cedalo/service-machines && \\\n    yarn install --prod --frozen-lockfile && \\\n    # Ensure node_modules is present so we can copy it\n    mkdir -p packages/service-machines/node_modules && yarn cache clean;\n\n# copy all packages with source\nCOPY --from=contextholder:latest /packages-with-source ./packages\nRUN node workspace-util.js prune @cedalo/service-machines\n\nFROM $BASE_IMAGE\n\nRUN apk update && apk upgrade\n\nCOPY --from=builder /build/node_modules /app/node_modules\nCOPY --from=builder /build/packages /app/packages\n\nWORKDIR /app/packages/service-machines\n\nEXPOSE 8089\n\nCMD [ \"npm\", \"start\" ]\n"
}