{
  "startTime": 1674253466923,
  "endTime": 1674253467879,
  "originalSmells": [
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 16,
        "lineEnd": 16,
        "columnStart": 4,
        "columnEnd": 46
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 26,
        "lineEnd": 26,
        "columnStart": 4,
        "columnEnd": 28
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 43,
        "lineEnd": 43,
        "columnStart": 4,
        "columnEnd": 24
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 49,
        "lineEnd": 49,
        "columnStart": 4,
        "columnEnd": 24
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 54,
        "lineEnd": 54,
        "columnStart": 4,
        "columnEnd": 23
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 63,
        "lineEnd": 63,
        "columnStart": 4,
        "columnEnd": 22
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 65,
        "lineEnd": 65,
        "columnStart": 4,
        "columnEnd": 21
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 72,
        "lineEnd": 72,
        "columnStart": 4,
        "columnEnd": 30
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 85,
        "lineEnd": 85,
        "columnStart": 4,
        "columnEnd": 29
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 106,
        "lineEnd": 106,
        "columnStart": 4,
        "columnEnd": 25
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 107,
        "lineEnd": 107,
        "columnStart": 4,
        "columnEnd": 107
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 113,
        "lineEnd": 113,
        "columnStart": 4,
        "columnEnd": 24
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 118,
        "lineEnd": 118,
        "columnStart": 4,
        "columnEnd": 23
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 127,
        "lineEnd": 127,
        "columnStart": 4,
        "columnEnd": 22
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 129,
        "lineEnd": 129,
        "columnStart": 4,
        "columnEnd": 21
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 136,
        "lineEnd": 136,
        "columnStart": 4,
        "columnEnd": 30
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 138,
        "lineEnd": 138,
        "columnStart": 4,
        "columnEnd": 30
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 151,
        "lineEnd": 151,
        "columnStart": 4,
        "columnEnd": 29
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 8,
        "lineEnd": 8,
        "columnStart": 39,
        "columnEnd": 69
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 8,
        "lineEnd": 8,
        "columnStart": 73,
        "columnEnd": 104
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 24,
        "lineEnd": 24,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 52,
        "lineEnd": 52,
        "columnStart": 4,
        "columnEnd": 46
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 53,
        "lineEnd": 53,
        "columnStart": 4,
        "columnEnd": 33
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 62,
        "lineEnd": 62,
        "columnStart": 4,
        "columnEnd": 26
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 78,
        "lineEnd": 78,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 92,
        "lineEnd": 92,
        "columnStart": 4,
        "columnEnd": 26
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 116,
        "lineEnd": 116,
        "columnStart": 4,
        "columnEnd": 46
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 117,
        "lineEnd": 117,
        "columnStart": 4,
        "columnEnd": 33
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 126,
        "lineEnd": 126,
        "columnStart": 4,
        "columnEnd": 26
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 144,
        "lineEnd": 144,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 158,
        "lineEnd": 158,
        "columnStart": 4,
        "columnEnd": 26
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 24,
        "lineEnd": 24,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 52,
        "lineEnd": 52,
        "columnStart": 4,
        "columnEnd": 46
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 53,
        "lineEnd": 53,
        "columnStart": 4,
        "columnEnd": 33
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 62,
        "lineEnd": 62,
        "columnStart": 4,
        "columnEnd": 26
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 78,
        "lineEnd": 78,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 92,
        "lineEnd": 92,
        "columnStart": 4,
        "columnEnd": 26
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 116,
        "lineEnd": 116,
        "columnStart": 4,
        "columnEnd": 46
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 117,
        "lineEnd": 117,
        "columnStart": 4,
        "columnEnd": 33
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 126,
        "lineEnd": 126,
        "columnStart": 4,
        "columnEnd": 26
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 144,
        "lineEnd": 144,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 158,
        "lineEnd": 158,
        "columnStart": 4,
        "columnEnd": 26
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 8,
        "lineEnd": 8,
        "columnStart": 39,
        "columnEnd": 69
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 8,
        "lineEnd": 8,
        "columnStart": 73,
        "columnEnd": 104
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 24,
        "lineEnd": 24,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 52,
        "lineEnd": 52,
        "columnStart": 4,
        "columnEnd": 46
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 53,
        "lineEnd": 53,
        "columnStart": 4,
        "columnEnd": 33
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 62,
        "lineEnd": 62,
        "columnStart": 4,
        "columnEnd": 26
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 78,
        "lineEnd": 78,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 92,
        "lineEnd": 92,
        "columnStart": 4,
        "columnEnd": 26
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 116,
        "lineEnd": 116,
        "columnStart": 4,
        "columnEnd": 46
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 117,
        "lineEnd": 117,
        "columnStart": 4,
        "columnEnd": 33
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 126,
        "lineEnd": 126,
        "columnStart": 4,
        "columnEnd": 26
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 144,
        "lineEnd": 144,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 158,
        "lineEnd": 158,
        "columnStart": 4,
        "columnEnd": 26
      }
    }
  ],
  "repairedSmells": [
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 24,
        "lineEnd": 24,
        "columnStart": 4,
        "columnEnd": 51
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 52,
        "lineEnd": 52,
        "columnStart": 4,
        "columnEnd": 69
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 53,
        "lineEnd": 53,
        "columnStart": 4,
        "columnEnd": 57
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 62,
        "lineEnd": 62,
        "columnStart": 4,
        "columnEnd": 50
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 78,
        "lineEnd": 78,
        "columnStart": 4,
        "columnEnd": 51
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 92,
        "lineEnd": 92,
        "columnStart": 4,
        "columnEnd": 50
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 116,
        "lineEnd": 116,
        "columnStart": 4,
        "columnEnd": 69
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 117,
        "lineEnd": 117,
        "columnStart": 4,
        "columnEnd": 57
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 126,
        "lineEnd": 126,
        "columnStart": 4,
        "columnEnd": 50
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 144,
        "lineEnd": 144,
        "columnStart": 4,
        "columnEnd": 51
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 158,
        "lineEnd": 158,
        "columnStart": 4,
        "columnEnd": 50
      }
    }
  ],
  "repairedDockerfile": "##########################################################\n# Core Mava image\nFROM nvidia/cuda:11.5.1-cudnn8-devel-ubuntu20.04 as mava-core\n# Flag to record agents\nARG record\n# Ensure no installs try launch interactive screen\nARG DEBIAN_FRONTEND=noninteractive\n# Update packages\nRUN apt-get update --fix-missing -y && apt-get install --no-install-recommends -y python3-pip && apt-get install --no-install-recommends -y python3-venv && rm -rf /var/lib/apt/lists/*;\n# Update python path\nRUN update-alternatives --install /usr/bin/python python /usr/bin/python3.8 10 &&\\\n    rm -rf /root/.cache && apt-get clean\n# Setup virtual env\nRUN python -m venv mava\nENV VIRTUAL_ENV /mava\nENV PATH /mava/bin:$PATH\nRUN pip install --no-cache-dir --upgrade pip setuptools wheel\n# Location of mava folder\nARG folder=/home/app/mava\n## working directory\nWORKDIR ${folder}\n## Copy code from current path\nCOPY . /home/app/mava\n# For box2d\nRUN apt-get install --no-install-recommends swig -y && rm -rf /var/lib/apt/lists/*;\n## Install core dependencies + reverb.\nRUN pip install --no-cache-dir -e .[reverb]\n## Optional install for screen recording.\nENV DISPLAY=:0\nRUN if [ \"$record\" = \"true\" ]; then \\\n    ./bash_scripts/install_record.sh; \\\n    fi\nEXPOSE 6006\n##########################################################\n\n##########################################################\n# Core Mava-TF image\nFROM mava-core as tf-core\n# Tensorflow gpu config.\nENV TF_FORCE_GPU_ALLOW_GROWTH=true\nENV CUDA_DEVICE_ORDER=PCI_BUS_ID\nENV TF_CPP_MIN_LOG_LEVEL=3\n## Install core tf dependencies.\nRUN pip install --no-cache-dir -e .[tf]\n##########################################################\n\n##########################################################\n# PZ image\nFROM tf-core AS pz\nRUN pip install --no-cache-dir -e .[pz]\n# PettingZoo Atari envs\nRUN apt-get update\nRUN apt-get install --no-install-recommends ffmpeg libsm6 libxext6 -y && rm -rf /var/lib/apt/lists/*;\nRUN apt-get install --no-install-recommends -y unrar-free && rm -rf /var/lib/apt/lists/*;\nRUN pip install --no-cache-dir autorom\nRUN AutoROM -v\n##########################################################\n\n##########################################################\n# SMAC image\nFROM tf-core AS sc2\n## Install smac environment\nRUN apt-get -y --no-install-recommends install git && rm -rf /var/lib/apt/lists/*;\nRUN pip install --no-cache-dir .[sc2]\n# We use the pz wrapper for smac\nRUN pip install --no-cache-dir .[pz]\nENV SC2PATH /home/app/mava/3rdparty/StarCraftII\n##########################################################\n\n##########################################################\n# Flatland Image\nFROM tf-core AS flatland\nRUN pip install --no-cache-dir -e .[flatland]\n##########################################################\n\n#########################################################\n## Robocup Image\nFROM tf-core AS robocup\nRUN apt-get install --no-install-recommends sudo -y && rm -rf /var/lib/apt/lists/*;\nRUN ./bash_scripts/install_robocup.sh\n##########################################################\n\n##########################################################\n## OpenSpiel Image\nFROM tf-core AS openspiel\nRUN pip install --no-cache-dir .[open_spiel]\n##########################################################\n\n##########################################################\n# MeltingPot Image\nFROM tf-core AS meltingpot\n# Install meltingpot\nRUN apt-get install --no-install-recommends -y git && rm -rf /var/lib/apt/lists/*;\nRUN ./bash_scripts/install_meltingpot.sh\n# Add meltingpot to python path\nENV PYTHONPATH \"${PYTHONPATH}:${folder}/../packages/meltingpot\"\n##########################################################\n\n# New Jax Images\n##########################################################\n# Core Mava-Jax image\nFROM mava-core as jax-core\n# Jax gpu config.\nENV XLA_PYTHON_CLIENT_PREALLOCATE=false\n## Install core jax dependencies.\n# Install jax gpu\nRUN pip install --no-cache-dir -e .[jax]\nRUN pip install --no-cache-dir --upgrade \"jax[cuda]\" -f https://storage.googleapis.com/jax-releases/jax_cuda_releases.html\n##########################################################\n\n##########################################################\n# PZ image\nFROM jax-core AS pz-jax\nRUN pip install --no-cache-dir -e .[pz]\n# PettingZoo Atari envs\nRUN apt-get update\nRUN apt-get install --no-install-recommends ffmpeg libsm6 libxext6 -y && rm -rf /var/lib/apt/lists/*;\nRUN apt-get install --no-install-recommends -y unrar-free && rm -rf /var/lib/apt/lists/*;\nRUN pip install --no-cache-dir autorom\nRUN AutoROM -v\n##########################################################\n\n##########################################################\n# SMAC image\nFROM jax-core AS sc2-jax\n## Install smac environment\nRUN apt-get -y --no-install-recommends install git && rm -rf /var/lib/apt/lists/*;\nRUN pip install --no-cache-dir .[sc2]\n# We use the pz wrapper for smac\nRUN pip install --no-cache-dir .[pz]\nENV SC2PATH /home/app/mava/3rdparty/StarCraftII\n##########################################################\n\n##########################################################\n# Flatland Image\nFROM jax-core AS flatland-jax\nRUN pip install --no-cache-dir -e .[flatland]\n# To fix module 'jaxlib.xla_extension' has no attribute '__path__'\nRUN pip install --no-cache-dir cloudpickle -U\n##########################################################\n\n#########################################################\n## Robocup Image\nFROM jax-core AS robocup-jax\nRUN apt-get install --no-install-recommends sudo -y && rm -rf /var/lib/apt/lists/*;\nRUN ./bash_scripts/install_robocup.sh\n##########################################################\n\n##########################################################\n## OpenSpiel Image\nFROM jax-core AS openspiel-jax\nRUN pip install --no-cache-dir .[open_spiel]\n##########################################################\n\n##########################################################\n# MeltingPot Image\nFROM jax-core AS meltingpot-jax\n# Install meltingpot\nRUN apt-get install --no-install-recommends -y git && rm -rf /var/lib/apt/lists/*;\nRUN ./bash_scripts/install_meltingpot.sh\n# Add meltingpot to python path\nENV PYTHONPATH \"${PYTHONPATH}:${folder}/../packages/meltingpot\"\n##########################################################\n"
}