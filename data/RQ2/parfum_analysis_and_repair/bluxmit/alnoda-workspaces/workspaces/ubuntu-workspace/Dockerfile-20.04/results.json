{
  "startTime": 1674253895584,
  "endTime": 1674253898208,
  "originalSmells": [
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 24,
        "lineEnd": 24,
        "columnStart": 7,
        "columnEnd": 32
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 25,
        "lineEnd": 25,
        "columnStart": 7,
        "columnEnd": 39
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 26,
        "lineEnd": 26,
        "columnStart": 7,
        "columnEnd": 36
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 40,
        "lineEnd": 40,
        "columnStart": 7,
        "columnEnd": 26
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 54,
        "lineEnd": 54,
        "columnStart": 7,
        "columnEnd": 37
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 125,
        "lineEnd": 125,
        "columnStart": 7,
        "columnEnd": 33
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 126,
        "lineEnd": 126,
        "columnStart": 7,
        "columnEnd": 31
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 9,
        "lineEnd": 9,
        "columnStart": 7,
        "columnEnd": 50
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 10,
        "lineEnd": 10,
        "columnStart": 7,
        "columnEnd": 52
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 11,
        "lineEnd": 11,
        "columnStart": 7,
        "columnEnd": 38
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 21,
        "lineEnd": 21,
        "columnStart": 7,
        "columnEnd": 43
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 22,
        "lineEnd": 22,
        "columnStart": 7,
        "columnEnd": 37
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 23,
        "lineEnd": 23,
        "columnStart": 7,
        "columnEnd": 38
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 32,
        "lineEnd": 32,
        "columnStart": 7,
        "columnEnd": 38
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 41,
        "lineEnd": 41,
        "columnStart": 7,
        "columnEnd": 30
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 43,
        "lineEnd": 43,
        "columnStart": 7,
        "columnEnd": 30
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 53,
        "lineEnd": 53,
        "columnStart": 7,
        "columnEnd": 36
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 56,
        "lineEnd": 56,
        "columnStart": 7,
        "columnEnd": 33
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 114,
        "lineEnd": 114,
        "columnStart": 7,
        "columnEnd": 34
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 116,
        "lineEnd": 116,
        "columnStart": 7,
        "columnEnd": 28
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 124,
        "lineEnd": 124,
        "columnStart": 7,
        "columnEnd": 35
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 9,
        "lineEnd": 9,
        "columnStart": 7,
        "columnEnd": 50
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 10,
        "lineEnd": 10,
        "columnStart": 7,
        "columnEnd": 52
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 11,
        "lineEnd": 11,
        "columnStart": 7,
        "columnEnd": 38
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 21,
        "lineEnd": 21,
        "columnStart": 7,
        "columnEnd": 43
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 22,
        "lineEnd": 22,
        "columnStart": 7,
        "columnEnd": 37
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 23,
        "lineEnd": 23,
        "columnStart": 7,
        "columnEnd": 38
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 32,
        "lineEnd": 32,
        "columnStart": 7,
        "columnEnd": 38
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 41,
        "lineEnd": 41,
        "columnStart": 7,
        "columnEnd": 30
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 43,
        "lineEnd": 43,
        "columnStart": 7,
        "columnEnd": 30
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 53,
        "lineEnd": 53,
        "columnStart": 7,
        "columnEnd": 36
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 56,
        "lineEnd": 56,
        "columnStart": 7,
        "columnEnd": 33
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 114,
        "lineEnd": 114,
        "columnStart": 7,
        "columnEnd": 34
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 116,
        "lineEnd": 116,
        "columnStart": 7,
        "columnEnd": 28
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 124,
        "lineEnd": 124,
        "columnStart": 7,
        "columnEnd": 35
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "FROM ubuntu:20.04\n\nCOPY unified-supervisord.conf supervisord.conf /etc/supervisord/\nCOPY mc.ini /home/abc/.config/mc/ini\nCOPY zsh-in-docker.sh /tmp/zsh-in-docker.sh\n\n# Systemctl within Docker and Python 3.9\nRUN DEBIAN_FRONTEND=noninteractive apt-get -y update \\ \n    && echo \"------------------------------------------------------ Common stuff\" \\\n    && apt-get install --no-install-recommends -y sudo curl wget telnet jq \\\n    && apt-get install --no-install-recommends -y software-properties-common \\\n    && apt-get install --no-install-recommends -y zip gzip tar \\\n    && echo \"------------------------------------------------------ docker systemctl replacement\" \\\n    && wget https://raw.githubusercontent.com/gdraheim/docker-systemctl-replacement/master/files/docker/systemctl3.py -O /usr/local/bin/systemctl \\\n    && chmod 0777 /usr/local/bin/systemctl \\\n    && echo \"------------------------------------------------------ User\" \\\n    && useradd -u 8877 abc \\\n    && chmod -R 777 /home \\\n    && mkdir -p /home/abc \\\n    && chown -R abc /home/abc \\\n    && echo \"------------------------------------------------------ Python\" \\\n    && apt-get install --no-install-recommends -y python3-distutils \\\n    && apt-get install --no-install-recommends -y python3-pip \\\n    && apt-get install --no-install-recommends -y python3-venv \\\n    && pip install --no-cache-dir --upgrade pip \\\n    && pip install --no-cache-dir --upgrade setuptools \\\n    && pip install --no-cache-dir --upgrade distlib \\\n    && update-alternatives --install /usr/bin/pip pip /usr/bin/pip3 1 \\\n    && echo \"------------------------------------------------------ Allow users some priviledged actions\" \\\n    && echo \"# Allow non-admin users to install packages\" >> /etc/sudoers \\\n    && echo \"abc ALL = NOPASSWD : /usr/bin/apt, /usr/bin/apt-get, /usr/bin/aptitude, /usr/bin/add-apt-repository, /usr/local/bin/pip, /usr/local/bin/systemctl, /usr/bin/dpkg, /usr/sbin/dpkg-reconfigure\" >> /etc/sudoers \\\n    && echo \"------------------------------------------------------ GIT\" \\\n    && apt-get install --no-install-recommends -y git git-flow \\\n    && wget -P /tmp https://github.com/jesseduffield/lazygit/releases/download/v0.34/lazygit_0.34_Linux_x86_64.tar.gz \\\n    && mkdir /tmp/lazygit && tar -xzf /tmp/lazygit_0.34_Linux_x86_64.tar.gz --directory /tmp/lazygit \\\n    && chmod +x /tmp/lazygit/lazygit \\\n    && mv /tmp/lazygit/lazygit /usr/bin/ \\\n    && rm /tmp/lazygit_0.34_Linux_x86_64.tar.gz \\\n    && rm -rf /tmp/lazygit \\\n    && echo \"------------------------------------------------------ Nodeenv\" \\\n    && pip install --no-cache-dir nodeenv \\\n    && apt-get install --no-install-recommends -y yarn \\\n    && echo \"------------------------------------------------------ Cron\" \\\n    && apt-get install --no-install-recommends -y cron \\\n    && mkdir -p /var/log/supervisord/ \\\n    && chmod -R 777 /var/spool/cron/crontabs \\\n    && chmod -R 777 /var/log \\\n    && chmod gu+rw /var/run \\\n    && chmod gu+s /usr/sbin/cron \\\n    && echo \"# Allow cron for user abc\" >> /etc/sudoers \\\n    && echo \"abc ALL = NOPASSWD : /usr/sbin/cron \" >> /etc/sudoers \\\n    && echo \"------------------------------------------------------ Supervisor\" \\\n    && apt-get remove -y cmdtest \\\n    && apt-get install --no-install-recommends -y supervisor \\\n    && pip3 install --no-cache-dir supervisor==4.2.2 \\\n    && apt-get -y update \\\n    && apt-get install --no-install-recommends -y systemd \\\n    && chmod -R 777 /etc/supervisord/ \\\n    && chmod -R 777 /var/log/supervisord/ \\\n    && echo \"------------------------------------------------------ ZSH root\" \\\n    && HOME=/root \\\n    && chmod +x /tmp/zsh-in-docker.sh \\\n    && /tmp/zsh-in-docker.sh \\\n    -t https://github.com/pascaldevink/spaceship-zsh-theme \\\n    -a 'SPACESHIP_PROMPT_ADD_NEWLINE=\"false\"' \\\n    -a 'SPACESHIP_PROMPT_SEPARATE_LINE=\"false\"' \\\n    -a 'export LS_COLORS=\"$LS_COLORS:ow=1;34:tw=1;34:\"' \\\n    -a 'SPACESHIP_USER_SHOW=\"false\"' \\\n    -a 'SPACESHIP_TIME_SHOW=\"true\"' \\\n    -a 'SPACESHIP_TIME_COLOR=\"grey\"' \\\n    -a 'SPACESHIP_DIR_COLOR=\"cyan\"' \\\n    -a 'SPACESHIP_GIT_SYMBOL=\"⇡\"' \\\n    -a 'SPACESHIP_BATTERY_SHOW=\"false\"' \\\n    -a 'if [[ $(pwd) != /root  ]]; then cd /root; fi  # Set starting dir to /root ' \\\n    -a 'hash -d r=/root' \\\n    -p git \\\n    -p https://github.com/zsh-users/zsh-autosuggestions \\\n    -p https://github.com/zsh-users/zsh-completions \\\n    -p https://github.com/zsh-users/zsh-history-substring-search \\\n    -p https://github.com/zsh-users/zsh-syntax-highlighting \\\n    -p 'history-substring-search' \\\n    -p https://github.com/bobthecow/git-flow-completion \\\n    -a 'bindkey \"\\$terminfo[kcuu1]\" history-substring-search-up' \\\n    -a 'bindkey \"\\$terminfo[kcud1]\" history-substring-search-down' \\\n    && printf '%s\\n%s\\n' \"export ZSH_DISABLE_COMPFIX=true\" \"$(cat /root/.zshrc)\" > /root/.zshrc \\\n    && echo \"------------------------------------------------------ ZSH abc\" \\\n    && mkdir -p /home/project \\\n    && HOME=/home/abc \\\n    && /tmp/zsh-in-docker.sh \\\n    -t https://github.com/pascaldevink/spaceship-zsh-theme \\\n    -a 'DISABLE_UPDATE_PROMPT=\"true\"' \\\n    -a 'SPACESHIP_PROMPT_ADD_NEWLINE=\"false\"' \\\n    -a 'SPACESHIP_PROMPT_SEPARATE_LINE=\"false\"' \\\n    -a 'export LS_COLORS=\"$LS_COLORS:ow=1;34:tw=1;34:\"' \\\n    -a 'SPACESHIP_USER_SHOW=\"true\"' \\\n    -a 'SPACESHIP_TIME_SHOW=\"true\"' \\\n    -a 'SPACESHIP_TIME_COLOR=\"grey\"' \\\n    -a 'SPACESHIP_DIR_COLOR=\"cyan\"' \\\n    -a 'SPACESHIP_GIT_SYMBOL=\"⇡\"' \\\n    -a 'SPACESHIP_BATTERY_SHOW=\"false\"' \\\n    -a 'if [[ $(pwd) != /home/project  ]]; then cd /home/project; fi  # Set starting dir to /home/project ' \\\n    -a 'hash -d p=/home/project' \\\n    -p git \\\n    -p https://github.com/zsh-users/zsh-autosuggestions \\\n    -p https://github.com/zsh-users/zsh-completions \\\n    -p https://github.com/zsh-users/zsh-history-substring-search \\\n    -p https://github.com/zsh-users/zsh-syntax-highlighting \\\n    -p 'history-substring-search' \\\n    -p https://github.com/bobthecow/git-flow-completion \\\n    -a 'bindkey \"\\$terminfo[kcuu1]\" history-substring-search-up' \\\n    -a 'bindkey \"\\$terminfo[kcud1]\" history-substring-search-down' \\\n    && rm /tmp/zsh-in-docker.sh \\\n    && printf '%s\\n%s\\n' \"export ZSH_DISABLE_COMPFIX=true\" \"$(cat /home/abc/.zshrc)\" > /home/abc/.zshrc \\\n    && echo \"------------------------------------------------------ Code editors\" \\\n    && apt-get install --no-install-recommends -y nano vim \\\n    && echo \"------------------------------------------------------ File browsers: MC, Xplr\" \\\n    && apt-get install --no-install-recommends -y mc \\\n    && wget -P /tmp https://github.com/sayanarijit/xplr/releases/download/v0.17.6/xplr-linux.tar.gz \\\n    && \\mkdir /tmp/xplr && tar -xzf /tmp/xplr-linux.tar.gz --directory /tmp/xplr \\\n    && chmod +x /tmp/xplr/xplr \\\n    && mv /tmp/xplr/xplr /usr/bin/ \\\n    && rm /tmp/xplr-linux.tar.gz \\\n    && rm -rf /tmp/xplr \\\n    && echo \"------------------------------------------------------ Sys monitoring: Glances, Vizex\" \\\n    && apt-get install --no-install-recommends -y ncdu htop \\\n    && pip install --no-cache-dir glances==3.2.5 \\\n    && pip install --no-cache-dir vizex==2.1.0 \\\n    && echo \"------------------------------------------------------ Web-based terminal\" \\\n    && cd /tmp && wget https://github.com/tsl0922/ttyd/releases/download/1.6.3/ttyd.x86_64 \\\n    && mv ttyd.x86_64 /usr/bin/ttyd \\\n    && chmod +x /usr/bin/ttyd \\\n    && echo \"------------------------------------------------------ utils\" \\\n    && git clone https://github.com/bluxmit/alnoda-workspaces /tmp/alnoda-workspaces \\\n    && mv /tmp/alnoda-workspaces/utils /home/abc/ \\\n    && rm -rf /tmp/alnoda-workspaces \\\n    && echo \"------------------------------------------------------ User\" \\\n    && chown abc /home/project \\\n    && chmod 777 /etc/supervisord/ \\\n    && mkdir -p /home/abc/.local/bin \\\n    && chmod 755 /home/abc/.local && chmod 755 /home/abc/.local/bin \\\n    && chown abc /home/abc/.local && chown abc /home/abc/.local/bin \\\n    && find /home -type d | xargs -I{} chown -R abc {} \\\n    && find /home -type f | xargs -I{} chown abc {} \\\n    && echo \"------------------------------------------------------ Aliases\" \\\n    && echo 'alias python=\"python3\"' >> /root/.zshrc \\\n    && echo 'alias python=\"python3\"' >> /home/abc/.zshrc \\\n    && echo \"------------------------------------------------------ Clean\" \\\n    && apt-get -y autoremove \\\n    && apt-get -y clean \\\n    && apt-get -y autoclean \\\n    && rm -rf /home/abc/.oh-my-zsh/.git \\\n    && rm -rf /home/abc/.oh-my-zsh/.github \\\n    && rm -rf /home/abc/.oh-my-zsh/custom/plugins/git-flow-completion/.git \\\n    && rm -rf /home/abc/.oh-my-zsh/custom/plugins/zsh-autosuggestions/.git \\\n    && rm -rf /home/abc/.oh-my-zsh/custom/plugins/zsh-completions/.git \\\n    && rm -rf /home/abc/.oh-my-zsh/custom/plugins/zsh-history-substring-search/.git \\\n    && rm -rf /home/abc/.oh-my-zsh/custom/plugins/zsh-syntax-highlighting/.git \\\n    && rm -rf /home/abc/.oh-my-zsh/custom/themes/spaceship-zsh-theme/.git && rm -rf /var/lib/apt/lists/*;\n\nUSER abc\n\nENV PATH=\"/home/abc/.local/bin:${PATH}\"\n\n###### ENTRY\n\n# note! this will have consequences only when started as root (docker run ... --user root ...) \n# systemctl start systemd-journald\n#   I remove this from entrypoint, as it is not used significantly, but slows down the start\n\n# this entrypoint should be the same for all images that are built on top of this one\nENTRYPOINT /etc/init.d/cron start; supervisord -c \"/etc/supervisord/unified-supervisord.conf\"\n"
}