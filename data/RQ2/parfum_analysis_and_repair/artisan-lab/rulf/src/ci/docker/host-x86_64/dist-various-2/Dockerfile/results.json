{
  "startTime": 1674250254925,
  "endTime": 1674250255999,
  "originalSmells": [
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 8,
        "lineEnd": 25,
        "columnStart": 57,
        "columnEnd": 25
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "FROM ubuntu:18.04\n\nCOPY scripts/cross-apt-packages.sh /scripts/\nRUN sh /scripts/cross-apt-packages.sh\n\n# Enable source repositories, which are disabled by default on Ubuntu >= 18.04\nRUN sed -i 's/^# deb-src/deb-src/' /etc/apt/sources.list\n\nRUN apt-get update && apt-get build-dep -y clang llvm && apt-get install -y --no-install-recommends \\\n  build-essential \\\n# gcc-multilib can not be installed together with gcc-arm-linux-gnueabi\n  gcc-7-multilib \\\n  libedit-dev \\\n  libgmp-dev \\\n  libisl-dev \\\n  libmpc-dev \\\n  libmpfr-dev \\\n  ninja-build \\\n  nodejs \\\n  python3-dev \\\n  software-properties-common \\\n  unzip \\\n  # Needed for apt-key to work:\n  dirmngr \\\n  gpg-agent \\\n  g++-7-arm-linux-gnueabi && rm -rf /var/lib/apt/lists/*;\n\nRUN apt-key adv --batch --yes --keyserver keyserver.ubuntu.com --recv-keys 74DA7924C5513486\nRUN add-apt-repository -y 'deb http://apt.dilos.org/dilos dilos2 main'\n\nENV \\\n    AR_x86_64_fuchsia=x86_64-fuchsia-ar \\\n    CC_x86_64_fuchsia=x86_64-fuchsia-clang \\\n    CXX_x86_64_fuchsia=x86_64-fuchsia-clang++ \\\n    AR_aarch64_fuchsia=aarch64-fuchsia-ar \\\n    CC_aarch64_fuchsia=aarch64-fuchsia-clang \\\n    CXX_aarch64_fuchsia=aarch64-fuchsia-clang++ \\\n    AR_sparcv9_sun_solaris=sparcv9-sun-solaris2.10-ar \\\n    CC_sparcv9_sun_solaris=sparcv9-sun-solaris2.10-gcc \\\n    CXX_sparcv9_sun_solaris=sparcv9-sun-solaris2.10-g++ \\\n    AR_x86_64_sun_solaris=x86_64-sun-solaris2.10-ar \\\n    CC_x86_64_sun_solaris=x86_64-sun-solaris2.10-gcc \\\n    CXX_x86_64_sun_solaris=x86_64-sun-solaris2.10-g++ \\\n    CC_armv7_unknown_linux_gnueabi=arm-linux-gnueabi-gcc-7 \\\n    CXX_armv7_unknown_linux_gnueabi=arm-linux-gnueabi-g++-7 \\\n    AR_x86_64_fortanix_unknown_sgx=ar \\\n    CC_x86_64_fortanix_unknown_sgx=x86_64-fortanix-unknown-sgx-clang-11 \\\n    CFLAGS_x86_64_fortanix_unknown_sgx=\"-mlvi-hardening -mllvm -x86-experimental-lvi-inline-asm-hardening\" \\\n    CXX_x86_64_fortanix_unknown_sgx=x86_64-fortanix-unknown-sgx-clang++-11 \\\n    CXXFLAGS_x86_64_fortanix_unknown_sgx=\"-mlvi-hardening -mllvm -x86-experimental-lvi-inline-asm-hardening\" \\\n    CC=gcc-7 \\\n    CXX=g++-7\n\nWORKDIR /build\nCOPY scripts/musl.sh /build\nRUN env \\\n    CC=arm-linux-gnueabi-gcc-7 CFLAGS=\"-march=armv7-a\" \\\n    CXX=arm-linux-gnueabi-g++-7 CXXFLAGS=\"-march=armv7-a\" \\\n    bash musl.sh armv7 && \\\n    rm -rf /build/*\n\nWORKDIR /tmp\nCOPY host-x86_64/dist-various-2/shared.sh /tmp/\nCOPY host-x86_64/dist-various-2/build-cloudabi-toolchain.sh /tmp/\nRUN /tmp/build-cloudabi-toolchain.sh x86_64-unknown-cloudabi\nCOPY host-x86_64/dist-various-2/build-fuchsia-toolchain.sh /tmp/\nRUN /tmp/build-fuchsia-toolchain.sh\nCOPY host-x86_64/dist-various-2/build-solaris-toolchain.sh /tmp/\nRUN /tmp/build-solaris-toolchain.sh x86_64  amd64   solaris-i386\nRUN /tmp/build-solaris-toolchain.sh sparcv9 sparcv9 solaris-sparc\nCOPY host-x86_64/dist-various-2/build-x86_64-fortanix-unknown-sgx-toolchain.sh /tmp/\nCOPY host-x86_64/dist-various-2/x86_64-fortanix-unknown-sgx-clang-wrap.sh /usr/bin/x86_64-fortanix-unknown-sgx-clang-11\nRUN ln -s /usr/bin/x86_64-fortanix-unknown-sgx-clang-11 /usr/bin/x86_64-fortanix-unknown-sgx-clang++-11\nRUN /tmp/build-x86_64-fortanix-unknown-sgx-toolchain.sh\n\nCOPY host-x86_64/dist-various-2/build-wasi-toolchain.sh /tmp/\nRUN /tmp/build-wasi-toolchain.sh\n\nCOPY scripts/sccache.sh /scripts/\nRUN sh /scripts/sccache.sh\n\nENV CARGO_TARGET_X86_64_FUCHSIA_AR /usr/local/bin/llvm-ar\nENV CARGO_TARGET_X86_64_FUCHSIA_RUSTFLAGS \\\n-C link-arg=--sysroot=/usr/local/x86_64-fuchsia \\\n-C link-arg=-L/usr/local/x86_64-fuchsia/lib \\\n-C link-arg=-L/usr/local/lib/x86_64-fuchsia/lib\nENV CARGO_TARGET_AARCH64_FUCHSIA_AR /usr/local/bin/llvm-ar\nENV CARGO_TARGET_AARCH64_FUCHSIA_RUSTFLAGS \\\n-C link-arg=--sysroot=/usr/local/aarch64-fuchsia \\\n-C link-arg=-L/usr/local/aarch64-fuchsia/lib \\\n-C link-arg=-L/usr/local/lib/aarch64-fuchsia/lib\n\nENV TARGETS=x86_64-fuchsia\nENV TARGETS=$TARGETS,aarch64-fuchsia\nENV TARGETS=$TARGETS,wasm32-unknown-unknown\nENV TARGETS=$TARGETS,wasm32-wasi\nENV TARGETS=$TARGETS,sparcv9-sun-solaris\nENV TARGETS=$TARGETS,x86_64-sun-solaris\nENV TARGETS=$TARGETS,x86_64-unknown-linux-gnux32\nENV TARGETS=$TARGETS,x86_64-unknown-cloudabi\nENV TARGETS=$TARGETS,x86_64-fortanix-unknown-sgx\nENV TARGETS=$TARGETS,nvptx64-nvidia-cuda\nENV TARGETS=$TARGETS,armv7-unknown-linux-gnueabi\nENV TARGETS=$TARGETS,armv7-unknown-linux-musleabi\n\n# As per https://bugs.launchpad.net/ubuntu/+source/gcc-defaults/+bug/1300211\n# we need asm in the search path for gcc-7 (for gnux32) but not in the search path of the\n# cross compilers.\n# Luckily one of the folders is /usr/local/include so symlink /usr/include/asm-generic there\nRUN ln -s /usr/include/asm-generic /usr/local/include/asm\n\nENV RUST_CONFIGURE_ARGS --enable-extended --enable-lld --disable-docs \\\n  --set target.wasm32-wasi.wasi-root=/wasm32-wasi \\\n  --musl-root-armv7=/musl-armv7\n\nENV SCRIPT python3 ../x.py dist --target $TARGETS\n"
}