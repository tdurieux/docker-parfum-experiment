{
  "startTime": 1674250565484,
  "endTime": 1674250566145,
  "originalSmells": [
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 15,
        "lineEnd": 18,
        "columnStart": 25,
        "columnEnd": 16
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 57,
        "lineEnd": 61,
        "columnStart": 47,
        "columnEnd": 11
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 15,
        "lineEnd": 18,
        "columnStart": 25,
        "columnEnd": 16
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 57,
        "lineEnd": 61,
        "columnStart": 47,
        "columnEnd": 11
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "# DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS HEADER.\n#\n# Copyright (c) 2022 Axway Software SA and its affiliates. All rights reserved.\n#\n# Axway Transfer CFT Docker image\n#\n# Building with:\n# docker build -f Dockerfile -t axway/cft:3.8 .\n\n#\n# Stage 1 : build\n#\n\nFROM ubuntu:20.04 AS builder\n\nRUN apt-get -y update && apt-get install --no-install-recommends -y \\\n        curl \\\n        unzip \\\n        binutils && \\\n        rm -rf /var/lib/apt/lists && \\\n        mkdir -p /opt/axway && \\\n        adduser --disabled-password --gecos '' --home /opt/axway --no-create-home --uid 1000 --gid 0 axway && \\\n        chown -R axway:0 /opt/axway && rm -rf /var/lib/apt/lists/*;\n\nUSER 1000\nWORKDIR /opt/axway\nENV LANG=C.UTF-8\n\n# Download and install Transfer CFT package\n\nARG PACKAGE=\"Transfer_CFT_3.10.2203_Install_b9dcb51484_linux-x86-64.zip\"\nARG URL_BASE=\"https://delivery.server.int/\"\nARG INSTALL_KIT=\"${URL_BASE}${PACKAGE}\"\n\nADD --chown=axway:0 $INSTALL_KIT installkit.zip\n\nRUN unzip installkit.zip -d setup && \\\n    cd setup && \\\n    chmod +x *.run && \\\n    ./Transfer_CFT_*_linux-x86-64*.run  --mode unattended --installdir /opt/axway/cft --accept_general_conditions yes && \\\n    strip -d /opt/axway/cft/home/lib/* && \\\n    cd && \\\n    rm -rf setup installkit.zip *.properties && \\\n    chown -R axway:0 /opt/axway && \\\n    chmod -R u+x /opt/axway && \\\n    chmod -R g=u /opt/axway\n\n# Copying useful scripts\n\nCOPY --chown=axway:0 resources/*.sh resources/uid_entrypoint ./\n\n#\n# Stage 2 : create final image\n#\n\nFROM ubuntu:20.04\n\nRUN apt-get -y update && apt-get upgrade -y && apt-get install --no-install-recommends -y \\\n        curl \\\n        jq \\\n        openssl \\\n        vim && \\\n        rm -rf /var/lib/apt/lists && \\\n        adduser --disabled-password --gecos '' --home /opt/axway --no-create-home --uid 1000 --gid 0 axway && \\\n        mkdir -p /opt/axway/data && \\\n        chown -R axway:0 /opt/axway && \\\n        chmod -R u+x /opt/axway && \\\n        chmod -R g=u /opt/axway /etc/passwd && rm -rf /var/lib/apt/lists/*;\n\nCOPY --chown=axway:0 --from=builder /opt/axway /opt/axway\n\nUSER 1000\nWORKDIR /opt/axway\nENV HOME=/opt/axway\nENV LANG=C.UTF-8\n\nARG BUILD_DATE\nARG BUILD_VERSION=\"3.10.2203\"\nARG BUILD_REVISION=\"b9dcb51484\"\n\nLABEL created=\"${BUILD_DATE}\"\nLABEL url=\"https://www.axway.com\"\nLABEL vendor=\"Axway\"\nLABEL maintainer=\"support@axway.com\"\nLABEL title=\"Transfer CFT\"\nLABEL version=\"${BUILD_VERSION}\"\nLABEL revision=\"${BUILD_REVISION}\"\n\n# Exposed ports\n\n# PESIT + PESITSSL\nEXPOSE 1761-1762\n# COMS (Needed for multinode/Multihost)\nEXPOSE 1765\n# CFT UI\nEXPOSE 1766\n# Only expose if CG not in the same network\nEXPOSE 1767\n# Used for REST API\nEXPOSE 1768\n\n# Environment variables\n\nENV CFT_FQDN             \"\"\nENV CFT_INSTANCE_ID      docker0_cft\nENV CFT_INSTANCE_GROUP   dev.docker\nENV CFT_CATALOG_SIZE     1000\nENV CFT_COM_SIZE         1000\nENV CFT_PESIT_PORT       1761\nENV CFT_PESITSSL_PORT    1762\nENV CFT_SFTP_PORT        1763\nENV CFT_COMS_PORT        1765\nENV CFT_COPILOT_PORT     1766\nENV CFT_COPILOT_CG_PORT  1767\nENV CFT_RESTAPI_PORT     1768\nENV CFT_CG_ENABLE        \"YES\"\nENV CFT_CG_HOST          127.0.0.1\nENV CFT_CG_PORT          12553\nENV CFT_CG_SHARED_SECRET \"\"\nENV CFT_CG_POLICY        \"\"\nENV CFT_CG_PERIODICITY   \"\"\nENV CFT_CG_AGENT_NAME    \"\"\nENV CFT_JVM              1024\nENV CFT_KEY              \"cat /run/secrets/cft.key\"\nENV CFT_INSTALLDIR       \"/opt/axway/cft\"\nENV CFT_CFTDIRRUNTIME    \"/opt/axway/data/runtime\"\nENV CFT_EXPORTDIR        \".export\"\nENV CFT_EXPORTCMD        \"/opt/axway/export_bases.sh\"\nENV CFT_MULTINODE_ENABLE \"NO\"\n\n# Entry point\n\nENTRYPOINT [ \"/opt/axway/uid_entrypoint\" ]\nCMD [ \"./start.sh\" ]\n\nHEALTHCHECK --interval=1m \\\n            --timeout=5s \\\n            --start-period=5m \\\n            --retries=3 \\\n            CMD . $CFT_CFTDIRRUNTIME/profile && copstatus\n"
}