{
  "startTime": 1674219400270,
  "endTime": 1674219402662,
  "originalSmells": [
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 46,
        "lineEnd": 46,
        "columnStart": 4,
        "columnEnd": 22
      }
    },
    {
      "rule": "configureShouldUseBuildFlag",
      "position": {
        "lineStart": 56,
        "lineEnd": 56,
        "columnStart": 1,
        "columnEnd": 43
      }
    },
    {
      "rule": "tarSomethingRmTheSomething",
      "position": {
        "lineStart": 38,
        "lineEnd": 38,
        "columnStart": 1,
        "columnEnd": 31
      }
    },
    {
      "rule": "tarSomethingRmTheSomething",
      "position": {
        "lineStart": 92,
        "lineEnd": 92,
        "columnStart": 1,
        "columnEnd": 35
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 21,
        "lineEnd": 21,
        "columnStart": 1,
        "columnEnd": 49
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 22,
        "lineEnd": 22,
        "columnStart": 1,
        "columnEnd": 24
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 23,
        "lineEnd": 23,
        "columnStart": 1,
        "columnEnd": 24
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 24,
        "lineEnd": 24,
        "columnStart": 1,
        "columnEnd": 25
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 25,
        "lineEnd": 25,
        "columnStart": 1,
        "columnEnd": 24
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 26,
        "lineEnd": 26,
        "columnStart": 1,
        "columnEnd": 28
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 27,
        "lineEnd": 27,
        "columnStart": 1,
        "columnEnd": 36
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 28,
        "lineEnd": 28,
        "columnStart": 1,
        "columnEnd": 31
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 29,
        "lineEnd": 29,
        "columnStart": 1,
        "columnEnd": 23
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 30,
        "lineEnd": 30,
        "columnStart": 1,
        "columnEnd": 31
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 31,
        "lineEnd": 31,
        "columnStart": 1,
        "columnEnd": 57
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 32,
        "lineEnd": 32,
        "columnStart": 1,
        "columnEnd": 30
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 33,
        "lineEnd": 33,
        "columnStart": 1,
        "columnEnd": 136
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 21,
        "lineEnd": 21,
        "columnStart": 1,
        "columnEnd": 49
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 22,
        "lineEnd": 22,
        "columnStart": 1,
        "columnEnd": 24
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 23,
        "lineEnd": 23,
        "columnStart": 1,
        "columnEnd": 24
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 24,
        "lineEnd": 24,
        "columnStart": 1,
        "columnEnd": 25
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 25,
        "lineEnd": 25,
        "columnStart": 1,
        "columnEnd": 24
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 26,
        "lineEnd": 26,
        "columnStart": 1,
        "columnEnd": 28
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 27,
        "lineEnd": 27,
        "columnStart": 1,
        "columnEnd": 36
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 28,
        "lineEnd": 28,
        "columnStart": 1,
        "columnEnd": 31
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 29,
        "lineEnd": 29,
        "columnStart": 1,
        "columnEnd": 23
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 30,
        "lineEnd": 30,
        "columnStart": 1,
        "columnEnd": 31
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 31,
        "lineEnd": 31,
        "columnStart": 1,
        "columnEnd": 57
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 32,
        "lineEnd": 32,
        "columnStart": 1,
        "columnEnd": 30
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 33,
        "lineEnd": 33,
        "columnStart": 1,
        "columnEnd": 136
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "# SPDX-License-Identifier: Apache-2.0\n# Copyright (c) 2019 Intel Corporation\n\nFROM ubuntu:20.04\n\nENV http_proxy=$http_proxy\nENV https_proxy=$https_proxy\nENV no_proxy=$no_proxy,eaa.openness,analytics.openness\nENV DEBIAN_FRONTEND=noninteractive\n\n##  OnPrem NTS uses CPU 0,2 and 3.\n##  So OpenVINO user needs to configure the value according the setup\nENV OPENVINO_TASKSET_CPU=7\n\nARG OPENVINO_LINK=https://registrationcenter-download.intel.com/akdlm/irc_nas/17062/l_openvino_toolkit_p_2021.1.110.tgz\nARG YEAR=2021\nARG OPENVINO_DEMOS_DIR=/opt/intel/openvino_$YEAR/deployment_tools/open_model_zoo/demos\nARG MODEL_ROOT=/opt/intel/openvino_$YEAR/deployment_tools/open_model_zoo/tools/downloader\nENV APP_DIR=/opt/intel/openvino_$YEAR/deployment_tools/inference_engine/demos/python_demos/object_detection_demo_ssd_async/\n\nRUN apt-get update && \\\n\tapt-get -y --no-install-recommends install build-essential gcc g++ cmake && \\\n\tapt-get -y --no-install-recommends install cpio && \\\n\tapt-get -y --no-install-recommends install sudo && \\\n\tapt-get -y --no-install-recommends install unzip && \\\n\tapt-get -y --no-install-recommends install wget && \\\n\tapt-get -y --no-install-recommends install lsb-core && \\\n\tapt-get -y --no-install-recommends install autoconf libtool && \\\n\tapt-get -y --no-install-recommends install ffmpeg x264 && \\\n\tapt-get -y --no-install-recommends install git && \\\n\tapt-get -y --no-install-recommends install python3-pip && \\\n\tapt-get -y --no-install-recommends install nginx libnginx-mod-rtmp libjson-c-dev && \\\n\tapt-get -y --no-install-recommends install util-linux && \\\n\tapt-get -y --no-install-recommends install libusb-1.0-0-dev libudev-dev libssl-dev libboost-program-options1.71-dev libboost-thread1.71 libboost-filesystem1.71 && rm -rf /var/lib/apt/lists/*;\n\n# OpenVino installation\nRUN cd /tmp && \\\n\twget $OPENVINO_LINK && \\\n\ttar xf l_openvino_toolkit*.tgz && \\\n\tcd l_openvino_toolkit* && \\\n\tsed -i 's/decline/accept/g' silent.cfg && \\\n\t./install_openvino_dependencies.sh && \\\n\t./install.sh -s silent.cfg && \\\n\trm -rf /tmp/l_openvino_toolkit* && rm l_openvino_toolkit*.tgz\n\n# Install numpy\nRUN pip3 install --no-cache-dir numpy\n\nCOPY nginx.conf /etc/nginx/nginx.conf\nRUN chmod +s /usr/sbin/nginx\n\n# Rebuilding libusb without UDEV support -- required for Intel Movidius Stick\nRUN cd /tmp && \\\n\twget https://github.com/libusb/libusb/archive/v1.0.22.zip && \\\n\tunzip v1.0.22.zip && cd libusb-1.0.22 && \\\n\t./bootstrap.sh && \\\n\t./configure --build=\"$(dpkg-architecture --query DEB_BUILD_GNU_TYPE)\" --disable-udev --enable-shared && \\\n\tmake -j4 && make install && \\\n\trm -rf /tmp/*1.0.22*\n\n# Creating user openvino and adding it to groups \"video\" and \"users\" to use GPU and VPU\nRUN useradd -ms /bin/bash -G video,users,www-data openvino && \\\n    chown -R openvino /home/openvino\n\nCOPY cmd/ /home/openvino\nADD start.sh /home/openvino\n\nRUN chown -R openvino:openvino /opt/intel/openvino*\nRUN chown -R openvino:openvino /home/openvino/*\n\n# chmod /etc/hosts\nRUN chmod 0777 /etc/hosts\n\nUSER openvino\nRUN echo \"source /opt/intel/openvino_$YEAR/bin/setupvars.sh\" >> ~/.bashrc\nRUN bash -c \"source ~/.bashrc\"\n\n# Build OpenVINO samples\nADD object_detection_demo_ssd_async.patch $APP_DIR\nRUN cd $APP_DIR && patch -p0 object_detection_demo_ssd_async.py object_detection_demo_ssd_async.patch\n\n# Download OpenVINO pre-trained models\nRUN cd $MODEL_ROOT && python3 -mpip install --user -r ./requirements.in && \\\n    ./downloader.py --name pedestrian-detection-adas-0002 && \\\n    ./downloader.py --name vehicle-detection-adas-0002\n\nRUN cp -r $MODEL_ROOT/intel/vehicle-detection-adas-0002 $APP_DIR/ && \\\n    cp -r $MODEL_ROOT/intel/pedestrian-detection-adas-0002 $APP_DIR/\n\n# Install Go\nRUN cd /tmp && \\\n\twget https://dl.google.com/go/go1.15.linux-amd64.tar.gz && \\\n\ttar -xvf go1.15.linux-amd64.tar.gz && rm go1.15.linux-amd64.tar.gz\n\nENV OPENVINO_ROOT=/opt/intel/openvino_$YEAR\nENV GOPATH=/home/openvino/go\nENV GOROOT=/tmp/go\nENV GO111MODULE=on\nENV PATH=$GOPATH/bin:$GOROOT/bin:$PATH\nRUN mkdir $GOPATH\n\n# Work Dir\nWORKDIR /home/openvino\n\n# Get go dependencies\nRUN git config --global http.proxy $http_proxy\nRUN go get github.com/gorilla/websocket\nRUN go build main.go openvino.go eaa_interface.go\n\n# OpenVINO inference and forwarding\nENTRYPOINT [\"./start.sh\"]\n"
}