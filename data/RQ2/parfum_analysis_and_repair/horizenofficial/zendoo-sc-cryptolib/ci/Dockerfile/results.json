{
  "startTime": 1674255682751,
  "endTime": 1674255683328,
  "originalSmells": [
    {
      "rule": "gpgUseBatchFlag",
      "position": {
        "lineStart": 19,
        "lineEnd": 19,
        "columnStart": 9,
        "columnEnd": 22
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "FROM ubuntu:18.04\n\nMAINTAINER infrastructure@zensystem.io\n\nSHELL [\"/bin/bash\", \"-c\"]\n\nCOPY entrypoint.sh entrypoint_setup_gpg.sh /usr/local/bin/\n\n# Get Ubuntu packages\nRUN set -eux && export GOSU_VERSION=1.12 && export DEBIAN_FRONTEND=noninteractive \\\n    && apt-get update \\\n    && apt-get install -y --no-install-recommends build-essential ca-certificates curl dirmngr \\\n       gcc-mingw-w64-x86-64 gnupg2 gnupg1-curl wget libssl-dev pkg-config jq ; \\\n# save list of currently installed packages for later so we can clean up\n    savedAptMark=\"$(apt-mark showmanual)\"; \\\n    apt-get update; \\\n    apt-get install -y --no-install-recommends ca-certificates wget; \\\n    if ! command -v gpg;then \\\n      apt-get install -y --no-install-recommends gnupg2 dirmngr; \\\n    elif gpg --batch --version | grep -q '^gpg (GnuPG) 1\\.'; then \\\n# \"This package provides support for HKPS keyservers.\" (GnuPG 1.x only)\n      apt-get install -y --no-install-recommends gnupg-curl; \\\n    fi; \\\n    rm -rf /var/lib/apt/lists/*; \\\n\n    dpkgArch=\"$(dpkg --print-architecture | awk -F- '{ print $NF }')\"; \\\n    wget -O /usr/local/bin/gosu \"https://github.com/tianon/gosu/releases/download/$GOSU_VERSION/gosu-$dpkgArch\"; \\\n    wget -O /usr/local/bin/gosu.asc \"https://github.com/tianon/gosu/releases/download/$GOSU_VERSION/gosu-$dpkgArch.asc\"; \\\n\n# verify the signature\n    export GNUPGHOME=\"$(mktemp -d)\"; \\\n    ( gpg2 --batch --keyserver hkps://keys.openpgp.org --keyserver-options timeout=15 --recv-keys B42F6819007F00F88E364FD4036A9C25BF357DD4 || \\\n      gpg2 --batch --keyserver keyserver.ubuntu.com --keyserver-options timeout=15 --recv-keys B42F6819007F00F88E364FD4036A9C25BF357DD4 || \\\n      gpg2 --batch --keyserver hkp://p80.pool.sks-keyservers.net:80 --keyserver-options timeout=15 --recv-keys B42F6819007F00F88E364FD4036A9C25BF357DD4 || \\\n      gpg2 --batch --keyserver hkp://ipv4.pool.sks-keyservers.net --keyserver-options timeout=15 --recv-keys B42F6819007F00F88E364FD4036A9C25BF357DD4 || \\\n      gpg2 --batch --keyserver hkp://pgp.mit.edu:80 --keyserver-options timeout=15 --recv-keys B42F6819007F00F88E364FD4036A9C25BF357DD4 ) \\\n    && gpg2 --batch --verify /usr/local/bin/gosu.asc /usr/local/bin/gosu \\\n    && command -v gpgconf && gpgconf --kill all || :; \\\n    rm -rf \"$GNUPGHOME\" /usr/local/bin/gosu.asc; \\\n\n# clean up fetch dependencies\n    apt-mark auto '.*' > /dev/null; \\\n    [ -z \"$savedAptMark\" ] || apt-mark manual $savedAptMark; \\\n    apt-get purge -y --auto-remove -o APT::AutoRemove::RecommendsImportant=false; \\\n\n    chmod +x /usr/local/bin/gosu; \\\n# verify that the binary works\n    gosu --version; \\\n    gosu nobody true \\\n    && chmod +x /usr/local/bin/{entrypoint.sh,entrypoint_setup_gpg.sh} \\\n    && apt-get -y clean \\\n    && apt-get -y autoclean \\\n    && rm -rf /var/lib/apt/lists/* /var/cache/apt/archives/*.deb\n\nENTRYPOINT [\"/usr/local/bin/entrypoint.sh\"]\n"
}