{
  "startTime": 1674221258984,
  "endTime": 1674221260274,
  "originalSmells": [
    {
      "rule": "configureShouldUseBuildFlag",
      "position": {
        "lineStart": 33,
        "lineEnd": 33,
        "columnStart": 4,
        "columnEnd": 15
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "# SPDX-License-Identifier: GPL-2.0-only OR GPL-3.0-only  */\n# Copyright (c) 2021 - 2022 Gavin Henry <ghenry@sentrypeer.org> */\n#\n#   _____            _              _____\n#  / ____|          | |            |  __ \\\n# | (___   ___ _ __ | |_ _ __ _   _| |__) |__  ___ _ __\n#  \\___ \\ / _ \\ '_ \\| __| '__| | | |  ___/ _ \\/ _ \\ '__|\n#  ____) |  __/ | | | |_| |  | |_| | |  |  __/  __/ |\n# |_____/ \\___|_| |_|\\__|_|   \\__, |_|   \\___|\\___|_|\n#                              __/ |\n#                             |___/\n#\nFROM alpine:edge AS builder\n#\nLABEL maintainer=\"Gavin Henry, ghenry@sentrypeer.org\"\n#\nRUN apk add --no-cache autoconf automake autoconf-archive \\\n\tgit sqlite-dev cmocka-dev util-linux-dev curl-dev \\\n\tpcre2-dev jansson-dev libmicrohttpd-dev build-base\n#\nRUN apk add --no-cache -X https://dl-cdn.alpinelinux.org/alpine/edge/testing \\\n    libosip2-dev\n#\nRUN apk add --no-cache -X https://dl-cdn.alpinelinux.org/alpine/edge/testing \\\n    opendht-dev\n#\nRUN git clone https://github.com/SentryPeer/SentryPeer.git\n#\nWORKDIR /SentryPeer\n#\nRUN sed -i '/AM_LDFLAGS=/d' Makefile.am\nRUN ./bootstrap.sh\nRUN ./configure --build=\"$(dpkg-architecture --query DEB_BUILD_GNU_TYPE)\"\nRUN make\nRUN make check\nRUN make install\n# https://github.com/telekom-security/tpotce/blob/22.x/docker/sentrypeer/Dockerfile\nFROM alpine:edge\n#\nLABEL maintainer=\"Gavin Henry, ghenry@sentrypeer.org\"\n#\nCOPY --from=builder /SentryPeer/sentrypeer /opt/sentrypeer/\n#\n# Install packages\nRUN apk -U add --no-cache \\\n    jansson \\\n    libmicrohttpd \\\n    libuuid \\\n    pcre2 \\\n    sqlite-libs && \\\n    apk -U add --no-cache -X https://dl-cdn.alpinelinux.org/alpine/edge/testing \\\n    libosip2 && \\\n    apk -U add --no-cache -X https://dl-cdn.alpinelinux.org/alpine/edge/testing \\\n    opendht-libs && \\\n    \\\n    # Setup user, groups and configs \\\n    mkdir -p /var/lib/sentrypeer && \\\n    mkdir -p /var/log/sentrypeer && \\\n    addgroup -g 2000 sentrypeer && \\\n    adduser -S -H -s /bin/ash -u 2000 -D -g 2000 sentrypeer && \\\n    chown -R sentrypeer:sentrypeer /opt/sentrypeer /var/lib/sentrypeer /var/log/sentrypeer && \\\n#\n# Clean up\n    rm -rf /root/* && \\\n    rm -rf /var/cache/apk/*\n#\n# Set workdir and start sentrypeer\nSTOPSIGNAL SIGKILL\nUSER sentrypeer:sentrypeer\nWORKDIR /opt/sentrypeer/\n#\n# SIP Port 5060, RESTful API and OpenDHT\nEXPOSE 5060/udp 8082 4222/udp\n #\n # ENV SENTRYPEER_DB_FILE=/my/location/sentrypeer.db\n # ENV SENTRYPEER_API=1\n # ENV SENTRYPEER_WEB_GUI=1\n # ENV SENTRYPEER_SIP_RESPONSIVE=1\n # ENV SENTRYPEER_SIP_DISABLE=1\n # ENV SENTRYPEER_SYSLOG=1\n # ENV SENTRYPEER_PEER_TO_PEER=1\n # ENV SENTRYPEER_JSON_LOG=1\n # ENV SENTRYPEER_JSON_LOG_FILE=/my/location/sentrypeer_json.log\n # ENV SENTRYPEER_VERBOSE=1\n # ENV SENTRYPEER_DEBUG=1\n #\nCMD [\"./sentrypeer\", \"-rawps\", \"-f\", \"/var/lib/sentrypeer/sentrypeer.db\", \"-l\", \"/var/log/sentrypeer/sentrypeer.json\"]\n\n"
}