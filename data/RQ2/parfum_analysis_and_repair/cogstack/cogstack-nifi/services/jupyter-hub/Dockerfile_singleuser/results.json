{
  "startTime": 1674251881685,
  "endTime": 1674251883476,
  "originalSmells": [
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 90,
        "lineEnd": 90,
        "columnStart": 4,
        "columnEnd": 58
      }
    },
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 91,
        "lineEnd": 91,
        "columnStart": 4,
        "columnEnd": 114
      }
    },
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 92,
        "lineEnd": 92,
        "columnStart": 4,
        "columnEnd": 115
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 116,
        "lineEnd": 116,
        "columnStart": 4,
        "columnEnd": 30
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 117,
        "lineEnd": 117,
        "columnStart": 4,
        "columnEnd": 44
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 120,
        "lineEnd": 120,
        "columnStart": 4,
        "columnEnd": 91
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 121,
        "lineEnd": 121,
        "columnStart": 4,
        "columnEnd": 115
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 122,
        "lineEnd": 122,
        "columnStart": 4,
        "columnEnd": 190
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 123,
        "lineEnd": 123,
        "columnStart": 4,
        "columnEnd": 132
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 126,
        "lineEnd": 126,
        "columnStart": 4,
        "columnEnd": 158
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 127,
        "lineEnd": 127,
        "columnStart": 4,
        "columnEnd": 149
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 128,
        "lineEnd": 128,
        "columnStart": 4,
        "columnEnd": 96
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 131,
        "lineEnd": 131,
        "columnStart": 4,
        "columnEnd": 21
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 134,
        "lineEnd": 134,
        "columnStart": 4,
        "columnEnd": 43
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 136,
        "lineEnd": 136,
        "columnStart": 4,
        "columnEnd": 111
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 137,
        "lineEnd": 137,
        "columnStart": 4,
        "columnEnd": 111
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 22,
        "lineEnd": 22,
        "columnStart": 5,
        "columnEnd": 50
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 48,
        "lineEnd": 85,
        "columnStart": 4,
        "columnEnd": 10
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 97,
        "lineEnd": 97,
        "columnStart": 4,
        "columnEnd": 48
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 98,
        "lineEnd": 98,
        "columnStart": 4,
        "columnEnd": 50
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 96,
        "lineEnd": 96,
        "columnStart": 4,
        "columnEnd": 77
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 97,
        "lineEnd": 97,
        "columnStart": 4,
        "columnEnd": 48
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 98,
        "lineEnd": 98,
        "columnStart": 4,
        "columnEnd": 50
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 113,
        "lineEnd": 113,
        "columnStart": 4,
        "columnEnd": 72
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 22,
        "lineEnd": 22,
        "columnStart": 5,
        "columnEnd": 50
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 48,
        "lineEnd": 85,
        "columnStart": 4,
        "columnEnd": 10
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 96,
        "lineEnd": 96,
        "columnStart": 4,
        "columnEnd": 77
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 97,
        "lineEnd": 97,
        "columnStart": 4,
        "columnEnd": 48
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 98,
        "lineEnd": 98,
        "columnStart": 4,
        "columnEnd": 50
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 113,
        "lineEnd": 113,
        "columnStart": 4,
        "columnEnd": 72
      }
    }
  ],
  "repairedSmells": [
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 96,
        "lineEnd": 96,
        "columnStart": 4,
        "columnEnd": 77
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 97,
        "lineEnd": 97,
        "columnStart": 4,
        "columnEnd": 72
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 98,
        "lineEnd": 98,
        "columnStart": 4,
        "columnEnd": 74
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 113,
        "lineEnd": 113,
        "columnStart": 4,
        "columnEnd": 72
      }
    }
  ],
  "repairedDockerfile": "FROM jupyterhub/singleuser:main\n\nARG HTTP_PROXY\nARG HTTPS_PROXY\nARG NO_PROXY\nARG http_proxy\nARG https_proxy\nARG no_proxy\n\nENV HTTP_PROXY=$HTTP_PROXY\nENV HTTPS_PROXY=$HTTPS_PROXY\nENV NO_PROXY=$NO_PROXY\nENV http_proxy=$HTTP_PROXY\nENV https_proxy=$HTTPS_PROXY\nENV no_proxy=$NO_PROXY\n\nENV DEBIAN_FRONTEND=noninteractive\nENV DEBIAN_PRIORITY=critical\n\nUSER root\n\nRUN apt-get update && apt-get upgrade -y && \\\n     apt-get install --no-install-recommends -y software-properties-common && rm -rf /var/lib/apt/lists/*;\n\n# add extra repos\nRUN apt-add-repository multiverse && \\\n    apt-add-repository universe && \\\n    add-apt-repository ppa:graphics-drivers/ppa && \\\n    apt-get update && apt-get upgrade -y\n\n# Add latest ubuntu repos to sources.list\nRUN echo \"deb http://archive.ubuntu.com/ubuntu/ jammy main restricted universe multiverse\" | tee -a /etc/apt/sources.list\nRUN echo \"deb-src http://archive.ubuntu.com/ubuntu/ jammy main restricted universe multiverse\" | tee -a /etc/apt/sources.list\nRUN echo \"deb http://archive.ubuntu.com/ubuntu/ jammy-security main restricted universe multiverse\" | tee -a /etc/apt/sources.list\nRUN echo \"deb-src http://archive.ubuntu.com/ubuntu/ jammy-security main restricted universe multiverse\" | tee -a /etc/apt/sources.list\nRUN echo \"deb http://archive.ubuntu.com/ubuntu/ jammy-backports main restricted universe multiverse\" | tee -a /etc/apt/sources.list\nRUN echo \"deb-src http://archive.ubuntu.com/ubuntu/ jammy-backports main restricted universe multiverse\" | tee -a /etc/apt/sources.list\nRUN echo \"deb http://archive.canonical.com/ubuntu/ jammy partner\" | tee -a /etc/apt/sources.list\nRUN echo \"deb-src http://archive.canonical.com/ubuntu/ jammy partner\" | tee -a /etc/apt/sources.list\n\n# remove newer python version, freeze other versions for max compatibility before updates\n# RUN apt-mark hold python3.10 python3.9 python3.8 python3 python3-gi python3-dev python3-distutils python3-lib2to3\nRUN apt-get purge --auto-remove python3.10\n\n# run updates\nRUN apt-get update && apt-get upgrade -y && \\\n    apt-get --force-yes -o Dpkg::Options::=\"--force-confold\" --force-yes -o Dpkg::Options::=\"--force-confdef\" -fuy full-upgrade && \\\n    apt-get autoremove -y && \\\n    apt-get install --no-install-recommends -y \\\n    gnupg \\\n    ssl-cert \\\n    libevent-dev \\\n    python-dev \\\n    python3-dev \\\n    python3.9-dev \\\n    python3-all-dev \\\n    python3-pip \\\n    libxml2-dev \\\n    libbz2-dev \\\n    libxslt1-dev \\\n    zlib1g-dev \\\n    libssl-dev \\\n    wget \\\n    curl \\\n    gnupg-agent \\\n    dirmngr \\\n    ca-certificates \\\n    apt-transport-https \\\n    apt-utils \\\n    fonts-dejavu \\\n    nano \\\n    iputils-ping \\\n    build-essential \\\n    unixodbc \\\n    unixodbc-dev \\\n    r-cran-rodbc \\\n    gfortran \\\n    gcc \\\n    g++ \\\n    git \\\n    ssh \\\n    jq \\\n    htop \\\n    libgl1-mesa-glx libegl1-mesa libxrandr2 libxrandr2 libxss1 \\\n    libxcursor1 libxcomposite1 libasound2 libxi6 libxtst6 \\\n    r-base && rm -rf /var/lib/apt/lists/*;\n\nRUN apt-get update && apt-get upgrade -y\n\n# Microsoft repos\nRUN curl -f https://packages.microsoft.com/keys/microsoft.asc | apt-key add -\nRUN curl -f https://packages.microsoft.com/config/ubuntu/21.04/prod.list > /etc/apt/sources.list.d/mssql-release.list\nRUN curl -f https://packages.microsoft.com/config/ubuntu/22.04/prod.list >> /etc/apt/sources.list.d/mssql-release.list\n\n# install remaining packages\nRUN apt-get update && apt-get upgrade -y\nRUN apt-get -y --no-install-recommends install unixodbc unixodbc-dev odbcinst && rm -rf /var/lib/apt/lists/*;\nRUN ACCEPT_EULA=Y apt-get --no-install-recommends install -y msodbcsql18 && rm -rf /var/lib/apt/lists/*;\nRUN ACCEPT_EULA=Y apt-get --no-install-recommends install -y mssql-tools18 && rm -rf /var/lib/apt/lists/*;\nRUN echo 'export PATH=\"$PATH:/opt/mssql-tools18/bin\"' >> ~/.bashrc\n\nRUN conda update conda\nRUN conda install --quiet --yes \\\n    elasticsearch \\\n    psycopg2 \\\n    pyodbc \\\n    pymssql\n\nRUN conda clean --all -f -y\n\nRUN fix-permissions $CONDA_DIR && fix-permissions /home/$NB_USER\n\n# deps for psycopg2\nRUN apt-get install -y postgresql-server-dev-all --no-install-recommends && rm -rf /var/lib/apt/lists/*;\n\n# update pip and install basic utilities\nRUN pip3 install --no-cache-dir --upgrade pip\nRUN pip3 install --no-cache-dir setuptools wheel virtualenv\n\n# jupyterhub stuff\nRUN pip3 install --no-cache-dir ipywidgets jupyter jupyterhub jupyterlab jupyterlab-git importlib_metadata\nRUN pip3 install --no-cache-dir jupyterlab_widgets jupyter_contrib_core jupyter_contrib_nbextensions jupyter-server-proxy fastbook\nRUN pip3 install --no-cache-dir docker docker-compose dockerspawner jupyterhub-firstuseauthenticator jupyterhub-systemdspawner jupyterhub-jwtauthenticator jupyterhub-client jupyterhub-kerberosauthenticator\nRUN pip3 install --no-cache-dir jupyterhub-nanowireauthenticator jupyterhub-ldapauthenticator jupyterhub-kubespawner jupyterhub-nativeauthenticator\n\n# extra packages for DB connections & utilities (charts, data formats, and other useful tools such as neo4j)\nRUN pip3 install --no-cache-dir pytesseract ipyparallel py7zr cython isort html2text jsoncsv simplejson detect wheel nltk keras bokeh seaborn matplotlib graphviz plotly tqdm\nRUN pip3 install --no-cache-dir pymssql mysql-connector-python cx-Oracle dataclasses numpy matplotlib pandas dill jsonpickle jsonext psycopg2 psycopg2-binary pyodbc\nRUN pip3 install --no-cache-dir dvc flask GitPython elasticsearch opensearch-py neo4j --ignore-installed PyYAML\n\n# XNAT\nRUN pip3 install --no-cache-dir xnat\n\n# medcat & models\nRUN pip3 install --no-cache-dir -U spacy click torch thinc\n# RUN python3 -m spacy download en_core_web_md\nRUN pip3 install --no-cache-dir https://s3-us-west-2.amazonaws.com/ai2-s2-scispacy/releases/v0.4.0/en_core_sci_md-0.4.0.tar.gz && \\\n    pip3 install --no-cache-dir https://s3-us-west-2.amazonaws.com/ai2-s2-scispacy/releases/v0.4.0/en_core_sci_lg-0.4.0.tar.gz\n\n# RUN pip3 install medcat\n\n# install R and other dependencies\nCOPY r_kernel_install.sh /etc/jupyterhub/\nRUN Rscript /etc/jupyterhub/r_kernel_install.sh\n\n# create jupyterhub shared folder\nRUN mkdir -p /home/jovyan/scratch\nRUN chmod -R 777 /home/jovyan/scratch\nRUN chmod g+s /home/jovyan/scratch\nRUN chmod 0777 /home/jovyan/scratch\n\n# copy scripts and config files\nCOPY config/jupyter_notebook_config.py /home/jovyan/.jupyter/\n\n# copy notebooks\nCOPY notebooks /home/jovyan/work/\n\n# clean up\nRUN apt-get autoremove -y\n\nWORKDIR /home/jovyan\nUSER jovyan\n\n# Configure container startup\nENTRYPOINT [\"tini\", \"-g\", \"--\"]\n\nCMD [\"jupyterhub-singleuser\"]"
}