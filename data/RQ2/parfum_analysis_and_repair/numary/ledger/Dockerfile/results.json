{
  "startTime": 1674255903423,
  "endTime": 1674255904390,
  "originalSmells": [
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 2,
        "lineEnd": 2,
        "columnStart": 4,
        "columnEnd": 65
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 30,
        "lineEnd": 30,
        "columnStart": 18,
        "columnEnd": 48
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 2,
        "lineEnd": 2,
        "columnStart": 4,
        "columnEnd": 65
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "FROM --platform=$BUILDPLATFORM golang:1.18 AS builder\nRUN apt-get update && \\\n    apt-get install --no-install-recommends -y gcc-aarch64-linux-gnu gcc-x86-64-linux-gnu && \\\n    ln -s /usr/bin/aarch64-linux-gnu-gcc /usr/bin/arm64-linux-gnu-gcc && \\\n    ln -s /usr/bin/x86_64-linux-gnu-gcc /usr/bin/amd64-linux-gnu-gcc && rm -rf /var/lib/apt/lists/*;\n# 1. Precompile the entire go standard library into the first Docker cache layer: useful for other projects too!\nRUN CGO_ENABLED=1 GOOS=linux go install -v -installsuffix cgo -a std\nARG TARGETARCH\nARG APP_SHA\nARG VERSION\nARG SEGMENT_WRITE_KEY\nWORKDIR /go/src/github.com/numary/ledger\n# get deps first so it's cached\nCOPY go.mod .\nCOPY go.sum .\nRUN --mount=type=cache,id=gomod,target=/go/pkg/mod \\\n    --mount=type=cache,id=gobuild,target=/root/.cache/go-build \\\n    go mod download\nCOPY . .\nRUN --mount=type=cache,id=gomod,target=/go/pkg/mod \\\n    --mount=type=cache,id=gobuild,target=/root/.cache/go-build \\\n    CGO_ENABLED=1 GOOS=linux GOARCH=$TARGETARCH \\\n    CC=$TARGETARCH-linux-gnu-gcc \\\n    go build -o numary -tags json1 \\\n    -ldflags=\"-X github.com/numary/ledger/cmd.Version=${VERSION} \\\n    -X github.com/numary/ledger/cmd.BuildDate=$(date +%s) \\\n    -X github.com/numary/ledger/cmd.Commit=${APP_SHA} \\\n    -X github.com/numary/ledger/cmd.DefaultSegmentWriteKey=${SEGMENT_WRITE_KEY}\" ./\n\nFROM ubuntu:jammy\nRUN apt update && apt install --no-install-recommends -y ca-certificates && rm -rf /var/lib/apt/lists/*\nCOPY --from=builder /go/src/github.com/numary/ledger/numary /usr/local/bin/numary\nEXPOSE 3068\nCMD [\"numary\", \"server\", \"start\"]\n"
}