{
  "startTime": 1674247875596,
  "endTime": 1674247877141,
  "originalSmells": [
    {
      "rule": "wgetUseHttpsUrl",
      "position": {
        "lineStart": 60,
        "lineEnd": 60,
        "columnStart": 7,
        "columnEnd": 136
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "FROM maven:3.5.3-jdk-8-alpine\n\n# metadata\nLABEL module.maintainer=\"onesaitplatform@indra.es\" \\\n\t  module.name=\"controlpanel\"\n\nADD *-exec.jar app.jar\n\n# Timezone\nRUN apk add --no-cache tzdata\n\n# web projects folder & logs folder\nRUN mkdir -p /usr/local/webprojects && \\\n\tmkdir -p /usr/local/themes && \\\n    mkdir -p /usr/local/files && \\\n\tmkdir -p /var/log/platform-logs && \\\n\tmkdir /application\n\n\nWORKDIR /application\nRUN unzip /app.jar &&\\\n\trm /app.jar\n\n# create sofia user/group\nRUN addgroup -S onesait -g 433 && adduser -u 431 -S -g onesait -h /usr/local -s /sbin/nologin onesait\n\n# Install git\nRUN apk update && apk upgrade && \\\n    apk add --no-cache bash git openssh\n\nRUN chown -R onesait:onesait /usr/local && \\\n    chown -R onesait:onesait /usr/share/maven && \\\n    chown -R onesait:onesait /var/log/platform-logs && \\\n    chown -R onesait:onesait /application && \\\n    chmod -R 777 /var/log && \\\n    chmod -R 777 /usr/local &&\\\n    chmod -R 777 /application &&\\\n    chmod -R 777 /etc/ssl/certs/java\n\n# libc6-compat package for GNU libc compatibility\n# needed for execute ocp binary\nENV BOWTIE2_VERSION 2.2.8\nENV ASPECTJ_VERSION 1.8.9\n\nRUN apk add --no-cache \\\n        bash \\\n        perl \\\n        wget \\\n        openssl \\\n        ca-certificates \\\n        libc6-compat \\\n        libstdc++ \\\n        nss \\\n        fontconfig \\\n        ttf-dejavu \\\n    && wget https://downloads.sourceforge.net/project/bowtie-bio/bowtie2/$BOWTIE2_VERSION/bowtie2-$BOWTIE2_VERSION-linux-x86_64.zip \\\n    && unzip -d /usr/local bowtie2-$BOWTIE2_VERSION-linux-x86_64.zip \\\n    && rm bowtie2-$BOWTIE2_VERSION-linux-x86_64.zip\n\nRUN cd /tmp/ \\\n    && wget 'https://download.oracle.com/otn-pub/java/jce/8/jce_policy-8.zip' --header \"Cookie: oraclelicense=accept-securebackup-cookie\" \\\n    && unzip jce_policy-8.zip \\\n    && yes |cp -v /tmp/UnlimitedJCEPolicyJDK8/*.jar /usr/lib/jvm/java-1.8-openjdk/jre/lib/security \\\n    && rm jce_policy-8.zip \\\n    && cd /usr/local \\\n    && wget https://repo1.maven.org/maven2/org/aspectj/aspectjweaver/$ASPECTJ_VERSION/aspectjweaver-$ASPECTJ_VERSION.jar\n\n\nVOLUME [\"/tmp\", \"/usr/local/webprojects\", \"/var/log/platform-logs\", \"/usr/local/themes\"]\n\n\nUSER onesait\n\nEXPOSE 18000 5701\n\n#HZ_SERVICE_DISCOVERY_STRATEGY can take values: service or zookeeper\n\nENV JAVA_OPTS=\"$JAVA_OPTS -Xms1G -Xmx3G -javaagent:/usr/local/aspectjweaver-$ASPECTJ_VERSION.jar\" \\\n    SERVER_NAME=localhost \\\n    KAFKAENABLED=false \\\n    KAFKABROKERS=none \\\n    KAFKAHOST=kafka \\\n    KAFKAPORT=9095 \\\n    REALTIMEDBSERVERS=realtimedb:27017 \\\n    REALTIMEDBAUTHDB=admin \\\n\tREALTIMEDBUSEAUTH=true \\\n  \tREALTIMEDBUSER=platformadmin \\\n\tREALTIMEDBPASS=ENC(GGpZ1sLYnXwK+vz2QLkI/VK7geKcdM4pZaTL6hv6QTk=) \\\n    REALTIMEDBWRITECONCERN=UNACKNOWLEDGED \\\n\tCONFIGDBMASTERURL=\"jdbc:mysql://configdb:3306/onesaitplatform_master_config?useUnicode=true&characterEncoding=UTF-8&allowMultiQueries=true&useSSL=false&autoReconnect=true\" \\\n\tCONFIGDBURL=\"jdbc:mysql://configdb:3306/onesaitplatform_config?useUnicode=true&characterEncoding=UTF-8&allowMultiQueries=true&useSSL=false&autoReconnect=true&nullDatabaseMeansCurrent=true\" \\\n\tSCHEDULERDBBURL=\"jdbc:mysql://configdb:3306/onesaitplatform_scheduler?useUnicode=true&characterEncoding=UTF-8&allowMultiQueries=true&useSSL=false&autoReconnect=true&nullDatabaseMeansCurrent=true\" \\\n\tCONFIGDBUSER=root \\\n\tCONFIGDBPASS=changeIt! \\\n    CONFIGDB_MAX_ACTIVE=2 \\\n    CONFIGDB_MAX_IDLE=2 \\\n    JDBCPROTOCOL=\"jdbc:mysql:\" \\\n    DBADDPROPS=\"\" \\\n    AUDITGLOBALNOTIFY=true \\\n    QUASARHOST=quasar \\\n    QUASARPORT=10800 \\\n    BURROWHOST=burrow \\\n    BURROWPORT=18400 \\\n    FLOW_DOMAIN_MIN_PORT=28000 \\\n    FLOW_DOMAIN_MAX_PORT=28500 \\\n    KSQLSERVER=http://streamingflowengineservice:20200 \\\n    KSQLENABLE=false \\\n    ENABLEHADOOP=false \\\n\tHDFSURL=hdfs://127.0.0.1:8020 \\\n\tHDFSPATH=/user/hdfs \\\n\tHIVEURL=jdbc:hive2://localhost:10000/default \\\n\tHIVEUSERNAME=cloudera-scm \\\n\tHIVEPASSWORD=cloudera-scm \\\n\tHIVEDRIVERCLASS=org.apache.hive.jdbc.HiveDriver \\\n\tIMPALAURL=jdbc:hive2://localhost:21050/default;auth=noSasl \\\n\tKUDUNUMREPLICAS=1 \\\n\tKUDUURL=localhost:7051 \\\n\tINCLUDEKUDUTABLENAME=false \\\n\tCAPTCHA_ON=false \\\n\tCAPTCHA_TOKEN=6Lc40JkUAAAAANyTpMrn9JNwKsiNRCY0bZ32cWIh \\\n\tCSRF_ON=true \\\n    HZ_SERVICE_DISCOVERY_STRATEGY=service \\\n    HZ_ZOOKEEPER_URL=zookeeper:2181 \\\n    CLOUD_GATEWAY=https://development.onesaitplatform.com \\\n    REALTIMEDBNAME=onesaitplatform_rtdb \\\n    AUTH_PROVIDER=configdb \\\n    CAS_ATT_MAIL=mail \\\n    CAS_ATT_NAME=name \\\n    CAS_MAIL_SUFFIX=onesaitplatform.com \\\n    LDAP_URL=\"\" \\\n    LDAP_BASE_DN=OU=\"\" \\\n    LDAP_ADMIN_DN=\"\" \\\n    LDAP_ADMIN_PASSWORD=\"\" \\\n    LDAP_DEFAULT_ROLE=ROLE_USER \\\n    LDAP_USERID_ATT=sAMAccountName \\\n    LDAP_MAIL_ATT=mail \\\n    LDAP_CN_ATT=cn \\\n    LDAP_IGNORE_PARTIAL_RESULT=false \\\n    LDAP_ADMINISTRATOR_DN=\"\" \\\n    LDAP_ANALYTICS_DN=\"\" \\\n    LDAP_DEVELOPER_DN=\"\" \\\n    LDAP_DATAVIEWER_DN=\"\" \\\n    LDAP_DEVOPS_DN=\"\" \\\n    LDAP_OPERATIONS_DN=\"\" \\\n    LDAP_PARTNER_DN=\"\" \\\n    LDAP_PLATFORM_ADMIN_DN=\"\" \\\n    LDAP_SYS_ADMIN_DN=\"\" \\\n    LDAP_USER_DN=\"\" \\\n    LDAP_GROUP_OF_NAMES_ATT=\"\" \\\n    LDAP_ROLES_MEMBER_ATT=\"\" \\\n    LDAP_ADMIN_WHITELIST=administrator,admin \\\n    JKS_URI=saml.jks \\\n    JKS_PASS=pass \\\n    KEY_ALIAS=pass \\\n    KEY_PASS=keypass \\\n    AD_ADMIN_USERID=administrator \\\n    IDP_METADATA=url.xml \\\n    ENTITY_ID=entityid \\\n    ENTITY_URL=https://${SERVER_NAME} \\\n    SAML_SCHEME=https \\\n    SAML_SERVER_NAME=localhost \\\n    SAML_INCLUDE_PORT=false \\\n    SAML_UNAUTHORIZED_URL=https://unauthorized.axpoiberia.es/ \\\n    STREAMSETS_SDC_VERSION=3.10.0 \\\n    TWOFA_ENABLED=false \\\n    CONFIGDB_ACL_ENABLED=false \\\n    CONFIGDB_ACL_LIST=administrator,analytics,dataviewer,demo_developer,demo_user,developer,operations,partner,sysadmin,user \\\n    DS_TIME_BETWEEN_EVICTION_RUNS_MILLIS=10000 \\\n    DS_MIN_EVICTABLE_IDLE_TIME_MILLIS=180000 \\\n    DS_MAX_WAIT_MILLIS=10000 \\\n    DS_MAX_WAIT=10000 \\\n    DS_INITIAL_SIZE=10 \\\n    DS_MAX_ACTIVE=30 \\\n    DS_MAX_IDLE=5 \\\n    DS_MIN_IDLE=5 \\\n    DS_REMOVE_ABANDONED=true \\\n    DS_REMOVE_ABANDONED_TIMEOUT=60 \\\n    ENABLE_METRICS=true \\\n    HTTP_MAX_FILE_SIZE=200Mb \\\n    HTTP_MAX_REQUEST_SIZE=200Mb \\\n    DYNAMIC_LOADBALANCER_ENABLED=false \\\n    DYNAMIC_LOADBALANCER_ENDPOINT=http://localhost:8000/nginx \\\n    QUERY_TOOL_ALLOWED_OPERATIONS=false \\\n    MAIL_PROXY_HOST=localhost \\\n    MAIL_PROXY_PORT=8080 \\\n    MULTITENANCY_ENABLED=false \\\n    MAIL_PROXY_HOST=localhost \\\n    MAIL_PROXY_PORT=8080 \\\n    RESTPLANNER_CHECKSSL=false \\\n    MAIL_PROXY_HOST=localhost \\\n    MAIL_PROXY_PORT=8080 \\\n    SPLASH_ON=false \\\n    SPLASH_EVERYXHOURS=24 \\\n    ELASTICSEARCH_ENABLED=false \\\n    NOTEBOOKPLATFORMAUTH=false \\\n    X509_ID_ATT=SERIALNUMBER \\\n    X509_ID_REGEX=(.*?)(?:,|$) \\\n    X509_CN_REGEX=CN=\\\"(.*?)(?:\\\"|$) \\\n    X509_ADMIN_ID=51503283G \\\n    X509_HASH_ID=false \\\n    SECURE_XFRAMEOPTIONS=true \\\n    ENCRYPTION_KEY=ENC(VYVseIUh5xiRd8ws0prbEAg6bGq7vmbfi3gkM65HECy+YPbjz4f49w==) \\\n    ENCRYPTION_ITERATIONS=5 \\\n    JWT_KEY=ENC(BXYVNNRDiawMsH4sY79FUPig6FWPGbcoMusSVrXXb6ZLtZ4qhIEUazqv6XrcRm39s8zEu2d1G8yTowyE/sEv7YF0vrLNdb1m) \\\n    JWT_CLIENT_SECRET=ENC(siZm4DUe6Y1FkxoUH7y0oUCiGDIq/vRX) \\\n    OAUTH_SSO_ENABLED=false \\\n    USE_KEYCLOAK=false \\\n    GRAYLOG_ENABLED=false \\\n    GRAYLOG_HOST=log-centralizer \\\n    GRAYLOG_PORT=12201 \\\n    CORS_ALLOWED_URLS=\"*\" \\\n\tINTERNAL_SSL=false \\\n\tEDGE_SERVER_NAME=iothub02.onesaitplatform.com \\\n\tSBA_USERNAME=operations \\\n\tSBA_SECRET=ENC(2Xd2AOD2NrMaWs915/st8C4ILo3qlHXv)\n\nCOPY docker-entrypoint.sh /usr/local/bin/\nENTRYPOINT [\"docker-entrypoint.sh\"]\n\n#ENTRYPOINT java $JAVA_OPTS -Dspring.application.json=$ONESAIT_PROPERTIES -Djava.security.egd=file:/dev/./urandom -Dspring.profiles.active=docker -Dloader.path=file:/usr/local/themes/ -Djava.awt.headless=true -jar /app.jar\n"
}