{
  "startTime": 1674256279692,
  "endTime": 1674256280880,
  "originalSmells": [
    {
      "rule": "npmCacheCleanAfterInstall",
      "position": {
        "lineStart": 56,
        "lineEnd": 56,
        "columnStart": 7,
        "columnEnd": 51
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "# Git: git version 2.30.2\n# gcc: 10.3.1 20210424\n# Node: 14.17.5 LTS, npm: 6.14.14, yarn: 1.22.5, herd: 1.1.11\n# /etc/os-release: Alpine Linux v3.14\n# Kernel(uname -a): Linux 55f39d8cbcc0 5.10.47-linuxkit Sat Jul 3 21:51:47 2021 x86_64\n# Build cmd: docker build . -t terminus/alpine-node.14-herd.1.1.11\n# Other tags: terminus/alpine-herd:1.1.11-n14.17,terminus/alpine-herd:1.1.11\n# Notice: 由于Alpine使用musl libc而不是glibc，而大多数流行的发行版使用后者，\n#         为了避免兼容性问题现阶段不建议在Alpine里面构建或者部署Node应用\nFROM node:14.17.5-alpine3.14\n\nLABEL maintainer=hustcer<majun@terminus.io>\n\nENV LANG=en_US.UTF-8\nENV NODEJS_ORG_MIRROR=\"https://npmmirror.com/dist\"\nENV SASS_BINARY_SITE=\"https://npmmirror.com/mirrors/node-sass\"\n\n# Use aliyun repo to speed up installation\n# Testing repo: https://mirrors.aliyun.com/alpine/edge/testing/\nRUN echo \"https://mirrors.aliyun.com/alpine/v3.14/main/\" > /etc/apk/repositories \\\n    && echo \"https://mirrors.aliyun.com/alpine/v3.14/community/\" >> /etc/apk/repositories \\\n    && apk update \\\n    && apk upgrade \\\n    && apk add --no-cache tzdata \\\n    && cp /usr/share/zoneinfo/Asia/Shanghai /etc/localtime \\\n    && echo \"Asia/Shanghai\" > /etc/timezone\n\n# Use terminus npm registry\nRUN npm config set @terminus:registry https://registry.npm.terminus.io/ \\\n    && npm config set registry https://registry.npmmirror.com/ \\\n    && apk add --no-cache busybox-extras bash \\\n       # Dev related: install libstdc++ libc6-compat, etc. to fix node-canvas related issue\n       # build-base will install: binutils, gcc, g++, make, patch, etc.\n       build-base libstdc++ libc6-compat cairo-dev jpeg-dev pango-dev giflib-dev \\\n       vim git git-subtree python2 \\\n       # Fix: Error loading shared library libuuid.so.1\n       libuuid \\\n       # Fix: Fontconfig error: Cannot load default config file\n       fontconfig \\\n       # Network related utils\n       curl tcpdump ca-certificates \\\n       # SEE: https://github.com/BurntSushi/ripgrep\n       # SEE: https://github.com/sharkdp/fd#installation\n       tree fd htop ripgrep \\\n    # Fix: Error loading shared library ld-linux-x86-64.so.2: No such file or directory\n    && ln -s /lib/libc.musl-x86_64.so.1 /lib/ld-linux-x86-64.so.2 \\\n    # Fix: Error loading shared library libresolv.so.2\n    && ln -s /lib/libc.so.6 /usr/lib/libresolv.so.2 \\\n    # Change default shell from ash to bash\n    && sed -i -e \"s/bin\\/ash/bin\\/bash/\" /etc/passwd \\\n    # Setup root alias\n    && echo \"alias vi='vim'\" >> /root/.bashrc \\\n    && echo \"alias ..='cd ..'\" >> /root/.bashrc \\\n    && echo \"alias ll='ls -l'\" >> /root/.bashrc \\\n    # Add --unsafe-perm to fix 'Error: EACCES: permission denied, mkdir...' issue while install node-sass\n    && npm i -g --unsafe-perm @terminus/herd@1.1.11 \\\n    && rm -rf /var/cache/apk/* \\\n    && echo \"\" > /root/.ash_history \\\n    # Add dice and erda user and create home dir, Don't assign a password\n    && adduser -h dice -Ds /bin/bash dice \\\n    && adduser -h erda -Ds /bin/bash erda && npm cache clean --force;\n\nCMD [ \"herd\" ]\n"
}