{
  "startTime": 1674254115115,
  "endTime": 1674254115930,
  "originalSmells": [
    {
      "rule": "wgetUseHttpsUrl",
      "position": {
        "lineStart": 62,
        "lineEnd": 62,
        "columnStart": 4,
        "columnEnd": 168
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "FROM maven:3-jdk-11 AS client_build\n\nCOPY ./guacamole-auth-azure/pom.xml /pom.xml\nCOPY ./guacamole-auth-azure/src /src\nCOPY ./docker/maven_package_and_exit_succesfully.sh /tmp/\nRUN bash /tmp/maven_package_and_exit_succesfully.sh\n\nFROM scratch as test-results\nCOPY --from=client_build /target/surefire-reports/* /\n\nFROM guacamole/guacd:1.4.0\n\nARG GUACAMOLE_AZURE_VERSION=0.1.1\n\nENV DEBIAN_FRONTEND=noninteractive\n\n# https://github.com/microsoft/AzureTRE/issues/1937\n# hadolint ignore=DL3002\nUSER root\n\n# dependencies\n# hadolint ignore=DL3008\nRUN apt-get update && apt-get install wget curl openssh-server apt-transport-https gnupg -y --no-install-recommends && \\\n    apt-get autoclean && apt-get autoremove && rm -rf /var/lib/apt/lists/*\n\nENV JAVA_HOME=/usr/lib/jvm/java-11-openjdk-amd64\nRUN JAVA_ARCHIVE=java.tar.gz && \\\n    wget -O \"$JAVA_ARCHIVE\" \"https://github.com/adoptium/temurin11-binaries/releases/download/jdk-11.0.15%2B10/OpenJDK11U-jre_x64_linux_hotspot_11.0.15_10.tar.gz\" --progress=dot:giga && \\\n    mkdir -p \"$JAVA_HOME\" && \\\n    tar xzf \"$JAVA_ARCHIVE\" -C \"$JAVA_HOME\" --strip-components=1 && \\\n    rm -f \"$JAVA_ARCHIVE\" && \\\n    export PATH=\"$JAVA_HOME\"/bin:\"$PATH\" && java -version\n\nENV CATALINA_BASE=/usr/share/tomcat9/\nRUN TOMCAT_ARCHIVE=tomcat.tar.gz && \\\n    TOMCAT_VER=9.0.62 && \\\n    wget -O \"$TOMCAT_ARCHIVE\" -N \"https://archive.apache.org/dist/tomcat/tomcat-9/v${TOMCAT_VER}/bin/apache-tomcat-${TOMCAT_VER}.tar.gz\" --progress=dot:giga && \\\n    tar xzf \"$TOMCAT_ARCHIVE\" && \\\n    rm -f \"$TOMCAT_ARCHIVE\" && \\\n    mv apache-tomcat-${TOMCAT_VER}/ \"$CATALINA_BASE\"\n\nENV GUACAMOLE_HOME=/guacamole/\nENV GUACAMOLE_LIB=\"${GUACAMOLE_HOME}/lib/\"\nENV CLASSPATH=${GUACAMOLE_LIB}:${CLASSPATH}\n\nRUN mkdir /guac-transfer\n\nCOPY ./docker/guacamole/ ${GUACAMOLE_HOME}\n\nRUN S6_ARCHIVE=s6-overlay.tar.gz && \\\n    wget -O \"$S6_ARCHIVE\" \"https://github.com/just-containers/s6-overlay/releases/download/v2.2.0.3/s6-overlay-amd64.tar.gz\" --progress=dot:giga && \\\n    tar xzvf \"$S6_ARCHIVE\" -C / && \\\n    rm -f \"$S6_ARCHIVE\"\n\nCOPY ./docker/sshd_config /etc/ssh/\n\nCOPY ./docker/services /etc/services.d/\n\n# retrieve auth integration from build image\nCOPY --from=client_build /target/lib/* \"${GUACAMOLE_LIB}\"\nCOPY --from=client_build \"/target/guacamole-auth-tre-${GUACAMOLE_AZURE_VERSION}.jar\" \"${GUACAMOLE_HOME}/extensions/\"\n\nRUN wget -O \"${GUACAMOLE_HOME}/guacamole.war\" \"https://apache.org/dyn/closer.cgi?action=download&filename=guacamole/1.4.0/binary/guacamole-1.4.0.war\" --progress=dot:giga\n\nENV OAUTH2_PROXY_HOME=/etc/oauth2-proxy\nRUN OAUTH2_PROXY_ARCHIVE=oauth2-proxy.tar.gz && \\\n    wget -O \"$OAUTH2_PROXY_ARCHIVE\" \"https://github.com/oauth2-proxy/oauth2-proxy/releases/download/v7.2.1/oauth2-proxy-v7.2.1.linux-amd64.tar.gz\" --progress=dot:giga && \\\n    mkdir -p \"$OAUTH2_PROXY_HOME\" && \\\n    tar zxpf \"$OAUTH2_PROXY_ARCHIVE\" -C \"$OAUTH2_PROXY_HOME\" --strip-components=1 && \\\n    rm -f \"$OAUTH2_PROXY_ARCHIVE\"\n\nCOPY ./docker/index.jsp \"$CATALINA_BASE\"/webapps/ROOT/index.jsp\n\nENTRYPOINT [ \"/init\" ]\n\nEXPOSE 80 2222\n"
}