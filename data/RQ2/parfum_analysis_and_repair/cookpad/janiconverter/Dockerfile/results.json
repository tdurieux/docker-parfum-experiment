{
  "startTime": 1674248755447,
  "endTime": 1674248756738,
  "originalSmells": [
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 71,
        "lineEnd": 71,
        "columnStart": 4,
        "columnEnd": 69
      }
    },
    {
      "rule": "wgetUseHttpsUrl",
      "position": {
        "lineStart": 31,
        "lineEnd": 31,
        "columnStart": 229,
        "columnEnd": 292
      }
    },
    {
      "rule": "wgetUseHttpsUrl",
      "position": {
        "lineStart": 31,
        "lineEnd": 31,
        "columnStart": 293,
        "columnEnd": 362
      }
    },
    {
      "rule": "configureShouldUseBuildFlag",
      "position": {
        "lineStart": 34,
        "lineEnd": 34,
        "columnStart": 66,
        "columnEnd": 78
      }
    },
    {
      "rule": "configureShouldUseBuildFlag",
      "position": {
        "lineStart": 37,
        "lineEnd": 37,
        "columnStart": 28,
        "columnEnd": 56
      }
    },
    {
      "rule": "configureShouldUseBuildFlag",
      "position": {
        "lineStart": 40,
        "lineEnd": 40,
        "columnStart": 48,
        "columnEnd": 77
      }
    },
    {
      "rule": "configureShouldUseBuildFlag",
      "position": {
        "lineStart": 43,
        "lineEnd": 43,
        "columnStart": 30,
        "columnEnd": 61
      }
    },
    {
      "rule": "configureShouldUseBuildFlag",
      "position": {
        "lineStart": 46,
        "lineEnd": 46,
        "columnStart": 66,
        "columnEnd": 95
      }
    },
    {
      "rule": "configureShouldUseBuildFlag",
      "position": {
        "lineStart": 49,
        "lineEnd": 49,
        "columnStart": 30,
        "columnEnd": 236
      }
    },
    {
      "rule": "configureShouldUseBuildFlag",
      "position": {
        "lineStart": 74,
        "lineEnd": 74,
        "columnStart": 4,
        "columnEnd": 37
      }
    },
    {
      "rule": "gemUpdateSystemRmRootGem",
      "position": {
        "lineStart": 88,
        "lineEnd": 88,
        "columnStart": 4,
        "columnEnd": 23
      }
    },
    {
      "rule": "gemUpdateSystemRmRootGem",
      "position": {
        "lineStart": 89,
        "lineEnd": 89,
        "columnStart": 4,
        "columnEnd": 14
      }
    },
    {
      "rule": "tarSomethingRmTheSomething",
      "position": {
        "lineStart": 34,
        "lineEnd": 34,
        "columnStart": 23,
        "columnEnd": 50
      }
    },
    {
      "rule": "tarSomethingRmTheSomething",
      "position": {
        "lineStart": 46,
        "lineEnd": 46,
        "columnStart": 23,
        "columnEnd": 50
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 24,
        "lineEnd": 24,
        "columnStart": 4,
        "columnEnd": 61
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 28,
        "lineEnd": 28,
        "columnStart": 116,
        "columnEnd": 293
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 52,
        "lineEnd": 52,
        "columnStart": 4,
        "columnEnd": 34
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 56,
        "lineEnd": 56,
        "columnStart": 2,
        "columnEnd": 47
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 60,
        "lineEnd": 60,
        "columnStart": 2,
        "columnEnd": 27
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 63,
        "lineEnd": 70,
        "columnStart": 4,
        "columnEnd": 14
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 82,
        "lineEnd": 82,
        "columnStart": 4,
        "columnEnd": 41
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 85,
        "lineEnd": 85,
        "columnStart": 4,
        "columnEnd": 58
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 24,
        "lineEnd": 24,
        "columnStart": 4,
        "columnEnd": 61
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 52,
        "lineEnd": 52,
        "columnStart": 4,
        "columnEnd": 34
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 56,
        "lineEnd": 56,
        "columnStart": 2,
        "columnEnd": 47
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 63,
        "lineEnd": 70,
        "columnStart": 4,
        "columnEnd": 14
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 82,
        "lineEnd": 82,
        "columnStart": 4,
        "columnEnd": 41
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 85,
        "lineEnd": 85,
        "columnStart": 4,
        "columnEnd": 58
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 24,
        "lineEnd": 24,
        "columnStart": 4,
        "columnEnd": 61
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 28,
        "lineEnd": 28,
        "columnStart": 116,
        "columnEnd": 293
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 52,
        "lineEnd": 52,
        "columnStart": 4,
        "columnEnd": 34
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 56,
        "lineEnd": 56,
        "columnStart": 2,
        "columnEnd": 47
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 60,
        "lineEnd": 60,
        "columnStart": 2,
        "columnEnd": 27
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 63,
        "lineEnd": 70,
        "columnStart": 4,
        "columnEnd": 14
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 82,
        "lineEnd": 82,
        "columnStart": 4,
        "columnEnd": 41
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 85,
        "lineEnd": 85,
        "columnStart": 4,
        "columnEnd": 58
      }
    }
  ],
  "repairedSmells": [
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 24,
        "lineEnd": 24,
        "columnStart": 4,
        "columnEnd": 85
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 52,
        "lineEnd": 52,
        "columnStart": 4,
        "columnEnd": 58
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 56,
        "lineEnd": 56,
        "columnStart": 2,
        "columnEnd": 71
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 63,
        "lineEnd": 70,
        "columnStart": 4,
        "columnEnd": 14
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 82,
        "lineEnd": 82,
        "columnStart": 4,
        "columnEnd": 65
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 85,
        "lineEnd": 85,
        "columnStart": 4,
        "columnEnd": 82
      }
    }
  ],
  "repairedDockerfile": "# https://github.com/phusion/baseimage-docker\nFROM phusion/baseimage:0.9.15\nMAINTAINER Shinichi Ohno\n\n# Set correct environment variables.\n# ENV HOME /root\nENV DEBIAN_FRONTEND noninteractive\nENV PORT 8080\nENV RAILS_ENV production\n\n# Regenerate SSH host keys. baseimage-docker does not contain any, so you\n# have to do that yourself. You may also comment out this instruction; the\n# init system will auto-generate one during boot.\n# RUN /etc/my_init.d/00_regen_ssh_host_keys.sh\n\n# Use baseimage-docker's init system.\nCMD [\"/sbin/my_init\"]\n\n# basic settings\nRUN echo \"LANG=\\\"en_GB.UTF-8\\\"\" > /etc/default/locale\nRUN locale-gen en_GB.UTF-8\nRUN dpkg-reconfigure locales\n\nRUN apt-get update\nRUN apt-get install --no-install-recommends -y build-essential wget curl git git-core && rm -rf /var/lib/apt/lists/*;\n\n# ffmpeg\n## Enable Universe and Multiverse and install dependencies.\nRUN echo deb http://archive.ubuntu.com/ubuntu precise universe multiverse >> /etc/apt/sources.list; apt-get update; apt-get -y --no-install-recommends install autoconf automake build-essential libass-dev libgpac-dev libtheora-dev libtool libvdpau-dev libvorbis-dev pkg-config texi2html zlib1g-dev libmp3lame-dev wget; rm -rf /var/lib/apt/lists/*; apt-get clean\n\n## Fetch Sources\nRUN cd /usr/local/src; git clone http://git.videolan.org/git/x264.git; git clone https://github.com/mstorsjo/fdk-aac.git; git clone https://chromium.googlesource.com/webm/libvpx; git clone http://git.videolan.org/git/ffmpeg.git; wget https://downloads.xiph.org/releases/opus/opus-1.0.3.tar.gz; wget https://www.tortall.net/projects/yasm/releases/yasm-1.2.0.tar.gz;\n\n## Build YASM assembler.\nRUN cd /usr/local/src; tar xzvf yasm-1.2.0.tar.gz; rm yasm-1.2.0.tar.gz cd yasm-1.2.0; ./configure --build=\"$(dpkg-architecture --query DEB_BUILD_GNU_TYPE)\"; make -j 4; make install; make distclean;\n\n## Build libx264\nRUN cd /usr/local/src/x264; ./configure --build=\"$(dpkg-architecture --query DEB_BUILD_GNU_TYPE)\" --enable-static; make -j 4; make install; make distclean\n\n## Build libfdk-aac\nRUN cd /usr/local/src/fdk-aac; autoreconf -fiv; ./configure --build=\"$(dpkg-architecture --query DEB_BUILD_GNU_TYPE)\" --disable-shared; make -j 4; make install; make distclean\n\n## Build libvpx\nRUN cd /usr/local/src/libvpx; ./configure --build=\"$(dpkg-architecture --query DEB_BUILD_GNU_TYPE)\" --disable-examples; make -j 4; make install; make clean\n\n## Build libopus\nRUN cd /usr/local/src; tar zxvf opus-1.0.3.tar.gz; rm opus-1.0.3.tar.gz cd opus-1.0.3; ./configure --build=\"$(dpkg-architecture --query DEB_BUILD_GNU_TYPE)\" --disable-shared; make -j 4; make install; make distclean\n\n## Build ffmpeg.\nRUN cd /usr/local/src/ffmpeg; ./configure --build=\"$(dpkg-architecture --query DEB_BUILD_GNU_TYPE)\" --extra-libs=\"-ldl\" --enable-gpl --enable-libass --enable-libfdk-aac --enable-libmp3lame --enable-libopus --enable-libtheora --enable-libvorbis --enable-libvpx --enable-libx264 --enable-nonfree; make -j 4; make install; make distclean;\n\n# imagemagick\nRUN apt-get install --no-install-recommends -y imagemagick && rm -rf /var/lib/apt/lists/*;\n\n# Node.js & npm\nRUN \\\n  apt-get install --no-install-recommends -y software-properties-common && \\\n  apt-get update && \\\n  add-apt-repository -y ppa:chris-lea/node.js && \\\n  apt-get update && \\\n  apt-get install --no-install-recommends -y nodejs && rm -rf /var/lib/apt/lists/*;\n\n# ruby & gem dependencies\nRUN apt-get -y --no-install-recommends install \\\n    libcurl4-openssl-dev \\\n    libreadline-dev \\\n    libssl-dev \\\n    libxml2-dev \\\n    libxslt1-dev \\\n    libyaml-dev \\\n    zlib1g-dev && \\\n    curl -f -O http://cache.ruby-lang.org/pub/ruby/2.1/ruby-2.1.3.tar.gz && \\\n    tar -zxvf ruby-2.1.3.tar.gz && \\\n    cd ruby-2.1.3 && \\\n    ./configure --build=\"$(dpkg-architecture --query DEB_BUILD_GNU_TYPE)\" --disable-install-doc && \\\n    make -j 4 && \\\n    make install && \\\n    cd .. && \\\n    rm -r ruby-2.1.3 ruby-2.1.3.tar.gz && \\\n    echo 'gem: --no-document' > /usr/local/etc/gemrc && rm -rf /var/lib/apt/lists/*;\n\n# dependencies to install mysql2 gem\nRUN apt-get -y --no-install-recommends install libmysqlclient-dev && rm -rf /var/lib/apt/lists/*;\n\n# dependencies to install rmagick gem\nRUN apt-get -y --no-install-recommends install libmagickcore-dev libmagickwand-dev && rm -rf /var/lib/apt/lists/*;\n\nRUN echo 'gem: --no-rdoc --no-ri' >> /.gemrc\nRUN gem update --system && rm -rf /root/.gem;\nRUN gem update && rm -rf /root/.gem;\nRUN gem install bundler\nRUN gem install jani-strip_maker\n\n# Clean up APT when done.\nRUN apt-get clean && rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/*\nRUN hash -r\n\n## setup rails\nRUN mkdir /etc/service/puma\nADD docker/puma.sh /etc/service/puma/run\nRUN chmod +x /etc/service/puma/run\n\n## bundle install first to Cache gems\nWORKDIR /tmp\nADD Gemfile /tmp/Gemfile\nADD Gemfile.lock /tmp/Gemfile.lock\nRUN bundle install --without=\"development test\" -j 4\n\nADD . /app\nWORKDIR /app\nRUN cp config/redis.yml.sample config/redis.yml\nRUN cp config/secrets.yml.sample config/secrets.yml\nRUN cp config/storages.yml.sample config/storages.yml\nRUN mkdir -p tmp/pids\n# To create .bundle directory, run `bundle install`\nRUN bundle install --without=\"development test\" -j 4\nRUN bundle exec rake assets:precompile\n"
}