{
  "startTime": 1674220490347,
  "endTime": 1674220493062,
  "originalSmells": [
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 61,
        "lineEnd": 61,
        "columnStart": 4,
        "columnEnd": 30
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 62,
        "lineEnd": 62,
        "columnStart": 4,
        "columnEnd": 43
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 335,
        "lineEnd": 335,
        "columnStart": 4,
        "columnEnd": 43
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 336,
        "lineEnd": 336,
        "columnStart": 4,
        "columnEnd": 105
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 341,
        "lineEnd": 341,
        "columnStart": 4,
        "columnEnd": 33
      }
    },
    {
      "rule": "tarSomethingRmTheSomething",
      "position": {
        "lineStart": 77,
        "lineEnd": 77,
        "columnStart": 28,
        "columnEnd": 76
      }
    },
    {
      "rule": "gpgUseBatchFlag",
      "position": {
        "lineStart": 65,
        "lineEnd": 65,
        "columnStart": 6,
        "columnEnd": 21
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 69,
        "lineEnd": 70,
        "columnStart": 4,
        "columnEnd": 82
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 299,
        "lineEnd": 300,
        "columnStart": 8,
        "columnEnd": 26
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 303,
        "lineEnd": 304,
        "columnStart": 8,
        "columnEnd": 26
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "# Copyright 2018-2022, NVIDIA CORPORATION & AFFILIATES. All rights reserved.\n#\n# Redistribution and use in source and binary forms, with or without\n# modification, are permitted provided that the following conditions\n# are met:\n#  * Redistributions of source code must retain the above copyright\n#    notice, this list of conditions and the following disclaimer.\n#  * Redistributions in binary form must reproduce the above copyright\n#    notice, this list of conditions and the following disclaimer in the\n#    documentation and/or other materials provided with the distribution.\n#  * Neither the name of NVIDIA CORPORATION nor the names of its\n#    contributors may be used to endorse or promote products derived\n#    from this software without specific prior written permission.\n#\n# THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS ``AS IS'' AND ANY\n# EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n# IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR\n# PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE COPYRIGHT OWNER OR\n# CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,\n# EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,\n# PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR\n# PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY\n# OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n# (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n# OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n\nARG BASE_IMAGE=tritonserver\nARG CIBASE_IMAGE=tritonserver_cibase\nARG SDK_IMAGE=tritonserver_sdk\nARG TRITON_COMMON_REPO_TAG=main\nARG TRITON_CORE_REPO_TAG=main\nARG TRITON_THIRD_PARTY_REPO_TAG=main\nARG TRITON_BACKEND_REPO_TAG=main\nARG TRITONTMP_DIR=/tmp\n\n############################################################################\n## Test artifacts built as part of the tritonserver build are\n## available in CIBASE_IMAGE. Copy these artifacts into the QA area.\n############################################################################\nFROM ${CIBASE_IMAGE} AS cibase\n\nARG TRITONTMP_DIR\nARG TRITON_COMMON_REPO_TAG\nARG TRITON_CORE_REPO_TAG\nARG TRITON_THIRD_PARTY_REPO_TAG\nARG TRITON_BACKEND_REPO_TAG\n\n# Ensure apt-get won't prompt for selecting options\nENV DEBIAN_FRONTEND=noninteractive\n\nRUN apt-get update && \\\n    apt-get install -y --no-install-recommends \\\n            build-essential \\\n            libarchive-dev \\\n            libboost-dev \\\n            python3-dev \\\n            python3-pip \\\n            rapidjson-dev \\\n            software-properties-common && \\\n    rm -rf /var/lib/apt/lists/*\n\nRUN pip3 install --no-cache-dir --upgrade pip && \\\n    pip3 install --no-cache-dir --upgrade wheel setuptools\n\nRUN wget -O - https://apt.kitware.com/keys/kitware-archive-latest.asc 2>/dev/null | \\\n      gpg --batch --dearmor - | \\\n      tee /etc/apt/trusted.gpg.d/kitware.gpg >/dev/null && \\\n    apt-add-repository 'deb https://apt.kitware.com/ubuntu/ focal main' && \\\n    apt-get update && \\\n    apt-get install -y --no-install-recommends \\\n      cmake-data=3.21.1-0kitware1ubuntu20.04.1 cmake=3.21.1-0kitware1ubuntu20.04.1 && rm -rf /var/lib/apt/lists/*;\n\n# Add inception_graphdef model to example repo\nWORKDIR /workspace/docs/examples/model_repository\nRUN mkdir -p inception_graphdef/1 && \\\n    wget -O ${TRITONTMP_DIR}/inception_v3_2016_08_28_frozen.pb.tar.gz \\\n        https://storage.googleapis.com/download.tensorflow.org/models/inception_v3_2016_08_28_frozen.pb.tar.gz && \\\n    (cd ${TRITONTMP_DIR} && tar xzf inception_v3_2016_08_28_frozen.pb.tar.gz) && \\\n    mv ${TRITONTMP_DIR}/inception_v3_2016_08_28_frozen.pb inception_graphdef/1/model.graphdef && rm inception_v3_2016_08_28_frozen.pb.tar.gz\n\n# Update the qa/ directory with test executables, models, etc.\nWORKDIR /workspace\nRUN mkdir -p qa/common && \\\n    cp -r /workspace/src/test/models/repeat_int32 qa/L0_decoupled/models/ && \\\n    cp -r /workspace/src/test/models/square_int32 qa/L0_decoupled/models/ && \\\n    mkdir qa/L0_simple_example/models && \\\n    cp -r docs/examples/model_repository/simple qa/L0_simple_example/models/. && \\\n    mkdir qa/L0_simple_go_client/models && \\\n    cp -r docs/examples/model_repository/simple qa/L0_simple_go_client/models/. && \\\n    mkdir qa/L0_backend_release/simple_models && \\\n    cp -r docs/examples/model_repository/simple qa/L0_backend_release/simple_models/. && \\\n    mkdir qa/L0_simple_nodejs_client/models && \\\n    cp -r docs/examples/model_repository/simple qa/L0_simple_nodejs_client/models/. && \\\n    mkdir qa/L0_backend_release/simple_seq_models && \\\n    cp -r /workspace/docs/examples/model_repository/simple_sequence qa/L0_backend_release/simple_seq_models/. && \\\n    mkdir qa/L0_shared_memory/models && \\\n    cp -r docs/examples/model_repository/simple qa/L0_shared_memory/models/. && \\\n    mkdir qa/L0_cuda_shared_memory/models && \\\n    cp -r docs/examples/model_repository/simple qa/L0_cuda_shared_memory/models/. && \\\n    mkdir qa/L0_client_java/models && \\\n    cp -r docs/examples/model_repository/simple qa/L0_client_java/models && \\\n    mkdir qa/L0_grpc/models && \\\n    cp -r docs/examples/model_repository/simple qa/L0_grpc/models && \\\n    cp -r docs/examples/model_repository/simple_dyna_sequence qa/L0_grpc/models && \\\n    cp -r docs/examples/model_repository/simple_int8 qa/L0_grpc/models && \\\n    cp -r docs/examples/model_repository/simple_identity qa/L0_grpc/models && \\\n    cp -r docs/examples/model_repository/simple_sequence qa/L0_grpc/models && \\\n    cp -r docs/examples/model_repository/simple_string qa/L0_grpc/models && \\\n    cp -r docs/examples/model_repository/inception_graphdef qa/L0_grpc/models && \\\n    mkdir qa/L0_http/models && \\\n    cp -r docs/examples/model_repository/simple qa/L0_http/models && \\\n    cp -r docs/examples/model_repository/simple_dyna_sequence qa/L0_http/models && \\\n    cp -r docs/examples/model_repository/simple_identity qa/L0_http/models && \\\n    cp -r docs/examples/model_repository/simple_sequence qa/L0_http/models && \\\n    cp -r docs/examples/model_repository/simple_string qa/L0_http/models && \\\n    cp -r docs/examples/model_repository/inception_graphdef qa/L0_http/models && \\\n    mkdir qa/L0_https/models && \\\n    cp -r docs/examples/model_repository/simple qa/L0_https/models/. && \\\n    mkdir qa/L0_secure_grpc/models && \\\n    cp -r docs/examples/model_repository/simple qa/L0_secure_grpc/models/. && \\\n    cp bin/simple qa/L0_simple_lib/. && \\\n    cp bin/memory_alloc qa/L0_io/. && \\\n    cp bin/multi_server qa/L0_multi_server/. && \\\n    cp bin/memory_test qa/L0_memory/. && \\\n    cp bin/pinned_memory_manager_test qa/L0_memory/. && \\\n    cp bin/repo_agent_test qa/L0_triton_repo_agent/. && \\\n    cp lib/libtritonrepoagent_relocation.so qa/L0_triton_repo_agent/. && \\\n    mkdir qa/L0_query/models/query/1 && \\\n    cp tritonbuild/tritonserver/backends/query/libtriton_query.so qa/L0_query/models/query/1/. && \\\n    cp bin/query_test qa/L0_query/. && \\\n    cp bin/register_api_test qa/L0_register/. && \\\n    cp bin/async_work_queue_test qa/L0_async_work_queue/. && \\\n    cp tritonbuild/tritonserver/backends/implicit_state/libtriton_implicit_state.so \\\n       qa/L0_implicit_state/. && \\\n    mkdir qa/L0_data_compression/models && \\\n    cp -r docs/examples/model_repository/simple qa/L0_data_compression/models && \\\n    cp bin/data_compressor_test qa/L0_data_compression/. && \\\n    cp bin/metrics_api_test qa/L0_metrics/. && \\\n    cp bin/response_cache_test qa/L0_response_cache/. && \\\n    cp -r deploy/mlflow-triton-plugin qa/L0_mlflow/.\n\n# caffe2plan will not exist if the build was done without TensorRT enabled\nRUN if [ -f bin/caffe2plan ]; then \\\n       cp bin/caffe2plan qa/common/.; \\\n    fi\n\nRUN mkdir -p qa/L0_simple_ensemble/models/simple/1 && \\\n    cp docs/examples/model_repository/simple/1/model.graphdef \\\n        qa/L0_simple_ensemble/models/simple/1/. && \\\n    mkdir -p qa/L0_simple_ensemble/models/simple/2 && \\\n    cp docs/examples/model_repository/simple/1/model.graphdef \\\n        qa/L0_simple_ensemble/models/simple/2/. && \\\n    mkdir -p qa/L0_socket/models/simple/1 && \\\n    cp docs/examples/model_repository/simple/1/model.graphdef \\\n        qa/L0_socket/models/simple/1/.\n\nRUN mkdir -p qa/L0_backend_identity/models && \\\n    cp -r src/test/models/identity_fp32 qa/L0_backend_identity/models/. && \\\n    mkdir -p qa/L0_backend_identity/models/identity_fp32/1\n\nRUN mkdir -p qa/custom_models/custom_sequence_int32/1 && \\\n    cp tritonbuild/tritonserver/backends/sequence/libtriton_sequence.so \\\n        qa/custom_models/custom_sequence_int32/1/. && \\\n    mkdir -p qa/custom_models/custom_dyna_sequence_int32/1 && \\\n    cp tritonbuild/tritonserver/backends/dyna_sequence/libtriton_dyna_sequence.so \\\n        qa/custom_models/custom_dyna_sequence_int32/1/.\n\n# L0_lifecycle needs No-GPU build of identity backend.\nRUN cd tritonbuild/identity && \\\n    rm -rf install build && mkdir build && cd build && \\\n    cmake -DTRITON_ENABLE_GPU=OFF \\\n        -DCMAKE_INSTALL_PREFIX:PATH=/workspace/tritonbuild/identity/install \\\n        -DTRITON_COMMON_REPO_TAG:STRING=${TRITON_COMMON_REPO_TAG} \\\n        -DTRITON_CORE_REPO_TAG:STRING=${TRITON_CORE_REPO_TAG} \\\n        -DTRITON_THIRD_PARTY_REPO_TAG:STRING=${TRITON_THIRD_PARTY_REPO_TAG} \\\n        -DTRITON_BACKEND_REPO_TAG:STRING=${TRITON_BACKEND_REPO_TAG} .. && \\\n    make -j16 install\n\n# L0_backend_python test require triton_shm_monitor\nRUN cd tritonbuild/python && \\\n    rm -rf install build && mkdir build && cd build && \\\n    cmake -DCMAKE_INSTALL_PREFIX:PATH=/workspace/tritonbuild/python/install \\\n        -DTRITON_COMMON_REPO_TAG:STRING=${TRITON_COMMON_REPO_TAG} \\\n        -DTRITON_CORE_REPO_TAG:STRING=${TRITON_CORE_REPO_TAG} \\\n        -DTRITON_BACKEND_REPO_TAG:STRING=${TRITON_BACKEND_REPO_TAG} .. && \\\n    make -j16 triton-shm-monitor install\n\nRUN cp tritonbuild/identity/install/backends/identity/libtriton_identity.so \\\n        qa/L0_lifecycle/. && \\\n    cp tritonbuild/python/install/backends/python/triton_shm_monitor*.so \\\n        qa/common/. && \\\n    mkdir -p qa/L0_perf_nomodel/custom_models/custom_zero_1_float32/1 && \\\n    mkdir -p qa/L0_perf_pyclients/custom_models/custom_zero_1_int32/1 && \\\n    mkdir -p qa/L0_infer_shm && \\\n    cp -r qa/L0_infer/. qa/L0_infer_shm && \\\n    mkdir -p qa/L0_infer_cudashm && \\\n    cp -r qa/L0_infer/. qa/L0_infer_cudashm && \\\n    mkdir -p qa/L0_infer_valgrind && \\\n    cp -r qa/L0_infer/. qa/L0_infer_valgrind && \\\n    mkdir -p qa/L0_infer_tf2 && \\\n    cp -r qa/L0_infer/. qa/L0_infer_tf2 && \\\n    if [ -d qa/L0_tf_image_models ]; then \\\n        mkdir -p qa/L0_tf_image_models_tf2 && \\\n            cp -r qa/L0_tf_image_models/. qa/L0_tf_image_models_tf2; \\\n    fi; \\\n    mkdir -p qa/L0_trt_shape_tensors_shm && \\\n    cp -r qa/L0_trt_shape_tensors/. qa/L0_trt_shape_tensors_shm && \\\n    mkdir -p qa/L0_trt_shape_tensors_cudashm && \\\n    cp -r qa/L0_trt_shape_tensors/. qa/L0_trt_shape_tensors_cudashm && \\\n    mkdir -p qa/L0_batcher_shm && \\\n    cp -r qa/L0_batcher/. qa/L0_batcher_shm && \\\n    mkdir -p qa/L0_batcher_cudashm && \\\n    cp -r qa/L0_batcher/. qa/L0_batcher_cudashm && \\\n    mkdir -p qa/L0_batcher_valgrind && \\\n    cp -r qa/L0_batcher/. qa/L0_batcher_valgrind && \\\n    mkdir -p qa/L0_sequence_batcher_shm && \\\n    cp -r qa/L0_sequence_batcher/. qa/L0_sequence_batcher_shm && \\\n    mkdir -p qa/L0_sequence_batcher_cudashm && \\\n    cp -r qa/L0_sequence_batcher/. qa/L0_sequence_batcher_cudashm && \\\n    mkdir -p qa/L0_sequence_batcher_valgrind && \\\n    cp -r qa/L0_sequence_batcher/. qa/L0_sequence_batcher_valgrind && \\\n    mkdir -p qa/L0_perf_nomodel_shm && \\\n    cp -r qa/L0_perf_nomodel/. qa/L0_perf_nomodel_shm && \\\n    mkdir -p qa/L0_perf_nomodel_cudashm && \\\n    cp -r qa/L0_perf_nomodel/. qa/L0_perf_nomodel_cudashm\n\n# L0_model_control_stress will not be present if gitlab tests are not available\nRUN if [ -d qa/L0_model_control_stress ]; then \\\n        mkdir -p qa/L0_model_control_stress_valgrind && \\\n            cp -r qa/L0_model_control_stress/. qa/L0_model_control_stress_valgrind && \\\n            mkdir -p qa/L0_model_control_stress_valgrind_massif && \\\n            cp -r qa/L0_model_control_stress/. qa/L0_model_control_stress_valgrind_massif; \\\n    fi\n\nRUN cp backends/repeat/libtriton_repeat.so qa/L0_model_config/.\n\nRUN mkdir -p qa/L0_decoupled/models/repeat_int32/1 && \\\n    cp backends/repeat/libtriton_repeat.so \\\n        qa/L0_decoupled/models/repeat_int32/1/.\nRUN mkdir -p qa/L0_decoupled/models/square_int32/1 && \\\n    cp backends/square/libtriton_square.so \\\n        qa/L0_decoupled/models/square_int32/1/.\nRUN mkdir -p qa/L0_decoupled/models/identity_int32/1\nRUN mkdir -p qa/L0_decoupled/models/simple_repeat/1 && \\\n    mkdir -p qa/L0_decoupled/models/fan_repeat/1 && \\\n    mkdir -p qa/L0_decoupled/models/sequence_repeat/1 && \\\n    mkdir -p qa/L0_decoupled/models/repeat_square/1 && \\\n    mkdir -p qa/L0_decoupled/models/nested_square/1\n\nRUN cp -r qa/L0_decoupled/models qa/L0_decoupled/python_models/ && \\\n    cp /workspace/tritonbuild/python/examples/decoupled/repeat_model.py \\\n        qa/L0_decoupled/python_models/repeat_int32/1/. && \\\n    cp /workspace/tritonbuild/python/examples/decoupled/repeat_config.pbtxt \\\n        qa/L0_decoupled/python_models/repeat_int32/. && \\\n    cp /workspace/tritonbuild/python/examples/decoupled/square_model.py \\\n        qa/L0_decoupled/python_models/square_int32/1/. && \\\n    cp /workspace/tritonbuild/python/examples/decoupled/square_config.pbtxt \\\n        qa/L0_decoupled/python_models/square_int32/.\n\nRUN mkdir -p qa/L0_repoagent_checksum/models/identity_int32/1 && \\\n    cp tritonbuild/identity/install/backends/identity/libtriton_identity.so \\\n        qa/L0_repoagent_checksum/models/identity_int32/1/.\nRUN mkdir -p qa/L0_passive_instance/models/distributed_int32_int32_int32/1 && \\\n    cp tritonbuild/tritonserver/backends/distributed_addsub/libtriton_distributed_addsub.so \\\n        qa/L0_passive_instance/models/distributed_int32_int32_int32/1/.\n\n############################################################################\n## Copy artifacts from sdk container\n############################################################################\nFROM ${SDK_IMAGE} AS sdk\n\nARG TARGETPLATFORM\nWORKDIR /workspace\nCOPY --from=cibase /workspace/qa/ qa/\nRUN mkdir -p qa/clients && mkdir -p qa/pkgs && \\\n    cp -a install/bin/* qa/clients/. && \\\n    cp install/lib/libgrpcclient.so qa/clients/. && \\\n    cp install/lib/libhttpclient.so qa/clients/. && \\\n    cp install/python/*.py qa/clients/. && \\\n    cp install/python/triton*.whl qa/pkgs/. && \\\n    cp install/java/examples/*.jar qa/clients/.\nRUN cp client/src/grpc_generated/go/*.go qa/L0_simple_go_client/. && \\\n    cp client/src/grpc_generated/javascript/*.js qa/L0_simple_nodejs_client/. && \\\n    cp client/src/grpc_generated/javascript/*.json qa/L0_simple_nodejs_client/. && \\\n    cp -r client/src/grpc_generated/java qa/L0_client_java/.\n\n############################################################################\n## Create CI enabled image\n############################################################################\nFROM $BASE_IMAGE\n\nARG TARGETPLATFORM\n\n# Ensure apt-get won't prompt for selecting options\nENV DEBIAN_FRONTEND=noninteractive\n\n# install platform specific packages\nRUN if [ $(cat /etc/os-release | grep 'VERSION_ID=\"20.04\"' | wc -l) -ne 0 ]; then \\\n        apt-get update && \\\n        apt-get install -y --no-install-recommends \\\n                libpng-dev; rm -rf /var/lib/apt/lists/*; \\\n    elif [ $(cat /etc/os-release | grep 'VERSION_ID=\"18.04\"' | wc -l) -ne 0 ]; then \\\n        apt-get update && \\\n        apt-get install -y --no-install-recommends \\\n                libpng-dev; rm -rf /var/lib/apt/lists/*; \\\n    else \\\n        echo \"Ubuntu version must be either 18.04 or 20.04\" && \\\n        exit 1; \\\n    fi\n\n# CI/QA for memcheck requires valgrind\n# libarchive-dev is required by Python backend\nRUN apt-get update && apt-get install -y --no-install-recommends \\\n                              curl \\\n                              libopencv-dev \\\n                              libarchive-dev \\\n                              libopencv-core-dev \\\n                              libzmq3-dev \\\n                              maven \\\n                              openjdk-11-jdk \\\n                              nginx \\\n                              npm \\\n                              protobuf-compiler \\\n                              python3-dev \\\n                              python3-pip \\\n                              python3-protobuf \\\n                              python3-setuptools \\\n                              swig \\\n                              valgrind && \\\n    rm -rf /var/lib/apt/lists/*\n\n# CI/QA expects \"python\" executable (not python3).\nRUN rm -f /usr/bin/python && \\\n    ln -s /usr/bin/python3 /usr/bin/python\n\nRUN pip3 install --no-cache-dir --upgrade wheel setuptools && \\\n    pip3 install --no-cache-dir --upgrade numpy pillow attrdict future grpcio requests gsutil awscli six grpcio-channelz\n\n# L0_http_fuzz is hitting similar issue with boofuzz with latest version (0.4.0):\n# https://github.com/jtpereyda/boofuzz/issues/529\n# Hence, fixing the boofuzz version to 0.3.0\nRUN pip3 install --no-cache-dir 'boofuzz==0.3.0'\n\n# go needed for example go client test.\nRUN if [ \"$TARGETPLATFORM\" = \"linux/arm64\" ]; then \\\n      wget https://golang.org/dl/go1.16.3.linux-arm64.tar.gz && \\\n      rm -rf /usr/local/go && tar -C /usr/local -xzf go1.16.3.linux-arm64.tar.gz && \\\n      rm -f go1.16.3.linux-arm64.tar.gz; \\\n    else \\\n      wget https://golang.org/dl/go1.16.3.linux-amd64.tar.gz && \\\n      rm -rf /usr/local/go && tar -C /usr/local -xzf go1.16.3.linux-amd64.tar.gz && \\\n      rm -f go1.16.3.linux-amd64.tar.gz; \\\n    fi\nENV GOPATH /root/go\nENV PATH $PATH:/usr/local/go/bin:$GOPATH/bin\nRUN GO111MODULE=off go get github.com/golang/protobuf/protoc-gen-go && \\\n    GO111MODULE=off go get google.golang.org/grpc\n\n# CI expects tests in /opt/tritonserver/qa. The triton-server (1000)\n# user should own all artifacts in case CI is run using triton-server\n# user.\nWORKDIR /opt/tritonserver\nCOPY --chown=1000:1000 --from=sdk /workspace/qa/ qa/\n\n# Remove CI tests that are meant to run only on build image and\n# install the tritonserver/triton python client APIs.\nRUN rm -fr qa/L0_copyrights qa/L0_build_variants && \\\n    find qa/pkgs/ -maxdepth 1 -type f -name \\\n    \"tritonclient-*linux*.whl\" | xargs printf -- '%s[all]' | \\\n    xargs pip3 install --upgrade\n\nENV LD_LIBRARY_PATH /opt/tritonserver/qa/clients:${LD_LIBRARY_PATH}\n\n# DLIS-3631: Needed to run Perf Analyzer CI tests correctly\nENV LD_LIBRARY_PATH /opt/hpcx/ompi/lib:${LD_LIBRARY_PATH}\n"
}