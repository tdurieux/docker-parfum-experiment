{
  "startTime": 1674248350309,
  "endTime": 1674248351368,
  "originalSmells": [
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 61,
        "lineEnd": 61,
        "columnStart": 4,
        "columnEnd": 31
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 64,
        "lineEnd": 64,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 65,
        "lineEnd": 65,
        "columnStart": 4,
        "columnEnd": 30
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 66,
        "lineEnd": 66,
        "columnStart": 4,
        "columnEnd": 26
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 67,
        "lineEnd": 67,
        "columnStart": 4,
        "columnEnd": 33
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 75,
        "lineEnd": 75,
        "columnStart": 4,
        "columnEnd": 52
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 81,
        "lineEnd": 81,
        "columnStart": 4,
        "columnEnd": 28
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 92,
        "lineEnd": 92,
        "columnStart": 4,
        "columnEnd": 34
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 95,
        "lineEnd": 95,
        "columnStart": 4,
        "columnEnd": 37
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 61,
        "lineEnd": 61,
        "columnStart": 4,
        "columnEnd": 31
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 64,
        "lineEnd": 64,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 65,
        "lineEnd": 65,
        "columnStart": 4,
        "columnEnd": 30
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 66,
        "lineEnd": 66,
        "columnStart": 4,
        "columnEnd": 26
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 67,
        "lineEnd": 67,
        "columnStart": 4,
        "columnEnd": 33
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 75,
        "lineEnd": 75,
        "columnStart": 4,
        "columnEnd": 52
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 81,
        "lineEnd": 81,
        "columnStart": 4,
        "columnEnd": 28
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 92,
        "lineEnd": 92,
        "columnStart": 4,
        "columnEnd": 34
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 95,
        "lineEnd": 95,
        "columnStart": 4,
        "columnEnd": 37
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 61,
        "lineEnd": 61,
        "columnStart": 4,
        "columnEnd": 31
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 64,
        "lineEnd": 64,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 65,
        "lineEnd": 65,
        "columnStart": 4,
        "columnEnd": 30
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 66,
        "lineEnd": 66,
        "columnStart": 4,
        "columnEnd": 26
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 67,
        "lineEnd": 67,
        "columnStart": 4,
        "columnEnd": 33
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 75,
        "lineEnd": 75,
        "columnStart": 4,
        "columnEnd": 52
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 81,
        "lineEnd": 81,
        "columnStart": 4,
        "columnEnd": 28
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 92,
        "lineEnd": 92,
        "columnStart": 4,
        "columnEnd": 34
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 95,
        "lineEnd": 95,
        "columnStart": 4,
        "columnEnd": 37
      }
    }
  ],
  "repairedSmells": [
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 61,
        "lineEnd": 61,
        "columnStart": 4,
        "columnEnd": 55
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 64,
        "lineEnd": 64,
        "columnStart": 4,
        "columnEnd": 51
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 65,
        "lineEnd": 65,
        "columnStart": 4,
        "columnEnd": 54
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 66,
        "lineEnd": 66,
        "columnStart": 4,
        "columnEnd": 50
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 67,
        "lineEnd": 67,
        "columnStart": 4,
        "columnEnd": 57
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 75,
        "lineEnd": 75,
        "columnStart": 4,
        "columnEnd": 76
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 81,
        "lineEnd": 81,
        "columnStart": 4,
        "columnEnd": 52
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 92,
        "lineEnd": 92,
        "columnStart": 4,
        "columnEnd": 58
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 95,
        "lineEnd": 95,
        "columnStart": 4,
        "columnEnd": 61
      }
    }
  ],
  "repairedDockerfile": "# from https://www.drupal.org/docs/8/system-requirements/drupal-8-php-requirements\nFROM php:7.4-apache-buster\n\n# install the PHP extensions we need\nRUN set -eux; \\\n\t\\\n\tif command -v a2enmod; then \\\n\t\ta2enmod rewrite; \\\n\tfi; \\\n\t\\\n\tsavedAptMark=\"$(apt-mark showmanual)\"; \\\n\t\\\n\tapt-get update; \\\n\tapt-get install -y --no-install-recommends \\\n\t\tlibfreetype6-dev \\\n\t\tlibjpeg-dev \\\n\t\tlibpng-dev \\\n\t\tlibpq-dev \\\n\t\tlibzip-dev \\\n\t; \\\n\t\\\n\tdocker-php-ext-configure gd \\\n\t\t--with-freetype \\\n\t\t--with-jpeg=/usr \\\n\t; \\\n\t\\\n\tdocker-php-ext-install -j \"$(nproc)\" \\\n\t\tgd \\\n\t\topcache \\\n\t\tpdo_mysql \\\n\t\tpdo_pgsql \\\n\t\tzip \\\n\t; \\\n\t\\\n# reset apt-mark's \"manual\" list so that \"purge --auto-remove\" will remove all build dependencies\n\tapt-mark auto '.*' > /dev/null; \\\n\tapt-mark manual $savedAptMark; \\\n\tldd \"$(php -r 'echo ini_get(\"extension_dir\");')\"/*.so \\\n\t\t| awk '/=>/ { print $3 }' \\\n\t\t| sort -u \\\n\t\t| xargs -r dpkg-query -S \\\n\t\t| cut -d: -f1 \\\n\t\t| sort -u \\\n\t\t| xargs -rt apt-mark manual; \\\n\t\\\n\tapt-get purge -y --auto-remove -o APT::AutoRemove::RecommendsImportant=false; \\\n\trm -rf /var/lib/apt/lists/*\n\n# set recommended PHP.ini settings\n# see https://secure.php.net/manual/en/opcache.installation.php\nRUN { \\\n\t\techo 'opcache.memory_consumption=128'; \\\n\t\techo 'opcache.interned_strings_buffer=8'; \\\n\t\techo 'opcache.max_accelerated_files=4000'; \\\n\t\techo 'opcache.revalidate_freq=60'; \\\n\t\techo 'opcache.fast_shutdown=1'; \\\n\t} > /usr/local/etc/php/conf.d/opcache-recommended.ini\n\nRUN apt-get update\n\n# Install Git and wget.\nRUN apt-get install --no-install-recommends git wget -y && rm -rf /var/lib/apt/lists/*;\n\n# sudo is used to run tests as www-data.\nRUN apt-get install --no-install-recommends -y sudo && rm -rf /var/lib/apt/lists/*;\nRUN apt-get install --no-install-recommends -y sqlite3 && rm -rf /var/lib/apt/lists/*;\nRUN apt-get install --no-install-recommends -y vim && rm -rf /var/lib/apt/lists/*;\nRUN apt-get install --no-install-recommends -y fontconfig && rm -rf /var/lib/apt/lists/*;\n\n# xdebug isn't available as a prebuilt extension in the parent image.\nRUN pecl install xdebug\nRUN PHP_EXTENSION_DIR=$(php -r 'echo ini_get(\"extension_dir\");') && \\\n  echo \"zend_extension=$PHP_EXTENSION_DIR/xdebug.so\" > /usr/local/etc/php/conf.d/xdebug.ini\n\n# We use imagemagick to support behat screenshots\nRUN apt-get install --no-install-recommends -y imagemagick libmagickwand-dev && rm -rf /var/lib/apt/lists/*;\nRUN pecl install imagick\nRUN PHP_EXTENSION_DIR=$(php -r 'echo ini_get(\"extension_dir\");') && \\\n  echo \"extension=$PHP_EXTENSION_DIR/imagick.so\" > /usr/local/etc/php/conf.d/imagick.ini\n\n# unzip is recommended for composer over the zip extension\nRUN apt-get install --no-install-recommends -y unzip && rm -rf /var/lib/apt/lists/*;\n\n# Install composer.\nCOPY install-composer.sh /usr/local/bin/\nRUN install-composer.sh\n\n# Install Robo CI.\nRUN wget https://robo.li/robo.phar\nRUN chmod +x robo.phar && mv robo.phar /usr/local/bin/robo\n\n# php-dom and bcmath dependencies\nRUN apt-get install --no-install-recommends -y libxslt-dev && rm -rf /var/lib/apt/lists/*;\nRUN docker-php-ext-install bcmath xsl\n\nRUN apt-get install --no-install-recommends -y mariadb-client && rm -rf /var/lib/apt/lists/*;\n\n# Install Drupal.\nWORKDIR /var/www\n\nRUN rm -rf html\nARG DRUPAL_VERSION_CONSTRAINT=\"^8.9\"\nRUN composer create-project drupal/legacy-project:$DRUPAL_VERSION_CONSTRAINT html\n\nWORKDIR /var/www/html\n\n# The drupal/legacy-project is loose with version constraints. For instance the\n# 8.9.16 tag requires drupal/core-recommended:^8.8. That can open you up to\n# unexpectantly having drupal/core downgraded, which we want to avoid. We\n# specifically require drupal/core-recommended and drupal/core-dev at ^8.9\n# for this purpose.\nRUN composer require --update-with-dependencies drupal/core-recommended:$DRUPAL_VERSION_CONSTRAINT drupal/core-dev:$DRUPAL_VERSION_CONSTRAINT wikimedia/composer-merge-plugin:^2.0 cweagans/composer-patches:^1.7.1\nRUN chown -R www-data:www-data sites modules themes\n\n# Cache currently used libraries to improve build times. We need to force\n# discarding changes as Drupal removes test code in /vendor.\nRUN cp composer.json composer.json.original \\\n  && cp composer.lock composer.lock.original \\\n  && mv vendor vendor.original \\\n  && composer require --update-with-all-dependencies --dev \\\n      cweagans/composer-patches \\\n      behat/mink-extension:v2.2 \\\n      drupal/drupal-extension:^4.0 \\\n      bex/behat-screenshot \\\n      phpmd/phpmd \\\n      phpmetrics/phpmetrics \\\n  && rm -rf vendor \\\n  && mv composer.json.original composer.json \\\n  && mv composer.lock.original composer.lock \\\n  && mv vendor.original vendor\n\nCOPY hooks/* /var/www/html/\n\n# Commit our preinstalled Drupal database for faster Behat tests.\nCOPY drupal.sql.gz /var/www\nCOPY settings.php /var/www\nRUN mkdir -p /var/www/html/sites/default/files/config_8faoX4lvQ9283v0ooiL1iEshqPsvAJpCDEyiKvBVq_kAxWxJVwQFnFp8z5PAuuqyUHEYUfJD2Q/sync \\\n  && chown -Rv www-data /var/www/html/sites/default/files\n\n# Add the vendor/bin directory to the $PATH\nENV PATH=\"/var/www/html/vendor/bin:${PATH}\"\n\n# We need to expose port 80 for Selenium containers.\nEXPOSE 80\n"
}