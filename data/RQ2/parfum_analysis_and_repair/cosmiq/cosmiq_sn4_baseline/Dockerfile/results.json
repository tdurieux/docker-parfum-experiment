{
  "startTime": 1674252666346,
  "endTime": 1674252667549,
  "originalSmells": [
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 127,
        "lineEnd": 127,
        "columnStart": 3,
        "columnEnd": 107
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "FROM nvidia/cuda:9.0-devel-ubuntu16.04\nMAINTAINER nweir <nweir@iqt.org>\n\nENV CUDNN_VERSION 7.3.0.29\nLABEL com.nvidia.cudnn.version=\"${CUDNN_VERSION}\"\n\n# prep apt-get and cudnn\nRUN apt-get update && apt-get install -y --no-install-recommends \\\n\t    apt-utils \\\n            libcudnn7=$CUDNN_VERSION-1+cuda9.0 \\\n            libcudnn7-dev=$CUDNN_VERSION-1+cuda9.0 && \\\n    apt-mark hold libcudnn7 && \\\n    rm -rf /var/lib/apt/lists/*\n\n# install requirements\nRUN apt-get update \\\n  && apt-get install -y --no-install-recommends \\\n    bc \\\n    bzip2 \\\n    ca-certificates \\\n    curl \\\n    git \\\n    libgdal-dev \\\n    libssl-dev \\\n    libffi-dev \\\n\t\tlibncurses-dev \\\n    libgl1 \\\n    jq \\\n    nfs-common \\\n    parallel \\\n    python-dev \\\n    python-pip \\\n    python-wheel \\\n    python-setuptools \\\n    unzip \\\n\t\tvim \\\n    wget \\\n    build-essential \\\n  && apt-get clean \\\n  && rm -rf /var/lib/apt/lists/*\n\nSHELL [\"/bin/bash\", \"-c\"]\nENV PATH /opt/conda/bin:$PATH\n\n# install anaconda\nRUN wget --quiet https://repo.anaconda.com/miniconda/Miniconda3-4.5.4-Linux-x86_64.sh -O ~/miniconda.sh && \\\n    /bin/bash ~/miniconda.sh -b -p /opt/conda && \\\n    rm ~/miniconda.sh && \\\n    /opt/conda/bin/conda clean -tipsy && \\\n    ln -s /opt/conda/etc/profile.d/conda.sh /etc/profile.d/conda.sh && \\\n    echo \". /opt/conda/etc/profile.d/conda.sh\" >> ~/.bashrc && \\\n    echo \"conda activate base\" >> ~/.bashrc\n\nENV TINI_VERSION v0.16.1\nADD https://github.com/krallin/tini/releases/download/${TINI_VERSION}/tini /usr/bin/tini\nRUN chmod +x /usr/bin/tini\n\n# use conda-forge instead of default channel\nRUN conda update conda && \\\n    conda config --remove channels defaults && \\\n    conda config --add channels conda-forge\n\n\n\n# set up conda environment and add to $PATH\nRUN conda create -n space_base python=3.6 \\\n                    && echo \"source activate space_base\" > ~/.bashrc\nENV PATH /opt/conda/envs/space_base/bin:$PATH\n\n# install GPU version of tensorflow\nRUN source activate space_base && \\\n    conda install -n space_base -c defaults tensorflow-gpu\n\n# install keras with tf backend\nENV KERAS_BACKEND=tensorflow\nRUN source activate space_base \\\n  && conda install -n space_base keras\n\n# install various conda dependencies into the space_base environment\nRUN conda install -n space_base \\\n              awscli \\\n              osmnx=0.7.3 \\\n              affine \\\n              pyproj \\\n              pyhamcrest=1.9.0 \\\n              cython \\\n              fiona \\\n              h5py \\\n              ncurses \\\n              jupyter \\\n              jupyterlab \\\n              ipykernel \\\n              libgdal \\\n              matplotlib \\\n\t\t\t\t\t\t\tncurses \\\n              numpy \\\n              opencv \\\n              pandas \\\n              pillow \\\n              pip \\\n              scipy \\\n              scikit-image \\\n              scikit-learn \\\n              shapely \\\n              gdal \\\n              rtree \\\n              testpath \\\n              tqdm \\\n              pandas \\\n              geopandas \\\n              rasterio\n\n# add a jupyter kernel for the conda environment in case it's wanted\nRUN source activate space_base && python -m ipykernel.kernelspec\n\n# open ports for jupyterlab and tensorboard\nEXPOSE 8888 6006\n\n# switch to a temp working dir to get and install spacenetutilities V3\nWORKDIR /tmp/\n\nRUN git clone https://github.com/SpaceNetChallenge/utilities.git && cd utilities && \\\n    git checkout spacenetV3 && \\\n    source activate space_base && \\\n    pip install --no-cache-dir --no-dependencies -e .\n\nRUN source activate space_base && \\\n\t\t\tpip install --no-cache-dir -e git+git://github.com/cosmiq/cosmiq_sn4_baseline.git@1.1.2#egg=cosmiq_sn4_baseline-1.1.2\n\nRUN [\"/bin/bash\"]\n"
}