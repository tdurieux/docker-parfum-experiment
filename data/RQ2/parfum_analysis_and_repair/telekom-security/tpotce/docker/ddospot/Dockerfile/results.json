{
  "startTime": 1674220990301,
  "endTime": 1674220991249,
  "originalSmells": [
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 42,
        "lineEnd": 42,
        "columnStart": 4,
        "columnEnd": 44
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "FROM alpine:3.16\n#\n# Include dist\nCOPY dist/ /root/dist/\n#\n# Install packages\nRUN apk --no-cache -U add \\\n             build-base \\\n             git \\\n\t     libcap \\\n\t     py3-colorama \\\n\t     py3-greenlet \\\n\t     py3-pip \\\n\t     py3-schedule \\\n\t     py3-sqlalchemy \\\n\t     py3-twisted \\\n\t     py3-wheel \\\n             python3 \\\n             python3-dev && \\\n#\t     \n# Install ddospot from GitHub and setup\n    mkdir -p /opt && \\\n    cd /opt/ && \\\n    git clone https://github.com/aelth/ddospot && \\\n    cd ddospot && \\\n    git checkout 49f515237bd2d5744290ed21dcca9b53def243ba && \\\n    # We only want JSON events, setting logger format to ('') ...\n    sed -i \"/handler.setFormatter(logging.Formatter(/{n;N;d}\" /opt/ddospot/ddospot/core/potloader.py && \\\n    sed -i \"s#handler.setFormatter(logging.Formatter(#handler.setFormatter(logging.Formatter(''))#g\" /opt/ddospot/ddospot/core/potloader.py && \\\n    # ... and remove msg from log message for individual honeypots\n    sed -i \"s#self.logger.info('\\%s - \\%s' \\% (msg, raw_json))#self.logger.info(raw_json)#g\" /opt/ddospot/ddospot/pots/chargen/chargen.py && \\\n    sed -i \"s#self.logger.info('New DNS query - \\%s' \\% (raw_json))#self.logger.info(raw_json)#g\" /opt/ddospot/ddospot/pots/dns/dns.py && \\\n    sed -i \"s#self.logger.info('\\%s - \\%s' \\% (msg, raw_json))#self.logger.info(raw_json)#g\" /opt/ddospot/ddospot/pots/generic/generic.py && \\\n    sed -i \"s#self.logger.info('\\%s - \\%s' \\% (msg, raw_json))#self.logger.info(raw_json)#g\" /opt/ddospot/ddospot/pots/ntp/ntp.py && \\\n    sed -i \"s#self.logger.info('\\%s - \\%s' \\% (msg, raw_json))#self.logger.info(raw_json)#g\" /opt/ddospot/ddospot/pots/ssdp/ssdp.py && \\\n    # We are using logrotate\n    sed -i \"s#rotate_size = 10#rotate_size = 9999#g\" /opt/ddospot/ddospot/pots/chargen/chargenpot.conf && \\\n    sed -i \"s#rotate_size = 10#rotate_size = 9999#g\" /opt/ddospot/ddospot/pots/dns/dnspot.conf && \\\n    sed -i \"s#rotate_size = 10#rotate_size = 9999#g\" /opt/ddospot/ddospot/pots/generic/genericpot.conf && \\\n    sed -i \"s#rotate_size = 10#rotate_size = 9999#g\" /opt/ddospot/ddospot/pots/ntp/ntpot.conf && \\\n    sed -i \"s#rotate_size = 10#rotate_size = 9999#g\" /opt/ddospot/ddospot/pots/ssdp/ssdpot.conf && \\\n    cp /root/dist/requirements.txt . && \\\n    pip3 install --no-cache-dir -r ddospot/requirements.txt && \\\n    setcap cap_net_bind_service=+ep /usr/bin/python3.10 && \\\n#\n# Setup user, groups and configs\n    addgroup -g 2000 ddospot && \\\n    adduser -S -H -s /bin/ash -u 2000 -D -g 2000 ddospot && \\\n    chown ddospot:ddospot -R /opt/ddospot && \\\n#\n# Clean up\n    apk del --purge build-base \\\n                    git \\\n\t\t    python3-dev && \\\n    rm -rf /root/* && \\\n    rm -rf /opt/ddospot/.git && \\\n    rm -rf /var/cache/apk/*\n#\n# Start ddospot\nSTOPSIGNAL SIGINT\nUSER ddospot:ddospot\nWORKDIR /opt/ddospot/ddospot/\nCMD [\"/usr/bin/python3\",\"ddospot.py\", \"-n\"]\n"
}