{
  "startTime": 1674253611381,
  "endTime": 1674253612077,
  "originalSmells": [
    {
      "rule": "yumInstallRmVarCacheYum",
      "position": {
        "lineStart": 2,
        "lineEnd": 6,
        "columnStart": 4,
        "columnEnd": 6
      }
    },
    {
      "rule": "yumInstallRmVarCacheYum",
      "position": {
        "lineStart": 8,
        "lineEnd": 12,
        "columnStart": 4,
        "columnEnd": 14
      }
    },
    {
      "rule": "tarSomethingRmTheSomething",
      "position": {
        "lineStart": 60,
        "lineEnd": 60,
        "columnStart": 5,
        "columnEnd": 55
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "FROM centos:7\n\nRUN yum -y install \\\n  epel-release \\\n  gcc \\\n  python-devel \\\n  time && rm -rf /var/cache/yum\n\nRUN yum -y install \\\n  python-pip \\\n  python36 \\\n  python36-devel \\\n  python36-pip && rm -rf /var/cache/yum\n\nRUN python -m pip install --upgrade 'pip<21'\nRUN python3.6 -m pip install --upgrade pip\n\nRUN python -m pip install --upgrade 'setuptools<45'\nRUN python3.6 -m pip install --upgrade setuptools\n\nWORKDIR /opt/opencue\n\nCOPY LICENSE ./\nCOPY requirements.txt ./\n\nRUN python -m pip install -r requirements.txt\nRUN python3.6 -m pip install -r requirements.txt\n\nCOPY proto/ ./proto\nCOPY rqd/deploy ./rqd/deploy\nCOPY rqd/README.md ./rqd/\nCOPY rqd/setup.py ./rqd/\nCOPY rqd/tests/ ./rqd/tests\nCOPY rqd/rqd/ ./rqd/rqd\n\nRUN python3.6 -m grpc_tools.protoc \\\n  -I=./proto \\\n  --python_out=./rqd/rqd/compiled_proto \\\n  --grpc_python_out=./rqd/rqd/compiled_proto \\\n  ./proto/*.proto\n\n# Fix imports to work in both Python 2 and 3. See\n# <https://github.com/protocolbuffers/protobuf/issues/1491> for more info.\nRUN 2to3 -wn -f import rqd/rqd/compiled_proto/*_pb2*.py\n\n# TODO(bcipriano) Lint the code here. (Issue #78)\n\nCOPY VERSION.in VERSIO[N] ./\nRUN test -e VERSION || echo \"$(cat VERSION.in)-custom\" | tee VERSION\n\n# Test in Python 2 and 3, but only install in the Python 3 environment.\nRUN cd rqd && python setup.py test\nRUN cd rqd && python3.6 setup.py test\nRUN cd rqd && python3.6 setup.py install\n\n# This step isn't really needed at runtime, but is used when publishing an OpenCue release\n# from this build.\nRUN versioned_name=\"rqd-$(cat ./VERSION)-all\" \\\n  && cp LICENSE requirements.txt VERSION rqd/ \\\n  && mv rqd $versioned_name \\\n  && tar -cvzf $versioned_name.tar.gz $versioned_name/* \\\n  && ln -s $versioned_name rqd && rm $versioned_name.tar.gz\n\n# RQD gRPC server\nEXPOSE 8444\n\n# NOTE: This shell out is needed to avoid RQD getting PID 0 which leads to leaking child processes.\nENTRYPOINT [\"/bin/bash\", \"-c\", \"set -e && rqd\"]\n"
}