{
  "startTime": 1674250341122,
  "endTime": 1674250342759,
  "originalSmells": [
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 37,
        "lineEnd": 37,
        "columnStart": 18,
        "columnEnd": 70
      }
    },
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 38,
        "lineEnd": 38,
        "columnStart": 4,
        "columnEnd": 116
      }
    },
    {
      "rule": "wgetUseHttpsUrl",
      "position": {
        "lineStart": 104,
        "lineEnd": 104,
        "columnStart": 4,
        "columnEnd": 154
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 76,
        "lineEnd": 76,
        "columnStart": 4,
        "columnEnd": 37
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 77,
        "lineEnd": 77,
        "columnStart": 4,
        "columnEnd": 371
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 28,
        "lineEnd": 28,
        "columnStart": 4,
        "columnEnd": 30
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 30,
        "lineEnd": 30,
        "columnStart": 4,
        "columnEnd": 49
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 33,
        "lineEnd": 33,
        "columnStart": 4,
        "columnEnd": 38
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 36,
        "lineEnd": 36,
        "columnStart": 4,
        "columnEnd": 46
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 45,
        "lineEnd": 45,
        "columnStart": 4,
        "columnEnd": 36
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 51,
        "lineEnd": 53,
        "columnStart": 4,
        "columnEnd": 28
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 63,
        "lineEnd": 63,
        "columnStart": 4,
        "columnEnd": 44
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 64,
        "lineEnd": 64,
        "columnStart": 4,
        "columnEnd": 31
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 66,
        "lineEnd": 66,
        "columnStart": 4,
        "columnEnd": 61
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 68,
        "lineEnd": 68,
        "columnStart": 4,
        "columnEnd": 61
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 70,
        "lineEnd": 70,
        "columnStart": 4,
        "columnEnd": 67
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 85,
        "lineEnd": 85,
        "columnStart": 4,
        "columnEnd": 64
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 94,
        "lineEnd": 94,
        "columnStart": 4,
        "columnEnd": 53
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 128,
        "lineEnd": 128,
        "columnStart": 4,
        "columnEnd": 28
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 36,
        "lineEnd": 36,
        "columnStart": 4,
        "columnEnd": 46
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 128,
        "lineEnd": 128,
        "columnStart": 4,
        "columnEnd": 28
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 28,
        "lineEnd": 28,
        "columnStart": 4,
        "columnEnd": 30
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 30,
        "lineEnd": 30,
        "columnStart": 4,
        "columnEnd": 49
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 33,
        "lineEnd": 33,
        "columnStart": 4,
        "columnEnd": 38
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 36,
        "lineEnd": 36,
        "columnStart": 4,
        "columnEnd": 46
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 51,
        "lineEnd": 53,
        "columnStart": 4,
        "columnEnd": 28
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 63,
        "lineEnd": 63,
        "columnStart": 4,
        "columnEnd": 44
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 64,
        "lineEnd": 64,
        "columnStart": 4,
        "columnEnd": 31
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 66,
        "lineEnd": 66,
        "columnStart": 4,
        "columnEnd": 61
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 68,
        "lineEnd": 68,
        "columnStart": 4,
        "columnEnd": 61
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 70,
        "lineEnd": 70,
        "columnStart": 4,
        "columnEnd": 67
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 85,
        "lineEnd": 85,
        "columnStart": 4,
        "columnEnd": 64
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 94,
        "lineEnd": 94,
        "columnStart": 4,
        "columnEnd": 53
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 128,
        "lineEnd": 128,
        "columnStart": 4,
        "columnEnd": 28
      }
    }
  ],
  "repairedSmells": [
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 36,
        "lineEnd": 36,
        "columnStart": 4,
        "columnEnd": 70
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 128,
        "lineEnd": 128,
        "columnStart": 4,
        "columnEnd": 52
      }
    }
  ],
  "repairedDockerfile": "# Licensed to the Apache Software Foundation (ASF) under one or more\n# contributor license agreements.  See the NOTICE file distributed with\n# this work for additional information regarding copyright ownership.\n# The ASF licenses this file to You under the Apache License, Version 2.0\n# (the \"License\"); you may not use this file except in compliance with\n# the License.  You may obtain a copy of the License at\n#\n#    http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n\nFROM ubuntu:16.04\nMAINTAINER Apache Software Foundation <dev@zeppelin.apache.org>\n\nENV Z_VERSION=\"0.9.0-preview1\"\n\nENV LOG_TAG=\"[ZEPPELIN_${Z_VERSION}]:\" \\\n    Z_HOME=\"/zeppelin\" \\\n    LANG=en_US.UTF-8 \\\n    LC_ALL=en_US.UTF-8 \\\n    ZEPPELIN_ADDR=\"0.0.0.0\"\n\nRUN echo \"$LOG_TAG update and install basic packages\" && \\\n    apt-get -y update && \\\n    apt-get install --no-install-recommends -y locales && \\\n    locale-gen $LANG && \\\n    apt-get install --no-install-recommends -y software-properties-common && \\\n    apt -y autoclean && \\\n    apt -y dist-upgrade && \\\n    apt-get install --no-install-recommends -y build-essential && rm -rf /var/lib/apt/lists/*;\n\nRUN echo \"$LOG_TAG install tini related packages\" && \\\n    apt-get install --no-install-recommends -y wget curl grep sed dpkg && \\\n    TINI_VERSION=$( curl -f https://github.com/krallin/tini/releases/latest | grep -o \"/v.*\\\"\" | sed 's:^..\\(.*\\).$:\\1:') && \\\n    curl -f -L \"https://github.com/krallin/tini/releases/download/v${TINI_VERSION}/tini_${TINI_VERSION}.deb\" > tini.deb && \\\n    dpkg -i tini.deb && \\\n    rm tini.deb && rm -rf /var/lib/apt/lists/*;\n\nENV JAVA_HOME=/usr/lib/jvm/java-8-openjdk-amd64\nRUN echo \"$LOG_TAG Install java8\" && \\\n    apt-get -y update && \\\n    apt-get install --no-install-recommends -y openjdk-8-jdk && \\\n    rm -rf /var/lib/apt/lists/*\n\n# should install conda first before numpy, matploylib since pip and python will be installed by conda\nRUN echo \"$LOG_TAG Install miniconda3 related packages\" && \\\n    apt-get -y update && \\\n    apt-get install --no-install-recommends -y bzip2 ca-certificates \\\n    libglib2.0-0 libxext6 libsm6 libxrender1 \\\n    git mercurial subversion && \\\n    echo 'export PATH=/opt/conda/bin:$PATH' > /etc/profile.d/conda.sh && \\\n    wget --quiet https://repo.continuum.io/miniconda/Miniconda3-4.6.14-Linux-x86_64.sh -O ~/miniconda.sh && \\\n    /bin/bash ~/miniconda.sh -b -p /opt/conda && \\\n    rm ~/miniconda.sh && rm -rf /var/lib/apt/lists/*;\n\nENV PATH /opt/conda/bin:$PATH\n\nRUN echo \"$LOG_TAG Install python related packages\" && \\\n    apt-get -y update && \\\n    apt-get install --no-install-recommends -y python-dev python-pip && \\\n    apt-get install --no-install-recommends -y gfortran && \\\n    # numerical/algebra packages\n    apt-get install --no-install-recommends -y libblas-dev libatlas-dev liblapack-dev && \\\n    # font, image\n    apt-get install --no-install-recommends -y libpng-dev libfreetype6-dev libxft-dev && \\\n    # for tkinter\n    apt-get install --no-install-recommends -y python-tk libxml2-dev libxslt-dev zlib1g-dev && \\\n    hash -r && \\\n    conda config --set always_yes yes --set changeps1 no && \\\n    conda update -q conda && \\\n    conda info -a && \\\n    conda config --add channels conda-forge && \\\n    pip install --no-cache-dir -q pycodestyle==2.5.0 && \\\n    pip install --no-cache-dir -q numpy==1.17.3 pandas==0.25.0 scipy==1.3.1 grpcio==1.19.0 bkzep==0.6.1 hvplot==0.5.2 protobuf==3.10.0 pandasql==0.7.3 ipython==7.8.0 matplotlib==3.0.3 ipykernel==5.1.2 jupyter_client==5.3.4 bokeh==1.3.4 panel==0.6.0 holoviews==1.12.3 seaborn==0.9.0 plotnine==0.5.1 intake==0.5.3 intake-parquet==0.2.2 altair==3.2.0 pycodestyle==2.5.0 apache_beam==2.15.0 && rm -rf /var/lib/apt/lists/*;\n\nRUN echo \"$LOG_TAG Install R related packages\" && \\\n    echo \"PATH: $PATH\" && \\\n    ls /opt/conda/bin && \\\n    echo \"deb http://cran.rstudio.com/bin/linux/ubuntu xenial/\" | tee -a /etc/apt/sources.list && \\\n    apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 51716619E084DAB9 && \\\n    apt-get -y update && \\\n    apt-get -y --no-install-recommends --allow-unauthenticated install r-base r-base-dev && \\\n    R -e \"install.packages('evaluate', repos = 'https://cloud.r-project.org')\" && \\\n    R -e \"install.packages('knitr', repos='http://cran.us.r-project.org')\" && \\\n    R -e \"install.packages('ggplot2', repos='http://cran.us.r-project.org')\" && \\\n    R -e \"install.packages('googleVis', repos='http://cran.us.r-project.org')\" && \\\n    R -e \"install.packages('data.table', repos='http://cran.us.r-project.org')\" && \\\n#    R -e \"install.packages('IRkernel', repos = 'https://cloud.r-project.org');IRkernel::installspec()\" && \\\n    R -e \"install.packages('shiny', repos = 'https://cloud.r-project.org')\" && \\\n    # for devtools, Rcpp\n    apt-get -y --no-install-recommends install libcurl4-gnutls-dev libssl-dev && \\\n    R -e \"install.packages('devtools', repos='http://cran.us.r-project.org')\" && \\\n    R -e \"install.packages('Rcpp', repos='http://cran.us.r-project.org')\" && \\\n    Rscript -e \"library('devtools'); library('Rcpp'); install_github('ramnathv/rCharts')\" && rm -rf /var/lib/apt/lists/*;\n\nRUN echo \"$LOG_TAG Cleanup\" && \\\n    apt-get autoclean && \\\n    apt-get clean\n\nRUN echo \"$LOG_TAG Download Zeppelin binary\" && \\\n    wget --quiet -O /tmp/zeppelin-${Z_VERSION}-bin-all.tgz https://archive.apache.org/dist/zeppelin/zeppelin-${Z_VERSION}/zeppelin-${Z_VERSION}-bin-all.tgz && \\\n    tar -zxvf /tmp/zeppelin-${Z_VERSION}-bin-all.tgz && \\\n    rm -rf /tmp/zeppelin-${Z_VERSION}-bin-all.tgz && \\\n    mkdir -p ${Z_HOME} && \\\n    mv /zeppelin-${Z_VERSION}-bin-all/* ${Z_HOME}/ && \\\n    chown -R root:root ${Z_HOME} && \\\n    mkdir -p ${Z_HOME}/logs ${Z_HOME}/run ${Z_HOME}/webapps && \\\n    # Allow process to edit /etc/passwd, to create a user entry for zeppelin\n    chgrp root /etc/passwd && chmod ug+rw /etc/passwd && \\\n    # Give access to some specific folders\n    chmod -R 775 \"${Z_HOME}/logs\" \"${Z_HOME}/run\" \"${Z_HOME}/notebook\" \"${Z_HOME}/conf\" && \\\n    # Allow process to create new folders (e.g. webapps)\n    chmod 775 ${Z_HOME}\n\nCOPY log4j.properties ${Z_HOME}/conf/\n\nRUN rm -rf /zeppelin/notebook/'Flink Tutorial'\nRUN rm -rf /zeppelin/notebook/'Python Tutorial'\nRUN rm -rf /zeppelin/notebook/'R Tutorial'\nRUN rm -rf /zeppelin/notebook/'Spark Tutorial'\nRUN rm -rf /zeppelin/notebook/'Zeppelin Tutorial'\nARG NOTEBOOK_NAME_WITH_SPACE=\"Using Mahout_2BYEZ5EVK.zpln\"\nADD ./${NOTEBOOK_NAME_WITH_SPACE} /zeppelin/notebook/${NOTEBOOK_NAME_WITH_SPACE}\n#\nRUN apt-get install --no-install-recommends -y maven && rm -rf /var/lib/apt/lists/*;\nRUN git clone https://github.com/apache/mahout\nWORKDIR /mahout\nRUN git checkout 14.1\nRUN mvn clean install -DskipTests\n\n#include Mahout interpreter\nUSER 1000\n\nADD interpreter.json /zeppelin/conf/interpreter.json\n\n\nEXPOSE 8080\n\n\nENTRYPOINT [ \"/usr/bin/tini\", \"--\" ]\nWORKDIR ${Z_HOME}\nCMD [\"bin/zeppelin.sh\"]\n\n"
}