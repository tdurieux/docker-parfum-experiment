{
  "startTime": 1674254643265,
  "endTime": 1674254643927,
  "originalSmells": [
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 32,
        "lineEnd": 32,
        "columnStart": 4,
        "columnEnd": 103
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "# Licensed to the Apache Software Foundation (ASF) under one or more\n# contributor license agreements.  See the NOTICE file distributed with\n# this work for additional information regarding copyright ownership.\n# The ASF licenses this file to You under the Apache License, Version 2.0\n# (the \"License\"); you may not use this file except in compliance with\n# the License.  You may obtain a copy of the License at\n#\n#    http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n\nARG ZEPPELIN_DISTRIBUTION_IMAGE=zeppelin-distribution:latest\nFROM $ZEPPELIN_DISTRIBUTION_IMAGE AS zeppelin-distribution\n\n# Prepare all interpreter settings for Zeppelin server\n# This steps are not needed, if you you add only specific interpreters settings to your image\nFROM alpine:3.11 AS interpreter-settings\nCOPY --from=zeppelin-distribution /opt/zeppelin/interpreter /tmp/interpreter\nRUN mkdir -p /opt/zeppelin/interpreter && \\\n    cd /tmp/interpreter && \\\n    find . -name 'interpreter-setting.json' -exec cp --parents \\{\\} /opt/zeppelin/interpreter \\;\n\nFROM ubuntu:20.04\nLABEL maintainer=\"Apache Software Foundation <dev@zeppelin.apache.org>\"\n\nRUN set -ex && \\\n    apt-get -y update && \\\n    # Install language and other base packages\n    DEBIAN_FRONTEND=noninteractive apt-get --no-install-recommends install -y language-pack-en openjdk-8-jre-headless tini wget && \\\n    # Cleanup\n    rm -rf /var/lib/apt/lists/* && \\\n    apt-get autoclean && \\\n    apt-get clean\n\nARG version=\"0.10.0\"\n\nENV LANG=en_US.UTF-8 \\\n    LC_ALL=en_US.UTF-8 \\\n    JAVA_HOME=/usr/lib/jvm/java-8-openjdk-amd64 \\\n    VERSION=\"${version}\" \\\n    HOME=\"/opt/zeppelin\" \\\n    ZEPPELIN_HOME=\"/opt/zeppelin\" \\\n    ZEPPELIN_ADDR=\"0.0.0.0\" \\\n    ZEPPELIN_WAR_TEMPDIR=\"/tmp/webapps\"\n\n# Copy Zeppelin related files\nCOPY --from=zeppelin-distribution /opt/zeppelin/zeppelin-web-${VERSION}.war ${ZEPPELIN_HOME}/\nCOPY --from=zeppelin-distribution /opt/zeppelin/zeppelin-web-angular-${VERSION}.war ${ZEPPELIN_HOME}/\nCOPY --from=zeppelin-distribution /opt/zeppelin/conf ${ZEPPELIN_HOME}/conf\nCOPY --from=zeppelin-distribution /opt/zeppelin/bin ${ZEPPELIN_HOME}/bin\nCOPY --from=zeppelin-distribution /opt/zeppelin/lib ${ZEPPELIN_HOME}/lib\nCOPY --from=zeppelin-distribution /opt/zeppelin/plugins ${ZEPPELIN_HOME}/plugins\nCOPY --from=zeppelin-distribution /opt/zeppelin/interpreter/zeppelin-interpreter-shaded-${VERSION}.jar ${ZEPPELIN_HOME}/interpreter/zeppelin-interpreter-shaded-${VERSION}.jar\n# copy example notebooks\nCOPY --from=zeppelin-distribution /opt/zeppelin/notebook ${ZEPPELIN_HOME}/notebook\n# copy k8s files\nCOPY --from=zeppelin-distribution /opt/zeppelin/k8s ${ZEPPELIN_HOME}/k8s\n\n# Decide\n## 1) Copy and activate all interpreters (default)\nCOPY --from=interpreter-settings /opt/zeppelin/interpreter ${ZEPPELIN_HOME}/interpreter\n## 2) Copy and activate only a specific set of interpreter\n# COPY --from=zeppelin-distribution /opt/zeppelin/interpreter/spark/interpreter-setting.json ${ZEPPELIN_HOME}/interpreter/spark/interpreter-setting.json\n# COPY --from=zeppelin-distribution /opt/zeppelin/interpreter/jdbc/interpreter-setting.json ${ZEPPELIN_HOME}/interpreter/jdbc/interpreter-setting.json\n# COPY --from=zeppelin-distribution /opt/zeppelin/interpreter/md/interpreter-setting.json ${ZEPPELIN_HOME}/interpreter/md/interpreter-setting.json\n\nCOPY log4j.properties ${ZEPPELIN_HOME}/conf/\n\nRUN mkdir -p \"${ZEPPELIN_HOME}/logs\" \"${ZEPPELIN_HOME}/run\" \"${ZEPPELIN_HOME}/notebook\" \"${ZEPPELIN_HOME}/local-repo\" && \\\n     # Allow process to edit /etc/passwd, to create a user entry for zeppelin\n    chgrp root /etc/passwd && chmod ug+rw /etc/passwd && \\\n    # Give access to some specific folders\n    chmod -R 775 \"${ZEPPELIN_HOME}/logs\" \"${ZEPPELIN_HOME}/run\" \"${ZEPPELIN_HOME}/conf\" \"${ZEPPELIN_HOME}/notebook\" \"${ZEPPELIN_HOME}/local-repo\"\n\nUSER 1000\n\nEXPOSE 8080\n\nENTRYPOINT [ \"/usr/bin/tini\", \"--\" ]\nWORKDIR ${ZEPPELIN_HOME}\nCMD [\"bin/zeppelin.sh\"]\n"
}