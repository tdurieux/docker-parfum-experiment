{
  "startTime": 1674252520932,
  "endTime": 1674252521661,
  "originalSmells": [
    {
      "rule": "wgetUseHttpsUrl",
      "position": {
        "lineStart": 62,
        "lineEnd": 62,
        "columnStart": 4,
        "columnEnd": 41
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 31,
        "lineEnd": 56,
        "columnStart": 4,
        "columnEnd": 23
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "FROM ubuntu:20.04\n\nLABEL org.opencontainers.image.ref.name=\"frauhottelmann/daloradius-docker\" \\\n      org.opencontainers.image.created=$BUILD_RFC3339 \\\n      org.opencontainers.image.authors=\"frauhottelmann\" \\\n      org.opencontainers.image.documentation=\"https://github.com/frauhottelmann/daloradius-docker/blob/master/README.md\" \\\n      org.opencontainers.image.description=\"Docker image with freeradius, daloradius, apache2, php. You need to supply your own MariaDB-Server.\" \\\n      org.opencontainers.image.licenses=\"GPLv3\" \\\n      org.opencontainers.image.source=\"https://github.com/frauhottelmann/daloradius-docker\" \\\n      org.opencontainers.image.revision=$COMMIT \\\n      org.opencontainers.image.version=$VERSION \\\n      org.opencontainers.image.url=\"https://hub.docker.com/r/frauhottelmann/daloradius-docker\"\n\nSHELL [\"/bin/bash\", \"-o\", \"pipefail\", \"-c\"]\n\nARG DEBIAN_FRONTEND=noninteractive\nARG BUILD_RFC3339=\"1970-01-01T00:00:00Z\"\nARG COMMIT\nARG VERSION\n\nSTOPSIGNAL SIGKILL\n\nENV MYSQL_USER radius\nENV MYSQL_PASSWORD dalodbpass\nENV MYSQL_HOST localhost\nENV MYSQL_PORT 3306\nENV MYSQL_DATABASE radius\n\nENV TZ Europe/Berlin\n\nRUN apt-get update \\\n && apt-get install --no-install-recommends --yes \\\n                    apt-utils \\\n                    tzdata \\\n                    apache2 \\\n                    libapache2-mod-php \\\n                    cron \\\n                    freeradius-config \\\n                    freeradius-utils \\\n                    freeradius \\\n                    freeradius-common \\\n                    freeradius-mysql \\\n                    net-tools \\\n                    php \\\n                    php-common \\\n                    php-gd \\\n                    php-curl \\\n                    php-mail \\\n                    php-mail-mime \\\n                    php-db \\\n                    php-mysql \\\n                    mariadb-client \\\n                    libmysqlclient-dev \\\n                    supervisor \\\n                    unzip \\\n                    wget \\\n                    vim \\\n && rm -rf /var/lib/apt/lists/*\n\nRUN ln -snf /usr/share/zoneinfo/$TZ /etc/localtime && echo $TZ > /etc/timezone \\\n && update-ca-certificates -f \\\n && mkdir -p /tmp/pear/cache \\\n && wget https://pear.php.net/go-pear.phar \\\n && php go-pear.phar \\\n && rm go-pear.phar \\\n && pear channel-update pear.php.net \\\n && pear install -a -f DB \\\n && pear install -a -f Mail \\\n && pear install -a -f Mail_Mime\n\nENV DALO_VERSION 1.2\n\nRUN wget https://github.com/lirantal/daloradius/archive/\"$DALO_VERSION\".zip \\\n && unzip \"$DALO_VERSION\".zip \\\n && rm \"$DALO_VERSION\".zip \\\n && rm -rf /var/www/html/index.html \\\n && mv daloradius-\"$DALO_VERSION\"/* daloradius-\"$DALO_VERSION\"/.gitignore daloradius-\"$DALO_VERSION\"/.htaccess daloradius-\"$DALO_VERSION\"/.htpasswd /var/www/html \\\n && mv /var/www/html/library/daloradius.conf.php.sample /var/www/html/library/daloradius.conf.php \\\n && chown -R www-data:www-data /var/www/html \\\n && chmod 644 /var/www/html/library/daloradius.conf.php\n\nEXPOSE 1812 1813 80\n\nCOPY supervisor-apache2.conf /etc/supervisor/conf.d/apache2.conf\nCOPY supervisor-freeradius.conf /etc/supervisor/conf.d/freeradius.conf\nCOPY supervisor-dalocron.conf /etc/supervisor/conf.d/supervisor-dalocron.conf\nCOPY freeradius-default-site /etc/freeradius/3.0/sites-available/default\n\nCOPY init.sh /cbs/\nCOPY supervisor.conf /etc/\n\n# Init freeradius config\nRUN set -ex \\\n  # Enable SQL in freeradius\n  && sed -i 's|driver = \"rlm_sql_null\"|driver = \"rlm_sql_mysql\"|' /etc/freeradius/3.0/mods-available/sql \\\n  && sed -i 's|dialect = \"sqlite\"|dialect = \"mysql\"|' /etc/freeradius/3.0/mods-available/sql \\\n  && sed -i 's|dialect = ${modules.sql.dialect}|dialect = \"mysql\"|' /etc/freeradius/3.0/mods-available/sqlcounter \\\n  && sed -i '/tls {/,/}/s/\\(.*\\)/#AUTO_COMMENT#&/' /etc/freeradius/3.0/mods-available/sql \\\n  && sed -i 's|#\\s*read_clients = yes|read_clients = yes|' /etc/freeradius/3.0/mods-available/sql \\\n  && ln -s /etc/freeradius/3.0/mods-available/sql /etc/freeradius/3.0/mods-enabled/sql \\\n  && ln -s /etc/freeradius/3.0/mods-available/sqlcounter /etc/freeradius/3.0/mods-enabled/sqlcounter \\\n  && sed -i 's|instantiate {|instantiate {\\nsql|' /etc/freeradius/3.0/radiusd.conf \\\n  # Enable status in freeadius\n  && ln -s /etc/freeradius/3.0/sites-available/status /etc/freeradius/3.0/sites-enabled/status\n\nCMD [\"sh\", \"/cbs/init.sh\"]\n"
}