{
  "startTime": 1674252300879,
  "endTime": 1674252302732,
  "originalSmells": [
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 65,
        "lineEnd": 65,
        "columnStart": 4,
        "columnEnd": 46
      }
    },
    {
      "rule": "configureShouldUseBuildFlag",
      "position": {
        "lineStart": 127,
        "lineEnd": 127,
        "columnStart": 20,
        "columnEnd": 31
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 15,
        "lineEnd": 15,
        "columnStart": 22,
        "columnEnd": 45
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 17,
        "lineEnd": 20,
        "columnStart": 22,
        "columnEnd": 9
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 22,
        "lineEnd": 22,
        "columnStart": 22,
        "columnEnd": 51
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 27,
        "lineEnd": 31,
        "columnStart": 22,
        "columnEnd": 14
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 37,
        "lineEnd": 37,
        "columnStart": 22,
        "columnEnd": 52
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 41,
        "lineEnd": 44,
        "columnStart": 22,
        "columnEnd": 14
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 49,
        "lineEnd": 49,
        "columnStart": 22,
        "columnEnd": 72
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 55,
        "lineEnd": 55,
        "columnStart": 22,
        "columnEnd": 52
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 60,
        "lineEnd": 60,
        "columnStart": 22,
        "columnEnd": 72
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 77,
        "lineEnd": 77,
        "columnStart": 4,
        "columnEnd": 109
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 93,
        "lineEnd": 93,
        "columnStart": 4,
        "columnEnd": 34
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 125,
        "lineEnd": 125,
        "columnStart": 22,
        "columnEnd": 44
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 93,
        "lineEnd": 93,
        "columnStart": 4,
        "columnEnd": 34
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 15,
        "lineEnd": 15,
        "columnStart": 22,
        "columnEnd": 45
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 17,
        "lineEnd": 20,
        "columnStart": 22,
        "columnEnd": 9
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 22,
        "lineEnd": 22,
        "columnStart": 22,
        "columnEnd": 51
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 27,
        "lineEnd": 31,
        "columnStart": 22,
        "columnEnd": 14
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 37,
        "lineEnd": 37,
        "columnStart": 22,
        "columnEnd": 52
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 41,
        "lineEnd": 44,
        "columnStart": 22,
        "columnEnd": 14
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 49,
        "lineEnd": 49,
        "columnStart": 22,
        "columnEnd": 72
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 55,
        "lineEnd": 55,
        "columnStart": 22,
        "columnEnd": 52
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 60,
        "lineEnd": 60,
        "columnStart": 22,
        "columnEnd": 72
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 77,
        "lineEnd": 77,
        "columnStart": 4,
        "columnEnd": 109
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 93,
        "lineEnd": 93,
        "columnStart": 4,
        "columnEnd": 34
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 125,
        "lineEnd": 125,
        "columnStart": 22,
        "columnEnd": 44
      }
    }
  ],
  "repairedSmells": [
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 93,
        "lineEnd": 93,
        "columnStart": 4,
        "columnEnd": 58
      }
    }
  ],
  "repairedDockerfile": "# MUST BE BUILT FROM .\n# docker build . -t php7.1-cassandra -f ./Dockerfile\nFROM php:7.4-fpm\n\nMAINTAINER Romaric Mourgues <romaric.mourgues@twakeapp.com>\n\nARG TIMEZONE\nARG APCU_VERSION=5.1.11\n\n# Set timezone\nRUN ln -snf /usr/share/zoneinfo/${TIMEZONE} /etc/localtime\nRUN echo ${TIMEZONE} > /etc/timezone\nRUN printf '[PHP]\\ndate.timezone = \"%s\"\\n', ${TIMEZONE} > /usr/local/etc/php/conf.d/tzone.ini\nRUN \"date\"\n\nRUN apt-get update && apt-get install --no-install-recommends -y cron && rm -rf /var/lib/apt/lists/*;\n\nRUN apt-get update && apt-get install --no-install-recommends -y \\\n    openssl \\\n    git \\\n    unzip && rm -rf /var/lib/apt/lists/*;\n\nRUN apt-get update && apt-get install --no-install-recommends -y libpng-dev && rm -rf /var/lib/apt/lists/*;\n\n#MBSTRING\nRUN docker-php-ext-install mbstring\n\nRUN apt-get update && apt-get install --no-install-recommends -y \\\n    libfreetype6-dev \\\n    libjpeg62-turbo-dev \\\n    libmcrypt-dev \\\n    libpng-dev \\\n    && docker-php-ext-install -j$(nproc) iconv mcrypt \\\n    && docker-php-ext-configure gd --with-freetype-dir=/usr/include/ --with-jpeg-dir=/usr/include/ \\\n    && docker-php-ext-install -j$(nproc) gd && rm -rf /var/lib/apt/lists/*;\n\n#ZIP\nRUN apt-get update && apt-get install --no-install-recommends -y zlib1g-dev && rm -rf /var/lib/apt/lists/*;\nRUN docker-php-ext-install zip\n\n#GD images\nRUN apt-get update && apt-get install --no-install-recommends -y \\\n    libfreetype6-dev \\\n    libjpeg62-turbo-dev \\\n    libpng-dev \\\n    && docker-php-ext-configure gd --with-freetype-dir=/usr/include/ --with-jpeg-dir=/usr/include/ \\\n    && docker-php-ext-install -j$(nproc) gd && rm -rf /var/lib/apt/lists/*;\n\n#ZMQ\nRUN apt-get update && apt-get install --no-install-recommends -y zlib1g-dev libzmq3-dev wget git \\\n    && pecl install zmq-beta \\\n    && docker-php-ext-install zip \\\n    && docker-php-ext-enable zmq && rm -rf /var/lib/apt/lists/*;\n\n#Imagick\nRUN apt-get update && apt-get install --no-install-recommends -y ghostscript && apt-get clean && rm -rf /var/lib/apt/lists/*;\nRUN apt-get update && apt-get install -y libmagickwand-dev --no-install-recommends && rm -rf /var/lib/apt/lists/*\nRUN pecl install imagick && docker-php-ext-enable imagick\n\n#Unoconv\nRUN apt-get update && apt-get install --no-install-recommends -y --force-yes unoconv libxml2-dev && rm -rf /var/lib/apt/lists/*;\nRUN docker-php-ext-install soap\nRUN apt-get clean && rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/*\n\n# Install Composer\nRUN curl -f -sS https://getcomposer.org/installer | php -- --install-dir=/usr/local/bin --filename=composer\nRUN composer --version\n\n# Type docker-php-ext-install to see available extensions\nRUN docker-php-ext-install pdo pdo_mysql\n\nENV CASSANDRA_PHP_DRIVER_VERSION 1.3.2\n\nRUN rm /var/lib/apt/lists/* -vrf && \\\n    apt-get clean && apt-get update\n\nRUN apt-get update && \\\n    apt-get install --no-install-recommends -y git wget libssl-dev zlib1g-dev libicu-dev g++ make cmake libuv-dev libgmp-dev uuid-dev && \\\n    apt-get autoclean -y && \\\n    apt-get clean -y && rm -rf /var/lib/apt/lists/*;\n\n# Install datastax php-driver fox cassandra\nRUN git clone https://github.com/datastax/php-driver.git /usr/src/datastax-php-driver && \\\n    cd /usr/src/datastax-php-driver && \\\n    git checkout --detach v${CASSANDRA_PHP_DRIVER_VERSION} && \\\n    git submodule update --init && \\\n    cd ext && \\\n    ./install.sh && \\\n    echo extension=cassandra.so > /usr/local/etc/php/conf.d/cassandra.ini\n\n# Install PHP extensions\nRUN docker-php-ext-install zip mbstring intl opcache bcmath && \\\n    echo extension=bcmath.so > /usr/local/etc/php/conf.d/docker-php-ext-bcmath.ini && \\\n    apt-get install --no-install-recommends -y php5-xdebug && \\\n    echo zend_extension=xdebug.so > /usr/local/etc/php/conf.d/xdebug.ini && \\\n    pecl install apcu-5.1.5 && \\\n    echo extension=apcu.so > /usr/local/etc/php/conf.d/apcu.ini && \\\n    pecl install uuid && \\\n    echo extension=uuid.so > /usr/local/etc/php/conf.d/uuid.ini && rm -rf /var/lib/apt/lists/*;\n\n\nRUN php -r \"copy('https://getcomposer.org/installer', 'composer-setup.php');\" \\\n    && php composer-setup.php && php -r \"unlink('composer-setup.php');\" \\\n    && mv composer.phar /usr/local/bin/composer\n\n## Cleanup\nRUN apt-get purge -y \\\n    g++ \\\n    git \\\n    && rm -rf /var/lib/apt/lists/*\n\n#ACPU\nRUN pecl install apcu-${APCU_VERSION} && docker-php-ext-enable apcu\nRUN echo \"extension=apcu.so\" >> /usr/local/etc/php/php.ini\nRUN echo \"apc.enable_cli=1\" >> /usr/local/etc/php/php.ini\nRUN echo \"apc.enable=1\" >> /usr/local/etc/php/php.ini\n\nRUN echo 'alias sf=\"php app/console\"' >> ~/.bashrc\nRUN echo 'alias sf3=\"php bin/console\"' >> ~/.bashrc\n\nADD ./uploads.ini /usr/local/etc/php/conf.d/uploads.ini\n\nADD ./www.conf /usr/local/etc/php-fpm.d/\n\n#ENCRYPTION\nRUN apt-get update && apt-get install --no-install-recommends -y git && rm -rf /var/lib/apt/lists/*;\nRUN git clone https://github.com/jedisct1/libsodium --branch stable\nRUN cd libsodium && ./configure --build=\"$(dpkg-architecture --query DEB_BUILD_GNU_TYPE)\" && make && make check && make install\nRUN pecl install -f libsodium\nRUN echo \"extension = sodium.so\" >> /usr/local/etc/php/php.ini\n\n#Sockets for amqp\nRUN docker-php-ext-install sockets"
}