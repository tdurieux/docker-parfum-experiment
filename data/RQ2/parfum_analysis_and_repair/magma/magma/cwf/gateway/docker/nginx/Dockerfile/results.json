{
  "startTime": 1674255411811,
  "endTime": 1674255412791,
  "originalSmells": [
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 15,
        "lineEnd": 15,
        "columnStart": 21,
        "columnEnd": 43
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 15,
        "lineEnd": 15,
        "columnStart": 21,
        "columnEnd": 43
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "################################################################################\n# Copyright 2020 The Magma Authors.\n\n# This source code is licensed under the BSD-style license found in the\n# LICENSE file in the root directory of this source tree.\n\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n################################################################################\nFROM nginx\n\n# install openssl to generate default key\nRUN apt update -y && apt install --no-install-recommends openssl -y && rm -rf /var/lib/apt/lists/*;\n\n# prepare a place for nginx ssl keys\nRUN mkdir -p /etc/nginx/certs\nRUN chown root:nginx /etc/nginx/certs\nRUN chmod g+rx /etc/nginx/certs\nRUN chmod g-w /etc/nginx/certs\nRUN chmod o-rwx /etc/nginx/certs\n\n# create root CA certificate\nRUN openssl genrsa -out ngxRootCA.key 2048\nRUN openssl req -x509 -new -nodes -key ngxRootCA.key -sha256 -days 3650 \\\n    -out ngxRootCA.pem -subj \"/C=US/ST=California/L=Menlo Park/O=Facebook/OU=FBC/CN=rootca.magma.test\"\n\n# create a default key for localhost to be overridden in production\nRUN openssl genrsa -out ingress_proxy.key 2048\nRUN openssl req -new -key ingress_proxy.key -out ingress_proxy.csr \\\n    -subj \"/C=US/ST=California/L=Menlo Park/O=Facebook/OU=FBC/CN=*.magma.test\"\nRUN openssl x509 -req -in ingress_proxy.csr -CA ngxRootCA.pem -CAkey ngxRootCA.key \\\n    -CAcreateserial -out ingress_proxy.crt -days 3650 -sha256\n\n# clean up and copy root ca for controller_proxy\nRUN rm -f ngxRootCA.key ingress_proxy.csr\nRUN mv ingress_proxy.key ingress_proxy.crt ngxRootCA.pem /etc/nginx/certs/\n"
}