{
  "startTime": 1674253310109,
  "endTime": 1674253312505,
  "originalSmells": [
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 6,
        "lineEnd": 19,
        "columnStart": 4,
        "columnEnd": 15
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 22,
        "lineEnd": 43,
        "columnStart": 4,
        "columnEnd": 15
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 6,
        "lineEnd": 19,
        "columnStart": 4,
        "columnEnd": 15
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 22,
        "lineEnd": 43,
        "columnStart": 4,
        "columnEnd": 15
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 6,
        "lineEnd": 19,
        "columnStart": 4,
        "columnEnd": 15
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 22,
        "lineEnd": 43,
        "columnStart": 4,
        "columnEnd": 15
      }
    }
  ],
  "repairedSmells": [
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 6,
        "lineEnd": 19,
        "columnStart": 4,
        "columnEnd": 15
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 22,
        "lineEnd": 43,
        "columnStart": 4,
        "columnEnd": 15
      }
    }
  ],
  "repairedDockerfile": "FROM ubuntu:bionic\n\n# Adapted from https://github.com/radiokit/docker-gstreamer/blob/master/Dockerfile\nRUN apt-get -y update\n\n# Install compiler etc.\nRUN DEBIAN_FRONTEND=noninteractive apt-get --no-install-recommends install -y \\\n  autoconf \\\n  automake \\\n  autopoint \\\n  bison \\\n  flex \\\n  libtool \\\n  yasm \\\n  nasm \\\n  git-core \\\n  build-essential \\\n  gettext \\\n  pulseaudio \\\n  gtk-doc-tools && rm -rf /var/lib/apt/lists/*;\n\n# Install dependencies necessary to build our custom GStreamer build\nRUN DEBIAN_FRONTEND=noninteractive apt-get --no-install-recommends install -y \\\n  libglib2.0-dev \\\n  libpthread-stubs0-dev \\\n  libssl-dev \\\n  liborc-dev \\\n  libmpg123-dev \\\n  libmp3lame-dev \\\n  libsoup2.4-dev \\\n  libshout3-dev \\\n  libpulse-dev \\\n  libopus-dev \\\n  libgirepository1.0-dev \\\n  libsrtp2-dev \\\n  libvpx-dev \\\n  libx11-dev \\\n  libxv-dev \\\n  libxt-dev \\\n  libx264-dev \\\n  libgnutls28-dev \\\n  python-gi-dev \\\n  python-dev \\\n  libxfixes-dev && rm -rf /var/lib/apt/lists/*;\n\n\nARG GIT_COMMIT=1.16.2\nARG LIB_NICE_VERSION=0.1.16\n\n#\n# Fetch and build GStreamer\nRUN git clone -b $GIT_COMMIT git://anongit.freedesktop.org/git/gstreamer/gstreamer && \\\ncd gstreamer && \\\n./autogen.sh --prefix=/usr --disable-gtk-doc && \\\nmake -j`nproc` && \\\nmake install && \\\ncd .. && \\\nrm -rvf /gstreamer\n\n# Fetch and build gst-plugins-base\nRUN git clone -b $GIT_COMMIT --depth 1 git://anongit.freedesktop.org/git/gstreamer/gst-plugins-base && \\\ncd gst-plugins-base && \\\n./autogen.sh --prefix=/usr \\\n--disable-gtk-doc \\\n--disable-adder \\\n--disable-app \\\n#--disable-videoconvert \\\n--disable-gio \\\n--disable-subparse \\\n#--disable-tcp \\\n#--disable-videotestsrc \\\n--disable-videorate \\\n--disable-videoscale \\\n#--disable-x \\\n--disable-xvideo \\\n--disable-xshm \\\n--disable-alsa \\\n--disable-cdparanoia \\\n--disable-ivorbis \\\n--disable-libvisual \\\n--disable-pango \\\n--disable-theora && \\\nmake -j`nproc` && \\\nmake install && \\\ncd .. && \\\nrm -rvf /gst-plugins-base\n\n\n# libnice\n\n\nRUN git clone -b $LIB_NICE_VERSION git://anongit.freedesktop.org/libnice/libnice \\\n&& cd libnice \\\n&& git checkout $LIB_NICE_VERSION \\\n&& ./autogen.sh --prefix=/usr --with-gstreamer --enable-static --enable-static-plugins --enable-shared --without-gstreamer-0.10 --disable-gtk-doc --enable-compile-warnings=no \\\n&& make install && \\\ncd .. && \\\nrm -rvf /libnice\n\n\n# Fetch and build gst-plugins-good\nRUN git clone -b $GIT_COMMIT --depth 1 git://anongit.freedesktop.org/git/gstreamer/gst-plugins-good && \\\ncd gst-plugins-good && \\\n./autogen.sh --prefix=/usr \\\n--enable-ximagesrc-xfixes \\\n--disable-gtk-doc \\\n--disable-alpha \\\n--disable-avi \\\n--disable-deinterlace \\\n--disable-dtmf \\\n--disable-effectv \\\n--disable-flv \\\n--disable-flx \\\n--disable-goom \\\n--disable-goom2k1 \\\n--disable-imagefreeze \\\n--disable-interleave \\\n--disable-isomp4 \\\n#--disable-matroska \\\n--disable-monoscope \\\n#--disable-rtp \\\n#--disable-rtpmanager \\\n--disable-rtsp \\\n--disable-shapewipe \\\n--disable-smpte \\\n--disable-udp \\\n--disable-videobox \\\n--disable-videocrop \\\n--disable-videofilter \\\n--disable-videomixer \\\n--disable-y4m \\\n--disable-directsound \\\n--disable-waveform \\\n--disable-oss \\\n--disable-oss4 \\\n--disable-sunaudio \\\n--disable-osx_audio \\\n--disable-osx_video \\\n--disable-gst_v4l2 \\\n#--disable-x \\\n--disable-aalib \\\n--disable-aalibtest \\\n--disable-cairo \\\n--disable-flac \\\n--disable-gdk_pixbuf \\\n--disable-jack \\\n--disable-jpeg \\\n--disable-libcaca \\\n--disable-libdv \\\n--disable-libpng \\\n--disable-dv1394 \\\n#--disable-vpx\n&& \\\nmake -j`nproc` && \\\nmake install && \\\ncd .. && \\\nrm -rvf /gst-plugins-good\n\n# Fetch and build gst-plugins-bad\n#RUN git clone -b $GIT_BRANCH --depth 1 git://anongit.freedesktop.org/git/gstreamer/gst-plugins-bad && \\\n#cd gst-plugins-bad && \\\n#git checkout $GIT_BRANCH && \\\n#RUN git clone -b webrtc-port-range --depth 1 https://gitlab.freedesktop.org/ikreymer/gst-plugins-bad.git && \\\nRUN git clone -b $GIT_COMMIT --depth 1 https://github.com/GStreamer/gst-plugins-bad.git && \\\ncd gst-plugins-bad && \\\n./autogen.sh --prefix=/usr \\\n--disable-gtk-doc \\\n--disable-accurip \\\n--disable-adpcmdec \\\n--disable-adpcmenc \\\n--disable-aiff \\\n--disable-videoframe_audiolevel \\\n--disable-asfmux \\\n--disable-compositor \\\n--disable-bayer \\\n--disable-camerabin2 \\\n--disable-coloreffects \\\n--disable-dvbsuboverlay \\\n--disable-dvdspu \\\n--disable-faceoverlay \\\n--disable-festival \\\n--disable-fieldanalysis \\\n--disable-freeverb \\\n--disable-frei0r \\\n--disable-gaudieffects \\\n--disable-geometrictransform \\\n--disable-gdp \\\n--disable-inter \\\n--disable-interlace \\\n--disable-ivfparse \\\n--disable-ivtc \\\n--disable-jp2kdecimator \\\n--disable-jpegformat \\\n--disable-librfb \\\n--disable-midi \\\n--disable-mpegdemux \\\n--disable-mpegtsdemux \\\n--disable-mpegtsmux \\\n--disable-mpegpsmux \\\n--disable-mxf \\\n--disable-netsim \\\n--disable-onvif \\\n--disable-pcapparse \\\n--disable-pnm \\\n--disable-rawparse \\\n--disable-sdp \\\n--disable-siren \\\n--disable-smooth \\\n--disable-speed \\\n--disable-subenc \\\n--disable-timecode \\\n--disable-videofilters \\\n--disable-videoparsers \\\n--disable-videosignal \\\n--disable-vmnc \\\n--disable-y4m \\\n--disable-yadif \\\n--disable-directsound \\\n--disable-wasapi \\\n--disable-direct3d \\\n--disable-winscreencap \\\n--disable-winks \\\n--disable-android_media \\\n--disable-apple_media \\\n--disable-bluez \\\n--disable-avc \\\n--disable-shm \\\n--disable-vcd \\\n--disable-opensles \\\n--disable-uvch264 \\\n--disable-nvenc \\\n--disable-tinyalsa \\\n--disable-msdk \\\n--disable-assrender \\\n--disable-voamrwbenc \\\n--disable-voaacenc \\\n--disable-bs2b \\\n--disable-bz2 \\\n--disable-chromaprint \\\n--disable-curl \\\n--disable-dash \\\n--disable-dc1394 \\\n--disable-decklink \\\n--disable-directfb \\\n--disable-wayland \\\n--disable-webp \\\n--disable-daala \\\n--disable-dts \\\n--disable-resindvd \\\n--disable-faac \\\n--disable-faad \\\n--disable-fbdev \\\n--disable-fdk_aac \\\n--disable-flite \\\n--disable-gsm \\\n--disable-fluidsynth \\\n--disable-kate \\\n--disable-kms \\\n--disable-ladspa \\\n--disable-lv2 \\\n--disable-libde265 \\\n--disable-libmms \\\n#--disable-srtp \\\n#--disable-dtls \\\n--disable-ttml \\\n--disable-modplug \\\n--disable-mpeg2enc \\\n--disable-mplex \\\n--disable-musepack \\\n--disable-neon \\\n--disable-ofa \\\n--disable-openal \\\n--disable-opencv \\\n--disable-openexr \\\n--disable-openh264 \\\n--disable-openjpeg \\\n--disable-openmpt \\\n--disable-openni2 \\\n--disable-rsvg \\\n--disable-gl \\\n--disable-gtk3 \\\n--disable-qt \\\n--disable-vulkan \\\n--disable-teletextdec \\\n--disable-wildmidi \\\n--disable-smoothstreaming \\\n--disable-sndfile \\\n--disable-soundtouch \\\n--disable-spc \\\n--disable-gme \\\n--disable-dvb \\\n--disable-acm \\\n--disable-vdpau \\\n--disable-sbc \\\n--disable-schro \\\n--disable-zbar \\\n--disable-rtmp \\\n--disable-spandsp \\\n--disable-hls \\\n--disable-x265 \\\n--disable-webrtcdsp && \\\nmake -j`nproc` && \\\nmake install && \\\ncd .. && \\\nrm -rvf /gst-plugins-bad && echo \"\"\n\n\n# Fetch and build gst-plugins-ugly\nRUN git clone -b $GIT_COMMIT --depth 1 git://anongit.freedesktop.org/git/gstreamer/gst-plugins-ugly && \\\ncd gst-plugins-ugly && \\\n./autogen.sh --prefix=/usr \\\n--disable-gtk-doc \\\n--disable-asfdemux \\\n--disable-dvdlpcmdec \\\n--disable-dvdsub \\\n--disable-xingmux \\\n--disable-realmedia \\\n--disable-a52dec \\\n--disable-amrnb \\\n--disable-amrwb \\\n--disable-cdio \\\n--disable-dvdread \\\n--disable-sidplay \\\n#--disable-x264 \\\n&& \\\nmake -j`nproc` && \\\nmake install && \\\ncd .. && \\\nrm -rvf /gst-plugins-ugly\n\n\n\n\n# install gst-python\nRUN git clone -b $GIT_COMMIT --depth 1 git://anongit.freedesktop.org/git/gstreamer/gst-python && \\\ncd gst-python && \\\n./autogen.sh --prefix=/usr && \\\nmake -j`nproc` && \\\nmake install && \\\ncd .. && \\\nrm -rvf /gst-python\n\n# Do some cleanup\nRUN DEBIAN_FRONTEND=noninteractive apt-get clean && \\\napt-get autoremove -y\n\n# configure pulseaudio\nRUN echo \"load-module module-native-protocol-tcp auth-anonymous=1 auth-ip-acl=0.0.0.0/0\" >> /etc/pulse/default.pa\nRUN echo \"load-module module-native-protocol-unix auth-anonymous=1 socket=/tmp/.X11-unix/pulse-socket\" >> /etc/pulse/default.pa\n\nRUN sed -i '/load-module module-console-kit/s/^/#/' /etc/pulse/default.pa\n\n# env vars\nENV DISPLAY :99\n\nENV SCREEN_WIDTH 1360\nENV SCREEN_HEIGHT 1020\nENV SCREEN_DEPTH 16\n\n"
}