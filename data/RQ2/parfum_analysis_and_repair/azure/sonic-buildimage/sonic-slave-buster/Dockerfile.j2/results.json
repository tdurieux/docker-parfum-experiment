{
  "startTime": 1674248167098,
  "endTime": 1674248169667,
  "originalSmells": [
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 553,
        "lineEnd": 553,
        "columnStart": 4,
        "columnEnd": 50
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 429,
        "lineEnd": 429,
        "columnStart": 4,
        "columnEnd": 30
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 430,
        "lineEnd": 430,
        "columnStart": 4,
        "columnEnd": 35
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 434,
        "lineEnd": 434,
        "columnStart": 4,
        "columnEnd": 35
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 435,
        "lineEnd": 435,
        "columnStart": 4,
        "columnEnd": 30
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 436,
        "lineEnd": 436,
        "columnStart": 4,
        "columnEnd": 36
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 437,
        "lineEnd": 437,
        "columnStart": 4,
        "columnEnd": 30
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 440,
        "lineEnd": 440,
        "columnStart": 4,
        "columnEnd": 32
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 441,
        "lineEnd": 441,
        "columnStart": 4,
        "columnEnd": 32
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 444,
        "lineEnd": 444,
        "columnStart": 4,
        "columnEnd": 35
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 445,
        "lineEnd": 445,
        "columnStart": 4,
        "columnEnd": 35
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 446,
        "lineEnd": 446,
        "columnStart": 4,
        "columnEnd": 28
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 447,
        "lineEnd": 447,
        "columnStart": 4,
        "columnEnd": 28
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 448,
        "lineEnd": 448,
        "columnStart": 4,
        "columnEnd": 35
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 449,
        "lineEnd": 449,
        "columnStart": 4,
        "columnEnd": 35
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 454,
        "lineEnd": 454,
        "columnStart": 4,
        "columnEnd": 28
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 457,
        "lineEnd": 459,
        "columnStart": 4,
        "columnEnd": 14
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 465,
        "lineEnd": 465,
        "columnStart": 4,
        "columnEnd": 33
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 469,
        "lineEnd": 469,
        "columnStart": 4,
        "columnEnd": 30
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 473,
        "lineEnd": 473,
        "columnStart": 4,
        "columnEnd": 34
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 474,
        "lineEnd": 474,
        "columnStart": 4,
        "columnEnd": 30
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 477,
        "lineEnd": 477,
        "columnStart": 4,
        "columnEnd": 32
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 478,
        "lineEnd": 478,
        "columnStart": 4,
        "columnEnd": 32
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 479,
        "lineEnd": 479,
        "columnStart": 4,
        "columnEnd": 30
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 480,
        "lineEnd": 480,
        "columnStart": 4,
        "columnEnd": 30
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 483,
        "lineEnd": 483,
        "columnStart": 4,
        "columnEnd": 22
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 486,
        "lineEnd": 486,
        "columnStart": 4,
        "columnEnd": 31
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 487,
        "lineEnd": 487,
        "columnStart": 4,
        "columnEnd": 31
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 490,
        "lineEnd": 490,
        "columnStart": 4,
        "columnEnd": 29
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 491,
        "lineEnd": 491,
        "columnStart": 4,
        "columnEnd": 29
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 494,
        "lineEnd": 494,
        "columnStart": 4,
        "columnEnd": 29
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 497,
        "lineEnd": 497,
        "columnStart": 4,
        "columnEnd": 28
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 498,
        "lineEnd": 498,
        "columnStart": 4,
        "columnEnd": 28
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 521,
        "lineEnd": 521,
        "columnStart": 4,
        "columnEnd": 37
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 522,
        "lineEnd": 522,
        "columnStart": 4,
        "columnEnd": 25
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 546,
        "lineEnd": 546,
        "columnStart": 4,
        "columnEnd": 33
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 549,
        "lineEnd": 549,
        "columnStart": 4,
        "columnEnd": 109
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 51,
        "lineEnd": 179,
        "columnStart": 22,
        "columnEnd": 36
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 372,
        "lineEnd": 375,
        "columnStart": 4,
        "columnEnd": 17
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 382,
        "lineEnd": 383,
        "columnStart": 11,
        "columnEnd": 73
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 396,
        "lineEnd": 396,
        "columnStart": 11,
        "columnEnd": 51
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 500,
        "lineEnd": 500,
        "columnStart": 4,
        "columnEnd": 31
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 506,
        "lineEnd": 506,
        "columnStart": 4,
        "columnEnd": 26
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 509,
        "lineEnd": 509,
        "columnStart": 4,
        "columnEnd": 30
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 526,
        "lineEnd": 531,
        "columnStart": 4,
        "columnEnd": 37
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 541,
        "lineEnd": 541,
        "columnStart": 4,
        "columnEnd": 102
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 554,
        "lineEnd": 554,
        "columnStart": 4,
        "columnEnd": 29
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 372,
        "lineEnd": 375,
        "columnStart": 4,
        "columnEnd": 17
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 382,
        "lineEnd": 383,
        "columnStart": 11,
        "columnEnd": 73
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 396,
        "lineEnd": 396,
        "columnStart": 11,
        "columnEnd": 51
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 500,
        "lineEnd": 500,
        "columnStart": 4,
        "columnEnd": 31
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 506,
        "lineEnd": 506,
        "columnStart": 4,
        "columnEnd": 26
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 509,
        "lineEnd": 509,
        "columnStart": 4,
        "columnEnd": 30
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 526,
        "lineEnd": 531,
        "columnStart": 4,
        "columnEnd": 37
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 541,
        "lineEnd": 541,
        "columnStart": 4,
        "columnEnd": 102
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 554,
        "lineEnd": 554,
        "columnStart": 4,
        "columnEnd": 29
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 51,
        "lineEnd": 179,
        "columnStart": 22,
        "columnEnd": 36
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 372,
        "lineEnd": 375,
        "columnStart": 4,
        "columnEnd": 17
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 382,
        "lineEnd": 383,
        "columnStart": 11,
        "columnEnd": 73
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 396,
        "lineEnd": 396,
        "columnStart": 11,
        "columnEnd": 51
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 500,
        "lineEnd": 500,
        "columnStart": 4,
        "columnEnd": 31
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 506,
        "lineEnd": 506,
        "columnStart": 4,
        "columnEnd": 26
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 509,
        "lineEnd": 509,
        "columnStart": 4,
        "columnEnd": 30
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 526,
        "lineEnd": 531,
        "columnStart": 4,
        "columnEnd": 37
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 541,
        "lineEnd": 541,
        "columnStart": 4,
        "columnEnd": 102
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 554,
        "lineEnd": 554,
        "columnStart": 4,
        "columnEnd": 29
      }
    }
  ],
  "repairedSmells": [
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 372,
        "lineEnd": 375,
        "columnStart": 4,
        "columnEnd": 17
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 382,
        "lineEnd": 383,
        "columnStart": 11,
        "columnEnd": 72
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 396,
        "lineEnd": 396,
        "columnStart": 11,
        "columnEnd": 75
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 500,
        "lineEnd": 500,
        "columnStart": 4,
        "columnEnd": 55
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 506,
        "lineEnd": 506,
        "columnStart": 4,
        "columnEnd": 50
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 509,
        "lineEnd": 509,
        "columnStart": 4,
        "columnEnd": 54
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 526,
        "lineEnd": 531,
        "columnStart": 4,
        "columnEnd": 37
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 541,
        "lineEnd": 541,
        "columnStart": 4,
        "columnEnd": 126
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 554,
        "lineEnd": 554,
        "columnStart": 4,
        "columnEnd": 53
      }
    }
  ],
  "repairedDockerfile": "{% set prefix = DEFAULT_CONTAINER_REGISTRY %}\n{%- if CONFIGURED_ARCH == \"armhf\" and MULTIARCH_QEMU_ENVIRON == \"y\" %}\nFROM {{ prefix }}multiarch/qemu-user-static:x86_64-arm-5.0.0-2 as qemu\nFROM {{ prefix }}multiarch/debian-debootstrap:armhf-buster\nCOPY --from=qemu /usr/bin/qemu-arm-static /usr/bin\n{%- elif CONFIGURED_ARCH == \"arm64\" and MULTIARCH_QEMU_ENVIRON == \"y\" %}\nFROM {{ prefix }}multiarch/debian-debootstrap:arm64-buster\n{%- else -%}\nFROM {{ prefix }}debian:buster\n{%- endif %}\n\nMAINTAINER gulv@microsoft.com\n\nCOPY [\"no-check-valid-until\", \"/etc/apt/apt.conf.d/\"]\n\nRUN echo \"deb [arch=amd64] http://debian-archive.trafficmanager.net/debian/ buster main contrib non-free\" >> /etc/apt/sources.list && \\\n        echo \"deb-src [arch=amd64] http://debian-archive.trafficmanager.net/debian/ buster main contrib non-free\" >> /etc/apt/sources.list && \\\n        echo \"deb [arch=amd64] http://debian-archive.trafficmanager.net/debian-security/ buster/updates main contrib non-free\" >> /etc/apt/sources.list && \\\n        echo \"deb-src [arch=amd64] http://debian-archive.trafficmanager.net/debian-security/ buster/updates main contrib non-free\" >> /etc/apt/sources.list && \\\n        echo \"deb [arch=amd64] http://debian-archive.trafficmanager.net/debian buster-backports main\" >> /etc/apt/sources.list && \\\n        echo \"deb [arch=amd64] http://packages.trafficmanager.net/debian/debian buster main contrib non-free\" >> /etc/apt/sources.list && \\\n        echo \"deb [arch=amd64] http://packages.trafficmanager.net/debian/debian buster-updates main contrib non-free\" >> /etc/apt/sources.list && \\\n        echo \"deb [arch=amd64] http://packages.trafficmanager.net/debian/debian-security buster_updates main contrib non-free\" >> /etc/apt/sources.list\n\n{%- if CONFIGURED_ARCH == \"armhf\" %}\nRUN echo \"deb [arch=armhf] http://deb.debian.org/debian buster main contrib non-free\" > /etc/apt/sources.list && \\\n        echo \"deb-src [arch=armhf] http://deb.debian.org/debian buster main contrib non-free\" >> /etc/apt/sources.list && \\\n        echo \"deb [arch=armhf] http://deb.debian.org/debian buster-updates main contrib non-free\" >> /etc/apt/sources.list && \\\n        echo \"deb-src [arch=armhf] http://deb.debian.org/debian buster-updates main contrib non-free\" >> /etc/apt/sources.list && \\\n        echo \"deb [arch=armhf] http://security.debian.org buster/updates main contrib non-free\" >> /etc/apt/sources.list && \\\n        echo \"deb-src [arch=armhf] http://security.debian.org buster/updates main contrib non-free\" >> /etc/apt/sources.list && \\\n        echo 'deb [arch=armhf] http://ftp.debian.org/debian buster-backports main' >> /etc/apt/sources.list && \\\n        echo \"deb [arch=armhf] http://packages.trafficmanager.net/debian/debian buster main contrib non-free\" >> /etc/apt/sources.list && \\\n        echo \"deb [arch=armhf] http://packages.trafficmanager.net/debian/debian buster-updates main contrib non-free\" >> /etc/apt/sources.list && \\\n        echo \"deb [arch=arm64] http://packages.trafficmanager.net/debian/debian-security buster_updates main contrib non-free\" >> /etc/apt/sources.list\n{%- elif CONFIGURED_ARCH == \"arm64\" %}\nRUN echo \"deb [arch=arm64] http://deb.debian.org/debian buster main contrib non-free\" > /etc/apt/sources.list && \\\n        echo \"deb-src [arch=arm64] http://deb.debian.org/debian buster main contrib non-free\" >> /etc/apt/sources.list && \\\n        echo \"deb [arch=arm64] http://deb.debian.org/debian buster-updates main contrib non-free\" >> /etc/apt/sources.list && \\\n        echo \"deb-src [arch=arm64] http://deb.debian.org/debian buster-updates main contrib non-free\" >> /etc/apt/sources.list && \\\n        echo \"deb [arch=arm64] http://security.debian.org buster/updates main contrib non-free\" >> /etc/apt/sources.list && \\\n        echo \"deb-src [arch=arm64] http://security.debian.org buster/updates main contrib non-free\" >> /etc/apt/sources.list && \\\n        echo 'deb [arch=arm64] http://ftp.debian.org/debian buster-backports main' >> /etc/apt/sources.list && \\\n        echo \"deb [arch=arm64] http://packages.trafficmanager.net/debian/debian buster main contrib non-free\" >> /etc/apt/sources.list && \\\n        echo \"deb [arch=arm64] http://packages.trafficmanager.net/debian/debian buster-updates main contrib non-free\" >> /etc/apt/sources.list && \\\n        echo \"deb [arch=arm64] http://packages.trafficmanager.net/debian/debian-security buster_updates main contrib non-free\" >> /etc/apt/sources.list\n{%- endif %}\n\n## Make apt-get non-interactive\nENV DEBIAN_FRONTEND=noninteractive\n\nRUN apt-get update && apt-get install --no-install-recommends -y \\\n        apt-utils \\\n        default-jre-headless \\\n        openssh-server \\\n        curl \\\n        wget \\\n        unzip \\\n        git \\\n        build-essential \\\n        libtool \\\n        lintian \\\n        sudo \\\n        dh-make \\\n        dh-exec \\\n        kmod \\\n        libtinyxml2-6a \\\n        libtinyxml2-dev \\\n        python \\\n        python-pip \\\n        python3 \\\n        python3-pip \\\n        libncurses5-dev \\\n        texinfo \\\n        dh-autoreconf \\\n        doxygen \\\n        devscripts \\\n        git-buildpackage \\\n        perl-modules \\\n        libswitch-perl \\\n        dh-systemd \\\n        libzmq5 \\\n        libzmq3-dev \\\n        jq \\\n\n        libreadline-dev \\\n        texlive-latex-base \\\n        texlive-generic-recommended \\\n        texlive-fonts-recommended \\\n        libpam0g-dev \\\n        libpam-dev \\\n        libcap-dev \\\n        imagemagick \\\n        ghostscript \\\n        groff \\\n        libpcre2-dev \\\n        gawk \\\n        chrpath \\\n\n        libc-ares-dev \\\n        libsnmp-dev \\\n        libjson-c3 \\\n        libjson-c-dev \\\n        libsystemd-dev \\\n        python-ipaddr \\\n        libcmocka-dev \\\n        python3-all-dev \\\n        python3-all-dbg \\\n        install-info \\\n        logrotate \\\n\n        cdbs \\\n\n        libxml-simple-perl \\\n        graphviz \\\n        aspell \\\n\n        libgetopt-long-descriptive-perl \\\n        libconst-fast-perl \\\n        libtemplate-perl \\\n        libnamespace-autoclean-perl \\\n        libmoose-perl \\\n        libmoosex-aliases-perl \\\n\n        bc \\\n        fakeroot \\\n        build-essential \\\n        devscripts \\\n        quilt \\\n        stgit \\\n        sbsigntool \\\n\n        module-assistant \\\n\n        gem2deb \\\n        libevent-dev \\\n        libglib2.0-dev \\\n        libqt4-dev \\\n        python-all-dev \\\n        python-twisted \\\n        phpunit \\\n        libbit-vector-perl \\\n        openjdk-11-jdk \\\n        javahelper \\\n        maven-debian-helper \\\n        ant \\\n        libhttpclient-java \\\n        libslf4j-java \\\n        libservlet3.1-java \\\n        qt5-default \\\n        pkg-php-tools \\\n\n        libpcre3 \\\n        libpcre3-dev \\\n        byacc \\\n        flex \\\n        libglib2.0-dev \\\n        bison \\\n        expat \\\n        libexpat1-dev \\\n        dpatch \\\n        libdb-dev \\\n        iptables-dev \\\n        ctags \\\n\n        libtool-bin \\\n        libxml2-dev \\\n\n        libusb-1.0-0-dev \\\n        libcurl3-nss-dev \\\n        libunwind8-dev \\\n        telnet \\\n        libc-ares2 \\\n        libgoogle-perftools4 \\\n\n        cpio \\\n        squashfs-tools \\\n        zip \\\n\n{%- if CONFIGURED_ARCH == \"amd64\" %} && rm -rf /var/lib/apt/lists/*;\n        linux-compiler-gcc-8-x86 \\\n{%- endif %}\n{%- if CONFIGURED_ARCH == \"armhf\" %}\n        linux-compiler-gcc-8-arm \\\n{%- endif %}\n        linux-kbuild-4.19 \\\n# teamd build\n        libdaemon-dev \\\n        libdbus-1-dev \\\n        libjansson-dev \\\n# For cavium sdk build\n        libpcap-dev \\\n        dnsutils \\\n        libusb-dev \\\n# For debian image reconfiguration\n        augeas-tools \\\n# For p4 build\n        libyaml-dev \\\n        libevent-dev \\\n        libjudy-dev \\\n        libedit-dev \\\n        libnanomsg-dev \\\n        python-stdeb \\\n# For redis build\n        libjemalloc-dev \\\n        liblua5.1-0-dev \\\n        lua-bitop-dev  \\\n        lua-cjson-dev \\\n# For mft kernel module build\n        dkms \\\n# For Jenkins static analysis, unit testing and code coverage\n        cppcheck \\\n        clang \\\n        pylint \\\n        python-pytest \\\n        python3-pytest \\\n        gcovr \\\n        python-pytest-cov \\\n        python3-pytest-cov \\\n        python-parse \\\n# For snmpd\n        default-libmysqlclient-dev \\\n        libssl-dev \\\n        libperl-dev \\\n        libpci-dev \\\n        libpci3 \\\n        libsensors5 \\\n        libsensors4-dev \\\n        libwrap0-dev \\\n# For lldpd\n\tdebhelper \\\n        autotools-dev \\\n        libbsd-dev \\\n        pkg-config \\\n        check \\\n# For mpdecimal\n        docutils-common \\\n        libjs-sphinxdoc \\\n        libjs-underscore \\\n        python-docutils \\\n        python-jinja2 \\\n        python-markupsafe \\\n        python-pygments \\\n        python-roman \\\n        python-sphinx \\\n        sphinx-common \\\n        python3-sphinx \\\n# For sonic config engine testing\n        python-dev \\\n{%- if CONFIGURED_ARCH == \"armhf\" or CONFIGURED_ARCH == \"arm64\" %}\n        libxslt-dev \\\n{%- endif %}\n# For lockfile\n        procmail \\\n# For gtest\n        libgtest-dev \\\n        cmake \\\n# For gmock\n        libgmock-dev \\\n# For pam_tacplus build\n        autoconf-archive \\\n# For iproute2\n        cm-super-minimal \\\n        libatm1-dev \\\n        libelf-dev \\\n        libmnl-dev \\\n        libselinux1-dev \\\n        linuxdoc-tools \\\n        lynx \\\n        texlive-latex-extra \\\n        texlive-latex-recommended \\\n        iproute2 \\\n# For bash\n        texi2html \\\n        sharutils \\\n        locales \\\n        time \\\n        man2html-base \\\n        libcunit1 \\\n        libcunit1-dev \\\n# For initramfs\n        shellcheck \\\n        bash-completion \\\n{%- if CONFIGURED_ARCH == \"amd64\" %}\n# For sonic vs image build\n        dosfstools \\\n        qemu-kvm \\\n        libvirt-clients \\\n{%- endif %}\n# For ntp\n        autogen \\\n        libopts25-dev \\\n        pps-tools \\\n        dh-apparmor \\\n# For lm-sensors\n        librrd8 \\\n        librrd-dev \\\n        rrdtool \\\n# For kdump-tools\n        liblzo2-dev \\\n# For iptables\n        libnetfilter-conntrack-dev \\\n        libnftnl-dev \\\n# For SAI3.7\n        protobuf-compiler \\\n        libprotobuf-dev \\\n        xxd \\\n# For DHCP Monitor tool\n        libexplain-dev \\\n        libevent-dev \\\n# For libyang\n        swig \\\n# For build dtb\n        device-tree-compiler \\\n# For sonic-mgmt-framework\n        autoconf \\\n        m4 \\\n        libxml2-utils \\\n        xsltproc \\\n        python-lxml \\\n        libexpat1-dev \\\n        libcurl3-gnutls \\\n        libcjson-dev \\\n# For WPA supplication\n        qtbase5-dev          \\\n        aspell-en            \\\n        swig3.0              \\\n        libpython2.7-dev     \\\n        libssl-dev           \\\n        dbus                 \\\n        libdbus-1-dev        \\\n        libdbus-glib-1-2     \\\n        libdbus-glib-1-dev   \\\n        libreadline-dev      \\\n        libncurses5-dev      \\\n        libpcsclite-dev      \\\n        docbook-to-man       \\\n        docbook-utils        \\\n# For kdump-tools\n        libbz2-dev \\\n# For linkmgrd\n        libboost1.71-dev \\\n        libboost-program-options1.71-dev \\\n        libboost-system1.71-dev \\\n        libboost-thread1.71-dev \\\n        libboost-atomic1.71-dev \\\n        libboost-chrono1.71-dev \\\n        libboost-container1.71-dev \\\n        libboost-context1.71-dev \\\n        libboost-contract1.71-dev \\\n        libboost-coroutine1.71-dev \\\n        libboost-date-time1.71-dev \\\n        libboost-fiber1.71-dev \\\n        libboost-filesystem1.71-dev \\\n        libboost-graph-parallel1.71-dev \\\n        libboost-log1.71-dev \\\n        libboost-regex1.71-dev \\\n        googletest \\\n        libgtest-dev \\\n        libgmock-dev \\\n        libgcc-8-dev \\\n# For sonic-host-services build\n        libcairo2-dev \\\n        libdbus-1-dev \\\n        libgirepository1.0-dev \\\n        libsystemd-dev \\\n        pkg-config \\\n# For audisp-tacplus\n        libauparse-dev \\\n        auditd\n\n# For iproute2\nRUN apt-get install --no-install-recommends -y -t buster-backports \\\n        libbpf-dev \\\n        dwz \\\n        debhelper && rm -rf /var/lib/apt/lists/*;\n\nRUN apt-get -y build-dep openssh\n\n# Build fix for ARMHF buster libsairedis\n{%- if CONFIGURED_ARCH == \"armhf\" %}\n       # Install doxygen build dependency packages\n       RUN apt install --no-install-recommends -y libxapian-dev yui-compressor libclang-3.9-dev texlive-extra-utils \\\n           texlive-font-utils rdfind llvm-6.0-dev libclang-6.0-dev sassc && rm -rf /var/lib/apt/lists/*;\n\n       # Update doxygen with 64bit file offset patch\n       RUN dget -u http://deb.debian.org/debian/pool/main/d/doxygen/doxygen_1.8.13-10.dsc && \\\n           cd doxygen-1.8.13 && \\\n           sed -i '56 a add_definitions(-D_FILE_OFFSET_BITS=64)' CMakeLists.txt && \\\n           DEB_BUILD_OPTIONS=nocheck dpkg-buildpackage -us -uc -b && \\\n           cd .. && \\\n           dpkg -i ./doxygen_1.8.13-10_armhf.deb && \\\n           rm -fr doxygen*\n\n       # Aspell is unable to locate the language dictionaries.\n       # Re-installing aspell-en dictionary to fix it.\n       RUN apt-get install --no-install-recommends --reinstall -y aspell-en && rm -rf /var/lib/apt/lists/*;\n\n       # workaround because of https://bugs.launchpad.net/qemu/+bug/1805913, just disable aspell\n       RUN cp /bin/true /usr/bin/aspell\n{%- endif %}\n\n## Config dpkg\n## install the configuration file if itâ€™s currently missing\nRUN sudo augtool --autosave \"set /files/etc/dpkg/dpkg.cfg/force-confmiss\"\n## combined with confold: overwrite configuration files that you have not modified\nRUN sudo augtool --autosave \"set /files/etc/dpkg/dpkg.cfg/force-confdef\"\n## do not modify the current configuration file, the new version is installed with a .dpkg-dist suffix\nRUN sudo augtool --autosave \"set /files/etc/dpkg/dpkg.cfg/force-confold\"\n\n# For linux build\nRUN apt-get -y build-dep linux\n\n# For gobgp and telemetry build\nRUN export VERSION=1.14.2 \\\n{%- if CONFIGURED_ARCH == \"armhf\" %}\n && wget https://storage.googleapis.com/golang/go$VERSION.linux-armv6l.tar.gz \\\n && tar -C /usr/local -xzf go$VERSION.linux-armv6l.tar.gz \\\n{%- elif CONFIGURED_ARCH == \"arm64\" %}\n && wget https://storage.googleapis.com/golang/go$VERSION.linux-arm64.tar.gz \\\n && tar -C /usr/local -xzf go$VERSION.linux-arm64.tar.gz \\\n{%- else %}\n && wget https://storage.googleapis.com/golang/go$VERSION.linux-amd64.tar.gz \\\n && tar -C /usr/local -xzf go$VERSION.linux-amd64.tar.gz \\\n{%- endif %}\n && echo 'export GOROOT=/usr/local/go' >> /etc/bash.bashrc \\\n && echo 'export PATH=$PATH:$GOROOT/bin' >> /etc/bash.bashrc \\\n && rm go$VERSION.linux-*.tar.gz\n\nRUN pip3 install --no-cache-dir --upgrade pip\nRUN pip2 install --no-cache-dir --upgrade 'pip<21'\nRUN apt-get purge -y python-pip python3-pip python3-yaml\n\n# For building Python packages\nRUN pip2 install --no-cache-dir setuptools==40.8.0\nRUN pip2 install --no-cache-dir wheel==0.35.1\nRUN pip3 install --no-cache-dir setuptools==49.6.00\nRUN pip3 install --no-cache-dir wheel==0.35.1\n\n# For building sonic-utilities\nRUN pip2 install --no-cache-dir fastentrypoints\nRUN pip3 install --no-cache-dir fastentrypoints\n\n# For running Python unit tests\nRUN pip2 install --no-cache-dir pytest-runner==4.4\nRUN pip3 install --no-cache-dir pytest-runner==5.2\nRUN pip2 install --no-cache-dir nose==1.3.7\nRUN pip3 install --no-cache-dir nose==1.3.7\nRUN pip2 install --no-cache-dir mockredispy==2.9.3\nRUN pip3 install --no-cache-dir mockredispy==2.9.3\n\n# For Python 2 unit tests, we need 'mock'. The last version of 'mock'\n# which supports Python 2 is 3.0.5. In Python 3, 'mock' is part of 'unittest'\n# in the standard library\nRUN pip2 install --no-cache-dir mock==3.0.5\n\n# For p4 build\nRUN pip2 install --no-cache-dir \\\n         ctypesgen==1.0.2 \\\n         crc16\n\n# For sonic config engine testing\n# Install pyangbind here, outside sonic-config-engine dependencies, as pyangbind causes enum34 to be installed.\n# enum34 causes Python 're' package to not work properly as it redefines an incompatible enum.py module\n# https://github.com/robshakir/pyangbind/issues/232\nRUN pip3 install --no-cache-dir pyangbind==0.8.1\nRUN pip3 uninstall -y enum34\n\n# For templating\nRUN pip2 install --no-cache-dir j2cli==0.3.10\n# Note: Jinja2 depends on MarkupSafe, however markupsafe 2.1.0 breaks Jinja2 2.10\n# Debian buster dist-packages include python3-markupsafe (1.1.0-1) and python3-jinja2 (2.10-2)\n# If not pinning the versions, any requirement like `MarkupSafe>=2.0` will pull latest into site-packages and mess up.\nRUN pip3 install --no-cache-dir MarkupSafe==2.0.1\nRUN pip3 install --no-cache-dir Jinja2==3.0.3\n\n# For sonic-mgmt-framework\nRUN pip2 install --no-cache-dir \"PyYAML==5.4.1\"\nRUN pip3 install --no-cache-dir \"PyYAML==5.4.1\"\nRUN pip2 install --no-cache-dir \"lxml==4.6.5\"\nRUN pip3 install --no-cache-dir \"lxml==4.6.5\"\n\n# For sonic-platform-common testing\nRUN pip3 install --no-cache-dir redis\n\n# For vs image build\nRUN pip2 install --no-cache-dir pexpect==4.6.0\nRUN pip3 install --no-cache-dir pexpect==4.8.0\n\n# For sonic-swss-common testing\nRUN pip2 install --no-cache-dir Pympler==0.8\nRUN pip3 install --no-cache-dir Pympler==0.8\n\n# For sonic_yang_model build\nRUN pip3 install --no-cache-dir pyang==2.4.0\n\n# For mgmt-framework build\nRUN pip2 install --no-cache-dir mmh3==2.5.1\nRUN pip3 install --no-cache-dir mmh3==2.5.1\n\nRUN apt-get install --no-install-recommends -y xsltproc && rm -rf /var/lib/apt/lists/*;\n\n# Install dependencies for isc-dhcp-relay build\nRUN apt-get -y build-dep isc-dhcp\n\n# Install vim\nRUN apt-get install --no-install-recommends -y vim && rm -rf /var/lib/apt/lists/*;\n\n# Install rsyslog\nRUN apt-get install --no-install-recommends -y rsyslog && rm -rf /var/lib/apt/lists/*;\n\nRUN cd /usr/src/gtest && cmake . && make -C /usr/src/gtest\n\nRUN mkdir /var/run/sshd\nEXPOSE 22\n\n# Install depot-tools (for git-retry)\nRUN git clone https://chromium.googlesource.com/chromium/tools/depot_tools.git /usr/share/depot_tools\nENV PATH /usr/share/depot_tools:$PATH\n\n# Install dependencies for dhcp relay test\nRUN pip3 install --no-cache-dir parameterized==0.8.1\nRUN pip3 install --no-cache-dir pyfakefs\n\n# Install docker engine 17.03.2~ce-0 inside docker and enable experimental feature\nRUN apt-get update\nRUN apt-get install --no-install-recommends -y \\\n           apt-transport-https \\\n           ca-certificates \\\n           curl \\\n           gnupg2 \\\n           software-properties-common && rm -rf /var/lib/apt/lists/*;\n{%- if CONFIGURED_ARCH == \"armhf\" %}\n    RUN update-ca-certificates --fresh\n{%- endif %}\nRUN curl -fsSL https://download.docker.com/linux/debian/gpg | sudo apt-key add -\nRUN add-apt-repository \\\n           \"deb [arch={{ CONFIGURED_ARCH }}] https://download.docker.com/linux/debian \\\n           $(lsb_release -cs) \\\n           stable\"\nRUN apt-get update\nRUN apt-get install --no-install-recommends -y docker-ce=5:18.09.5~3-0~debian-buster docker-ce-cli=5:18.09.5~3-0~debian-buster && rm -rf /var/lib/apt/lists/*;\nRUN echo \"DOCKER_OPTS=\\\"--experimental --storage-driver=vfs {{ DOCKER_EXTRA_OPTS }}\\\"\" >> /etc/default/docker\nRUN update-alternatives --set iptables /usr/sbin/iptables-legacy\n\n# Install m2crypto package, needed by SWI tools\nRUN pip2 install --no-cache-dir m2crypto==0.36.0\n\n# Install swi tools\nRUN pip3 install --no-cache-dir git+https://github.com/aristanetworks/swi-tools.git@bead66bf261770237f7dd21ace3774ba04a017e9\n\n{% if CONFIGURED_ARCH != \"amd64\" -%}\n# Install node.js for azure pipeline\nRUN curl -f -sL https://deb.nodesource.com/setup_14.x | bash -\nRUN apt-get install --no-install-recommends -y nodejs && rm -rf /var/lib/apt/lists/*;\n\n# Tell azure pipeline to use node.js in the docker\nLABEL \"com.azure.dev.pipelines.agent.handler.node.path\"=\"/usr/bin/node\"\n{% endif -%}\n\n# Install Bazel build system (amd64 and arm64 architectures are supported using this method)\n# TODO(PINS): Remove once pre-build Bazel binaries are available for armhf (armv7l)\n{%- if CONFIGURED_ARCH == \"amd64\" or CONFIGURED_ARCH == \"arm64\" %}\nARG bazelisk_url=https://github.com/bazelbuild/bazelisk/releases/latest/download/bazelisk-linux-{{ CONFIGURED_ARCH }}\nRUN curl -fsSL -o /usr/local/bin/bazel ${bazelisk_url} && chmod 755 /usr/local/bin/bazel\n{% endif -%}\n"
}