{
  "startTime": 1674253199286,
  "endTime": 1674253201637,
  "originalSmells": [
    {
      "rule": "wgetUseHttpsUrl",
      "position": {
        "lineStart": 64,
        "lineEnd": 64,
        "columnStart": 4,
        "columnEnd": 58
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 27,
        "lineEnd": 27,
        "columnStart": 10,
        "columnEnd": 28
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 28,
        "lineEnd": 28,
        "columnStart": 10,
        "columnEnd": 40
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 29,
        "lineEnd": 29,
        "columnStart": 10,
        "columnEnd": 29
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 30,
        "lineEnd": 30,
        "columnStart": 10,
        "columnEnd": 31
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 32,
        "lineEnd": 32,
        "columnStart": 10,
        "columnEnd": 35
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 33,
        "lineEnd": 33,
        "columnStart": 10,
        "columnEnd": 28
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 35,
        "lineEnd": 35,
        "columnStart": 10,
        "columnEnd": 75
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 41,
        "lineEnd": 41,
        "columnStart": 10,
        "columnEnd": 42
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 116,
        "lineEnd": 116,
        "columnStart": 10,
        "columnEnd": 28
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 165,
        "lineEnd": 165,
        "columnStart": 10,
        "columnEnd": 30
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 176,
        "lineEnd": 176,
        "columnStart": 42,
        "columnEnd": 59
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 189,
        "lineEnd": 189,
        "columnStart": 10,
        "columnEnd": 28
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 190,
        "lineEnd": 190,
        "columnStart": 10,
        "columnEnd": 33
      }
    },
    {
      "rule": "configureShouldUseBuildFlag",
      "position": {
        "lineStart": 114,
        "lineEnd": 114,
        "columnStart": 4,
        "columnEnd": 163
      }
    },
    {
      "rule": "tarSomethingRmTheSomething",
      "position": {
        "lineStart": 126,
        "lineEnd": 126,
        "columnStart": 4,
        "columnEnd": 32
      }
    },
    {
      "rule": "aptGetInstallUseY",
      "position": {
        "lineStart": 182,
        "lineEnd": 182,
        "columnStart": 4,
        "columnEnd": 29
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 3,
        "lineEnd": 3,
        "columnStart": 47,
        "columnEnd": 70
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 25,
        "lineEnd": 25,
        "columnStart": 4,
        "columnEnd": 622
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 59,
        "lineEnd": 59,
        "columnStart": 4,
        "columnEnd": 47
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 62,
        "lineEnd": 62,
        "columnStart": 4,
        "columnEnd": 59
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 65,
        "lineEnd": 65,
        "columnStart": 4,
        "columnEnd": 81
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 66,
        "lineEnd": 66,
        "columnStart": 4,
        "columnEnd": 74
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 68,
        "lineEnd": 68,
        "columnStart": 4,
        "columnEnd": 42
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 147,
        "lineEnd": 147,
        "columnStart": 22,
        "columnEnd": 45
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 164,
        "lineEnd": 164,
        "columnStart": 4,
        "columnEnd": 90
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 169,
        "lineEnd": 169,
        "columnStart": 4,
        "columnEnd": 34
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 172,
        "lineEnd": 172,
        "columnStart": 4,
        "columnEnd": 34
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 182,
        "lineEnd": 182,
        "columnStart": 4,
        "columnEnd": 29
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 188,
        "lineEnd": 188,
        "columnStart": 4,
        "columnEnd": 88
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 195,
        "lineEnd": 195,
        "columnStart": 4,
        "columnEnd": 48
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 200,
        "lineEnd": 200,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 25,
        "lineEnd": 25,
        "columnStart": 4,
        "columnEnd": 622
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 59,
        "lineEnd": 59,
        "columnStart": 4,
        "columnEnd": 47
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 62,
        "lineEnd": 62,
        "columnStart": 4,
        "columnEnd": 59
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 65,
        "lineEnd": 65,
        "columnStart": 4,
        "columnEnd": 81
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 66,
        "lineEnd": 66,
        "columnStart": 4,
        "columnEnd": 74
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 68,
        "lineEnd": 68,
        "columnStart": 4,
        "columnEnd": 42
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 164,
        "lineEnd": 164,
        "columnStart": 4,
        "columnEnd": 90
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 169,
        "lineEnd": 169,
        "columnStart": 4,
        "columnEnd": 34
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 172,
        "lineEnd": 172,
        "columnStart": 4,
        "columnEnd": 34
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 182,
        "lineEnd": 182,
        "columnStart": 4,
        "columnEnd": 29
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 188,
        "lineEnd": 188,
        "columnStart": 4,
        "columnEnd": 88
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 195,
        "lineEnd": 195,
        "columnStart": 4,
        "columnEnd": 48
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 200,
        "lineEnd": 200,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 3,
        "lineEnd": 3,
        "columnStart": 47,
        "columnEnd": 70
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 25,
        "lineEnd": 25,
        "columnStart": 4,
        "columnEnd": 622
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 59,
        "lineEnd": 59,
        "columnStart": 4,
        "columnEnd": 47
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 62,
        "lineEnd": 62,
        "columnStart": 4,
        "columnEnd": 59
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 65,
        "lineEnd": 65,
        "columnStart": 4,
        "columnEnd": 81
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 66,
        "lineEnd": 66,
        "columnStart": 4,
        "columnEnd": 74
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 68,
        "lineEnd": 68,
        "columnStart": 4,
        "columnEnd": 42
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 147,
        "lineEnd": 147,
        "columnStart": 22,
        "columnEnd": 45
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 164,
        "lineEnd": 164,
        "columnStart": 4,
        "columnEnd": 90
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 169,
        "lineEnd": 169,
        "columnStart": 4,
        "columnEnd": 34
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 172,
        "lineEnd": 172,
        "columnStart": 4,
        "columnEnd": 34
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 182,
        "lineEnd": 182,
        "columnStart": 4,
        "columnEnd": 29
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 188,
        "lineEnd": 188,
        "columnStart": 4,
        "columnEnd": 88
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 195,
        "lineEnd": 195,
        "columnStart": 4,
        "columnEnd": 48
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 200,
        "lineEnd": 200,
        "columnStart": 4,
        "columnEnd": 27
      }
    }
  ],
  "repairedSmells": [
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 25,
        "lineEnd": 25,
        "columnStart": 4,
        "columnEnd": 645
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 59,
        "lineEnd": 59,
        "columnStart": 4,
        "columnEnd": 71
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 62,
        "lineEnd": 62,
        "columnStart": 4,
        "columnEnd": 83
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 65,
        "lineEnd": 65,
        "columnStart": 4,
        "columnEnd": 105
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 66,
        "lineEnd": 66,
        "columnStart": 4,
        "columnEnd": 98
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 68,
        "lineEnd": 68,
        "columnStart": 4,
        "columnEnd": 66
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 164,
        "lineEnd": 164,
        "columnStart": 4,
        "columnEnd": 114
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 169,
        "lineEnd": 169,
        "columnStart": 4,
        "columnEnd": 58
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 172,
        "lineEnd": 172,
        "columnStart": 4,
        "columnEnd": 58
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 182,
        "lineEnd": 182,
        "columnStart": 4,
        "columnEnd": 56
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 188,
        "lineEnd": 188,
        "columnStart": 4,
        "columnEnd": 112
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 195,
        "lineEnd": 195,
        "columnStart": 4,
        "columnEnd": 72
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 200,
        "lineEnd": 200,
        "columnStart": 4,
        "columnEnd": 51
      }
    }
  ],
  "repairedDockerfile": "FROM ubuntu:18.04\nLABEL maintainer=\"Brian Delhaisse <brian.delhaisse@iit.it> - Daniele Bonatto <dbonatto@ulb.ac.be>\"\n\nRUN apt-get update && yes | apt-get upgrade && apt-get -y --no-install-recommends install wget && rm -rf /var/lib/apt/lists/*;\n\n### Main Directory\n\nRUN mkdir /pyrobolearn/\nWORKDIR /pyrobolearn/\n\n### Main Downloads to avoid rebuilding the docker image every time we change something\n\nRUN wget https://bitbucket.org/rbdl/rbdl/get/default.zip\nRUN wget https://www.coin-or.org/download/source/Ipopt/Ipopt-3.12.12.zip\nRUN wget https://sourceforge.net/projects/roboticslab/files/External/nite/NiTE-Linux-x64-2.2.tar.bz2\nRUN wget -c \"https://developer.nvidia.com/compute/cuda/10.1/Prod/local_installers/cuda-repo-ubuntu1804-10-1-local-10.1.168-418.67_1.0-1_amd64.deb\"\nRUN wget -c \"https://developer.download.nvidia.com/compute/machine-learning/repos/ubuntu1804/x86_64/libcudnn7_7.6.0.64-1+cuda10.1_amd64.deb\"\nRUN wget -c \"https://developer.download.nvidia.com/compute/machine-learning/repos/ubuntu1804/x86_64/libcudnn7-dev_7.6.0.64-1+cuda10.1_amd64.deb\"\n# ! We never remove those, the image may be a little big\n\n\n### Main packages\n\n# tzdata is interactive, we don't want this\nARG DEBIAN_FRONTEND=noninteractive\nRUN apt-get -y --no-install-recommends install python3.6 python3-pip build-essential clang tzdata python3-tk cmake gcc gfortran g++ wget libpng-dev libopenblas-dev git python3.6-dev python-numpy lsb-release libeigen3-dev unzip libxi-dev libxmu-dev libusb-1.0.0-dev pkg-config freeglut3-dev libudev-dev openjdk-8-jdk usbutils libopenni-sensor-primesense0 libatlas-base-dev libprotobuf-dev libleveldb-dev libsnappy-dev libhdf5-serial-dev protobuf-compiler libboost-all-dev libgflags-dev libgoogle-glog-dev liblmdb-dev python3-protobuf protobuf-compiler python3-setuptools python3-dev libopencv-dev opencl-headers ocl-icd-opencl-dev libviennacl-dev && rm -rf /var/lib/apt/lists/*;\n# TODO I we should put all those in the requirements.txt instead but we need to be careful with the ln -s command\nRUN yes | pip3 install --no-cache-dir numpy\nRUN yes | pip3 install --no-cache-dir torch torchvision\nRUN yes | pip3 install --no-cache-dir cython\nRUN yes | pip3 install --no-cache-dir gpytorch\n# scikit-build needed first for installing the requirements properly\nRUN yes | pip3 install --no-cache-dir scikit-build\nRUN yes | pip3 install --no-cache-dir cmake\nRUN ln -s /usr/include/locale.h /usr/include/xlocale.h\nRUN yes | pip3 install --no-cache-dir git+https://github.com/python-control/python-control\n\n# Needed for slycot as the cmake did not found fortranobject.c\n# /usr/local/lib/python3.6/dist-packages/numpy/f2py/src/fortranobject.c\nRUN ln -sf /usr/local/lib/python3.6/dist-packages/numpy/ /usr/lib/python3/dist-packages/numpy\nADD requirements.txt .\nRUN yes | pip3 install --no-cache-dir -r requirements.txt\n\n\n### rbdl\n# We need to install this before ROS as ROS will trigger all the tests of rbdl and they don't work\n\nRUN mkdir rbdl\nWORKDIR /pyrobolearn/rbdl/\nRUN mv ../default.zip . && unzip default.zip && mv rbdl-rbdl-* rbdl && cd rbdl && mkdir build && cd build/ && cmake -D CMAKE_BUILD_TYPE=Release -D RBDL_BUILD_ADDON_URDFREADER=ON -D RBDL_BUILD_PYTHON_WRAPPER=ON ../ && make -j`nproc` &&  make install && cp python/rbdl.so /usr/local/lib/python3.6/dist-packages && cp python/rbdl.so /usr/local/lib/python3.6/site-packages\n\nWORKDIR /pyrobolearn/\n\n\n### ros-melodic\n\nRUN sh -c 'echo \"deb http://packages.ros.org/ros/ubuntu $(lsb_release -sc) main\" > /etc/apt/sources.list.d/ros-latest.list'\nRUN yes | apt-key adv --keyserver 'hkp://keyserver.ubuntu.com:80' --recv-key C1CF6E31E6BADE8868B172B4F42ED6FBAB17C654\nRUN apt-get update\nRUN apt-get -y --no-install-recommends install ros-melodic-desktop-full && rm -rf /var/lib/apt/lists/*;\nRUN rosdep init\nRUN rosdep update\nRUN apt-get -y --no-install-recommends install python-rosinstall ros-melodic-catkin && rm -rf /var/lib/apt/lists/*;\nRUN sh -c 'echo \"deb http://packages.osrfoundation.org/gazebo/ubuntu-stable `lsb_release -cs` main\" > /etc/apt/sources.list.d/gazebo-stable.list'\nRUN wget https://packages.osrfoundation.org/gazebo.key -O - | apt-key add -\nRUN apt-get -y --no-install-recommends install ros-melodic-gazebo-ros-pkgs ros-melodic-gazebo-ros-control && rm -rf /var/lib/apt/lists/*;\nRUN apt-get -y --no-install-recommends install ros-melodic-ros-control ros-melodic-ros-controllers && rm -rf /var/lib/apt/lists/*;\n\nRUN apt-get -y --no-install-recommends install python-catkin-tools && rm -rf /var/lib/apt/lists/*;\n#RUN echo \"source /opt/ros/melodic/setup.bash\" >> ~/.bashrc && /bin/bash -c 'source ~/.bashrc'\n#RUN /bin/bash -x -c \"source /opt/ros/melodic/setup.bash\"\nENV LD_LIBRARY_PATH=\"$LD_LIBRARY_PATH:/usr/local/lib\"\nENV OPENPOSE_PATH=\"/pyrobolearn/openpose/\"\nENV LD_LIBRARY_PATH=\"$LD_LIBRARY_PATH:/opt/ros/melodic/lib\"\nENV PATH=\"/opt/ros/melodic/bin:${PATH}\"\nENV ROS_DISTRO=\"melodic\"\nENV ROS_ETC_DIR=\"/opt/ros/melodic/etc/ros\"\nENV ROS_ROOT=\"/opt/ros/melodic/share/ros\"\nENV ROS_PYTHON_VERSION=2\nENV ROS_VERSION=1\nENV ROS_PACKAGE_PATH=\"/opt/ros/melodic/share\"\nENV ROS_MASTER_URI=\"http://localhost:11311\"\nENV PYTHONPATH=\"/opt/ros/melodic/lib/python2.7/dist-packages\"\nENV CMAKE_PREFIX_PATH=\"/opt/ros/melodic:${CMAKE_PREFIX_PATH}\"\nENV LD_LIBRARY_PATH=\"/opt/ros/melodic/lib:${LD_LIBRARY_PATH}\"\nENV PKG_CONFIG_PATH=\"/opt/ros/melodic/lib/pkgconfig\"\n\nRUN mkdir -p /pyrobolearn/catkin_ws/src && cd /pyrobolearn/catkin_ws/src && catkin_init_workspace && cd /pyrobolearn/catkin_ws/ && catkin_make\n#RUN /bin/bash -x -c \"source /pyrobolearn/catkin_ws/devel/setup.bash\"\n#RUN echo \"source /pyrobolearn/catkin_ws/devel/setup.bash\" >> ~/.bashrc && /bin/bash -c 'source ~/.bashrc'\nENV CMAKE_PREFIX_PATH=\"/pyrobolearn/catkin_ws/devel:${CMAKE_PREFIX_PATH}\"\nENV LD_LIBRARY_PATH=\"/pyrobolearn/catkin_ws/devel/lib:${LD_LIBRARY_PATH}\"\nENV ROS_PACKAGE_PATH=\"/pyrobolearn/catkin_ws/src:${ROS_PACKAGE_PATH}\"\nENV ROSLIST_PACKAGE_DIRECTORIES=\"/pyrobolearn/catkin_ws/devel/share/common-lisp\"\n\n\nWORKDIR /pyrobolearn/\n\n\n### lpopt\n\nRUN unzip Ipopt-3.12.12.zip\nWORKDIR /pyrobolearn/Ipopt-3.12.12/ThirdParty/Blas\nRUN ./get.Blas && mkdir -p build && cd build && ../configure --prefix=/usr/local --disable-shared --with-pic && make && make install\nWORKDIR /pyrobolearn/Ipopt-3.12.12/ThirdParty/Lapack\nRUN ./get.Lapack && mkdir -p build && cd build && ../configure --prefix=/usr/local --disable-shared --with-pic --with-blas=\"/usr/local/lib/libcoinblas.a -lgfortran\" && make && make install\nWORKDIR /pyrobolearn/Ipopt-3.12.12/ThirdParty/ASL\nRUN ./get.ASL\n\nWORKDIR /pyrobolearn/Ipopt-3.12.12/ThirdParty/Mumps\nRUN ./get.Mumps\n\n\nWORKDIR /pyrobolearn/Ipopt-3.12.12/\nRUN ./configure --build=\"$(dpkg-architecture --query DEB_BUILD_GNU_TYPE)\" --prefix=/usr/local/ coin_skip_warn_cxxflags=yes --with-blas=\"/usr/local/lib/libcoinblas.a -lgfortran\" --with-lapack=/usr/local/lib/libcoinlapack.a && make -j`nproc` && make test && make install\nENV LD_LIBRARY_PATH=\"${LD_LIBRARY_PATH}:/usr/local/lib/\"\nRUN yes | pip3 install --no-cache-dir ipopt\n\nWORKDIR /pyrobolearn/\n\n### openni2 and nite2\n\nRUN git clone https://github.com/occipital/OpenNI2.git && cd OpenNI2 && make -j`nproc` && ln -s $PWD/Bin/x64-Release/libOpenNI2.so /usr/local/lib && ln -s $PWD/Bin/x64-Release/OpenNI2/ /usr/local/lib/ && ldconfig && cp $PWD/Packaging/Linux/primesense-usb.rules /etc/udev/rules.d/557-primesense-usb.rules\n\nRUN git clone https://github.com/OpenKinect/libfreenect && cd libfreenect && mkdir -p build && cd build && cmake .. -DBUILD_OPENNI2_DRIVER=ON && make -j`nproc` && make install && ldconfig && ln -s /usr/local/lib/OpenNI2-FreenectDriver/libFreenectDriver.so /usr/local/lib/OpenNI2/Drivers && cd .. && cp platform/linux/udev/51-kinect.rules /etc/udev/rules.d/ && cd wrappers/python/ && python setup.py install && echo 'KERNEL == \\\"ttyUSB0\\\", MODE = \\\"0777\\\"' > 80-persistent-local-usb.rules\n\nRUN tar xvf NiTE-Linux-*.tar.bz2 && cd NiTE-*/ && ./install.sh && ln -s $PWD/Redist/libNiTE2.so /usr/local/lib/ && ln -s $PWD/Include /usr/local/include/NiTE-Linux-x64-2.2 && cd .. && ldconfig && rm NiTE-Linux-*.tar.bz2\n\n# x64\nENV OPENNI2_INCLUDE=\"/pyrobolearn/OpenNI2/Include\"\nENV OPENNI2_REDIST64=\"/pyrobolearn/OpenNI2/Bin/x64-Release\"\nENV NITE2_REDIST64=\"/pyrobolearn/NiTE-Linux-x64-2.2/Redist\"\n\n\nWORKDIR /pyrobolearn/\n\n### openpose\n\nRUN git clone https://github.com/CMU-Perceptual-Computing-Lab/openpose\nWORKDIR /pyrobolearn/openpose\n#RUN apt-get -y install sudo && useradd -m docker && echo \"docker:docker\" | chpasswd && adduser docker sudo\n# BASE  REQUIREMENTS\n# Already installed with apt at start\n# INSTALL CUDA\nRUN mv ../cuda-repo*.deb .\nRUN dpkg -i cuda-repo*.deb\nRUN apt-key add '/var/cuda-repo-10-1-local-10.1.168-418.67/7fa2af80.pub'\nRUN apt-get update && apt-get -y --no-install-recommends install cuda && rm -rf /var/lib/apt/lists/*;\nENV PATH=\"/usr/local/cuda-10.1/bin:${PATH}\"\n\n# INSTALL CUDNN\nRUN mv ../libcudnn*.deb .\nRUN dpkg -i libcudnn7_7*.deb\nRUN dpkg -i libcudnn7-dev*.deb\n\n# Openpose installation\nRUN mkdir build && cd build && cmake -DBUILD_PYTHON=ON -DPYBIND11_PYTHON_VERSION=3.6 .. && make -j`nproc` && make install\n\nRUN cp build/python/openpose/pyopenpose.cpython-36m-x86_64-linux-gnu.so /usr/local/lib/python3.6/dist-packages/\nENV OPENPOSE_PATH=/pyrobolearn/openpose/\n\nWORKDIR /pyrobolearn/\n\n# Audio\nRUN apt-get install --no-install-recommends -y libasound-dev portaudio19-dev libportaudio2 libportaudiocpp0 ffmpeg && rm -rf /var/lib/apt/lists/*; #libav-tools\nRUN yes | pip3 install --no-cache-dir pyaudio\n\n# GDAL\n\nRUN apt-get install --no-install-recommends -y libgdal-dev && rm -rf /var/lib/apt/lists/*;\nENV CPLUS_INCLUDE_PATH=/usr/include/gdal\nENV C_INCLUDE_PATH=/usr/include/gdal\nRUN apt-get install --no-install-recommends -y python-gdal && rm -rf /var/lib/apt/lists/*;\n\n# INSTALL PYROBOLEARN\nRUN git clone https://github.com/robotlearn/pyrobolearn.git\nRUN cd /pyrobolearn/pyrobolearn/ && yes | pip3 install --no-cache-dir -e .\n\nWORKDIR /pyrobolearn/pyrobolearn/\n\n# gazebo models\n\nRUN apt-get install -y --no-install-recommends mercurial && rm -rf /var/lib/apt/lists/*;\nRUN hg clone https://bitbucket.org/osrf/gazebo_models/\n\n\n# trac ik\n# TODO not found libfcl-dev\nRUN apt-get install --no-install-recommends -y libccd-dev libccd2 libfcl0.5 libnlopt-dev libnlopt0 libeigen3-dev && rm -rf /var/lib/apt/lists/*;\nRUN yes | pip3 install --no-cache-dir nlopt\nRUN yes | pip3 install --no-cache-dir catkin_pkg\n\n\nRUN cd /pyrobolearn/catkin_ws/ && git clone https://github.com/ros/cmake_modules.git && catkin_make\n\nRUN apt-get install --no-install-recommends -y ros-melodic-cmake-modules && rm -rf /var/lib/apt/lists/*;\nENV CMAKE_PREFIX_PATH /usr/local/share/trac_ik_lib/cmake/;/opt/ros/melodic/share/cmake_modules/cmake/\nRUN git clone https://bitbucket.org/traclabs/trac_ik.git\nRUN cd trac_ik/trac_ik_lib/ && mkdir build && cd build && cmake -Dkdl_parser_DIR=/opt/ros/melodic/share/kdl_parser/cmake/ -Dcmake_modules_DIR=/opt/ros/melodic/share/cmake_modules/cmake/ -DCATKIN_ENABLE_TESTING=FALSE -DPYTHON_VERSION=3.6 .. && make -j`nproc` && make install\n\nRUN apt-get install --no-install-recommends -y swig && rm -rf /var/lib/apt/lists/*;\nRUN cd trac_ik/trac_ik_python/ && mkdir build && cd build && cmake -Drospy_DIR=/opt/ros/melodic/share/rospy/cmake/ -Dtrac_ik_lib_DIR=/usr/local/share/trac_ik_lib/cmake/ -Dtf_conversions_DIR=/opt/ros/melodic/share/tf_conversions/cmake/ -DPYTHON_VERSION=3.6 .. && make -j`nproc` && make install\n\n### Finishing\n\nRUN mkdir /pyrobolearn/dev/\n\nVOLUME /pyrobolearn/dev/\nWORKDIR /pyrobolearn/dev/\n\nRUN ldconfig\nRUN printenv\nRUN cat /proc/driver/nvidia/version && nvcc -V\n\n# TODO maybe transform for alpine linux\n\n#ENTRYPOINT \"python3\"\n"
}