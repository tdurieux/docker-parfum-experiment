{
  "startTime": 1674218276480,
  "endTime": 1674218279379,
  "originalSmells": [
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 39,
        "lineEnd": 39,
        "columnStart": 4,
        "columnEnd": 49
      }
    },
    {
      "rule": "npmCacheCleanAfterInstall",
      "position": {
        "lineStart": 51,
        "lineEnd": 51,
        "columnStart": 4,
        "columnEnd": 34
      }
    },
    {
      "rule": "npmCacheCleanAfterInstall",
      "position": {
        "lineStart": 55,
        "lineEnd": 55,
        "columnStart": 4,
        "columnEnd": 15
      }
    },
    {
      "rule": "npmCacheCleanAfterInstall",
      "position": {
        "lineStart": 59,
        "lineEnd": 59,
        "columnStart": 4,
        "columnEnd": 15
      }
    },
    {
      "rule": "npmCacheCleanAfterInstall",
      "position": {
        "lineStart": 62,
        "lineEnd": 62,
        "columnStart": 4,
        "columnEnd": 38
      }
    },
    {
      "rule": "npmCacheCleanAfterInstall",
      "position": {
        "lineStart": 64,
        "lineEnd": 64,
        "columnStart": 4,
        "columnEnd": 15
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 33,
        "lineEnd": 33,
        "columnStart": 4,
        "columnEnd": 29
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 34,
        "lineEnd": 34,
        "columnStart": 4,
        "columnEnd": 22
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 32,
        "lineEnd": 32,
        "columnStart": 4,
        "columnEnd": 33
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 37,
        "lineEnd": 37,
        "columnStart": 4,
        "columnEnd": 49
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 38,
        "lineEnd": 38,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 40,
        "lineEnd": 40,
        "columnStart": 4,
        "columnEnd": 29
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 46,
        "lineEnd": 46,
        "columnStart": 4,
        "columnEnd": 26
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 32,
        "lineEnd": 32,
        "columnStart": 4,
        "columnEnd": 33
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 37,
        "lineEnd": 37,
        "columnStart": 4,
        "columnEnd": 49
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 38,
        "lineEnd": 38,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 40,
        "lineEnd": 40,
        "columnStart": 4,
        "columnEnd": 29
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 46,
        "lineEnd": 46,
        "columnStart": 4,
        "columnEnd": 26
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 32,
        "lineEnd": 32,
        "columnStart": 4,
        "columnEnd": 33
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 37,
        "lineEnd": 37,
        "columnStart": 4,
        "columnEnd": 49
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 38,
        "lineEnd": 38,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 40,
        "lineEnd": 40,
        "columnStart": 4,
        "columnEnd": 29
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 46,
        "lineEnd": 46,
        "columnStart": 4,
        "columnEnd": 26
      }
    }
  ],
  "repairedSmells": [
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 32,
        "lineEnd": 32,
        "columnStart": 4,
        "columnEnd": 57
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 37,
        "lineEnd": 37,
        "columnStart": 4,
        "columnEnd": 73
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 38,
        "lineEnd": 38,
        "columnStart": 4,
        "columnEnd": 51
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 40,
        "lineEnd": 40,
        "columnStart": 4,
        "columnEnd": 53
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 46,
        "lineEnd": 46,
        "columnStart": 4,
        "columnEnd": 50
      }
    }
  ],
  "repairedDockerfile": "# Dockerfile for aws-serverless-auth-reference-app, to make it easy to quickly try out the mobile app\n#\n# Build Docker image\n# docker build -t aws-serverless-auth-reference-app https://github.com/awslabs/aws-serverless-auth-reference-app.git\n# docker build -t aws-serverless-auth-reference-app .\n\n# Run Docker image\n# docker run --rm -it -p 8100:8100 -p 35729:35729 aws-serverless-auth-reference-app\n\n# # once you're running inside the Docker container\n# aws configure  # make sure to choose us-east-1 as the region\n# cd ./api\n# gulp deploy\n# gulp bootstrap\n# cd ../app\n# ionic serve\n# use http://localhost:8100 to browse and test app\n\n# q to quit Ionic\n# exit to exit the Docker container\n\n#=========================================================================\n\nFROM library/ubuntu:16.04\nMAINTAINER Jim Tran and Justin Pirtle\nWORKDIR /home/\nENV DIRPATH /home/aws-serverless-auth-reference-app/\n\n# update apt repository packages\nRUN apt-get update\n\n# install the AWS CLI and Python pip dependency\nRUN apt-get install --no-install-recommends -y python-pip && rm -rf /var/lib/apt/lists/*;\nRUN pip install --no-cache-dir --upgrade pip\nRUN pip install --no-cache-dir awscli\n\n# install Node.js\nRUN apt-get install --no-install-recommends -y python-software-properties && rm -rf /var/lib/apt/lists/*;\nRUN apt-get install --no-install-recommends -y curl && rm -rf /var/lib/apt/lists/*;\nRUN curl -f -sL https://deb.nodesource.com/setup_8.x | bash -\nRUN apt-get install --no-install-recommends -y nodejs && rm -rf /var/lib/apt/lists/*;\n\n# set the Node.js npm logger level for build visibility (logging minimized by default)\n# RUN npm config set loglevel info\n\n# install git and pull down source code\nRUN apt-get install --no-install-recommends -y git && rm -rf /var/lib/apt/lists/*;\nRUN git clone --depth 1 https://github.com/awslabs/aws-serverless-auth-reference-app\nRUN DIRPATH=$(pwd)/aws-serverless-auth-reference-app\n\n# install the latest Gulp CLI tools globally (you will need a newer version of Gulp CLI which supports Gulp v4)\nRUN npm install gulpjs/gulp-cli -g && npm cache clean --force;\n\n# install the Node modules for the bootstrapping process\nWORKDIR $DIRPATH/api/\nRUN npm install && npm cache clean --force;\n\n# install the Node modules for the Lambda run-time\nWORKDIR $DIRPATH/api/lambda\nRUN npm install && npm cache clean --force;\n\n# install latest version of the Ionic CLI, Cordova, and Bower tools\nRUN npm install -g ionic cordova bower && npm cache clean --force;\nWORKDIR $DIRPATH/app\nRUN npm install && npm cache clean --force;\n\n# install the Bower crypto components (for AWS request signing) - omitted for now since bower components are statically embedded\n# RUN echo '{ \"allow_root\": true }' > /root/.bowerrc\n# RUN bower install\n\n# install Cordova platform components if you would like to build the app for mobile\nRUN cordova platform remove android\nRUN cordova platform remove ios\nRUN cordova platform add android@6.X.X\nRUN cordova platform add ios@4.X.X\n\n# change prompt color\nRUN echo 'export PS1=\"\\[\\033[0;33m\\][Docker container (aws-serverless-auth-reference-app): \\w]  \\[\\033[0m\\]\"' >> /root/.bashrc\n\n# start new shell with new prompt color\nRUN bash\n\n# Expose the Ionic ports\nEXPOSE 8100 35729\nWORKDIR $DIRPATH\n\n# ENTRYPOINT aws configure && (cd api && gulp deploy) && (cd api && gulp bootstrap) && (cd app && ionic serve) && (cd api && gulp undeploy)\n"
}