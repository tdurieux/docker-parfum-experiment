{
  "startTime": 1674248202792,
  "endTime": 1674248204281,
  "originalSmells": [
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 45,
        "lineEnd": 45,
        "columnStart": 4,
        "columnEnd": 37
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 54,
        "lineEnd": 54,
        "columnStart": 1,
        "columnEnd": 49
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 63,
        "lineEnd": 63,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 75,
        "lineEnd": 75,
        "columnStart": 1,
        "columnEnd": 46
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 116,
        "lineEnd": 116,
        "columnStart": 4,
        "columnEnd": 17
      }
    },
    {
      "rule": "configureShouldUseBuildFlag",
      "position": {
        "lineStart": 70,
        "lineEnd": 70,
        "columnStart": 4,
        "columnEnd": 15
      }
    },
    {
      "rule": "configureShouldUseBuildFlag",
      "position": {
        "lineStart": 85,
        "lineEnd": 85,
        "columnStart": 28,
        "columnEnd": 54
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 4,
        "lineEnd": 4,
        "columnStart": 4,
        "columnEnd": 29
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 5,
        "lineEnd": 5,
        "columnStart": 4,
        "columnEnd": 47
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 13,
        "lineEnd": 13,
        "columnStart": 1,
        "columnEnd": 27
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 14,
        "lineEnd": 14,
        "columnStart": 1,
        "columnEnd": 43
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 15,
        "lineEnd": 15,
        "columnStart": 1,
        "columnEnd": 30
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 16,
        "lineEnd": 16,
        "columnStart": 1,
        "columnEnd": 24
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 17,
        "lineEnd": 17,
        "columnStart": 1,
        "columnEnd": 24
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 18,
        "lineEnd": 18,
        "columnStart": 1,
        "columnEnd": 24
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 19,
        "lineEnd": 19,
        "columnStart": 1,
        "columnEnd": 23
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 20,
        "lineEnd": 20,
        "columnStart": 1,
        "columnEnd": 28
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 21,
        "lineEnd": 21,
        "columnStart": 1,
        "columnEnd": 25
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 22,
        "lineEnd": 22,
        "columnStart": 1,
        "columnEnd": 28
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 23,
        "lineEnd": 23,
        "columnStart": 1,
        "columnEnd": 31
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 24,
        "lineEnd": 24,
        "columnStart": 1,
        "columnEnd": 30
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 25,
        "lineEnd": 25,
        "columnStart": 1,
        "columnEnd": 30
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 26,
        "lineEnd": 26,
        "columnStart": 1,
        "columnEnd": 37
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 27,
        "lineEnd": 27,
        "columnStart": 1,
        "columnEnd": 35
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 28,
        "lineEnd": 28,
        "columnStart": 1,
        "columnEnd": 33
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 29,
        "lineEnd": 29,
        "columnStart": 1,
        "columnEnd": 32
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 30,
        "lineEnd": 30,
        "columnStart": 1,
        "columnEnd": 29
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 31,
        "lineEnd": 31,
        "columnStart": 1,
        "columnEnd": 30
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 32,
        "lineEnd": 32,
        "columnStart": 1,
        "columnEnd": 31
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 33,
        "lineEnd": 33,
        "columnStart": 1,
        "columnEnd": 24
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 34,
        "lineEnd": 34,
        "columnStart": 1,
        "columnEnd": 35
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 38,
        "lineEnd": 38,
        "columnStart": 4,
        "columnEnd": 31
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 119,
        "lineEnd": 119,
        "columnStart": 4,
        "columnEnd": 50
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 127,
        "lineEnd": 127,
        "columnStart": 4,
        "columnEnd": 95
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 4,
        "lineEnd": 4,
        "columnStart": 4,
        "columnEnd": 29
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 5,
        "lineEnd": 5,
        "columnStart": 4,
        "columnEnd": 47
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 38,
        "lineEnd": 38,
        "columnStart": 4,
        "columnEnd": 31
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 119,
        "lineEnd": 119,
        "columnStart": 4,
        "columnEnd": 50
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 127,
        "lineEnd": 127,
        "columnStart": 4,
        "columnEnd": 95
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 4,
        "lineEnd": 4,
        "columnStart": 4,
        "columnEnd": 29
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 5,
        "lineEnd": 5,
        "columnStart": 4,
        "columnEnd": 47
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 13,
        "lineEnd": 13,
        "columnStart": 1,
        "columnEnd": 27
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 14,
        "lineEnd": 14,
        "columnStart": 1,
        "columnEnd": 43
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 15,
        "lineEnd": 15,
        "columnStart": 1,
        "columnEnd": 30
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 16,
        "lineEnd": 16,
        "columnStart": 1,
        "columnEnd": 24
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 17,
        "lineEnd": 17,
        "columnStart": 1,
        "columnEnd": 24
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 18,
        "lineEnd": 18,
        "columnStart": 1,
        "columnEnd": 24
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 19,
        "lineEnd": 19,
        "columnStart": 1,
        "columnEnd": 23
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 20,
        "lineEnd": 20,
        "columnStart": 1,
        "columnEnd": 28
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 21,
        "lineEnd": 21,
        "columnStart": 1,
        "columnEnd": 25
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 22,
        "lineEnd": 22,
        "columnStart": 1,
        "columnEnd": 28
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 23,
        "lineEnd": 23,
        "columnStart": 1,
        "columnEnd": 31
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 24,
        "lineEnd": 24,
        "columnStart": 1,
        "columnEnd": 30
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 25,
        "lineEnd": 25,
        "columnStart": 1,
        "columnEnd": 30
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 26,
        "lineEnd": 26,
        "columnStart": 1,
        "columnEnd": 37
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 27,
        "lineEnd": 27,
        "columnStart": 1,
        "columnEnd": 35
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 28,
        "lineEnd": 28,
        "columnStart": 1,
        "columnEnd": 33
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 29,
        "lineEnd": 29,
        "columnStart": 1,
        "columnEnd": 32
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 30,
        "lineEnd": 30,
        "columnStart": 1,
        "columnEnd": 29
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 31,
        "lineEnd": 31,
        "columnStart": 1,
        "columnEnd": 30
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 32,
        "lineEnd": 32,
        "columnStart": 1,
        "columnEnd": 31
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 33,
        "lineEnd": 33,
        "columnStart": 1,
        "columnEnd": 24
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 34,
        "lineEnd": 34,
        "columnStart": 1,
        "columnEnd": 35
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 38,
        "lineEnd": 38,
        "columnStart": 4,
        "columnEnd": 31
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 119,
        "lineEnd": 119,
        "columnStart": 4,
        "columnEnd": 50
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 127,
        "lineEnd": 127,
        "columnStart": 4,
        "columnEnd": 95
      }
    }
  ],
  "repairedSmells": [
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 4,
        "lineEnd": 4,
        "columnStart": 4,
        "columnEnd": 53
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 5,
        "lineEnd": 5,
        "columnStart": 4,
        "columnEnd": 71
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 38,
        "lineEnd": 38,
        "columnStart": 4,
        "columnEnd": 55
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 119,
        "lineEnd": 119,
        "columnStart": 4,
        "columnEnd": 74
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 127,
        "lineEnd": 127,
        "columnStart": 4,
        "columnEnd": 119
      }
    }
  ],
  "repairedDockerfile": "FROM ubuntu:18.04\nARG DEBIAN_FRONTEND=noninteractive\nARG SSHPASSWORD=pollenisator123\nRUN apt-get update\nRUN apt-get install --no-install-recommends -y gnupg2 && rm -rf /var/lib/apt/lists/*;\nRUN apt-get install --no-install-recommends -y apt-transport-https wget && rm -rf /var/lib/apt/lists/*;\nRUN wget -qO - https://www.mongodb.org/static/pgp/server-4.2.asc | apt-key add -\nRUN echo \"deb [ arch=amd64 ] https://repo.mongodb.org/apt/ubuntu xenial/mongodb-org/4.2 multiverse\" | tee /etc/apt/sources.list.d/mongodb-org-4.2.list\n# Dependencies\n# whatweb as whatweb\n# nikto as nikto\n# dnsrecon as dnsrecon\nRUN apt-get update && \\\n\tapt-get install --no-install-recommends -y python3 && \\\n\tapt-get install --no-install-recommends -y python3.7 python3.7-dev && \\\n\tapt-get install --no-install-recommends -y python3-tk && \\\n\tapt-get install --no-install-recommends -y wget && \\\n\tapt-get install --no-install-recommends -y curl && \\\n\tapt-get install --no-install-recommends -y nmap && \\\n\tapt-get install --no-install-recommends -y git && \\\n\tapt-get install --no-install-recommends -y dnsutils && \\\n\tapt-get install --no-install-recommends -y nikto && \\\n\tapt-get install --no-install-recommends -y dnsrecon && \\\n\tapt-get install --no-install-recommends -y python3-dev && \\\n\tapt-get install --no-install-recommends -y libssl-dev && \\\n\tapt-get install --no-install-recommends -y libffi-dev && \\\n\tapt-get install --no-install-recommends -y mongodb-org-tools && \\\n\tapt-get install --no-install-recommends -y python-requests && \\\n\tapt-get install --no-install-recommends -y ruby ruby-dev && \\\n\tapt-get install --no-install-recommends -y bsdmainutils && \\\n\tapt-get install --no-install-recommends -y smbclient && \\\n\tapt-get install --no-install-recommends -y python-dev && \\\n\tapt-get install --no-install-recommends -y python3-pip && \\\n\tapt-get install --no-install-recommends -y nano && \\\n\tapt-get install --no-install-recommends -y build-essential && rm -rf /var/lib/apt/lists/*;\nRUN wget https://github.com/pypa/get-pip/raw/fa7dc83944936bf09a0e4cb5d5ec852c0d256599/get-pip.py\nRUN python3 get-pip.py\n\nRUN apt-get install --no-install-recommends -y autoconf && rm -rf /var/lib/apt/lists/*;\n# Test SSL as testssl.sh\nRUN git clone --depth 1 https://github.com/drwetter/testssl.sh.git /home/testssl.sh && \\\n\tchmod +x /home/testssl.sh/testssl.sh && \\\n\tln -s /home/testssl.sh/testssl.sh /usr/bin/testssl.sh\n\n\nRUN pip3 install --no-cache-dir --upgrade setuptools\n# Dirsearch as dirsearch.py\nRUN git clone https://github.com/maurosoria/dirsearch.git /home/dirsearch/ && \\\n\tchmod +x /home/dirsearch/dirsearch.py && \\\n\tln -s /home/dirsearch/dirsearch.py /usr/bin/dirsearch.py\n\n\n# Sublist3r as sublist3r.py\nRUN git clone https://github.com/aboul3la/Sublist3r.git /home/sublist3r/ && \\\n\tpip3 install --no-cache-dir -r /home/sublist3r/requirements.txt && \\\n\tchmod +x /home/sublist3r/sublist3r.py && \\\n\tln -s /home/sublist3r/sublist3r.py /usr/bin/sublist3r.py\n# SSH scan as ssh_scan\nRUN gem install ssh_scan\n\n\n# crtsh as crtsh.py\nCOPY crtsh /home/crtsh\nRUN pip3 install --no-cache-dir feedparser && \\\n\tchmod +x /home/crtsh/crtsh.py && \\\n\tln -s /home/crtsh/crtsh.py /usr/bin/crtsh.py\n\n# amap as amap\nRUN git clone https://github.com/BlackArch/amap/ /home/amap/\nWORKDIR /home/amap\nRUN ./configure --build=\"$(dpkg-architecture --query DEB_BUILD_GNU_TYPE)\" && make && make install\n\n\n# Smbmap as smbmap.py\nRUN git clone https://github.com/ShawnDEvans/smbmap /home/smbmap && \\\n\tpip3 install --no-cache-dir -r /home/smbmap/requirements.txt && \\\n\tchmod +x /home/smbmap/smbmap.py && \\\n\tln -s /home/smbmap/smbmap.py /usr/bin/smbmap.py\n# enum4linux as enum4linux.pl\nRUN git clone https://github.com/portcullislabs/enum4linux /home/enum4linux && \\\n\tchmod +x /home/enum4linux/enum4linux.pl && \\\n\tln -s /home/enum4linux/enum4linux.pl /usr/bin/enum4linux.pl\n# ikescan as\nRUN git clone https://github.com/royhills/ike-scan /home/ike-scan\nWORKDIR /home/ike-scan\nRUN autoreconf --install && ./configure --build=\"$(dpkg-architecture --query DEB_BUILD_GNU_TYPE)\" --with-openssl && make && make check && make install\n\n# WhatWeb\nRUN wget https://codeload.github.com/urbanadventurer/WhatWeb/tar.gz/v0.4.9 -O /tmp/whatweb.tar.gz && \\\n\tcd /home && \\\n\ttar xvfz /tmp/whatweb.tar.gz && \\\n\tmv WhatWeb-0.4.9 whatweb && \\\n\trm /tmp/whatweb.tar.gz && \\\n\tln -s /home/whatweb/whatweb /usr/bin/whatweb\n# bluekeep scanner\nRUN git clone https://github.com/robertdavidgraham/rdpscan /home/rdpscan && cd /home/rdpscan && make && ln -s /home/rdpscan/rdpscan /usr/bin/rdpscan\n# EternalBlue\nRUN wget https://svn.nmap.org/nmap/scripts/smb-vuln-ms17-010.nse -O /usr/share/nmap/scripts/smb-vuln-ms17-010.nse\n#Searchsploit\nRUN git clone https://github.com/offensive-security/exploitdb.git /opt/exploitdb\nRUN sed 's|path_array+=(.*)|path_array+=(\"/opt/exploitdb\")|g' /opt/exploitdb/.searchsploit_rc > ~/.searchsploit_rc\nRUN ln -sf /opt/exploitdb/searchsploit /usr/local/bin/searchsploit\n#OPenrelay\nCOPY smtp-open-relay.nse /usr/share/nmap/scripts/smtp-open-relay.nse\n\n# Set timezone\nENV TZ Europe/Paris\n\n#CME\nRUN python3.7 /get-pip.py\nRUN rm /get-pip.py\nRUN git clone --recursive https://github.com/byt3bl33d3r/CrackMapExec /home/cme/\nWORKDIR /home/cme/\nRUN python3.7 -m pip install --upgrade pynacl\nRUN python3.7 -m pip install --upgrade cryptography\nRUN python3.7 -m pip install --upgrade asn1crypto\nRUN pip install --no-cache-dir .\nRUN cme smb\n# Knockpy as knockpy.py\nRUN apt-get install --no-install-recommends -y python-dnspython python-pip && rm -rf /var/lib/apt/lists/*;\nRUN python3.7 -m pip install setuptools\nRUN git clone https://github.com/guelfoweb/knock.git /home/knock && \\\n\tcd /home/knock && \\\n\tchmod +x /home/knock/knockpy/knockpy.py && \\\n\tpython3.7 /home/knock/setup.py install && \\\n\tln -s /home/knock/knockpy/knockpy.py /usr/bin/knockpy.py\n## SERVER\nRUN apt-get install --no-install-recommends -y openssh-server libcurl3 mongodb-org-shell mongodb-org-server mongodb-org && rm -rf /var/lib/apt/lists/*;\nRUN mkdir -p /data/db\nRUN adduser pollenisator && usermod -s /bin/false pollenisator && usermod -d / pollenisator && mkdir -p /etc/Pollenisator/files/ && chown root.root /etc/Pollenisator && chown pollenisator.pollenisator /etc/Pollenisator/files\nRUN echo \"pollenisator:$SSHPASSWORD\" | chpasswd\nRUN sed -i 's/Subsystem\\tsftp\\t\\/usr\\/lib\\/openssh\\/sftp-server/Subsystem sftp internal-sftp/g' /etc/ssh/sshd_config\nRUN echo \"Match User pollenisator\\n\\tChrootDirectory /etc/Pollenisator/\\n\\tPermitTunnel no\\n\\tX11Forwarding no\\n\\tAllowTcpForwarding no\\n\\tForceCommand internal-sftp\\n\\tPasswordAuthentication yes\\n\" >> /etc/ssh/sshd_config\nRUN service ssh stop\nRUN service ssh start\n# Pollenisator\nRUN git clone https://github.com/AlgoSecure/Pollenisator.git /home/Pollenisator && python3.7 -m pip install -r requirements.txt\nCOPY start.sh /home/Pollenisator/\n## CLIENT\nWORKDIR /home/Pollenisator\nCMD [\"/bin/sh\", \"-c\", \"./start.sh\"]\n"
}