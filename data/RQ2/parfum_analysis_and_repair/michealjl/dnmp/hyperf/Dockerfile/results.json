{
  "startTime": 1674215715236,
  "endTime": 1674215716760,
  "originalSmells": [
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 8,
        "lineEnd": 8,
        "columnStart": 4,
        "columnEnd": 46
      }
    },
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 20,
        "lineEnd": 20,
        "columnStart": 4,
        "columnEnd": 74
      }
    },
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 28,
        "lineEnd": 28,
        "columnStart": 4,
        "columnEnd": 96
      }
    },
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 41,
        "lineEnd": 41,
        "columnStart": 7,
        "columnEnd": 93
      }
    },
    {
      "rule": "curlUseHttpsUrl",
      "position": {
        "lineStart": 20,
        "lineEnd": 20,
        "columnStart": 4,
        "columnEnd": 74
      }
    },
    {
      "rule": "configureShouldUseBuildFlag",
      "position": {
        "lineStart": 50,
        "lineEnd": 50,
        "columnStart": 7,
        "columnEnd": 84
      }
    },
    {
      "rule": "tarSomethingRmTheSomething",
      "position": {
        "lineStart": 30,
        "lineEnd": 30,
        "columnStart": 4,
        "columnEnd": 60
      }
    },
    {
      "rule": "tarSomethingRmTheSomething",
      "position": {
        "lineStart": 46,
        "lineEnd": 46,
        "columnStart": 7,
        "columnEnd": 59
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 5,
        "lineEnd": 5,
        "columnStart": 4,
        "columnEnd": 41
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 7,
        "lineEnd": 7,
        "columnStart": 4,
        "columnEnd": 26
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 15,
        "lineEnd": 15,
        "columnStart": 4,
        "columnEnd": 43
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 27,
        "lineEnd": 27,
        "columnStart": 4,
        "columnEnd": 28
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 15,
        "lineEnd": 15,
        "columnStart": 4,
        "columnEnd": 43
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 27,
        "lineEnd": 27,
        "columnStart": 4,
        "columnEnd": 28
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 5,
        "lineEnd": 5,
        "columnStart": 4,
        "columnEnd": 41
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 7,
        "lineEnd": 7,
        "columnStart": 4,
        "columnEnd": 26
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 15,
        "lineEnd": 15,
        "columnStart": 4,
        "columnEnd": 43
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 27,
        "lineEnd": 27,
        "columnStart": 4,
        "columnEnd": 28
      }
    }
  ],
  "repairedSmells": [
    {
      "rule": "tarSomethingRmTheSomething",
      "position": {
        "lineStart": 46,
        "lineEnd": 46,
        "columnStart": 7,
        "columnEnd": 59
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 15,
        "lineEnd": 15,
        "columnStart": 4,
        "columnEnd": 67
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 27,
        "lineEnd": 27,
        "columnStart": 4,
        "columnEnd": 52
      }
    }
  ],
  "repairedDockerfile": "FROM php:7.4.8\n\nRUN  sed -i s@/archive.ubuntu.com/@/mirrors.aliyun.com/@g /etc/apt/sources.list && apt-get clean\n\nRUN apt-get update && \\\n    apt-get install --no-install-recommends -y openssl libssl-dev && \\\n    pecl channel-update pecl.php.net && \\\n    apt-get install --no-install-recommends -y git && \\\n    curl -f -sS https://getcomposer.org/installer | php && \\\n    mv composer.phar /usr/bin/composer && \\\n    composer config -g repo.packagist composer https://mirrors.aliyun.com/composer/ && rm -rf /var/lib/apt/lists/*;\n\nUSER root\n\n    # Install the zip mysqli pdo_mysql extension\nRUN apt-get install --no-install-recommends libzip-dev zip unzip -y && \\\n    docker-php-ext-configure zip && \\\n    docker-php-ext-install zip mysqli pdo_mysql sockets && rm -rf /var/lib/apt/lists/*;\n\n    # Install Php Redis Extension\nRUN curl -f 'https://pecl.php.net/get/redis-5.1.1.tgz' -o /tmp/redis-5.1.1.tgz \\\n    && cd /tmp \\\n    && pecl install redis-5.1.1.tgz \\\n    && rm -rf /tmp/redis-5.1.1.tgz \\\n    && docker-php-ext-enable redis\n\n    # Install Amqp extension\nRUN apt-get -y --no-install-recommends install cmake && \\\n    curl -f -L -o /tmp/rabbitmq-c.tar.gz https://github.com/alanxz/rabbitmq-c/archive/master.tar.gz && \\\n    mkdir -p rabbitmq-c && \\\n    tar -C rabbitmq-c -zxvf /tmp/rabbitmq-c.tar.gz --strip 1 && \\\n    cd rabbitmq-c/ && \\\n    mkdir _build && cd _build/ && \\\n    cmake .. && \\\n    cmake --build . --target install && \\\n    pecl install amqp && \\\n    docker-php-ext-enable amqp && \\\n    # Install bcmath\n    docker-php-ext-install bcmath && rm /tmp/rabbitmq-c.tar.gz && rm -rf /var/lib/apt/lists/*;\n\nRUN cd /tmp \\\n    && curl -f -SL \"https://github.com/swoole/swoole-src/archive/v4.5.2.tar.gz\" -o swoole.tar.gz \\\n    && ls -alh \\\n    # php extension:swoole\n    && cd /tmp \\\n    && mkdir -p swoole \\\n    && tar -xf swoole.tar.gz -C swoole --strip-components=1 \\\n    && ( cd swoole \\\n    && phpize \\\n    && ./configure --build=\"$(dpkg-architecture --query DEB_BUILD_GNU_TYPE)\" --enable-sockets --enable-mysqlnd --enable-openssl --enable-http2 \\\n    && make -s -j$(nproc) && make install) \\\n\n    && echo \"extension=swoole.so\" > /usr/local/etc/php/conf.d/50_swoole.ini \\\n    && echo \"swoole.use_shortname = 'Off'\" >> /usr/local/etc/php/conf.d/50_swoole.ini \\\n    # clear\n    && php -v \\\n    && php -m \\\n    && php --ri swoole && rm swoole.tar.gz\n\nUSER root\n\n    # Clean up\nRUN apt-get clean && \\\n    rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/* && \\\n    rm /var/log/lastlog /var/log/faillog\n\nENTRYPOINT [\"php\", \"/www/hyperf/bin/hyperf.php\", \"start\"]\n\nEXPOSE 9501\n"
}