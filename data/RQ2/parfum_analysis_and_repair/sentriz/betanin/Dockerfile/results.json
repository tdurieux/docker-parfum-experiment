{
  "startTime": 1674253923672,
  "endTime": 1674253924634,
  "originalSmells": [
    {
      "rule": "npmCacheCleanAfterInstall",
      "position": {
        "lineStart": 5,
        "lineEnd": 5,
        "columnStart": 4,
        "columnEnd": 15
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 2,
        "lineEnd": 2,
        "columnStart": 4,
        "columnEnd": 66
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "FROM node:16.8.0-stretch-slim AS builder-frontend\nRUN apt-get update -qq && \\\n    apt-get install -y -qq --no-install-recommends build-essential && rm -rf /var/lib/apt/lists/*;\nWORKDIR /src\nCOPY betanin_client/ .\nRUN npm install && \\\n    PRODUCTION=true npm run-script build && npm cache clean --force;\n\n\nFROM alpine:3.14.2 AS builder-mp3gain\nWORKDIR /tmp\nCOPY alpine/mp3gain/APKBUILD .\nRUN apk update && \\\n    apk add --no-cache abuild && \\\n    abuild-keygen -a -n && \\\n    REPODEST=/tmp/out abuild -F -r\n\n\nFROM alpine:3.14.2 AS builder-mp3val\nWORKDIR /tmp\nCOPY alpine/mp3val/APKBUILD .\nRUN apk update && \\\n    apk add --no-cache abuild && \\\n    abuild-keygen -a -n && \\\n    REPODEST=/tmp/out abuild -F -r\n\n\nFROM alpine:3.14.2\nLABEL org.opencontainers.image.source https://github.com/sentriz/betanin\nWORKDIR /src\nCOPY . .\nCOPY --from=builder-frontend /src/dist/ /src/betanin_client/dist/\nCOPY --from=builder-mp3gain /tmp/out/*/*.apk /pkgs/\nCOPY --from=builder-mp3val /tmp/out/*/*.apk /pkgs/\n\nENV UID=1000\nENV GID=1000\nRUN apk add --no-cache --upgrade --virtual=build-dependencies build-base libffi-dev openssl-dev python3-dev jpeg-dev libpng-dev zlib-dev jpeg-dev && \\\n    apk add --no-cache --upgrade sudo python3 libev chromaprint ffmpeg gstreamer && \\\n    apk add --no-cache --allow-untrusted /pkgs/* && \\\n    python3 -m ensurepip && \\\n    pip3 install --no-cache-dir . --requirement requirements-docker.txt && \\\n    apk del --purge build-dependencies && \\\n    rm -r /pkgs /tmp/* ~/.cache\n\nVOLUME /b/.local/share/betanin/\nVOLUME /b/.config/betanin/\nVOLUME /b/.config/beets/\n\nENV HOME=/b\nENV PYTHONUNBUFFERED=1\nENV PYTHONWARNINGS=\"ignore:Unverified HTTPS request\"\n\nENTRYPOINT [ \"/src/docker-entry\" ]\n"
}