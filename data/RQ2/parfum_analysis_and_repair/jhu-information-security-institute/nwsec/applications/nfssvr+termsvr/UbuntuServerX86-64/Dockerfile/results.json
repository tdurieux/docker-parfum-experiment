{
  "startTime": 1674215560760,
  "endTime": 1674215562137,
  "originalSmells": [
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 25,
        "lineEnd": 25,
        "columnStart": 4,
        "columnEnd": 63
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 26,
        "lineEnd": 26,
        "columnStart": 4,
        "columnEnd": 149
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 27,
        "lineEnd": 27,
        "columnStart": 4,
        "columnEnd": 64
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 30,
        "lineEnd": 30,
        "columnStart": 4,
        "columnEnd": 108
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 44,
        "lineEnd": 44,
        "columnStart": 4,
        "columnEnd": 56
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 45,
        "lineEnd": 45,
        "columnStart": 4,
        "columnEnd": 37
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 48,
        "lineEnd": 48,
        "columnStart": 4,
        "columnEnd": 40
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 25,
        "lineEnd": 25,
        "columnStart": 4,
        "columnEnd": 63
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 26,
        "lineEnd": 26,
        "columnStart": 4,
        "columnEnd": 149
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 27,
        "lineEnd": 27,
        "columnStart": 4,
        "columnEnd": 64
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 30,
        "lineEnd": 30,
        "columnStart": 4,
        "columnEnd": 108
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 44,
        "lineEnd": 44,
        "columnStart": 4,
        "columnEnd": 56
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 45,
        "lineEnd": 45,
        "columnStart": 4,
        "columnEnd": 37
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 48,
        "lineEnd": 48,
        "columnStart": 4,
        "columnEnd": 40
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 25,
        "lineEnd": 25,
        "columnStart": 4,
        "columnEnd": 63
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 26,
        "lineEnd": 26,
        "columnStart": 4,
        "columnEnd": 149
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 27,
        "lineEnd": 27,
        "columnStart": 4,
        "columnEnd": 64
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 30,
        "lineEnd": 30,
        "columnStart": 4,
        "columnEnd": 108
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 44,
        "lineEnd": 44,
        "columnStart": 4,
        "columnEnd": 56
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 45,
        "lineEnd": 45,
        "columnStart": 4,
        "columnEnd": 37
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 48,
        "lineEnd": 48,
        "columnStart": 4,
        "columnEnd": 40
      }
    }
  ],
  "repairedSmells": [
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 25,
        "lineEnd": 25,
        "columnStart": 4,
        "columnEnd": 87
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 26,
        "lineEnd": 26,
        "columnStart": 4,
        "columnEnd": 173
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 27,
        "lineEnd": 27,
        "columnStart": 4,
        "columnEnd": 88
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 30,
        "lineEnd": 30,
        "columnStart": 4,
        "columnEnd": 132
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 44,
        "lineEnd": 44,
        "columnStart": 4,
        "columnEnd": 80
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 45,
        "lineEnd": 45,
        "columnStart": 4,
        "columnEnd": 61
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 48,
        "lineEnd": 48,
        "columnStart": 4,
        "columnEnd": 64
      }
    }
  ],
  "repairedDockerfile": "# Description:\n#   This runtime environment example Dockerfile creates a container with a telnet server and a ssh server\n# Usage:\n#   We create a tar file from the current directory to resolve symlinks and then pipe that in to our build command\n#   From this directory, run $ tar -czh . | docker build -t tnfssvr_plus_termsvr -\n#   By default, runs as root\n# https://www.gnu.org/software/inetutils/\n# https://ubuntu.com/server/docs/service-openssh\n\nFROM ubuntu:20.04\n\n#https://grigorkh.medium.com/fix-tzdata-hangs-docker-image-build-cdb52cc3360d\nENV TZ=US/Eastern\nRUN ln -snf /usr/share/zoneinfo/$TZ /etc/localtime && echo $TZ > /etc/timezone\n\n#avoid question/dialog during apt-get installs\nARG DEBIAN_FRONTEND noninteractive\n\n# Setup container's ENV for systemd\nENV container docker\n\n#update\nRUN apt-get update\n\n#install utilities\nRUN apt-get install --no-install-recommends apt-utils dpkg-dev debconf debconf-utils -y && rm -rf /var/lib/apt/lists/*;\nRUN apt-get install --no-install-recommends net-tools iputils-ping iptables iproute2 wget nmap bind9-dnsutils dnsutils inetutils-traceroute openssh-server isc-dhcp-common -y && rm -rf /var/lib/apt/lists/*;\nRUN apt-get install --no-install-recommends vim acl sudo telnet ssh netcat nfs-common -y && rm -rf /var/lib/apt/lists/*;\n\n#install dependencies for systemd and syslog\nRUN apt-get install --no-install-recommends systemd systemd-sysv syslog-ng syslog-ng-core syslog-ng-mod-sql syslog-ng-mod-mongodb -y && rm -rf /var/lib/apt/lists/*;\n\nVOLUME [ \"/tmp\", \"/run\", \"/run/lock\" ]\n# Remove unnecessary units\nRUN rm -f /lib/systemd/system/multi-user.target.wants/* \\\n  /etc/systemd/system/*.wants/* \\\n  /lib/systemd/system/local-fs.target.wants/* \\\n  /lib/systemd/system/sockets.target.wants/*udev* \\\n  /lib/systemd/system/sockets.target.wants/*initctl* \\\n  /lib/systemd/system/sysinit.target.wants/systemd-tmpfiles-setup* \\\n  /lib/systemd/system/systemd-update-utmp*\nCMD [ \"/lib/systemd/systemd\", \"log-level=info\", \"unit=sysinit.target\" ]\n\n#install all the things (inetutils-inetd, openssh-server)\nRUN apt-get install --no-install-recommends inetutils-inetd inetutils-telnetd -y && rm -rf /var/lib/apt/lists/*;\nRUN apt-get install --no-install-recommends openssh-server -y && rm -rf /var/lib/apt/lists/*;\n\n#install all the things (nfs server)\nRUN apt-get install --no-install-recommends nfs-kernel-server -y && rm -rf /var/lib/apt/lists/*;\n\n#update configuration files for termsvr\nCOPY etc_ssh_sshd_config /etc/ssh/sshd_config\nCOPY etc_inetd.conf /etc/inetd.conf\n\n#update configuration files for nfssvr\nCOPY etc_exports /etc/exports\nCOPY etc_fstab /etc/fstab\n\n#create a user student with password nwsec\nRUN useradd -m student\nRUN echo 'student:nwsec' | chpasswd\nRUN useradd -m john\nRUN echo 'john:password' | chpasswd\nRUN useradd -m jane\nRUN echo 'jane:password' | chpasswd\n\n# Finished!\nRUN echo $'\\n\\\n* Container is ready, run it using $ docker run -d --name nfssvr_plus_termsvr --hostname nfssvr-plus-termsvr --add-host nfssvr-plus-termsvr.netsec-docker.isi.jhu.edu:127.0.1.1 --dns 192.168.25.10 --dns-search netsec-docker.isi.jhu.edu --privileged -v /export/nfsshare:/export/nfsshare:rw -v /nfsshare:/nfsshare:rw -v /sys/fs/cgroup:/sys/fs/cgroup:ro --network host --cpus=1 tnfssvr_plus_termsvr:latest \\n\\\n* Attach to it using $ docker exec -it nfssvr_plus_termsvr bash \\n\\\n* Enable the telnet service using # systemctl enable inetutils-inetd \\n\\\n* Enable the ssh service using # systemctl enable ssh \\n\\\n* Start the telnet service using # systemctl start inetutils-inetd \\n\\\n* Start the ssh service using # systemctl start ssh \\n\\\n* inetutils-inetd status is available using # systemctl status inetutils-inetd \\n\\\n* openssh-server status is available using # systemctl status ssh \\n\\\n* inetutils-inetd can be stopped and started as well using systemctl \\n\\\n* openssh-server can be stopped and started as well using systemctl \\n\\\n* telnet into the server by running $ telnet CONTAINERIPADDRESS \\n\\\n* ssh into the server by running $ ssh student@CONTAINERIPADDRESS \\n\\\n* nfs-kernel-server status is available using # systemctl status nfs-kernel-server \\n\\\n* nfs-kernel-server can be stopped and started as well using systemctl \\n\\\n* On the VM hosting this nfs server, create the /nfsshared directory for the volume shared with the container \\n\\\n* On the client, create /mnt/nfs and mount using $ sudo mount -vvvv -t nfs -o proto=tcp,port=2049 nfs.nwsecdocker.jhu.edu:/nfsshare /mnt/nfs'\n"
}