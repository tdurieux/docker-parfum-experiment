{
  "startTime": 1674252285677,
  "endTime": 1674252287007,
  "originalSmells": [
    {
      "rule": "npmCacheCleanAfterInstall",
      "position": {
        "lineStart": 16,
        "lineEnd": 16,
        "columnStart": 27,
        "columnEnd": 38
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "FROM node:12.18.2-alpine\n\n# RUN sed -i 's/dl-cdn.alpinelinux.org/mirrors.ustc.edu.cn/g' /etc/apk/repositories\nRUN apk update\n\nRUN apk add --no-cache autoconf automake file g++ gcc libc-dev libtool make nasm pkgconfig python zlib-dev\nENV NODE_ENV production\n\nCOPY ./web/source /usr/local/app\nCOPY ./wait-for-it.sh /usr/local/app/wait-for-it.sh\nCOPY ./web/default.yml /etc/app/default.yml\n\nWORKDIR /usr/local/app\nRUN chmod 755 wait-for-it.sh\n\nRUN npm config set registry https://registry.npm.taobao.org/\nRUN rm -rf node_modules && npm install && npm cache clean --force;\n# 包管理文件夹和包管理工具\n\n# Replace app configuration\nRUN cp -f /etc/app/default.yml ./.config/default.yml\n\nRUN npm run build\n# webpack && gulp build\n# gulp：处理html压缩/预处理/条件编译，图片压缩，精灵图自动合并等任务\n# webpack：管理模块化，构建js/css。\n\nEXPOSE 3000\nCMD bash -c \"./wait-for-it.sh db:5432 -- echo 1 && ./wait-for-it.sh rds:6379 -- echo 2 && npm run init && sleep 20 && npm start\""
}