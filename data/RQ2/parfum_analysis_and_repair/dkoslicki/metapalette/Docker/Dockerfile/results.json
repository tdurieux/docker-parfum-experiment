{
  "startTime": 1674253414762,
  "endTime": 1674253415679,
  "originalSmells": [
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 20,
        "lineEnd": 20,
        "columnStart": 1,
        "columnEnd": 28
      }
    },
    {
      "rule": "configureShouldUseBuildFlag",
      "position": {
        "lineStart": 28,
        "lineEnd": 28,
        "columnStart": 1,
        "columnEnd": 12
      }
    },
    {
      "rule": "tarSomethingRmTheSomething",
      "position": {
        "lineStart": 26,
        "lineEnd": 26,
        "columnStart": 95,
        "columnEnd": 126
      }
    },
    {
      "rule": "tarSomethingRmTheSomething",
      "position": {
        "lineStart": 56,
        "lineEnd": 56,
        "columnStart": 1,
        "columnEnd": 18
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 8,
        "lineEnd": 8,
        "columnStart": 1,
        "columnEnd": 24
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 9,
        "lineEnd": 9,
        "columnStart": 1,
        "columnEnd": 23
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 10,
        "lineEnd": 10,
        "columnStart": 1,
        "columnEnd": 35
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 11,
        "lineEnd": 11,
        "columnStart": 1,
        "columnEnd": 23
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 12,
        "lineEnd": 12,
        "columnStart": 1,
        "columnEnd": 24
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 16,
        "lineEnd": 16,
        "columnStart": 1,
        "columnEnd": 26
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 17,
        "lineEnd": 17,
        "columnStart": 1,
        "columnEnd": 67
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 19,
        "lineEnd": 19,
        "columnStart": 1,
        "columnEnd": 46
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 33,
        "lineEnd": 33,
        "columnStart": 4,
        "columnEnd": 87
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 38,
        "lineEnd": 38,
        "columnStart": 4,
        "columnEnd": 109
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 42,
        "lineEnd": 42,
        "columnStart": 4,
        "columnEnd": 34
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 33,
        "lineEnd": 33,
        "columnStart": 4,
        "columnEnd": 87
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 38,
        "lineEnd": 38,
        "columnStart": 4,
        "columnEnd": 109
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 42,
        "lineEnd": 42,
        "columnStart": 4,
        "columnEnd": 34
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 8,
        "lineEnd": 8,
        "columnStart": 1,
        "columnEnd": 24
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 9,
        "lineEnd": 9,
        "columnStart": 1,
        "columnEnd": 23
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 10,
        "lineEnd": 10,
        "columnStart": 1,
        "columnEnd": 35
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 11,
        "lineEnd": 11,
        "columnStart": 1,
        "columnEnd": 23
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 12,
        "lineEnd": 12,
        "columnStart": 1,
        "columnEnd": 24
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 16,
        "lineEnd": 16,
        "columnStart": 1,
        "columnEnd": 26
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 17,
        "lineEnd": 17,
        "columnStart": 1,
        "columnEnd": 67
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 19,
        "lineEnd": 19,
        "columnStart": 1,
        "columnEnd": 46
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 33,
        "lineEnd": 33,
        "columnStart": 4,
        "columnEnd": 87
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 38,
        "lineEnd": 38,
        "columnStart": 4,
        "columnEnd": 109
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 42,
        "lineEnd": 42,
        "columnStart": 4,
        "columnEnd": 34
      }
    }
  ],
  "repairedSmells": [
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 33,
        "lineEnd": 33,
        "columnStart": 4,
        "columnEnd": 111
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 38,
        "lineEnd": 38,
        "columnStart": 4,
        "columnEnd": 133
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 42,
        "lineEnd": 42,
        "columnStart": 4,
        "columnEnd": 58
      }
    }
  ],
  "repairedDockerfile": "#This docker file will create a docker container for the CommonKmers method\n\nFROM cami/profiling\n\nMAINTAINER David Koslicki version: 0.1\n\n#Install required packages\nRUN apt-get -y update && \\\n apt-get install --no-install-recommends -y wget && \\\n apt-get install --no-install-recommends -y g++ && \\\n apt-get install --no-install-recommends -y build-essential && \\\n apt-get install --no-install-recommends -y git && \\\n apt-get install --no-install-recommends -y gzip && rm -rf /var/lib/apt/lists/*;\n\n#Install python, biopython\nRUN apt-get -y update && \\\n apt-get install --no-install-recommends -y python && \\\n apt-get install --no-install-recommends -y python-numpy python-scipy python-dev python-pip && \\\n easy_install -f http://biopython.org/DIST/ biopython && \\\n apt-get install --no-install-recommends -y libatlas-base-dev gfortran && \\\n pip install --no-cache-dir --upgrade scipy && rm -rf /var/lib/apt/lists/*;\n\n#Install Jellyfish\nRUN apt-get -y update && \\ \n mkdir jellyfish && \\ \n cd jellyfish && \\ \n wget https://github.com/gmarcais/Jellyfish/releases/download/v2.2.3/jellyfish-2.2.3.tar.gz && tar -xzf jellyfish-2.2.3.tar.gz && \\ \n cd /jellyfish/jellyfish-2.2.3/ && \\\n ./configure --build=\"$(dpkg-architecture --query DEB_BUILD_GNU_TYPE)\" && \\\n make && \\\n cp /jellyfish/jellyfish-2.2.3/bin/jellyfish /usr/local/bin && rm jellyfish-2.2.3.tar.gz\n\n#Install ete3\nRUN apt-get install --no-install-recommends -y python-numpy python-qt4 python-lxml python-six python-matplotlib && \\\n #easy_install -U ete3 && \\\n easy_install -U ete2 && rm -rf /var/lib/apt/lists/*;\n\n#Install X server for ETE\nRUN apt-get install --no-install-recommends -y xvfb x11-xkb-utils xfonts-100dpi xfonts-75dpi xfonts-scalable xfonts-cyrillic x11-apps && rm -rf /var/lib/apt/lists/*;\n#preface all python commands with xvfb-run\n\n#Install h5py\nRUN apt-get install --no-install-recommends -y python-h5py && rm -rf /var/lib/apt/lists/*;\n\n#Get the MetaPalette code, Install query per sequence and count_in_file\nRUN git clone https://github.com/dkoslicki/MetaPalette.git && \\\n cd /MetaPalette/src/QueryPerSeq/ && \\\n g++ -I /jellyfish/jellyfish-2.2.3/include -std=c++0x -Wall -O3 -L /jellyfish/jellyfish-2.2.3/.libs -Wl,--rpath=/jellyfish/jellyfish-2.2.3/.libs query_per_sequence.cc sequence_mers.hpp -l jellyfish-2.0 -l pthread -o query_per_sequence && \\\n cp /MetaPalette/src/QueryPerSeq/query_per_sequence /usr/local/bin && \\\n ls /MetaPalette/src/Python/ | xargs -I{} cp /MetaPalette/src/Python/{} /usr/local/sbin/ && \\\n cd /MetaPalette/src/CountInFile/ && \\\n g++ -I /jellyfish/jellyfish-2.2.3/include -std=c++0x -Wall -O3 -L /jellyfish/jellyfish-2.2.3/.libs -Wl,--rpath=/jellyfish/jellyfish-2.2.3/.libs count_in_file.cc -l jellyfish-2.0 -l pthread -o count_in_file && \\\n cp /MetaPalette/src/CountInFile/count_in_file /usr/local/bin\n\n#Install Bcalm\nRUN wget https://github.com/Malfoy/bcalm/archive/1.tar.gz && \\\n tar -zxf 1.tar.gz && \\\n cd BCALM-1 && \\\n sed -i 's/-march=native//g' makefile && \\\n make && \\\n cp bcalm /usr/local/bin && rm 1.tar.gz\n\n#Make training env variable\nENV TRAINING_FILES_LIST $DCKR_MNT/input/FileNames.txt\nENV INPUT_LIST_OF_FILE_NAMES $DCKR_MNT/input/InputFileNames.txt\nENV TRAINED_DATA $DCKR_MNT/MetaPaletteData\n\n#Create tasks\nRUN cp /MetaPalette/Docker/default /dckr/etc/tasks.d/default && \\\n cp /MetaPalette/Docker/sensitive /dckr/etc/tasks.d/sensitive && \\\n cp /MetaPalette/Docker/specific /dckr/etc/tasks.d/specific && \\\n cp /MetaPalette/Docker/train /dckr/etc/tasks.d/train && \\\n echo -e \"\\n \\n NOTE: Be sure to download the training data at http://files.cgrb.oregonstate.edu/Koslicki_Lab/MetaPalette/ and uncompress it. The resulting directory should be passed to docker at the location CONT_DATABASES_DIR via: -v /path/to/uncompressed/Data:/dckr/mnt/camiref/CommonKmersData:ro\"\n"
}