{
  "startTime": 1674256296865,
  "endTime": 1674256297506,
  "originalSmells": [
    {
      "rule": "apkAddUseNoCache",
      "position": {
        "lineStart": 68,
        "lineEnd": 68,
        "columnStart": 7,
        "columnEnd": 19
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "FROM registry.cn-hangzhou.aliyuncs.com/taotao-cloud-project/taotao-cloud-openjdk17:amd64 as builder\n\nWORKDIR /root\n\nADD ./build/libs/taotao-cloud-gateway-2022.07.jar ./\n\nRUN java -Djarmode=layertools -jar taotao-cloud-gateway-2022.07.jar extract\n\nFROM registry.cn-hangzhou.aliyuncs.com/taotao-cloud-project/taotao-cloud-skywalking:8.8.1\n\nARG BACKEND_SERVICE=192.168.10.200:11800\nARG AGENT_AUTHENTICATION=taotao-cloud\nARG APP_NAME=taotao-cloud-gateway\nARG APP_VERSION=2022.07\nARG JAR=${APP_NAME}-${VERSION}\nARG JAR_NAME=${JAR}.jar\nARG APP_PORT=33333\nARG PRROFILES=test\n\nLABEL application_name=${APP_NAME}\nLABEL application_version=${APP_VERSION}\nLABEL org.opencontainers.image.authors=981376577@qq.com\n\nENV TZ=Asia/Shanghai\nENV APP_NAME=${APP_NAME}\nENV VERSION=${APP_VERSION}\nENV JAR_NAME=${APP_NAME}-${VERSION}.jar\nENV BACKEND_SERVICE=${BACKEND_SERVICE}\nENV AGENT_AUTHENTICATION=${AGENT_AUTHENTICATION}\nENV TAOTAO_CLOUD_MAIL_PASSWORD=${TAOTAO_CLOUD_MAIL_PASSWORD}\nENV PRROFILES=${PRROFILES}\nENV JAVA_OPTIONS=\"-Xms512m \\\n                  -Xmx2g \\\n                  -Xss256k \\\n                  -XX:MaxDirectMemorySize=256m \\\n                  -XX:SurvivorRatio=8 \\\n                  -XX:+UseCompressedOops \\\n                  -XX:+UseCompressedClassPointers \\\n                  -XX:+SegmentedCodeCache \\\n                  -XX:+PrintCommandLineFlags \\\n                  -XX:+ExplicitGCInvokesConcurrent \\\n                  -XX:+HeapDumpOnOutOfMemoryError \\\n                  -Xlog:gc*=debug:file=/root/logs/${APP_NAME}/gc.log:utctime,level,tags:filecount=50,filesize=100M \\\n                  -Xlog:jit+compilation=debug:file=/root/logs/${APP_NAME}/jit.compile.log:utctime,level,tags:filecount=10,filesize=100M \\\n                  -XX:MetaspaceSize=256m \\\n                  -XX:MaxMetaspaceSize=256m \\\n                  -verbose:gc \\\n                  -XX:ParallelGCThreads=4 \\\n                  -Djava.security.egd=file:/dev/./urandom \\\n                  -Dfile.encoding=utf-8 \\\n                  -Dspring.profiles.active=${PRROFILES} \\\n                  -javaagent:/skywalking/agent/skywalking-agent.jar \\\n                  -Dskywalking.agent.service_name=${APP_NAME} \\\n                  -Dskywalking.agent.authentication=${AGENT_AUTHENTICATION} \\\n                  -Dskywalking.collector.backend_service=${BACKEND_SERVICE} \\\n                  -Dskywalking.logging.file_name=skywalking.log \\\n                  -Dskywalking.logging.level=INFO \\\n                  -Dskywalking.logging.dir=/root/logs/${APP_NAME}\"\n\nUSER root\n\nWORKDIR /root\n\nRUN ln -sf /usr/share/zoneinfo/$TZ /etc/localtime \\\n\t  && echo $TZ > /etc/timezone \\\n    && mkdir -p /root/logs/${APP_NAME} \\\n\t  && touch /root/logs/${APP_NAME}/jit.compile.log /root/logs/${APP_NAME}/gc.log \\\n    && sed -i 's/dl-cdn.alpinelinux.org/mirrors.ustc.edu.cn/g' /etc/apk/repositories \\\n    && apk add --no-cache curl\n\nVOLUME /root/logs\n\nEXPOSE ${APP_PORT}\n\nCOPY --from=builder /root/dependencies/ ./\nRUN true\nCOPY --from=builder /root/spring-boot-loader/ ./\nRUN true\nCOPY --from=builder /root/snapshot-dependencies/ ./\nRUN true\nCOPY --from=builder /root/application/ ./\nRUN true\n\nHEALTHCHECK --interval=60s --timeout=60s --retries=5 CMD curl -fs http://127.0.0.1:${APP_PORT}/actuator/health || exit 1\n\nENTRYPOINT sleep 10; java ${JAVA_OPTIONS} org.springframework.boot.loader.JarLauncher\n"
}