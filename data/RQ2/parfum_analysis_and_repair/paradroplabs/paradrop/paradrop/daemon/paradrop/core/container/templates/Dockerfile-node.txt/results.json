{
  "startTime": 1674251379378,
  "endTime": 1674251380956,
  "originalSmells": [
    {
      "rule": "npmCacheCleanAfterInstall",
      "position": {
        "lineStart": 21,
        "lineEnd": 21,
        "columnStart": 4,
        "columnEnd": 33
      }
    },
    {
      "rule": "npmCacheCleanAfterInstall",
      "position": {
        "lineStart": 33,
        "lineEnd": 33,
        "columnStart": 33,
        "columnEnd": 45
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "FROM {image}\n\nENV npm_config_loglevel=warn\n\n# Set up an unprivileged user so that we can drop out of root.\n# Make /home/paradrop so that npm can drop some files in there.\n# Make /opt/paradrop/app for installing the app files.\nRUN useradd --system --uid 999 paradrop && \\\n    mkdir -p /home/paradrop && \\\n    chown paradrop /home/paradrop && \\\n    mkdir -p /opt/paradrop/app && \\\n    chown paradrop /opt/paradrop/app && \\\n    chmod a+s /opt/paradrop/app\n\nWORKDIR /opt/paradrop/app\n\n# Add cap_net_bind_service to node so that it can bind to ports 1-1024.\n# Not all images support this.\nRUN setcap 'cap_net_bind_service=+ep' /usr/local/bin/node || true\n\n# Install popular tools here.\nRUN npm install --global gulp-cli && npm cache clean --force;\n\n{has_packages:if:RUN apt-get update && apt-get install -y {packages}}\n\n# Defang setuid/setgid binaries.\nRUN find / -perm +6000 -type f -exec chmod a-s {{}} \\; || true\n\n# Copy paradrop.yaml and package.json, the latter only if it exists. Then call\n# init-app.sh to install dependencies. These layers will be cached as long as\n# the requirements do not change.\nCOPY paradrop.yaml package.jso[n] /opt/paradrop/app/\nRUN npm rebuild && \\\n    if [ -f package.json ]; then \\\n    npm install; npm cache clean --force; fi\n\nCOPY . /opt/paradrop/app/\nRUN chown paradrop:paradrop -R /opt/paradrop/app\n\n{drop_root:if:USER paradrop}\n\nCMD {cmd}\n"
}