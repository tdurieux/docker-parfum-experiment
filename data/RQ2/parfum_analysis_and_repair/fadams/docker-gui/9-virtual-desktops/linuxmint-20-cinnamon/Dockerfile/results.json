{
  "startTime": 1674248338799,
  "endTime": 1674248341015,
  "originalSmells": [
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 41,
        "lineEnd": 43,
        "columnStart": 4,
        "columnEnd": 25
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "#\n# Licensed to the Apache Software Foundation (ASF) under one\n# or more contributor license agreements.  See the NOTICE file\n# distributed with this work for additional information\n# regarding copyright ownership.  The ASF licenses this file\n# to you under the Apache License, Version 2.0 (the\n# \"License\"); you may not use this file except in compliance\n# with the License.  You may obtain a copy of the License at\n#\n#   http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing,\n# software distributed under the License is distributed on an\n# \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n# KIND, either express or implied.  See the License for the\n# specific language governing permissions and limitations\n# under the License.\n#\n\nFROM ubuntu:20.04\n\nENV LANG=en_GB.UTF-8\nENV TZ=Europe/London\n\nRUN apt-get update && DEBIAN_FRONTEND=noninteractive \\\n    apt-get install -y --no-install-recommends gnupg && \\\n    # Enable partner repository (for mint-meta-codecs)\n    sed -i 's/# deb http:\\/\\/archive.canonical.com\\/ubuntu focal partner/deb http:\\/\\/archive.canonical.com\\/ubuntu focal partner/' /etc/apt/sources.list && \\\n    # Remove \"This system has been minimized\" warning.\n    rm -f /etc/update-motd.d/60-unminimize && \\\n    # Set up the repositories for Linux Mint 20 \"Ulyana\"\n    echo \"deb http://packages.linuxmint.com/ ulyana main upstream import backport\\n\\n$(cat /etc/apt/sources.list)\" > /etc/apt/sources.list.d/official-package-repositories.list && \\\n    rm /etc/apt/sources.list && \\\n    LINUX_MINT_KEY=$(apt update 2>&1 | \\\n        grep -o '[0-9A-Z]\\{16\\}$' | xargs) && \\\n    apt-key adv --recv-keys --keyserver \\\n    hkp://keyserver.ubuntu.com:80 ${LINUX_MINT_KEY} && \\\n    apt-get update && DEBIAN_FRONTEND=noninteractive \\\n    apt-get -fy -o Dpkg::Options::=\"--force-confnew\" \\\n                -o APT::Immediate-Configure=false \\\n                dist-upgrade && \\\n    DEBIAN_FRONTEND=noninteractive \\\n    apt-get --no-install-recommends install -y --allow-unauthenticated \\\n        linuxmint-keyring && \\\n    unset LINUX_MINT_KEY && \\\n    # Add the main Mint flavoured packages\n    DEBIAN_FRONTEND=noninteractive \\\n    apt-get install -y --no-install-recommends \\\n    base-files ntp apt-utils add-apt-key aptdaemon \\\n    apt-transport-https locales tzdata language-pack-en \\\n    language-pack-gnome-en mintlocale mint-meta-cinnamon \\\n    mintupload mint-common mint-meta-core mint-themes \\\n    mintdesktop mintmenu mintstick mintsystem mintwelcome \\\n    xserver-xephyr wamerican cinnamon-core cinnamon-doc \\\n    cinnamon-desktop-environment mint-info-cinnamon \\\n    mintnanny mintreport mint-meta-codecs wbritish \\\n    # Add packages to be similar to Mint iso installation.\n    gnome-terminal keyboard-configuration pidgin xed \\\n    gimp gimp-help-en hexchat firefox firefox-locale-en \\\n    libreoffice openoffice.org-hyphenation thunderbird \\\n    thunderbird-locale-en thunderbird-gnome-support \\\n    gucharmap remmina remmina-common remmina-plugin-rdp \\\n    remmina-plugin-vnc remmina-plugin-nx gvfs-backends \\\n    remmina-plugin-spice remmina-plugin-xdmcp drawing \\\n    transmission-gtk pix rhythmbox gnome-calculator \\\n    gnome-screenshot xreader xviewer xplayer gnote \\\n    simple-scan inkscape vlc vlc-data baobab blueberry \\\n    gnome-power-manager gufw dmz-cursor-theme vino \\\n    gnome-system-log gnome-system-monitor libglu1-mesa \\\n    gnome-disk-utility pulseaudio libpulsedsp paprefs \\\n    pulseaudio-utils libcanberra-pulse pavucontrol \\\n    pulseaudio-module-bluetooth gstreamer1.0-pulseaudio \\\n    pulseaudio-module-zeroconf avahi-utils libnss-mdns \\\n    mesa-utils cheese cups system-config-printer-gnome \\\n    colord system-config-printer-udev gnome-keyring \\\n    libpam-gnome-keyring libpam-kwallet5 \\\n    # Install Display Manager and dependencies\n    lightdm slick-greeter dbus-x11 && \\\n#    # Default libgl1-mesa-dri causes \"black window\" issues\n#    # when software rendering. Use ppa to upgrade version.\n#    add-apt-repository -y ppa:oibaf/graphics-drivers && \\\n#    apt-get update && DEBIAN_FRONTEND=noninteractive \\\n#    apt-get install -y libgl1-mesa-dri && \\\n    # Stop synaptic package manager being painfully slow\n    rm /etc/apt/apt.conf.d/docker-gzip-indexes && \\\n    rm -rf /var/lib/apt/lists/* && apt-get update && \\\n    # Generate locales\n    echo LANG=$LANG > /etc/default/locale && \\\n    update-locale LANG=$LANG && \\\n    # Set up the timezone\n    echo $TZ > /etc/timezone && \\\n    ln -snf /usr/share/zoneinfo/$TZ /etc/localtime && \\\n    DEBIAN_FRONTEND=noninteractive \\\n    dpkg-reconfigure tzdata && \\\n    # Configure LightDM Display Manager to use\n    # Xephyr instead of X\n    echo '#!/bin/bash\\nexport XAUTHORITY=/root/.Xauthority.docker\\nexport DISPLAY=:0\\nexec Xephyr $1 -ac >> /var/log/lightdm/x-1.log' > /usr/bin/Xephyr-lightdm-wrapper && \\\n    chmod +x /usr/bin/Xephyr-lightdm-wrapper && \\\n    echo '[LightDM]\\nminimum-display-number=1\\n[Seat:*]\\nxserver-command=/usr/bin/Xephyr-lightdm-wrapper' > /etc/lightdm/lightdm.conf.d/70-linuxmint.conf && \\\n    # Change nemo icons from standard to small\n    # https://unix.stackexchange.com/questions/250266/rhel-7-gnome-shell-decrease-desktop-icon-size\n    sed -i '/default-zoom-level/{n; s/standard/small/}' \\\n      /usr/share/glib-2.0/schemas/org.nemo.gschema.xml && \\\n    glib-compile-schemas /usr/share/glib-2.0/schemas/ > \\\n        /dev/null 2>&1 && \\\n    # Configure console\n    echo \"console-setup console-setup/charmap select UTF-8\" | debconf-set-selections && \\\n    # Fix mintupdate \"APT-cache damaged\" error\n    cp /usr/share/linuxmint/mintsystem/apt/official-package-repositories.pref \\\n       /etc/apt/preferences.d/official-package-repositories.pref && \\\n    # Fix synaptic Empty Dir::Cache::pkgcache setting not\n    # handled correctly https://bugs.launchpad.net/ubuntu/+source/synaptic/+bug/1243615\n    # which causes synaptic to barf with: E: Could not \n    # open file - open (2: No such file or directory)\n    # E: _cache->open() failed, please report.\n    sed -i 's/Dir::Cache::pkgcache \"\"; //' \\\n        /etc/apt/apt.conf.d/docker-clean && \\\n    # Disable getty@tty1.service to speed up desktop loading.\n    rm -f /etc/systemd/system/getty.target.wants/getty@tty1.service && \\\n    # Fix issues with slow shutdown\n    sed -i 's/#DefaultTimeoutStopSec=90s/DefaultTimeoutStopSec=5s/' /etc/systemd/system.conf && \\\n    # Fix Polkit issues caused by container login being\n    # considered to be an \"inactive\" session.\n    chmod 755 /etc/polkit-1/localauthority && \\\n    # Mint Software Sources\n    echo \"[Mint Software Sources]\\nIdentity=unix-user:*\\nAction=com.linuxmint.mintsources\\nResultAny=auth_self_keep\\nResultInactive=auth_self_keep\\nResultActive=auth_self_keep\\n\" > /etc/polkit-1/localauthority/50-local.d/10-mintsources.pkla && \\\n    # Date & Time\n    echo \"[Date & Time]\\nIdentity=unix-user:*\\nAction=org.cinnamon.settingsdaemon.datetimemechanism.configure\\nResultAny=auth_admin_keep\\nResultInactive=auth_admin_keep\\nResultActive=auth_admin_keep\\n\" > /etc/polkit-1/localauthority/50-local.d/10-datetimemechanism.pkla && \\\n    # Gnome System Log\n    echo \"[Gnome System Log]\\nIdentity=unix-user:*\\nAction=org.debian.pkexec.gnome-system-log.run\\nResultAny=auth_admin_keep\\nResultInactive=auth_admin_keep\\nResultActive=auth_admin_keep\\n\" > /etc/polkit-1/localauthority/50-local.d/10-system-log.pkla && \\\n    # Shutdown & Restart\n    # Note that auth_admin_keep may be better than yes\n    # here, but there seems to be an issue with the\n    # authentication dialog appearing.\n    echo \"[Shutdown & Restart]\\nIdentity=unix-user:*\\nAction=org.freedesktop.login1.power-off;org.freedesktop.login1.power-off-multiple-sessions;org.freedesktop.login1.reboot;org.freedesktop.login1.reboot-multiple-sessions\\nResultAny=yes\\nResultInactive=yes\\nResultActive=yes\\n\" > /etc/polkit-1/localauthority/50-local.d/10-shutdown.pkla\n\n#-------------------------------------------------------------------------------\n# Example usage\n#\n# Build the image\n# docker build -t linuxmint-cinnamon:20 .\n\n"
}