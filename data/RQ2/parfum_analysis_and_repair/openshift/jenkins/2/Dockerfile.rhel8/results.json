{
  "startTime": 1674250045838,
  "endTime": 1674250046806,
  "originalSmells": [
    {
      "rule": "yumInstallRmVarCacheYum",
      "position": {
        "lineStart": 65,
        "lineEnd": 65,
        "columnStart": 4,
        "columnEnd": 32
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "##############################################\n# Stage 1 : Build go-init\n##############################################\nFROM registry.ci.openshift.org/ocp/builder:rhel-8-golang-1.17-openshift-4.11 AS go-init-builder\nARG jenkins_version=latest\nWORKDIR  /go/src/github.com/openshift/jenkins\nCOPY . .\nWORKDIR  /go/src/github.com/openshift/jenkins/go-init\nRUN GO111MODULE=off go build . && cp go-init /usr/bin\n\n##############################################\n# Stage 2 : Build slave-base with go-init\n##############################################\nFROM registry.ci.openshift.org/ocp/4.11:cli\nARG jenkins_version=latest\nMAINTAINER OpenShift Developer Services <openshift-dev-services+jenkins@redhat.com>\nCOPY --from=go-init-builder /usr/bin/go-init /usr/bin/go-init\n\n# Jenkins image for OpenShift\n#\n# This image provides a Jenkins server, primarily intended for integration with\n# OpenShift v3.\n#\n# Volumes:\n# * /var/jenkins_home\n# Environment:\n# * $JENKINS_PASSWORD - Password for the Jenkins 'admin' user.\n\nMAINTAINER OpenShift Developer Services <openshift-dev-services+jenkins@redhat.com>\n\nENV JENKINS_VERSION=2 \\\n    HOME=/var/lib/jenkins \\\n    JENKINS_HOME=/var/lib/jenkins \\\n    JENKINS_UC=https://updates.jenkins.io \\\n    OPENSHIFT_JENKINS_IMAGE_VERSION=4.10 \\\n    LANG=en_US.UTF-8 \\\n    LC_ALL=en_US.UTF-8 \\\n    INSTALL_JENKINS_VIA_RPMS=false\n# openshift/ocp-build-data will change INSTALL_JENKINS_VIA_RPMS to true\n# so that the osbs/brew builds will install via RPMs; when this runs\n# in api.ci, it will employ the old centos style, download the plugins and\n# redhat-stable core RPM for download\n\nLABEL io.k8s.description=\"Jenkins is a continuous integration server\" \\\n      io.k8s.display-name=\"Jenkins 2\" \\\n      io.openshift.tags=\"jenkins,jenkins2,ci\" \\\n      io.openshift.expose-services=\"8080:http\" \\\n      io.jenkins.version=\"${jenkins_version}\" \\\n      io.openshift.s2i.scripts-url=image:///usr/libexec/s2i\n\n# Labels consumed by Red Hat build service\nLABEL com.redhat.component=\"openshift-jenkins-2-container\" \\\n      name=\"openshift4/jenkins-2-rhel7\" \\\n      architecture=\"x86_64 \\\n      maintainer=\"openshift-dev-services+jenkins@redhat.com\"\"\n\n# 8080 for main web interface, 50000 for slave agents\nEXPOSE 8080 50000\n\n# for backward compatibility with pre-3.6 installs leveraging a PV, where rpm installs went to /usr/lib64/jenkins, we are\n# establishing a symbolic link for that guy as well, so that existing plugins in JENKINS_HOME/plugins pointing to\n# /usr/lib64/jenkins will subsequently get redirected to /usr/lib/jenkins; it is confirmed that the 3.7 jenkins RHEL images\n# do *NOT* have a /usr/lib64/jenkins path\nRUN ln -s /usr/lib/jenkins /usr/lib64/jenkins && \\\n    INSTALL_PKGS=\"dejavu-sans-fonts wget rsync gettext git tar zip unzip openssl bzip2 java-11-openjdk java-11-openjdk-devel java-1.8.0-openjdk java-1.8.0-openjdk-devel jq glibc-locale-source xmlstarlet\" && \\\n    yum install -y $INSTALL_PKGS && \\\n    rpm -V  $INSTALL_PKGS && \\\n    yum clean all && \\\n    localedef -f UTF-8 -i en_US en_US.UTF-8 && rm -rf /var/cache/yum\n\nCOPY ./contrib/openshift /opt/openshift\nCOPY ./contrib/jenkins /usr/local/bin\nADD ./contrib/s2i /usr/libexec/s2i\nADD release.version /tmp/release.version\n\nRUN /usr/local/bin/install-jenkins-core-plugins.sh /opt/openshift/bundle-plugins.txt && \\\n    rmdir /var/log/jenkins && \\\n    chmod -R 775 /etc/alternatives && \\\n    chmod -R 775 /var/lib/alternatives && \\\n    chmod -R 775 /usr/lib/jvm && \\\n    chmod 775 /usr/bin && \\\n    chmod 775 /usr/share/man/man1 && \\\n    mkdir -p /var/lib/origin && \\\n    chmod 775 /var/lib/origin && \\\n    unlink /usr/bin/java && \\\n    unlink /usr/bin/jjs && \\\n    unlink /usr/bin/keytool && \\\n    unlink /usr/bin/pack200 && \\\n    unlink /usr/bin/rmid && \\\n    unlink /usr/bin/rmiregistry && \\\n    unlink /usr/bin/unpack200 && \\\n    unlink /usr/share/man/man1/java.1.gz && \\\n    unlink /usr/share/man/man1/jjs.1.gz && \\\n    unlink /usr/share/man/man1/keytool.1.gz && \\\n    unlink /usr/share/man/man1/pack200.1.gz && \\\n    unlink /usr/share/man/man1/rmid.1.gz && \\\n    unlink /usr/share/man/man1/rmiregistry.1.gz && \\\n    unlink /usr/share/man/man1/unpack200.1.gz && \\\n    chown -R 1001:0 /opt/openshift && \\\n    /usr/local/bin/fix-permissions /opt/openshift && \\\n    /usr/local/bin/fix-permissions /opt/openshift/configuration/init.groovy.d && \\\n    /usr/local/bin/fix-permissions /var/lib/jenkins && \\\n    /usr/local/bin/fix-permissions /var/log\n\nVOLUME [\"/var/lib/jenkins\"]\n\nUSER 1001\nENTRYPOINT [\"/usr/bin/go-init\", \"-main\", \"/usr/libexec/s2i/run\"]\n"
}