{
  "startTime": 1674254366011,
  "endTime": 1674254367100,
  "originalSmells": [
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 55,
        "lineEnd": 55,
        "columnStart": 4,
        "columnEnd": 41
      }
    },
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 65,
        "lineEnd": 66,
        "columnStart": 4,
        "columnEnd": 41
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 38,
        "lineEnd": 38,
        "columnStart": 4,
        "columnEnd": 48
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 44,
        "lineEnd": 44,
        "columnStart": 4,
        "columnEnd": 24
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 45,
        "lineEnd": 45,
        "columnStart": 4,
        "columnEnd": 24
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 34,
        "lineEnd": 34,
        "columnStart": 4,
        "columnEnd": 33
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 35,
        "lineEnd": 35,
        "columnStart": 4,
        "columnEnd": 96
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 37,
        "lineEnd": 37,
        "columnStart": 4,
        "columnEnd": 59
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 40,
        "lineEnd": 40,
        "columnStart": 4,
        "columnEnd": 75
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 47,
        "lineEnd": 47,
        "columnStart": 4,
        "columnEnd": 51
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 48,
        "lineEnd": 48,
        "columnStart": 4,
        "columnEnd": 33
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 34,
        "lineEnd": 34,
        "columnStart": 4,
        "columnEnd": 33
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 35,
        "lineEnd": 35,
        "columnStart": 4,
        "columnEnd": 96
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 37,
        "lineEnd": 37,
        "columnStart": 4,
        "columnEnd": 59
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 40,
        "lineEnd": 40,
        "columnStart": 4,
        "columnEnd": 75
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 47,
        "lineEnd": 47,
        "columnStart": 4,
        "columnEnd": 51
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 48,
        "lineEnd": 48,
        "columnStart": 4,
        "columnEnd": 33
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 53,
        "lineEnd": 54,
        "columnStart": 4,
        "columnEnd": 52
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 34,
        "lineEnd": 34,
        "columnStart": 4,
        "columnEnd": 33
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 35,
        "lineEnd": 35,
        "columnStart": 4,
        "columnEnd": 96
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 37,
        "lineEnd": 37,
        "columnStart": 4,
        "columnEnd": 59
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 40,
        "lineEnd": 40,
        "columnStart": 4,
        "columnEnd": 75
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 47,
        "lineEnd": 47,
        "columnStart": 4,
        "columnEnd": 51
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 48,
        "lineEnd": 48,
        "columnStart": 4,
        "columnEnd": 33
      }
    }
  ],
  "repairedSmells": [
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 34,
        "lineEnd": 34,
        "columnStart": 4,
        "columnEnd": 57
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 35,
        "lineEnd": 35,
        "columnStart": 4,
        "columnEnd": 120
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 37,
        "lineEnd": 37,
        "columnStart": 4,
        "columnEnd": 83
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 40,
        "lineEnd": 40,
        "columnStart": 4,
        "columnEnd": 99
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 47,
        "lineEnd": 47,
        "columnStart": 4,
        "columnEnd": 75
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 48,
        "lineEnd": 48,
        "columnStart": 4,
        "columnEnd": 57
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 53,
        "lineEnd": 54,
        "columnStart": 4,
        "columnEnd": 52
      }
    }
  ],
  "repairedDockerfile": "FROM debian:latest\n\n#\n# Java 11, Scala 2.12.12, and Spark 3.0.1 (or more recent), on Debian\n# Updated Oct 2020\n#\n\nLABEL maintainer=\"Olivier LeDiouris <olivier@lediouris.net>\"\n\n# Will set the proxy in the image.\n# Might be needed to set it at the Docker level too (when building the image), to pull the base image for example.\n#\n# ENV http_proxy http://www-proxy.us.oracle.com:80\n# ENV https_proxy http://www-proxy.us.oracle.com:80\n# ENV ftp_proxy http://etc...\n# ENV no_proxy \"*.oracle.com,.home.net\"\n\nENV SCALA_VERSION 2.13.3\n# ENV SCALA_VERSION 2.12.12\n# ENV SCALA_VERSION 2.12.6\nENV SCALA_TARBALL http://www.scala-lang.org/files/archive/scala-$SCALA_VERSION.deb\n\n# See https://spark.apache.org/downloads.html\n# -------------------------------------------\n# ENV APACHE_MIRROR https://mirrors.gigenet.com/apache/spark/spark-3.0.1/\n# ENV APACHE_MIRROR https://mirrors.ocf.berkeley.edu/apache/spark/spark-3.0.1/\nENV APACHE_MIRROR https://dlcdn.apache.org/spark/spark-3.1.2/\n# ENV APACHE_MIRROR https://mirrors.gigenet.com/apache/spark/spark-3.0.0-preview2/\n# ENV SPARK_TARBALL http://apache.claz.org/spark/spark-2.3.0/spark-2.3.0-bin-hadoop2.7.tgz\n# ENV SPARK_TARBALL $APACHE_MIRROR/spark-3.0.0-preview2-bin-hadoop3.2.tgz\n# ENV SPARK_TARBALL $APACHE_MIRROR/spark-3.0.1-bin-hadoop2.7-hive1.2.tgz\nENV SPARK_TARBALL $APACHE_MIRROR/spark-3.1.2-bin-hadoop3.2.tgz\n\nRUN apt-get update\nRUN apt-get install --no-install-recommends -y sysvbanner && rm -rf /var/lib/apt/lists/*;\nRUN apt-get install --no-install-recommends -y curl git build-essential default-jdk libssl-dev libffi-dev python-dev vim && rm -rf /var/lib/apt/lists/*;\n# RUN apt-get install -y python-pip python-dev\nRUN apt-get install --no-install-recommends -y python3-pip python3-dev python3-venv && rm -rf /var/lib/apt/lists/*;\nRUN pip3 install --no-cache-dir pandas numpy scipy scikit-learn\n#\nRUN apt-get install --no-install-recommends -y cmake unzip pkg-config libopenblas-dev liblapack-dev && rm -rf /var/lib/apt/lists/*;\n# RUN apt-get install -y python-numpy python-scipy python-matplotlib python-yaml\nRUN python3 -mpip install matplotlib\n#\nRUN pip3 install --no-cache-dir jupyter\nRUN pip3 install --no-cache-dir pyspark\n#\nRUN apt-get install --no-install-recommends -y libopencv-dev python3-opencv && rm -rf /var/lib/apt/lists/*;\nRUN apt-get install --no-install-recommends -y python3-tk && rm -rf /var/lib/apt/lists/*;\n\nRUN echo \"+-----------------------+\"  && \\\n\techo \"| ===> installing Scala |\"  && \\\n\techo \"+-----------------------+\"  && \\\n    DEBIAN_FRONTEND=noninteractive \\\n            apt-get install -y --allow libjansi-java && \\\n    curl -f -sSL $SCALA_TARBALL -o scala.deb && \\\n    dpkg -i scala.deb && \\\n    echo \"===> Cleaning up...\" && \\\n    rm -f *.deb\n\nRUN mkdir /workdir\nWORKDIR /workdir\nRUN echo \"+-----------------------+\" && \\\n    echo \"| ===> installing Spark |\" && \\\n    echo \"+-----------------------+\" && \\\n    DEBIAN_FRONTEND=noninteractive \\\n    curl -f \\\n    -sSL $SPARK_TARBALL -o spark.tgz && \\\n    tar xvf spark.tgz && \\\n    echo \"===> Cleaning up...\" && \\\n    rm spark.tgz\n\n# TODO Hive, Hadoop, etc?\n#\n# Jupyter Notebooks kernels: IJava, Almond?\n# See https://github.com/SpencerPark/IJava, https://github.com/SpencerPark/IJava#install-from-source\n#\nWORKDIR /workdir\nRUN git clone https://github.com/SpencerPark/IJava.git\nWORKDIR /workdir/IJava\nRUN pwd\nRUN ./gradlew installKernel\n#\nWORKDIR /workdir\n# Coursier (https://get-coursier.io/)\n# RUN curl -Lo coursier https://git.io/coursier-cli\n# RUN chmod +x coursier\n# RUN ./coursier launch --fork almond -- --install\n# RUN rm -f coursier\n#\n# To start: jupyter notebook --ip=0.0.0.0 --port=8080 --allow-root --no-browser\n#\n# TODO Copy projects, classes, notebooks and resources?\n#\nRUN echo \"alias ll='ls -lisah'\" >> $HOME/.bashrc\nRUN echo \"banner Spark\" >> $HOME/.bashrc\nRUN echo \"git --version\" >> $HOME/.bashrc\nRUN echo \"java -version\" >> $HOME/.bashrc\nRUN echo \"scala -version\" >> $HOME/.bashrc\nRUN echo \"echo -------------------------\" >> $HOME/.bashrc\nRUN echo \"echo From /workdir, cd spark*\" >> $HOME/.bashrc\nRUN echo \"echo Then ./bin/spark-shell \" >> $HOME/.bashrc\nRUN echo \"echo as well as ./bin/pyspark \" >> $HOME/.bashrc\nRUN echo \"echo or ./bin/run-example org.apache.spark.examples.SparkPi\" >> $HOME/.bashrc\nRUN echo \"echo -------------------------\" >> $HOME/.bashrc\nRUN echo \"echo To start Jupyter Notebooks:\" >> $HOME/.bashrc\nRUN echo \"echo jupyter notebook --ip=0.0.0.0 --port=8080 --allow-root --no-browser\" >> $HOME/.bashrc\nRUN echo \"echo -------------------------\" >> $HOME/.bashrc\n#\nRUN echo \"To run it, use 'docker run -it --rm -e USER=root -p 8080:8080 oliv-spark:latest /bin/bash'\"\n\n# RUN git clone https://github.com/OlivierLD/node.pi.git\n# WORKDIR /workdir/node.pi\n# RUN npm install\n# RUN npm install -g node-inspector\n\n#\n# If needed, to unset env vars\n#\n# ENV http_proxy \"\"\n# ENV https_proxy \"\"\n# ENV ftp_proxy \"\"\n# ENV no_proxy \"\"\n\n# EXPOSE 9876\nCMD [\"echo\", \"Sparkling!\"]\n"
}