{
  "startTime": 1674250210540,
  "endTime": 1674250211355,
  "originalSmells": [
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 31,
        "lineEnd": 31,
        "columnStart": 4,
        "columnEnd": 107
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 18,
        "lineEnd": 18,
        "columnStart": 4,
        "columnEnd": 149
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "# Copyright (C) 2020 GEM Foundation\n#\n# OpenQuake is free software: you can redistribute it and/or modify it\n# under the terms of the GNU Affero General Public License as published\n# by the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# OpenQuake is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU Affero General Public License for more details.\n#\n# You should have received a copy of the GNU Affero General Public License\n# along with OpenQuake. If not, see <http://www.gnu.org/licenses/>.\nFROM python:3.8 AS compile-image\nLABEL maintainer=\"GEM Foundation <devops@openquake.org>\" \\\n       vendor=\"GEM Foundation\"\nRUN apt-get update &&  \\\n    apt-get install -y --no-install-recommends build-essential gcc git libcap-dev ssh dnsutils telnet netbase net-tools lsof tcpdump sudo strace time && \\\n    useradd -m -u 1000 -G sudo -s /bin/bash openquake && echo \"openquake ALL=(ALL) NOPASSWD:ALL\" | sudo tee -a /etc/sudoers && rm -rf /var/lib/apt/lists/*;\nARG oq_branch\nENV LANG en_US.UTF-8\nWORKDIR /usr/src\n\n# Create venv\nENV VIRTUAL_ENV=/opt/openquake\nRUN python3 -m venv $VIRTUAL_ENV\nENV PATH=\"$VIRTUAL_ENV/bin:$PATH\"\n\n# Install dependencies and engine\nRUN git clone https://github.com/gem/oq-engine.git --depth=1 --branch $oq_branch && cd oq-engine && \\\n    pip --disable-pip-version-check --no-cache-dir install -e . -r requirements-py38-linux64.txt --no-warn-script-location\n#\nUSER openquake\nENV HOME /home/openquake\n#\n#ENV OQ_CONFIG_FILE /opt/openquake/openquake.cfg\n#ADD openquake.cfg /opt/openquake/openquake.cfg\n#\nWORKDIR ${HOME}\nRUN mkdir oqdata\n#\nADD scripts/oq-db_start.sh ${HOME}\nADD scripts/oq-start.sh ${HOME}\nEXPOSE 8800:8800\nSTOPSIGNAL SIGINT\nENTRYPOINT [\"/bin/bash\", \"-c\"]\nCMD [\"./oq-start.sh\"] \n"
}