{
  "startTime": 1674215294959,
  "endTime": 1674215295973,
  "originalSmells": [
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 57,
        "lineEnd": 57,
        "columnStart": 5,
        "columnEnd": 92
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "# This Dockerfile uses multi-stage build to customize DEV and PROD images:\n# https://docs.docker.com/develop/develop-images/multistage-build/\n\nFROM python:3.8.6-slim-buster AS development_build\n\nLABEL maintainer=\"sobolevn@wemake.services\"\nLABEL vendor=\"wemake.services\"\n\nARG DJANGO_ENV\n\nENV DJANGO_ENV=${DJANGO_ENV} \\\n  # build:\n  BUILD_ONLY_PACKAGES='wget' \\\n  # python:\n  PYTHONFAULTHANDLER=1 \\\n  PYTHONUNBUFFERED=1 \\\n  PYTHONHASHSEED=random \\\n  PYTHONDONTWRITEBYTECODE=1 \\\n  # pip:\n  PIP_NO_CACHE_DIR=off \\\n  PIP_DISABLE_PIP_VERSION_CHECK=on \\\n  PIP_DEFAULT_TIMEOUT=100 \\\n  # dockerize:\n  DOCKERIZE_VERSION=v0.6.1 \\\n  # tini:\n  TINI_VERSION=v0.19.0 \\\n  # poetry:\n  POETRY_VERSION=1.1.4 \\\n  POETRY_NO_INTERACTION=1 \\\n  POETRY_VIRTUALENVS_CREATE=false \\\n  POETRY_CACHE_DIR='/var/cache/pypoetry' \\\n  PATH=\"$PATH:/root/.poetry/bin\"\n\n\n# System deps:\nRUN apt-get update \\\n  && apt-get install --no-install-recommends -y \\\n    bash \\\n    postgresql \\\n    build-essential \\\n    curl \\\n    gettext \\\n    git \\\n    libpq-dev \\\n    # Defining build-time-only dependencies:\n    $BUILD_ONLY_PACKAGES \\\n  # Installing `dockerize` utility:\n  # https://github.com/jwilder/dockerize\n  && wget \"https://github.com/jwilder/dockerize/releases/download/${DOCKERIZE_VERSION}/dockerize-linux-amd64-${DOCKERIZE_VERSION}.tar.gz\" \\\n  && tar -C /usr/local/bin -xzvf \"dockerize-linux-amd64-${DOCKERIZE_VERSION}.tar.gz\" \\\n  && rm \"dockerize-linux-amd64-${DOCKERIZE_VERSION}.tar.gz\" && dockerize --version \\\n  # Installing `tini` utility:\n  # https://github.com/krallin/tini\n  && wget -O /usr/local/bin/tini \"https://github.com/krallin/tini/releases/download/${TINI_VERSION}/tini\" \\\n  && chmod +x /usr/local/bin/tini && tini --version \\\n  # Installing `poetry` package manager:\n  # https://github.com/python-poetry/poetry \\\n  && curl -f -sSL 'https://raw.githubusercontent.com/python-poetry/poetry/master/get-poetry.py' | python \\\n  && poetry --version \\\n  # Removing build-time-only dependencies:\n  && apt-get remove -y $BUILD_ONLY_PACKAGES \\\n  # Cleaning cache:\n  && apt-get purge -y --auto-remove -o APT::AutoRemove::RecommendsImportant=false \\\n  && apt-get clean -y && rm -rf /var/lib/apt/lists/*\n\nWORKDIR /code\n\n# This is a special case. We need to run this script as an entry point:\nCOPY ./docker/django/entrypoint.sh /docker-entrypoint.sh\n\n# Setting up proper permissions:\nRUN chmod +x '/docker-entrypoint.sh' \\\n  && groupadd -r web && useradd -d /code -r -g web web \\\n  && chown web:web -R /code \\\n  && mkdir -p /var/www/django/static /var/www/django/media \\\n  && chown web:web /var/www/django/static /var/www/django/media\n\n# Copy only requirements, to cache them in docker layer\nCOPY --chown=web:web ./poetry.lock ./pyproject.toml /code/\n\n# Project initialization:\nRUN echo \"$DJANGO_ENV\" \\\n  && poetry install \\\n    $(if [ \"$DJANGO_ENV\" = 'production' ]; then echo '--no-dev'; fi) \\\n    --no-interaction --no-ansi \\\n  # Cleaning poetry installation's cache for production:\n  && if [ \"$DJANGO_ENV\" = 'production' ]; then rm -rf \"$POETRY_CACHE_DIR\"; fi\n\n# Running as non-root user:\nUSER web\n\n# We customize how our app is loaded with the custom entrypoint:\nENTRYPOINT [\"tini\", \"--\", \"/docker-entrypoint.sh\"]\n\n\n# The following stage is only for Prod:\n# https://wemake-django-template.readthedocs.io/en/latest/pages/template/production.html\nFROM development_build AS production_build\nCOPY --chown=web:web . /code\n"
}