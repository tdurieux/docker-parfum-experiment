{
  "startTime": 1674255903749,
  "endTime": 1674255905218,
  "originalSmells": [
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 11,
        "lineEnd": 11,
        "columnStart": 4,
        "columnEnd": 41
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 14,
        "lineEnd": 14,
        "columnStart": 4,
        "columnEnd": 44
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 16,
        "lineEnd": 16,
        "columnStart": 4,
        "columnEnd": 56
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 18,
        "lineEnd": 18,
        "columnStart": 4,
        "columnEnd": 30
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 19,
        "lineEnd": 19,
        "columnStart": 4,
        "columnEnd": 22
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 20,
        "lineEnd": 20,
        "columnStart": 4,
        "columnEnd": 23
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 22,
        "lineEnd": 22,
        "columnStart": 4,
        "columnEnd": 28
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 36,
        "lineEnd": 36,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 48,
        "lineEnd": 48,
        "columnStart": 4,
        "columnEnd": 33
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 80,
        "lineEnd": 80,
        "columnStart": 4,
        "columnEnd": 33
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 83,
        "lineEnd": 83,
        "columnStart": 126,
        "columnEnd": 151
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 100,
        "lineEnd": 100,
        "columnStart": 4,
        "columnEnd": 31
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 101,
        "lineEnd": 101,
        "columnStart": 4,
        "columnEnd": 51
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 111,
        "lineEnd": 111,
        "columnStart": 57,
        "columnEnd": 70
      }
    },
    {
      "rule": "tarSomethingRmTheSomething",
      "position": {
        "lineStart": 71,
        "lineEnd": 71,
        "columnStart": 4,
        "columnEnd": 47
      }
    },
    {
      "rule": "tarSomethingRmTheSomething",
      "position": {
        "lineStart": 87,
        "lineEnd": 87,
        "columnStart": 66,
        "columnEnd": 88
      }
    },
    {
      "rule": "tarSomethingRmTheSomething",
      "position": {
        "lineStart": 91,
        "lineEnd": 91,
        "columnStart": 66,
        "columnEnd": 88
      }
    },
    {
      "rule": "tarSomethingRmTheSomething",
      "position": {
        "lineStart": 111,
        "lineEnd": 111,
        "columnStart": 4,
        "columnEnd": 33
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 4,
        "lineEnd": 6,
        "columnStart": 4,
        "columnEnd": 47
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 21,
        "lineEnd": 21,
        "columnStart": 4,
        "columnEnd": 79
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 25,
        "lineEnd": 25,
        "columnStart": 4,
        "columnEnd": 26
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 32,
        "lineEnd": 32,
        "columnStart": 4,
        "columnEnd": 79
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 35,
        "lineEnd": 35,
        "columnStart": 4,
        "columnEnd": 55
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 52,
        "lineEnd": 52,
        "columnStart": 4,
        "columnEnd": 78
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 61,
        "lineEnd": 61,
        "columnStart": 4,
        "columnEnd": 54
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 75,
        "lineEnd": 75,
        "columnStart": 4,
        "columnEnd": 31
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 79,
        "lineEnd": 79,
        "columnStart": 4,
        "columnEnd": 28
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 85,
        "lineEnd": 85,
        "columnStart": 4,
        "columnEnd": 79
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 21,
        "lineEnd": 21,
        "columnStart": 4,
        "columnEnd": 79
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 25,
        "lineEnd": 25,
        "columnStart": 4,
        "columnEnd": 26
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 32,
        "lineEnd": 32,
        "columnStart": 4,
        "columnEnd": 79
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 35,
        "lineEnd": 35,
        "columnStart": 4,
        "columnEnd": 55
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 52,
        "lineEnd": 52,
        "columnStart": 4,
        "columnEnd": 78
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 75,
        "lineEnd": 75,
        "columnStart": 4,
        "columnEnd": 31
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 79,
        "lineEnd": 79,
        "columnStart": 4,
        "columnEnd": 28
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 85,
        "lineEnd": 85,
        "columnStart": 4,
        "columnEnd": 79
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 4,
        "lineEnd": 6,
        "columnStart": 4,
        "columnEnd": 47
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 21,
        "lineEnd": 21,
        "columnStart": 4,
        "columnEnd": 79
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 25,
        "lineEnd": 25,
        "columnStart": 4,
        "columnEnd": 26
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 32,
        "lineEnd": 32,
        "columnStart": 4,
        "columnEnd": 79
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 35,
        "lineEnd": 35,
        "columnStart": 4,
        "columnEnd": 55
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 52,
        "lineEnd": 52,
        "columnStart": 4,
        "columnEnd": 78
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 61,
        "lineEnd": 61,
        "columnStart": 4,
        "columnEnd": 54
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 75,
        "lineEnd": 75,
        "columnStart": 4,
        "columnEnd": 31
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 79,
        "lineEnd": 79,
        "columnStart": 4,
        "columnEnd": 28
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 85,
        "lineEnd": 85,
        "columnStart": 4,
        "columnEnd": 79
      }
    }
  ],
  "repairedSmells": [
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 21,
        "lineEnd": 21,
        "columnStart": 4,
        "columnEnd": 103
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 25,
        "lineEnd": 25,
        "columnStart": 4,
        "columnEnd": 50
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 32,
        "lineEnd": 32,
        "columnStart": 4,
        "columnEnd": 103
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 35,
        "lineEnd": 35,
        "columnStart": 4,
        "columnEnd": 79
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 52,
        "lineEnd": 52,
        "columnStart": 4,
        "columnEnd": 102
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 75,
        "lineEnd": 75,
        "columnStart": 4,
        "columnEnd": 55
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 79,
        "lineEnd": 79,
        "columnStart": 4,
        "columnEnd": 52
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 85,
        "lineEnd": 85,
        "columnStart": 4,
        "columnEnd": 103
      }
    }
  ],
  "repairedDockerfile": "FROM ubuntu:18.04\n\n# also install python version 2 used by bowtie2\nRUN apt-get update && \\\n    DEBIAN_FRONTEND=\"noninteractive\" apt-get --no-install-recommends install -y python python-dev python3 python3-dev python3-pip apt-transport-https openjdk-8-jre wget zip \\\n    python3-matplotlib pandoc texlive software-properties-common \\\n    python3-pandas python3-biopython python3-tk && \\\n    apt-get remove -y texlive-fonts-recommended-doc texlive-latex-base-doc \\\n        texlive-latex-recommended-doc \\\n        texlive-pictures-doc texlive-pstricks-doc && rm -rf /var/lib/apt/lists/*;\n\nRUN pip3 install --no-cache-dir boto3 cloudpickle awscli\n\n# install dependencies\nRUN pip3 install --no-cache-dir kneaddata --no-binary :all:\n\nRUN pip3 install --no-cache-dir humann==3.0.0.alpha.3 --no-binary :all:\n\nRUN pip3 install --no-cache-dir numpy==1.14.5\nRUN pip3 install --no-cache-dir scipy\nRUN pip3 install --no-cache-dir cython\nRUN apt-get install --no-install-recommends python3-pysam samtools zlib1g-dev libbz2-dev liblzma-dev -y && rm -rf /var/lib/apt/lists/*;\nRUN pip3 install --no-cache-dir biom-format\n\n# install cmseq\nRUN apt-get install --no-install-recommends -y git && \\\n    git clone https://github.com/SegataLab/cmseq.git && \\\n    cd cmseq && \\\n    python3 setup.py install && \\\n    cd ../ && \\\n    rm -r cmseq && rm -rf /var/lib/apt/lists/*;\n\nRUN apt-get install --no-install-recommends python3-pysam samtools zlib1g-dev libbz2-dev liblzma-dev -y && rm -rf /var/lib/apt/lists/*;\n\n# install v3 of phylophlan plus dependencies and setup default configuration\nRUN apt-get install --no-install-recommends fasttree ncbi-blast+ mafft raxml -y && rm -rf /var/lib/apt/lists/*;\nRUN pip3 install --no-cache-dir PhyloPhlAn\nRUN wget https://github.com/scapella/trimal/archive/v1.4.1.tar.gz && \\\n    tar xzvf v1.4.1.tar.gz && \\\n    cd trimal-1.4.1/source/ && make && cp *al /usr/local/bin/ && \\\n    cd ../../ && \\\n    rm v1.4.1.tar.gz && rm -r trimal-1.4.1\n\n# write config files\nRUN mkdir -p /usr/local/lib/python3.6/dist-packages/phylophlan/phylophlan_configs\nRUN phylophlan_write_config_file -o /usr/local/lib/python3.6/dist-packages/phylophlan/phylophlan_configs/supermatrix_nt.cfg \\\n    -d n --db_dna makeblastdb --map_dna blastn --msa mafft --trim trimal --tree1 fasttree --tree2 raxml --overwrite --verbose\n\nRUN pip3 install --no-cache-dir metaphlan==3.0.7\nRUN metaphlan --install --nproc 24\n\n# install hclust2 from source\nRUN apt-get install --no-install-recommends -y python-pip python-matplotlib python-scipy python-pandas && rm -rf /var/lib/apt/lists/*;\nRUN wget https://raw.githubusercontent.com/SegataLab/hclust2/master/hclust2.py && \\\n    mv hclust2.py /usr/local/bin/ && \\\n    chmod +x /usr/local/bin/hclust2.py\n\n# install R with vegan\nRUN apt-key adv --keyserver keyserver.ubuntu.com --recv-keys E298A3A825C0D65DFD57CBB651716619E084DAB9 && \\\n    add-apt-repository 'deb https://cloud.r-project.org/bin/linux/ubuntu bionic-cran35/' && \\\n    apt-get update -y && \\\n    apt-get install --no-install-recommends r-base-dev libcurl4-openssl-dev -y && \\\n    R -q -e \"install.packages('vegan', repos='http://cran.r-project.org')\" && rm -rf /var/lib/apt/lists/*;\n\n# install workflows 16s dependencies\nRUN wget https://drive5.com/downloads/usearch9.0.2132_i86linux32.gz && \\\n    gunzip usearch9.0.2132_i86linux32.gz && \\\n    chmod +x usearch9.0.2132_i86linux32 && \\\n    mv usearch9.0.2132_i86linux32 /usr/local/bin/usearch\n\nRUN wget https://github.com/torognes/vsearch/releases/download/v2.14.2/vsearch-2.14.2-linux-x86_64.tar.gz && \\\n    tar xzvf vsearch-2.14.2-linux-x86_64.tar.gz && \\\n    cp vsearch-2.14.2-linux-x86_64/bin/vsearch /usr/local/bin/ && rm vsearch-2.14.2-linux-x86_64.tar.gz\n\n# install clustalo and rename fasttree\nRUN apt-get install --no-install-recommends -y clustalo && rm -rf /var/lib/apt/lists/*;\nRUN ln -s /usr/bin/fasttree /usr/bin/FastTree\n\n# install picrust2 and dependencies\nRUN apt-get install --no-install-recommends hmmer -y && rm -rf /var/lib/apt/lists/*;\nRUN pip3 install --no-cache-dir pandas --upgrade\nRUN R -q -e \"install.packages(c('castor'), repos='http://cran.r-project.org')\"\n\nRUN wget https://github.com/picrust/picrust2/archive/v2.3.0-b.tar.gz && tar xvzf v2.3.0-b.tar.gz && ( cd picrust2-2.3.0-b/ && pip3 install --no-cache-dir --editable . && cp -r picrust2/default_files /usr/local/lib/python3.6/dist-packages/picrust2/) && rm -r picrust2* && rm v2.3.0-b.tar.gz\n\nRUN apt-get install --no-install-recommends autotools-dev libtool flex bison cmake automake autoconf -y && rm -rf /var/lib/apt/lists/*;\n\nRUN wget https://github.com/Pbdas/epa-ng/archive/v0.3.6.tar.gz && tar xzvf v0.3.6.tar.gz && rm v0.3.6.tar.gz\nRUN cd epa-ng-0.3.6/ && make && cp bin/epa-ng /usr/local/bin/ && cd ../\nRUN rm -r epa-ng* && rm v0.3.6.tar.gz\n\nRUN wget https://github.com/lczech/gappa/archive/v0.6.0.tar.gz && tar xzvf v0.6.0.tar.gz && rm v0.6.0.tar.gz\nRUN cd gappa-0.6.0/ && make && cp bin/gappa /usr/local/bin/ && cd ../\nRUN rm -r gappa* && rm v0.6.0.tar.gz\n\n# Update to newer pandoc version (to work with latest engine options in anadama2)\nRUN wget https://github.com/jgm/pandoc/releases/download/2.10/pandoc-2.10-1-amd64.deb && \\\n    dpkg -i pandoc-2.10-1-amd64.deb && \\\n    rm pandoc-2.10-1-amd64.deb\n\nRUN pip install --no-cache-dir anadama2==0.7.9\nRUN pip3 install --no-cache-dir biobakery_workflows==3.0.0-alpha.6\n\n# install dada2 and dependencies\nRUN R -q -e \"install.packages('BiocManager', repos='http://cran.r-project.org')\"\nRUN R -q -e \"library(BiocManager); BiocManager::install('dada2')\"\n\nRUN R -q -e \"install.packages(c('gridExtra','seqinr','castor'), repos='http://cran.r-project.org')\"\n\n# install picrust1\nRUN wget https://github.com/picrust/picrust/releases/download/v1.1.4/picrust-1.1.4.tar.gz && \\\n    tar -xzf picrust-1.1.4.tar.gz && cd picrust-1.1.4 && pip install --no-cache-dir . && rm picrust-1.1.4.tar.gz\n\n"
}