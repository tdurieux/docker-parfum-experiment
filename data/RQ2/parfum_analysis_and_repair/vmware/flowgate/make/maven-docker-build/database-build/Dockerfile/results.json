{
  "startTime": 1674253492852,
  "endTime": 1674253494324,
  "originalSmells": [
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 33,
        "lineEnd": 34,
        "columnStart": 4,
        "columnEnd": 39
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "#\n#Copyright 2019 VMware, Inc.\n#\n#Licensed under the Apache License, Version 2.0 (the \"License\");\n#you may not use this file except in compliance with the License.\n#You may obtain a copy of the License at\n#\n#    http://www.apache.org/licenses/LICENSE-2.0\n#\n#Unless required by applicable law or agreed to in writing, software\n#distributed under the License is distributed on an \"AS IS\" BASIS,\n#WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n#See the License for the specific language governing permissions and\n#limitations under the License.\n#\n\nFROM ubuntu:16.04\n\n#MAINTAINER Couchbase Docker Team <docker@couchbase.com>\n\n# Install dependencies:\n#  runit: for container process management\n#  wget: for downloading .deb\n#  python-httplib2: used by CLI tools\n#  chrpath: for fixing curl, below\n#  tzdata: timezone info used by some N1QL functions\n# Additional dependencies for system commands used by cbcollect_info:\n#  lsof: lsof\n#  lshw: lshw\n#  sysstat: iostat, sar, mpstat\n#  net-tools: ifconfig, arp, netstat\n#  numactl: numactl\nRUN apt-get update && \\\n    apt-get install --no-install-recommends -yq zip runit wget python-httplib2 chrpath tzdata \\\n    lsof lshw sysstat net-tools numactl && \\\n    apt-get autoremove && apt-get clean && \\\n    rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/*\n\nARG CB_VERSION=6.0.0\nARG CB_RELEASE_URL=https://packages.couchbase.com/releases\nARG CB_PACKAGE=couchbase-server-community_6.0.0-ubuntu16.04_amd64.deb\nARG CB_SHA256=949b1ded72776a557b9cd3ac89253a4fe6aed079966a4057c5aec41ae5a30ece\n\nENV PATH=$PATH:/opt/couchbase/bin:/opt/couchbase/bin/tools:/opt/couchbase/bin/install\n\n# Create Couchbase user with UID 1000 (necessary to match default\n# boot2docker UID)\nRUN groupadd -g 1000 couchbase && useradd couchbase -u 1000 -g couchbase -M\n\n# Install couchbase\nRUN export INSTALL_DONT_START_SERVER=1 && \\\n    wget -N $CB_RELEASE_URL/$CB_VERSION/$CB_PACKAGE && \\\n    echo \"$CB_SHA256  $CB_PACKAGE\" | sha256sum -c - && \\\n    dpkg -i ./$CB_PACKAGE && rm -f ./$CB_PACKAGE\n\n# Add dummy script for commands invoked by cbcollect_info that\n# make no sense in a Docker container\nCOPY dummy.sh /usr/local/bin/\nRUN ln -s dummy.sh /usr/local/bin/iptables-save && \\\n    ln -s dummy.sh /usr/local/bin/lvdisplay && \\\n    ln -s dummy.sh /usr/local/bin/vgdisplay && \\\n    ln -s dummy.sh /usr/local/bin/pvdisplay && \\\n    mkdir -p /home/couchbase\n\nRUN chown -R couchbase:couchbase /home/couchbase\nCOPY init.sh /\n\n# Fix curl RPATH\nRUN chrpath -r '$ORIGIN/../lib' /opt/couchbase/bin/curl\n\n# 8091: Couchbase Web console, REST/HTTP interface\n# 8092: Views, queries, XDCR\n# 8093: Query services (4.0+)\n# 8094: Full-text Search (4.5+)\n# 8095: Analytics (5.5+)\n# 8096: Eventing (5.5+)\n# 11207: Smart client library data node access (SSL)\n# 11210: Smart client library/moxi data node access\n# 11211: Legacy non-smart client library data node access\n# 18091: Couchbase Web console, REST/HTTP interface (SSL)\n# 18092: Views, query, XDCR (SSL)\n# 18093: Query services (SSL) (4.0+)\n# 18094: Full-text Search (SSL) (4.5+)\n# 18095: Analytics (SSL) (5.5+)\n# 18096: Eventing (SSL) (5.5+)\nEXPOSE 8091 8092 8093 8094 8095 8096 11207 11210 11211 18091 18092 18093 18094 18095 18096\nVOLUME /opt/couchbase/var\n\n# Add bootstrap script\nCOPY entrypoint.sh /\nENTRYPOINT [\"/entrypoint.sh\"]\n"
}