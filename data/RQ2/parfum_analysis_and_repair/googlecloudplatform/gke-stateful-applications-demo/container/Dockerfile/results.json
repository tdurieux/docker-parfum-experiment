{
  "startTime": 1674253932659,
  "endTime": 1674253934146,
  "originalSmells": [
    {
      "rule": "wgetUseHttpsUrl",
      "position": {
        "lineStart": 62,
        "lineEnd": 62,
        "columnStart": 7,
        "columnEnd": 224
      }
    },
    {
      "rule": "wgetUseHttpsUrl",
      "position": {
        "lineStart": 64,
        "lineEnd": 64,
        "columnStart": 7,
        "columnEnd": 189
      }
    },
    {
      "rule": "sha256sumEchoOneSpaces",
      "position": {
        "lineStart": 63,
        "lineEnd": 63,
        "columnStart": 7,
        "columnEnd": 84
      }
    },
    {
      "rule": "sha256sumEchoOneSpaces",
      "position": {
        "lineStart": 74,
        "lineEnd": 74,
        "columnStart": 7,
        "columnEnd": 94
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "# Copyright 2018 Google LLC\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#     https://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n\nFROM gcr.io/google-containers/debian-base-amd64:0.3\n\nARG BUILD_DATE\nARG VCS_REF\nARG CASSANDRA_VERSION\nARG CQLSH_CONTAINER\n\nLABEL \\\n    org.label-schema.build-date=$BUILD_DATE \\\n    org.label-schema.docker.dockerfile=\"/Dockerfile\" \\\n    org.label-schema.license=\"Apache License 2.0\" \\\n    org.label-schema.name=\"Cassandra container optimized for Kubernetes\" \\\n    org.label-schema.url=\"https://github.com/GoogleCloudPlatform/\" \\\n    org.label-schema.vcs-ref=$VCS_REF \\\n    org.label-schema.vcs-type=\"Git\" \\\n    org.label-schema.vcs-url=\"https://github.com/GoogleCloudPlatform/gke-stateful-applications-demo\"\n\nENV \\\n    CASSANDRA_CONF=/etc/cassandra \\\n    CASSANDRA_DATA=/var/lib/cassandra \\\n    CASSANDRA_LOGS=/var/log/cassandra \\\n    CASSANDRA_RELEASE=3.11.3 \\\n    CASSANDRA_SHA=d82e0670cb41b091e88fff55250ce945c4ea026c87a5517d3cf7b6b351d5e2ba \\\n    JAVA_HOME=/usr/lib/jvm/java-8-openjdk-amd64 \\\n    DI_VERSION=1.2.1 \\\n    DI_SHA=057ecd4ac1d3c3be31f82fc0848bf77b1326a975b4f8423fe31607205a0fe945 \\\n    JOLOKIA_VERSION=1.5.0 \\\n    JOLOKIA_SHA=cd7e20a2887e013873d7321cea1e6bf6bd6ffcdd3cd3968d6950edd8d79bbfb8 \\\n    PROMETHEUS_VERSION=0.10 \\\n    PROMETHEUS_SHA=b144a5a22fc9ee62d8d198f0dcc622f851c77cf52fee4bd529afbc266af37e29 \\\n    LOGENCODER_VERSION=4.10-SNAPSHOT \\\n    LOGENCODER_SHA=89be27bea7adc05b68c052a27b08c594a9f8e354185acbfd7a7b5f04c7cd9e20\n\nCOPY files /\n\n# hadolint ignore=DL3008,DL4006\nRUN \\\n    set -ex \\\n    && echo 'debconf debconf/frontend select Noninteractive' | debconf-set-selections \\\n    && export CASSANDRA_VERSION=${CASSANDRA_VERSION:-$CASSANDRA_RELEASE} \\\n    && export CASSANDRA_HOME=/usr/local/apache-cassandra-${CASSANDRA_VERSION} \\\n    && apt-get update && apt-get -qq -y --force-yes install --no-install-recommends \\\n        bash \\\n\topenjdk-8-jre-headless \\\n        libjemalloc1 \\\n        localepurge \\\n        wget \\\n        jq \\\n    && wget -q -O - \"https://search.maven.org/remotecontent?filepath=io/prometheus/jmx/jmx_prometheus_javaagent/${PROMETHEUS_VERSION}/jmx_prometheus_javaagent-${PROMETHEUS_VERSION}.jar\" > /usr/local/share/prometheus-agent.jar \\\n    && echo \"$PROMETHEUS_SHA  /usr/local/share/prometheus-agent.jar\" | sha256sum -c - \\\n    && wget -q -O - \"https://search.maven.org/remotecontent?filepath=org/jolokia/jolokia-jvm/${JOLOKIA_VERSION}/jolokia-jvm-${JOLOKIA_VERSION}-agent.jar\" > /usr/local/share/jolokia-agent.jar \\\n    && echo \"$JOLOKIA_SHA  /usr/local/share/jolokia-agent.jar\" | sha256sum -c - \\\n    && mirror_url=$( wget -q -O - 'https://www.apache.org/dyn/closer.cgi?as_json=1' | jq --raw-output '.preferred' ) \\\n    && wget -q -O - \"${mirror_url}cassandra/${CASSANDRA_VERSION}/apache-cassandra-${CASSANDRA_VERSION}-bin.tar.gz\" > /usr/local/apache-cassandra-bin.tar.gz \\\n    && echo \"$CASSANDRA_SHA /usr/local/apache-cassandra-bin.tar.gz\" | sha256sum - \\\n    && tar -xzf /usr/local/apache-cassandra-bin.tar.gz -C /usr/local \\\n    && rm /usr/local/apache-cassandra-bin.tar.gz \\\n    && ln -s $CASSANDRA_HOME /usr/local/apache-cassandra \\\n    # TODO stage this in gcr\n    && wget -q -O - \"https://github.com/mstump/logstash-logback-encoder/releases/download/${LOGENCODER_VERSION}/logstash-logback-encoder-${LOGENCODER_VERSION}.jar\" > /usr/local/apache-cassandra/lib/log-encoder.jar \\\n    && echo \"$LOGENCODER_SHA  /usr/local/apache-cassandra/lib/log-encoder.jar\" | sha256sum -c - \\\n    && wget -q -O - https://github.com/Yelp/dumb-init/releases/download/v${DI_VERSION}/dumb-init_${DI_VERSION}_amd64 > /sbin/dumb-init \\\n    && echo \"$DI_SHA  /sbin/dumb-init\" | sha256sum -c - \\\n    && adduser --disabled-password --no-create-home --gecos '' --disabled-login cassandra \\\n    && mkdir -p /var/lib/cassandra/ /var/log/cassandra/ /etc/cassandra/triggers \\\n    && chmod +x /sbin/dumb-init /ready-probe.sh \\\n    && mv /logback-stdout.xml /logback-json-files.xml /logback-json-stdout.xml /logback-files.xml /cassandra.yaml /jvm.options /prometheus.yaml /etc/cassandra/ \\\n    && mv /usr/local/apache-cassandra/conf/cassandra-env.sh /etc/cassandra/ \\\n    && chown cassandra: /ready-probe.sh \\\n    && if [ -n \"$CQLSH_CONTAINER\" ]; then apt-get -y --no-install-recommends install python; else rm -rf  $CASSANDRA_HOME/pylib; fi \\\n    && apt-get -y purge wget jq localepurge \\\n    && apt-get -y autoremove \\\n    && apt-get clean \\\n    && rm -rf \\\n        $CASSANDRA_HOME/*.txt \\\n        $CASSANDRA_HOME/doc \\\n        $CASSANDRA_HOME/javadoc \\\n        $CASSANDRA_HOME/tools/*.yaml \\\n        $CASSANDRA_HOME/tools/bin/*.bat \\\n        $CASSANDRA_HOME/bin/*.bat \\\n        doc \\\n        man \\\n        info \\\n        locale \\\n        common-licenses \\\n        ~/.bashrc \\\n        /var/lib/apt/lists/* \\\n        /var/log/**/* \\\n        /var/cache/debconf/* \\\n        /etc/systemd \\\n        /lib/lsb \\\n        /lib/udev \\\n        /usr/share/doc/ \\\n        /usr/share/doc-base/ \\\n        /usr/share/man/ \\\n        /tmp/* \\\n        /usr/lib/jvm/java-8-openjdk-amd64/jre/plugin \\\n        /usr/lib/jvm/java-8-openjdk-amd64/jre/bin/javaws \\\n        /usr/lib/jvm/java-8-openjdk-amd64/jre/bin/jjs \\\n        /usr/lib/jvm/java-8-openjdk-amd64/jre/bin/orbd \\\n        /usr/lib/jvm/java-8-openjdk-amd64/jre/bin/pack200 \\\n        /usr/lib/jvm/java-8-openjdk-amd64/jre/bin/policytool \\\n        /usr/lib/jvm/java-8-openjdk-amd64/jre/bin/rmid \\\n        /usr/lib/jvm/java-8-openjdk-amd64/jre/bin/rmiregistry \\\n        /usr/lib/jvm/java-8-openjdk-amd64/jre/bin/servertool \\\n        /usr/lib/jvm/java-8-openjdk-amd64/jre/bin/tnameserv \\\n        /usr/lib/jvm/java-8-openjdk-amd64/jre/bin/unpack200 \\\n        /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/javaws.jar \\\n        /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/deploy* \\\n        /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/desktop \\\n        /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/*javafx* \\\n        /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/*jfx* \\\n        /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/amd64/libdecora_sse.so \\\n        /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/amd64/libprism_*.so \\\n        /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/amd64/libfxplugins.so \\\n        /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/amd64/libglass.so \\\n        /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/amd64/libgstreamer-lite.so \\\n        /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/amd64/libjavafx*.so \\\n        /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/amd64/libjfx*.so \\\n        /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/ext/jfxrt.jar \\\n        /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/ext/nashorn.jar \\\n        /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/oblique-fonts \\\n        /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/plugin.jar \\\n        /usr/lib/jvm/java-8-openjdk-amd64/jre/man \\\n        /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/images \\\n        /usr/lib/jvm/java-8-openjdk-amd64/man \\\n        /usr/lib/jvm/java-8-openjdk-amd64/jre/THIRD_PARTY_README \\\n        /usr/lib/jvm/java-8-openjdk-amd64/jre/ASSEMBLY_EXCEPTION\n\nVOLUME [\"/var/lib/cassandra\"]\n\n# 1234: prometheus jmx_exporter\n# 7000: intra-node communication\n# 7001: TLS intra-node communication\n# 7199: JMX\n# 9042: CQL\n# 9160: thrift service\n# 8778: jolokia port\nEXPOSE 1234 7000 7001 7199 9042 9160 8778\n\nCMD [\"/sbin/dumb-init\", \"/bin/bash\", \"/run.sh\"]\n"
}