{
  "startTime": 1674248897879,
  "endTime": 1674248898586,
  "originalSmells": [
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 5,
        "lineEnd": 5,
        "columnStart": 3,
        "columnEnd": 33
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 5,
        "lineEnd": 5,
        "columnStart": 3,
        "columnEnd": 33
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "FROM onlyoffice/communityserver:latest AS communityserver-ami\nARG APPSETTING_CONFIG=/var/www/onlyoffice/WebStudio/web.appsettings.config\nARG RESOURCE_SQL=/var/www/onlyoffice/Sql/onlyoffice.resources.sql\n\nRUN apt-get -y update && \\\n   apt-get install --no-install-recommends -yq xmlstarlet && rm -rf /var/lib/apt/lists/*;\n\nRUN echo \"INSERT INTO \\`tenants_tariff\\` (\\`tenant\\`, \\`tariff\\`, \\`stamp\\`, \\`comment\\`) VALUES ('-1', '-1000', NOW() + INTERVAL 5 YEAR, 'ami');\" >> $RESOURCE_SQL && \\\n    echo \"INSERT INTO \\`tenants_quota\\` (\\`tenant\\`, \\`name\\`, \\`max_file_size\\`, \\`max_total_size\\`, \\`active_users\\`, \\`features\\`) VALUES ('-1000', 'start_trial', '102400', '10995116277760', '10000', 'docs,domain,audit,controlpanel,healthcheck,ldap,sso,whitelabel,branding,ssbranding,update,support,portals:10000,discencryption,privacyroom');\" >> $RESOURCE_SQL && \\\n    echo \"UPDATE \\`core_settings\\` SET \\`value\\` = 0x1371A72766B7FD0D86DC0E83CFFFF0CE9A8BE350B7D1779D12C2D160376CFDE646294E0DE9B8E487DC856817EF01A21F53C93883F979FCE38AFE74799B58B64E822FFAD96289813A644CC5CBE2471328E5B9D03DB4426D67EC877299ABD6A5BE6561F4A8061ECE01D41F50220EFB748AC1F67E5D649E57E204352DC2DFF15E18675A9AA5BAAD41CC4779CBE63C5933E1 WHERE tenant = -1 AND id = 'SmtpSettings';\" >> $RESOURCE_SQL && \\\n    chown onlyoffice:onlyoffice $RESOURCE_SQL\n\nRUN xmlstarlet ed -L \\\n    -s \"/appSettings\" -t elem -n \"add\" \\\n    -i \"/appSettings/add[not(@*)]\" -t attr -n \"key\" -v \"fullTextSearch\" \\\n    -i \"/appSettings/add[@key='fullTextSearch']\" -t attr -n \"value\" -v \"false\" \\\n    $APPSETTING_CONFIG && \\\n    xmlstarlet ed -L \\\n    -s \"/appSettings\" -t elem -n \"add\" \\\n    -i \"/appSettings/add[not(@*)]\" -t attr -n \"key\" -v \"web.ami.meta\" \\\n    -i \"/appSettings/add[@key='web.ami.meta']\" -t attr -n \"value\" -v \"http://169.254.169.254/latest/meta-data/\" \\\n    $APPSETTING_CONFIG && \\\n    xmlstarlet ed -L \\\n    -d \"/appSettings/add[@key='files.thirdparty.enable']\" \\\n    -s \"/appSettings\" -t elem -n \"add\" \\\n    -i \"/appSettings/add[not(@*)]\" -t attr -n \"key\" -v \"files.thirdparty.enable\" \\\n    -i \"/appSettings/add[@key='files.thirdparty.enable']\" -t attr -n \"value\" -v \"box,dropboxv2,docusign,google,onedrive,nextcloud,owncloud,webdav,kdrive,yandex\" \\\n    $APPSETTING_CONFIG && \\\n    xmlstarlet ed -L \\\n    -d \"/appSettings/add[@key='web.hide-settings']\" \\\n    -s \"/appSettings\" -t elem -n \"add\" \\\n    -i \"/appSettings/add[not(@*)]\" -t attr -n \"key\" -v \"web.hide-settings\" \\\n    -i \"/appSettings/add[@key='web.hide-settings']\" -t attr -n \"value\" -v \"VersionSettings,Monitoring,PublicPortal,PortalRename,Migration,Promocode,TariffSettings,ProxyHttpContent,MailService,FullTextSearch,Storage,EncryptionSettings\" \\\n    $APPSETTING_CONFIG\n\nFROM communityserver-ami AS communityserver-alc\nARG APPSETTING_CONFIG=/var/www/onlyoffice/WebStudio/web.appsettings.config\n\nRUN xmlstarlet ed -L \\\n    -d \"/appSettings/add[@key='web.ami.meta']\" \\\n    -s \"/appSettings\" -t elem -n \"add\" \\\n    -i \"/appSettings/add[not(@*)]\" -t attr -n \"key\" -v \"web.ami.meta\" \\\n    -i \"/appSettings/add[@key='web.ami.meta']\" -t attr -n \"value\" -v \"http://100.100.100.200/latest/meta-data/\" \\\n    $APPSETTING_CONFIG\n"
}