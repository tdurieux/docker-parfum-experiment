{
  "startTime": 1674248092713,
  "endTime": 1674248094196,
  "originalSmells": [
    {
      "rule": "yumInstallRmVarCacheYum",
      "position": {
        "lineStart": 69,
        "lineEnd": 69,
        "columnStart": 4,
        "columnEnd": 84
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "# LICENSE CDDL 1.0 + GPL 2.0\n#\n# Copyright (c) 2020 DATAlysis LLC (https://datalysis.ch). All rights reserved.\n#\n# OAS DOCKERFILES PROJECT\n# --------------------------\n# This is the Dockerfile for Oracle Analytics Server 5.9.0\n#\n# REQUIRED FILES TO BUILD THIS IMAGE\n# ----------------------------------\n# (1) Oracle_Analytics_Server_Linux_5.9.0.zip\n#     Download Oracle Analytics Server 5.9.0 Installer For Linux x86-64-bit\n#     from https://www.oracle.com/solutions/business-analytics/analytics-server/analytics-server.html\n# (2) fmw_12.2.1.4.0_infrastructure_Disk1_1of1.zip\n#     Download Oracle WebLogic Server 12.2.1.4 - Fusion Middleware Infrastructure Installer\n#     from https://www.oracle.com/middleware/technologies/weblogic-server-installers-downloads.html\n# (3) jdk-8u291-linux-x64.rpm\n#     Download an Oracle JDK 1.8.211+\n#     from https://www.oracle.com/java/technologies/javase/javase-jdk8-downloads.html\n# (4) p30657796_122140_Generic.zip\n#     Download Oracle WebLogic Server 12.2.1.4 Patch\n#     from https://www.oracle.com/solutions/business-analytics/analytics-server/analytics-server.html\n#\n# HOW TO BUILD THIS IMAGE\n# -----------------------\n# Put all downloaded files in the same directory as this Dockerfile\n# Run:\n#      $ docker build -t oracle/oas:5.9.0 .\n\n\n# Pull base image\n# ---------------\nFROM oraclelinux:7-slim\n\n# Maintainer\n# ----------\nLABEL maintainer=\"Gianni Ceresa <gianni.ceresa@datalysis.ch>\"\n\n# Environment variables required for this build (do NOT change)\n# -------------------------------------------------------------\nENV OAS_VERSION=\"5.9.0\"                         \\\n    ORACLE_BASE=/opt/oracle                     \\\n    INSTALL_FILE_JDK=\"jdk-8u291-linux-x64.rpm\"  \\\n    INSTALL_FILE_WLS=\"fmw_12.2.1.4.0_infrastructure_Disk1_1of1.zip\" \\\n    INSTALL_FILE_WLS_PATCH=\"p30657796_122140_Generic.zip\"           \\\n    INSTALL_FILE_OAS=\"Oracle_Analytics_Server_Linux_5.9.0.zip\"      \\\n    INSTALL_RSP_WLS=\"weblogic.rsp\"              \\\n    INSTALL_RSP_OAS=\"oas_install.rsp\"           \\\n    CONFIG_RSP_OAS=\"oas_config.rsp\"             \\\n    RUN_FILE=\"runOAS.sh\"\n\n# Use second ENV so that variables get substituted\nENV INSTALL_DIR=${ORACLE_BASE}/install                 \\\n    ORACLE_HOME=${ORACLE_BASE}/product/${OAS_VERSION}  \\\n    DOMAIN_HOME=${ORACLE_BASE}/config/domains\n\n# Copy binaries\n# -------------\nCOPY ${INSTALL_FILE_JDK} ${INSTALL_FILE_WLS} ${INSTALL_FILE_WLS_PATCH} ${INSTALL_FILE_OAS} ${INSTALL_DIR}/\nCOPY ${INSTALL_RSP_WLS} ${INSTALL_RSP_OAS} ${CONFIG_RSP_OAS} ${RUN_FILE} _configureOAS.sh _validateRCU.sh _dropRCU.sh ${ORACLE_BASE}/\n\n# Setup filesystem and 'oracle' user\n# Adjust file permissions, go to 'ORACLE_HOME' as 'oracle' to proceed with OAS installation\n# Install pre-req packages + Oracle JDK\n# Make sure the run files are executable\n# ------------------------------------------\nRUN useradd -d /home/oracle -m -s /bin/bash oracle                               && \\\n    echo oracle:oracle | chpasswd                                                && \\\n    yum -y update                                                                && \\\n    yum -y install oracle-database-preinstall-19c unzip wget tar openssl libgfortran  && \\\n    yum -y localinstall ${INSTALL_DIR}/${INSTALL_FILE_JDK}                       && \\\n    yum clean all                                                                && \\\n    rm ${INSTALL_DIR}/${INSTALL_FILE_JDK}                                        && \\\n    touch ${ORACLE_BASE}/oraInst.loc                                             && \\\n    echo inventory_loc=${ORACLE_BASE}/oraInventory > ${ORACLE_BASE}/oraInst.loc  && \\\n    echo inst_group=oracle >> ${ORACLE_BASE}/oraInst.loc                         && \\\n    mkdir -p ${ORACLE_HOME}                                                      && \\\n    mkdir -p ${DOMAIN_HOME}                                                      && \\\n    chown -R oracle. ${ORACLE_BASE}                                              && \\\n    chown -R oracle. ${ORACLE_HOME}                                              && \\\n    chown -R oracle. ${DOMAIN_HOME} && \\\n    chmod ug+x ${ORACLE_BASE}/*.sh && rm -rf /var/cache/yum\n\n# Replace place holders (and force /dev/urandom for Java)\n# -------------------------------------------------------\nRUN sed -i -e \"s|###ORACLE_HOME###|${ORACLE_HOME}|g\"   ${ORACLE_BASE}/${INSTALL_RSP_WLS}  && \\\n    sed -i -e \"s|###ORACLE_HOME###|${ORACLE_HOME}|g\"   ${ORACLE_BASE}/${INSTALL_RSP_OAS}  && \\\n    sed -i -e \"s|###DOMAIN_HOME###|${DOMAIN_HOME}|g\"   ${ORACLE_BASE}/${CONFIG_RSP_OAS}   && \\\n    sed -i -e \"s|source=file:/dev/random|source=file:/dev/urandom|g\"     /usr/java/default/jre/lib/security/java.security  && \\\n    sed -i -e \"s|source=file:/dev/urandom|source=file:/dev/./urandom|g\"  /usr/java/default/jre/lib/security/java.security\n\n# Switch to 'oracle'\n# ------------------\nUSER oracle\n\n# Start installation\n# ------------------\nRUN cd ${INSTALL_DIR}                       && \\\n    unzip ${INSTALL_FILE_WLS} -d ./tmp_wls  && \\\n    rm ${INSTALL_FILE_WLS}                  && \\\n    java -jar $(find ${INSTALL_DIR}/tmp_wls -name *.jar) -silent -responseFile ${ORACLE_BASE}/${INSTALL_RSP_WLS} -invPtrLoc ${ORACLE_BASE}/oraInst.loc  && \\\n    rm -rf ${INSTALL_DIR}/tmp_wls           && \\\n    unzip ${INSTALL_FILE_WLS_PATCH} -d ${INSTALL_DIR}/wls_patch  && \\\n    rm ${INSTALL_FILE_WLS_PATCH}            && \\\n    cd ${INSTALL_DIR}/wls_patch/30657796    && \\\n    ${ORACLE_HOME}/OPatch/opatch apply -silent -invPtrLoc ${ORACLE_BASE}/oraInst.loc  && \\\n    cd ${INSTALL_DIR}                       && \\\n    rm -rf ${INSTALL_DIR}/wls_patch         && \\\n    unzip ${INSTALL_FILE_OAS} -d ./tmp_oas  && \\\n    rm ${INSTALL_FILE_OAS}                  && \\\n    java -jar $(find ${INSTALL_DIR}/tmp_oas -name *.jar) -silent -responseFile ${ORACLE_BASE}/${INSTALL_RSP_OAS} -invPtrLoc ${ORACLE_BASE}/oraInst.loc  && \\\n    rm -rf ${INSTALL_DIR}/tmp_oas           && \\\n    rm -rf ${INSTALL_DIR}\n\n# Set work directory\n# ------------------\nWORKDIR ${ORACLE_BASE}\n\n# Expose ports\n# ------------\nEXPOSE 9500-9514\n\n# Define default command to start OAS\n# -----------------------------------\nCMD ${ORACLE_BASE}/${RUN_FILE}\n"
}