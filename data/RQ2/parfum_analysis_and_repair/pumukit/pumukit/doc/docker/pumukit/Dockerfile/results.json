{
  "startTime": 1674246836126,
  "endTime": 1674246839152,
  "originalSmells": [
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 65,
        "lineEnd": 65,
        "columnStart": 4,
        "columnEnd": 40
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "ARG PHP_VERSION=7.4\nARG ALPINE_VERSION=3.11\n\nFROM php:${PHP_VERSION}-fpm-alpine${ALPINE_VERSION} as base\nMAINTAINER Pablo Nieto, pnieto@teltek.es\n\nARG APCU_VERSION=5.1.19\nARG PHP_MONGODB_VERSION=1.9.0\nARG XDEBUG_VERSION=3.0.1\n\nENV PHP_FPM_PM=\"dynamic\" \\\n\tPHP_FPM_MAX_CHILDREN=\"5\" \\ \n\tPHP_FPM_START_SERVERS=\"2\" \\\n\tPHP_FPM_MIN_SPARE_SERVERS=\"1\" \\\n\tPHP_FPM_MAX_SPARE_SERVERS=\"2\" \\\n\tPHP_FPM_MAX_REQUESTS=\"1000\" \\\n\tPHP_MAX_EXECUTION_TIME=30 \\\n\tPHP_MEMORY_LIMIT=512M \\\n\tPHP_UPLOAD_MAX_FILESIZE=10G \\\n\tPHP_UPLOAD_TMP_DIR=/tmp \\\n\tPHP_DEFAULT_LOCALE=es \\\n\tPHP_DEFAULT_CHARSET=UTF-8\n\nENV PHP_FPM_PM=\"dynamic\" \\\n\tPHP_FPM_MAX_CHILDREN=\"5\" \\ \n\tPHP_FPM_START_SERVERS=\"2\" \\\n\tPHP_FPM_MIN_SPARE_SERVERS=\"1\" \\\n\tPHP_FPM_MAX_SPARE_SERVERS=\"2\" \\\n\tPHP_FPM_MAX_REQUESTS=\"1000\" \\\n\tPHP_MAX_EXECUTION_TIME=30 \\\n\tPHP_MEMORY_LIMIT=512M \\\n\tPHP_UPLOAD_MAX_FILESIZE=10G \\\n\tPHP_UPLOAD_TMP_DIR=/tmp \\\n\tPHP_DEFAULT_LOCALE=es \\\n\tPHP_DEFAULT_CHARSET=UTF-8\n\nENV PHP_FPM_PM=\"dynamic\" \\\n\tPHP_FPM_MAX_CHILDREN=\"5\" \\ \n\tPHP_FPM_START_SERVERS=\"2\" \\\n\tPHP_FPM_MIN_SPARE_SERVERS=\"1\" \\\n\tPHP_FPM_MAX_SPARE_SERVERS=\"2\" \\\n\tPHP_FPM_MAX_REQUESTS=\"1000\" \\\n\tPHP_MAX_EXECUTION_TIME=30 \\\n\tPHP_MEMORY_LIMIT=512M \\\n\tPHP_UPLOAD_MAX_FILESIZE=10G \\\n\tPHP_UPLOAD_TMP_DIR=/tmp \\\n\tPHP_DEFAULT_LOCALE=es \\\n\tPHP_DEFAULT_CHARSET=UTF-8\n\nRUN apk  add --no-cache \\\n    \t    --update \\\n\t     \tlibgcc \\\n\t\t\tlibstdc++ \\\n\t\t\tca-certificates \\\n\t\t\tlibcrypto1.1 \\\n\t\t\tlibssl1.1 \\\n\t\t\tlibgomp \\\n\t\t\texpat \\\n\t\t\tpython \\\n\t\t\tpy-setuptools \\\n\t\t\tpy-argparse \\\n\t\t\tpy2-pip \\\n\t\t\tgrep \\\n;\n\nRUN pip install --no-cache-dir google-api-python-client\n\nCOPY --from=teltek/ffmpeg /usr/local /usr/local\n\n\nRUN apk add --no-cache \\\n\t\tacl \\\n\t\tfile \\\n\t\tgettext \\\n\t\tgit \\\n;\n\nRUN set -eux; \\\n \tapk add --no-cache --virtual .build-deps \\\n \t\t$PHPIZE_DEPS \\\n \t\ticu-dev \\\n\t\topenldap-dev \\\n\t\tgettext-dev \\\n\t\tlibpng-dev \\\n\t\texpat-dev \\\n \t\tlibzip-dev \\\n \t\tzlib-dev \\\n\t\tlibxml2-dev \\\n\t\tlibxslt-dev \\\n\t\tjpeg-dev \\\n\t\tfreetype-dev \\\n \t; \\\n \t\\\n \tdocker-php-ext-configure zip; \\\n\tfreetype-config --cflags; \\\n     \tmkdir -p /opt/ffmpeg/include; \\\n\tln -s /usr/include/freetype2 /opt/ffmpeg/include/freetype2; \\\n\tdocker-php-ext-configure gd \\\n\t \t--with-freetype \\\n\t\t--with-jpeg ; \\\n \tdocker-php-ext-install -j$(nproc) \\\n \t\tintl \\\n\t\texif \\\n\t\tldap \\\n\t\tgettext \\\n\t\tpcntl \\\n\t\tgd \\\n\t\tshmop \\\n\t\tsockets \\\n\t\tsysvmsg \\\n\t\tsysvsem \\\n\t\tsysvshm \\\n \t\tzip \\\n\t\txsl \\\n\t\tsoap \\\n \t; \\\n \tpecl install \\\n \t\tapcu-${APCU_VERSION} \\\n\t\tmongodb-${PHP_MONGODB_VERSION} \\\n\t\txdebug-${XDEBUG_VERSION} \\\n \t; \\\n \tpecl clear-cache ;\\\n \tdocker-php-ext-enable \\\n \t\tapcu \\\n \t\topcache \\\n\t\tmongodb \\\n \t; \\\n\t\\\n\trunDeps=\"$( \\\n            scanelf --needed --nobanner --format '%n#p' --recursive /usr/local/lib/php/extensions \\\n                | tr ',' '\\n' \\\n                | sort -u \\\n                | awk 'system(\"[ -e /usr/local/lib/\" $1 \" ]\") == 0 { next } { print \"so:\" $1 }' \\\n            )\"; \\\n\tapk add --no-cache --virtual .api-phpexts-rundeps $runDeps; \\\n\t\\\n\tapk del .build-deps\n\n\nCOPY --from=composer:latest /usr/bin/composer /usr/bin/composer\nCOPY php.ini /usr/local/etc/php/php.ini\nCOPY php-cli.ini /usr/local/etc/php/php-cli.ini\n\n\nCOPY ./www.conf /usr/local/etc/php-fpm.d/www.conf\n\n\n\nCOPY ./www.conf /usr/local/etc/php-fpm.d/www.conf\n\n\n\nCOPY ./www.conf /usr/local/etc/php-fpm.d/www.conf\n\n\n# https://getcomposer.org/doc/03-cli.md#composer-allow-superuser\nENV COMPOSER_ALLOW_SUPERUSER=1\n\n# Download and install pumukit to get the composer cache and improve build times\nRUN git clone https://github.com/pumukit/pumukit /srv/pumukit; \\\n\tcd /srv/pumukit; \\\n\tgit checkout master; \\\n\tcomposer install -a -n --no-scripts\nRUN rm -rf /srv/pumukit\n\nENV PATH=\"${PATH}:/root/.composer/vendor/bin\"\n\nWORKDIR /srv/pumukit\n"
}