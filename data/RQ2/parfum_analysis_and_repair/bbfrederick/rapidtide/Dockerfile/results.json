{
  "startTime": 1674219824194,
  "endTime": 1674219825425,
  "originalSmells": [
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 42,
        "lineEnd": 42,
        "columnStart": 4,
        "columnEnd": 138
      }
    },
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 48,
        "lineEnd": 48,
        "columnStart": 4,
        "columnEnd": 89
      }
    },
    {
      "rule": "curlUseHttpsUrl",
      "position": {
        "lineStart": 42,
        "lineEnd": 42,
        "columnStart": 4,
        "columnEnd": 138
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 26,
        "lineEnd": 26,
        "columnStart": 4,
        "columnEnd": 29
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 27,
        "lineEnd": 27,
        "columnStart": 4,
        "columnEnd": 46
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 28,
        "lineEnd": 28,
        "columnStart": 4,
        "columnEnd": 49
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 29,
        "lineEnd": 29,
        "columnStart": 4,
        "columnEnd": 49
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 31,
        "lineEnd": 31,
        "columnStart": 4,
        "columnEnd": 45
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 32,
        "lineEnd": 32,
        "columnStart": 4,
        "columnEnd": 47
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 33,
        "lineEnd": 33,
        "columnStart": 4,
        "columnEnd": 53
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 34,
        "lineEnd": 34,
        "columnStart": 4,
        "columnEnd": 51
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 121,
        "lineEnd": 121,
        "columnStart": 4,
        "columnEnd": 51
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 9,
        "lineEnd": 23,
        "columnStart": 4,
        "columnEnd": 23
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 26,
        "lineEnd": 26,
        "columnStart": 4,
        "columnEnd": 29
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 27,
        "lineEnd": 27,
        "columnStart": 4,
        "columnEnd": 46
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 28,
        "lineEnd": 28,
        "columnStart": 4,
        "columnEnd": 49
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 29,
        "lineEnd": 29,
        "columnStart": 4,
        "columnEnd": 49
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 31,
        "lineEnd": 31,
        "columnStart": 4,
        "columnEnd": 45
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 32,
        "lineEnd": 32,
        "columnStart": 4,
        "columnEnd": 47
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 33,
        "lineEnd": 33,
        "columnStart": 4,
        "columnEnd": 53
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 34,
        "lineEnd": 34,
        "columnStart": 4,
        "columnEnd": 51
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 121,
        "lineEnd": 121,
        "columnStart": 4,
        "columnEnd": 51
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 9,
        "lineEnd": 23,
        "columnStart": 4,
        "columnEnd": 23
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 26,
        "lineEnd": 26,
        "columnStart": 4,
        "columnEnd": 29
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 27,
        "lineEnd": 27,
        "columnStart": 4,
        "columnEnd": 46
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 28,
        "lineEnd": 28,
        "columnStart": 4,
        "columnEnd": 49
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 29,
        "lineEnd": 29,
        "columnStart": 4,
        "columnEnd": 49
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 31,
        "lineEnd": 31,
        "columnStart": 4,
        "columnEnd": 45
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 32,
        "lineEnd": 32,
        "columnStart": 4,
        "columnEnd": 47
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 33,
        "lineEnd": 33,
        "columnStart": 4,
        "columnEnd": 53
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 34,
        "lineEnd": 34,
        "columnStart": 4,
        "columnEnd": 51
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 121,
        "lineEnd": 121,
        "columnStart": 4,
        "columnEnd": 51
      }
    }
  ],
  "repairedSmells": [
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 9,
        "lineEnd": 23,
        "columnStart": 4,
        "columnEnd": 23
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 26,
        "lineEnd": 26,
        "columnStart": 4,
        "columnEnd": 53
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 27,
        "lineEnd": 27,
        "columnStart": 4,
        "columnEnd": 70
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 28,
        "lineEnd": 28,
        "columnStart": 4,
        "columnEnd": 73
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 29,
        "lineEnd": 29,
        "columnStart": 4,
        "columnEnd": 73
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 31,
        "lineEnd": 31,
        "columnStart": 4,
        "columnEnd": 69
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 32,
        "lineEnd": 32,
        "columnStart": 4,
        "columnEnd": 71
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 33,
        "lineEnd": 33,
        "columnStart": 4,
        "columnEnd": 77
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 34,
        "lineEnd": 34,
        "columnStart": 4,
        "columnEnd": 75
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 121,
        "lineEnd": 121,
        "columnStart": 4,
        "columnEnd": 75
      }
    }
  ],
  "repairedDockerfile": "# Use Ubuntu 20.04 LTS\nFROM ubuntu:20.04\n\n# Pre-cache neurodebian key\nCOPY ./dockerbuild/neurodebian.gpg /usr/local/etc/neurodebian.gpg\n\n# Prepare environment\nRUN df -h\nRUN apt-get update\nRUN apt-get install -y --no-install-recommends \\\n                    curl \\\n                    bzip2 \\\n                    ca-certificates \\\n                    xvfb \\\n                    build-essential \\\n                    autoconf \\\n                    libtool \\\n                    gnupg \\\n                    pkg-config \\\n                    xterm \\\n                    libgl1-mesa-glx \\\n                    libx11-xcb1 \\\n                    lsb-release \\\n                    git && rm -rf /var/lib/apt/lists/*;\nARG DEBIAN_FRONTEND=noninteractive\nENV TZ=America/New_York\nRUN apt-get install --no-install-recommends -y tzdata && rm -rf /var/lib/apt/lists/*;\nRUN apt-get install --no-install-recommends -y --reinstall libqt5dbus5 && rm -rf /var/lib/apt/lists/*;\nRUN apt-get install --no-install-recommends -y --reinstall libqt5widgets5 && rm -rf /var/lib/apt/lists/*;\nRUN apt-get install --no-install-recommends -y --reinstall libqt5network5 && rm -rf /var/lib/apt/lists/*;\nRUN apt-get remove qtchooser\nRUN apt-get install --no-install-recommends -y --reinstall libqt5gui5 && rm -rf /var/lib/apt/lists/*;\nRUN apt-get install --no-install-recommends -y --reinstall libqt5core5a && rm -rf /var/lib/apt/lists/*;\nRUN apt-get install --no-install-recommends -y --reinstall libxkbcommon-x11-0 && rm -rf /var/lib/apt/lists/*;\nRUN apt-get install --no-install-recommends -y --reinstall libxcb-xinerama0 && rm -rf /var/lib/apt/lists/*;\n\n\nRUN apt-get clean && rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/*\n\n#RUN git config --global init.defaultBranch main\n\n# Installing Neurodebian packages (FSL)\nRUN curl -f -sSL \"https://neuro.debian.net/lists/$( lsb_release -c | cut -f2 ).us-ca.full\" >> /etc/apt/sources.list.d/neurodebian.sources.list && \\\n    apt-key add /usr/local/etc/neurodebian.gpg && \\\n    (apt-key adv --refresh-keys --keyserver hkp://ha.pool.sks-keyservers.net 0xA5D32F012649A5A9 || true)\n\n\n# Installing and setting up miniconda\nRUN curl -f -sSLO https://repo.anaconda.com/miniconda/Miniconda3-py39_4.12.0-Linux-x86_64.sh && \\\n    bash Miniconda3-py39_4.12.0-Linux-x86_64.sh -b -p /usr/local/miniconda && \\\n    rm Miniconda3-py39_4.12.0-Linux-x86_64.sh\n\n\n# Set CPATH for packages relying on compiled libs (e.g. indexed_gzip)\nENV PATH=\"/usr/local/miniconda/bin:$PATH\" \\\n    CPATH=\"/usr/local/miniconda/include/:$CPATH\" \\\n    LANG=\"C.UTF-8\" \\\n    LC_ALL=\"C.UTF-8\" \\\n    PYTHONNOUSERSITE=1\n\n\n# add the conda-forge channel\nRUN conda config --add channels conda-forge\n\n# Install mamba so we can install packages before the heat death of the universe\nRUN conda install -c conda-forge -y mamba\nRUN conda clean --all\n\n# install conda-build\nRUN conda install -y conda-build\n\n# Update to the newest version of conda\n#RUN conda update -n base -c defaults conda conda-build mamba\n\n# Installing precomputed python packages\nRUN mamba install -y python \\\n                     pip \\\n                     scipy \\\n                     numpy \\\n                     matplotlib \\\n                     mkl \\\n                     mkl-service \\\n                     statsmodels \\\n                     scikit-image \\\n                     scikit-learn \\\n                     nibabel \\\n                     nilearn \\\n                     keras \\\n                     h5py \\\n                     \"tensorflow>=2.4.0\" \\\n                     pyqtgraph \\\n                     pyfftw \\\n                     pandas \\\n                     versioneer \\\n                     numba; sync && \\\n    chmod -R a+rX /usr/local/miniconda; sync && \\\n    chmod +x /usr/local/miniconda/bin/*; sync && \\\n    conda-build purge-all; sync && \\\n    conda clean -tipsy && sync\nRUN df -h\n\n\n# Create a shared $HOME directory\nRUN useradd -m -s /bin/bash -G users rapidtide\nWORKDIR /home/rapidtide\nENV HOME=\"/home/rapidtide\"\n\n\n# Precaching fonts, set 'Agg' as default backend for matplotlib\n#RUN python -c \"from matplotlib import font_manager\" && \\\n#    sed -i 's/\\(backend *: \\).*$/\\1Agg/g' $( python -c \"import matplotlib; print(matplotlib.matplotlib_fname())\" )\n\n\n# Installing rapidtide\nCOPY . /src/rapidtide\nRUN cd /src/rapidtide && \\\n    python setup.py install && \\\n    rm -rf /src/rapidtide/build /src/rapidtide/dist\n\n\nENV IS_DOCKER_8395080871=1\nRUN apt-get install --no-install-recommends -y --reinstall libxcb-xinerama0 && rm -rf /var/lib/apt/lists/*;\n\n\nRUN ldconfig\nWORKDIR /tmp/\nENTRYPOINT [\"/usr/local/miniconda/bin/rapidtide_dispatcher\"]\n\n# set a non-root user\nUSER rapidtide\n\nARG VERSION\nARG BUILD_DATE\nARG VCS_REF\n\nRUN echo $VERSION\nRUN echo $BUILD_DATE\nRUN echo $VCS_REF\n\nLABEL org.label-schema.build-date=$BUILD_DATE \\\n      org.label-schema.name=\"rapidtide\" \\\n      org.label-schema.description=\"rapidtide - a set of tools for delay processing\" \\\n      org.label-schema.url=\"http://nirs-fmri.net\" \\\n      org.label-schema.vcs-ref=$VCS_REF \\\n      org.label-schema.vcs-url=\"https://github.com/bbfrederick/rapidtide\" \\\n      org.label-schema.version=$VERSION\n"
}