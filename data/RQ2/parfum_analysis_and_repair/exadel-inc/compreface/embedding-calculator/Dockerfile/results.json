{
  "startTime": 1674253442934,
  "endTime": 1674253444195,
  "originalSmells": [
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 3,
        "lineEnd": 5,
        "columnStart": 22,
        "columnEnd": 70
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "ARG BASE_IMAGE\nFROM ${BASE_IMAGE:-python:3.7-slim}\n\nRUN apt-get update && apt-get install --no-install-recommends -y build-essential cmake git wget unzip \\\n        curl yasm pkg-config libswscale-dev libtbb2 libtbb-dev libjpeg-dev \\\n        libpng-dev libtiff-dev libavformat-dev libpq-dev libfreeimage3 \\\n    && rm -rf /var/lib/apt/lists/*\n\n# install common python packages\nSHELL [\"/bin/bash\", \"-c\"]\nWORKDIR /app/ml\nCOPY requirements.txt .\nRUN pip --no-cache-dir install -r requirements.txt\n\nARG BE_VERSION\nARG APP_VERSION_STRING\nENV BE_VERSION=$BE_VERSION\nENV APP_VERSION_STRING=$APP_VERSION_STRING\nENV HOME=/app/ml\nENV LC_ALL=C.UTF-8\nENV LANG=C.UTF-8\nENV PYTHONUNBUFFERED=0\nENV JOBLIB_MULTIPROCESSING=0\n\n# download ML models\nARG INTEL_OPTIMIZATION=false\nARG GPU_IDX=-1\nENV GPU_IDX=$GPU_IDX INTEL_OPTIMIZATION=$INTEL_OPTIMIZATION\nARG FACE_DETECTION_PLUGIN=\"facenet.FaceDetector\"\nARG CALCULATION_PLUGIN=\"facenet.Calculator\"\nARG EXTRA_PLUGINS=\"facenet.LandmarksDetector,agegender.AgeDetector,agegender.GenderDetector,facenet.facemask.MaskDetector\"\nENV FACE_DETECTION_PLUGIN=$FACE_DETECTION_PLUGIN CALCULATION_PLUGIN=$CALCULATION_PLUGIN \\\n    EXTRA_PLUGINS=$EXTRA_PLUGINS\nCOPY src src\nCOPY srcext srcext\nRUN python -m src.services.facescan.plugins.setup\n\n# copy rest of the code\nCOPY tools tools\nCOPY sample_images sample_images\n\n# run tests\nARG SKIP_TESTS\nCOPY pytest.ini .\nRUN if [ -z $SKIP_TESTS  ]; then pytest -m \"not performance\" /app/ml/src; fi\n\nEXPOSE 3000\n\nCOPY uwsgi.ini .\nENV UWSGI_PROCESSES=${UWSGI_PROCESSES:-2}\nENV UWSGI_THREADS=1\nCMD [\"uwsgi\", \"--ini\", \"uwsgi.ini\"]\n"
}