{
  "startTime": 1674220062186,
  "endTime": 1674220063006,
  "originalSmells": [
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 76,
        "lineEnd": 76,
        "columnStart": 22,
        "columnEnd": 45
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "# Copyright (c) 2019-21 Red Hat, Inc.\n# This program and the accompanying materials are made\n# available under the terms of the Eclipse Public License 2.0\n# which is available at https://www.eclipse.org/legal/epl-2.0/\n#\n# SPDX-License-Identifier: EPL-2.0\n#\n# Contributors:\n#   Red Hat, Inc. - initial API and implementation\n\nFROM registry-proxy.engineering.redhat.com/rh-osbs/devspaces-theia-rhel8:3.2 as builder\nARG NEXE_SHA1=0f0869b292f1d7b68ba6e170d628de68a10c009f\n\nWORKDIR /home/theia\n\n# Apply node libs installed globally to the PATH\nENV PATH=${HOME}/.yarn/bin:${PATH}\n\n# setup extra stuff\nUSER root\nENV YARN_FLAGS=\"--offline\"\nENV NEXE_FLAGS=\"--target 'alpine-x64-14' --temp /tmp/nexe-cache\"\nCOPY asset-theia-endpoint-runtime-pre-assembly-nexe-cache-*.tar.gz asset-theia-endpoint-runtime-binary-yarn-*.tar.gz asset-node-src.tar.gz /tmp/\nRUN tar xzf /tmp/asset-theia-endpoint-runtime-binary-yarn-$(uname -m).tar.gz -C / && rm -f /tmp/asset-theia-endpoint-runtime-binary-yarn-*.tar.gz && \\\n    export NODE_VERSION=$(node --version | sed -s 's/v//') && mkdir -p \"/home/theia/.nexe/${NODE_VERSION}\" && \\\n    tar zxf /tmp/asset-node-src.tar.gz --strip-components=1 -C \"/home/theia/.nexe/${NODE_VERSION}\" && \\\n    rm -f /tmp/asset-node-src.tar.gz && \\\n    tar zxf /tmp/asset-theia-endpoint-runtime-pre-assembly-nexe-cache-$(uname -m).tar.gz -C \"/tmp/\" && \\\n    rm -f /tmp/asset-theia-endpoint-runtime-pre-assembly-nexe-cache-*.tar.gz\n\nRUN yum install -y git make cmake gcc gcc-c++ python2 automake autoconf which glibc-devel && \\\n    yum -y clean all && rm -rf /var/cache/yum && ln -s /usr/bin/python2 /usr/bin/python\n# setup nexe\n# install specific nexe\nCOPY asset-theia-endpoint-runtime-pre-assembly-nexe-*.tar.gz /tmp/\nRUN tar zxf /tmp/asset-theia-endpoint-runtime-pre-assembly-nexe-$(uname -m).tar.gz -C \"/tmp/\" && \\\n    rm -f /tmp/asset-theia-endpoint-runtime-pre-assembly-nexe-*.tar.gz\n# Change back to root folder\nWORKDIR /home/theia\n\nRUN /tmp/nexe/index.js -v && \\\n    # Build remote binary with node runtime 14.x and che-theia node dependencies. nexe icludes to the binary only\n    # necessary dependencies.\n    eval /tmp/nexe/index.js -i node_modules/@eclipse-che/theia-remote/lib/node/plugin-remote.js ${NEXE_FLAGS} -o ${HOME}/plugin-remote-endpoint\n\n# Light image without node. We include remote binary to this image.\n# https://access.redhat.com/containers/?tab=tags#/registry.access.redhat.com/ubi8-minimal\nFROM ubi8-minimal:8.6-854 as runtime\nUSER 0\nRUN microdnf -y install yum python38 python38-pyyaml jq && python3 --version && \\\n    yum -y -q update && \\\n    yum -y -q clean all && rm -rf /var/cache/yum && \\\n    echo \"Installed Packages\" && rpm -qa | sort -V && echo \"End Of Installed Packages\"\n# copy previously cached yq dependency wheels for offline install\nCOPY *.whl /tmp\n\nENV SUMMARY=\"Red Hat OpenShift Dev Spaces - theia-endpoint container\" \\\n    DESCRIPTION=\"Red Hat OpenShift Dev Spaces - theia-endpoint container\" \\\n    PRODNAME=\"devspaces\" \\\n    COMPNAME=\"theia-endpoint-rhel8\"\n\nLABEL summary=\"$SUMMARY\" \\\n      description=\"$DESCRIPTION\" \\\n      io.k8s.description=\"$DESCRIPTION\" \\\n      io.k8s.display-name=\"$DESCRIPTION\" \\\n      io.openshift.tags=\"$PRODNAME,$COMPNAME\" \\\n      com.redhat.component=\"$PRODNAME-$COMPNAME-container\" \\\n      name=\"$PRODNAME/$COMPNAME\" \\\n      version=\"3.2\" \\\n      license=\"EPLv2\" \\\n      maintainer=\"Nick Boldt <nboldt@redhat.com>\" \\\n      io.openshift.expose-services=\"\" \\\n      usage=\"\"\n\n# Setup extra stuff\n# install yq from local wheels we fetched earlier\nRUN pip3 --version && pip3 install --no-cache-dir /tmp/*.whl && yq --version && rm -fr /tmp/*.whl\n\nCOPY --from=builder /home/theia/plugin-remote-endpoint /plugin-remote-endpoint\n\nCOPY src/entrypoint.sh /entrypoint.sh\nENTRYPOINT [\"/entrypoint.sh\"]\n"
}