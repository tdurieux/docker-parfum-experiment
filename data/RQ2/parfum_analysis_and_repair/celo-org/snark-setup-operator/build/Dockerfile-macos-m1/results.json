{
  "startTime": 1674220620069,
  "endTime": 1674220621013,
  "originalSmells": [
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 4,
        "lineEnd": 4,
        "columnStart": 4,
        "columnEnd": 34
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 4,
        "lineEnd": 4,
        "columnStart": 4,
        "columnEnd": 34
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 4,
        "lineEnd": 4,
        "columnStart": 4,
        "columnEnd": 34
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "FROM rust:latest as cargo-build\n\nRUN apt-get update && apt-get install --no-install-recommends clang cmake -y && rm -rf /var/lib/apt/lists/*;\n\nRUN rustup install beta && rustup +beta target install aarch64-apple-darwin\n\nWORKDIR /usr/src/main\n\nCOPY Cargo.lock Cargo.lock\nCOPY Cargo.toml Cargo.toml\n\nRUN git clone https://github.com/tpoechtrager/osxcross && \\\n    cd osxcross && \\\n    wget -nc https://celoosxcross.blob.core.windows.net/sdk/MacOSX11.0.sdk.tar.bz2 && \\\n    mv MacOSX11.0.sdk.tar.bz2 tarballs/ && \\\n    UNATTENDED=yes OSX_VERSION_MIN=11.0 ./build.sh && \\\n    cd ..\n\nRUN mkdir src/\n\nRUN echo \"fn main() {println!(\\\"if you see this, the build cache was invalidated\\\")}\" > src/main.rs\n\nRUN PATH=\"$PWD/osxcross/target/bin:$PATH\" CC=\"$PWD/osxcross/target/bin/arm64-apple-darwin20.1-clang\" CXX=\"$PWD/osxcross/target/bin/arm64-apple-darwin20.1-clang++\" RUSTFLAGS=\"$RUSTFLAGS -C linker=$PWD/osxcross/target/bin/arm64-apple-darwin20.1-clang -C ar=$PWD/osxcross/target/bin/arm64-apple-darwin20.1-ar\" cargo +beta build --release --target=aarch64-apple-darwin\n\nRUN rm -f target/aarch64-apple-darwin/release/deps/snark-setup-operator*\n\nCOPY src ./src\nCOPY LICENSE .\nCOPY Cargo.lock .\nCOPY README.md .\n\nRUN mkdir out\nRUN PATH=\"$PWD/osxcross/target/bin:$PATH\" CC=\"$PWD/osxcross/target/bin/arm64-apple-darwin20.1-clang\" CXX=\"$PWD/osxcross/target/bin/arm64-apple-darwin20.1-clang++\" RUSTFLAGS=\"$RUSTFLAGS -C linker=$PWD/osxcross/target/bin/arm64-apple-darwin20.1-clang -C ar=$PWD/osxcross/target/bin/arm64-apple-darwin20.1-ar\" cargo +beta build --bin contribute --release --target aarch64-apple-darwin && cp target/aarch64-apple-darwin/release/contribute out/contribute-macos-m1\nRUN PATH=\"$PWD/osxcross/target/bin:$PATH\" CC=\"$PWD/osxcross/target/bin/arm64-apple-darwin20.1-clang\" CXX=\"$PWD/osxcross/target/bin/arm64-apple-darwin20.1-clang++\" RUSTFLAGS=\"$RUSTFLAGS -C linker=$PWD/osxcross/target/bin/arm64-apple-darwin20.1-clang -C ar=$PWD/osxcross/target/bin/arm64-apple-darwin20.1-ar\" cargo +beta build --bin generate --release --target aarch64-apple-darwin && cp target/aarch64-apple-darwin/release/generate out/generate-macos-m1\nRUN PATH=\"$PWD/osxcross/target/bin:$PATH\" CC=\"$PWD/osxcross/target/bin/arm64-apple-darwin20.1-clang\" CXX=\"$PWD/osxcross/target/bin/arm64-apple-darwin20.1-clang++\" RUSTFLAGS=\"$RUSTFLAGS -C linker=$PWD/osxcross/target/bin/arm64-apple-darwin20.1-clang -C ar=$PWD/osxcross/target/bin/arm64-apple-darwin20.1-ar\" cargo +beta build --bin contribute --release --target aarch64-apple-darwin --no-default-features && cp target/aarch64-apple-darwin/release/contribute out/contribute-macos-m1-noasm\nRUN PATH=\"$PWD/osxcross/target/bin:$PATH\" CC=\"$PWD/osxcross/target/bin/arm64-apple-darwin20.1-clang\" CXX=\"$PWD/osxcross/target/bin/arm64-apple-darwin20.1-clang++\" RUSTFLAGS=\"$RUSTFLAGS -C linker=$PWD/osxcross/target/bin/arm64-apple-darwin20.1-clang -C ar=$PWD/osxcross/target/bin/arm64-apple-darwin20.1-ar\" cargo +beta build --bin generate --release --target aarch64-apple-darwin --no-default-features && cp target/aarch64-apple-darwin/release/generate out/generate-macos-m1-noasm\n"
}