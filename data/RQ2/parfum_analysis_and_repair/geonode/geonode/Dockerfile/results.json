{
  "startTime": 1674254356986,
  "endTime": 1674254358093,
  "originalSmells": [
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 39,
        "lineEnd": 39,
        "columnStart": 4,
        "columnEnd": 22
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 40,
        "lineEnd": 40,
        "columnStart": 7,
        "columnEnd": 32
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 41,
        "lineEnd": 41,
        "columnStart": 7,
        "columnEnd": 67
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 45,
        "lineEnd": 45,
        "columnStart": 4,
        "columnEnd": 32
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 75,
        "lineEnd": 75,
        "columnStart": 4,
        "columnEnd": 31
      }
    },
    {
      "rule": "mkdirUsrSrcThenRemove",
      "position": {
        "lineStart": 3,
        "lineEnd": 3,
        "columnStart": 4,
        "columnEnd": 29
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 6,
        "lineEnd": 6,
        "columnStart": 25,
        "columnEnd": 59
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 19,
        "lineEnd": 22,
        "columnStart": 4,
        "columnEnd": 57
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 34,
        "lineEnd": 34,
        "columnStart": 4,
        "columnEnd": 83
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 44,
        "lineEnd": 44,
        "columnStart": 4,
        "columnEnd": 32
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 19,
        "lineEnd": 22,
        "columnStart": 4,
        "columnEnd": 57
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 24,
        "lineEnd": 32,
        "columnStart": 4,
        "columnEnd": 15
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 34,
        "lineEnd": 34,
        "columnStart": 4,
        "columnEnd": 83
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 44,
        "lineEnd": 44,
        "columnStart": 4,
        "columnEnd": 32
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 6,
        "lineEnd": 6,
        "columnStart": 25,
        "columnEnd": 59
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 19,
        "lineEnd": 22,
        "columnStart": 4,
        "columnEnd": 57
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 24,
        "lineEnd": 32,
        "columnStart": 4,
        "columnEnd": 15
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 34,
        "lineEnd": 34,
        "columnStart": 4,
        "columnEnd": 83
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 44,
        "lineEnd": 44,
        "columnStart": 4,
        "columnEnd": 32
      }
    }
  ],
  "repairedSmells": [
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 19,
        "lineEnd": 22,
        "columnStart": 4,
        "columnEnd": 57
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 24,
        "lineEnd": 32,
        "columnStart": 4,
        "columnEnd": 15
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 34,
        "lineEnd": 34,
        "columnStart": 4,
        "columnEnd": 107
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 44,
        "lineEnd": 44,
        "columnStart": 4,
        "columnEnd": 56
      }
    }
  ],
  "repairedDockerfile": "FROM python:3.10.2-buster\nLABEL GeoNode development team\n\nRUN mkdir -p /usr/src/geonode && rm -rf /usr/src/geonode\n\n# Enable postgresql-client-13\nRUN apt-get update -y && apt-get install --no-install-recommends curl wget unzip -y && rm -rf /var/lib/apt/lists/*;\nRUN echo \"deb http://apt.postgresql.org/pub/repos/apt/ buster-pgdg main\" | tee /etc/apt/sources.list.d/pgdg.list\nRUN echo \"deb http://deb.debian.org/debian/ stable main contrib non-free\" | tee /etc/apt/sources.list.d/debian.list\nRUN wget --quiet -O - https://www.postgresql.org/media/keys/ACCC4CF8.asc | apt-key add -\n\n# To get GDAL 3.2.1 to fix this issue https://github.com/OSGeo/gdal/issues/1692\n# TODO: The following line should be removed if base image upgraded to Bullseye\nRUN echo \"deb http://deb.debian.org/debian/ bullseye main contrib non-free\" | tee /etc/apt/sources.list.d/debian.list\n\n# This section is borrowed from the official Django image but adds GDAL and others\nRUN apt-get update -y && apt-get upgrade -y\n\n# Prepraing dependencies\nRUN apt-get install --no-install-recommends -y \\\n    libgdal-dev libpq-dev libxml2-dev \\\n    libxml2 libxslt1-dev zlib1g-dev libjpeg-dev \\\n    libmemcached-dev libldap2-dev libsasl2-dev libffi-dev && rm -rf /var/lib/apt/lists/*;\n\nRUN apt-get install -y --no-install-recommends \\\n    gcc zip gettext geoip-bin cron \\\n    postgresql-client-13 \\\n    sqlite3 spatialite-bin libsqlite3-mod-spatialite \\\n    python3-all-dev python3-dev \\\n    python3-gdal python3-psycopg2 python3-ldap \\\n    python3-pip python3-pil python3-lxml python3-pylibmc \\\n    uwsgi uwsgi-plugin-python3 \\\n    firefox-esr && rm -rf /var/lib/apt/lists/*;\n\nRUN apt-get install --no-install-recommends -y devscripts build-essential debhelper pkg-kde-tools sharutils && rm -rf /var/lib/apt/lists/*;\n# RUN git clone https://salsa.debian.org/debian-gis-team/proj.git /tmp/proj\n# RUN cd /tmp/proj && debuild -i -us -uc -b && dpkg -i ../*.deb\n\n# Install pip packages\nRUN pip3 install --no-cache-dir uwsgi \\\n    && pip install --no-cache-dir pip --upgrade \\\n    && pip install --no-cache-dir pygdal==$(gdal-config --version).* flower==0.9.4\n\n# Activate \"memcached\"\nRUN apt-get install --no-install-recommends -y memcached && rm -rf /var/lib/apt/lists/*;\nRUN pip install --no-cache-dir pylibmc sherlock\n\n# add bower and grunt command\nCOPY . /usr/src/geonode/\nWORKDIR /usr/src/geonode\n\nCOPY monitoring-cron /etc/cron.d/monitoring-cron\nRUN chmod 0644 /etc/cron.d/monitoring-cron\nRUN crontab /etc/cron.d/monitoring-cron\nRUN touch /var/log/cron.log\nRUN service cron start\n\nCOPY wait-for-databases.sh /usr/bin/wait-for-databases\nRUN chmod +x /usr/bin/wait-for-databases\nRUN chmod +x /usr/src/geonode/tasks.py \\\n    && chmod +x /usr/src/geonode/entrypoint.sh\n\nCOPY celery.sh /usr/bin/celery-commands\nRUN chmod +x /usr/bin/celery-commands\n\nCOPY celery-cmd /usr/bin/celery-cmd\nRUN chmod +x /usr/bin/celery-cmd\n\n# # Install \"geonode-contribs\" apps\n# RUN cd /usr/src; git clone https://github.com/GeoNode/geonode-contribs.git -b master\n# # Install logstash and centralized dashboard dependencies\n# RUN cd /usr/src/geonode-contribs/geonode-logstash; pip install --upgrade  -e . \\\n#     cd /usr/src/geonode-contribs/ldap; pip install --upgrade  -e .\n\nRUN pip install --upgrade --no-cache-dir  --src /usr/src -r requirements.txt\nRUN pip install --no-cache-dir --upgrade -e .\n\n# Cleanup apt update lists\nRUN rm -rf /var/lib/apt/lists/*\n\n# Export ports\nEXPOSE 8000\n\n# We provide no command or entrypoint as this image can be used to serve the django project or run celery tasks\n# ENTRYPOINT /usr/src/geonode/entrypoint.sh\n"
}