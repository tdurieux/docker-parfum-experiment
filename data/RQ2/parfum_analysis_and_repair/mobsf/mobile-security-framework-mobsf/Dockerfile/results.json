{
  "startTime": 1674251664870,
  "endTime": 1674251665781,
  "originalSmells": [
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 24,
        "lineEnd": 42,
        "columnStart": 21,
        "columnEnd": 21
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "# Base image\nFROM ubuntu:20.04\n\n# Labels and Credits\nLABEL \\\n    name=\"MobSF\" \\\n    author=\"Ajin Abraham <ajin25@gmail.com>\" \\\n    maintainer=\"Ajin Abraham <ajin25@gmail.com>\" \\\n    contributor_1=\"OscarAkaElvis <oscar.alfonso.diaz@gmail.com>\" \\\n    contributor_2=\"Vincent Nadal <vincent.nadal@orange.fr>\" \\\n    description=\"Mobile Security Framework (MobSF) is an automated, all-in-one mobile application (Android/iOS/Windows) pen-testing, malware analysis and security assessment framework capable of performing static and dynamic analysis.\"\n\n# Environment vars\nENV DEBIAN_FRONTEND=\"noninteractive\" \\\n    ANALYZER_IDENTIFIER=\"\" \\\n    JDK_FILE=\"openjdk-16.0.1_linux-x64_bin.tar.gz\" \\\n    JDK_FILE_ARM=\"openjdk-16.0.1_linux-aarch64_bin.tar.gz\" \\\n    WKH_FILE=\"wkhtmltox_0.12.6-1.focal_amd64.deb\" \\\n    WKH_FILE_ARM=\"wkhtmltox_0.12.6-1.focal_arm64.deb\" \\\n    JAVA_HOME=\"/jdk-16.0.1\"\n\nENV PATH=\"$JAVA_HOME/bin:$PATH\"\n\n# See https://docs.docker.com/develop/develop-images/dockerfile_best-practices/#run\nRUN apt update -y && apt install -y  --no-install-recommends \\\n    build-essential \\\n    locales \\\n    sqlite3 \\\n    fontconfig-config \\\n    libjpeg-turbo8 \\\n    libxrender1 \\\n    libfontconfig1 \\\n    libxext6 \\\n    fontconfig \\\n    xfonts-75dpi \\\n    xfonts-base \\\n    python3.9 \\\n    python3-dev \\\n    python3-pip \\\n    wget \\\n    curl \\\n    git \\\n    android-tools-adb && rm -rf /var/lib/apt/lists/*;\n\n# Set locales\nRUN locale-gen en_US.UTF-8\nENV LANG='en_US.UTF-8' LANGUAGE='en_US:en' LC_ALL='en_US.UTF-8'\n\n# Install wkhtmltopdf & OpenJDK\nARG TARGETPLATFORM\n\nCOPY scripts/install_java_wkhtmltopdf.sh .\nRUN ./install_java_wkhtmltopdf.sh\n\nRUN groupadd -g 9901 mobsf\nRUN adduser mobsf --shell /bin/false -u 9901 --ingroup mobsf --gecos \"\" --disabled-password\n\n\n# Install Requirements\nCOPY requirements.txt .\nRUN pip3 install --upgrade --no-cache-dir setuptools pip && \\\n    pip3 install --quiet --no-cache-dir -r requirements.txt\n\n# Cleanup\nRUN \\\n    apt remove -y \\\n        libssl-dev \\\n        libffi-dev \\\n        libxml2-dev \\\n        libxslt1-dev \\\n        python3-dev \\\n        wget && \\\n    apt clean && \\\n    apt autoclean && \\\n    apt autoremove -y && \\\n    rm -rf /var/lib/apt/lists/* /tmp/* > /dev/null 2>&1\n\nWORKDIR /home/mobsf/Mobile-Security-Framework-MobSF\n# Copy source code\nCOPY . .\n\n# Set adb binary path and apktool directory\nRUN sed -i \"s#ADB_BINARY = ''#ADB_BINARY = '/usr/bin/adb'#\" mobsf/MobSF/settings.py && \\\n    mkdir -p /home/mobsf/.local/share/apktool/framework\n\n# Postgres support is set to false by default\nARG POSTGRES=False\n\nENV POSTGRES_USER=postgres\nENV POSTGRES_PASSWORD=password\nENV POSTGRES_DB=mobsf\nENV POSTGRES_HOST=postgres\n\n# Check if Postgres support needs to be enabled\nRUN ./scripts/postgres_support.sh $POSTGRES\n\nHEALTHCHECK CMD curl --fail http://host.docker.internal:8000/ || exit 1\n\n# Expose MobSF Port and Proxy Port\nEXPOSE 8000 8000 1337 1337\n\nRUN chown -R mobsf:mobsf /home/mobsf/Mobile-Security-Framework-MobSF\nUSER mobsf\n# Run MobSF\nCMD [\"/home/mobsf/Mobile-Security-Framework-MobSF/scripts/entrypoint.sh\"]\n"
}