{
  "startTime": 1674248528291,
  "endTime": 1674248529200,
  "originalSmells": [
    {
      "rule": "yumInstallRmVarCacheYum",
      "position": {
        "lineStart": 35,
        "lineEnd": 35,
        "columnStart": 7,
        "columnEnd": 34
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "FROM quay.io/pypa/manylinux2010_x86_64 as builder\n\nENV PATH /root/.cargo/bin:$PATH\n\n# Use an explicit version to actually install the version we require instead of using the cache\n# It would be even cooler to invalidate the cache depending on when the official rust image changes,\n# but I don't know how to do that\nRUN curl --tlsv1.2 -sSf https://sh.rustup.rs | sh -s -- --default-toolchain 1.62.0 -y\n\n# Compile dependencies only for build caching\nADD Cargo.toml /maturin/Cargo.toml\nADD Cargo.lock /maturin/Cargo.lock\nRUN mkdir /maturin/src && \\\n    touch  /maturin/src/lib.rs && \\\n    echo 'fn main() { println!(\"Dummy\") }' > /maturin/src/main.rs && \\\n    cargo rustc --bin maturin --manifest-path /maturin/Cargo.toml --release -- -C link-arg=-s\n\nADD . /maturin/\n\n# Manually update the timestamps as ADD keeps the local timestamps and cargo would then believe the cache is fresh\nRUN touch /maturin/src/lib.rs /maturin/src/main.rs\n\nRUN cargo rustc --bin maturin --manifest-path /maturin/Cargo.toml --release --features password-storage -- -C link-arg=-s \\\n    && mv /maturin/target/release/maturin /usr/bin/maturin \\\n    && rm -rf /maturin\n\nFROM quay.io/pypa/manylinux2010_x86_64\n\nENV PATH /root/.cargo/bin:$PATH\n# Add all supported python versions\nENV PATH /opt/python/cp37-cp37m/bin:/opt/python/cp38-cp38/bin:/opt/python/cp39-cp39/bin:/opt/python/cp310-cp310/bin:$PATH\n# Otherwise `cargo new` errors\nENV USER root\n\nRUN curl --tlsv1.2 -sSf https://sh.rustup.rs | sh -s -- -y \\\n    && yum install -y libffi-devel \\\n    && python3.7 -m pip install --no-cache-dir cffi \\\n    && python3.8 -m pip install --no-cache-dir cffi \\\n    && python3.9 -m pip install --no-cache-dir cffi \\\n    && python3.10 -m pip install --no-cache-dir cffi \\\n    && mkdir /io && rm -rf /var/cache/yum\n\nCOPY --from=builder /usr/bin/maturin /usr/bin/maturin\n\nWORKDIR /io\n\nENTRYPOINT [\"/usr/bin/maturin\"]\n"
}