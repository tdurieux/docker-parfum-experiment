{
  "startTime": 1674252340464,
  "endTime": 1674252342108,
  "originalSmells": [
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 37,
        "lineEnd": 37,
        "columnStart": 22,
        "columnEnd": 55
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 37,
        "lineEnd": 37,
        "columnStart": 22,
        "columnEnd": 55
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "FROM registry.cern.ch/cmsweb/oracle:21_5 as oracle\n#FROM cmssw/oracle:21_1 as oracle\nFROM golang:latest as builder\nMAINTAINER Valentin Kuznetsov vkuznet@gmail.com\n\n# get oracle for our build\nCOPY --from=oracle /usr/lib/oracle /usr/lib/oracle\nENV LD_LIBRARY_PATH=/usr/lib/oracle\nENV PATH=$PATH:/usr/lib/oracle\nENV PKG_CONFIG_PATH=/usr/lib/oracle\n\n# update apt\n#RUN apt-get update && apt-get -y install unzip\n\n# start the setup\nENV WDIR=/data\nRUN mkdir -p $WDIR\nWORKDIR ${WDIR}\nADD oci8.pc $WDIR/oci8.pc\nENV PKG_CONFIG_PATH=$WDIR\n\n# build dbs2go with specific tag\nENV TAG=v00.05.05\nWORKDIR $GOPATH/src/github.com/vkuznet\nRUN git clone https://github.com/vkuznet/dbs2go\nWORKDIR $GOPATH/src/github.com/vkuznet/dbs2go\n\n# example how to checkout specific branch\n# RUN git checkout --track origin/api-struct && \\\nRUN git checkout tags/$TAG -b build && \\\n    sed -i -e \"s,_ \\\"gopkg.in/rana/ora.v4\\\",,g\" web/server.go && \\\n    sed -i -e \"s,_ \\\"github.com/mattn/go-sqlite3\\\",,g\" web/server.go && \\\n    sed -i -e \"s,_ \\\"github.com/go-sql-driver/mysql\\\",,g\" web/server.go && \\\n    make && cp -r dbs2go static $WDIR\n\n# for gibc library we will use debian:stretch\nFROM debian:stable-slim\nRUN apt-get update && apt-get -y --no-install-recommends install libaio1 procps && mkdir -p /data && rm -rf /var/lib/apt/lists/*;\nCOPY --from=builder /data /data\nCOPY --from=oracle /usr/lib/oracle /usr/lib/oracle\nENV LD_LIBRARY_PATH=/usr/lib/oracle\nENV PATH=$PATH:/usr/lib/oracle\nENV PKG_CONFIG_PATH=/usr/lib/oracle\n\n# remove shell from the image\nRUN apt-get -y --allow-remove-essential remove bash --purge\nRUN rm /bin/dash /bin/sh\n\n# run the service\nENV PATH=\"/data/gopath/bin:/data:${PATH}\"\nWORKDIR /data\n"
}