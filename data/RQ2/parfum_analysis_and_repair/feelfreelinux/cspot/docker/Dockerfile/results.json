{
  "startTime": 1674249860722,
  "endTime": 1674249862562,
  "originalSmells": [
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 4,
        "lineEnd": 7,
        "columnStart": 4,
        "columnEnd": 36
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "FROM ubuntu:focal AS builder\n\nRUN export DEBIAN_FRONTEND=noninteractive \\\n && apt-get update \\\n && apt-get install --no-install-recommends -y \\\n    git ca-certificates golang protobuf-compiler \\\n    libavahi-compat-libdnssd-dev libasound2-dev libasound2-plugins \\\n    cmake build-essential libssl-dev && rm -rf /var/lib/apt/lists/*;\n\nWORKDIR /src\n\nRUN git clone https://github.com/feelfreelinux/cspot.git cspot\n\nWORKDIR /src/cspot\n\nRUN git submodule update --init --recursive\n\nWORKDIR /src/cspot/targets/cli/build\n\n# cmake fix\nRUN sed -i 's/VERSION 3.18/VERSION 3.16/' ../CMakeLists.txt\nRUN cmake ..\nRUN make\n\nFROM ubuntu:focal\n\nWORKDIR /app\n\nCOPY --from=builder \\\n     /usr/lib/x86_64-linux-gnu/libcrypto.so.1.1 \\\n     /usr/lib/x86_64-linux-gnu/libasound.so.2 \\\n     /usr/lib/x86_64-linux-gnu/libdns_sd.so.1 \\\n     /usr/lib/x86_64-linux-gnu/libavahi-common.so.3 \\\n     /usr/lib/x86_64-linux-gnu/libavahi-client.so.3 \\\n     /usr/lib/x86_64-linux-gnu/libdbus-1.so.3 \\\n     /usr/lib/x86_64-linux-gnu/\nCOPY --from=builder /src/cspot/targets/cli/build/cspotcli .\n\nRUN export DEBIAN_FRONTEND=noninteractive \\\n && apt-get update \\\n && apt-get install --no-install-recommends -y \\\n    libasound2-plugins \\\n && rm -rf /var/lib/apt/lists/*\n\n# https://github.com/TheBiggerGuy/docker-pulseaudio-example/blob/master/Dockerfile\nENV UNAME cspot\n\nRUN export UNAME=$UNAME UID=1000 GID=1000 && \\\n    mkdir -p \"/home/${UNAME}\" && \\\n    echo \"${UNAME}:x:${UID}:${GID}:${UNAME} User,,,:/home/${UNAME}:/bin/bash\" >> /etc/passwd && \\\n    echo \"${UNAME}:x:${UID}:\" >> /etc/group && \\\n    mkdir -p /etc/sudoers.d && \\\n    echo \"${UNAME} ALL=(ALL) NOPASSWD: ALL\" > /etc/sudoers.d/${UNAME} && \\\n    chmod 0440 /etc/sudoers.d/${UNAME} && \\\n    chown ${UID}:${GID} -R /home/${UNAME} && \\\n    gpasswd -a ${UNAME} audio\n\nCOPY pulse-client.conf /etc/pulse/client.conf\n\nUSER $UNAME\nENV HOME /home/$UNAME\n\nCMD [\"/app/cspotcli\"]\n"
}