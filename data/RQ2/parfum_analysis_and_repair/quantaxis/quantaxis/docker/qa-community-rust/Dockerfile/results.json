{
  "startTime": 1674255290406,
  "endTime": 1674255291670,
  "originalSmells": [
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 12,
        "lineEnd": 12,
        "columnStart": 3,
        "columnEnd": 173
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 15,
        "lineEnd": 15,
        "columnStart": 3,
        "columnEnd": 44
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 16,
        "lineEnd": 16,
        "columnStart": 3,
        "columnEnd": 76
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 18,
        "lineEnd": 18,
        "columnStart": 3,
        "columnEnd": 56
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 18,
        "lineEnd": 18,
        "columnStart": 60,
        "columnEnd": 124
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 90,
        "lineEnd": 90,
        "columnStart": 4,
        "columnEnd": 66
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 92,
        "lineEnd": 92,
        "columnStart": 7,
        "columnEnd": 94
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 94,
        "lineEnd": 94,
        "columnStart": 7,
        "columnEnd": 55
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 102,
        "lineEnd": 102,
        "columnStart": 4,
        "columnEnd": 29
      }
    },
    {
      "rule": "sha256sumEchoOneSpaces",
      "position": {
        "lineStart": 44,
        "lineEnd": 44,
        "columnStart": 4,
        "columnEnd": 57
      }
    },
    {
      "rule": "tarSomethingRmTheSomething",
      "position": {
        "lineStart": 29,
        "lineEnd": 29,
        "columnStart": 3,
        "columnEnd": 53
      }
    },
    {
      "rule": "tarSomethingRmTheSomething",
      "position": {
        "lineStart": 73,
        "lineEnd": 73,
        "columnStart": 4,
        "columnEnd": 41
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 31,
        "lineEnd": 31,
        "columnStart": 4,
        "columnEnd": 60
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 31,
        "lineEnd": 31,
        "columnStart": 65,
        "columnEnd": 105
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 65,
        "lineEnd": 65,
        "columnStart": 4,
        "columnEnd": 64
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 66,
        "lineEnd": 66,
        "columnStart": 4,
        "columnEnd": 52
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 96,
        "lineEnd": 96,
        "columnStart": 22,
        "columnEnd": 105
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 100,
        "lineEnd": 100,
        "columnStart": 4,
        "columnEnd": 44
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 31,
        "lineEnd": 31,
        "columnStart": 4,
        "columnEnd": 60
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 31,
        "lineEnd": 31,
        "columnStart": 65,
        "columnEnd": 105
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 100,
        "lineEnd": 100,
        "columnStart": 4,
        "columnEnd": 44
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 31,
        "lineEnd": 31,
        "columnStart": 4,
        "columnEnd": 60
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 31,
        "lineEnd": 31,
        "columnStart": 65,
        "columnEnd": 105
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 65,
        "lineEnd": 65,
        "columnStart": 4,
        "columnEnd": 64
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 66,
        "lineEnd": 66,
        "columnStart": 4,
        "columnEnd": 52
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 96,
        "lineEnd": 96,
        "columnStart": 22,
        "columnEnd": 105
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 100,
        "lineEnd": 100,
        "columnStart": 4,
        "columnEnd": 44
      }
    }
  ],
  "repairedSmells": [
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 31,
        "lineEnd": 31,
        "columnStart": 4,
        "columnEnd": 83
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 31,
        "lineEnd": 31,
        "columnStart": 87,
        "columnEnd": 151
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 100,
        "lineEnd": 100,
        "columnStart": 4,
        "columnEnd": 68
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 66,
        "lineEnd": 66,
        "columnStart": 4,
        "columnEnd": 76
      }
    }
  ],
  "repairedDockerfile": "FROM ghcr.io/yutiansut/quantaxis/qa-jupyer:latest\nUSER root\nENV TZ=Asia/Shanghai\nENV DEBIAN_FRONTEND noninteractive\n\nADD VUWHL /VUWHL/\nCOPY daily_update /etc/cron.d/daily_update\nCOPY run-community.sh /root/\nCOPY runcelery.sh /root/\nCOPY wait_for_it.sh /root/\n\nRUN cd /root && git clone https://gitee.com/yutiansut/qamazing_community && cd qamazing_community \\\n&& pip install --no-cache-dir quantaxis-servicedetect quantaxis-pubsub quantaxis quantaxis_webserver quantaxis_run qifimanager qavifiserver eventlet -U -i https://pypi.doubanio.com/simple \\\n&& pip uninstall pytdx -y \\\n&& cd /VUWHL/ \\\n&& pip install --no-cache-dir pytdx-1.72r2-py3-none-any.whl \\\n&& pip install --no-cache-dir qifiaccount QAStrategy -U -i https://pypi.doubanio.com/simple \\\n&& cd /root/qamazing_community/ \\\n&& pip install --no-cache-dir qgrid -i https://pypi.doubanio.com/simple && pip install --no-cache-dir \"dask[complete]\" -i https://pypi.doubanio.com/simple\n\n\nENV RUSTUP_HOME=/usr/local/rustup \\\n    CARGO_HOME=/usr/local/cargo \\\n    PATH=/usr/local/cargo/bin:$PATH \\\n    RUST_VERSION=1.55.0\n    #https://cmake.org/files/v3.19/cmake-3.19.0-Linux-x86_64.tar.gz\nARG CMAKE_VERSION=3.19.0\nWORKDIR /tmp\nRUN wget https://github.com/Kitware/CMake/releases/download/v${CMAKE_VERSION}/cmake-${CMAKE_VERSION}-Linux-x86_64.tar.gz \\\n&& tar xzf cmake-${CMAKE_VERSION}-Linux-x86_64.tar.gz \\\n&& mv cmake-${CMAKE_VERSION}-Linux-x86_64 /usr/local/cmake && rm cmake-${CMAKE_VERSION}-Linux-x86_64.tar.gz\nRUN apt-get install --no-install-recommends -y --allow-downgrades zlib1g pkg-config && apt-get install --no-install-recommends pkg-config libssl-dev -y && rm -rf /var/lib/apt/lists/*;\n\nRUN set -eux; \\\n    dpkgArch=\"$(dpkg --print-architecture)\"; \\\n    case \"${dpkgArch##*-}\" in \\\n        amd64) rustArch='x86_64-unknown-linux-gnu'; rustupSha256='49c96f3f74be82f4752b8bffcf81961dea5e6e94ce1ccba94435f12e871c3bdb' ;; \\\n        armhf) rustArch='armv7-unknown-linux-gnueabihf'; rustupSha256='5a2be2919319e8778698fa9998002d1ec720efe7cb4f6ee4affb006b5e73f1be' ;; \\\n        arm64) rustArch='aarch64-unknown-linux-gnu'; rustupSha256='d93ef6f91dab8299f46eef26a56c2d97c66271cea60bf004f2f088a86a697078' ;; \\\n        i386) rustArch='i686-unknown-linux-gnu'; rustupSha256='e3d0ae3cfce5c6941f74fed61ca83e53d4cd2deb431b906cbd0687f246efede4' ;; \\\n        *) echo >&2 \"unsupported architecture: ${dpkgArch}\"; exit 1 ;; \\\n    esac; \\\n    url=\"https://static.rust-lang.org/rustup/archive/1.22.1/${rustArch}/rustup-init\"; \\\n    wget \"$url\"; \\\n    echo \"${rustupSha256}  *rustup-init\" | sha256sum -c -; \\\n    chmod +x rustup-init; \\\n    ./rustup-init -y --no-modify-path --profile minimal --default-toolchain $RUST_VERSION --default-host ${rustArch}; \\\n    rm rustup-init; \\\n    chmod -R a+w $RUSTUP_HOME $CARGO_HOME; \\\n    rustup --version; \\\n    cargo --version; \\\n    rustc --version;\n\n\nENV GOPATH=/root/go\nENV PATH=${GOPATH}/bin:/usr/lib/go-1.15/bin:/usr/local/cmake/bin:${PATH}\nENV PKG_CONFIG_PATH = /usr/local/lib/pkgconfig\nENV LD_LIBRARY_PATH=:${LD_LIBRARY_PATH}:/usr/local/bin:/usr/local/lib\nENV GO111MODULE=on\n#\nCOPY ./config  /root/.cargo/\nCOPY ./update_all.py  /root/QUANTAXIS/config/\nRUN set -eux; \\\n    wget https://mirrors.ustc.edu.cn/golang/go1.15.6.linux-amd64.tar.gz; \\\n    apt update --fix-missing; \\\n    apt install --no-install-recommends -y build-essential libzmq3-dev pkg-config cmake; rm -rf /var/lib/apt/lists/*; \\\n    apt-get install --no-install-recommends -y cron --allow-unauthenticated; \\\n\tchmod 0644 /etc/cron.d/daily_update ; \\\n\tchmod +x /root/QUANTAXIS/config/update_all.py; \\\n\tcrontab /etc/cron.d/daily_update; \\\n    echo \"set nocp\" >> ~/.vimrc && echo \"set paste\" >> ~/.vimrc &&  /bin/bash -c \"source ~/.vimrc\"; \\\n    chmod +x /root/run-community.sh; \\\n    chmod +x /root/runcelery.sh && chmod +x /root/wait_for_it.sh; \\\n    tar xvf go1.15.6.linux-amd64.tar.gz ; rm go1.15.6.linux-amd64.tar.gz \\\n    chown -R root:root ./go ; \\\n    mv go /usr/lib/go-1.15; \\\n    go env -w GOPROXY=https://goproxy.cn; \\\n    go get -u github.com/gopherdata/gophernotes; \\\n    cp /root/go/bin/gophernotes /usr/local/bin/ ; \\\n    mkdir -p /root/.local/share/jupyter/kernels/gophernotes ; \\\n    cd /root/.local/share/jupyter/kernels/gophernotes; \\\n    wget https://raw.githubusercontent.com/gopherdata/gophernotes/master/kernel/kernel.json ; \\\n    wget https://raw.githubusercontent.com/gopherdata/gophernotes/master/kernel/logo-32x32.png ; \\\n    wget https://raw.githubusercontent.com/gopherdata/gophernotes/master/kernel/logo-64x64.png ; \\\n    cargo install evcxr_jupyter --force; \\\n    evcxr_jupyter --install;\n    ## clean\n## run build for tensorflow 2\nENV GOPROXY=https://goproxy.io\nRUN conda install --yes tensorflow\nRUN pip install --no-cache-dir tornado==5.1.1 -i https://pypi.doubanio.com/simple \\\n    && conda install --yes keras \\\n    && pip install --no-cache-dir QAStrategy quantaxis_run qifiaccount -U -i https://pypi.doubanio.com/simple \\\n    && cd /VUWHL/ \\\n    && pip install --no-cache-dir quantaxis-1.10.19r1-py3-none-any.whl\n\nRUN apt-get update && apt-get -y --no-install-recommends install libcurl4-openssl-dev libssl-dev build-essential net-tools htop \\\n    && cd /root/ && wget https://github.com/QUANTAXIS/QUANTAXIS/releases/download/1.10.2/portfoliohandler \\\n    && chmod +777 /root/portfoliohandler && rm -rf /var/lib/apt/lists/*;\n\nRUN apt install --no-install-recommends -y gcc git tini iputils-ping && \\\n    mkdir /root/.prefect/ && \\\n    pip install --no-cache-dir \"pip==20.2.4\" && \\\n    pip install --no-cache-dir prefect && rm -rf /var/lib/apt/lists/*;\nENV LC_ALL C.UTF-8\nENV LANG C.UTF-8\n\n\nWORKDIR /root\nEXPOSE 80 8010 8787 8020 8029 8018 8019 8028 8080\nCOPY entrypoint.sh /usr/local/bin/entrypoint.sh\nCMD [\"/bin/bash\", \"/root/run-community.sh\"]\n"
}