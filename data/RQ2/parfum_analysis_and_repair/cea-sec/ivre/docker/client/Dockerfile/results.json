{
  "startTime": 1674218660226,
  "endTime": 1674218661326,
  "originalSmells": [
    {
      "rule": "configureShouldUseBuildFlag",
      "position": {
        "lineStart": 41,
        "lineEnd": 43,
        "columnStart": 4,
        "columnEnd": 39
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "# This file is part of IVRE.\n# Copyright 2011 - 2022 Pierre LALET <pierre@droids-corp.org>\n#\n# IVRE is free software: you can redistribute it and/or modify it\n# under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# IVRE is distributed in the hope that it will be useful, but WITHOUT\n# ANY WARRANTY; without even the implied warranty of MERCHANTABILITY\n# or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public\n# License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with IVRE. If not, see <http://www.gnu.org/licenses/>.\n\nARG TAG=latest\nFROM ivre/base:${TAG}\nLABEL maintainer=\"Pierre LALET <pierre@droids-corp.org>\"\n\n# Tools\n## non-free: s3270\nRUN sed -i 's/ main/ main non-free/' /etc/apt/sources.list\n## openssl: IVRE depends on openssl exec + libssl needed for Nmap\n## libfreetype6 libfontconfig1 fonts-dejavu: screenshots w/ phantomjs\nRUN apt-get -q update && \\\n    apt-get -qy --no-install-recommends install rsync screen ipython3 openssl \\\n        tesseract-ocr libfreetype6 libfontconfig1 fonts-dejavu imagemagick \\\n        ffmpeg s3270 patch bash-completion bzip2 python3-pil nfdump && \\\n    apt-get clean && rm -rf /var/lib/apt/lists/*\n\n# Install Nmap. Use included libpcap as a workaround for Nmap issue\n# #34 (https://github.com/nmap/nmap/issues/34) since we do not know\n# which kernel version will be used\n# ADD https://github.com/nmap/nmap/tarball/master ./nmap.tar.gz\nADD https://nmap.org/dist/nmap-7.92.tgz ./nmap.tar.gz\nRUN apt-get -q update && \\\n    apt-get -qy --no-install-recommends install build-essential libssl-dev flex bison && \\\n    tar zxf nmap.tar.gz && \\\n    mv nmap-* nmap && \\\n    cd nmap && \\\n    ./configure --build=\"$(dpkg-architecture --query DEB_BUILD_GNU_TYPE)\" --without-ndiff --without-zenmap --without-nping \\\n                --without-ncat --without-nmap-update \\\n                --with-libpcap=included && \\\n    make && make install && \\\n    cd ../ && rm -rf nmap nmap.tar.gz && \\\n    apt-get -qy --purge autoremove build-essential libssl-dev flex bison && \\\n    apt-get clean && rm -rf /var/lib/apt/lists/*\n\n# Install Zeek\nRUN apt-get -q update && \\\n    apt-get -qy --no-install-recommends install gnupg wget && \\\n    echo 'deb http://download.opensuse.org/repositories/security:/zeek/Debian_11/ /' > /etc/apt/sources.list.d/zeek.list && \\\n    wget -qO - https://download.opensuse.org/repositories/security:zeek/Debian_11/Release.key | apt-key add - && \\\n    apt-get -q update && apt-get -qy --no-install-recommends install zeek && \\\n    apt-get -qy --purge autoremove gnupg wget && \\\n    apt-get clean && rm -rf /var/lib/apt/lists/*\n\n# Install p0f\nRUN apt-get -q update && \\\n    apt-get -qy --no-install-recommends install p0f && \\\n    apt-get clean && rm -rf /var/lib/apt/lists/*\n\n# \"Install\" phantomjs for our http-screenshot NSE script replacement\nADD https://bitbucket.org/ariya/phantomjs/downloads/phantomjs-1.9.8-linux-x86_64.tar.bz2 ./phantomjs-1.9.8-linux-x86_64.tar.bz2\nRUN tar jxf phantomjs-1.9.8-linux-x86_64.tar.bz2 phantomjs-1.9.8-linux-x86_64/bin/phantomjs && \\\n    mv phantomjs-1.9.8-linux-x86_64/bin/phantomjs /usr/local/bin/ && \\\n    rm -rf phantomjs-1.9.8-linux-x86_64*\n\n# Add our *-screenshot NSE scripts\nRUN for d in /usr /usr/local; do \\\n        d=\"$d/share/ivre/patches\"; \\\n        [ -d \"$d\" ] && ( \\\n            cp $d/nmap/scripts/*.nse /usr/local/share/nmap/scripts; \\\n            cd /usr/local/share/nmap/; \\\n            for p in $d/nmap/*.patch; do \\\n                 patch -p0 < $p; \\\n            done ; \\\n            patch /etc/p0f/p0f.fp $d/p0f/p0f.fp.patch \\\n        ) \\\n    done; true\nRUN nmap --script-update\n\nRUN mkdir /var/lib/ivre\n"
}