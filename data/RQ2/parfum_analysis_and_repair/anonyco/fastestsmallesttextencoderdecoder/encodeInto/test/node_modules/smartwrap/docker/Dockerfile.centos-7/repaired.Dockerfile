FROM centos:7

RUN yum install -y epel-release && rm -rf /var/cache/yum

# Install bzip2
RUN yum install -y bzip2 && rm -rf /var/cache/yum

RUN yum install -y git && rm -rf /var/cache/yum

# Install nodejs 11
RUN curl -f -sL https://rpm.nodesource.com/setup_11.x | bash -
RUN yum install -y nodejs && rm -rf /var/cache/yum

# RUN ln -s /usr/bin/nodejs /usr/bin/node

# Install smartwrap
RUN git clone --branch master https://www.github.com/tecfu/smartwrap

# Install grunt
RUN npm install grunt-cli -g && npm cache clean --force;

# Install dev dependencies
WORKDIR /smartwrap
RUN npm install && npm cache clean --force;

# Run unit tests
RUN node -v
RUN npm test
