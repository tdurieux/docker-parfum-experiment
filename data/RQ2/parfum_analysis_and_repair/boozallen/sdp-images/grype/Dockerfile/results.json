{
  "startTime": 1674254437593,
  "endTime": 1674254438776,
  "originalSmells": [
    {
      "rule": "yumInstallRmVarCacheYum",
      "position": {
        "lineStart": 28,
        "lineEnd": 28,
        "columnStart": 2,
        "columnEnd": 108
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "# Copyright Â© 2022 Booz Allen Hamilton. All Rights Reserved.\n# This software package is licensed under the Booz Allen Public License. The license can be found in the License file or at http://boozallen.github.io/licenses/bapl\n\nARG BASE_REGISTRY=registry.access.redhat.com\nARG BASE_IMAGE=ubi8/ubi\nARG BASE_TAG=8.4\nFROM ${BASE_REGISTRY}/${BASE_IMAGE}:${BASE_TAG}\n\n### Required Atomic/OpenShift Labels - https://github.com/projectatomic/ContainerApplicationGenericLabels\nLABEL name=\"Solutions Delivery Platform: Grype\" \\\n      maintainer=\"uip@bah.com\" \\\n      vendor=\"Booz Allen Hamilton\" \\\n      version=\"0.38.0\" \\\n      release=\"0.38.0\" \\\n      summary=\"Anchore Grype container\" \\\n      description=\"The Anchore Grype container image for the Solutions Delivery Platform\"\n\n### add licenses to this directory\nCOPY LICENSE /licenses\n\n### Use yum as root user\nUSER root\n\n### Install packages\nRUN INSTALL_PKGS=\"coreutils python3-pip jq\" && \\\n  yum clean all &&\\\n  yum --disableplugin=subscription-manager -y update-minimal --setopt=tsflags=nodocs \\\n  --security && \\\n  yum --disableplugin=subscription-manager -y install --allowerasing --setopt=tsflags=nodocs ${INSTALL_PKGS} && rm -rf /var/cache/yum\n\n### Install yq\nRUN python3 -m pip install --user yq\n\nENV PROGRAM_NAME grype\nENV PROGRAM_VERSION v0.38.0\nENV HOME /root\nENV PROGRAM_DESTINATION_DIR /usr/local/bin\n\nARG user=${PROGRAM_NAME}\n\nWORKDIR /scanner\n\n# Install Grype\nRUN curl -sSfL https://raw.githubusercontent.com/anchore/grype/main/install.sh | sh -s -- -b ${PROGRAM_DESTINATION_DIR} ${PROGRAM_VERSION}\n\n# Add user, create required directories and cleanup\nRUN useradd -ms /bin/bash ${user}                                                                              && \\\n  chown -R ${user}:${user} ${PROGRAM_DESTINATION_DIR}/${PROGRAM_NAME}                                         && \\\n  mkdir /report                                                                                              && \\\n  chown -R ${user}:${user} /report                                                                           && \\\n  yum --nogpgcheck --disableplugin=subscription-manager clean all\n\n### Insert container entrypoint script\nCOPY container-entrypoint.sh /usr/local/bin/container-entrypoint.sh\n\n### Set script as executable\nRUN chmod +x /usr/local/bin/container-entrypoint.sh\n\nUSER ${user}\n\nCMD []\nENTRYPOINT [ \"/bin/sh\", \"/usr/local/bin/container-entrypoint.sh\" ]\n"
}