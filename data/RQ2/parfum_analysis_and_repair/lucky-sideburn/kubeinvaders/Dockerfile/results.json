{
  "startTime": 1674246363315,
  "endTime": 1674246364121,
  "originalSmells": [
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 3,
        "lineEnd": 3,
        "columnStart": 4,
        "columnEnd": 176
      }
    },
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 3,
        "lineEnd": 3,
        "columnStart": 74,
        "columnEnd": 150
      }
    },
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 20,
        "lineEnd": 20,
        "columnStart": 4,
        "columnEnd": 103
      }
    },
    {
      "rule": "tarSomethingRmTheSomething",
      "position": {
        "lineStart": 21,
        "lineEnd": 21,
        "columnStart": 4,
        "columnEnd": 37
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 13,
        "lineEnd": 13,
        "columnStart": 4,
        "columnEnd": 80
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 35,
        "lineEnd": 35,
        "columnStart": 4,
        "columnEnd": 28
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 9,
        "lineEnd": 9,
        "columnStart": 4,
        "columnEnd": 100
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 13,
        "lineEnd": 13,
        "columnStart": 4,
        "columnEnd": 80
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 35,
        "lineEnd": 35,
        "columnStart": 4,
        "columnEnd": 28
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 9,
        "lineEnd": 9,
        "columnStart": 4,
        "columnEnd": 100
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 13,
        "lineEnd": 13,
        "columnStart": 4,
        "columnEnd": 80
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 35,
        "lineEnd": 35,
        "columnStart": 4,
        "columnEnd": 28
      }
    }
  ],
  "repairedSmells": [
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 9,
        "lineEnd": 9,
        "columnStart": 4,
        "columnEnd": 100
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 13,
        "lineEnd": 13,
        "columnStart": 4,
        "columnEnd": 104
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 35,
        "lineEnd": 35,
        "columnStart": 4,
        "columnEnd": 52
      }
    }
  ],
  "repairedDockerfile": "FROM  nginx\n\n# Install kubectl\nRUN curl -f -LO \"https://storage.googleapis.com/kubernetes-release/release/$( curl -f -s https://storage.googleapis.com/kubernetes-release/release/stable.txt)/bin/linux/amd64/kubectl\"\nRUN chmod +x ./kubectl\nRUN mv ./kubectl /usr/local/bin/kubectl\n\n# Install Openresty\nRUN apt-get update\nRUN apt-get -y install --no-install-recommends wget gnupg ca-certificates jq openssl task-spooler at && rm -rf /var/lib/apt/lists/*;\nRUN wget -O - https://openresty.org/package/pubkey.gpg | apt-key add -\nRUN codename=`grep -Po 'VERSION=\"[0-9]+ \\(\\K[^)]+' /etc/os-release` && echo \"deb http://openresty.org/package/debian $codename openresty\" | tee /etc/apt/sources.list.d/openresty.list\nRUN apt-get update\nRUN apt-get -y --no-install-recommends install openresty luarocks libssl-dev git vim lua-json lua-socket && rm -rf /var/lib/apt/lists/*;\nRUN apt-get update --fix-missing\nRUN chmod 777 /usr/local/openresty/nginx\nRUN luarocks install luasec\nRUN luarocks install lunajson\n\n# Install kube-linter\nRUN curl -f -L -O https://github.com/stackrox/kube-linter/releases/download/0.2.4/kube-linter-linux.tar.gz\nRUN tar -xvf kube-linter-linux.tar.gz && rm kube-linter-linux.tar.gz\nRUN rm -f kube-linter-linux.tar.gz\nRUN cp  kube-linter /usr/local/bin/\nRUN chmod 775 /usr/local/bin/kube-linter\nRUN mkdir /tmp/kube-linter-pods\nRUN chmod 777 /tmp/kube-linter-pods\n\nCOPY kube-linter/kube-linter-parser.sh /opt/kube-linter-parser.sh\nRUN chmod +x /opt/kube-linter-parser.sh\n\n# Install game part\nCOPY html5/ /var/www/html\n\n# Install Redis\nRUN apt-get install --no-install-recommends redis -y && rm -rf /var/lib/apt/lists/*;\nCOPY redis/redis.conf /etc/redis/redis.conf\n\n# Configure Nginx\nRUN sed -i.bak 's/listen\\(.*\\)80;/listen 8081;/' /etc/nginx/conf.d/default.conf\nRUN mkdir /usr/local/openresty/nginx/conf/kubeinvaders\n\nCOPY nginx/nginx.conf /etc/nginx/nginx.conf\n\nCOPY scripts/metrics.lua /usr/local/openresty/nginx/conf/kubeinvaders/metrics.lua\nCOPY scripts/pod.lua /usr/local/openresty/nginx/conf/kubeinvaders/pod.lua\nCOPY scripts/node.lua /usr/local/openresty/nginx/conf/kubeinvaders/node.lua\nCOPY scripts/kube-linter.lua /usr/local/openresty/nginx/conf/kubeinvaders/kube-linter.lua\nCOPY scripts/chaos-node.lua /usr/local/openresty/nginx/conf/kubeinvaders/chaos-node.lua\nCOPY scripts/chaos-containers.lua /usr/local/openresty/nginx/conf/kubeinvaders/chaos-containers.lua\nCOPY scripts/config_kubeinv.lua /usr/local/openresty/lualib/config_kubeinv.lua\nCOPY nginx/KubeInvaders.conf /etc/nginx/conf.d/KubeInvaders.conf\nRUN chmod g+rwx /var/cache/nginx /var/run /var/log/nginx /var/www/html /etc/nginx/conf.d\n\nEXPOSE 8080\n\nENV PATH=/usr/local/openresty/nginx/sbin:$PATH\nCOPY ./entrypoint.sh /\nRUN chmod a+rwx ./entrypoint.sh\nENTRYPOINT [\"/entrypoint.sh\"]\n"
}