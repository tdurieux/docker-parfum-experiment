{
  "startTime": 1674217597717,
  "endTime": 1674217599583,
  "originalSmells": [
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 3,
        "lineEnd": 3,
        "columnStart": 22,
        "columnEnd": 132
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 3,
        "lineEnd": 3,
        "columnStart": 22,
        "columnEnd": 132
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "FROM golang:1.17.9-buster AS builder-deps\nMAINTAINER Lotus Development Team\n\nRUN apt-get update && apt-get install --no-install-recommends -y ca-certificates build-essential clang ocl-icd-opencl-dev ocl-icd-libopencl1 jq libhwloc-dev && rm -rf /var/lib/apt/lists/*;\n\nARG RUST_VERSION=nightly\nENV XDG_CACHE_HOME=\"/tmp\"\n\nENV RUSTUP_HOME=/usr/local/rustup \\\n    CARGO_HOME=/usr/local/cargo \\\n    PATH=/usr/local/cargo/bin:$PATH\n\nRUN wget \"https://static.rust-lang.org/rustup/dist/x86_64-unknown-linux-gnu/rustup-init\"; \\\n    chmod +x rustup-init; \\\n    ./rustup-init -y --no-modify-path --profile minimal --default-toolchain $RUST_VERSION; \\\n    rm rustup-init; \\\n    chmod -R a+w $RUSTUP_HOME $CARGO_HOME; \\\n    rustup --version; \\\n    cargo --version; \\\n    rustc --version;\n\n\nFROM builder-deps AS builder-local\nMAINTAINER Lotus Development Team\n\nCOPY ./ /opt/filecoin\nWORKDIR /opt/filecoin\nRUN make clean deps\n\n\nFROM builder-local AS builder-test\nMAINTAINER Lotus Development Team\n\nWORKDIR /opt/filecoin\n\nRUN make debug\n\n\nFROM builder-local AS builder\nMAINTAINER Lotus Development Team\n\nWORKDIR /opt/filecoin\n\nARG RUSTFLAGS=\"\"\nARG GOFLAGS=\"\"\n\nRUN make lotus lotus-miner lotus-worker lotus-shed lotus-wallet lotus-gateway lotus-stats\n\n\nFROM ubuntu:20.04 AS base\nMAINTAINER Lotus Development Team\n\n# Base resources\nCOPY --from=builder /etc/ssl/certs                           /etc/ssl/certs\nCOPY --from=builder /lib/x86_64-linux-gnu/libdl.so.2         /lib/\nCOPY --from=builder /lib/x86_64-linux-gnu/librt.so.1         /lib/\nCOPY --from=builder /lib/x86_64-linux-gnu/libgcc_s.so.1      /lib/\nCOPY --from=builder /lib/x86_64-linux-gnu/libutil.so.1       /lib/\nCOPY --from=builder /usr/lib/x86_64-linux-gnu/libltdl.so.7   /lib/\nCOPY --from=builder /usr/lib/x86_64-linux-gnu/libnuma.so.1   /lib/\nCOPY --from=builder /usr/lib/x86_64-linux-gnu/libhwloc.so.5  /lib/\nCOPY --from=builder /usr/lib/x86_64-linux-gnu/libOpenCL.so.1 /lib/\n\nRUN useradd -r -u 532 -U fc \\\n && mkdir -p /etc/OpenCL/vendors \\\n && echo \"libnvidia-opencl.so.1\" > /etc/OpenCL/vendors/nvidia.icd\n\n###\nFROM base AS lotus\nMAINTAINER Lotus Development Team\n\nCOPY --from=builder /opt/filecoin/lotus /usr/local/bin/\nCOPY --from=builder /opt/filecoin/lotus-shed /usr/local/bin/\nCOPY scripts/docker-lotus-entrypoint.sh /\n\nENV FILECOIN_PARAMETER_CACHE /var/tmp/filecoin-proof-parameters\nENV LOTUS_PATH /var/lib/lotus\nENV DOCKER_LOTUS_IMPORT_SNAPSHOT https://fil-chain-snapshots-fallback.s3.amazonaws.com/mainnet/minimal_finality_stateroots_latest.car\nENV DOCKER_LOTUS_IMPORT_WALLET \"\"\n\nRUN mkdir /var/lib/lotus /var/tmp/filecoin-proof-parameters\nRUN chown fc: /var/lib/lotus /var/tmp/filecoin-proof-parameters\n\nVOLUME /var/lib/lotus\nVOLUME /var/tmp/filecoin-proof-parameters\n\nUSER fc\n\nEXPOSE 1234\n\nENTRYPOINT [\"/docker-lotus-entrypoint.sh\"]\n\nCMD [\"-help\"]\n\n###\nFROM base AS lotus-wallet\nMAINTAINER Lotus Development Team\n\nCOPY --from=builder /opt/filecoin/lotus-wallet /usr/local/bin/\n\nENV WALLET_PATH /var/lib/lotus-wallet\n\nRUN mkdir /var/lib/lotus-wallet\nRUN chown fc: /var/lib/lotus-wallet\n\nVOLUME /var/lib/lotus-wallet\n\nUSER fc\n\nEXPOSE 1777\n\nENTRYPOINT [\"/usr/local/bin/lotus-wallet\"]\n\nCMD [\"-help\"]\n\n###\nFROM base AS lotus-gateway\nMAINTAINER Lotus Development Team\n\nCOPY --from=builder /opt/filecoin/lotus-gateway /usr/local/bin/\n\nUSER fc\n\nEXPOSE 1234\n\nENTRYPOINT [\"/usr/local/bin/lotus-gateway\"]\n\nCMD [\"-help\"]\n\n\n###\nFROM base AS lotus-miner\nMAINTAINER Lotus Development Team\n\nCOPY --from=builder /opt/filecoin/lotus-miner /usr/local/bin/\nCOPY scripts/docker-lotus-miner-entrypoint.sh /\n\nENV FILECOIN_PARAMETER_CACHE /var/tmp/filecoin-proof-parameters\nENV LOTUS_MINER_PATH /var/lib/lotus-miner\n\nRUN mkdir /var/lib/lotus-miner /var/tmp/filecoin-proof-parameters\nRUN chown fc: /var/lib/lotus-miner /var/tmp/filecoin-proof-parameters\n\nVOLUME /var/lib/lotus-miner\nVOLUME /var/tmp/filecoin-proof-parameters\n\nUSER fc\n\nEXPOSE 2345\n\nENTRYPOINT [\"/docker-lotus-miner-entrypoint.sh\"]\n\nCMD [\"-help\"]\n\n\n###\nFROM base AS lotus-worker\nMAINTAINER Lotus Development Team\n\nCOPY --from=builder /opt/filecoin/lotus-worker /usr/local/bin/\n\nENV FILECOIN_PARAMETER_CACHE /var/tmp/filecoin-proof-parameters\nENV LOTUS_WORKER_PATH /var/lib/lotus-worker\n\nRUN mkdir /var/lib/lotus-worker\nRUN chown fc: /var/lib/lotus-worker\n\nVOLUME /var/lib/lotus-worker\n\nUSER fc\n\nEXPOSE 3456\n\nENTRYPOINT [\"/usr/local/bin/lotus-worker\"]\n\nCMD [\"-help\"]\n\n\n###\nfrom base as lotus-all-in-one\n\nENV FILECOIN_PARAMETER_CACHE /var/tmp/filecoin-proof-parameters\nENV LOTUS_MINER_PATH /var/lib/lotus-miner\nENV LOTUS_PATH /var/lib/lotus\nENV LOTUS_WORKER_PATH /var/lib/lotus-worker\nENV WALLET_PATH /var/lib/lotus-wallet\nENV DOCKER_LOTUS_IMPORT_SNAPSHOT https://fil-chain-snapshots-fallback.s3.amazonaws.com/mainnet/minimal_finality_stateroots_latest.car\n\nCOPY --from=builder /opt/filecoin/lotus      /usr/local/bin/\nCOPY --from=builder /opt/filecoin/lotus-shed /usr/local/bin/\nCOPY --from=builder /opt/filecoin/lotus-wallet /usr/local/bin/\nCOPY --from=builder /opt/filecoin/lotus-gateway /usr/local/bin/\nCOPY --from=builder /opt/filecoin/lotus-miner /usr/local/bin/\nCOPY --from=builder /opt/filecoin/lotus-worker /usr/local/bin/\nCOPY --from=builder /opt/filecoin/lotus-stats /usr/local/bin/\n\nRUN mkdir /var/tmp/filecoin-proof-parameters\nRUN mkdir /var/lib/lotus\nRUN mkdir /var/lib/lotus-miner\nRUN mkdir /var/lib/lotus-worker\nRUN mkdir /var/lib/lotus-wallet\nRUN chown fc: /var/tmp/filecoin-proof-parameters\nRUN chown fc: /var/lib/lotus\nRUN chown fc: /var/lib/lotus-miner\nRUN chown fc: /var/lib/lotus-worker\nRUN chown fc: /var/lib/lotus-wallet\n\n\nVOLUME /var/tmp/filecoin-proof-parameters\nVOLUME /var/lib/lotus\nVOLUME /var/lib/lotus-miner\nVOLUME /var/lib/lotus-worker\nVOLUME /var/lib/lotus-wallet\n\nEXPOSE 1234\nEXPOSE 2345\nEXPOSE 3456\nEXPOSE 1777\n\n###\nfrom base as lotus-test\n\nENV FILECOIN_PARAMETER_CACHE /var/tmp/filecoin-proof-parameters\nENV LOTUS_MINER_PATH /var/lib/lotus-miner\nENV LOTUS_PATH /var/lib/lotus\nENV LOTUS_WORKER_PATH /var/lib/lotus-worker\nENV WALLET_PATH /var/lib/lotus-wallet\n\nCOPY --from=builder-test /opt/filecoin/lotus      /usr/local/bin/\nCOPY --from=builder-test /opt/filecoin/lotus-miner /usr/local/bin/\nCOPY --from=builder-test /opt/filecoin/lotus-worker /usr/local/bin/\nCOPY --from=builder-test /opt/filecoin/lotus-seed /usr/local/bin/\n\nRUN mkdir /var/tmp/filecoin-proof-parameters\nRUN mkdir /var/lib/lotus\nRUN mkdir /var/lib/lotus-miner\nRUN mkdir /var/lib/lotus-worker\nRUN mkdir /var/lib/lotus-wallet\nRUN chown fc: /var/tmp/filecoin-proof-parameters\nRUN chown fc: /var/lib/lotus\nRUN chown fc: /var/lib/lotus-miner\nRUN chown fc: /var/lib/lotus-worker\nRUN chown fc: /var/lib/lotus-wallet\n\n\nVOLUME /var/tmp/filecoin-proof-parameters\nVOLUME /var/lib/lotus\nVOLUME /var/lib/lotus-miner\nVOLUME /var/lib/lotus-worker\nVOLUME /var/lib/lotus-wallet\n\nEXPOSE 1234\nEXPOSE 2345\nEXPOSE 3456\nEXPOSE 1777\n\n"
}