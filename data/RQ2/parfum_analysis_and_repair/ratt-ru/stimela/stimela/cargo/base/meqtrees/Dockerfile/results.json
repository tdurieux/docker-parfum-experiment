{
  "startTime": 1674254291836,
  "endTime": 1674254292960,
  "originalSmells": [
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 6,
        "lineEnd": 6,
        "columnStart": 4,
        "columnEnd": 40
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 29,
        "lineEnd": 29,
        "columnStart": 4,
        "columnEnd": 18
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 80,
        "lineEnd": 80,
        "columnStart": 4,
        "columnEnd": 35
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 88,
        "lineEnd": 88,
        "columnStart": 4,
        "columnEnd": 55
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 89,
        "lineEnd": 89,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 107,
        "lineEnd": 107,
        "columnStart": 4,
        "columnEnd": 21
      }
    },
    {
      "rule": "tarSomethingRmTheSomething",
      "position": {
        "lineStart": 16,
        "lineEnd": 16,
        "columnStart": 4,
        "columnEnd": 25
      }
    },
    {
      "rule": "tarSomethingRmTheSomething",
      "position": {
        "lineStart": 27,
        "lineEnd": 27,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "tarSomethingRmTheSomething",
      "position": {
        "lineStart": 48,
        "lineEnd": 48,
        "columnStart": 4,
        "columnEnd": 24
      }
    },
    {
      "rule": "tarSomethingRmTheSomething",
      "position": {
        "lineStart": 66,
        "lineEnd": 66,
        "columnStart": 4,
        "columnEnd": 25
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "FROM stimela/base:1.6.0\n\nRUN docker-apt-install libblitz0-dev python3-dev libblas-dev liblapack-dev libqdbm-dev wcslib-dev \\\n libfftw3-dev python3-numpy libcfitsio-dev libboost-all-dev libboost-system-dev cmake g++ wget gfortran \\\n libncurses5-dev libsofa1-dev bison libbison-dev flex libreadline6-dev python3-pip\n\nRUN pip3 install --no-cache-dir -U pip setuptools wheel\n\n# casacore wheels no longer work and we need python 3 support, so build from source\n\n#####################################################################\n## BUILD CASACORE FROM SOURCE\n#####################################################################\nRUN mkdir /src\nWORKDIR /src\nRUN wget https://github.com/casacore/casacore/archive/v3.3.0.tar.gz\nRUN tar xvf v3.3.0.tar.gz && rm v3.3.0.tar.gz\nRUN mkdir casacore-3.3.0/build\nWORKDIR /src/casacore-3.3.0/build\nRUN echo hello\nRUN cmake -DCMAKE_INSTALL_PREFIX=/usr -DCMAKE_BUILD_TYPE=Release -DBUILD_DEPRECATED=ON -DBUILD_PYTHON3=ON -DBUILD_PYTHON=OFF ../\nRUN make -j 4\nRUN make install\nRUN ldconfig\n#RUN pip install -U --user --force-reinstall --install-option=\"--prefix=/usr\"  pip setuptools wheel\nWORKDIR /src\nRUN wget https://github.com/casacore/python-casacore/archive/v3.3.0.tar.gz\nRUN tar xvf v3.3.0.tar.gz.1 && rm v3.3.0.tar.gz.1\nWORKDIR /src/python-casacore-3.3.0\nRUN pip3 install --no-cache-dir .\nWORKDIR /\nRUN python3 -c \"from pyrap.tables import table as tbl\"\n\n#####################################################################\n## Get CASACORE ephem data\n#####################################################################\nRUN mkdir -p /usr/share/casacore/data/\nWORKDIR /usr/share/casacore/data/\nRUN docker-apt-install rsync\nRUN rsync -avz rsync://casa-rsync.nrao.edu/casa-data .\n\n#####################################################################\n## BUILD MAKEMS FROM SOURCE AND TEST\n#####################################################################\nRUN mkdir -p /src/\nWORKDIR /src\nENV BUILD /src\nRUN wget https://github.com/ska-sa/makems/archive/1.5.3.tar.gz\nRUN tar xvf 1.5.3.tar.gz && rm 1.5.3.tar.gz\nRUN mkdir -p $BUILD/makems-1.5.3/LOFAR/build/gnu_opt\nWORKDIR $BUILD/makems-1.5.3/LOFAR/build/gnu_opt\nRUN cmake -DCMAKE_MODULE_PATH:PATH=$BUILD/makems-1.5.3/LOFAR/CMake \\\n-DUSE_LOG4CPLUS=OFF -DBUILD_TESTING=OFF -DCMAKE_BUILD_TYPE=Release ../..\nRUN make -j 4\nRUN make install\n\nENV PATH=/src/makems-1.5.3/LOFAR/build/gnu_opt/CEP/MS/src:${PATH}\nWORKDIR $BUILD/makems-1.5.3/test\nRUN makems WSRT_makems.cfg\n\n#####################################################################\n## BUILD CASArest from source\n#####################################################################\nWORKDIR /src\nRUN docker-apt-install git\nRUN wget https://github.com/casacore/casarest/archive/v1.7.0.tar.gz\nRUN tar xvf v1.7.0.tar.gz && rm v1.7.0.tar.gz\nWORKDIR /src/casarest-1.7.0\nRUN mkdir -p build\nWORKDIR /src/casarest-1.7.0/build\nRUN cmake -DCMAKE_INSTALL_PREFIX=/usr -DCMAKE_BUILD_TYPE=Release ../\nRUN make -j 4\nRUN make install\nRUN ldconfig\n\n\n# add additional Timba dependencies\nRUN docker-apt-install python3-pyqt4 python3-pyqt5\nWORKDIR /code\nRUN git clone https://github.com/ska-sa/meqtrees-cattery.git\nRUN pip3 install --no-cache-dir ./meqtrees-cattery\nWORKDIR /src\nRUN git clone -b v1.5.0 https://github.com/ska-sa/purr.git\nRUN git clone -b v1.6.0 https://github.com/ska-sa/owlcat.git\nRUN git clone -b v1.4.3 https://github.com/ska-sa/kittens.git\nRUN git clone -b v1.6.0 https://github.com/ska-sa/tigger-lsm.git\nRUN git clone -b v1.7.1 https://github.com/ska-sa/pyxis.git\n\nRUN pip3 install --no-cache-dir ./purr ./owlcat ./kittens ./tigger-lsm\nRUN pip3 install --no-cache-dir -e ./pyxis\n\nWORKDIR /src\nRUN git clone -b v1.8.0 https://github.com/ska-sa/meqtrees-timba.git\nRUN mkdir /src/meqtrees-timba/build\nWORKDIR /src/meqtrees-timba/build\nRUN cmake -DCMAKE_INSTALL_PREFIX=/usr -DCMAKE_BUILD_TYPE=Release -DENABLE_PYTHON_3=ON ..\nRUN make -j4\nRUN make install\nRUN ldconfig\n\nRUN update-alternatives --install /usr/bin/python python /usr/bin/python3.6 2\n# basic install tests\nRUN flag-ms.py --help\nRUN meqtree-pipeliner.py --help\nRUN pyxis --help\n\n# run test when built\nRUN pip3 install --no-cache-dir nose\nWORKDIR /src/pyxis/Pyxis/recipes/meqtrees-batch-test\nRUN python3 -m \"nose\"\n"
}