{
  "startTime": 1674256294914,
  "endTime": 1674256295569,
  "originalSmells": [
    {
      "rule": "npmCacheCleanAfterInstall",
      "position": {
        "lineStart": 58,
        "lineEnd": 58,
        "columnStart": 4,
        "columnEnd": 22
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 56,
        "lineEnd": 56,
        "columnStart": 4,
        "columnEnd": 42
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 57,
        "lineEnd": 57,
        "columnStart": 4,
        "columnEnd": 58
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 21,
        "lineEnd": 42,
        "columnStart": 18,
        "columnEnd": 8
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 21,
        "lineEnd": 42,
        "columnStart": 18,
        "columnEnd": 8
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "FROM ubuntu:20.04\n\nMAINTAINER yijixiuxin<1058715329@qq.com>\n\nENV DEBIAN_FRONTEND=noninteractive\nENV LANG C.UTF-8\n\nSHELL [\"/bin/bash\", \"-c\"]\n\nWORKDIR /root\n\nCOPY sources.list /etc/apt/\nCOPY .condarc /root\nCOPY condainit /root\nCOPY mysql_secure.sh /root/\nCOPY mysql.sql /root/\nCOPY pm2.config.js /root/\nCOPY pytdx-1.72r2-py3-none-any.whl /root/\nCOPY requirements.txt /root/\nCOPY start.sh /usr/local/\n\nRUN apt update && apt install --no-install-recommends -y \\\n    sudo \\\n    apt-utils \\\n    vim \\\n    git \\\n    subversion \\\n    g++ \\\n    gdb \\\n    cmake \\\n    openjdk-11-jdk \\\n    mysql-server \\\n    redis \\\n    openssh-server \\\n    net-tools \\\n    iputils-ping \\\n    telnet \\\n    lsb-core \\\n    iptables \\\n    expect \\\n    tzdata \\\n    npm \\\n    wget && \\\n    wget https://repo.anaconda.com/miniconda/Miniconda3-py38_4.11.0-Linux-x86_64.sh && \\\n    bash Miniconda3-py38_4.11.0-Linux-x86_64.sh -b -p /usr/local/anaconda3/ && \\\n    rm Miniconda3-py38_4.11.0-Linux-x86_64.sh && \\\n    source /usr/local/anaconda3/bin/activate && \\\n    conda init && \\\n    conda clean -i && \\\n    pip config set global.index-url https://mirrors.aliyun.com/pypi/simple/ && \\\n    source .bashrc && \\\n    conda create -y -n chanlun python=3.7 && \\\n    conda activate chanlun && \\\n    conda install -y pandas requests numpy redis matplotlib pymysql && \\\n    conda install -y -c conda-forge ta-lib ipywidgets && \\\n    conda install -y -c conda-forge jupyterlab jupyterlab_widgets && \\\n    pip3 install --no-cache-dir -r /root/requirements.txt && \\\n    pip3 install --no-cache-dir wheel /root/pytdx-1.72r2-py3-none-any.whl && \\\n    npm install -g pm2 && \\\n    jupyter-lab --generate-config && \\\n    conda deactivate && \\\n    chmod 777 -R /usr/local/anaconda3/ && \\\n    usermod -d /var/lib/mysql/ mysql && \\\n    service mysql start && \\\n    chmod +x /root/mysql_secure.sh && \\\n    expect /root/mysql_secure.sh && \\\n    sed -i \"s/bind-address.*= 127.0.0.1/bind-address = 0.0.0.0/g\" /etc/mysql/mysql.conf.d/mysqld.cnf && \\\n    mysql -P 3306 -uroot -p123456 < /root/mysql.sql && \\\n    service mysql restart && \\\n    echo \"Asia/Shanghai\" > /etc/timezone && \\\n    ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime && \\\n    chmod 777 /usr/local/start.sh && \\\n    touch /usr/local/start.log && \\\n    chmod 777 /usr/local/start.log && \\\n    cd /root && \\\n    cat condainit >> /etc/profile && \\\n    echo -e >> /etc/profile && \\\n    echo \"export PYTHONPATH=$PYTHONPATH:/root/app/src\" >> /etc/profile && \\\n    echo -e >> /etc/profile && \\\n    echo \"set completion-ignore-case on\" >> ~/.inputrc && \\\n    source /etc/profile && \\\n    mkdir /root/app && npm cache clean --force; && rm -rf /var/lib/apt/lists/*;\n\nWORKDIR /root/app\n\nENV DEBIAN_FRONTEND=dialog\n\nVOLUME [\"/home/app\", \"/var/lib/mysql\", \"/var/lib/redis\"]\nEXPOSE 3306\nEXPOSE 8000\nEXPOSE 8888\n\nENTRYPOINT [\"/bin/bash\", \"/usr/local/start.sh\"]"
}