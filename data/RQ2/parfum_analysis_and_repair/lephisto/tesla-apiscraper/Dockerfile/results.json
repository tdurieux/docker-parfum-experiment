{
  "startTime": 1674251728480,
  "endTime": 1674251729648,
  "originalSmells": [
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 12,
        "lineEnd": 12,
        "columnStart": 4,
        "columnEnd": 54
      }
    },
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 18,
        "lineEnd": 18,
        "columnStart": 4,
        "columnEnd": 45
      }
    },
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 24,
        "lineEnd": 24,
        "columnStart": 4,
        "columnEnd": 50
      }
    },
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 62,
        "lineEnd": 62,
        "columnStart": 2,
        "columnEnd": 135
      }
    },
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 63,
        "lineEnd": 63,
        "columnStart": 2,
        "columnEnd": 126
      }
    },
    {
      "rule": "npmCacheCleanAfterInstall",
      "position": {
        "lineStart": 33,
        "lineEnd": 33,
        "columnStart": 4,
        "columnEnd": 15
      }
    },
    {
      "rule": "curlUseHttpsUrl",
      "position": {
        "lineStart": 62,
        "lineEnd": 62,
        "columnStart": 2,
        "columnEnd": 135
      }
    },
    {
      "rule": "curlUseHttpsUrl",
      "position": {
        "lineStart": 63,
        "lineEnd": 63,
        "columnStart": 2,
        "columnEnd": 126
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 42,
        "lineEnd": 42,
        "columnStart": 4,
        "columnEnd": 25
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 6,
        "lineEnd": 6,
        "columnStart": 4,
        "columnEnd": 30
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 7,
        "lineEnd": 7,
        "columnStart": 4,
        "columnEnd": 42
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 8,
        "lineEnd": 8,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 9,
        "lineEnd": 9,
        "columnStart": 4,
        "columnEnd": 29
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 15,
        "lineEnd": 15,
        "columnStart": 4,
        "columnEnd": 31
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 21,
        "lineEnd": 21,
        "columnStart": 4,
        "columnEnd": 30
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 25,
        "lineEnd": 25,
        "columnStart": 4,
        "columnEnd": 29
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 28,
        "lineEnd": 28,
        "columnStart": 4,
        "columnEnd": 26
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 39,
        "lineEnd": 39,
        "columnStart": 4,
        "columnEnd": 34
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 6,
        "lineEnd": 6,
        "columnStart": 4,
        "columnEnd": 30
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 7,
        "lineEnd": 7,
        "columnStart": 4,
        "columnEnd": 42
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 8,
        "lineEnd": 8,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 9,
        "lineEnd": 9,
        "columnStart": 4,
        "columnEnd": 29
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 15,
        "lineEnd": 15,
        "columnStart": 4,
        "columnEnd": 31
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 21,
        "lineEnd": 21,
        "columnStart": 4,
        "columnEnd": 30
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 25,
        "lineEnd": 25,
        "columnStart": 4,
        "columnEnd": 29
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 28,
        "lineEnd": 28,
        "columnStart": 4,
        "columnEnd": 26
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 39,
        "lineEnd": 39,
        "columnStart": 4,
        "columnEnd": 34
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 6,
        "lineEnd": 6,
        "columnStart": 4,
        "columnEnd": 30
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 7,
        "lineEnd": 7,
        "columnStart": 4,
        "columnEnd": 42
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 8,
        "lineEnd": 8,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 9,
        "lineEnd": 9,
        "columnStart": 4,
        "columnEnd": 29
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 15,
        "lineEnd": 15,
        "columnStart": 4,
        "columnEnd": 31
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 21,
        "lineEnd": 21,
        "columnStart": 4,
        "columnEnd": 30
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 25,
        "lineEnd": 25,
        "columnStart": 4,
        "columnEnd": 29
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 28,
        "lineEnd": 28,
        "columnStart": 4,
        "columnEnd": 26
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 39,
        "lineEnd": 39,
        "columnStart": 4,
        "columnEnd": 34
      }
    }
  ],
  "repairedSmells": [
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 6,
        "lineEnd": 6,
        "columnStart": 4,
        "columnEnd": 54
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 7,
        "lineEnd": 7,
        "columnStart": 4,
        "columnEnd": 66
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 8,
        "lineEnd": 8,
        "columnStart": 4,
        "columnEnd": 51
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 9,
        "lineEnd": 9,
        "columnStart": 4,
        "columnEnd": 53
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 15,
        "lineEnd": 15,
        "columnStart": 4,
        "columnEnd": 55
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 21,
        "lineEnd": 21,
        "columnStart": 4,
        "columnEnd": 54
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 25,
        "lineEnd": 25,
        "columnStart": 4,
        "columnEnd": 53
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 28,
        "lineEnd": 28,
        "columnStart": 4,
        "columnEnd": 50
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 39,
        "lineEnd": 39,
        "columnStart": 4,
        "columnEnd": 58
      }
    }
  ],
  "repairedDockerfile": "# Dockerfile for standalone usage\nFROM debian:stretch-slim\n\nRUN apt-get -y update\n\n# Install Python\nRUN apt-get -y --no-install-recommends install python3 && rm -rf /var/lib/apt/lists/*;\nRUN apt-get -y --no-install-recommends install apt-transport-https && rm -rf /var/lib/apt/lists/*;\nRUN apt-get -y --no-install-recommends install curl && rm -rf /var/lib/apt/lists/*;\nRUN apt-get -y --no-install-recommends install gnupg2 && rm -rf /var/lib/apt/lists/*;\n\n# Install Influx\nRUN curl -f -sL https://repos.influxdata.com/influxdb.key | apt-key add -\nRUN echo \"deb https://repos.influxdata.com/debian stretch stable\" | tee /etc/apt/sources.list.d/influxdb.list\nRUN apt-get -y update\nRUN apt-get -y --no-install-recommends install influxdb && rm -rf /var/lib/apt/lists/*;\n\n# Install Grafana\nRUN curl -f https://packages.grafana.com/gpg.key | apt-key add -\nRUN echo \"deb https://packages.grafana.com/oss/deb stable main\" | tee /etc/apt/sources.list.d/grafana.list\nRUN apt-get -y update\nRUN apt-get -y --no-install-recommends install grafana && rm -rf /var/lib/apt/lists/*;\n\n# Install Node\nRUN curl -f -sL https://deb.nodesource.com/setup_11.x | bash -\nRUN apt-get install --no-install-recommends -y nodejs && rm -rf /var/lib/apt/lists/*;\n\n# Install Grafana addons\nRUN apt-get -y --no-install-recommends install git && rm -rf /var/lib/apt/lists/*;\nWORKDIR /var/lib/grafana/plugins\nRUN git clone https://github.com/lephisto/grafana-trackmap-panel\nWORKDIR /var/lib/grafana/plugins/grafana-trackmap-panel\nRUN git checkout v2.0.4-teslascraper\nRUN npm install && npm cache clean --force;\nRUN npm audit fix\nRUN npm run build\nRUN grafana-cli plugins install natel-discrete-panel\n\n# Install Tesla API Scraper\nRUN apt-get -y --no-install-recommends install python3-pip && rm -rf /var/lib/apt/lists/*;\nWORKDIR /\nRUN git clone https://github.com/lephisto/tesla-apiscraper\nRUN pip3 install --no-cache-dir influxdb\n\nRUN git clone https://github.com/tkrajina/srtm.py\nWORKDIR srtm.py\nRUN python3 ./setup.py install\nWORKDIR /\n\n# Configure it\nWORKDIR tesla-apiscraper\nRUN git checkout v2019.5\nRUN cp config.py.dist config.py\n\n# Create temp files for dashboard API calls\nRUN echo '{\"dashboard\":' > /tmp/TeslaMetricsV2.json\nRUN cat ./grafana-dashboards/TeslaMetricsV2.json >> /tmp/TeslaMetricsV2.json\nRUN echo '}' >> /tmp/TeslaMetricsV2.json\nRUN sed -i 's/\\${DS_TESLA}/InfluxDB/g' /tmp/TeslaMetricsV2.json\n\n# Install Grafana data source and dashboards\nRUN service grafana-server start ; sleep 5 && \\\n  curl -f -v -H 'Content-Type: application/json' -d @./grafana-datasources/influxdb.json https://admin:admin@localhost:3000/api/datasources && \\\n  curl -f -v -H 'Content-Type: application/json' -d @/tmp/TeslaMetricsV2.json https://admin:admin@localhost:3000/api/dashboards/db && \\\n  service grafana-server stop\n\nRUN sed -i \"s/a_influxpass = '<influxdbpassword>'/a_influx_pass = None/g\" /tesla-apiscraper/config.py\nRUN sed -i \"s/a_influxuser = 'tesla'/a_influx_user = None/g\" /tesla-apiscraper/config.py\n\n# Define our startup script\nRUN echo \"#!/bin/bash\" > /start.sh\nRUN echo \"sed -i \\\"s/<email>/\\${TESLA_USERNAME}/g\\\" /tesla-apiscraper/config.py\" >> /start.sh\nRUN echo \"sed -i \\\"s/<password>/\\${TESLA_PASSWORD}/g\\\" /tesla-apiscraper/config.py\" >> /start.sh\nRUN echo \"service influxdb start\" >> /start.sh\nRUN echo \"influx -execute \\\"create database tesla\\\"\" >>/start.sh\nRUN echo \"service grafana-server start\" >> /start.sh\nRUN echo \"python3 /tesla-apiscraper/apiscraper.py\" >> /start.sh\nRUN chmod +x /start.sh\n\n# Persist Influx Data\nVOLUME [\"/var/lib/influxdb\"]\n\n# Run it\nEXPOSE 3000\nEXPOSE 8023\nCMD /start.sh\n"
}