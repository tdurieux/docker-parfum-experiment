{
  "startTime": 1674253463214,
  "endTime": 1674253464672,
  "originalSmells": [
    {
      "rule": "aptGetInstallUseY",
      "position": {
        "lineStart": 29,
        "lineEnd": 36,
        "columnStart": 2,
        "columnEnd": 26
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "FROM openjdk:8-jre-slim-buster\n\nARG GRAYLOG_VERSION\nARG BUILD_DATE\nARG GRAYLOG_HOME=/usr/share/graylog\nARG GRAYLOG_USER=graylog\nARG GRAYLOG_UID=1100\nARG GRAYLOG_GROUP=graylog\nARG GRAYLOG_GID=1100\nARG DEBUG_OPTS=''\n\nWORKDIR ${GRAYLOG_HOME}\n\n# hadolint ignore=DL3027,DL3008\nRUN \\\n  echo \"export JAVA_HOME=/usr/local/openjdk-8\"     > /etc/profile.d/graylog.sh && \\\n  echo \"export BUILD_DATE=${BUILD_DATE}\"           >> /etc/profile.d/graylog.sh && \\\n  echo \"export GRAYLOG_VERSION=${GRAYLOG_VERSION}\" >> /etc/profile.d/graylog.sh && \\\n  echo \"export GRAYLOG_SERVER_JAVA_OPTS='-Dlog4j2.formatMsgNoLookups=true -Djdk.tls.acknowledgeCloseNotify=true -XX:+UnlockExperimentalVMOptions -XX:+UseCGroupMemoryLimitForHeap -XX:NewRatio=1 -XX:MaxMetaspaceSize=256m -server -XX:+ResizeTLAB -XX:+UseConcMarkSweepGC -XX:+CMSConcurrentMTEnabled -XX:+CMSClassUnloadingEnabled -XX:+UseParNewGC -XX:-OmitStackTraceInFastThrow \" ${DEBUG_OPTS} \"'\" >> /etc/profile.d/graylog.sh && \\\n  echo \"export GRAYLOG_HOME=${GRAYLOG_HOME}\"       >> /etc/profile.d/graylog.sh && \\\n  echo \"export GRAYLOG_BIN_DIR=${GRAYLOG_HOME}/bin\"       >> /etc/profile.d/graylog.sh && \\\n  echo \"export GRAYLOG_USER=${GRAYLOG_USER}\"       >> /etc/profile.d/graylog.sh && \\\n  echo \"export GRAYLOG_GROUP=${GRAYLOG_GROUP}\"     >> /etc/profile.d/graylog.sh && \\\n  echo \"export GRAYLOG_UID=${GRAYLOG_UID}\"         >> /etc/profile.d/graylog.sh && \\\n  echo \"export GRAYLOG_GID=${GRAYLOG_GID}\"         >> /etc/profile.d/graylog.sh && \\\n  echo \"export GRAYLOG_REPORT_DISABLE_SANDBOX=true\" >> /etc/profile.d/graylog.sh && \\\n  echo \"export GRAYLOG_REPORT_GENERATION_TIMEOUT_SECONDS=600\" >> /etc/profile.d/graylog.sh && \\\n  echo \"export PATH=${GRAYLOG_HOME}/bin:${PATH}\"   >> /etc/profile.d/graylog.sh && \\\n  apt-get update  > /dev/null && \\\n  apt-get install -y --no-install-recommends --assume-yes \\\n    curl \\\n    tini \\\n    libcap2-bin \\\n    libglib2.0-0 \\\n    libx11-6 \\\n    libnss3 \\\n    fontconfig > /dev/null && \\\n  addgroup \\\n    --gid \"${GRAYLOG_GID}\" \\\n    --quiet \\\n    \"${GRAYLOG_GROUP}\" && \\\n  adduser \\\n    --disabled-password \\\n    --disabled-login \\\n    --gecos '' \\\n    --home ${GRAYLOG_HOME} \\\n    --uid \"${GRAYLOG_UID}\" \\\n    --gid \"${GRAYLOG_GID}\" \\\n    --quiet \\\n    \"${GRAYLOG_USER}\" && \\\n  chown --recursive \"${GRAYLOG_USER}\":\"${GRAYLOG_GROUP}\" ${GRAYLOG_HOME} && \\\n  setcap 'cap_net_bind_service=+ep' \"${JAVA_HOME}/bin/java\" && \\\n  apt-get remove --assume-yes --purge \\\n    apt-utils > /dev/null && \\\n  rm -f /etc/apt/sources.list.d/* && \\\n  apt-get clean > /dev/null && \\\n  apt autoremove --assume-yes > /dev/null && \\\n  rm -rf \\\n    /tmp/* \\\n    /var/cache/debconf/* \\\n    /var/lib/apt/lists/* \\\n    /var/log/* \\\n    /usr/share/X11 \\\n    /usr/share/doc/* 2> /dev/null\n\nEXPOSE 9000\nUSER ${GRAYLOG_USER}\n\nRUN \\\n  install \\\n    --directory \\\n    --mode=0750 \\\n    ${GRAYLOG_HOME}/data \\\n    ${GRAYLOG_HOME}/data/journal \\\n    ${GRAYLOG_HOME}/data/log \\\n    ${GRAYLOG_HOME}/data/config \\\n    ${GRAYLOG_HOME}/data/plugin \\\n    ${GRAYLOG_HOME}/data/data \\\n    ${GRAYLOG_HOME}/data/contentpacks \\\n    ${GRAYLOG_HOME}/lib \\\n    ${GRAYLOG_HOME}/log \\\n    ${GRAYLOG_HOME}/plugin \\\n    ${GRAYLOG_HOME}/bin\n\nCOPY docker-entrypoint.sh /\nCOPY graylog.conf ${GRAYLOG_HOME}/data/config\nCOPY log4j2.xml ${GRAYLOG_HOME}/data/config\n\nENTRYPOINT [\"tini\", \"--\", \"/docker-entrypoint.sh\"]\nCMD [\"graylog\"]\n\n"
}