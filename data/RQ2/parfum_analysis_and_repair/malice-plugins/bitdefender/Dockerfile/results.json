{
  "startTime": 1674218653556,
  "endTime": 1674218654426,
  "originalSmells": [
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 38,
        "lineEnd": 38,
        "columnStart": 5,
        "columnEnd": 42
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "####################################################\n# GOLANG BUILDER\n####################################################\nFROM golang:1.11 as go_builder\n\nCOPY . /go/src/github.com/malice-plugins/bitdefender\nWORKDIR /go/src/github.com/malice-plugins/bitdefender\nRUN go get -u github.com/golang/dep/cmd/dep && dep ensure\nRUN go build -ldflags \"-s -w -X main.Version=v$(cat VERSION) -X main.BuildTime=$(date -u +%Y%m%d)\" -o /bin/avscan\n\n####################################################\n# PLUGIN BUILDER\n####################################################\nFROM ubuntu:bionic\n# FROM debian:jessie\n\nLABEL maintainer \"https://github.com/blacktop\"\n\nLABEL malice.plugin.repository = \"https://github.com/malice-plugins/bitdefender.git\"\nLABEL malice.plugin.category=\"av\"\nLABEL malice.plugin.mime=\"*\"\nLABEL malice.plugin.docker.engine=\"*\"\n\n# Create a malice user and group first so the IDs get set the same way, even as\n# the rest of this may change over time.\nRUN groupadd -r malice \\\n  && useradd --no-log-init -r -g malice malice \\\n  && mkdir /malware \\\n  && chown -R malice:malice /malware\n\nARG BDKEY\nENV BDVERSION 7.7-1\n\nENV BDURLPART BitDefender_Antivirus_Scanner_for_Unices/Unix/Current/EN_FR_BR_RO/Linux/\nENV BDURL https://download.bitdefender.com/SMB/Workstation_Security_and_Management/${BDURLPART}\n\nRUN buildDeps='ca-certificates wget build-essential' \\\n  && apt-get update -qq \\\n  && apt-get install --no-install-recommends -yq $buildDeps psmisc \\\n  && set -x \\\n  && echo \"===> Install Bitdefender...\" \\\n  && cd /tmp \\\n  && wget -q ${BDURL}/BitDefender-Antivirus-Scanner-${BDVERSION}-linux-amd64.deb.run \\\n  && chmod 755 /tmp/BitDefender-Antivirus-Scanner-${BDVERSION}-linux-amd64.deb.run \\\n  && sh /tmp/BitDefender-Antivirus-Scanner-${BDVERSION}-linux-amd64.deb.run --check \\\n  && echo \"===> Making installer noninteractive...\" \\\n  && sed -i 's/^more LICENSE$/cat  LICENSE/' BitDefender-Antivirus-Scanner-${BDVERSION}-linux-amd64.deb.run \\\n  && sed -i 's/^CRCsum=.*$/CRCsum=\"0000000000\"/' BitDefender-Antivirus-Scanner-${BDVERSION}-linux-amd64.deb.run \\\n  && sed -i 's/^MD5=.*$/MD5=\"00000000000000000000000000000000\"/' BitDefender-Antivirus-Scanner-${BDVERSION}-linux-amd64.deb.run \\\n  && (echo 'accept'; echo 'n') | sh /tmp/BitDefender-Antivirus-Scanner-${BDVERSION}-linux-amd64.deb.run; \\\n  if [ \"x$BDKEY\" != \"x\" ]; then \\\n  echo \"===> Updating License...\"; \\\n  oldkey='^Key =.*$'; \\\n  newkey=\"Key = ${BDKEY}\"; \\\n  sed -i \"s|$oldkey|$newkey|g\" /opt/BitDefender-scanner/etc/bdscan.conf; \\\n  cat /opt/BitDefender-scanner/etc/bdscan.conf; \\\n  fi \\\n  && echo \"===> Clean up unnecessary files...\" \\\n  && apt-get purge -y --auto-remove $buildDeps \\\n  && apt-get clean \\\n  && rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/* /go /usr/local/go\n\n# Ensure ca-certificates is installed for elasticsearch to use https\nRUN apt-get update -qq && apt-get install -yq --no-install-recommends ca-certificates \\\n  && rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/*\n\n# Update Bitdefender definitions\nRUN mkdir -p /opt/malice && echo \"accept\" | bdscan --update\n\n# Add EICAR Test Virus File to malware folder\nADD http://www.eicar.org/download/eicar.com.txt /malware/EICAR\n\nCOPY --from=go_builder /bin/avscan /bin/avscan\n\nWORKDIR /malware\n\nENTRYPOINT [\"/bin/avscan\"]\nCMD [\"--help\"]\n"
}