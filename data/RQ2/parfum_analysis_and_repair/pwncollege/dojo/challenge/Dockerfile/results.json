{
  "startTime": 1674250959029,
  "endTime": 1674250960721,
  "originalSmells": [
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 173,
        "lineEnd": 173,
        "columnStart": 4,
        "columnEnd": 126
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 10,
        "lineEnd": 90,
        "columnStart": 4,
        "columnEnd": 39
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 10,
        "lineEnd": 90,
        "columnStart": 4,
        "columnEnd": 39
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "FROM ubuntu:20.04\n\nRUN rm /etc/dpkg/dpkg.cfg.d/excludes\n\nENV DEBIAN_FRONTEND noninteractive\nENV LC_CTYPE=C.UTF-8\n\nRUN dpkg --add-architecture i386\nRUN apt-get update && \\\n    dpkg -l | grep ^ii | cut -d' ' -f3 | grep -v '^libgcc-s1:amd64$' | xargs apt-get install -y --reinstall && \\\n    apt-get install --no-install-recommends -y sudo \\\n                       build-essential \\\n                       git \\\n                       gcc-multilib \\\n                       g++-multilib \\\n                       clang \\\n                       llvm \\\n                       gdb \\\n                       gdb-multiarch \\\n                       qemu-system-x86 \\\n                       kmod \\\n                       openssh-server \\\n                       python-is-python3 \\\n                       python3-dev \\\n                       python3-pip \\\n                       ipython3 \\\n                       default-jdk \\\n                       net-tools \\\n                       iproute2 \\\n                       nasm \\\n                       cmake \\\n                       rubygems \\\n                       emacs \\\n                       vim \\\n                       nano \\\n                       ed \\\n                       zsh \\\n                       tmux \\\n                       screen \\\n                       binwalk \\\n                       strace \\\n                       ltrace \\\n                       autoconf \\\n                       socat \\\n                       netcat \\\n                       nmap \\\n                       curl \\\n                       wget \\\n                       tcpdump \\\n                       exiftool \\\n                       hexedit \\\n                       parallel \\\n                       patchelf \\\n                       genisoimage \\\n                       whiptail \\\n                       binutils \\\n                       bsdmainutils \\\n                       bsdutils \\\n                       debianutils \\\n                       diffutils \\\n                       elfutils \\\n                       findutils \\\n                       gnupg-utils \\\n                       keyutils \\\n                       pcaputils \\\n                       pcre2-utils \\\n                       psutils \\\n                       squashfs-tools \\\n                       unzip \\\n                       virtualenvwrapper \\\n                       upx-ucl \\\n                       man-db \\\n                       manpages-dev \\\n                       bison \\\n                       bc \\\n                       flex \\\n                       cpio \\\n                       libelf-dev \\\n                       libtool-bin \\\n                       libini-config-dev \\\n                       libssl-dev \\\n                       libffi-dev \\\n                       libgmp-dev \\\n                       libglib2.0-dev \\\n                       libseccomp-dev \\\n                       libedit-dev \\\n                       libpixman-1-dev \\\n                       libc6:i386 \\\n                       libc6-dev-i386 \\\n                       libstdc++6:i386 \\\n                       libncurses5:i386 && rm -rf /var/lib/apt/lists/*;\n\nRUN yes | unminimize\n\nRUN useradd -s /bin/bash -m hacker && \\\n    passwd -d hacker\n\nRUN mkdir /opt/linux && wget -O - https://mirrors.edge.kernel.org/pub/linux/kernel/v5.x/linux-5.4.tar.gz | tar xzC /opt/linux\nWORKDIR /opt/linux/linux-5.4\nRUN make defconfig\nRUN for CONFIG in \\\n    CONFIG_9P_FS=y \\\n    CONFIG_9P_FS_POSIX_ACL=y \\\n    CONFIG_9P_FS_SECURITY=y \\\n    CONFIG_BALLOON_COMPACTION=y \\\n    CONFIG_CRYPTO_DEV_VIRTIO=y \\\n    CONFIG_DEBUG_FS=y \\\n    CONFIG_DEBUG_INFO=y \\\n    CONFIG_DEBUG_INFO_BTF=y \\\n    CONFIG_DEBUG_INFO_DWARF4=y \\\n    CONFIG_DEBUG_INFO_REDUCED=n \\\n    CONFIG_DEBUG_INFO_SPLIT=n \\\n    CONFIG_DEVPTS_FS=y \\\n    CONFIG_DRM_VIRTIO_GPU=y \\\n    CONFIG_FRAME_POINTER=y \\\n    CONFIG_GDB_SCRIPTS=y \\\n    CONFIG_HW_RANDOM_VIRTIO=y \\\n    CONFIG_HYPERVISOR_GUEST=y \\\n    CONFIG_NET_9P=y \\\n    CONFIG_NET_9P_DEBUG=n \\\n    CONFIG_NET_9P_VIRTIO=y \\\n    CONFIG_PARAVIRT=y \\\n    CONFIG_PCI=y \\\n    CONFIG_PCI_HOST_GENERIC=y \\\n    CONFIG_VIRTIO_BALLOON=y \\\n    CONFIG_VIRTIO_BLK=y \\\n    CONFIG_VIRTIO_BLK_SCSI=y \\\n    CONFIG_VIRTIO_CONSOLE=y \\\n    CONFIG_VIRTIO_INPUT=y \\\n    CONFIG_VIRTIO_NET=y \\\n    CONFIG_VIRTIO_PCI=y \\\n    CONFIG_VIRTIO_PCI_LEGACY=y \\\n    ; do echo $CONFIG >> .config; done\nRUN make -j$(nproc) bzImage\nRUN ln -s $PWD/arch/x86/boot/bzImage ../bzImage && \\\n    ln -s $PWD/vmlinux ../vmlinux\nWORKDIR /\n\nRUN echo '    StrictHostKeyChecking no' >> /etc/ssh/ssh_config && \\\n    echo '    UserKnownHostsFile=/dev/null' >> /etc/ssh/ssh_config && \\\n    echo '    LogLevel ERROR' >> /etc/ssh/ssh_config && \\\n    sed -i 's/#PasswordAuthentication yes/PasswordAuthentication yes/g' /etc/ssh/sshd_config && \\\n    sed -i 's/#PermitEmptyPasswords no/PermitEmptyPasswords yes/g' /etc/ssh/sshd_config && \\\n    sed -i 's/#PermitRootLogin prohibit-password/PermitRootLogin yes/g' /etc/ssh/sshd_config\n\nRUN mkdir /opt/gdb && wget -O - https://ftp.gnu.org/gnu/gdb/gdb-11.1.tar.gz | tar xzC /opt/gdb && \\\n    cd /opt/gdb/gdb-11.1 && \\\n    mkdir build && \\\n    cd build && \\\n    ../configure --prefix=/usr --with-python=/usr/bin/python3 && \\\n    make -j$(nproc) && \\\n    make install\n\nRUN curl -fsSL https://code-server.dev/install.sh | /bin/sh /dev/stdin\nRUN mkdir -p /opt/code-server/extensions && code-server --extensions-dir=/opt/code-server/extensions --install-extension ms-python.python\nRUN mv /usr/lib/code-server/lib/vscode/node_modules/@vscode/ripgrep/bin/rg /usr/lib/code-server/lib/vscode/node_modules/@vscode/ripgrep/bin/rg.orig && \\\n    echo '#!/usr/bin/python \\n\\\n          \\n\\\n          import sys \\n\\\n          import os \\n\\\n          \\n\\\n          sys.argv[0] += \".orig\" \\n\\\n          if \"--follow\" in sys.argv: sys.argv.remove(\"--follow\") \\n\\\n          os.execv(sys.argv[0], sys.argv)' \\\n    | awk '{$1=$1};1' > /usr/lib/code-server/lib/vscode/node_modules/@vscode/ripgrep/bin/rg && \\\n    chmod +x /usr/lib/code-server/lib/vscode/node_modules/@vscode/ripgrep/bin/rg\n\nRUN git clone https://github.com/aquynh/capstone /opt/capstone && cd /opt/capstone && ./make.sh && ./make.sh install\nRUN git clone https://github.com/radareorg/radare2 /opt/radare2 && cd /opt/radare2 && sys/install.sh\nRUN git clone https://github.com/aflplusplus/aflplusplus /opt/aflplusplus && cd /opt/aflplusplus && make distrib && make install\nRUN git clone https://github.com/yrp604/rappel /opt/rappel && cd /opt/rappel && make && cp bin/rappel /usr/bin/rappel\nRUN wget https://github.com/0vercl0k/rp/releases/download/v2.0.2/rp-lin-x64 -O /usr/bin/rp++ && chmod +x /usr/bin/rp++\n\nRUN pip install --no-cache-dir --force-reinstall git+https://github.com/Gallopsled/pwntools#egg=pwntools jupyter angr r2pipe asteval psutil\n\nRUN git clone https://github.com/pwndbg/pwndbg /opt/pwndbg\nRUN git clone https://github.com/hugsy/gef /opt/gef\nRUN git clone https://github.com/jerdna-regeiz/splitmind /opt/splitmind\n\nRUN ln -s /usr/bin/ipython3 /usr/bin/ipython\n\nRUN mkdir /opt/pwn.college\nCOPY docker-entrypoint.sh /opt/pwn.college/docker-entrypoint.sh\nCOPY setuid_python.c /opt/pwn.college/setuid_python.c\nCOPY vm /opt/pwn.college/vm\nCOPY .tmux.conf /opt/pwn.college/.tmux.conf\nCOPY .gdbinit /opt/pwn.college/.gdbinit\nCOPY .radare2rc /opt/pwn.college/.radare2rc\n\nRUN gcc /opt/pwn.college/setuid_python.c -o /opt/pwn.college/python && \\\n    rm /opt/pwn.college/setuid_python.c\n\nRUN ln -s /opt/pwn.college/vm/vm /usr/local/bin/vm\n\nRUN ln -sf /home/hacker/.tmux.conf /root/.tmux.conf && \\\n    ln -sf /home/hacker/.gdbinit /root/.gdbinit && \\\n    ln -sf /home/hacker/.radare2rc /root/.radare2rc\n\nRUN echo 'pwn.college{uninitialized}' > /flag && \\\n    chmod 400 /flag\n\nRUN mkdir /challenge\n\nRUN find / -type f -perm -4000 | xargs -r chmod u-s\n\nRUN chmod u+s /opt/pwn.college/python /opt/pwn.college/vm/vm\n\nWORKDIR /home/hacker\n"
}