{
  "startTime": 1674248496047,
  "endTime": 1674248498176,
  "originalSmells": [
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 59,
        "lineEnd": 59,
        "columnStart": 4,
        "columnEnd": 29
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 60,
        "lineEnd": 60,
        "columnStart": 4,
        "columnEnd": 24
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 61,
        "lineEnd": 61,
        "columnStart": 4,
        "columnEnd": 25
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 62,
        "lineEnd": 62,
        "columnStart": 4,
        "columnEnd": 34
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 2,
        "lineEnd": 2,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 3,
        "lineEnd": 3,
        "columnStart": 4,
        "columnEnd": 39
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 4,
        "lineEnd": 4,
        "columnStart": 4,
        "columnEnd": 28
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 5,
        "lineEnd": 5,
        "columnStart": 4,
        "columnEnd": 35
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 51,
        "lineEnd": 51,
        "columnStart": 4,
        "columnEnd": 42
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 52,
        "lineEnd": 52,
        "columnStart": 4,
        "columnEnd": 60
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 53,
        "lineEnd": 53,
        "columnStart": 4,
        "columnEnd": 40
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 58,
        "lineEnd": 58,
        "columnStart": 4,
        "columnEnd": 96
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 2,
        "lineEnd": 2,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 3,
        "lineEnd": 3,
        "columnStart": 4,
        "columnEnd": 39
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 4,
        "lineEnd": 4,
        "columnStart": 4,
        "columnEnd": 28
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 5,
        "lineEnd": 5,
        "columnStart": 4,
        "columnEnd": 35
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 51,
        "lineEnd": 51,
        "columnStart": 4,
        "columnEnd": 42
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 52,
        "lineEnd": 52,
        "columnStart": 4,
        "columnEnd": 60
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 53,
        "lineEnd": 53,
        "columnStart": 4,
        "columnEnd": 40
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 58,
        "lineEnd": 58,
        "columnStart": 4,
        "columnEnd": 96
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 2,
        "lineEnd": 2,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 3,
        "lineEnd": 3,
        "columnStart": 4,
        "columnEnd": 39
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 4,
        "lineEnd": 4,
        "columnStart": 4,
        "columnEnd": 28
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 5,
        "lineEnd": 5,
        "columnStart": 4,
        "columnEnd": 35
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 51,
        "lineEnd": 51,
        "columnStart": 4,
        "columnEnd": 42
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 52,
        "lineEnd": 52,
        "columnStart": 4,
        "columnEnd": 60
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 53,
        "lineEnd": 53,
        "columnStart": 4,
        "columnEnd": 40
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 58,
        "lineEnd": 58,
        "columnStart": 4,
        "columnEnd": 96
      }
    }
  ],
  "repairedSmells": [
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 2,
        "lineEnd": 2,
        "columnStart": 4,
        "columnEnd": 51
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 3,
        "lineEnd": 3,
        "columnStart": 4,
        "columnEnd": 63
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 4,
        "lineEnd": 4,
        "columnStart": 4,
        "columnEnd": 52
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 5,
        "lineEnd": 5,
        "columnStart": 4,
        "columnEnd": 59
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 51,
        "lineEnd": 51,
        "columnStart": 4,
        "columnEnd": 66
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 52,
        "lineEnd": 52,
        "columnStart": 4,
        "columnEnd": 84
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 53,
        "lineEnd": 53,
        "columnStart": 4,
        "columnEnd": 64
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 58,
        "lineEnd": 58,
        "columnStart": 4,
        "columnEnd": 120
      }
    }
  ],
  "repairedDockerfile": "FROM ubuntu:16.04\nRUN apt-get update\nRUN apt-get install --no-install-recommends -y make && rm -rf /var/lib/apt/lists/*;\nRUN apt-get install --no-install-recommends -y gcc gcc-multilib && rm -rf /var/lib/apt/lists/*;\nRUN apt-get install --no-install-recommends -y clang && rm -rf /var/lib/apt/lists/*;\nRUN apt-get install --no-install-recommends -y libpam0g-dev && rm -rf /var/lib/apt/lists/*;\n\nCOPY buffer_01.c /tmp/buffer_01.c\nCOPY flag_01.c /tmp/flag_01.c\n\nCOPY buffer_02.c /tmp/buffer_02.c\nCOPY flag_02.c /tmp/flag_02.c\n\nCOPY buffer_03.c /tmp/buffer_03.c\nCOPY flag_03.c /tmp/flag_03.c\n\nCOPY buffer_04.c /tmp/buffer_04.c\nCOPY flag_04.c /tmp/flag_04.c\n\nCOPY buffer_05.c /tmp/buffer_05.c\nCOPY flag_05.c /tmp/flag_05.c\n\nCOPY buffer_rop.c /tmp/buffer_rop.c\nCOPY flag_rop.c /tmp/flag_rop.c\n\n\nWORKDIR /tmp\nRUN gcc  -g -m32 -fno-stack-protector -z execstack buffer_01.c -c\nRUN gcc  -g -m32 -fno-stack-protector -z execstack flag_01.c -c\nRUN gcc  -g -m32 -fno-stack-protector -z execstack buffer_01.o flag_01.o -o say_hello\n\nRUN gcc  -g -m32 -fno-stack-protector -z execstack buffer_02.c -c\nRUN gcc  -g -m32 -fno-stack-protector -z execstack flag_02.c -c\nRUN gcc  -g -m32 -fno-stack-protector -z execstack buffer_02.o flag_02.o -o say_hello2\n\nRUN gcc  -g -m32 -fno-stack-protector -z execstack buffer_03.c -c\nRUN gcc  -g -m32 -fno-stack-protector -z execstack flag_03.c -c\nRUN gcc  -g -m32 -fno-stack-protector -z execstack buffer_03.o flag_03.o -o say_hello3\n\nRUN gcc  -g -m32 -fno-stack-protector -z execstack buffer_04.c flag_04.c -o say_hello4\n\nRUN gcc  -g -m32 -fno-stack-protector -z execstack buffer_05.c flag_05.c -o say_hello5\n\nRUN clang  -o rop buffer_rop.c -m32 -fno-stack-protector  -Wl,-z,relro,-z,now,-z,noexecstack -static\n\n\n\n\nFROM ctf-sshd:latest\nRUN dpkg --add-architecture i386\nRUN apt-get update\nRUN apt-get install --no-install-recommends -y python binutils gdb && rm -rf /var/lib/apt/lists/*;\nRUN apt-get install --no-install-recommends -y libc6-dbg libc6-dbg:i386 lib32stdc++6 && rm -rf /var/lib/apt/lists/*;\nRUN apt-get install --no-install-recommends -y vim strace ltrace && rm -rf /var/lib/apt/lists/*;\n\n# ROPgadget : https://github.com/JonathanSalwan/ROPgadget\n# pwntools  : http://docs.pwntools.com/en/stable/install.html\n\nRUN apt-get install --no-install-recommends -y python2.7 python-pip python-dev git libssl-dev libffi-dev build-essential && rm -rf /var/lib/apt/lists/*;\nRUN pip install --no-cache-dir --upgrade pip\nRUN pip install --no-cache-dir capstone\nRUN pip install --no-cache-dir ropgadget\nRUN pip install --no-cache-dir --upgrade pwntools\n\nRUN useradd -d /home/grandmaster -s /bin/dash grandmaster\n\nRUN useradd -d /home/bender -s /bin/bash bender\nRUN echo 'bender:leelu' | chpasswd\nCOPY --from=0  --chown=grandmaster /tmp/say_hello /home/bender/say_hello\nCOPY --from=0  --chown=grandmaster /tmp/buffer_01.c /home/bender/buffer_01.c\nRUN chmod 555 /home/bender/say_hello\nRUN chmod 444 /home/bender/buffer_01.c\n\nRUN useradd -d /home/leela -s /bin/bash leela\nRUN echo 'leela:yivo' | chpasswd\nCOPY --from=0  --chown=grandmaster /tmp/say_hello2 /home/leela/say_hello2\nCOPY --from=0  --chown=grandmaster /tmp/buffer_02.c /home/leela/buffer_02.c\nRUN chmod 555 /home/leela/say_hello2\nRUN chmod 444 /home/leela/buffer_02.c\n\nRUN useradd -d /home/philip -s /bin/bash philip\nRUN echo 'philip:elzar' | chpasswd\nCOPY --from=0  --chown=grandmaster /tmp/say_hello3 /home/philip/say_hello3\nCOPY --from=0  --chown=grandmaster /tmp/buffer_03.c /home/philip/buffer_03.c\nRUN chmod 555 /home/philip/say_hello3\nRUN chmod 444 /home/philip/buffer_03.c\n\nRUN useradd -d /home/fry -s /bin/bash fry\nRUN echo 'fry:futur' | chpasswd\nCOPY --from=0  --chown=root /tmp/say_hello4 /home/fry/say_hello4\nCOPY --from=0  --chown=grandmaster /tmp/buffer_04.c /home/fry/buffer_04.c\nRUN chmod 555 /home/fry/say_hello4\nRUN chmod u+s /home/fry/say_hello4\nRUN chmod 444 /home/fry/buffer_04.c\nCOPY --chown=fry profile04 /home/fry/.profile\nRUN chmod 644 /home/fry/.profile\nCOPY --chown=root flag04.txt /home/fry/flag04.txt\nRUN chmod 700 /home/fry/flag04.txt\nCOPY --chown=fry pattern.py /home/fry/pattern.py\n\nRUN useradd -d /home/zapp -s /bin/bash zapp\nRUN echo 'zapp:kif' | chpasswd\nCOPY --from=0  --chown=grandmaster /tmp/say_hello5 /home/zapp/say_hello5\nCOPY --from=0  --chown=grandmaster /tmp/buffer_05.c /home/zapp/buffer_05.c\nRUN chmod 555 /home/zapp/say_hello5\nRUN chmod 444 /home/zapp/buffer_05.c\nCOPY --chown=zapp pattern.py /home/zapp/pattern.py\n\nCOPY --from=0  --chown=grandmaster /tmp/rop /home/zapp/rop\nCOPY --from=0  --chown=grandmaster /tmp/buffer_rop.c /home/zapp/buffer_rop.c\nRUN chmod 555 /home/zapp/rop\nRUN chmod 444 /home/zapp/buffer_rop.c\n\nEXPOSE 22\n"
}