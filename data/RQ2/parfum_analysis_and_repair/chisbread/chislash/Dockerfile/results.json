{
  "startTime": 1674253352079,
  "endTime": 1674253352686,
  "originalSmells": [
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 4,
        "lineEnd": 5,
        "columnStart": 7,
        "columnEnd": 38
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "FROM ubuntu:20.04\nRUN sed -i s@/archive.ubuntu.com/@/mirrors.aliyun.com/@g /etc/apt/sources.list \\\n    && apt-get clean \\\n    && apt-get update \\\n    && apt-get install --no-install-recommends -y wget xz-utils iproute2 iptables \\\n        curl python3 python3-yaml kmod \\\n    && rm -rf /var/lib/apt/lists/* \\\n    && rm /bin/sh && ln -s /bin/bash /bin/sh \\\n    && mv -v /usr/sbin/ip6tables /usr/sbin/ip6tables--DISABLED-$(date +\"%Y-%m-%d--%H-%M\") \\\n    && cp -v /usr/sbin/ip6tables-nft /usr/sbin/ip6tables \\\n    && mv -v /usr/sbin/iptables /usr/sbin/iptables--DISABLED-$(date +\"%Y-%m-%d--%H-%M\") \\\n    && cp -v /usr/sbin/iptables-nft /usr/sbin/iptables\n\nARG CLASHVER=v1.10.6\nARG YACDVER=v0.3.4\nARG SCVER=v0.7.2\nRUN echo 'detect arch ...' \\\n    && SC_ARCH='unknown' && ARCH='unknown' \\\n    && if [[ `uname -p` =~ \"x86_64\" ]]; then ARCH='amd64'; SC_ARCH='linux64'; fi \\\n    && if [[ `uname -p` =~ \"armv7\" ]]; then \\\n        ARCH='armv7'; SC_ARCH='armv7'; \\\n        for i in /etc/ssl/certs/*.pem; do HASH=$(openssl x509 -hash -noout -in $i); ln -s $(basename $i) /etc/ssl/certs/$HASH.0; done \\\n    fi \\\n    && if [[ `uname -p` =~ \"aarch64\" ]]; then ARCH='armv8';SC_ARCH='aarch64'; fi \\\n    && echo 'install clash ...' \\\n    && wget https://github.com/Dreamacro/clash/releases/download/$CLASHVER/clash-linux-$ARCH-$CLASHVER.gz \\\n    && gunzip clash-linux-$ARCH-$CLASHVER.gz \\\n    && mv clash-linux-$ARCH-$CLASHVER /usr/bin/clash \\\n    && chmod 774 /usr/bin/clash \\\n    && echo 'install yacd dashboard ...' \\\n    && wget https://github.com/haishanh/yacd/releases/download/$YACDVER/yacd.tar.xz \\\n    && mkdir -p /default/clash/dashboard \\\n    && tar xvf yacd.tar.xz -C /default/clash/dashboard && rm yacd.tar.xz \\\n    && echo 'download default Country.mmdb ...' \\\n    && wget https://geolite.clash.dev/Country.mmdb -O /default/clash/Country.mmdb \\\n    && echo 'install subconverter ...' \\\n    && wget https://github.com/tindy2013/subconverter/releases/download/$SCVER/subconverter_$SC_ARCH.tar.gz \\\n    && gunzip subconverter_$SC_ARCH.tar.gz && tar xvf subconverter_$SC_ARCH.tar && rm subconverter_$SC_ARCH.tar \\\n    && mv subconverter /default/ \\\n    && wget https://github.com/ACL4SSR/ACL4SSR/archive/refs/heads/master.tar.gz \\\n    && gunzip master.tar.gz && tar xvf master.tar && rm master.tar \\\n    && mkdir /default/exports && mv ACL4SSR-master /default/exports/ACL4SSR \\\n    && chmod -R a+r /default/\n\nENV ENABLE_CLASH=1\nENV REQUIRED_CONFIG=\"\"\nENV CLASH_HTTP_PORT=7890\nENV CLASH_SOCKS_PORT=7891\nENV CLASH_TPROXY_PORT=7892\nENV CLASH_MIXED_PORT=7893\nENV DASH_PORT=8080\nENV DASH_PATH=\"/etc/clash/dashboard/public\"\nENV IP_ROUTE=1\nENV UDP_PROXY=1\nENV IPV6_PROXY=1\nENV PROXY_FWMARK=0x162\nENV PROXY_ROUTE_TABLE=0x162\nENV LOG_LEVEL=\"info\"\nENV SECRET=\"\"\nENV ENABLE_SUBCONV=1\nENV SUBCONV_URL=\"http://127.0.0.1:25500/sub\"\nENV SUBSCR_URLS=\"\"\nENV SUBSCR_EXPR=6000\nENV REMOTE_CONV_RULE=\"http://127.0.0.1:8091/ACL4SSR/Clash/config/ACL4SSR_Online_Full.ini\"\nENV EXPORT_DIR_PORT=8091\nENV EXPORT_DIR_BIND='0.0.0.0'\nENV NO_ENGLISH=true\n\nEXPOSE $CLASH_HTTP_PORT $CLASH_SOCKS_PORT $CLASH_TPROXY_PORT $CLASH_MIXED_PORT $DASH_PORT $SUBCONV_PORT\nVOLUME /etc/clash\nCOPY start.sh /\nCOPY transparent_proxy /transparent_proxy\nCOPY utils /default/clash/utils\nRUN chmod +x /transparent_proxy/*\nRUN useradd -g root -s /bin/bash -u 1086 -m clash\nENTRYPOINT [ \"/start.sh\" ]\n"
}