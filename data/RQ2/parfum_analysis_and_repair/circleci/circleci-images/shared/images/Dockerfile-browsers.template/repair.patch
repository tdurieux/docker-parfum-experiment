diff --git a/Users/tdurieux/git/dinghy-experiment/data/evaluation/dockerfiles/circleci/circleci-images/shared/images/Dockerfile-browsers.template b/Users/tdurieux/git/dinghy-experiment/data/evaluation/dockerfile_repair_results/circleci/circleci-images/shared/images/Dockerfile-browsers.template/repaired.Dockerfile
index 3a33abf..d21fcf3 100644
--- a/Users/tdurieux/git/dinghy-experiment/data/evaluation/dockerfiles/circleci/circleci-images/shared/images/Dockerfile-browsers.template
+++ b/Users/tdurieux/git/dinghy-experiment/data/evaluation/dockerfile_repair_results/circleci/circleci-images/shared/images/Dockerfile-browsers.template/repaired.Dockerfile
@@ -3,29 +3,29 @@ FROM {{BASE_IMAGE}}
 #
 # Install Java 11 LTS / OpenJDK 11
 #
-RUN if grep -q Debian /etc/os-release && grep -q stretch /etc/os-release; then \
+RUN if grep -q Debian /etc/os-release && grep -q stretch /etc/os-release;then \
 		echo 'deb http://deb.debian.org/debian stretch-backports main' | sudo tee -a /etc/apt/sources.list.d/stretch-backports.list; \
 	elif grep -q Ubuntu /etc/os-release && grep -q xenial /etc/os-release; then \
-		sudo apt-get update && sudo apt-get install -y software-properties-common && \
-		sudo add-apt-repository -y ppa:openjdk-r/ppa; \
+		sudo apt-get update && sudo apt-get install --no-install-recommends -y software-properties-common && \
+		sudo add-apt-repository -y ppa:openjdk-r/ppa; rm -rf /var/lib/apt/lists/*; \
 	fi && \
-	sudo apt-get update && sudo apt-get install -y openjdk-11-jre openjdk-11-jre-headless openjdk-11-jdk openjdk-11-jdk-headless && \
-	sudo apt-get install -y bzip2 libgconf-2-4 # for extracting firefox and running chrome, respectively
+	sudo apt-get update && sudo apt-get install --no-install-recommends -y openjdk-11-jre openjdk-11-jre-headless openjdk-11-jdk openjdk-11-jdk-headless && \
+	sudo apt-get install --no-install-recommends -y bzip2 libgconf-2-4 && rm -rf /var/lib/apt/lists/*; # for extracting firefox and running chrome, respectively
 
 # install firefox
 #
 RUN FIREFOX_URL="https://download.mozilla.org/?product=firefox-latest-ssl&os=linux64&lang=en-US" \
-  && ACTUAL_URL=$(curl -Ls -o /dev/null -w %{url_effective} $FIREFOX_URL) \
+  && ACTUAL_URL=$( curl -f -Ls -o /dev/null -w %{url_effective} $FIREFOX_URL) \
   && curl --silent --show-error --location --fail --retry 3 --output /tmp/firefox.tar.bz2 $ACTUAL_URL \
   && sudo tar -xvjf /tmp/firefox.tar.bz2 -C /opt \
   && sudo ln -s /opt/firefox/firefox /usr/local/bin/firefox \
-  && sudo apt-get install -y libgtk3.0-cil-dev libasound2 libasound2 libdbus-glib-1-2 libdbus-1-3 \
+  && sudo apt-get install --no-install-recommends -y libgtk3.0-cil-dev libasound2 libasound2 libdbus-glib-1-2 libdbus-1-3 libasound2 \
   && rm -rf /tmp/firefox.* \
-  && firefox --version
+  && firefox --version && rm /tmp/firefox.tar.bz2 && rm -rf /var/lib/apt/lists/*;
 
 # install geckodriver
 
-RUN export GECKODRIVER_LATEST_RELEASE_URL=$(curl https://api.github.com/repos/mozilla/geckodriver/releases/latest | jq -r ".assets[] | select(.name | test(\"linux64.tar.gz$\")) | .browser_download_url") \
+RUN export GECKODRIVER_LATEST_RELEASE_URL=$( curl -f https://api.github.com/repos/mozilla/geckodriver/releases/latest | jq -r ".assets[] | select(.name | test(\"linux64.tar.gz$\")) | .browser_download_url") \
      && curl --silent --show-error --location --fail --retry 3 --output /tmp/geckodriver_linux64.tar.gz "$GECKODRIVER_LATEST_RELEASE_URL" \
      && cd /tmp \
      && tar xf geckodriver_linux64.tar.gz \
@@ -45,8 +45,8 @@ RUN cd /home/circleci && wget -O google-chrome-stable_current_amd64.deb -t 5 "ht
 
 RUN CHROME_VERSION="$(google-chrome --version)" \
     && export CHROMEDRIVER_RELEASE="$(echo $CHROME_VERSION | sed 's/^Google Chrome //')" && export CHROMEDRIVER_RELEASE=${CHROMEDRIVER_RELEASE%%.*} \
-    && CHROMEDRIVER_VERSION=$(curl --silent --show-error --location --fail --retry 4 --retry-delay 5 http://chromedriver.storage.googleapis.com/LATEST_RELEASE_${CHROMEDRIVER_RELEASE}) \
-    && curl --silent --show-error --location --fail --retry 4 --retry-delay 5 --output /tmp/chromedriver_linux64.zip "http://chromedriver.storage.googleapis.com/$CHROMEDRIVER_VERSION/chromedriver_linux64.zip" \
+    && CHROMEDRIVER_VERSION=$( curl --silent --show-error --location --fail --retry 4 --retry-delay 5 https://chromedriver.storage.googleapis.com/LATEST_RELEASE_${CHROMEDRIVER_RELEASE}) \
+    && curl --silent --show-error --location --fail --retry 4 --retry-delay 5 --output /tmp/chromedriver_linux64.zip "https://chromedriver.storage.googleapis.com/$CHROMEDRIVER_VERSION/chromedriver_linux64.zip" \
     && cd /tmp \
     && unzip chromedriver_linux64.zip \
     && rm -rf chromedriver_linux64.zip \
@@ -56,7 +56,7 @@ RUN CHROME_VERSION="$(google-chrome --version)" \
 
 # Google Chrome < v85 had libxss1 as a dependency. It no longer does but people
 # have been depending on it so installing manually.
-RUN sudo apt-get install -y libxss1
+RUN sudo apt-get install --no-install-recommends -y libxss1 && rm -rf /var/lib/apt/lists/*;
 
 # start xvfb automatically to avoid needing to express in circle.yml
 ENV DISPLAY :99