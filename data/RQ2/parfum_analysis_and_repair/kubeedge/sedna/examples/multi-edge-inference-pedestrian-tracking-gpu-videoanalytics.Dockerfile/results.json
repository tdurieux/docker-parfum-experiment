{
  "startTime": 1674253795635,
  "endTime": 1674253796953,
  "originalSmells": [
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 12,
        "lineEnd": 12,
        "columnStart": 4,
        "columnEnd": 59
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 72,
        "lineEnd": 72,
        "columnStart": 4,
        "columnEnd": 95
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 75,
        "lineEnd": 75,
        "columnStart": 4,
        "columnEnd": 73
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 78,
        "lineEnd": 78,
        "columnStart": 4,
        "columnEnd": 77
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 79,
        "lineEnd": 79,
        "columnStart": 4,
        "columnEnd": 72
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 84,
        "lineEnd": 84,
        "columnStart": 4,
        "columnEnd": 86
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 92,
        "lineEnd": 92,
        "columnStart": 4,
        "columnEnd": 21
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 95,
        "lineEnd": 95,
        "columnStart": 4,
        "columnEnd": 37
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 6,
        "lineEnd": 6,
        "columnStart": 4,
        "columnEnd": 54
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 7,
        "lineEnd": 7,
        "columnStart": 4,
        "columnEnd": 57
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 10,
        "lineEnd": 10,
        "columnStart": 4,
        "columnEnd": 66
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 20,
        "lineEnd": 24,
        "columnStart": 4,
        "columnEnd": 30
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 26,
        "lineEnd": 26,
        "columnStart": 4,
        "columnEnd": 64
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 29,
        "lineEnd": 29,
        "columnStart": 4,
        "columnEnd": 30
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 89,
        "lineEnd": 89,
        "columnStart": 4,
        "columnEnd": 31
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 6,
        "lineEnd": 6,
        "columnStart": 4,
        "columnEnd": 54
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 7,
        "lineEnd": 7,
        "columnStart": 4,
        "columnEnd": 57
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 10,
        "lineEnd": 10,
        "columnStart": 4,
        "columnEnd": 66
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 20,
        "lineEnd": 24,
        "columnStart": 4,
        "columnEnd": 30
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 26,
        "lineEnd": 26,
        "columnStart": 4,
        "columnEnd": 64
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 29,
        "lineEnd": 29,
        "columnStart": 4,
        "columnEnd": 30
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 89,
        "lineEnd": 89,
        "columnStart": 4,
        "columnEnd": 31
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 6,
        "lineEnd": 6,
        "columnStart": 4,
        "columnEnd": 54
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 7,
        "lineEnd": 7,
        "columnStart": 4,
        "columnEnd": 57
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 10,
        "lineEnd": 10,
        "columnStart": 4,
        "columnEnd": 66
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 20,
        "lineEnd": 24,
        "columnStart": 4,
        "columnEnd": 30
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 26,
        "lineEnd": 26,
        "columnStart": 4,
        "columnEnd": 64
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 29,
        "lineEnd": 29,
        "columnStart": 4,
        "columnEnd": 30
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 89,
        "lineEnd": 89,
        "columnStart": 4,
        "columnEnd": 31
      }
    }
  ],
  "repairedSmells": [
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 6,
        "lineEnd": 6,
        "columnStart": 4,
        "columnEnd": 78
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 7,
        "lineEnd": 7,
        "columnStart": 4,
        "columnEnd": 81
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 10,
        "lineEnd": 10,
        "columnStart": 4,
        "columnEnd": 90
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 20,
        "lineEnd": 24,
        "columnStart": 4,
        "columnEnd": 30
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 26,
        "lineEnd": 26,
        "columnStart": 4,
        "columnEnd": 88
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 29,
        "lineEnd": 29,
        "columnStart": 4,
        "columnEnd": 54
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 89,
        "lineEnd": 89,
        "columnStart": 4,
        "columnEnd": 55
      }
    }
  ],
  "repairedDockerfile": "FROM pytorch/pytorch:1.8.1-cuda10.2-cudnn7-devel\nWORKDIR /home\n\nRUN apt update -o Acquire::https::developer.download.nvidia.com::Verify-Peer=false\n\n# Required by OpenCV\nRUN apt install --no-install-recommends libgl1 libglx-mesa0 libgl1-mesa-glx -y && rm -rf /var/lib/apt/lists/*;\nRUN apt install --no-install-recommends -y gfortran libopenblas-dev liblapack-dev && rm -rf /var/lib/apt/lists/*;\n\n# Update Python\nRUN apt install --no-install-recommends python3.8 python3.8-distutils python3-venv curl -y && rm -rf /var/lib/apt/lists/*;\nRUN python3.8 --version\nRUN curl -f https://bootstrap.pypa.io/get-pip.py -o get-pip.py\nRUN python3.8 get-pip.py\n\n######################################################\n#  Install OpenCV manually with gstreamer support    #\n######################################################\n\nENV DEBIAN_FRONTEND=\"noninteractive\" TZ=\"Europe/London\"\nRUN apt install --no-install-recommends libgstreamer1.0-dev libgstreamer-plugins-base1.0-dev libgstreamer-plugins-bad1.0-dev \\\n    gstreamer1.0-plugins-base gstreamer1.0-plugins-good gstreamer1.0-plugins-bad \\\n    gstreamer1.0-plugins-ugly gstreamer1.0-libav gstreamer1.0-doc gstreamer1.0-tools \\\n    gstreamer1.0-x gstreamer1.0-alsa gstreamer1.0-gl gstreamer1.0-gtk3 gstreamer1.0-qt5 \\\n    gstreamer1.0-pulseaudio -y && rm -rf /var/lib/apt/lists/*;\n\nRUN apt install --no-install-recommends ubuntu-restricted-extras wget ca-certificates -y && rm -rf /var/lib/apt/lists/*;\n\nRUN wget -k --no-check-certificate https://github.com/opencv/opencv/archive/4.5.5.zip -O opencv.zip\nRUN apt install --no-install-recommends unzip cmake -y && rm -rf /var/lib/apt/lists/*;\n\nRUN wget -k --no-check-certificate https://github.com/opencv/opencv_contrib/archive/4.5.5.zip -O opencv_contrib.zip\n\nRUN unzip opencv.zip\nRUN unzip opencv_contrib.zip\n\nRUN ls -la\nRUN pwd\n\nWORKDIR opencv-4.5.5\nRUN mkdir build\n\nWORKDIR build\n\nRUN cmake -D CMAKE_BUILD_TYPE=RELEASE \\\n-D INSTALL_PYTHON_EXAMPLES=OFF \\\n-D INSTALL_C_EXAMPLES=OFF \\\n-D PYTHON_EXECUTABLE=$(which python3) \\\n-D BUILD_opencv_python2=OFF \\\n-D OPENCV_EXTRA_MODULES_PATH=/home/opencv_contrib-4.5.5/modules \\\n-D WITH_CUDA=ON \\ \n-D WITH_CUDNN=OFF\\\n-D OPENCV_DNN_CUDA=ON\\\n-D ENABLE_FAST_MATH=1\\\n-D CUDA_FAST_MATH=1\\\n-D CUDA_ARCH_BIN=6.0\\\n-D WITH_CUBLAS=1 \\\n-D CMAKE_INSTALL_PREFIX=$(python3 -c \"import sys; print(sys.prefix)\") \\\n-D PYTHON3_EXECUTABLE=$(which python3) \\\n-D PYTHON3_INCLUDE_DIR=$(python3 -c \"from distutils.sysconfig import get_python_inc; print(get_python_inc())\") \\\n-D PYTHON3_PACKAGES_PATH=$(python3 -c \"from distutils.sysconfig import get_python_lib; print(get_python_lib())\") \\\n-D WITH_GSTREAMER=ON \\\n-D BUILD_TIFF=ON \\\n-D BUILD_JPEG=ON \\\n-D WITH_JPEG=ON \\\n-D BUILD_EXAMPLES=OFF ..\n\nRUN make -j6\nRUN make install\nRUN ldconfig\n\n## Install applications dependencies\nRUN pip install --no-cache-dir tqdm pillow pytorch-ignite asyncio --trusted-host=developer.download.nvidia.com\n\n## Add Kafka Python library\nRUN pip install --no-cache-dir kafka-python --trusted-host=developer.download.nvidia.com\n\n## Add tracking dependencies\nRUN pip install --no-cache-dir lap scipy Cython --trusted-host=developer.download.nvidia.com\nRUN pip install --no-cache-dir cython_bbox --trusted-host=developer.download.nvidia.com\n\n## SEDNA SECTION ##\n\nCOPY ./lib/requirements.txt /home\nRUN pip install --no-cache-dir -r /home/requirements.txt --trusted-host=developer.download.nvidia.com\n\nENV PYTHONPATH \"${PYTHONPATH}:/home/lib\"\n\n# OpenCV\nRUN apt install --no-install-recommends libglib2.0-0 -y && rm -rf /var/lib/apt/lists/*;\n\n## Install S3 library\nRUN pip install --no-cache-dir boto3\n\n# ONNX\nRUN pip install --no-cache-dir onnx protobuf==3.16.0\n\nWORKDIR /home/work\nCOPY ./lib /home/lib\n\nCOPY examples/multiedgeinference/pedestrian_tracking/detection/ /home/work/\n\nENV LOG_LEVEL=\"INFO\"\n\nENTRYPOINT [\"python\"]\nCMD [\"worker.py\"]\n"
}