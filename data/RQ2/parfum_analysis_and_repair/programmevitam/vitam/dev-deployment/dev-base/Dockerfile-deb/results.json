{
  "startTime": 1674215551935,
  "endTime": 1674215553148,
  "originalSmells": [
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 62,
        "lineEnd": 62,
        "columnStart": 4,
        "columnEnd": 138
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 14,
        "lineEnd": 14,
        "columnStart": 39,
        "columnEnd": 79
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 24,
        "lineEnd": 24,
        "columnStart": 22,
        "columnEnd": 84
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 36,
        "lineEnd": 36,
        "columnStart": 7,
        "columnEnd": 33
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 50,
        "lineEnd": 50,
        "columnStart": 39,
        "columnEnd": 65
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 56,
        "lineEnd": 56,
        "columnStart": 39,
        "columnEnd": 62
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 76,
        "lineEnd": 76,
        "columnStart": 22,
        "columnEnd": 55
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 81,
        "lineEnd": 81,
        "columnStart": 4,
        "columnEnd": 37
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 83,
        "lineEnd": 83,
        "columnStart": 4,
        "columnEnd": 49
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 85,
        "lineEnd": 85,
        "columnStart": 4,
        "columnEnd": 44
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 86,
        "lineEnd": 86,
        "columnStart": 4,
        "columnEnd": 29
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 90,
        "lineEnd": 90,
        "columnStart": 39,
        "columnEnd": 65
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 95,
        "lineEnd": 95,
        "columnStart": 22,
        "columnEnd": 57
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 100,
        "lineEnd": 100,
        "columnStart": 39,
        "columnEnd": 65
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 126,
        "lineEnd": 126,
        "columnStart": 4,
        "columnEnd": 66
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 156,
        "lineEnd": 156,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 81,
        "lineEnd": 81,
        "columnStart": 4,
        "columnEnd": 37
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 83,
        "lineEnd": 83,
        "columnStart": 4,
        "columnEnd": 49
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 85,
        "lineEnd": 85,
        "columnStart": 4,
        "columnEnd": 44
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 86,
        "lineEnd": 86,
        "columnStart": 4,
        "columnEnd": 29
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 126,
        "lineEnd": 126,
        "columnStart": 4,
        "columnEnd": 66
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 156,
        "lineEnd": 156,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 14,
        "lineEnd": 14,
        "columnStart": 39,
        "columnEnd": 79
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 24,
        "lineEnd": 24,
        "columnStart": 22,
        "columnEnd": 84
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 50,
        "lineEnd": 50,
        "columnStart": 39,
        "columnEnd": 65
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 56,
        "lineEnd": 56,
        "columnStart": 39,
        "columnEnd": 62
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 76,
        "lineEnd": 76,
        "columnStart": 22,
        "columnEnd": 55
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 81,
        "lineEnd": 81,
        "columnStart": 4,
        "columnEnd": 37
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 83,
        "lineEnd": 83,
        "columnStart": 4,
        "columnEnd": 49
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 85,
        "lineEnd": 85,
        "columnStart": 4,
        "columnEnd": 44
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 86,
        "lineEnd": 86,
        "columnStart": 4,
        "columnEnd": 29
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 90,
        "lineEnd": 90,
        "columnStart": 39,
        "columnEnd": 65
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 95,
        "lineEnd": 95,
        "columnStart": 22,
        "columnEnd": 57
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 100,
        "lineEnd": 100,
        "columnStart": 39,
        "columnEnd": 65
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 126,
        "lineEnd": 126,
        "columnStart": 4,
        "columnEnd": 66
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 156,
        "lineEnd": 156,
        "columnStart": 4,
        "columnEnd": 27
      }
    }
  ],
  "repairedSmells": [
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 81,
        "lineEnd": 81,
        "columnStart": 4,
        "columnEnd": 61
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 83,
        "lineEnd": 83,
        "columnStart": 4,
        "columnEnd": 73
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 85,
        "lineEnd": 85,
        "columnStart": 4,
        "columnEnd": 67
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 86,
        "lineEnd": 86,
        "columnStart": 4,
        "columnEnd": 53
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 126,
        "lineEnd": 126,
        "columnStart": 4,
        "columnEnd": 90
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 156,
        "lineEnd": 156,
        "columnStart": 4,
        "columnEnd": 51
      }
    }
  ],
  "repairedDockerfile": "#########################################################################################\n# Dockerfile to build vitam and run on one server\n# Based on Debian\n#\n# Maintained by Vitam Integration Team\n# Image name: vitam/dev-deb-base\n#########################################################################################\n\n# Set the base image to Debian 10\nFROM debian:10.2\nMAINTAINER French Prime minister Office/SGMAP/DINSIC/Vitam Program <contact.vitam@culture.gouv.fr>\n\n#ENV DEBIAN_FRONTEND noninteractive\n\nRUN apt-get clean && apt-get update && apt-get install --no-install-recommends -y apt-utils procps init && rm -rf /var/lib/apt/lists/*;\n\n# Make sure the package repository and packages are up to date.\n\nCOPY deb/buster-backports.list /etc/apt/sources.list.d\n\nRUN apt-get clean && apt-get update && apt-get upgrade -y\n\nRUN apt-get remove -y openjdk*\n\nRUN apt-get update && apt-get install --no-install-recommends -t buster-backports -y openjdk-11-jdk-headless && rm -rf /var/lib/apt/lists/*;\n\n#RUN apt-get install -y systemd-sysv\n\n################################  Configure systemd  ###############################\n\n# Hint for systemd that we are running inside a container\nENV container docker\nENV LC_ALL C\nENV DEBIAN_FRONTEND noninteractive\n\nRUN apt-get update \\\n    && apt-get install --no-install-recommends -y systemd \\\n    && apt-get clean \\\n    && rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/*\n\nRUN rm -f /lib/systemd/system/multi-user.target.wants/* \\\n    /etc/systemd/system/*.wants/* \\\n    /lib/systemd/system/local-fs.target.wants/* \\\n    /lib/systemd/system/sockets.target.wants/*udev* \\\n    /lib/systemd/system/sockets.target.wants/*initctl* \\\n    /lib/systemd/system/sysinit.target.wants/systemd-tmpfiles-setup* \\\n    /lib/systemd/system/systemd-update-utmp*\n\n################################  Install build tools (rpm / maven / java)  ###############################\n\nRUN apt-get clean && apt-get update && apt-get install --no-install-recommends -y openssl && rm -rf /var/lib/apt/lists/*;\n\n# to bypass the \"trustAnchors parameter must be non-empty\" problem\n# See http://stackoverflow.com/questions/6784463/error-trustanchors-parameter-must-be-non-empty\nRUN /var/lib/dpkg/info/ca-certificates-java.postinst configure\n\nRUN apt-get clean && apt-get update && apt-get install --no-install-recommends -y curl && apt-get clean && rm -rf /var/lib/apt/lists/*;\n\n# Add Java to path\nENV JAVA_HOME /usr/lib/jvm/java-11-openjdk-amd64\n\n# Install & configure maven\nRUN curl -f -k https://repo.maven.apache.org/maven2/org/apache/maven/apache-maven/3.3.9/apache-maven-3.3.9-bin.tar.gz --output /tmp/maven.tgz \\\n   && tar xvzf /tmp/maven.tgz --directory /opt \\\n   && rm -f /tmp/maven.tgz \\\n   && ln -s /opt/apache-maven-3.3.9 /opt/maven \\\n   && mkdir -p /devhome/.m2 \\\n   && chmod -R 777 /devhome\n\n# Add Maven & java to path\nENV M2_HOME /opt/maven\nENV PATH ${M2_HOME}/bin:${JAVA_HOME}/bin:${PATH}\n\n################################  Install ansible  ###############################\n# for sudo in automatic deployment ; note : ansible needs epel repo\n\nRUN apt-get update && apt-get install --no-install-recommends -y sudo net-tools \\\n  && apt-get clean && rm -rf /var/lib/apt/lists/*;\n\n\n# Editor & unzip\nRUN apt-get install --no-install-recommends -y vim unzip wget && rm -rf /var/lib/apt/lists/*;\n\nRUN apt-get install --no-install-recommends -y -t buster-backports golang && rm -rf /var/lib/apt/lists/*;\n\nRUN apt-get install --no-install-recommends -y node-gyp libnode-dev && \\\n    apt-get install --no-install-recommends -y nodejs && rm -rf /var/lib/apt/lists/*;\n# symbolic link is not necessary anymore\n# RUN apt-get -t buster-backports -y install ansible\n\nRUN apt-get clean && apt-get update && apt-get install --no-install-recommends -y git vim && rm -rf /var/lib/apt/lists/*;\n\n##################################  Declare local deb repo  #################################\n\n# Note : declare at the end ; else other commands will fail.\nRUN apt-get update && apt-get install --no-install-recommends -y dpkg-dev gnupg2 \\\n    && apt-get clean && rm -rf /var/lib/apt/lists/*;\n\nCOPY deb/ansible.list /etc/apt/sources.list.d/ansible.list\nRUN apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --recv-keys 93C4A3FD7BB9C367\nRUN apt-get clean && apt-get update && apt-get install --no-install-recommends -y ansible && rm -rf /var/lib/apt/lists/*;\n\nCOPY deb/local.list /etc/apt/sources.list.d/local.list\n\n################################## Add dev helpers #################################\n\nCOPY deb/vitam-build-repo /usr/bin\nCOPY vitam-deploy /usr/bin\nCOPY vitam-deploy-extra /usr/bin\nCOPY deb/vitam-maven-build-only /usr/bin\nCOPY vitam-redeploy /usr/bin\nCOPY vitam-redeploy-extra /usr/bin\nCOPY vitam-command /usr/bin\nRUN  chmod a+x /usr/bin/vitam-*\n\n# KWA review : Why remove this script ?\nCOPY deb/profile-build-repo.sh /etc/profile.d\nCOPY profile-prompt-usage.sh /etc/profile.d\nCOPY .bashrc /devhome\nCOPY vitam-usage.txt /etc\nCOPY deb/sudo-nopwd /etc/sudoers.d\nRUN chmod 664 /etc/sudoers.d/sudo-nopwd\n\nENV TERM xterm\n\n# If we don't install openjdk a 2nd time, sometimes it doesn't work, why ???\nRUN apt-get install --no-install-recommends -t buster-backports -y openjdk-11-jdk-headless && rm -rf /var/lib/apt/lists/*;\n\n##################################  CONTAINER SETTINGS  #################################\n\nVOLUME [ \"/sys/fs/cgroup\" ]\nVOLUME [ \"/code\" ]\nVOLUME [ \"/devhome/.m2\" ]\n\nWORKDIR /code\n\n#ENV DEBIAN_FRONTEND teletype\n\n# Entry Point to systemd init\nCMD [\"/sbin/init\"]\n\nCOPY vitam-stop /usr/bin\nCOPY vitam-start /usr/bin\nCOPY vitam-restart /usr/bin\nCOPY vitam-bench-ingest /usr/bin\nCOPY vitam-mongo-cli /usr/bin\nCOPY vitam-mongo-cli-rs /usr/bin\nCOPY deb/vitam-recreate-repo /usr/bin\n\nRUN  chmod a+x /usr/bin/vitam-*\n\n# System tuning for elasticsearch\nRUN echo \"vm.max_map_count = 262144\" >> /etc/sysctl.conf\n\nCOPY deb/vitam-build-griffins /usr/bin\n\nRUN apt-get install --no-install-recommends -y gawk && rm -rf /var/lib/apt/lists/*;\n"
}