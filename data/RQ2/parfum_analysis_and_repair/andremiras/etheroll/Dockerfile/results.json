{
  "startTime": 1674216791182,
  "endTime": 1674216792652,
  "originalSmells": [
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 28,
        "lineEnd": 28,
        "columnStart": 4,
        "columnEnd": 53
      }
    },
    {
      "rule": "yarnCacheCleanAfterInstall",
      "position": {
        "lineStart": 36,
        "lineEnd": 36,
        "columnStart": 12,
        "columnEnd": 30
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 10,
        "lineEnd": 19,
        "columnStart": 34,
        "columnEnd": 11
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 30,
        "lineEnd": 30,
        "columnStart": 37,
        "columnEnd": 83
      }
    }
  ],
  "repairedSmells": [
    {
      "rule": "yarnCacheCleanAfterInstall",
      "position": {
        "lineStart": 36,
        "lineEnd": 36,
        "columnStart": 34,
        "columnEnd": 50
      }
    }
  ],
  "repairedDockerfile": "# Docker image for installing dependencies & running tests.\n# Build with:\n# docker build --tag=andremiras/etheroll-js .\n# Run with:\n# docker run andremiras/etheroll-js /bin/sh -c 'make test CI=1'\n# Or for interactive shell:\n# docker run -it --rm andremiras/etheroll-js\nFROM ubuntu:18.04 as base\n\n# install dependencies and configure locale\nRUN apt update -qq > /dev/null && apt --yes install --no-install-recommends \\\n    build-essential \\\n    ca-certificates \\\n    curl \\\n    git \\\n    gnupg \\\n    locales \\\n    make \\\n    nodejs \\\n    python3 \\\n    && locale-gen en_US.UTF-8 \\\n    && apt --yes autoremove && apt --yes clean && rm -rf /var/lib/apt/lists/*;\n\nENV LANG=\"en_US.UTF-8\" \\\n    LANGUAGE=\"en_US.UTF-8\" \\\n    LC_ALL=\"en_US.UTF-8\"\n\n# install yarn\nRUN curl -f -sS https://dl.yarnpkg.com/debian/pubkey.gpg | apt-key add - \\\n    && echo \"deb https://dl.yarnpkg.com/debian/ stable main\" | tee /etc/apt/sources.list.d/yarn.list \\\n    && apt update -qq > /dev/null && apt --yes install --no-install-recommends yarn && rm -rf /var/lib/apt/lists/*;\n\nWORKDIR /app\nCOPY . /app\n\nFROM base as full\nRUN make && yarn build-staging && yarn cache clean;\n\n# prod environment\nFROM nginx:1.17.10 as prod\nCOPY default.conf.template /etc/nginx/conf.d/default.conf.template\nCOPY --from=full /app/build /usr/share/nginx/html\nCMD /bin/bash -c \"envsubst '\\$PORT' < /etc/nginx/conf.d/default.conf.template > /etc/nginx/conf.d/default.conf\" && nginx -g 'daemon off;'\n"
}