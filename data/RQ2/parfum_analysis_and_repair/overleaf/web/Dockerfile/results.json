{
  "startTime": 1674216025334,
  "endTime": 1674216026313,
  "originalSmells": [
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 9,
        "lineEnd": 9,
        "columnStart": 4,
        "columnEnd": 31
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "# the base image is suitable for running web with /app bind mounted\nFROM node:12.22.3 as base\n\nWORKDIR /app\n\n# install_deps changes app files and installs npm packages\n# as such it has to run at a later stage\n\nRUN apt-get update \\\n&& apt-get install --no-install-recommends -y parallel \\\n&& rm -rf /var/lib/apt/lists/*\n\nRUN mkdir /app/node_modules && chown node:node /app/node_modules\n\n# the deps image is used for caching npm ci\nFROM base as deps\n\nCOPY package.json package-lock.json /app/\n\nRUN npm ci --quiet\n\n\n# the dev is suitable for running tests\nFROM deps as dev\n\nCOPY . /app\n\nRUN mkdir -p /app/data/dumpFolder && \\\n  mkdir -p /app/data/logs && \\\n  mkdir -p /app/data/pdf && \\\n  mkdir -p /app/data/uploads && \\\n  mkdir -p /app/data/zippedProjects && \\\n  chmod -R 0755 /app/data/ && \\\n  chown -R node:node /app/data/\n\nARG SENTRY_RELEASE\nENV SENTRY_RELEASE=$SENTRY_RELEASE\n\nUSER node\n\n\n# the webpack image has deps+src+webpack artifacts\nFROM dev as webpack\n\nUSER root\nRUN chmod 0755 ./install_deps.sh && ./install_deps.sh\n\n\n# the final production image without webpack source maps\nFROM webpack as app\n\nRUN find /app/public -name '*.js.map' -delete\nRUN rm /app/modules/server-ce-scripts -rf\nUSER node\n\nCMD [\"node\", \"--expose-gc\", \"app.js\"]\n"
}