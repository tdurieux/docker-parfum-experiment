{
  "startTime": 1674250248136,
  "endTime": 1674250248570,
  "originalSmells": [
    {
      "rule": "npmCacheCleanAfterInstall",
      "position": {
        "lineStart": 29,
        "lineEnd": 29,
        "columnStart": 31,
        "columnEnd": 42
      }
    },
    {
      "rule": "apkAddUseNoCache",
      "position": {
        "lineStart": 21,
        "lineEnd": 21,
        "columnStart": 4,
        "columnEnd": 28
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "###############################################################################\n# Copyright 2019 IBM Corp. All Rights Reserved.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n################################################################################\n#######################################\n# Build the preliminary image\n#######################################\nFROM node:12-alpine as buildImg\n\nRUN apk update\nRUN apk add --no-cache python3 make g++\n\n\nUSER node\nWORKDIR /home/node\n\nCOPY --chown=node .build/bundle /home/node/app\n\nRUN cd app/programs/server/ && npm install && npm cache clean --force;\n\n#######################################\n# Build the production image\n#######################################\nFROM node:12-alpine\nLABEL maintainer=\"Michael McKay <mckaymic@us.ibm.com>\"\n\nUSER node\nWORKDIR /home/node\n\nARG BUILD_ID\nARG LAST_COMMIT_ID\nENV BUILD_ID=\"${BUILD_ID}\"\nENV LAST_COMMIT_ID=\"${LAST_COMMIT_ID}\"\nENV PORT=\"${PORT:-3000}\"\nENV NODE_ENV=\"production\"\n\nRUN mkdir -p /home/node/app\nCOPY --chown=node --from=buildImg /home/node /home/node\n\nEXPOSE \"${PORT}\"\nCMD [\"node\", \"/home/node/app/main.js\"]\n"
}