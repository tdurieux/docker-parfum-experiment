{
  "startTime": 1674255171218,
  "endTime": 1674255172057,
  "originalSmells": [
    {
      "rule": "configureShouldUseBuildFlag",
      "position": {
        "lineStart": 29,
        "lineEnd": 29,
        "columnStart": 4,
        "columnEnd": 59
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 7,
        "lineEnd": 10,
        "columnStart": 4,
        "columnEnd": 28
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 46,
        "lineEnd": 50,
        "columnStart": 4,
        "columnEnd": 40
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "FROM debian:buster as build\n\nENV LANG C.UTF-8\nENV DEBIAN_FRONTEND=noninteractive\n\nRUN --mount=type=cache,id=apt-build,target=/var/apt/cache \\\n    apt-get update && \\\n    apt-get install --no-install-recommends --yes \\\n        python3 python3-dev python3-setuptools python3-pip python3-venv \\\n        build-essential swig libatlas-base-dev portaudio19-dev \\\n        curl ca-certificates && rm -rf /var/lib/apt/lists/*;\n\nENV APP_DIR=/usr/lib/voice2json\nENV BUILD_DIR=/build\n\n# Directory of prebuilt tools\nARG TARGETARCH\nARG TARGETVARIANT\nCOPY download/shared ${BUILD_DIR}/download/\nCOPY download/${TARGETARCH}${TARGETVARIANT}/ ${BUILD_DIR}/download/\n\nCOPY m4/ ${BUILD_DIR}/m4/\nCOPY configure config.sub config.guess \\\n     install-sh missing aclocal.m4 \\\n     Makefile.in setup.py.in voice2json.sh.in voice2json.spec.in \\\n     requirements.txt \\\n     ${BUILD_DIR}/\n\nRUN cd ${BUILD_DIR} && \\\n    ./configure --build=\"$(dpkg-architecture --query DEB_BUILD_GNU_TYPE)\" --enable-in-place --prefix=${APP_DIR}/.venv\n\nCOPY scripts/install/ ${BUILD_DIR}/scripts/install/\n\nRUN --mount=type=cache,id=pip-build,target=/root/.cache/pip \\\n    cd ${BUILD_DIR} && \\\n    make && \\\n    make install\n\n# -----------------------------------------------------------------------------\n\nFROM debian:buster as run\n\nENV LANG C.UTF-8\n\nRUN --mount=type=cache,id=apt-run,target=/var/apt/cache \\\n    apt-get update && \\\n    apt-get install --yes --no-install-recommends \\\n        python3 \\\n        libportaudio2 libatlas3-base libgfortran4 \\\n        ca-certificates \\\n        perl sox alsa-utils espeak-ng jq && rm -rf /var/lib/apt/lists/*;\n\nENV APP_DIR=/usr/lib/voice2json\nCOPY --from=build ${APP_DIR}/ ${APP_DIR}/\nCOPY --from=build /build/voice2json.sh ${APP_DIR}/\n\nCOPY etc/profile.defaults.yml ${APP_DIR}/etc/\nCOPY etc/profiles/ ${APP_DIR}/etc/profiles/\nCOPY etc/precise/ ${APP_DIR}/etc/precise/\nCOPY site/ ${APP_DIR}/site/\nCOPY bin/voice2json ${APP_DIR}/bin/\n\nCOPY VERSION ${APP_DIR}/\nCOPY voice2json/ ${APP_DIR}/voice2json/\n\nENTRYPOINT [\"bash\", \"/usr/lib/voice2json/voice2json.sh\"]\n"
}