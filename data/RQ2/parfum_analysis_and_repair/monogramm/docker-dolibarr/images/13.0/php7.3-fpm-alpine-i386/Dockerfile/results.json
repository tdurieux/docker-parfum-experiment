{
  "startTime": 1674255667081,
  "endTime": 1674255667849,
  "originalSmells": [
    {
      "rule": "mkdirUsrSrcThenRemove",
      "position": {
        "lineStart": 120,
        "lineEnd": 120,
        "columnStart": 1,
        "columnEnd": 28
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "FROM i386/php:7.3-fpm-alpine\n\n# Install the packages we need\n# Install the PHP extensions we need\n# see https://wiki.dolibarr.org/index.php/Dependencies_and_external_libraries\n# Prepare folders\nRUN set -ex; \\\n\tapk add --no-cache \\\n\t\tbzip2 \\\n\t\ticu-libs \\\n\t\timagemagick \\\n\t\tlibldap \\\n\t\tlibpq \\\n\t\tlibpng \\\n\t\tmysql-client \\\n\t\trsync \\\n\t\tssmtp \\\n\t\tshadow \\\n\t\tunzip \\\n\t\tzip \\\n\t; \\\n\tapk add --no-cache --virtual .build-deps \\\n\t\t$PHPIZE_DEPS \\\n\t\tautoconf \\\n\t\tcurl-dev \\\n\t\tfreetype-dev \\\n\t\tgcc \\\n\t\tg++ \\\n\t\ticu-dev \\\n\t\tlibjpeg-turbo-dev \\\n\t\timagemagick-dev \\\n\t\timagemagick-libs \\\n\t\tlibmcrypt-dev \\\n\t\tlibpng-dev \\\n\t\tlibtool \\\n\t\tlibxml2-dev \\\n\t\tlibzip-dev \\\n\t\tmake \\\n\t\topenldap-dev \\\n\t\tpostgresql-dev \\\n\t\tpostgresql-libs \\\n\t\tunzip \\\n\t\tzlib-dev \\\n\t; \\\n\tdocker-php-ext-configure ldap; \\\n\tdocker-php-ext-configure gd --with-freetype-dir=/usr --with-png-dir=/usr --with-jpeg-dir=/usr; \\\n\tdocker-php-ext-configure intl; \\\n\tdocker-php-ext-configure zip; \\\n\tdocker-php-ext-install -j \"$(nproc)\" \\\n\t\tcalendar \\\n\t\tgd \\\n\t\tintl \\\n\t\tldap \\\n\t\tmbstring \\\n\t\tmysqli \\\n\t\tpdo \\\n\t\tpdo_mysql \\\n\t\tpdo_pgsql \\\n\t\tpgsql \\\n\t\tsoap \\\n\t\tzip \\\n\t; \\\n\tpecl install imagick; \\\n\tdocker-php-ext-enable imagick; \\\n\tapk --purge del .build-deps; \\\n\trm -rf /var/cache/apk/*; \\\n\tmkdir -p /var/www/documents; \\\n\tchown -R www-data:root /var/www; \\\n\tchmod -R g=u /var/www\n\nVOLUME /var/www/html /var/www/documents /var/www/scripts\n\n# Runtime env var\nENV DOLI_AUTO_CONFIGURE=1 \\\n\tDOLI_DB_TYPE=mysqli \\\n\tDOLI_DB_HOST= \\\n\tDOLI_DB_PORT=3306 \\\n\tDOLI_DB_USER=dolibarr \\\n\tDOLI_DB_PASSWORD='' \\\n\tDOLI_DB_NAME=dolibarr \\\n\tDOLI_DB_PREFIX=llx_ \\\n\tDOLI_DB_CHARACTER_SET=utf8 \\\n\tDOLI_DB_COLLATION=utf8_unicode_ci \\\n\tDOLI_DB_ROOT_LOGIN='' \\\n\tDOLI_DB_ROOT_PASSWORD='' \\\n\tDOLI_ADMIN_LOGIN=admin \\\n\tDOLI_MODULES='' \\\n\tDOLI_URL_ROOT='http://localhost' \\\n\tDOLI_AUTH=dolibarr \\\n\tDOLI_LDAP_HOST= \\\n\tDOLI_LDAP_PORT=389 \\\n\tDOLI_LDAP_VERSION=3 \\\n\tDOLI_LDAP_SERVERTYPE=openldap \\\n\tDOLI_LDAP_LOGIN_ATTRIBUTE=uid \\\n\tDOLI_LDAP_DN='' \\\n\tDOLI_LDAP_FILTER='' \\\n\tDOLI_LDAP_ADMIN_LOGIN='' \\\n\tDOLI_LDAP_ADMIN_PASS='' \\\n\tDOLI_LDAP_DEBUG=false \\\n\tDOLI_HTTPS=0 \\\n\tDOLI_PROD=0 \\\n\tDOLI_NO_CSRF_CHECK=0 \\\n\tWWW_USER_ID=82 \\\n\tWWW_GROUP_ID=82 \\\n\tPHP_INI_DATE_TIMEZONE='UTC' \\\n\tPHP_MEMORY_LIMIT=256M \\\n\tPHP_MAX_UPLOAD=20M \\\n\tPHP_MAX_EXECUTION_TIME=300\n\n# Build time env var\nARG DOLI_VERSION=13.0.4\n\n# Get Dolibarr\nADD https://github.com/Dolibarr/dolibarr/archive/${DOLI_VERSION}.zip /tmp/dolibarr.zip\n\n# Install Dolibarr from tag archive\nRUN set -ex; \\\n\tmkdir -p /tmp/dolibarr; \\\n\tunzip -q /tmp/dolibarr.zip -d /tmp/dolibarr; \\\n\trm /tmp/dolibarr.zip; \\\n\tmkdir -p /usr/src/dolibarr; rm -rf /usr/src/dolibarr \\\n\tcp -r \"/tmp/dolibarr/dolibarr-${DOLI_VERSION}\"/* /usr/src/dolibarr; \\\n\trm -rf /tmp/dolibarr; \\\n\tchmod +x /usr/src/dolibarr/scripts/*; \\\n\techo \"${DOLI_VERSION}\" > /usr/src/dolibarr/.docker-image-version\n\nCOPY entrypoint.sh /\nRUN set -ex; \\\n\tchmod 755 /entrypoint.sh\n\nENTRYPOINT [\"/entrypoint.sh\"]\nCMD [\"php-fpm\"]\n\n# Arguments to label built container\nARG VCS_REF\nARG BUILD_DATE\n\n# Container labels (http://label-schema.org/)\n# Container annotations (https://github.com/opencontainers/image-spec)\nLABEL maintainer=\"Monogramm maintainers <opensource at monogramm dot io>\" \\\n\t  product=\"Dolibarr\" \\\n\t  version=${DOLI_VERSION} \\\n\t  org.label-schema.vcs-ref=${VCS_REF} \\\n\t  org.label-schema.vcs-url=\"https://github.com/Monogramm/docker-dolibarr\" \\\n\t  org.label-schema.build-date=$BUILD_DATE \\\n\t  org.label-schema.name=\"Dolibarr\" \\\n\t  org.label-schema.description=\"Open Source ERP & CRM for Business\" \\\n\t  org.label-schema.url=\"https://www.dolibarr.org/\" \\\n\t  org.label-schema.vendor=\"Dolibarr\" \\\n\t  org.label-schema.version=${DOLI_VERSION} \\\n\t  org.label-schema.schema-version=\"1.0\" \\\n\t  org.opencontainers.image.revision=${VCS_REF} \\\n\t  org.opencontainers.image.source=\"https://github.com/Monogramm/docker-dolibarr\" \\\n\t  org.opencontainers.image.created=${BUILD_DATE} \\\n\t  org.opencontainers.image.title=\"Dolibarr\" \\\n\t  org.opencontainers.image.description=\"Open Source ERP & CRM for Business\" \\\n\t  org.opencontainers.image.url=\"https://www.dolibarr.org/\" \\\n\t  org.opencontainers.image.vendor=\"Dolibarr\" \\\n\t  org.opencontainers.image.version=${DOLI_VERSION} \\\n\t  org.opencontainers.image.authors=\"Monogramm maintainers <opensource at monogramm dot io>\"\n"
}