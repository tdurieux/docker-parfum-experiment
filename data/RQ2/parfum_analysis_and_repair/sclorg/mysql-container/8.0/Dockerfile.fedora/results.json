{
  "startTime": 1674249113558,
  "endTime": 1674249115978,
  "originalSmells": [
    {
      "rule": "yumInstallRmVarCacheYum",
      "position": {
        "lineStart": 45,
        "lineEnd": 45,
        "columnStart": 4,
        "columnEnd": 56
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "FROM quay.io/fedora/s2i-core:35\n\n# MySQL image for OpenShift.\n#\n# Volumes:\n#  * /var/lib/mysql/data - Datastore for MySQL\n# Environment:\n#  * $MYSQL_USER - Database user name\n#  * $MYSQL_PASSWORD - User's password\n#  * $MYSQL_DATABASE - Name of the database to create\n#  * $MYSQL_ROOT_PASSWORD (Optional) - Password for the 'root' MySQL account\n\nENV MYSQL_VERSION=8.0 \\\n    APP_DATA=/opt/app-root/src \\\n    HOME=/var/lib/mysql\n\nENV SUMMARY=\"MySQL $MYSQL_VERSION SQL database server\" \\\n    DESCRIPTION=\"MySQL is a multi-user, multi-threaded SQL database server. The container \\\nimage provides a containerized packaging of the MySQL mysqld daemon and client application. \\\nThe mysqld server daemon accepts connections from clients and provides access to content from \\\nMySQL databases on behalf of the clients.\" \\\n    NAME=mysql\n\nLABEL summary=\"$SUMMARY\" \\\n      description=\"$DESCRIPTION\" \\\n      io.k8s.description=\"$DESCRIPTION\" \\\n      io.k8s.display-name=\"MySQL $MYSQL_VERSION\" \\\n      io.openshift.expose-services=\"3306:mysql\" \\\n      io.openshift.tags=\"database,mysql,mysql80,rh-mysql80\" \\\n      com.redhat.component=\"$NAME\" \\\n      name=\"fedora/$NAME-80\" \\\n      version=\"$MYSQL_VERSION\" \\\n      usage=\"docker run -d -e MYSQL_USER=user -e MYSQL_PASSWORD=pass -e MYSQL_DATABASE=db -p 3306:3306 quay.io/fedora/$NAME-80\" \\\n      maintainer=\"SoftwareCollections.org <sclorg@redhat.com>\"\n\nEXPOSE 3306\n\n# On Fedora, we fake missing python binary. In case user installs the python2\n# in the container, this hack will be removed by installing /usr/bin/python from RPM.\nRUN ln -s /usr/bin/python3 /usr/bin/python\n\n# This image must forever use UID 27 for mysql user so our volumes are\n# safe in the future. This should *never* change, the last test is there\n# to make sure of that.\nRUN INSTALL_PKGS=\"rsync tar gettext hostname bind-utils groff-base community-mysql-server policycoreutils\" && \\\n    yum install -y --setopt=tsflags=nodocs $INSTALL_PKGS && \\\n    rpm -V $INSTALL_PKGS && \\\n    yum -y clean all --enablerepo='*' && \\\n    mkdir -p /var/lib/mysql/data && chown -R mysql.0 /var/lib/mysql && \\\n    test \"$(id mysql)\" = \"uid=27(mysql) gid=27(mysql) groups=27(mysql)\" && rm -rf /var/cache/yum\n\n# Get prefix path and path to scripts rather than hard-code them in scripts\nENV CONTAINER_SCRIPTS_PATH=/usr/share/container-scripts/mysql \\\n    MYSQL_PREFIX=/usr\n\nCOPY 8.0/root-common /\nCOPY 8.0/s2i-common/bin/ $STI_SCRIPTS_PATH\nCOPY 8.0/root /\n\n# this is needed due to issues with squash\n# when this directory gets rm'd by the container-setup\n# script.\n# Also reset permissions of filesystem to default values\nRUN rm -rf /etc/my.cnf.d/* && \\\n    /usr/libexec/container-setup && \\\n    rpm-file-permissions\n\n# Not using VOLUME statement since it's not working in OpenShift Online:\n# https://github.com/sclorg/httpd-container/issues/30\n# VOLUME [\"/var/lib/mysql/data\"]\n\nUSER 27\n\nENTRYPOINT [\"container-entrypoint\"]\nCMD [\"run-mysqld\"]\n"
}