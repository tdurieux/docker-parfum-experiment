{
  "startTime": 1674252684108,
  "endTime": 1674252685410,
  "originalSmells": [
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 83,
        "lineEnd": 83,
        "columnStart": 4,
        "columnEnd": 49
      }
    },
    {
      "rule": "yumInstallRmVarCacheYum",
      "position": {
        "lineStart": 47,
        "lineEnd": 47,
        "columnStart": 4,
        "columnEnd": 37
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "# This image provides a Python 3.8 environment you can use to run your Python\n# applications.\nFROM quay.io/centos7/s2i-base-centos7\n\nEXPOSE 8080\n\nENV PYTHON_VERSION=3.8 \\\n    PYTHON_SCL_VERSION=38 \\\n    PATH=$PATH:/opt/rh/rh-python38/root/usr/bin:$HOME/.local/bin/:/opt/rh/$NODEJS_SCL/root/usr/bin:/opt/rh/httpd24/root/usr/bin:/opt/rh/python38/root/usr/bin:/opt/rh/httpd24/root/usr/sbin:/opt/rh/rh-python38/root/usr/local/bin \\\n    LD_LIBRARY_PATH=/opt/rh/rh-python38/root/usr/lib64:/opt/rh/$NODEJS_SCL/root/usr/lib64:/opt/rh/httpd24/root/usr/lib64:/opt/rh/python38/root/usr/lib64 \\\n    LIBRARY_PATH=/opt/rh/httpd24/root/usr/lib64 \\\n    X_SCLS=rh-python38 \\\n    MANPATH=/opt/rh/rh-python38/root/usr/share/man:/opt/rh/python38/root/usr/share/man:/opt/rh/httpd24/root/usr/share/man:/opt/rh/$NODEJS_SCL/root/usr/share/man \\\n    VIRTUAL_ENV=/opt/app-root \\\n    PYTHONPATH=/opt/rh/$NODEJS_SCL/root/usr/lib/python2.7/site-packages \\\n    XDG_DATA_DIRS=/opt/rh/python38/root/usr/share:/opt/rh/rh-python38/root/usr/share:/usr/local/share:/usr/share \\\n    PKG_CONFIG_PATH=/opt/rh/python38/root/usr/lib64/pkgconfig:/opt/rh/httpd24/root/usr/lib64/pkgconfig:/opt/rh/rh-python38/root/usr/lib64/pkgconfig \\\n    PYTHONUNBUFFERED=1 \\\n    PYTHONIOENCODING=UTF-8 \\\n    LC_ALL=en_US.UTF-8 \\\n    LANG=en_US.UTF-8 \\\n    PIP_NO_CACHE_DIR=off\n\nENV SUMMARY=\"Platform for building and running Python $PYTHON_VERSION applications\" \\\n    DESCRIPTION=\"Python $PYTHON_VERSION available as container is a base platform for \\\nbuilding and running various Python $PYTHON_VERSION applications and frameworks. \\\nPython is an easy to learn, powerful programming language. It has efficient high-level \\\ndata structures and a simple but effective approach to object-oriented programming. \\\nPython's elegant syntax and dynamic typing, together with its interpreted nature, \\\nmake it an ideal language for scripting and rapid application development in many areas \\\non most platforms.\"\n\nLABEL summary=\"$SUMMARY\" \\\n      description=\"$DESCRIPTION\" \\\n      io.k8s.description=\"$DESCRIPTION\" \\\n      io.k8s.display-name=\"Python 3.8\" \\\n      io.openshift.expose-services=\"8080:http\" \\\n      io.openshift.tags=\"builder,python,python38,python-38,rh-python38\" \\\n      com.redhat.component=\"python38-container\" \\\n      name=\"centos7/python-38-centos7\" \\\n      version=\"1\" \\\n      usage=\"s2i build https://github.com/sclorg/s2i-python-container.git --context-dir=3.8/test/setup-test-app/ centos7/python-38-centos7 python-sample-app\" \\\n      maintainer=\"SoftwareCollections.org <sclorg@redhat.com>\"\n\nRUN INSTALL_PKGS=\"rh-python38 rh-python38-python-devel rh-python38-python-setuptools rh-python38-python-pip nss_wrapper \\\n        httpd24 httpd24-httpd-devel httpd24-mod_ssl httpd24-mod_auth_kerb httpd24-mod_ldap \\\n        httpd24-mod_session atlas-devel gcc-gfortran libffi-devel libtool-ltdl enchant\" && \\\n    yum install -y centos-release-scl && \\\n    yum -y --setopt=tsflags=nodocs install --enablerepo=centosplus $INSTALL_PKGS && \\\n    rpm -V $INSTALL_PKGS && \\\n    # Remove centos-logos (httpd dependency) to keep image size smaller.\n    rpm -e --nodeps centos-logos && \\\n    yum -y clean all --enablerepo='*' && rm -rf /var/cache/yum\n\n# Copy the S2I scripts from the specific language image to $STI_SCRIPTS_PATH.\nCOPY 3.8/s2i/bin/ $STI_SCRIPTS_PATH\n\n# Copy extra files to the image.\nCOPY 3.8/root/ /\n\n# Python 3 only\n# Yes, the directory below is already copied by the previous command.\n# The problem here is that the wheels directory is copied as a symlink.\n# Only if you specify symlink directly as a source, COPY copies all the\n# files from the symlink destination.\nCOPY 3.8/root/opt/wheels /opt/wheels\n# - Create a Python virtual environment for use by any application to avoid\n#   potential conflicts with Python packages preinstalled in the main Python\n#   installation.\n# - In order to drop the root user, we have to make some directories world\n#   writable as OpenShift default security model is to run the container\n#   under random UID.\nRUN source scl_source enable rh-python38 && \\\n    python3.8 -m venv ${APP_ROOT} && \\\n    # Python 3 only code, Python 2 installs pip from PyPI in the assemble script. \\\n    # We have to upgrade pip to a newer verison because: \\\n    # * pip < 9 does not support different packages' versions for Python 2/3 \\\n    # * pip < 19.3 does not support manylinux2014 wheels. Only manylinux2014 (and later) wheels \\\n    #   support platforms like ppc64le, aarch64 or armv7 \\\n    # We are newly using wheel from one of the latest stable Fedora releases (from RPM python-pip-wheel) \\\n    # because it's tested better then whatever version from PyPI and contains useful patches. \\\n    # We have to do it here (in the macro) so the permissions are correctly fixed and pip is able \\\n    # to reinstall itself in the next build phases in the assemble script if user wants the latest version \\\n    ${APP_ROOT}/bin/pip install --no-cache-dir /opt/wheels/pip-* && \\\n    rm -r /opt/wheels && \\\n    chown -R 1001:0 ${APP_ROOT} && \\\n    fix-permissions ${APP_ROOT} -P && \\\n    rpm-file-permissions\n\n\nUSER 1001\n\n# Set the default CMD to print the usage of the language image.\nCMD $STI_SCRIPTS_PATH/usage\n"
}