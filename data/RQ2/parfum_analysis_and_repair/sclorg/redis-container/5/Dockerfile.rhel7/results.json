{
  "startTime": 1674256301405,
  "endTime": 1674256302335,
  "originalSmells": [
    {
      "rule": "yumInstallRmVarCacheYum",
      "position": {
        "lineStart": 47,
        "lineEnd": 47,
        "columnStart": 4,
        "columnEnd": 36
      }
    },
    {
      "rule": "yumInstallRmVarCacheYum",
      "position": {
        "lineStart": 50,
        "lineEnd": 50,
        "columnStart": 4,
        "columnEnd": 56
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "FROM rhscl/s2i-core-rhel7\n\n# Redis image based on Software Collections packages\n#\n# Volumes:\n#  * /var/lib/redis/data - Datastore for Redis\n# Environment:\n#  * $REDIS_PASSWORD - Database password\n\nENV REDIS_VERSION=5 \\\n    HOME=/var/lib/redis\n\nENV SUMMARY=\"Redis in-memory data structure store, used as database, cache and message broker\" \\\n    DESCRIPTION=\"Redis $REDIS_VERSION available as container, is an advanced key-value store. \\\nIt is often referred to as a data structure server since keys can contain strings, hashes, lists, \\\nsets and sorted sets. You can run atomic operations on these types, like appending to a string; \\\nincrementing the value in a hash; pushing to a list; computing set intersection, union and difference; \\\nor getting the member with highest ranking in a sorted set. In order to achieve its outstanding \\\nperformance, Redis works with an in-memory dataset. Depending on your use case, you can persist \\\nit either by dumping the dataset to disk every once in a while, or by appending each command to a log.\"\n\nLABEL summary=\"$SUMMARY\" \\\n      description=\"$DESCRIPTION\" \\\n      io.k8s.description=\"$DESCRIPTION\" \\\n      io.k8s.display-name=\"Redis 5\" \\\n      io.openshift.expose-services=\"6379:redis\" \\\n      io.openshift.tags=\"database,redis,redis5,rh-redis5\" \\\n      com.redhat.component=\"rh-redis5-container\" \\\n      name=\"rhscl/redis-5-rhel7\" \\\n      version=\"5\" \\\n      com.redhat.license_terms=\"https://www.redhat.com/en/about/red-hat-end-user-license-agreements#rhel\" \\\n      usage=\"podman run -d --name redis_database -p 6379:6379 rhscl/redis-5-rhel7\" \\\n      maintainer=\"SoftwareCollections.org <sclorg@redhat.com>\"\n\nEXPOSE 6379\n\n# Create user for redis that has known UID\n# We need to do this before installing the RPMs which would create user with random UID\n# The UID is the one used by the default user from the parent layer (1001),\n# and since the user exists already, do not create a new one, but only rename\n# the existing\n# This image must forever use UID 1001 for redis user so our volumes are\n# safe in the future. This should *never* change, the last test is there\n# to make sure of that.\nRUN getent group  redis & > /dev/null || groupadd -r redis & > /dev/null && \\\n    usermod -l redis -aG redis -c 'Redis Server' default & > /dev/null && \\\n# Install gettext for envsubst command\n    yum install -y yum-utils gettext && \\\n    prepare-yum-repositories rhel-server-rhscl-7-rpms && \\\n    INSTALL_PKGS=\"rh-redis5\" && \\\n    yum install -y --setopt=tsflags=nodocs $INSTALL_PKGS && \\\n    rpm -V $INSTALL_PKGS && \\\n    yum -y clean all --enablerepo='*' && \\\n    mkdir -p /var/lib/redis/data && chown -R redis.0 /var/lib/redis && \\\n    [[ \"$(id redis)\" == \"uid=1001(redis)\"* ]] && rm -rf /var/cache/yum\n\n# Get prefix path and path to scripts rather than hard-code them in scripts\nENV CONTAINER_SCRIPTS_PATH=/usr/share/container-scripts/redis \\\n    REDIS_PREFIX=/opt/rh/rh-redis5/root/usr \\\n    ENABLED_COLLECTIONS=rh-redis5\n\n# When bash is started non-interactively, to run a shell script, for example it\n# looks for this variable and source the content of this file. This will enable\n# the SCL for all scripts without need to do 'scl enable'.\nENV BASH_ENV=${CONTAINER_SCRIPTS_PATH}/scl_enable \\\n    ENV=${CONTAINER_SCRIPTS_PATH}/scl_enable \\\n    PROMPT_COMMAND=\". ${CONTAINER_SCRIPTS_PATH}/scl_enable\"\n\nCOPY root /\n\n# this is needed due to issues with squash\n# when this directory gets rm'd by the container-setup\n# script.\nRUN /usr/libexec/container-setup\n\nVOLUME [\"/var/lib/redis/data\"]\n\n# Using a numeric value because of a comment in [1]:\n# If your S2I image does not include a USER declaration with a numeric user,\n# your builds will fail by default.\n# [1] https://docs.openshift.com/container-platform/4.4/openshift_images/create-images.html#images-create-guide-openshift_create-images\nUSER 1001\n\nENTRYPOINT [\"container-entrypoint\"]\nCMD [\"run-redis\"]\n"
}