{
  "startTime": 1674219646899,
  "endTime": 1674219647990,
  "originalSmells": [
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 21,
        "lineEnd": 21,
        "columnStart": 4,
        "columnEnd": 74
      }
    },
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 49,
        "lineEnd": 49,
        "columnStart": 4,
        "columnEnd": 59
      }
    },
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 81,
        "lineEnd": 81,
        "columnStart": 4,
        "columnEnd": 38
      }
    },
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 90,
        "lineEnd": 90,
        "columnStart": 4,
        "columnEnd": 76
      }
    },
    {
      "rule": "curlUseHttpsUrl",
      "position": {
        "lineStart": 81,
        "lineEnd": 81,
        "columnStart": 4,
        "columnEnd": 38
      }
    },
    {
      "rule": "aptGetInstallUseY",
      "position": {
        "lineStart": 83,
        "lineEnd": 83,
        "columnStart": 4,
        "columnEnd": 72
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 12,
        "lineEnd": 12,
        "columnStart": 4,
        "columnEnd": 97
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 14,
        "lineEnd": 14,
        "columnStart": 4,
        "columnEnd": 67
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 20,
        "lineEnd": 20,
        "columnStart": 4,
        "columnEnd": 23
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 23,
        "lineEnd": 23,
        "columnStart": 4,
        "columnEnd": 46
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 24,
        "lineEnd": 24,
        "columnStart": 4,
        "columnEnd": 112
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 32,
        "lineEnd": 35,
        "columnStart": 4,
        "columnEnd": 111
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 42,
        "lineEnd": 42,
        "columnStart": 4,
        "columnEnd": 46
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 46,
        "lineEnd": 46,
        "columnStart": 4,
        "columnEnd": 64
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 82,
        "lineEnd": 82,
        "columnStart": 4,
        "columnEnd": 113
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 83,
        "lineEnd": 83,
        "columnStart": 4,
        "columnEnd": 72
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 12,
        "lineEnd": 12,
        "columnStart": 4,
        "columnEnd": 97
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 14,
        "lineEnd": 14,
        "columnStart": 4,
        "columnEnd": 67
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 20,
        "lineEnd": 20,
        "columnStart": 4,
        "columnEnd": 23
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 23,
        "lineEnd": 23,
        "columnStart": 4,
        "columnEnd": 46
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 24,
        "lineEnd": 24,
        "columnStart": 4,
        "columnEnd": 112
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 32,
        "lineEnd": 35,
        "columnStart": 4,
        "columnEnd": 111
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 46,
        "lineEnd": 46,
        "columnStart": 4,
        "columnEnd": 64
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 82,
        "lineEnd": 82,
        "columnStart": 4,
        "columnEnd": 113
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 83,
        "lineEnd": 83,
        "columnStart": 4,
        "columnEnd": 72
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 12,
        "lineEnd": 12,
        "columnStart": 4,
        "columnEnd": 97
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 14,
        "lineEnd": 14,
        "columnStart": 4,
        "columnEnd": 67
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 20,
        "lineEnd": 20,
        "columnStart": 4,
        "columnEnd": 23
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 23,
        "lineEnd": 23,
        "columnStart": 4,
        "columnEnd": 46
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 24,
        "lineEnd": 24,
        "columnStart": 4,
        "columnEnd": 112
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 32,
        "lineEnd": 35,
        "columnStart": 4,
        "columnEnd": 111
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 42,
        "lineEnd": 42,
        "columnStart": 4,
        "columnEnd": 46
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 46,
        "lineEnd": 46,
        "columnStart": 4,
        "columnEnd": 64
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 82,
        "lineEnd": 82,
        "columnStart": 4,
        "columnEnd": 113
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 83,
        "lineEnd": 83,
        "columnStart": 4,
        "columnEnd": 72
      }
    }
  ],
  "repairedSmells": [
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 12,
        "lineEnd": 12,
        "columnStart": 4,
        "columnEnd": 121
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 14,
        "lineEnd": 14,
        "columnStart": 4,
        "columnEnd": 91
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 20,
        "lineEnd": 20,
        "columnStart": 4,
        "columnEnd": 47
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 23,
        "lineEnd": 23,
        "columnStart": 4,
        "columnEnd": 70
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 24,
        "lineEnd": 24,
        "columnStart": 4,
        "columnEnd": 136
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 32,
        "lineEnd": 35,
        "columnStart": 4,
        "columnEnd": 110
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 46,
        "lineEnd": 46,
        "columnStart": 4,
        "columnEnd": 88
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 82,
        "lineEnd": 82,
        "columnStart": 4,
        "columnEnd": 137
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 83,
        "lineEnd": 83,
        "columnStart": 4,
        "columnEnd": 99
      }
    }
  ],
  "repairedDockerfile": "# Dockerfile for OffWorld-Gym Remote Env Server.\n# Encapsulates ROS to allow for less user installation fuss and parallel Gazebo environments on a single host\n\n# FROM nvidia/cuda:11.6.0-devel-ubuntu20.04\nFROM ubuntu:20.04\n\n# set the image timezone to be UTC\nENV TZ=UTC\nRUN ln -snf /usr/share/zoneinfo/$TZ /etc/localtime && echo $TZ > /etc/timezone\n\n# Install Ubuntu system level dependecies\nRUN apt-get update -y\nRUN apt-get install --no-install-recommends -y -q gnupg2 apt-utils lsb-core lsb-release software-properties-common dialog && rm -rf /var/lib/apt/lists/*;\nRUN apt-get clean all\nRUN apt-get install --no-install-recommends -y -q nano net-tools xvfb glew-utils mesa-utils && rm -rf /var/lib/apt/lists/*;\n\n# Install ROS and other Python dependencies\n# RUN $OFFWORLD_GYM_ROOT/scripts/install-real-and-sim.sh install_ros_dep_lib\nENV DEBIAN_FRONTEND=noninteractive\nRUN sh -c 'echo \"deb http://packages.ros.org/ros/ubuntu $(lsb_release -sc) main\" > /etc/apt/sources.list.d/ros-latest.list'\nRUN apt install --no-install-recommends -y curl && rm -rf /var/lib/apt/lists/*;\nRUN curl -f -s https://raw.githubusercontent.com/ros/rosdistro/master/ros.asc | apt-key add -\nRUN apt update -y\nRUN apt install --no-install-recommends -y ros-noetic-desktop-full git && rm -rf /var/lib/apt/lists/*;\nRUN apt install --no-install-recommends -y python3-rosdep python3-rosinstall python3-rosinstall-generator python3-wstool build-essential && rm -rf /var/lib/apt/lists/*;\nRUN rosdep init\nRUN sudo rosdep fix-permissions\nRUN rosdep update\nENV source /opt/ros/noetic/setup.bash\n\n# install additional ROS packages\nRUN apt-get update -y\nRUN apt install --no-install-recommends --allow-unauthenticated -y ros-noetic-rosbridge-suite ros-noetic-multirobot-map-merge ros-noetic-explore-lite \\\n                    ros-noetic-ros-controllers ros-noetic-rospack \\\n                    python3-tk libeigen3-dev \\\n                    ros-noetic-roslint ros-noetic-catkin python3-catkin-tools ros-noetic-robot-state-publisher && rm -rf /var/lib/apt/lists/*;\n\n###########################################################################\n# Install Python3.8\n# RUN $OFFWORLD_GYM_ROOT/scripts/install-real-and-sim.sh install_python_dep_lib\nRUN add-apt-repository ppa:deadsnakes/ppa \\\n\t&& apt-get update \\\n\t&& apt-get install --no-install-recommends -y python3.8 python3.8-dev && rm -rf /var/lib/apt/lists/*;\n\n# Install Offworld Client Library and Python dependecies\nRUN export OFFWORLD_GYM_ROOT=`pwd`/..\nRUN apt install --no-install-recommends -y libbullet-dev git curl wget python3-distutils && rm -rf /var/lib/apt/lists/*;\nENV LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/usr/local/python3/bin\nENV PATH=$PATH:/root/.local/bin\nRUN curl -f https://bootstrap.pypa.io/get-pip.py -o get-pip.py\nRUN python3.8 get-pip.py\n\nRUN python3.8 -m pip install --upgrade pip\nRUN pip3.8 install --user --upgrade testresources==2.0.1\nRUN pip3.8 install --user --upgrade setuptools==60.9.3\nRUN pip3.8 install --user --upgrade numpy==1.22.3\nRUN pip3.8 install --user --upgrade scipy==1.8.0\nRUN pip3.8 install --user --upgrade opencv-python==4.5.5.64\nRUN pip3.8 install --user --upgrade catkin_pkg==0.4.24\nRUN pip3.8 install --user --upgrade empy==3.3.4\nRUN pip3.8 install --user --upgrade requests==2.27.1\nRUN pip3.8 install --user --upgrade defusedxml==0.7.1\nRUN pip3.8 install --user --upgrade rospkg==1.4.0\nRUN pip3.8 install --user --upgrade matplotlib==3.5.1\nRUN pip3.8 install --user --upgrade netifaces==0.11.0\nRUN pip3.8 install --user --upgrade regex==2022.3.2\nRUN pip3.8 install --user --upgrade psutil==5.9.0\nRUN pip3.8 install --user --upgrade gym==0.23.0\nRUN pip3.8 install --user --upgrade python-socketio==5.5.2\nRUN pip3.8 install --user --upgrade scikit-image==0.19.2\nRUN pip3.8 install --user --upgrade pyquaternion==0.9.5\nRUN pip3.8 install --user --upgrade imageio==2.16.1\nRUN pip3.8 install --user --upgrade importlib-metadata==4.11.2\n\n###########################################################################\n# Gazebo and nvm\n# RUN $OFFWORLD_GYM_ROOT/scripts/install-real-and-sim.sh install_gazebo_nvm_dep_lib\n# Replace shell with bash so we can source files\nRUN rm /bin/sh && ln -s /bin/bash /bin/sh\n\n\nRUN curl -f -sSL https://get.gazebosim.org | sh\nRUN apt-get install --no-install-recommends -y libjansson-dev npm libboost-dev imagemagick libtinyxml-dev mercurial cmake build-essential && rm -rf /var/lib/apt/lists/*;\nRUN apt install -y --no-install-recommends ros-noetic-gazebo-ros-pkgs ros-noetic-gazebo-ros-control && rm -rf /var/lib/apt/lists/*;\n\nENV NVM_DIR=/usr/local/nvm\nRUN mkdir -p $NVM_DIR\nENV NODE_VERSION=9.11.2\n\n# # Install nvm\nRUN curl -f -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.0/install.sh | bash \\\n    && source $NVM_DIR/nvm.sh \\\n    && nvm install $NODE_VERSION \\\n    && nvm alias default $NODE_VERSION \\\n    && nvm use default\n\nENV NODE_PATH=$NVM_DIR/v$NODE_VERSION/lib/node_modules\nENV PATH=$NVM_DIR/versions/node/v$NODE_VERSION/bin:$PATH\n\n# Copy and Initialize workspace\nRUN mkdir -p /offworld-gym\nENV  OFFWORLD_GYM_ROOT='/offworld-gym'\nCOPY . /offworld-gym\nWORKDIR /offworld-gym\n\n# Install gzweb\nWORKDIR /\n# RUN mv $OFFWORLD_GYM_ROOT/offworld_gym/envs/gazebo/catkin_ws/src/gzweb /\nRUN git clone https://github.com/offworld-projects/offworld-gzweb.git -b fix-camera-angle/gzweb_1.4.1\nRUN mv offworld-gzweb gzweb\nRUN cd /gzweb \\\n    && source /usr/share/gazebo/setup.sh \\\n    && mkdir -p /gzweb/http/client/assets/ \\ \n    && npm run deploy --- -m local \\\n    && npm run update\n\nWORKDIR $OFFWORLD_GYM_ROOT\nRUN pip3.8 install --user -e .\n\n\nRUN mkdir -p $OFFWORLD_GYM_ROOT/offworld_gym/envs/gazebo/catkin_ws/src\nWORKDIR $OFFWORLD_GYM_ROOT/offworld_gym/envs/gazebo/catkin_ws/src\nRUN git clone https://github.com/offworld-projects/rosbot_description.git -b offworld-gym\n\nWORKDIR $OFFWORLD_GYM_ROOT/offworld_gym/envs/gazebo/catkin_ws\nRUN chmod +x $OFFWORLD_GYM_ROOT/offworld_gym/envs/gazebo/catkin_ws/src/gym_offworld_monolith/scripts/command_server.py\nRUN chmod +x $OFFWORLD_GYM_ROOT/offworld_gym/envs/gazebo/catkin_ws/src/gym_offworld_monolith/scripts/robot_commands.py\n\nRUN /bin/bash -c \"source /opt/ros/noetic/setup.bash && catkin_make\"\n# RUN $OFFWORLD_GYM_ROOT/scripts/install-real-and-sim.sh build_gym_shell_script\n\n###########################################################################\n# Setting environment variables\n# Appended to the python system path at runtime to import ROS python modules regardless of existing env setup.\nENV GAZEBO_GYM_PYTHON_DEPENDENCIES=/offworld-gym/offworld_gym/envs/gazebo/catkin_ws/devel/lib/python3/dist-packages:/opt/ros/noetic/lib/python3.8/dist-packages\n\n# Replaces PYTHONPATH in the subprocess that calls roslaunch within a Gazebo Gym (So that your python3 site-packages don't get imported by accident)\nENV ROSLAUNCH_PYTHONPATH_OVERRIDE=/opt/ros/noetic/lib/python3.8/dist-packages:/offworld-gym/offworld_gym/envs/gazebo/catkin_ws/devel/lib/python3/dist-packages\n\n# 2nd line below is a hack. Something in the original astra_minimal.dae causes rendering to crash in chrome, but astra.dae works.\nRUN cp -r /usr/share/gazebo-11/media /gzweb/http/client/assets/ \\\n    && cp -r /offworld-gym/offworld_gym/envs/gazebo/catkin_ws/src/gym_offworld_monolith/models/* /gzweb/http/client/assets/ \\\n    && cp -r /offworld-gym/offworld_gym/envs/gazebo/catkin_ws/src/rosbot_description/src/rosbot_description /gzweb/http/client/assets/ \\\n    && cp /gzweb/http/client/assets/rosbot_description/meshes/astra.dae /gzweb/http/client/assets/rosbot_description/meshes/astra_minimal.dae\n\n\n# Add to .bashrc for root user\nENV GAZEBO_MODEL_PATH=$OFFWORLD_GYM_ROOT/offworld_gym/envs/gazebo/catkin_ws/src/gym_offworld_monolith/models:$GAZEBO_MODEL_PATH\nENV OFFWORLD_GYM_ROOT=$OFFWORLD_GYM_ROOT\nENV PYTHONPATH=/usr/local/lib/python3.8/dist-packages/:/root/.local/lib/python3.8/site-packages:/usr/lib/python3/dist-packages/:/usr/lib/python3/dist-packages:$PYTHONPATH\nENV GAZEBO_MODEL_PATH=$OFFWORLD_GYM_ROOT/offworld_gym/envs/gazebo/catkin_ws/src/gym_offworld_monolith/models:$GAZEBO_MODEL_PATH\nRUN chmod +x $OFFWORLD_GYM_ROOT/offworld_gym/envs/gazebo/docker_entrypoint.sh\nWORKDIR $OFFWORLD_GYM_ROOT\n\nCMD [\"source /offworld-gym/offworld_gym/envs/gazebo/docker_entrypoint.sh\"]\nENTRYPOINT [\"/bin/bash\",\"-c\"]\n\n\n\n"
}