{
  "startTime": 1674252748766,
  "endTime": 1674252749962,
  "originalSmells": [
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 67,
        "lineEnd": 67,
        "columnStart": 3,
        "columnEnd": 49
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 66,
        "lineEnd": 66,
        "columnStart": 3,
        "columnEnd": 26
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 68,
        "lineEnd": 68,
        "columnStart": 3,
        "columnEnd": 28
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 66,
        "lineEnd": 66,
        "columnStart": 3,
        "columnEnd": 26
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 68,
        "lineEnd": 68,
        "columnStart": 3,
        "columnEnd": 28
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "# === build js ===\nFROM node:14 as build-js\nWORKDIR /app\n\nCOPY ./js/src ./src\nCOPY ./js/tsconfig.json ./js/webpack.config.js ./js/package*.json ./\n\nRUN npm ci\nWORKDIR /app\nRUN npm run build:js\n\n\n# === setup python ===\nFROM python:3.7.0 as setup\nWORKDIR /app\n\nCOPY ./algorithmx ./algorithmx\nCOPY ./docs ./docs\nCOPY ./tests ./tests\nCOPY dev-requirements.txt setup.py pyproject.toml algorithmx-jupyter.json \\\nREADME.md LICENSE.txt changelog.md MANIFEST.in ./\n\n# upgrade pip\nRUN python -m pip install --upgrade pip\n\n# copy built js\nCOPY --from=build-js /app/dist ./js/dist\nCOPY --from=build-js /app/build ./js/build\nCOPY --from=build-js /app/build/library ./algorithmx/server/dist\nCOPY --from=build-js /app/build/nbextension ./algorithmx/nbextension\nCOPY --from=build-js /app/build/labextension ./algorithmx/labextension\n\n\n# === prepare build ===\nFROM setup as prepare-build\n\n# install dev dependencies and the module itself\nRUN python -m pip install -r /app/dev-requirements.txt \\\n&& python -m pip install -e \".[networkx]\"\n\n\n# === http server ===\nFROM setup as http-server\n\n# install the module itself\nRUN python -m pip install --no-deps -e \".[networkx]\"\n\nEXPOSE 5050\nEXPOSE 5051\n\n\n# === jupyter notebook ===\nFROM setup as jupyter-notebook\n\n# install jupyter nodebook and the module itself\nRUN python -m pip install -e \".[jupyter,networkx]\" \\\n&& python -m jupyter nbextension list\n\nEXPOSE 8888\n\n\n# === jupyter lab ===\nFROM setup as jupyter-lab\n\n# install nodejs\nRUN apt-get update \\\n&& apt-get install --no-install-recommends -y curl \\\n&& curl -f -sL https://deb.nodesource.com/setup_14.x | bash \\\n&& apt-get install --no-install-recommends -y nodejs && rm -rf /var/lib/apt/lists/*;\n\n# install jupyter lab and the module itself\nRUN python -m pip install -e \".[jupyter,networkx]\"\n\n# enable the jupyter lab extension\nRUN python -m jupyter labextension install @jupyter-widgets/jupyterlab-manager --no-build \\\n&& python -m jupyter lab build --dev-build=True --minimize=False \\\n&& python -m jupyter labextension list\n\nEXPOSE 8888\n"
}