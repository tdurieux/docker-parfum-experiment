{
  "startTime": 1674220447230,
  "endTime": 1674220448151,
  "originalSmells": [
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 54,
        "lineEnd": 59,
        "columnStart": 4,
        "columnEnd": 15
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 54,
        "lineEnd": 59,
        "columnStart": 4,
        "columnEnd": 15
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "# This file is part of docker-debian-systemd.\n#\n# Copyright (c)\n#   2018-2019 Alexander Haase <ahaase@alexhaase.de>\n#\n# Permission is hereby granted, free of charge, to any person obtaining a copy\n# of this software and associated documentation files (the \"Software\"), to deal\n# in the Software without restriction, including without limitation the rights\n# to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n# copies of the Software, and to permit persons to whom the Software is\n# furnished to do so, subject to the following conditions:\n#\n# The above copyright notice and this permission notice shall be included in all\n# copies or substantial portions of the Software.\n#\n# THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n# IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n# FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n# AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n# LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n# OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n# SOFTWARE.\n\n# This image bases on the regular Debian image. By default the 'latest' tag\n# (pointing to the current stable release) of the parent image will be used.\n# However, an alternate parent tag may be set by defining the 'TAG' build\n# argument to a specific Debian release, e.g. 'stretch' or 'buster'.\nARG  TAG=latest\nFROM debian:${TAG}\nLABEL maintainer=\"manuel.delapena@elastic.co\"\n\n# Configure the debconf frontend.\n#\n# This image doesn't include whiptail, dialog, nor the readline perl module.\n# Therefore, the debconf frontend will be set to 'teletype' to avoid error\n# messages about no dialog frontend could be found.\nRUN echo 'debconf debconf/frontend select teletype' | debconf-set-selections\n\n\n# Install the necessary packages.\n#\n# In addition to the regular Debian base image, a BASIC set of packages from the\n# Debian minimal configuration will be installed. After all packages have been\n# installed, the apt caches and some log files will be removed to minimize the\n# image.\n#\n# NOTE: An upgrade will be performed to include updates and security fixes of\n#       installed packages that received updates in the Debian repository after\n#       the upstream image has been created.\n#\n# NOTE: No syslog daemon will be installed, as systemd's journald should fit\n#       most needs. Please file an issue if you think this should be changed.\nRUN apt-get update && apt-get install -y --no-install-recommends \\\n        systemd \\\n        systemd-sysv \\\n        cron \\\n        procps \\\n        anacron && rm -rf /var/lib/apt/lists/*;\nRUN apt-get dist-upgrade -y\n\n\n\n\n\n\n\nRUN apt-get clean\nRUN rm -rf                        \\\n    /var/lib/apt/lists/*          \\\n    /var/log/alternatives.log     \\\n    /var/log/apt/history.log      \\\n    /var/log/apt/term.log         \\\n    /var/log/dpkg.log\n\n\n# Configure systemd.\n#\n# For running systemd inside a Docker container, some additional tweaks are\n# required. For a detailed list see:\n#\n# https://developers.redhat.com/blog/2016/09/13/ \\\n#   running-systemd-in-a-non-privileged-container/\n#\n# Additional tweaks will be applied in the final image below.\n\n# To avoid ugly warnings when running this image on a host running systemd, the\n# following units will be masked.\n#\n# NOTE: This will not remove ALL warnings in all Debian releases, but seems to\n#       work for stretch.\nRUN systemctl mask --   \\\n    dev-hugepages.mount \\\n    sys-fs-fuse-connections.mount\n\n# The machine-id should be generated when creating the container. This will be\n# done automatically if the file is not present, so let's delete it.\nRUN rm -f           \\\n    /etc/machine-id \\\n    /var/lib/dbus/machine-id\n\n\n\n\n# Build the final image.\n#\n# To get a minimal image without deleted files in intermediate layers, the\n# contents of the image previously built will be copied into a second version of\n# the parent image.\n#\n# NOTE: This method requires buildkit, as the differ of buildkit will copy\n#       changed files only and we'll get a minimal image with just the changed\n#       files in a single new layer.\n#\n# NOTE: All settings related to the image's environment (e.g. CMD, ENV and\n#       VOLUME settings) need to be set in the following image definition to be\n#       used by child images and containers.\n\nFROM debian:${TAG}\nCOPY --from=0 / /\n\n\n# Configure systemd.\n#\n# For running systemd inside a Docker container, some additional tweaks are\n# required. Some of them have already been applied above.\n#\n# The 'container' environment variable tells systemd that it's running inside a\n# Docker container environment.\nENV container docker\n\n# A different stop signal is required, so systemd will initiate a shutdown when\n# running 'docker stop <container>'.\nSTOPSIGNAL SIGRTMIN+3\n\n# The host's cgroup filesystem need's to be mounted (read-only) in the\n# container. '/run', '/run/lock' and '/tmp' need to be tmpfs filesystems when\n# running the container without 'CAP_SYS_ADMIN'.\n#\n# NOTE: For running Debian stretch, 'CAP_SYS_ADMIN' still needs to be added, as\n#       stretch's version of systemd is not recent enough. Buster will run just\n#       fine without 'CAP_SYS_ADMIN'.\nVOLUME [ \"/sys/fs/cgroup\", \"/run\", \"/run/lock\", \"/tmp\" ]\n\n# As this image should run systemd, the default command will be changed to start\n# the init system. CMD will be preferred in favor of ENTRYPOINT, so one may\n# override it when creating the container to e.g. to run a bash console instead.\nCMD [ \"/sbin/init\" ]\n"
}