{
  "startTime": 1674254444559,
  "endTime": 1674254445879,
  "originalSmells": [
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 14,
        "lineEnd": 14,
        "columnStart": 2,
        "columnEnd": 68
      }
    },
    {
      "rule": "curlUseHttpsUrl",
      "position": {
        "lineStart": 14,
        "lineEnd": 14,
        "columnStart": 2,
        "columnEnd": 68
      }
    },
    {
      "rule": "configureShouldUseBuildFlag",
      "position": {
        "lineStart": 16,
        "lineEnd": 18,
        "columnStart": 2,
        "columnEnd": 52
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 7,
        "lineEnd": 7,
        "columnStart": 4,
        "columnEnd": 32
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 10,
        "lineEnd": 10,
        "columnStart": 4,
        "columnEnd": 50
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 11,
        "lineEnd": 12,
        "columnStart": 2,
        "columnEnd": 51
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 25,
        "lineEnd": 25,
        "columnStart": 4,
        "columnEnd": 26
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 25,
        "lineEnd": 25,
        "columnStart": 30,
        "columnEnd": 53
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 25,
        "lineEnd": 25,
        "columnStart": 57,
        "columnEnd": 79
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 25,
        "lineEnd": 25,
        "columnStart": 83,
        "columnEnd": 107
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 7,
        "lineEnd": 7,
        "columnStart": 4,
        "columnEnd": 32
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 10,
        "lineEnd": 10,
        "columnStart": 4,
        "columnEnd": 50
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 11,
        "lineEnd": 12,
        "columnStart": 2,
        "columnEnd": 51
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 25,
        "lineEnd": 25,
        "columnStart": 4,
        "columnEnd": 26
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 25,
        "lineEnd": 25,
        "columnStart": 30,
        "columnEnd": 53
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 25,
        "lineEnd": 25,
        "columnStart": 57,
        "columnEnd": 79
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 25,
        "lineEnd": 25,
        "columnStart": 83,
        "columnEnd": 107
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 7,
        "lineEnd": 7,
        "columnStart": 4,
        "columnEnd": 32
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 10,
        "lineEnd": 10,
        "columnStart": 4,
        "columnEnd": 50
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 11,
        "lineEnd": 12,
        "columnStart": 2,
        "columnEnd": 51
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 25,
        "lineEnd": 25,
        "columnStart": 4,
        "columnEnd": 26
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 25,
        "lineEnd": 25,
        "columnStart": 30,
        "columnEnd": 53
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 25,
        "lineEnd": 25,
        "columnStart": 57,
        "columnEnd": 79
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 25,
        "lineEnd": 25,
        "columnStart": 83,
        "columnEnd": 107
      }
    }
  ],
  "repairedSmells": [
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 7,
        "lineEnd": 7,
        "columnStart": 4,
        "columnEnd": 56
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 10,
        "lineEnd": 10,
        "columnStart": 4,
        "columnEnd": 74
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 11,
        "lineEnd": 12,
        "columnStart": 2,
        "columnEnd": 51
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 25,
        "lineEnd": 25,
        "columnStart": 4,
        "columnEnd": 50
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 25,
        "lineEnd": 25,
        "columnStart": 54,
        "columnEnd": 101
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 25,
        "lineEnd": 25,
        "columnStart": 105,
        "columnEnd": 151
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 25,
        "lineEnd": 25,
        "columnStart": 155,
        "columnEnd": 203
      }
    }
  ],
  "repairedDockerfile": "FROM debian:9-slim as base\n\nENV FFMPEG_VERSION=4.0.2 LD_LIBRARY_PATH=/usr/local/lib\n\nRUN apt-get update\n\n# install mediainfo executable\nRUN apt-get install --no-install-recommends -y mediainfo && rm -rf /var/lib/apt/lists/*;\n\n# build ffmpeg libraries\nRUN apt-get install --no-install-recommends -y make curl gcc g++ nasm yasm && \\\n  apt-get install --no-install-recommends -y opencl-dev vim libass-dev libavformat-dev \\\n  libavutil-dev libavfilter-dev uuid-dev zlib1g-dev && \\\n  DIR=$(mktemp -d) && cd ${DIR} && \\\n  curl -f -s https://ffmpeg.org/releases/ffmpeg-${FFMPEG_VERSION}.tar.gz | tar zxvf - -C . && \\\n  cd ffmpeg-${FFMPEG_VERSION} && \\\n  ./configure --build=\"$(dpkg-architecture --query DEB_BUILD_GNU_TYPE)\" --enable-version3 --enable-hardcoded-tables --enable-shared --enable-static \\\n    --enable-small --enable-libass --enable-postproc --enable-avresample --enable-libfreetype \\\n    --disable-lzma --enable-opencl --enable-pthreads && \\\n  make && \\\n  make install && \\\n  make distclean && \\\n  rm -rf ${DIR} && rm -rf /var/lib/apt/lists/*;\n\n# install git, make, and gcc to build gpac\nRUN apt-get install --no-install-recommends -y git && apt-get install --no-install-recommends -y make && apt-get install --no-install-recommends -y gcc && apt-get install --no-install-recommends -y clang && rm -rf /var/lib/apt/lists/*;\nCOPY .git/ /app/.git/\n\n# pull and build gpac\nRUN git clone https://github.com/Comcast/gpac-caption-extractor.git && \\\n    cp -r /gpac-caption-extractor/include/gpac /usr/local/include && \\\n    cd gpac-caption-extractor && make gpac && cp libgpac.so /usr/local/lib\n\n# build /app/caption-inspector executable\nCOPY src/ /app/src/\nCOPY include/ /app/include/\nCOPY Makefile /app/Makefile\nWORKDIR /app\nRUN mkdir obj && mkdir python; cd src && make ci_with_gpac\n\nRUN ldd /usr/bin/mediainfo\n\n#\n# Runtime Container\n#\nFROM debian:9-slim as slim\n\nENV FFMPEG_VERSION=4.0.2 LD_LIBRARY_PATH=/usr/local/lib\n\nCOPY --from=base /app/caption-inspector /usr/local/bin/\n# copy required libraries from base to the slim image\nCOPY --from=base /usr/local/lib/libavformat.so.* /usr/local/lib/\nCOPY --from=base /usr/local/lib/libavcodec.so.* /usr/local/lib/\nCOPY --from=base /usr/local/lib/libavutil.so.* /usr/local/lib/\nCOPY --from=base /usr/local/lib/libswresample.so.* /usr/local/lib/\nCOPY --from=base /usr/lib/x86_64-linux-gnu/libOpenCL.so.* /usr/local/lib/\nCOPY --from=base /usr/local/lib/libgpac.so /usr/local/lib/\n\n# ensure all required libraries are installed\nRUN if ldd /usr/local/bin/caption-inspector | grep \"not found\"; then false; fi\n\nCOPY --from=base /usr/bin/mediainfo /usr/local/bin/mediainfo\n# copy required libraries from base to the slim image\nCOPY --from=base /usr/lib/x86_64-linux-gnu/libmediainfo.so.* /usr/local/lib/\nCOPY --from=base /usr/lib/x86_64-linux-gnu/libzen.so.* /usr/local/lib/\nCOPY --from=base /usr/lib/x86_64-linux-gnu/libcurl-gnutls.so.* /usr/local/lib/\nCOPY --from=base /usr/lib/x86_64-linux-gnu/libmms.so.* /usr/local/lib/\nCOPY --from=base /lib/x86_64-linux-gnu/libglib-2.0.so.* /usr/local/lib/\nCOPY --from=base /usr/lib/x86_64-linux-gnu/libtinyxml2.so.* /usr/local/lib/\nCOPY --from=base /usr/lib/x86_64-linux-gnu/libnghttp2.so.* /usr/local/lib/\nCOPY --from=base /usr/lib/x86_64-linux-gnu/libidn2.so.* /usr/local/lib/\nCOPY --from=base /usr/lib/x86_64-linux-gnu/librtmp.so.* /usr/local/lib/\nCOPY --from=base /usr/lib/x86_64-linux-gnu/libssh2.so.* /usr/local/lib/\nCOPY --from=base /usr/lib/x86_64-linux-gnu/libpsl.so.* /usr/local/lib/\nCOPY --from=base /usr/lib/x86_64-linux-gnu/libnettle.so.* /usr/local/lib/\nCOPY --from=base /usr/lib/x86_64-linux-gnu/libgnutls.so.* /usr/local/lib/\nCOPY --from=base /usr/lib/x86_64-linux-gnu/libgssapi_krb5.so.* /usr/local/lib/\nCOPY --from=base /usr/lib/x86_64-linux-gnu/libkrb5.so.* /usr/local/lib/\nCOPY --from=base /usr/lib/x86_64-linux-gnu/libk5crypto.so.* /usr/local/lib/\nCOPY --from=base /usr/lib/x86_64-linux-gnu/liblber-2.4.so.* /usr/local/lib/\nCOPY --from=base /usr/lib/x86_64-linux-gnu/libldap_r-2.4.so.* /usr/local/lib/\nCOPY --from=base /usr/lib/x86_64-linux-gnu/libunistring.so.* /usr/local/lib/\nCOPY --from=base /usr/lib/x86_64-linux-gnu/libhogweed.so.* /usr/local/lib/\nCOPY --from=base /usr/lib/x86_64-linux-gnu/libgmp.so.* /usr/local/lib/\nCOPY --from=base /usr/lib/x86_64-linux-gnu/libunistring.so.* /usr/local/lib/\nCOPY --from=base /usr/lib/x86_64-linux-gnu/libp11-kit.so.* /usr/local/lib/\nCOPY --from=base /lib/x86_64-linux-gnu/libidn.so.* /usr/local/lib/\nCOPY --from=base /usr/lib/x86_64-linux-gnu/libtasn1.so.* /usr/local/lib/\nCOPY --from=base /usr/lib/x86_64-linux-gnu/libhogweed.so.* /usr/local/lib/\nCOPY --from=base /usr/lib/x86_64-linux-gnu/libgmp.so.* /usr/local/lib/\nCOPY --from=base /usr/lib/x86_64-linux-gnu/libkrb5support.so.* /usr/local/lib/\nCOPY --from=base /lib/x86_64-linux-gnu/libkeyutils.so.* /usr/local/lib/\nCOPY --from=base /usr/lib/x86_64-linux-gnu/libkrb5support.so.* /usr/local/lib/\nCOPY --from=base /lib/x86_64-linux-gnu/libkeyutils.so.* /usr/local/lib/\nCOPY --from=base /usr/lib/x86_64-linux-gnu/libkrb5support.so.* /usr/local/lib/\nCOPY --from=base /lib/x86_64-linux-gnu/libkeyutils.so.* /usr/local/lib/\nCOPY --from=base /usr/lib/x86_64-linux-gnu/libsasl2.so.* /usr/local/lib/\nCOPY --from=base /usr/lib/x86_64-linux-gnu/libffi.so.* /usr/local/lib/\n\n# ensure all required libraries are installed\nRUN if ldd /usr/local/bin/mediainfo | grep \"not found\"; then false; fi\n\nENTRYPOINT [\"/usr/local/bin/caption-inspector\"]\n"
}