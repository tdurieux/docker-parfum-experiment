diff --git a/Users/tdurieux/git/dinghy-experiment/data/evaluation/dockerfiles/cityoflosangeles/aqueduct/Dockerfile b/Users/tdurieux/git/dinghy-experiment/data/evaluation/dockerfile_repair_results/cityoflosangeles/aqueduct/Dockerfile/repaired.Dockerfile
index 8ae641d..fa7d6b1 100644
--- a/Users/tdurieux/git/dinghy-experiment/data/evaluation/dockerfiles/cityoflosangeles/aqueduct/Dockerfile
+++ b/Users/tdurieux/git/dinghy-experiment/data/evaluation/dockerfile_repair_results/cityoflosangeles/aqueduct/Dockerfile/repaired.Dockerfile
@@ -2,7 +2,7 @@ FROM continuumio/miniconda3:4.8.2
 
 # Install inkscape and xelatex for notebook conversion to PDF,
 # graphviz for ibis visualizations.
-RUN apt-get update && apt-get install -y \
+RUN apt-get update && apt-get install --no-install-recommends -y \
   bash-completion \
   gcc \
   graphviz \
@@ -15,12 +15,12 @@ RUN apt-get update && apt-get install -y \
   texlive-xetex \
   unixodbc-dev \
   unzip \
-  vim
+  vim && rm -rf /var/lib/apt/lists/*;
 
 
 # Some dependencies necessary to get rendering working
 # for headless chrome/chromium.
-RUN apt-get update && apt-get install -y gconf-service libasound2 libatk1.0-0 libc6 libcairo2 libcups2 libdbus-1-3 libexpat1 libfontconfig1 libgcc1 libgconf-2-4 libgdk-pixbuf2.0-0 libglib2.0-0 libgtk-3-0 libnspr4 libpango-1.0-0 libpangocairo-1.0-0 libstdc++6 libx11-6 libx11-xcb1 libxcb1 libxcomposite1 libxcursor1 libxdamage1 libxext6 libxfixes3 libxi6 libxrandr2 libxrender1 libxss1 libxtst6 ca-certificates fonts-liberation libappindicator1 libnss3 lsb-release xdg-utils wget
+RUN apt-get update && apt-get install --no-install-recommends -y gconf-service libasound2 libatk1.0-0 libc6 libcairo2 libcups2 libdbus-1-3 libexpat1 libfontconfig1 libgcc1 libgconf-2-4 libgdk-pixbuf2.0-0 libglib2.0-0 libgtk-3-0 libnspr4 libpango-1.0-0 libpangocairo-1.0-0 libstdc++6 libx11-6 libx11-xcb1 libxcb1 libxcomposite1 libxcursor1 libxdamage1 libxext6 libxfixes3 libxi6 libxrandr2 libxrender1 libxss1 libxtst6 ca-certificates fonts-liberation libappindicator1 libnss3 lsb-release xdg-utils wget && rm -rf /var/lib/apt/lists/*;
 
 
 # Install conda dependencies early, as it takes a long time.
@@ -54,18 +54,18 @@ RUN echo /opt/oracle/instantclient_19_6 > /etc/ld.so.conf.d/oracle-instantclient
 RUN rm instant_client.zip
 
 # Install SQL Server ODBC Driver
-RUN curl https://packages.microsoft.com/keys/microsoft.asc | apt-key add -
-RUN curl https://packages.microsoft.com/config/ubuntu/18.04/prod.list > /etc/apt/sources.list.d/mssql-release.list
-RUN apt-get update && ACCEPT_EULA=Y apt-get install -y msodbcsql17
+RUN curl -f https://packages.microsoft.com/keys/microsoft.asc | apt-key add -
+RUN curl -f https://packages.microsoft.com/config/ubuntu/18.04/prod.list > /etc/apt/sources.list.d/mssql-release.list
+RUN apt-get update && ACCEPT_EULA=Y apt-get --no-install-recommends install -y msodbcsql17 && rm -rf /var/lib/apt/lists/*;
 
 # Dependencies for altair_saver, conda packages are currently broken.
-RUN npm install -g --unsafe vega vega-cli vega-lite canvas
+RUN npm install -g --unsafe vega vega-cli vega-lite canvas && npm cache clean --force;
 
 # Install puppeteer-related notebook conversion.
-RUN pip install notebook-as-pdf && pyppeteer-install
+RUN pip install --no-cache-dir notebook-as-pdf && pyppeteer-install
 
 # Install some python-only packages using pip
-RUN pip install \
+RUN pip install --no-cache-dir \
   altair \
   altair_saver \
   arcgis \
@@ -123,9 +123,9 @@ RUN jupyter lab build --dev-build=False --debug && jupyter lab clean
 ENV DEFAULT_KERNEL python3
 # civis-jupyter-notebook is heavy handed with dependencies.
 # If we want a different version of pandas, we have to reinstall it afterwards.
-RUN pip install civis-jupyter-notebook && \
+RUN pip install --no-cache-dir civis-jupyter-notebook && \
      civis-jupyter-notebooks-install && \
-     pip install -U pandas
+     pip install --no-cache-dir -U pandas
 
 
 ENV TINI_VERSION v0.16.1
@@ -139,7 +139,7 @@ ENTRYPOINT ["/tini", "--"]
 
 # Install the local utils package
 COPY civis-aqueduct-utils /tmp/civis-aqueduct-utils
-RUN pip install /tmp/civis-aqueduct-utils && \
+RUN pip install --no-cache-dir /tmp/civis-aqueduct-utils && \
       jupyter nbextension install --sys-prefix --py civis_aqueduct_utils && \
       jupyter nbextension enable --sys-prefix --py civis_aqueduct_utils && \
       rm -r /tmp/civis-aqueduct-utils