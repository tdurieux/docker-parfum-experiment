{
  "startTime": 1674249352215,
  "endTime": 1674249353248,
  "originalSmells": [
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 58,
        "lineEnd": 60,
        "columnStart": 4,
        "columnEnd": 14
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 32,
        "lineEnd": 43,
        "columnStart": 25,
        "columnEnd": 10
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 32,
        "lineEnd": 43,
        "columnStart": 25,
        "columnEnd": 10
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 49,
        "lineEnd": 56,
        "columnStart": 22,
        "columnEnd": 28
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "########################################################\n##  Use this to create a pool of nodes that uses\n##  the payment plugins for plenum\n##\n##  To run this file please use the following\n##  Docker commands:\n##\n##  docker build -t indy_pool .\n##\n##  docker run -itd -p 9701-9708:9701-9708 indy_pool\n##\n##  Connecting to the container through bash (optional):\n##  docker ps | grep indy # to obtain container_id\n##  docker exec -it <container_id> /bin/bash\n##\n########################################################\n# this will be changed to sovrin docker hub when possible. Now changed to maintainer's hub\nFROM camparra/ubuntu16.04-rocksdb\n\nARG uid=1000\n\nARG indy_stream=rc\n\n\nARG indy_plenum_ver=1.10.0~rc1\nARG indy_node_ver=1.10.0~rc1\nARG python3_indy_crypto_ver=0.4.5\nARG indy_crypto_ver=0.4.5\nARG token_ver=1.0.3~rc20\nARG fees_ver=1.0.3~rc20\n\n# Install environment\nRUN apt-get update -y && apt-get install --no-install-recommends -y \\\n\t\t\twget \\\n\t\t\tpython3.5 \\\n\t\t\tpython3-pip \\\n\t\t\tpython-setuptools \\\n\t\t\tpython3-nacl \\\n\t\t\tapt-transport-https \\\n\t\t\tca-certificates \\\n\t\t\tsupervisor \\\n\t\t\tcurl \\\n      sudo \\\n      nano && rm -rf /var/lib/apt/lists/*;\n\n# Add Sovrin artifact repository\nRUN apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 68DB5E88\nRUN echo \"deb https://repo.sovrin.org/deb xenial $indy_stream\" >> /etc/apt/sources.list\n\nRUN apt-get update && apt-get install -y --no-install-recommends \\\n    python3-pyzmq=18.1.0 \\\n    indy-plenum=${indy_plenum_ver} \\\n    indy-node=${indy_node_ver} \\\n    python3-indy-crypto=${python3_indy_crypto_ver} \\\n    libindy-crypto=${indy_crypto_ver} \\\n    sovtoken=${token_ver} \\\n    sovtokenfees=${fees_ver} && rm -rf /var/lib/apt/lists/*;\n\nRUN pip3 install --no-cache-dir -U \\\n    pip==9.0.3 \\\n    setuptools\n\nRUN useradd -m -d /home/indy -s /bin/bash -p $(openssl passwd -1 \"token\") -u $uid indy; usermod -aG sudo indy\n\nRUN echo \"[supervisord]\\n\\\nlogfile = /tmp/supervisord.log\\n\\\nlogfile_maxbytes = 50MB\\n\\\nlogfile_backups=10\\n\\\nlogLevel = error\\n\\\npidfile = /tmp/supervisord.pid\\n\\\nnodaemon = true\\n\\\nminfds = 1024\\n\\\nminprocs = 200\\n\\\numask = 022\\n\\\nuser = indy\\n\\\nidentifier = supervisor\\n\\\ndirectory = /tmp\\n\\\nnocleanup = true\\n\\\nchildlogdir = /tmp\\n\\\nstrip_ansi = false\\n\\\n\\n\\\n[program:node1]\\n\\\ncommand=start_indy_node Node1 0.0.0.0 9701 0.0.0.0 9702\\n\\\ndirectory=/home/indy\\n\\\nstdout_logfile=/tmp/node1.log\\n\\\nstderr_logfile=/tmp/node1.log\\n\\\n\\n\\\n[program:node2]\\n\\\ncommand=start_indy_node Node2 0.0.0.0 9703 0.0.0.0 9704\\n\\\ndirectory=/home/indy\\n\\\nstdout_logfile=/tmp/node2.log\\n\\\nstderr_logfile=/tmp/node2.log\\n\\\n\\n\\\n[program:node3]\\n\\\ncommand=start_indy_node Node3 0.0.0.0 9705 0.0.0.0 9706\\n\\\ndirectory=/home/indy\\n\\\nstdout_logfile=/tmp/node3.log\\n\\\nstderr_logfile=/tmp/node3.log\\n\\\n\\n\\\n[program:node4]\\n\\\ncommand=start_indy_node Node4 0.0.0.0 9707 0.0.0.0 9708\\n\\\ndirectory=/home/indy\\n\\\nstdout_logfile=/tmp/node4.log\\n\\\nstderr_logfile=/tmp/node4.log\\n\"\\\n>> /etc/supervisord.conf\n\nUSER indy\n\nRUN awk '{if (index($1, \"NETWORK_NAME\") != 0) {print(\"NETWORK_NAME = \\\"sandbox\\\"\")} else print($0)}' /etc/indy/indy_config.py> /tmp/indy_config.py\nRUN mv /tmp/indy_config.py /etc/indy/indy_config.py\n\nARG pool_ip=127.0.0.1\n\nRUN generate_indy_pool_transactions --nodes 4 --clients 5 --nodeNum 1 2 3 4 --ips=\"$pool_ip,$pool_ip,$pool_ip,$pool_ip\"\n\nEXPOSE 9701 9702 9703 9704 9705 9706 9707 9708\n\nCMD [\"/usr/bin/supervisord\"]\n"
}