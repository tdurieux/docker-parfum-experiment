{
  "startTime": 1674246769024,
  "endTime": 1674246770322,
  "originalSmells": [
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 42,
        "lineEnd": 42,
        "columnStart": 7,
        "columnEnd": 153
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 90,
        "lineEnd": 90,
        "columnStart": 7,
        "columnEnd": 38
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "FROM ubuntu:latest\nARG S6_VERSION=v2.2.0.3\nARG S6_ARCH=amd64\nARG DEBIAN_FRONTEND=noninteractive\nARG USER_NAME=pagermaid\nARG WORK_DIR=/pagermaid/workdir\nENV PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin \\\n    SHELL=/bin/bash \\\n    LANG=zh_CN.UTF-8 \\\n    PS1=\"\\u@\\h:\\w \\$ \" \\\n    RUN_AS_ROOT=true\nSHELL [\"/bin/bash\", \"-c\"]\nWORKDIR $WORK_DIR\nRUN source ~/.bashrc \\\n    ## 安装运行环境依赖，自编译建议修改为国内镜像源\n    && sed -i 's/archive.ubuntu.com/mirrors.bfsu.edu.cn/g' /etc/apt/sources.list \\\n    && sed -i 's/security.ubuntu.com/mirrors.bfsu.edu.cn/g' /etc/apt/sources.list \\\n    && sed -i 's/ports.ubuntu.com/mirrors.bfsu.edu.cn/g' /etc/apt/sources.list \\\n    && apt-get update \\\n    && apt-get upgrade -y \\\n    && apt-get install --no-install-recommends -y \\\n        python3 \\\n        python3-pip \\\n        tesseract-ocr \\\n        tesseract-ocr-eng \\\n        tesseract-ocr-chi-sim \\\n        language-pack-zh-hans \\\n        sudo \\\n        git \\\n        openssl \\\n        redis-server \\\n        curl \\\n        wget \\\n        neofetch \\\n        imagemagick \\\n        ffmpeg \\\n        fortune-mod \\\n        figlet \\\n        libmagic1 \\\n        libzbar0 \\\n        iputils-ping \\\n    ## 安装s6 \\\n    && curl -f -L -o /tmp/s6-overlay-installer https://github.com/just-containers/s6-overlay/releases/download/${S6_VERSION}/s6-overlay-${S6_ARCH}-installer \\\n    && chmod +x /tmp/s6-overlay-installer \\\n    && /tmp/s6-overlay-installer / \\\n    ## 安装编译依赖\n    && apt-get update \\\n    && apt-get install --no-install-recommends -y \\\n        ## 这是跨平台交叉编译要用到的包，如果自行构建，有可能不需要\n        build-essential \\\n        apt-utils \\\n        python3-dev \\\n        libxslt1-dev \\\n        libxml2-dev \\\n        libssl-dev \\\n        libffi-dev \\\n        zlib1g-dev \\\n        tcl8.6-dev \\\n        tk8.6-dev \\\n        libimagequant-dev \\\n        libraqm-dev \\\n        libjpeg-dev \\\n        libtiff5-dev \\\n        libopenjp2-7-dev \\\n        libfreetype6-dev \\\n        liblcms2-dev \\\n        libwebp-dev \\\n        python3-tk \\\n        libharfbuzz-dev \\\n        libfribidi-dev \\\n        libxcb1-dev \\\n        pkg-config \\\n    ## 设置时区\n    && ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime \\\n    && echo \"Asia/Shanghai\" > /etc/timezone \\\n    ## python软链接\n    && ln -sf /usr/bin/python3 /usr/bin/python \\\n    ## 升级pip\n    && pip config set global.index-url https://pypi.tuna.tsinghua.edu.cn/simple \\\n    && python -m pip install --upgrade pip \\\n    ## 添加用户\n    && useradd $USER_NAME -u 917 -U -r -m -d /$USER_NAME -s /bin/bash \\\n    && usermod -aG sudo,users $USER_NAME \\\n    && echo \"$USER_NAME ALL=(ALL) NOPASSWD:ALL\" > /etc/sudoers.d/$USER_NAME \\\n    ## 克隆仓库\n    && git clone -b master https://github.com/Xtao-Labs/PagerMaid-Modify.git $WORK_DIR \\\n    && git config --global pull.ff only \\\n    ## 复制s6启动脚本\n    && cp -r s6/* / \\\n    ## pip install\n    && pip install --no-cache-dir -r requirements.txt \\\n    ## 卸载编译依赖\n    && sudo apt-get purge --auto-remove -y \\\n        build-essential \\\n        apt-utils \\\n        python3-dev \\\n        libxslt1-dev \\\n        libxml2-dev \\\n        libssl-dev \\\n        libffi-dev \\\n        zlib1g-dev \\\n        tcl8.6-dev \\\n        tk8.6-dev \\\n        libimagequant-dev \\\n        libraqm-dev \\\n        libjpeg-dev \\\n        libtiff5-dev \\\n        libopenjp2-7-dev \\\n        libfreetype6-dev \\\n        liblcms2-dev \\\n        libwebp-dev \\\n        python3-tk \\\n        libharfbuzz-dev \\\n        libfribidi-dev \\\n        libxcb1-dev \\\n        pkg-config \\\n    && apt-get clean -y \\\n    && rm -rf \\\n        ## 删除apt和pip的安装缓存\n        /tmp/* \\\n        /var/lib/apt/lists/* \\\n        /var/tmp/* \\\n        ~/.cache\nENTRYPOINT [\"/init\"]\n"
}