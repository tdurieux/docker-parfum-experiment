{
  "startTime": 1674254365885,
  "endTime": 1674254366846,
  "originalSmells": [
    {
      "rule": "npmCacheCleanAfterInstall",
      "position": {
        "lineStart": 38,
        "lineEnd": 38,
        "columnStart": 5,
        "columnEnd": 54
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "#\n# Wechaty Docker\n# https://github.com/wechaty/wechaty\n#\n# FROM alpine\n#\n# Docker image for Alpine Linux with latest ShellCheck, a static analysis tool for shell scripts.\n# https://hub.docker.com/r/nlknguyen/alpine-shellcheck/\n# FROM nlknguyen/alpine-shellcheck\nFROM mhart/alpine-node:7\nLABEL maintainer=\"Huan LI <zixia@zixia.net>\"\n\nRUN  apk update && apk upgrade \\\n  && apk add \\\n      bash \\\n      ca-certificates \\\n      chromium-chromedriver \\\n      chromium \\\n      coreutils \\\n      curl \\\n      ffmpeg \\\n      figlet \\\n      jq \\\n      moreutils \\\n      ttf-freefont \\\n      udev \\\n      vim \\\n      xauth \\\n      xvfb \\\n  && rm -rf /tmp/* /var/cache/apk/*\n\nRUN mkdir /wechaty\nWORKDIR /wechaty\n\n# npm `chromedriver` not support alpine linux\n# https://github.com/giggio/node-chromedriver/issues/70\nCOPY package.json .\nRUN sed -i '/chromedriver/d' package.json \\\n  && npm --silent --progress=false install > /dev/null \\\n  && rm -fr /tmp/* ~/.npm && npm cache clean --force;\n\n# Loading from node_modules Folders: https://nodejs.org/api/modules.html\n# If it is not found there, then it moves to the parent directory, and so on, until the root of the file system is reached.\nCOPY . .\nRUN  sed -i '/chromedriver/d' package.json \\\n  && npm run dist \\\n  && npm --silent --progress=false link \\\n  \\\n  && mkdir /bot \\\n  \\\n  && (   mkdir /node_modules && cd /node_modules \\\n      && ln -s /wechaty . \\\n      && ln -s /wechaty/node_modules/* . \\\n    ) \\\n  && ln -s /wechaty/tsconfig.json / \\\n  && echo \"export * from 'wechaty'\" > /index.ts \\\n  \\\n  && echo 'Linked wechaty to global'\n\nVOLUME [ \"/bot\" ]\n\nENTRYPOINT [ \"/wechaty/bin/entrypoint.sh\" ]\nCMD [ \"\" ]\n\n#\n# https://docs.docker.com/docker-cloud/builds/advanced/\n# http://label-schema.org/rc1/\n#\nLABEL org.label-schema.license=\"ISC\" \\\n      org.label-schema.build-date=\"$(date -u +'%Y-%m-%dT%H:%M:%SZ')\" \\\n      org.label-schema.version=\"$DOCKER_TAG\" \\\n      org.label-schema.schema-version=\"$(wechaty-version)\" \\\n      org.label-schema.name=\"Wechaty\" \\\n      org.label-schema.description=\"Wechat for Bot\" \\\n      org.label-schema.usage=\"https://github.com/wechaty/wechaty/wiki/Docker\" \\\n      org.label-schema.url=\"https://www.chatie.io\" \\\n      org.label-schema.vendor=\"AKA Mobi\" \\\n      org.label-schema.vcs-ref=\"$SOURCE_COMMIT\" \\\n      org.label-schema.vcs-url=\"https://github.com/wechaty/wechaty\" \\\n      org.label-schema.docker.cmd=\"docker run -ti --rm wechaty/wechaty <code.js>\" \\\n      org.label-schema.docker.cmd.test=\"docker run -ti --rm wechaty/wechaty test\" \\\n      org.label-schema.docker.cmd.help=\"docker run -ti --rm wechaty/wechaty help\" \\\n      org.label-schema.docker.params=\"WECHATY_TOKEN=token token from https://www.chatie.io\"\n\n#RUN npm test\n"
}