{
  "startTime": 1674217461763,
  "endTime": 1674217462652,
  "originalSmells": [
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 61,
        "lineEnd": 95,
        "columnStart": 4,
        "columnEnd": 32
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 61,
        "lineEnd": 95,
        "columnStart": 4,
        "columnEnd": 32
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "##########################################################################\n#\n# @file   Dockerfile\n# @brief  multiOTP open source docker image creator (based on Debian 8)\n#\n# multiOTP package - Strong two-factor authentication open source package\n# https://www\\.multiOTP.net/\n#\n# The multiOTP package is the lightest package available that provides so many\n# strong authentication functionalities and goodies, and best of all, for anyone\n# that is interested about security issues, it's a fully open source solution!\n#\n# This package is the result of a *LOT* of work. If you are happy using this\n# package, [Donation] are always welcome to support this project.\n# Please check https://www\\.multiOTP.net/ and you will find the magic button ;-)\n#\n# @author    Andre Liechti, SysCo systemes de communication sa, <info@multiotp.net>\n# @version   5.9.1.0\n# @date      2022-06-17\n# @since     2013-11-29\n# @copyright (c) 2013-2022 SysCo systemes de communication sa\n# @copyright GNU Lesser General Public License\n#\n# docker build .\n# docker run -v [PATH/TO/MULTIOTP/DATA/VOLUME]:/etc/multiotp -v [PATH/TO/FREERADIUS/CONFIG/VOLUME]:/etc/freeradius -v [PATH/TO/MULTIOTP/LOG/VOLUME]:/var/log/multiotp -v [PATH/TO/FREERADIUS/LOG/VOLUME]:/var/log/freeradius -p [HOST WWW PORT NUMBER]:80 -p [HOST SSL PORT NUMBER]:443 -p [HOST RADIUS-AUTH PORT NUMBER]:1812/udp -p [HOST RADIUS-ACCNT PORT NUMBER]:1813/udp -d xxxxxxxxxxxx\n#\n# 2022-05-08 5.8.8.4 SysCo/al Better docker support (also for Synology)\n# 2022-05-08 5.8.8.1 SysCo/al Add Raspberry Pi Bullseye 11.0 support\n# 2021-09-14 5.8.3.0 SysCo/al Debian Bullseye 11.0 support\n# 2021-05-19 5.8.2.3 SysCo/al Added php-bcmath\n# 2021-03-25 5.8.1.9 SysCo/al Remove apt-offline, which is not used\n# 2020-08-31 5.8.0.0 SysCo/al Debian Buster 10.5 support\n# 2019-10-22 5.6.1.3 SysCo/al Debian 10 support\n# 2019-01-07 5.4.1.1 SysCo/al Debian 9 support\n# 2018-03-20 5.1.1.2 SysCo/al Initial public Dockerfile release\n##########################################################################\n\nFROM debian:11\nENV DEBIAN 11\nENV PHPINSTALLPREFIX php\nENV PHPINSTALLPREFIXVERSION php7.4\nENV PHPVERSION 7.4\nENV SQLITEVERSION sqlite3\n\nMAINTAINER Andre Liechti <andre.liechti@multiotp.net>\nLABEL Description=\"multiOTP open source, running on Debian ${DEBIAN} with PHP${PHPVERSION}.\" \\\n      License=\"LGPL-3.0\" \\\n      Usage=\"docker run -v [PATH/TO/MULTIOTP/DATA/VOLUME]:/etc/multiotp -v [PATH/TO/FREERADIUS/CONFIG/VOLUME]:/etc/freeradius -v [PATH/TO/MULTIOTP/LOG/VOLUME]:/var/log/multiotp -v [PATH/TO/FREERADIUS/LOG/VOLUME]:/var/log/freeradius -p [HOST WWW PORT NUMBER]:80 -p [HOST SSL PORT NUMBER]:443 -p [HOST RADIUS-AUTH PORT NUMBER]:1812/udp -p [HOST RADIUS-ACCNT PORT NUMBER]:1813/udp -d multiotp-open-source\" \\\n      Version=\"5.9.1.0\"\n\nARG DEBIAN_FRONTEND=noninteractive\n\nRUN echo slapd slapd/internal/adminpw password rtzewrpiZRT753 | debconf-set-selections; \\\n    echo slapd slapd/internal/generated_adminpw password rtzewrpiZRT753 | debconf-set-selections; \\\n    echo slapd slapd/password2 password rtzewrpiZRT753 | debconf-set-selections; \\\n    echo slapd slapd/password1 password rtzewrpiZRT753 | debconf-set-selections;\n\n# Make sure you run apt-get update in the same line with\n# all the packages to ensure all are updated correctly.\n# (https://runnable.com/blog/9-common-dockerfile-mistakes)\nRUN apt-get update && \\\n    apt-get install --no-install-recommends -y \\\n    apache2-utils \\\n    apt-utils \\\n    build-essential \\\n    bzip2 \\\n    dialog \\\n    dselect \\\n    freeradius \\\n    initramfs-tools \\\n    ldap-utils \\\n    libbz2-dev \\\n    logrotate \\\n    nano \\\n    net-tools \\\n    nginx-extras \\\n    ntp \\\n    p7zip-full \\\n    php-pear \\\n    ${PHPINSTALLPREFIX}-bcmath \\\n    ${PHPINSTALLPREFIX}-cgi \\\n    ${PHPINSTALLPREFIX}-dev \\\n    ${PHPINSTALLPREFIX}-fpm \\\n    ${PHPINSTALLPREFIX}-gd \\\n    ${PHPINSTALLPREFIX}-gmp \\\n    ${PHPINSTALLPREFIX}-ldap \\\n    ${PHPINSTALLPREFIXVERSION}-${SQLITEVERSION} \\\n    slapd \\\n    snmp \\\n    snmpd \\\n    ${SQLITEVERSION} \\\n    subversion \\\n    sudo \\\n    unzip \\\n    wget \\\n    ${PHPINSTALLPREFIX}-mbstring && rm -rf /var/lib/apt/lists/*;\n\n\n############################################################\n# Offline local docker image creation\n############################################################\nCOPY raspberry/boot-part/*.sh /boot/\nCOPY raspberry/boot-part/multiotp-tree /boot/multiotp-tree/\n\n\n############################################################\n# Take online the latest version of multiOTP open source\n# (if you want to build an image with the latest\n#  available version instead of the local one)\n#\n# RUN wget -q https://download.multiotp.net/multiotp.zip -O /tmp/multiotp.zip && \\\n#     unzip -q -o /tmp/multiotp.zip -d /tmp/multiotp\n#\n# RUN mv /tmp/multiotp/raspberry/boot-part/* /boot && \\\n#     rm -rf /tmp/multiotp\n############################################################\n\n\nWORKDIR /\n\nRUN chmod 777 /boot/*.sh && \\\n    /boot/install.sh && \\\n    /boot/newvm.sh INIT\n\nEXPOSE 80/tcp 443/tcp 1812/udp 1813/udp\n\nVOLUME /etc/multiotp /etc/freeradius /var/log/multiotp /var/log/freeradius\n\nENTRYPOINT /boot/newvm.sh RUNDOCKER\n"
}