{
  "startTime": 1674253008304,
  "endTime": 1674253010127,
  "originalSmells": [
    {
      "rule": "yumInstallRmVarCacheYum",
      "position": {
        "lineStart": 19,
        "lineEnd": 19,
        "columnStart": 4,
        "columnEnd": 43
      }
    },
    {
      "rule": "yumInstallRmVarCacheYum",
      "position": {
        "lineStart": 21,
        "lineEnd": 21,
        "columnStart": 4,
        "columnEnd": 37
      }
    },
    {
      "rule": "yumInstallRmVarCacheYum",
      "position": {
        "lineStart": 22,
        "lineEnd": 22,
        "columnStart": 4,
        "columnEnd": 31
      }
    },
    {
      "rule": "yumInstallRmVarCacheYum",
      "position": {
        "lineStart": 23,
        "lineEnd": 23,
        "columnStart": 4,
        "columnEnd": 39
      }
    },
    {
      "rule": "yumInstallRmVarCacheYum",
      "position": {
        "lineStart": 24,
        "lineEnd": 24,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "yumInstallRmVarCacheYum",
      "position": {
        "lineStart": 27,
        "lineEnd": 27,
        "columnStart": 4,
        "columnEnd": 21
      }
    },
    {
      "rule": "yumInstallRmVarCacheYum",
      "position": {
        "lineStart": 28,
        "lineEnd": 28,
        "columnStart": 4,
        "columnEnd": 23
      }
    },
    {
      "rule": "yumInstallRmVarCacheYum",
      "position": {
        "lineStart": 30,
        "lineEnd": 30,
        "columnStart": 4,
        "columnEnd": 23
      }
    },
    {
      "rule": "yumInstallRmVarCacheYum",
      "position": {
        "lineStart": 31,
        "lineEnd": 31,
        "columnStart": 4,
        "columnEnd": 64
      }
    },
    {
      "rule": "yumInstallRmVarCacheYum",
      "position": {
        "lineStart": 32,
        "lineEnd": 32,
        "columnStart": 4,
        "columnEnd": 38
      }
    },
    {
      "rule": "yumInstallRmVarCacheYum",
      "position": {
        "lineStart": 33,
        "lineEnd": 33,
        "columnStart": 4,
        "columnEnd": 24
      }
    },
    {
      "rule": "yumInstallRmVarCacheYum",
      "position": {
        "lineStart": 34,
        "lineEnd": 34,
        "columnStart": 4,
        "columnEnd": 26
      }
    },
    {
      "rule": "yumInstallRmVarCacheYum",
      "position": {
        "lineStart": 35,
        "lineEnd": 35,
        "columnStart": 4,
        "columnEnd": 23
      }
    },
    {
      "rule": "yumInstallRmVarCacheYum",
      "position": {
        "lineStart": 36,
        "lineEnd": 36,
        "columnStart": 4,
        "columnEnd": 23
      }
    },
    {
      "rule": "yumInstallRmVarCacheYum",
      "position": {
        "lineStart": 80,
        "lineEnd": 80,
        "columnStart": 4,
        "columnEnd": 43
      }
    },
    {
      "rule": "yumInstallRmVarCacheYum",
      "position": {
        "lineStart": 82,
        "lineEnd": 82,
        "columnStart": 4,
        "columnEnd": 37
      }
    },
    {
      "rule": "yumInstallRmVarCacheYum",
      "position": {
        "lineStart": 83,
        "lineEnd": 83,
        "columnStart": 4,
        "columnEnd": 31
      }
    },
    {
      "rule": "yumInstallRmVarCacheYum",
      "position": {
        "lineStart": 84,
        "lineEnd": 84,
        "columnStart": 4,
        "columnEnd": 39
      }
    },
    {
      "rule": "yumInstallRmVarCacheYum",
      "position": {
        "lineStart": 85,
        "lineEnd": 85,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "yumInstallRmVarCacheYum",
      "position": {
        "lineStart": 88,
        "lineEnd": 88,
        "columnStart": 4,
        "columnEnd": 21
      }
    },
    {
      "rule": "yumInstallRmVarCacheYum",
      "position": {
        "lineStart": 89,
        "lineEnd": 89,
        "columnStart": 4,
        "columnEnd": 23
      }
    },
    {
      "rule": "yumInstallRmVarCacheYum",
      "position": {
        "lineStart": 91,
        "lineEnd": 91,
        "columnStart": 4,
        "columnEnd": 23
      }
    },
    {
      "rule": "yumInstallRmVarCacheYum",
      "position": {
        "lineStart": 92,
        "lineEnd": 92,
        "columnStart": 4,
        "columnEnd": 64
      }
    },
    {
      "rule": "yumInstallRmVarCacheYum",
      "position": {
        "lineStart": 93,
        "lineEnd": 93,
        "columnStart": 4,
        "columnEnd": 38
      }
    },
    {
      "rule": "yumInstallRmVarCacheYum",
      "position": {
        "lineStart": 94,
        "lineEnd": 94,
        "columnStart": 4,
        "columnEnd": 24
      }
    },
    {
      "rule": "yumInstallRmVarCacheYum",
      "position": {
        "lineStart": 95,
        "lineEnd": 95,
        "columnStart": 4,
        "columnEnd": 26
      }
    },
    {
      "rule": "yumInstallRmVarCacheYum",
      "position": {
        "lineStart": 96,
        "lineEnd": 96,
        "columnStart": 4,
        "columnEnd": 23
      }
    },
    {
      "rule": "yumInstallRmVarCacheYum",
      "position": {
        "lineStart": 97,
        "lineEnd": 97,
        "columnStart": 4,
        "columnEnd": 23
      }
    },
    {
      "rule": "yumInstallRmVarCacheYum",
      "position": {
        "lineStart": 98,
        "lineEnd": 98,
        "columnStart": 4,
        "columnEnd": 23
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "FROM centos:centos7 AS BUILD\n\nENV MAVEN_VERSION=3.6.3\nENV BASE_URL=https://apache.osuosl.org/maven/maven-3/${MAVEN_VERSION}/binaries\nENV USER_HOME_DIR=/root\nENV ANT_VERSION=1.10.3\nENV ANT_HOME=/opt/ant\n\n# Temporary Workaround to Surefire issue\nENV _JAVA_OPTIONS=-Djdk.net.URLClassPath.disableClassPathURLCheck=true\n\n# change to tmp folder\nWORKDIR /tmp\n\n\n\n# Update\nRUN yum update -y\n# Get Java\nRUN yum install java-1.8.0-openjdk-devel -y && rm -rf /var/cache/yum\n# Get dependencies\nRUN yum install centos-release-scl -y && rm -rf /var/cache/yum\nRUN yum install epel-release -y && rm -rf /var/cache/yum\nRUN yum install sclo-cassandra3-jffi -y && rm -rf /var/cache/yum\nRUN yum install python27 -y && rm -rf /var/cache/yum\n#scl enable python27 bash\nRUN source /etc/profile\nRUN yum install jq -y && rm -rf /var/cache/yum\nRUN yum install lsof -y && rm -rf /var/cache/yum\nRUN yum groupinstall \"Development tools\" -y\nRUN yum install curl -y && rm -rf /var/cache/yum\nRUN yum install perl-Test-Simple perl-version perl-Data-Dumpe -y && rm -rf /var/cache/yum\nRUN yum install dpkg-devel dpkg-dev -y && rm -rf /var/cache/yum\nRUN yum install httpd -y && rm -rf /var/cache/yum\nRUN yum install mod_ssl -y && rm -rf /var/cache/yum\nRUN yum install nano -y && rm -rf /var/cache/yum\nRUN yum install wget -y && rm -rf /var/cache/yum\n\nENV HOME /root\nENV JAVA_HOME /usr/lib/jvm/java-1.8.0\n# Download and extract maven\nRUN mkdir -p /usr/share/maven /usr/share/maven/ref \\\n  && curl -fsSL -o /tmp/apache-maven.tar.gz ${BASE_URL}/apache-maven-${MAVEN_VERSION}-bin.tar.gz \\\n  && tar -xzf /tmp/apache-maven.tar.gz -C /usr/share/maven --strip-components=1 \\\n  && rm -f /tmp/apache-maven.tar.gz \\\n  && ln -s /usr/share/maven/bin/mvn /usr/bin/mvn\n\n# Download and extract apache ant to opt folder\nRUN wget --no-check-certificate --no-cookies http://archive.apache.org/dist/ant/binaries/apache-ant-${ANT_VERSION}-bin.tar.gz \\\n    && wget --no-check-certificate --no-cookies http://archive.apache.org/dist/ant/binaries/apache-ant-${ANT_VERSION}-bin.tar.gz.sha512 \\\n    && echo \"$(cat apache-ant-${ANT_VERSION}-bin.tar.gz.sha512) apache-ant-${ANT_VERSION}-bin.tar.gz\" | sha512sum -c \\\n    && tar -zxf apache-ant-${ANT_VERSION}-bin.tar.gz -C /opt/ \\\n    && ln -s /opt/apache-ant-${ANT_VERSION} /opt/ant \\\n    && rm -f apache-ant-${ANT_VERSION}-bin.tar.gz \\\n    && rm -f apache-ant-${ANT_VERSION}-bin.tar.gz.sha512\n\n# add executables to path\nRUN update-alternatives --install \"/usr/bin/ant\" \"ant\" \"/opt/ant/bin/ant\" 1 && \\\n    update-alternatives --set \"ant\" \"/opt/ant/bin/ant\"\n\nENV MAVEN_HOME /usr/share/maven\nENV MAVEN_CONFIG \"$USER_HOME_DIR/.m2\"\n\nWORKDIR ./datafari\nCOPY . .\nRUN mvn -f pom.xml -Dorg.slf4j.simpleLogger.log.org.apache.maven.cli.transfer.Slf4jMavenTransferListener=warn -B clean install\nRUN ant clean-build -f ./linux/build.xml\n\nRUN mkdir /root/rpmbuild\nRUN mv linux/installer/redhat/* /root/rpmbuild\nRUN cd /root/rpmbuild/SPECS && rpmbuild -ba datafari.spec\nRUN mv /root/rpmbuild/RPMS/x86_64/datafari*.rpm /root/datafari.rpm\n\nFROM centos/systemd AS deploy\n\nMAINTAINER Olivier Tavard FRANCE LABS <olivier.tavard@francelabs.com>\n\n# Update\nRUN yum update -y\n# Get Java\nRUN yum install java-1.8.0-openjdk-devel -y && rm -rf /var/cache/yum\n# Get dependencies\nRUN yum install centos-release-scl -y && rm -rf /var/cache/yum\nRUN yum install epel-release -y && rm -rf /var/cache/yum\nRUN yum install sclo-cassandra3-jffi -y && rm -rf /var/cache/yum\nRUN yum install python27 -y && rm -rf /var/cache/yum\n#scl enable python27 bash\nRUN source /etc/profile\nRUN yum install jq -y && rm -rf /var/cache/yum\nRUN yum install lsof -y && rm -rf /var/cache/yum\nRUN yum groupinstall \"Development tools\" -y\nRUN yum install curl -y && rm -rf /var/cache/yum\nRUN yum install perl-Test-Simple perl-version perl-Data-Dumpe -y && rm -rf /var/cache/yum\nRUN yum install dpkg-devel dpkg-dev -y && rm -rf /var/cache/yum\nRUN yum install httpd -y && rm -rf /var/cache/yum\nRUN yum install mod_ssl -y && rm -rf /var/cache/yum\nRUN yum install nano -y && rm -rf /var/cache/yum\nRUN yum install wget -y && rm -rf /var/cache/yum\nRUN yum install sudo -y && rm -rf /var/cache/yum\n\nENV HOME /root\nENV JAVA_HOME /usr/lib/jvm/java-1.8.0\n\n# For dev\nRUN echo \"export LANG=C.UTF-8\" >> /etc/profile\nRUN echo \"export JAVA_HOME=/usr/local/openjdk-8\" >> /etc/profile\nRUN echo \"export PATH=$JAVA_HOME/bin:$PATH\" >> /etc/profile\n\nWORKDIR /var/datafari\nCOPY --from=BUILD /root/datafari.rpm .\nRUN rpm -ivh datafari.rpm\n\nEXPOSE 80 443\nWORKDIR /opt/datafari\nRUN  sed -i -e 's/sleep 10/sleep 30/g' /opt/datafari/bin/start-datafari.sh\nRUN systemctl enable httpd\nCMD [\"/usr/sbin/init\"]\n\n"
}