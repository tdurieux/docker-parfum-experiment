{
  "startTime": 1674246069037,
  "endTime": 1674246069933,
  "originalSmells": [
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 12,
        "lineEnd": 12,
        "columnStart": 4,
        "columnEnd": 50
      }
    },
    {
      "rule": "npmCacheCleanAfterInstall",
      "position": {
        "lineStart": 19,
        "lineEnd": 19,
        "columnStart": 4,
        "columnEnd": 15
      }
    },
    {
      "rule": "npmCacheCleanAfterInstall",
      "position": {
        "lineStart": 21,
        "lineEnd": 21,
        "columnStart": 4,
        "columnEnd": 41
      }
    },
    {
      "rule": "npmCacheCleanAfterInstall",
      "position": {
        "lineStart": 28,
        "lineEnd": 28,
        "columnStart": 4,
        "columnEnd": 22
      }
    },
    {
      "rule": "npmCacheCleanAfterInstall",
      "position": {
        "lineStart": 68,
        "lineEnd": 68,
        "columnStart": 4,
        "columnEnd": 69
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 6,
        "lineEnd": 6,
        "columnStart": 4,
        "columnEnd": 35
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 7,
        "lineEnd": 7,
        "columnStart": 4,
        "columnEnd": 28
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 8,
        "lineEnd": 8,
        "columnStart": 4,
        "columnEnd": 23
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 9,
        "lineEnd": 9,
        "columnStart": 4,
        "columnEnd": 26
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 10,
        "lineEnd": 10,
        "columnStart": 4,
        "columnEnd": 33
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 11,
        "lineEnd": 11,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 18,
        "lineEnd": 18,
        "columnStart": 4,
        "columnEnd": 29
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 20,
        "lineEnd": 20,
        "columnStart": 4,
        "columnEnd": 32
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 6,
        "lineEnd": 6,
        "columnStart": 4,
        "columnEnd": 35
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 7,
        "lineEnd": 7,
        "columnStart": 4,
        "columnEnd": 28
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 8,
        "lineEnd": 8,
        "columnStart": 4,
        "columnEnd": 23
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 9,
        "lineEnd": 9,
        "columnStart": 4,
        "columnEnd": 26
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 10,
        "lineEnd": 10,
        "columnStart": 4,
        "columnEnd": 33
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 11,
        "lineEnd": 11,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 18,
        "lineEnd": 18,
        "columnStart": 4,
        "columnEnd": 29
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 20,
        "lineEnd": 20,
        "columnStart": 4,
        "columnEnd": 32
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 6,
        "lineEnd": 6,
        "columnStart": 4,
        "columnEnd": 35
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 7,
        "lineEnd": 7,
        "columnStart": 4,
        "columnEnd": 28
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 8,
        "lineEnd": 8,
        "columnStart": 4,
        "columnEnd": 23
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 9,
        "lineEnd": 9,
        "columnStart": 4,
        "columnEnd": 26
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 10,
        "lineEnd": 10,
        "columnStart": 4,
        "columnEnd": 33
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 11,
        "lineEnd": 11,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 18,
        "lineEnd": 18,
        "columnStart": 4,
        "columnEnd": 29
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 20,
        "lineEnd": 20,
        "columnStart": 4,
        "columnEnd": 32
      }
    }
  ],
  "repairedSmells": [
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 6,
        "lineEnd": 6,
        "columnStart": 4,
        "columnEnd": 59
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 7,
        "lineEnd": 7,
        "columnStart": 4,
        "columnEnd": 52
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 8,
        "lineEnd": 8,
        "columnStart": 4,
        "columnEnd": 47
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 9,
        "lineEnd": 9,
        "columnStart": 4,
        "columnEnd": 50
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 10,
        "lineEnd": 10,
        "columnStart": 4,
        "columnEnd": 57
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 11,
        "lineEnd": 11,
        "columnStart": 4,
        "columnEnd": 51
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 18,
        "lineEnd": 18,
        "columnStart": 4,
        "columnEnd": 53
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 20,
        "lineEnd": 20,
        "columnStart": 4,
        "columnEnd": 56
      }
    }
  ],
  "repairedDockerfile": "FROM ubuntu:latest\n\nVOLUME /data\n#VOLUME /config\n\nRUN apt update\nRUN apt install --no-install-recommends -y tzdata apt-utils && rm -rf /var/lib/apt/lists/*;\nRUN apt install --no-install-recommends -y net-tools && rm -rf /var/lib/apt/lists/*;\nRUN apt install --no-install-recommends -y nano && rm -rf /var/lib/apt/lists/*;\nRUN apt-get install --no-install-recommends -y git && rm -rf /var/lib/apt/lists/*;\nRUN apt-get -y --no-install-recommends install curl gnupg && rm -rf /var/lib/apt/lists/*;\nRUN apt-get -y --no-install-recommends install sudo && rm -rf /var/lib/apt/lists/*;\nRUN curl -f -sL https://deb.nodesource.com/setup_10.x | bash -\nRUN mkdir -p /opt/meta\n\n\nWORKDIR /opt/meta\n\nRUN apt-get -y --no-install-recommends install nodejs && rm -rf /var/lib/apt/lists/*;\nRUN npm install && npm cache clean --force;\nRUN apt-get install --no-install-recommends -y mosquitto && rm -rf /var/lib/apt/lists/*;\nRUN npm install -g --unsafe-perm node-red && npm cache clean --force;\n\n#RUN mkdir -p /home\n#RUN mkdir -p /home/meta\n#RUN mkdir -p /home/meta/.meta\n#RUN chown -R 1000:1000 \"/home/meta/.meta\"\n\nRUN npm install pm2 -g && npm cache clean --force;\nRUN useradd -u 1000 -U -p \"$(openssl passwd -1 meta)\"  -d /config -s /bin/false meta\nRUN usermod -G users meta\nRUN adduser meta sudo\n\n# uncomment next command to prevent autodiscovery of brain\n#COPY config/config.js /opt/meta/node_modules/@jac459/metadriver/config.js\nCOPY scripts/startup.sh /scripts/startup.sh\n#COPY flows_cred.json /data/flows_cred.json\n#COPY flows.json /data/flows.json \n\n# Add configuration and scripts\n#ADD startup/ /etc/meta/\nRUN chown -R 1000:1000 \"/scripts\"\n\nRUN mkdir -p /config\nRUN mkdir -p /config/meta\nRUN mkdir -p /opt\nRUN mkdir -p /opt/meta\nRUN mkdir -p /config/.pm2\nRUN chown -R 1000:1000 \"/config\"\nRUN chown -R 1000:1000 \"/opt/meta\"\n\n# uncomment next command to prevent autodiscovery of brain\n#COPY config/config.js /opt/meta/node_modules/@jac459/metadriver/config.js\nCOPY scripts/startup.sh /scripts/startup.sh\n#COPY flows_cred.json /data/flows_cred.json\n#COPY flows.json /data/flows.json \n\n\n# Add configuration and scripts\n#ADD startup/ /etc/meta/ \n\nRUN pm2 startup\n              # Run this command as root, it sets up starting PM2, that needs to be done with root\n\nWORKDIR /opt/meta\n  # now we can continue as user = meta\nUSER meta\n\nRUN npm install --no-color --prefix \"/opt/meta/\"  jac459/metadriver && npm cache clean --force;\n#RUN pm2 start /opt/meta/node_modules/@jac459/metadriver/meta.js\n#RUN pm2 start mosquitto\n#RUN pm2 start node-red\n\n\nENV OPENVPN_USERDIR=**None**\nEXPOSE 1880-1883\nEXPOSE 3000\nexpose 4000-4100\n#RUN pm2 save\n# Expose port and run  \n#CMD [\"dumb-init\", \"bash -c 'sleep 99m'\"]\n#CMD /usr/bin/node /opt/meta/node_modules/@jac459/metadriver/meta.js\nCMD \"/scripts/startup.sh\"\n"
}