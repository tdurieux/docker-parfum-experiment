{
  "startTime": 1674252297934,
  "endTime": 1674252299299,
  "originalSmells": [
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 32,
        "lineEnd": 32,
        "columnStart": 4,
        "columnEnd": 31
      }
    },
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 60,
        "lineEnd": 60,
        "columnStart": 4,
        "columnEnd": 35
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "#\n# crashplan Dockerfile\n#\n# https://github.com/jlesage/docker-crashplan\n#\n\n# Pull base image.\nFROM jlesage/baseimage-gui:alpine-3.8-glibc-v3.5.2\n\n# Docker image version is provided via build arg.\nARG DOCKER_IMAGE_VERSION=unknown\n\n# Define software versions.\nARG CRASHPLAN_VERSION=4.8.4\nARG CRASHPLAN_JRE_VERSION=1.8.0_72\n\n# Define software download URLs.\nARG CRASHPLAN_URL=https://download.code42.com/installs/linux/install/CrashPlan/CrashPlan_${CRASHPLAN_VERSION}_Linux.tgz\nARG CRASHPLAN_JRE_URL=http://download.code42.com/installs/proserver/jre/jre-linux-x64-${CRASHPLAN_JRE_VERSION}.tgz\n\n# Define container build variables.\nARG TARGETDIR=/usr/local/crashplan\nARG MANIFESTDIR=/backupArchives\n\n# Define working directory.\nWORKDIR /tmp\n\n# Install CrashPlan.\nRUN \\\n    add-pkg --virtual build-dependencies cpio curl && \\\n    # Download CrashPlan.\n    echo \"Downloading CrashPlan...\" && \\\n    curl -f -# -L ${CRASHPLAN_URL} | tar -xz && \\\n    echo \"Installing CrashPlan...\" && \\\n    mkdir -p ${TARGETDIR} && \\\n    # Extract CrashPlan.\n    cat crashplan-install/CrashPlan_${CRASHPLAN_VERSION}.cpi | gzip -d -c - | cpio -i --no-preserve-owner --directory=${TARGETDIR} && \\\n    # Keep a copy of the default config.\n    mv ${TARGETDIR}/conf ${TARGETDIR}/conf.default && \\\n    # Make sure the UI connects by default to the engine using the loopback IP address (127.0.0.1).\n    sed-patch '/<helpNovice>STILL_RUNNING<\\/helpNovice>/a \\\\t<serviceUIConfig>\\n\\t\\t<serviceHost>127.0.0.1<\\/serviceHost>\\n\\t<\\/serviceUIConfig>' ${TARGETDIR}/conf.default/default.service.xml && \\\n      # Set the manifest path (directory for inbound backups).\n    sed-patch \"s|<backupConfig>|<backupConfig>\\n\\t\\t\\t<manifestPath>${MANIFESTDIR}</manifestPath>|g\" ${TARGETDIR}/conf.default/default.service.xml && \\\n    # Prevent automatic updates.\n    rm -r /usr/local/crashplan/upgrade && \\\n    touch /usr/local/crashplan/upgrade && chmod 400 /usr/local/crashplan/upgrade && \\\n    # The configuration directory should be stored outside the container.\n    ln -s /config/conf $TARGETDIR/conf && \\\n    # The run.conf file should be stored outside the container.\n    cp crashplan-install/scripts/run.conf ${TARGETDIR}/bin/run.conf.default && \\\n    ln -s /config/bin/run.conf $TARGETDIR/bin/run.conf && \\\n    # The cache directory should be stored outside the container.\n    ln -s /config/cache $TARGETDIR/cache && \\\n    # The log directory should be stored outside the container.\n    rm -r $TARGETDIR/log && \\\n    ln -s /config/log $TARGETDIR/log && \\\n    # The '/var/lib/crashplan' directory should be stored outside the container.\n    ln -s /config/var /var/lib/crashplan && \\\n    # Download and install the JRE.\n    echo \"Downloading and installing JRE...\" && \\\n    curl -f -# -L ${CRASHPLAN_JRE_URL} | tar -xz -C ${TARGETDIR} && \\\n    chown -R root:root ${TARGETDIR}/jre && \\\n    # Cleanup\n    del-pkg build-dependencies && \\\n    rm -rf /tmp/*\n\n# Install dependencies.\nRUN \\\n    add-pkg \\\n        gtk+2.0 \\\n        # For the monitor.\n        yad \\\n        bc \\\n        curl\n\n# Adjust the openbox config.\nRUN \\\n    # Maximize only the main/initial window.\n    sed-patch 's/<application type=\"normal\">/<application type=\"normal\" class=\"CrashPlan\">/' \\\n        /etc/xdg/openbox/rc.xml && \\\n    # Make sure the main window is always in the background.\n    sed-patch '/<application type=\"normal\" class=\"CrashPlan\">/a \\    <layer>below</layer>' \\\n        /etc/xdg/openbox/rc.xml\n\n# Enable log monitoring.\nRUN \\\n    sed-patch 's|LOG_FILES=|LOG_FILES=/config/log/service.log.0|' /etc/logmonitor/logmonitor.conf && \\\n    sed-patch 's|STATUS_FILES=|STATUS_FILES=/config/log/app.log|' /etc/logmonitor/logmonitor.conf\n\n# Generate and install favicons.\nRUN \\\n    APP_ICON_URL=https://github.com/jlesage/docker-templates/raw/master/jlesage/images/crashplan-icon.png && \\\n    install_app_icon.sh \"$APP_ICON_URL\"\n\n# Add files.\nCOPY rootfs/ /\n\n# Set environment variables.\nENV S6_WAIT_FOR_SERVICE_MAXTIME=9000 \\\n    APP_NAME=\"CrashPlan\" \\\n    KEEP_APP_RUNNING=1 \\\n    CRASHPLAN_DIR=${TARGETDIR} \\\n    JAVACOMMON=\"/usr/local/crashplan/jre/bin/java\"\n\n# Define mountable directories.\nVOLUME [\"/config\"]\nVOLUME [\"/storage\"]\nVOLUME [\"/backupArchives\"]\n\n# Expose ports.\n#   - 4242: Computer-to-computer connections.\n#   - 4243: Connection to the CrashPlan service.\nEXPOSE 4242 4243\n\n# Metadata.\nLABEL \\\n      org.label-schema.name=\"crashplan\" \\\n      org.label-schema.description=\"Docker container for CrashPlan\" \\\n      org.label-schema.version=\"$DOCKER_IMAGE_VERSION\" \\\n      org.label-schema.vcs-url=\"https://github.com/jlesage/docker-crashplan\" \\\n      org.label-schema.schema-version=\"1.0\"\n"
}