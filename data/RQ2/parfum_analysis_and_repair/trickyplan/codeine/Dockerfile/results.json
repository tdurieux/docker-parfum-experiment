{
  "startTime": 1674220515984,
  "endTime": 1674220516765,
  "originalSmells": [
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 66,
        "lineEnd": 66,
        "columnStart": 4,
        "columnEnd": 46
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "ARG PHP_VERSION=8.1\nFROM php:${PHP_VERSION}-fpm as codeine-builder\nLABEL maintainer=\"bergstein@trickyplan.com\"\nUSER root\n\nENV DEBIAN_FRONTEND=noninteractive\n\n# Install Debian Dependencies\nRUN apt-get update -q && \\\n    apt-get install --no-install-recommends -yq              \\\n    build-essential locales zip unzip git curl pkg-config     \\\n    libonig-dev libzip-dev libcurl4-openssl-dev               \\\n    libssl-dev libpng-dev libfreetype6-dev libmagickwand-dev  \\\n    libjpeg62-turbo-dev libyaml-dev  \\\n  && rm -rf /var/lib/apt/lists/*\n\n# Install PHP & PECL Extensions\nRUN curl  -fsSL https://github.com/FriendsOfPHP/pickle/releases/latest/download/pickle.phar \\\n          -o /usr/bin/pickle && \\\n    chmod +x /usr/bin/pickle\n\n# Install extensions\nRUN pickle install --no-interaction yaml@2.2.2 && \\\n    pickle install --no-interaction mongodb@1.12.0 && \\\n    pickle install --no-interaction imagick@3.6.0 && \\\n    pickle install --no-interaction igbinary@3.2.7 && \\\n    pickle install --no-interaction redis@5.3.7 && \\\n    pickle install --no-interaction zstd@0.11.0\n\nFROM php:${PHP_VERSION}-fpm as codeine-app\nLABEL maintainer=\"bergstein@trickyplan.com\"\nUSER root\nENV PHPEXTDIR=/usr/local/lib/php/extensions/no-debug-non-zts-20200930\n\nCOPY --from=codeine-builder $PHPEXTDIR/*.so  $PHPEXTDIR/\n\nRUN apt-get update -q && \\\n    apt-get install --no-install-recommends -yq oathtool locales \\\n    libgraphicsmagick-q16-3 libmagickwand-6.q16-6 \\\n    unzip curl libyaml-0-2 git && \\\n    rm -rf /var/lib/apt/lists/*\n\n# Install Debian Dependencies\nRUN apt-get update -q && \\\n    apt-get install --no-install-recommends -yq curl zip unzip \\\n    oathtool locales \\\n    libgraphicsmagick-q16-3 libmagickwand-6.q16-6 \\\n    unzip curl libyaml-0-2 git && \\\n    rm -rf /var/lib/apt/lists/*\n\n# Copy PHP-FPM configs\n\nCOPY docker/php/conf.d/*.ini /usr/local/etc/php/conf.d/\nCOPY docker/php-fpm.d/*.conf /usr/local/etc/php-fpm.d/\n\n# Add user for  application\nRUN if [ ! $(getent group codeine) ]; then groupadd -g 1000 codeine; fi\nRUN if [ ! $(getent passwd codeine) ]; then useradd -u 1000 -ms /bin/bash -g codeine codeine; fi\n\n# Composer\n\nCOPY --chown=codeine:codeine ./src /var/www/codeine/src\nCOPY --chown=codeine:codeine ./composer.json /var/www/codeine/\nCOPY --chown=codeine:codeine ./composer.lock /var/www/codeine/\nCOPY --chown=codeine:codeine ./index.php /var/www/codeine/\n\nRUN curl -f -sS https://getcomposer.org/installer | php -- --install-dir=/usr/local/bin --filename=composer\n\n# Composer Install\nWORKDIR /var/www/codeine\nRUN composer install\n\n# Copy src to /var/www/\nRUN chown -R codeine /var/www/codeine/vendor\n\nRUN if [ ! -d /var/www/codeine/src/Data ]; then mkdir /var/www/codeine/src/Data; fi\nRUN chmod -R 777 /var/www/codeine/src/Data\n\nRUN if [ ! -d /var/log/codeine ]; then mkdir /var/log/codeine; fi\nRUN chmod -R 777 /var/log/codeine\n\nRUN if [ ! -d /var/tmp/codeine ]; then mkdir /var/tmp/codeine; fi\nRUN chown -R codeine:codeine /var/tmp/codeine\n\n# Change current user to codeine\nUSER codeine\n\n# Expose port 9000 and start php-fpm server\nEXPOSE 9000\nCMD [\"php-fpm\"]\n"
}