{
  "startTime": 1674250139157,
  "endTime": 1674250140906,
  "originalSmells": [
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 13,
        "lineEnd": 13,
        "columnStart": 4,
        "columnEnd": 52
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 17,
        "lineEnd": 17,
        "columnStart": 4,
        "columnEnd": 68
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 13,
        "lineEnd": 13,
        "columnStart": 4,
        "columnEnd": 52
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 17,
        "lineEnd": 17,
        "columnStart": 4,
        "columnEnd": 68
      }
    }
  ],
  "repairedSmells": [
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 13,
        "lineEnd": 13,
        "columnStart": 4,
        "columnEnd": 52
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 17,
        "lineEnd": 17,
        "columnStart": 4,
        "columnEnd": 68
      }
    }
  ],
  "repairedDockerfile": "#\n# Munin Cron stats collector\n#\n\nFROM gcr.io/mcback/cron-base:latest\n\n# FIXME\nRUN apt-get -y update\n\n# Install packages\nRUN \\\n\n\n    apt-get -y --no-install-recommends install munin && \\\n    #\n    # Install one extra dependency to fix hostname resolution\n    # (https://github.com/munin-monitoring/munin/issues/1109#issuecomment-449397665)\n    apt-get -y --no-install-recommends install libio-socket-ssl-perl && \\\n    #\n    # Symlink logs to /dev/null\n    # (we can't write to /proc/1/fd/1 from unprivileged user, but --debug prints the same log to STDERR)\n    rm /var/log/munin/*.log && \\\n    ln -s /dev/null /var/log/munin/munin-html.log && \\\n    ln -s /dev/null /var/log/munin/munin-limits.log && \\\n    ln -s /dev/null /var/log/munin/munin-update.log && \\\n    #\n    #\n    # Don't generate graphs in Cron job as they'll be generated by CGI script\n    sed -i -e \"s/^#graph_strategy .*/graph_strategy cgi/\" /etc/munin/munin.conf && \\\n    #\n    # Remove localhost from configuration\n    sed -i -e \"s/^\\[localhost.*//\" /etc/munin/munin.conf && \\\n    sed -i -e \"s/\\s*address 127.*//\" /etc/munin/munin.conf && \\\n    sed -i -e \"s/\\s*use_node_name 127.*//\" /etc/munin/munin.conf && \\\n    #\n    # Create directory for PID file\n    mkdir -p /var/run/munin/ && \\\n    chown munin:munin /var/run/munin && \\\n    #\n    true && rm -rf /var/lib/apt/lists/*;\n\n# Replace misc. configuration with our own\nRUN rm -rf /etc/munin/munin-conf.d/\nCOPY munin-conf.d/ /etc/munin/munin-conf.d/\n\n# Overwrite crontab with our own\nCOPY crontab /etc/cron.d/munin\n\nCOPY bin/munin-cron.sh /\n\n# Volume for RRD data (shared with munin-fastcgi-graph)\nVOLUME /var/lib/munin/\n\n# Volume for generated HTML (shared with munin-httpd)\nVOLUME /var/cache/munin/www/\n\n# No USER because Cron will run the script as unprivileged user itself\n\n# Use our own wrapper for\nCMD [\"/munin-cron.sh\"]\n"
}