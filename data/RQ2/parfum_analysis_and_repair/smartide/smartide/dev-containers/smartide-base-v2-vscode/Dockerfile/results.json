{
  "startTime": 1674249147380,
  "endTime": 1674249147950,
  "originalSmells": [
    {
      "rule": "npmCacheCleanAfterInstall",
      "position": {
        "lineStart": 30,
        "lineEnd": 30,
        "columnStart": 7,
        "columnEnd": 35
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "#################################################\n# SmartIDE Developer Container Image\n# Licensed under GPL v3.0\n# Copyright (C) leansoftX.com\n#################################################\n\nFROM --platform=$TARGETPLATFORM registry.cn-hangzhou.aliyuncs.com/smartide/smartide-base-v2:latest\nARG TARGETPLATFORM\nARG PLATFORM\n\n\nUSER smartide\n# use sudo so that user does not get sudo usage info on (the first) login\nRUN sudo echo \"Running 'sudo' for smartide: success\" && \\\n    # create .bashrc.d folder and source it in the bashrc\n    mkdir -p /home/smartide/.bashrc.d && \\\n    (echo; echo \"for i in \\$(ls -A \\$HOME/.bashrc.d/); do source \\$HOME/.bashrc.d/\\$i; done\"; echo) >> /home/smartide/.bashrc\n\nENV HOME=/home/smartide\nWORKDIR $HOME\n\nENV NODE_VERSION=14.17.6\nENV NVM_DIR /home/smartide/.nvm\nRUN curl -fsSL https://raw.githubusercontent.com/nvm-sh/nvm/v0.38.0/install.sh | sh \\\n    && . $NVM_DIR/nvm.sh  \\\n    && nvm install $NODE_VERSION \\\n    && nvm install 12.22.7 \\\n    && nvm install 16.9.1 \\\n    && nvm alias default $NODE_VERSION \\\n    && nvm use $NODE_VERSION \\\n    && npm install -g yarn node-gyp \\\n    && echo \". ~/.nvm/nvm-lazy.sh\"  >> /home/smartide/.bashrc.d/50-node && npm cache clean --force;\n# above, we are adding the lazy nvm init to .bashrc, because one is executed on interactive shells, the other for non-interactive shells (e.g. plugin-host)\nCOPY --chown=smartide:smartide nvm-lazy.sh /home/smartide/.nvm/nvm-lazy.sh\nENV PATH $NVM_DIR/versions/node/v$NODE_VERSION/bin:$PATH\n\n\nUSER root\n\nRUN echo \"export NVM_DIR_ROOT=\\\"/home/smartide/.nvm\\\"\" >> /etc/profile && \\\n    echo \"[ -s \\\"\\$NVM_DIR_ROOT/nvm.sh\\\" ] && \\. \\\"\\$NVM_DIR_ROOT/nvm.sh\\\"\"  >> /etc/profile  && \\\n    echo \"[ -s \\\"\\$NVM_DIR_ROOT/bash_completion\\\" ] && \\. \\\"\\$NVM_DIR_ROOT/bash_completion\\\"\"  >> /etc/profile\n\nWORKDIR /home\n\n\n# COPY openvscode-images-arm64 opvscode\nCOPY openvscode-images-arm64 opvscode-arm64\nCOPY openvscode-images-amd64 opvscode-amd64\n\n\n\n#复制IDE文件\nSHELL [\"/bin/bash\", \"-c\"]\nRUN if [ \"$TARGETPLATFORM\" = \"linux/arm64\" ];then mv opvscode-arm64/* opvscode;mv opvscode/bin/remote-cli/openvscode-server opvscode/bin/remote-cli/code;else mv opvscode-amd64/* opvscode;mv opvscode/bin/remote-cli/openvscode-server opvscode/bin/remote-cli/code;fi\n\n\n\nENV LANG=C.UTF-8 \\\n    LC_ALL=C.UTF-8 \\\n    EDITOR=code \\\n    VISUAL=code \\\n    GIT_EDITOR=\"code --wait\" \\\n    OPENVSCODE_SERVER_ROOT=/home/opvscode\n\nRUN  ln -sf /home/smartide/.nvm/versions/node/v$NODE_VERSION/bin/node /home/opvscode\n\n\nCOPY gosu_entrypoint_base.sh /idesh/gosu_entrypoint_base.sh\nRUN chmod +x /idesh/gosu_entrypoint_base.sh\n\nENTRYPOINT [\"/idesh/gosu_entrypoint_base.sh\"]\n\n# COPY openvscode.service /lib/systemd/system/\n# COPY startup-openvscode.sh /idesh/startup-openvscode.sh\n\n# RUN chmod +x /idesh/startup-openvscode.sh &&                               \\\n#     ln -sf /lib/systemd/system/openvscode.service                    \\\n#        /etc/systemd/system/multi-user.target.wants/openvscode.service\n"
}