{
  "startTime": 1674256237831,
  "endTime": 1674256241338,
  "originalSmells": [
    {
      "rule": "wgetUseHttpsUrl",
      "position": {
        "lineStart": 41,
        "lineEnd": 41,
        "columnStart": 4,
        "columnEnd": 82
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "#RUN yum install -y https://iso.yunion.cn/vm-images/baremetal-pxerom-1.1.0-21092209.x86_64.rpm\n#RUN yum install -y http://192.168.23.50:8083/baremetal-pxerom-1.1.0-21092209.x86_64.rpm\nFROM registry.cn-beijing.aliyuncs.com/yunionio/yunionos:v0.1.4 as yunionos\n\nFROM centos:8 as grub-stage\n\nRUN dnf install -y grub2*\n\n# make grub_booti386 firmware\nRUN grub2-mkimage -d /usr/lib/grub/i386-pc/ -O i386-pc-pxe -o /root/grub_booti386 -p '/grub' pxe tftp boot linux ext2 xfs ntfs fat part_msdos part_gpt normal biosdisk\n# make grub_bootx64 firmware\nRUN grub2-mkimage -d /usr/lib/grub/x86_64-efi/ -O x86_64-efi -o /root/grub_bootx64.efi -p '/grub' efinet tftp boot linux ext2 xfs ntfs fat part_msdos part_gpt normal efi_gop\n# make grub_arm64 firmware\nRUN grub2-mkimage -d /usr/lib/grub/arm64-efi/ -O arm64-efi -o /root/grub_arm64.efi -p '/grub' efinet tftp boot linux ext2 xfs ntfs fat part_msdos part_gpt normal efi_gop\n\nRUN mkdir -p /tftp/grub\n\nRUN cp /root/grub_booti386 /tftp\nRUN cp -rf /usr/lib/grub/i386-pc /tftp/grub\n\nRUN cp /root/grub_bootx64.efi /tftp\nRUN cp -rf /usr/lib/grub/x86_64-efi /tftp/grub\n\nRUN cp /root/grub_arm64.efi /tftp\nRUN cp -rf /usr/lib/grub/arm64-efi /tftp/grub\n\n\nFROM registry.cn-beijing.aliyuncs.com/yunionio/onecloud-base:v0.3-3.13.5\n\nMAINTAINER \"Zexi Li <zexi.li@icloud.com>\"\n\nRUN mkdir -p /opt/yunion/bin\n\nRUN apk update && \\\n    apk add --no-cache ipmitool ethtool tzdata ca-certificates cdrkit coreutils librados librbd && \\\n    rm -rf /var/cache/apk/*\n\nRUN mkdir -p /opt/cloud/yunion/baremetal\n\n# udpate latest pci.ids\nRUN wget -O /opt/cloud/yunion/baremetal/pci.ids https://pci-ids.ucw.cz/v2.2/pci.ids\n\n# download baremetal-pxerom-*.x86_64.rpm and unpack rpm in current directory\n#COPY --from=build /opt/cloud/yunion/baremetal/bootia32.efi /opt/cloud/yunion/baremetal\n#COPY --from=build /opt/cloud/yunion/baremetal/bootx64.efi /opt/cloud/yunion/baremetal\n#COPY --from=build /opt/cloud/yunion/baremetal/chain.c32 /opt/cloud/yunion/baremetal\n#COPY --from=build ./opt/cloud/yunion/baremetal/initramfs /opt/cloud/yunion/baremetal\n#COPY --from=build ./opt/cloud/yunion/baremetal/isolinux.bin /opt/cloud/yunion/baremetal\n#COPY --from=build ./opt/cloud/yunion/baremetal/kernel /opt/cloud/yunion/baremetal\n#COPY --from=build ./opt/cloud/yunion/baremetal/ldlinux.c32 /opt/cloud/yunion/baremetal\n#COPY --from=build ./opt/cloud/yunion/baremetal/ldlinux.e32 /opt/cloud/yunion/baremetal\n#COPY --from=build ./opt/cloud/yunion/baremetal/ldlinux.e64 /opt/cloud/yunion/baremetal\n#COPY --from=build ./opt/cloud/yunion/baremetal/libcom32.c32 /opt/cloud/yunion/baremetal\n#COPY --from=build ./opt/cloud/yunion/baremetal/libutil.c32 /opt/cloud/yunion/baremetal\n#COPY --from=build ./opt/cloud/yunion/baremetal/lpxelinux.0 /opt/cloud/yunion/baremetal\n#COPY --from=build ./opt/cloud/yunion/baremetal/menu.c32 /opt/cloud/yunion/baremetal\n#COPY --from=build ./opt/cloud/yunion/baremetal/pxelinux.0 /opt/cloud/yunion/baremetal\n\n# copy grub file\nCOPY --from=grub-stage /tftp/grub_booti386 /opt/cloud/yunion/baremetal\nCOPY --from=grub-stage /tftp/grub_bootx64.efi /opt/cloud/yunion/baremetal\nCOPY --from=grub-stage /tftp/grub_arm64.efi /opt/cloud/yunion/baremetal\nCOPY --from=grub-stage /tftp/grub /opt/cloud/yunion/baremetal/grub\n\n# copy boot files from yunionos\nCOPY --from=yunionos /yunionos/x86_64/kernel /opt/cloud/yunion/baremetal\nCOPY --from=yunionos /yunionos/x86_64/initramfs /opt/cloud/yunion/baremetal\nCOPY --from=yunionos /yunionos/aarch64/kernel /opt/cloud/yunion/baremetal/kernel_aarch64\nCOPY --from=yunionos /yunionos/aarch64/initramfs /opt/cloud/yunion/baremetal/initramfs_aarch64\n\n# TODO: syslinux firmwares should removed in future\nCOPY --from=yunionos /yunionos/x86_64/isolinux.bin /opt/cloud/yunion/baremetal\nCOPY --from=yunionos /yunionos/x86_64/bootia32.efi /opt/cloud/yunion/baremetal\nCOPY --from=yunionos /yunionos/x86_64/bootx64.efi /opt/cloud/yunion/baremetal\nCOPY --from=yunionos /yunionos/x86_64/chain.c32 /opt/cloud/yunion/baremetal\nCOPY --from=yunionos /yunionos/x86_64/initramfs /opt/cloud/yunion/baremetal\nCOPY --from=yunionos /yunionos/x86_64/kernel /opt/cloud/yunion/baremetal\nCOPY --from=yunionos /yunionos/x86_64/ldlinux.c32 /opt/cloud/yunion/baremetal\nCOPY --from=yunionos /yunionos/x86_64/ldlinux.e32 /opt/cloud/yunion/baremetal\nCOPY --from=yunionos /yunionos/x86_64/ldlinux.e64 /opt/cloud/yunion/baremetal\nCOPY --from=yunionos /yunionos/x86_64/libcom32.c32 /opt/cloud/yunion/baremetal\nCOPY --from=yunionos /yunionos/x86_64/libutil.c32 /opt/cloud/yunion/baremetal\nCOPY --from=yunionos /yunionos/x86_64/lpxelinux.0 /opt/cloud/yunion/baremetal\nCOPY --from=yunionos /yunionos/x86_64/menu.c32 /opt/cloud/yunion/baremetal\nCOPY --from=yunionos /yunionos/x86_64/pxelinux.0 /opt/cloud/yunion/baremetal\n"
}