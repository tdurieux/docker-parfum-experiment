{
  "startTime": 1674219502892,
  "endTime": 1674219503454,
  "originalSmells": [
    {
      "rule": "npmCacheCleanAfterInstall",
      "position": {
        "lineStart": 45,
        "lineEnd": 45,
        "columnStart": 17,
        "columnEnd": 28
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 32,
        "lineEnd": 32,
        "columnStart": 4,
        "columnEnd": 38
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 37,
        "lineEnd": 37,
        "columnStart": 4,
        "columnEnd": 47
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "FROM centos/httpd\n\nRUN rpm -Uhv https://dl.fedoraproject.org/pub/epel/7/x86_64/Packages/e/epel-release-7-11.noarch.rpm && \\\n    yum -y --setopt=tsflags=nodocs install centos-release-scl && \\\n    yum -y --setopt=tsflags=nodocs install rh-python35 gcc mariadb-devel \\\n    libxml2-devel libxslt-devel httpd-devel mod_wsgi mod_ssl npm && \\\n    yum -y update --setopt=tsflags=nodocs\n\n# static configuration for Apache\nCOPY ./etc/kiwi-httpd.conf /etc/httpd/conf.d/\n\n# configure uploads directory\nRUN mkdir -p /var/kiwi/uploads && chown apache:apache /var/kiwi/uploads\n\n# make sure Python 3.5 is enabled by default\nENV PATH /opt/rh/rh-python35/root/usr/bin${PATH:+:${PATH}}\nENV LD_LIBRARY_PATH /opt/rh/rh-python35/root/usr/lib64${LD_LIBRARY_PATH:+:${LD_LIBRARY_PATH}}\nENV PKG_CONFIG_PATH /opt/rh/rh-python35/root/usr/lib64/pkgconfig${PKG_CONFIG_PATH:+:${PKG_CONFIG_PATH}}\nENV XDG_DATA_DIRS \"/opt/rh/rh-python35/root/usr/share:${XDG_DATA_DIRS:-/usr/local/share:/usr/share}\"\n\n# Create a virtualenv for the application dependencies\nRUN virtualenv /venv\n\n# Set virtualenv environment variables. This is equivalent to running\n# source /env/bin/activate. This ensures the application is executed within\n# the context of the virtualenv and will have access to its dependencies.\nENV VIRTUAL_ENV /venv\nENV PATH /venv/bin:$PATH\n\n\n# Install Kiwi TCMS dependencies and replace\n# standard mod_wsgi with one compiled for Python 3\nRUN pip install --no-cache-dir --upgrade pip mod_wsgi && \\\n    ln -fs /venv/lib64/python3.5/site-packages/mod_wsgi/server/mod_wsgi-py35.cpython-35m-x86_64-linux-gnu.so \\\n           /usr/lib64/httpd/modules/mod_wsgi.so\n\nCOPY ./requirements/ /Kiwi/requirements/\nRUN pip install --no-cache-dir -r /Kiwi/requirements/mysql.txt\n\n# Add manage.py\nCOPY ./manage.py /Kiwi/\nRUN sed -i \"s/tcms.settings.devel/tcms.settings.product/\" /Kiwi/manage.py\n\n# install patternfly\nCOPY package.json /Kiwi/\nRUN cd /Kiwi/ && npm install && \\\n    find ./node_modules -type f -not -path \"*/dist/*\" -delete && \\\n    find ./node_modules -type d -empty -delete && npm cache clean --force;\n\n# Copy the application code to the virtual environment\nCOPY ./tcms/ /venv/lib64/python3.5/site-packages/tcms/\n\n# collect static files\nRUN /Kiwi/manage.py collectstatic --noinput\n"
}