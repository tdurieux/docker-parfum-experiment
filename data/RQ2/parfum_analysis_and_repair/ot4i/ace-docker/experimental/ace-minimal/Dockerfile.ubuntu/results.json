{
  "startTime": 1674254243600,
  "endTime": 1674254244711,
  "originalSmells": [
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 45,
        "lineEnd": 45,
        "columnStart": 4,
        "columnEnd": 24
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "FROM ubuntu:20.04\n\n# docker build -t ace-minimal:12.0.4.0-ubuntu -f Dockerfile.ubuntu .\n\nMAINTAINER Trevor Dolby <tdolby@uk.ibm.com> (@tdolby)\n\nARG DOWNLOAD_URL=http://public.dhe.ibm.com/ibmdl/export/pub/software/websphere/integration/12.0.4.0-ACE-LINUX64-DEVELOPER.tar.gz\nARG PRODUCT_LABEL=ace-12.0.4.0\n\n# Prevent errors about having no terminal when using apt-get\nENV DEBIAN_FRONTEND noninteractive\n\n# Set up exclusions\nCOPY excludes*txt /tmp/\n\nRUN cat /tmp/excludes-base.txt >> /tmp/all-excludes.txt && \\\n# Adapters are optional\n    cat /tmp/excludes-adapters.txt >> /tmp/all-excludes.txt && \\\n# CICS is optional\n    cat /tmp/excludes-cics.txt >> /tmp/all-excludes.txt && \\\n# FTE is optional\n    cat /tmp/excludes-fte.txt >> /tmp/all-excludes.txt && \\\n# GlobalCache is optional; set MQSI_NO_CACHE_SUPPORT=1\n    cat /tmp/excludes-globalcache.txt >> /tmp/all-excludes.txt && \\\n# IMS is optional\n    cat /tmp/excludes-ims.txt >> /tmp/all-excludes.txt && \\\n# node.js support is optional; use --no-nodejs on server start line\n    cat /tmp/excludes-nodejs.txt >> /tmp/all-excludes.txt && \\\n# NPM install support is optional\n    cat /tmp/excludes-npm.txt >> /tmp/all-excludes.txt && \\\n# ODBC drivers are optional\n    cat /tmp/excludes-odbc.txt >> /tmp/all-excludes.txt && \\\n# Toolkit is optional\n    cat /tmp/excludes-tools.txt >> /tmp/all-excludes.txt && \\\n# Web UI support optional; use --admin-rest-api -1 on server start line\n    cat /tmp/excludes-webui.txt >> /tmp/all-excludes.txt && \\\n# WSRR nodes are optional\n    cat /tmp/excludes-wsrr.txt >> /tmp/all-excludes.txt && \\\n# XSLT nodes are optional\n    cat /tmp/excludes-xmlt.txt >> /tmp/all-excludes.txt\n\n# Install ACE and accept the license\nRUN apt-get update && apt-get install -y --no-install-recommends curl zip binutils && \\\n    mkdir /opt/ibm && \\\n    echo Downloading package ${DOWNLOAD_URL} && \\\n    curl -f ${DOWNLOAD_URL} \\\n    | tar zx --exclude-from=/tmp/all-excludes.txt --directory /opt/ibm && \\\n    mv /opt/ibm/${PRODUCT_LABEL} /opt/ibm/ace-12 && \\\n    find /opt/ibm -name \"*.so*\" -exec strip {} \";\" && \\\n    find /opt/ibm -name \"*.wrk\" -exec strip {} \";\" && \\\n    find /opt/ibm -name \"*.lil\" -exec strip {} \";\" && \\\n    ( strip /opt/ibm/ace-12/server/bin/* 2>/dev/null || /bin/true ) && \\\n    zip -d /opt/ibm/ace-12/common/classes/IntegrationAPI.jar BIPmsgs_de.properties BIPmsgs_es.properties BIPmsgs_fr.properties BIPmsgs_it.properties BIPmsgs_ja.properties BIPmsgs_ko.properties BIPmsgs_pl.properties BIPmsgs_pt_BR.properties BIPmsgs_ru.properties BIPmsgs_tr.properties BIPmsgs_zh.properties BIPmsgs_zh_HK.properties BIPmsgs_zh_TW.properties && \\\n    if [ $(uname -m) = x86_64 ]; then apt-get remove -y zip binutils binutils-common libbinutils binutils-x86-64-linux-gnu; else apt-get remove -y zip binutils binutils-common libbinutils; fi && \\\n    rm -rf /var/lib/apt/lists/* && \\\n    /opt/ibm/ace-12/ace make registry global accept license deferred\n\n# Configure the system and increase security\nRUN echo \"ACE_12:\" > /etc/debian_chroot \\\n  && sed -i 's/sha512/sha512 minlen=8/' /etc/pam.d/common-password \\\n  && sed -i 's/PASS_MIN_DAYS\\t0/PASS_MIN_DAYS\\t1/' /etc/login.defs \\\n  && sed -i 's/PASS_MAX_DAYS\\t99999/PASS_MAX_DAYS\\t90/' /etc/login.defs \\\n  && echo \". /opt/ibm/ace-12/server/bin/mqsiprofile\" >> /root/.bashrc\n\n# Set BASH_ENV to source mqsiprofile when using docker exec bash -c\nENV BASH_ENV=/opt/ibm/ace-12/server/bin/mqsiprofile\n\n# Create a user to run as, create the ace workdir, and chmod script files\nRUN useradd  --uid 1001 --create-home --home-dir /home/aceuser --shell /bin/bash -G mqbrkrs,sudo aceuser \\\n  && su - aceuser -c \"export LICENSE=accept && . /opt/ibm/ace-12/server/bin/mqsiprofile && mqsicreateworkdir /home/aceuser/ace-server\" \\\n  && echo \". /opt/ibm/ace-12/server/bin/mqsiprofile\" >> /home/aceuser/.bashrc\n\n# Install useful utilities, and the latest of everything to keep security scanners happy\nRUN apt-get update && apt-get install -y --no-install-recommends \\\n    ca-certificates \\\n    curl \\\n    tzdata \\\n    unzip \\\n    zip \\\n  && apt-get -y  dist-upgrade \\\n  && rm -rf /var/lib/apt/lists/*\n\n# aceuser\nUSER 1001\n\n# Only needed if CacheSupport is disabled above\nENV MQSI_NO_CACHE_SUPPORT=1\n\n# Leaving this blank to avoid issues with openshift\n#ENTRYPOINT [\"bash\"]\n"
}