{
  "startTime": 1674255444460,
  "endTime": 1674255445686,
  "originalSmells": [
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 41,
        "lineEnd": 41,
        "columnStart": 4,
        "columnEnd": 29
      }
    },
    {
      "rule": "yumInstallRmVarCacheYum",
      "position": {
        "lineStart": 28,
        "lineEnd": 37,
        "columnStart": 4,
        "columnEnd": 12
      }
    },
    {
      "rule": "tarSomethingRmTheSomething",
      "position": {
        "lineStart": 130,
        "lineEnd": 130,
        "columnStart": 1,
        "columnEnd": 27
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "# Copyright Â© 2019, Octave Online LLC\n#\n# This file is part of Octave Online Server.\n#\n# Octave Online Server is free software: you can redistribute it and/or modify\n# it under the terms of the GNU Affero General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or (at your\n# option) any later version.\n#\n# Octave Online Server is distributed in the hope that it will be useful, but\n# WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY\n# or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU Affero General Public\n# License for more details.\n#\n# You should have received a copy of the GNU Affero General Public License\n# along with Octave Online Server.  If not, see\n# <https://www.gnu.org/licenses/>.\n\nARG FULL_BASE_IMAGE\nFROM $FULL_BASE_IMAGE\n\n# Install some popular Octave Forge packages.\n# If a package fails to install, try building the image again and it might work the second time.\n# Most packages are auto-loaded via octaverc (since version 4.2.1) except for the following packages that shadow core library functions or are slow to load: tsa, stk, ltfat, and nan.\n# Note: The package list gets written to /usr/local/share/octave/octave_packages\n\n# rpmfusion is required for ffmpeg\nRUN dnf install -y --nogpgcheck https://download1.rpmfusion.org/free/el/rpmfusion-free-release-8.noarch.rpm\nRUN yum install -y \\\n\tunits \\\n\tmpfr-devel \\\n\tportaudio-devel \\\n\tpatch \\\n\tncurses-devel \\\n\tlibicu-devel \\\n\tffmpeg-devel \\\n\tnetcdf-devel \\\n\tpython3-pip && rm -rf /var/cache/yum\n\n# TODO: install version 1.5.1 until the symbolic package is fixed:\n# https://github.com/cbm755/octsympy/issues/1023\nRUN pip3 install --no-cache-dir sympy==1.5.1\n\nARG PKG_BASE_URL=https://downloads.sourceforge.net/project/octave/Octave%20Forge%20Packages/Individual%20Package%20Releases\n\nRUN mkdir pkg-downloads\n\nRUN cd pkg-downloads && wget $PKG_BASE_URL/control-3.3.1.tar.gz && \\\n\tLC_ALL=C /usr/local/bin/octave -q --eval \"pkg install control-3.3.1.tar.gz;\"\n\nRUN cd pkg-downloads && wget $PKG_BASE_URL/signal-1.4.1.tar.gz && \\\n\tLC_ALL=C /usr/local/bin/octave -q --eval \"pkg install signal-1.4.1.tar.gz;\"\n\n# NOTE: The signal package is not compatible with Octave 7.0.1:\n# https://sourceforge.net/p/octave/signal/merge-requests/3/\n# RUN cd pkg-downloads && \\\n# \thg clone -r o7compat http://hg.code.sf.net/u/octave-online/signal && \\\n# \t(cd signal && hg archive signal.tar.gz) && \\\n# \tLC_ALL=C /usr/local/bin/octave -q --eval \"pkg install signal/signal.tar.gz;\"\n\nRUN cd pkg-downloads && wget $PKG_BASE_URL/communications-1.2.3.tar.gz && \\\n\tLC_ALL=C /usr/local/bin/octave -q --eval \"pkg install communications-1.2.3.tar.gz;\"\n\nRUN cd pkg-downloads && wget $PKG_BASE_URL/struct-1.0.17.tar.gz && \\\n\tLC_ALL=C /usr/local/bin/octave -q --eval \"pkg install struct-1.0.17.tar.gz;\"\n\nRUN cd pkg-downloads && wget $PKG_BASE_URL/io-2.6.3.tar.gz && \\\n\tLC_ALL=C /usr/local/bin/octave -q --eval \"pkg install io-2.6.3.tar.gz;\"\n\nRUN cd pkg-downloads && wget $PKG_BASE_URL/statistics-1.4.3.tar.gz && \\\n\tLC_ALL=C /usr/local/bin/octave -q --eval \"pkg install statistics-1.4.3.tar.gz;\"\n\nRUN cd pkg-downloads && wget $PKG_BASE_URL/optim-1.6.1.tar.gz && \\\n\tLC_ALL=C /usr/local/bin/octave -q --eval \"pkg install optim-1.6.1.tar.gz;\"\n\nRUN cd pkg-downloads && wget $PKG_BASE_URL/image-2.12.0.tar.gz && \\\n\tLC_ALL=C /usr/local/bin/octave -q --eval \"pkg install image-2.12.0.tar.gz;\"\n\nRUN cd pkg-downloads && wget $PKG_BASE_URL/general-2.1.1.tar.gz && \\\n\tLC_ALL=C /usr/local/bin/octave -q --eval \"pkg install general-2.1.1.tar.gz;\"\n\nRUN cd pkg-downloads && wget $PKG_BASE_URL/matgeom-1.2.3.tar.gz && \\\n\tLC_ALL=C /usr/local/bin/octave -q --eval \"pkg install matgeom-1.2.3.tar.gz;\"\n\nRUN cd pkg-downloads && wget $PKG_BASE_URL/linear-algebra-2.2.3.tar.gz && \\\n\tLC_ALL=C /usr/local/bin/octave -q --eval \"pkg install linear-algebra-2.2.3.tar.gz;\"\n\nRUN cd pkg-downloads && wget $PKG_BASE_URL/geometry-4.0.0.tar.gz && \\\n\tLC_ALL=C /usr/local/bin/octave -q --eval \"pkg install geometry-4.0.0.tar.gz;\"\n\n# NOTE: The geometry package has a compile error with modern GCC:\n# https://sourceforge.net/p/octave/geometry/ci/04965cda30b5f9e51774194c67879e7336df1710/\nRUN cd pkg-downloads && \\\n\thg clone -r 04965c http://hg.code.sf.net/p/octave/geometry && \\\n\t(cd geometry && hg archive geometry.tar.gz) && \\\n\tLC_ALL=C /usr/local/bin/octave -q --eval \"pkg install geometry/geometry.tar.gz;\"\n\nRUN cd pkg-downloads && wget $PKG_BASE_URL/data-smoothing-1.3.0.tar.gz && \\\n\tLC_ALL=C /usr/local/bin/octave -q --eval \"pkg install data-smoothing-1.3.0.tar.gz;\"\n\nRUN cd pkg-downloads && wget $PKG_BASE_URL/nan-3.6.1.tar.gz && \\\n\tLC_ALL=C /usr/local/bin/octave -q --eval \"pkg install nan-3.6.1.tar.gz;\"\n\n# TODO: Remove?\nRUN cd pkg-downloads && wget $PKG_BASE_URL/tsa-4.6.3.tar.gz && \\\n\tLC_ALL=C /usr/local/bin/octave -q --eval \"pkg install tsa-4.6.3.tar.gz;\"\n\nRUN cd pkg-downloads && wget $PKG_BASE_URL/miscellaneous-1.3.0.tar.gz && \\\n\tLC_ALL=C /usr/local/bin/octave -q --eval \"pkg install miscellaneous-1.3.0.tar.gz;\"\n\nRUN cd pkg-downloads && wget $PKG_BASE_URL/interval-3.2.0.tar.gz && \\\n\tLC_ALL=C /usr/local/bin/octave -q --eval \"pkg install interval-3.2.0.tar.gz;\"\n\n# TODO: Remove?\nRUN cd pkg-downloads && wget $PKG_BASE_URL/stk-2.6.1.tar.gz && \\\n\tLC_ALL=C /usr/local/bin/octave -q --eval \"pkg install stk-2.6.1.tar.gz;\"\n\nRUN cd pkg-downloads && wget $PKG_BASE_URL/mapping-1.4.1.tar.gz && \\\n\tLC_ALL=C /usr/local/bin/octave -q --eval \"pkg install mapping-1.4.1.tar.gz;\"\n\nRUN cd pkg-downloads && wget $PKG_BASE_URL/financial-0.5.3.tar.gz && \\\n\tLC_ALL=C /usr/local/bin/octave -q --eval \"pkg install financial-0.5.3.tar.gz;\"\n\nRUN cd pkg-downloads && wget $PKG_BASE_URL/symbolic-2.9.0.tar.gz && \\\n\tLC_ALL=C /usr/local/bin/octave -q --eval \"pkg install symbolic-2.9.0.tar.gz;\"\n\n# Workaround for bug in package ltfat:\n# https://github.com/ltfat/ltfat/issues/115\nCOPY containers/octave-pkg/ltfat.patch pkg-downloads/ltfat.patch\nRUN cd pkg-downloads && wget $PKG_BASE_URL/ltfat-2.3.1.tar.gz && \\\n\ttar zxf ltfat-2.3.1.tar.gz && \\\n\tpatch --ignore-whitespace -p0 < ltfat.patch && \\\n\ttar czf ltfat_fix.tar.gz ltfat && \\\n\tLC_ALL=C /usr/local/bin/octave -q --eval \"pkg install ltfat_fix.tar.gz;\" && rm ltfat-2.3.1.tar.gz\n\nRUN cd pkg-downloads && wget $PKG_BASE_URL/video-2.0.2.tar.gz && \\\n\tLC_ALL=C /usr/local/bin/octave -q --eval \"pkg install video-2.0.2.tar.gz;\"\n\nRUN cd pkg-downloads && wget $PKG_BASE_URL/netcdf-1.0.14.tar.gz && \\\n\tLC_ALL=C /usr/local/bin/octave -q --eval \"pkg install netcdf-1.0.14.tar.gz;\"\n\nRUN cd pkg-downloads && wget $PKG_BASE_URL/dataframe-1.2.0.tar.gz && \\\n\tLC_ALL=C /usr/local/bin/octave -q --eval \"pkg install dataframe-1.2.0.tar.gz;\"\n\nRUN cd pkg-downloads && wget $PKG_BASE_URL/mvn-1.1.0.tar.gz && \\\n\tLC_ALL=C /usr/local/bin/octave -q --eval \"pkg install mvn-1.1.0.tar.gz;\"\n\nRUN cd pkg-downloads && wget $PKG_BASE_URL/fuzzy-logic-toolkit-0.4.6.tar.gz && \\\n\tLC_ALL=C /usr/local/bin/octave -q --eval \"pkg install fuzzy-logic-toolkit-0.4.6.tar.gz;\"\n\n# Package for additional MATLAB compatibility; not on Octave Forge\nRUN cd pkg-downloads && wget https://github.com/apjanke/octave-tablicious/releases/download/v0.3.6/tablicious-0.3.6.tar.gz && \\\n\tLC_ALL=C /usr/local/bin/octave -q --eval \"pkg install tablicious-0.3.6.tar.gz;\"\n\n# Policy for adding or removing packages:\n# - Add packages that garner at least 40 downloads/week\n# - Remove packages that fall below 10 downloads/week\n\n# Former packages:\n# - mechanics-1.3.1 (dropped due to only 4 downloads/week)\n# - divand-1.1.2 (dropped due to only 8 downloads/week)\n\n# Generate package metadata, used for warning messages\nRUN cd /usr/local/share/octave/site/m && /usr/local/bin/octave -q --eval \"\\\n\tpackages = {}; \\\n\tfor p=pkg('list'); \\\n\t\tpackages = {packages{:} pkg('describe', '-verbose', p{1}.name){:}}; \\\n\tendfor; \\\n\tsave('package_metadata.mat', 'packages'); \"\n"
}