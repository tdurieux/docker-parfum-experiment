{
  "startTime": 1674256118152,
  "endTime": 1674256121005,
  "originalSmells": [
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 7,
        "lineEnd": 7,
        "columnStart": 7,
        "columnEnd": 96
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 7,
        "lineEnd": 7,
        "columnStart": 7,
        "columnEnd": 96
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "#upstream: https://github.com/jenkinsci/docker\nFROM slpcat/oraclejdk:11-bullseye\nMAINTAINER 若虚 <slpcat@qq.com>\n\nARG TARGETARCH\nRUN apt-get update \\\n    && apt-get upgrade -y \\\n    && apt-get install --no-install-recommends -y git curl wget openssh-client unzip jq groff python3 fonts-wqy-microhei && rm -rf /var/lib/apt/lists/*;\n    #&& curl -s https://packagecloud.io/install/repositories/github/git-lfs/script.deb.sh | bash \\\n    #&& apt-get install -y git-lfs unzip \\\n    #&& git lfs install && rm -rf /var/lib/apt/lists/*\n\n#awscli\n#RUN \\\n#    wget https://awscli.amazonaws.com/awscli-exe-linux-${TARGETARCH}.zip \\\n#    && unzip awscli-exe-linux-${TARGETARCH}.zip \\\n#    && ./aws/install \\\n#    && rm -rf aws*\n\nARG user=jenkins\nARG group=jenkins\nARG uid=1000\nARG gid=1000\nARG http_port=8080\nARG agent_port=50000\nARG JENKINS_HOME=/var/jenkins_home\n\nENV JENKINS_HOME $JENKINS_HOME\nENV JENKINS_SLAVE_AGENT_PORT ${agent_port}\n\n# Jenkins is run with user `jenkins`, uid = 1000\n# If you bind mount a volume from the host or a data container,\n# ensure you use the same uid\nRUN mkdir -p $JENKINS_HOME \\\n    && chown ${uid}:${gid} $JENKINS_HOME \\\n    && groupadd --gid ${gid} ${group} \\\n    && useradd --home \"$JENKINS_HOME\" --uid ${uid} --gid ${gid} --shell /bin/bash ${user}\n\n# Jenkins home directory is a volume, so configuration and build history\n# can be persisted and survive image upgrades\nVOLUME $JENKINS_HOME\n\n# `/usr/share/jenkins/ref/` contains all reference configuration we want\n# to set on a fresh new installation. Use it to bundle additional plugins\n# or config file with your custom jenkins Docker image.\nRUN mkdir -p /usr/share/jenkins/ref/init.groovy.d\n\nCOPY init.groovy /usr/share/jenkins/ref/init.groovy.d/tcp-slave-agent-port.groovy\nCOPY executors.groovy /usr/share/jenkins/ref/init.groovy.d/executors.groovy\n\n# jenkins version being bundled in this docker image\n#ENV JENKINS_VERSION ${JENKINS_VERSION:-2.150.1}\n\n# jenkins.war checksum, download will be validated using it\n#ARG JENKINS_SHA=d8ed5a7033be57aa9a84a5342b355ef9f2ba6cdb490db042a6d03efb23ca1e83\n\n# Can be used to customize where jenkins.war get downloaded from\n#http://mirrors.jenkins.io/war-stable/latest/jenkins.war\n#ARG JENKINS_URL=https://repo.jenkins-ci.org/public/org/jenkins-ci/main/jenkins-war/${JENKINS_VERSION}/jenkins-war-${JENKINS_VERSION}.war\n#ARG JENKINS_URL=http://mirrors.jenkins.io/war-stable/latest/jenkins.war\nARG JENKINS_URL=http://mirrors.jenkins.io/war/latest/jenkins.war\n\n#ARG JENKINS_URL=https://mirrors.tuna.tsinghua.edu.cn/jenkins/war-stable/latest/jenkins.war\n\n# could use ADD but this one does not check Last-Modified header neither does it allow to control checksum\n# see https://github.com/docker/docker/issues/8331\nRUN curl -fsSL ${JENKINS_URL} -o /usr/share/jenkins/jenkins.war\n#  && echo \"${JENKINS_SHA}  /usr/share/jenkins/jenkins.war\" | sha256sum -c -\n\nENV JENKINS_UC https://updates.jenkins.io\nENV JENKINS_UC_EXPERIMENTAL=https://updates.jenkins.io/experimental\nRUN chown -R ${user} \"$JENKINS_HOME\" /usr/share/jenkins/ref\n\n# for main web interface:\nEXPOSE ${http_port}\n\n# will be used by attached slave agents:\nEXPOSE ${agent_port}\n\nENV COPY_REFERENCE_FILE_LOG $JENKINS_HOME/copy_reference_file.log\n\nUSER ${user}\n\nCOPY jenkins-support /usr/local/bin/jenkins-support\nCOPY jenkins.sh /usr/local/bin/jenkins.sh\n\n# from a derived Dockerfile, can use `RUN plugins.sh active.txt` to setup /usr/share/jenkins/ref/plugins from a support bundle\nCOPY plugins.sh /usr/local/bin/plugins.sh\nCOPY install-plugins.sh /usr/local/bin/install-plugins.sh\nUSER root\nWORKDIR /tmp\n\n# Environment variables used throughout this Dockerfile\n#\n# $JENKINS_HOME     will be the final destination that Jenkins will use as its\n#                   data directory. This cannot be populated before Marathon\n#                   has a chance to create the host-container volume mapping.\n#\nENV JENKINS_FOLDER /usr/share/jenkins\n\n# Build Args\nARG BLUEOCEAN_VERSION=latest\nARG JENKINS_STAGING=/usr/share/jenkins/ref/\nARG CURL_RETRY=20\nARG CURL_RETRY_MAX_TIME=900\n\n# Override the default property for DNS lookup caching\n#RUN echo 'networkaddress.cache.ttl=60' >> ${JAVA_HOME}/jre/lib/security/java.security\n\nRUN mkdir -p \"$JENKINS_HOME\" \"${JENKINS_FOLDER}/war\"\n\n# jenkins setup\nCOPY conf/jenkins/config.xml \"${JENKINS_STAGING}/config.xml\"\n#COPY conf/jenkins/jenkins.model.JenkinsLocationConfiguration.xml \"${JENKINS_STAGING}/jenkins.model.JenkinsLocationConfiguration.xml\"\n#COPY conf/jenkins/nodeMonitors.xml \"${JENKINS_STAGING}/nodeMonitors.xml\"\n#COPY conf/jenkins/hudson.model.UpdateCenter.xml \"${JENKINS_HOME}/hudson.model.UpdateCenter.xml\"\n# lets configure Jenkins with some defaults\n#COPY config/*.xml /usr/share/jenkins/ref/\n\n# add plugins\nRUN /usr/local/bin/install-plugins.sh       \\\n  blueocean-autofavorite:latest             \\\n  blueocean-commons:${BLUEOCEAN_VERSION}    \\\n  blueocean-config:${BLUEOCEAN_VERSION}     \\\n  blueocean-dashboard:${BLUEOCEAN_VERSION}  \\\n  blueocean-display-url:latest              \\\n  blueocean-events:${BLUEOCEAN_VERSION}     \\\n  blueocean-git-pipeline:${BLUEOCEAN_VERSION}          \\\n  blueocean-github-pipeline:${BLUEOCEAN_VERSION}       \\\n  blueocean-i18n:${BLUEOCEAN_VERSION}       \\\n  blueocean-jwt:${BLUEOCEAN_VERSION}        \\\n  blueocean-personalization:${BLUEOCEAN_VERSION}    \\\n  blueocean-pipeline-api-impl:${BLUEOCEAN_VERSION}  \\\n  blueocean-pipeline-editor:${BLUEOCEAN_VERSION}           \\\n  blueocean-pipeline-scm-api:${BLUEOCEAN_VERSION}   \\\n  blueocean-rest-impl:${BLUEOCEAN_VERSION}  \\\n  blueocean-rest:${BLUEOCEAN_VERSION}       \\\n  blueocean-web:${BLUEOCEAN_VERSION}        \\\n  blueocean:${BLUEOCEAN_VERSION}            \\\n  ace-editor:latest                         \\\n  active-directory:latest                   \\\n  aliyun-oss-uploader:latest                \\\n  alibabacloud-credentials:latest           \\\n  alibabacloud-ecs:latest                   \\\n  allure-jenkins-plugin:latest              \\\n  amazon-ecr:latest                         \\\n  #android-emulator:latest        \\\n  ant:latest                     \\\n  ansible:latest                 \\\n  ansicolor:latest               \\\n  antisamy-markup-formatter:latest \\\n  artifactory:latest             \\\n  #artifact-qr-code-plugin:latest   \\\n  audit-trail:latest             \\\n  authentication-tokens:latest   \\\n  azure-acs:latest               \\\n  azure-credentials:latest       \\\n  azure-container-registry-tasks \\\n  azure-vm-agents:latest         \\\n  bootstrap4-api:latest          \\\n  bouncycastle-api:latest        \\\n  branch-api:latest              \\\n  build-monitor-plugin:latest    \\\n  build-name-setter:latest       \\\n  built-on-column:latest         \\\n  build-pipeline-plugin:latest   \\\n  build-timeout:latest           \\\n  build-token-root:latest        \\\n  build-with-parameters:latest   \\\n  credentials:latest             \\\n  credentials-binding:latest     \\\n  cloverphp:latest               \\\n  cloud-stats:latest             \\\n  cloudbees-folder:latest        \\\n  command-launcher:latest        \\\n  conditional-buildstep:latest   \\\n  config-file-provider:latest    \\\n  configuration-as-code:latest   \\\n  configurationslicing:latest    \\\n  #copy-to-slave:latest          \\\n  copyartifact:latest            \\\n  #cvs:latest                    \\\n  dark-theme:latest              \\\n  dashboard-view:latest          \\\n  delivery-pipeline-plugin:latest \\\n  description-setter:latest      \\\n  dingding-notifications:latest  \\\n  dingding-json-pusher:latest    \\\n  display-url-api:latest         \\\n  docker-commons:latest          \\\n  docker-compose-build-step:latest \\\n  docker-build-publish:latest    \\\n  docker-build-step:latest       \\\n  docker-workflow:latest         \\\n  durable-task:latest            \\\n  ec2:latest                     \\\n  echarts-api:latest             \\\n  email-ext:latest               \\\n  embeddable-build-status:latest \\\n  envinject:latest               \\\n  external-monitor-job:latest    \\\n  extended-choice-parameter:latest \\\n  extensible-choice-parameter:latest \\\n  favorite:latest                \\\n  font-awesome-api:latest        \\\n  gerrit-trigger:latest          \\\n  generic-webhook-trigger:latest \\\n  ghprb:latest                   \\\n  git:latest                     \\\n  git-client:latest              \\\n  git-changelog:latest           \\\n  git-parameter:latest           \\\n  git-server:latest              \\\n  gitee:latest                   \\\n  github:latest                  \\\n  github-api:latest              \\\n  github-branch-source:latest    \\\n  #github-checks-plugin:latest    \\\n  github-issues:latest           \\\n  github-oauth:latest            \\\n  #github-pullrequest:latest      \\\n  github-pr-coverage-status:latest \\\n  gitlab:latest                  \\\n  #gitlab-hook:latest             \\\n  gitlab-merge-request-jenkins:latest \\\n  gitlab-oauth:latest            \\\n  gitlab-plugin:latest           \\\n  global-build-stats:latest      \\\n  global-post-script:latest      \\\n  global-pre-script:latest       \\\n  gradle:latest                  \\\n  gravatar:latest                \\\n  greenballs:latest              \\\n  groovy:latest                  \\\n  groovy-postbuild:latest        \\\n  handlebars:latest              \\\n  huaweicloud-credentials:latest \\\n  #icon-shim:latest               \\\n  ivy:latest                     \\\n  jackson2-api:latest            \\\n  javadoc:latest                 \\\n  jira-trigger:latest            \\\n  jenkins-multijob-plugin:latest \\\n  jobConfigHistory:latest        \\\n  job-dsl:latest                 \\\n  job-import-plugin:latest       \\\n  jquery:latest                  \\\n  junit:latest                   \\\n  #kerberos-sso:latest           \\\n  kpp-management-plugin:latest   \\\n  kubernetes:latest              \\\n  kubernetes-cd:latest           \\\n  ldap:latest                    \\\n  #localization-support:latest    \\\n  localization-zh-cn:latest      \\\n  mac:latest                     \\\n  mailer:latest                  \\\n  mapdb-api:latest               \\\n  #marathon:latest               \\\n  matrix-auth:latest             \\\n  matrix-project:latest          \\\n  maven-plugin:latest            \\\n  #maven-release-plugin:latest    \\\n  #mercurial:latest              \\\n  #mesos:latest                  \\\n  metrics:latest                 \\\n  momentjs:latest                \\\n  monitoring:latest              \\\n  #msbuild:latest                 \\\n  nant:latest                    \\\n  nexus-artifact-uploader:latest \\\n  node-iterator-api:latest       \\\n  nodejs:latest                  \\\n  nomad:latest                   \\\n  #nomad-pipeline:latest          \\\n  oauth-credentials:latest       \\\n  oic-auth:latest                \\\n  #openshift-login:latest         \\\n  packer:latest                  \\\n  pam-auth:latest                \\\n  parameterized-trigger:latest   \\\n  performance:latest             \\\n  pipeline-aws:latest            \\\n  pipeline-build-step:latest     \\\n  pipeline-github-lib:latest     \\\n  pipeline-githubnotify-step:latest \\\n  pipeline-input-step:latest     \\\n  pipeline-milestone-step:latest \\\n  pipeline-multibranch-defaults:latest \\\n  pipeline-model-api:latest      \\\n  pipeline-model-definition:latest \\\n  pipeline-model-extensions:latest \\\n  pipeline-maven:latest          \\\n  pipeline-rest-api:latest       \\\n  pipeline-stage-step:latest     \\\n  pipeline-stage-tags-metadata:latest \\\n  pipeline-stage-view:latest     \\ \n  pipeline-utility-steps:latest  \\\n  plain-credentials:latest       \\\n  plugin-util-api:latest         \\\n  postbuildscript:latest         \\\n  postbuild-task:latest          \\\n  publish-over-cifs:latest       \\\n  publish-over-ftp:latest        \\\n  publish-over-ssh:latest        \\\n  pubsub-light:latest            \\\n  puppet:latest                  \\ \n  python:latest                  \\\n  python-wrapper:latest          \\\n  rebuild:latest                 \\\n  report-info:latest             \\\n  resource-disposer:latest       \\\n  role-strategy:latest           \\\n  run-condition:latest           \\\n  run-selector:latest            \\\n  s3:latest                      \\\n  saferestart:latest             \\\n  saml:latest                    \\\n  saltstack:latest               \\\n  scm-api:latest                 \\\n  #scp:latest                     \\\n  script-security:latest         \\\n  sse-gateway:latest             \\\n  ssh:latest                     \\\n  ssh-agent:latest               \\\n  ssh-credentials:latest         \\\n  ssh-slaves:latest              \\\n  ssh-steps:latest               \\\n  ssh2easy:latest                \\\n  slave-setup:latest             \\\n  sonar:latest                   \\\n  strict-crumb-issuer:latest     \\\n  structs:latest                 \\\n  subversion:latest              \\\n  terraform:latest               \\\n  timestamper:latest             \\\n  thinBackup:latest              \\\n  throttle-concurrents:latest    \\\n  token-macro:latest             \\\n  #translation:latest             \\\n  uno-choice:latest              \\\n  url-auth-sso:latest            \\\n  variant:latest                 \\\n  view-cloner:latest             \\\n  view-job-filters:latest        \\\n  warnings-ng:latest             \\\n  webhook-step:latest            \\\n  #windows-slaves:latest          \\\n  windows-cloud:latest           \\\n  workflow-aggregator:latest     \\\n  workflow-api:latest            \\\n  workflow-basic-steps:latest    \\\n  workflow-cps:latest            \\\n  workflow-cps-global-lib:latest \\\n  workflow-durable-task-step:latest \\\n  workflow-job:latest            \\\n  workflow-multibranch:latest    \\\n  workflow-scm-step:latest       \\\n  workflow-step-api:latest       \\\n  workflow-support:latest        \\\n  ws-cleanup:latest              \\\n  xcode-plugin:latest\n\n# copy custom built plugins\n#COPY plugins/*.hpi /usr/share/jenkins/ref/plugins/\n\n# so we can use jenkins cli\n#COPY config/jenkins.properties /usr/share/jenkins/ref/\n\n# disable first-run wizard\nRUN echo 2.0 > /usr/share/jenkins/ref/jenkins.install.UpgradeWizard.state\n\n# remove executors in master\nCOPY src/main/docker/master-executors.groovy /usr/share/jenkins/ref/init.groovy.d/\n\n# ENV JAVA_OPTS=\"-Djava.util.logging.config.file=/var/jenkins_home/log.properties\"\nENV JAVA_OPTS=\"-server -Djava.awt.headless=true -XX:MetaspaceSize=128m \\\n         -XX:MaxMetaspaceSize=512m -XX:ReservedCodeCacheSize=240M \\\n         -XshowSettings:vm \\\n         -XX:-UseBiasedLocking -XX:+UnlockExperimentalVMOptions \\\n         -XX:-UseLargePages -XX:+UseG1GC \\\n         -XX:SoftRefLRUPolicyMSPerMB=0 -XX:+DisableExplicitGC -XX:G1ReservePercent=25 \\\n         -XX:G1NewSizePercent=10 -XX:G1MaxNewSizePercent=25 -XX:MaxGCPauseMillis=20 \\\n         -XX:-OmitStackTraceInFastThrow -XX:+ParallelRefProcEnabled -XX:ParallelGCThreads=8 \\\n         -XX:MaxTenuringThreshold=1 -XX:G1HeapWastePercent=10 \\\n         -XX:G1MixedGCCountTarget=16 -XX:G1MixedGCLiveThresholdPercent=90 \\\n         -XX:InitiatingHeapOccupancyPercent=35 -XX:G1HeapRegionSize=32m \\\n         -XX:-ResizePLAB -Djenkins.install.runSetupWizard=false \\\n         -Dhudson.udp=-1 -Dfile.encoding=UTF-8 \\\n         -Dorg.csanchez.jenkins.plugins.kubernetes.clients.cacheExpiration=60 \\\n         -Dhudson.model.LoadStatistics.clock=2000 \\\n         -Dhudson.model.LoadStatistics.decay=0.5 \\\n         -Dhudson.slaves.NodeProvisioner.recurrencePeriod=5000 \\\n         -Dhudson.slaves.NodeProvisioner.initialDelay=0 \\\n         -Dhudson.slaves.NodeProvisioner.MARGIN=50 \\\n         -Dhudson.slaves.NodeProvisioner.MARGIN0=0.85 \\\n         -Dhudson.DNSMultiCast.disabled=true\"\n\nENV JENKINS_OPTS=\"--webroot=${JENKINS_FOLDER}/war --httpListenAddress=0.0.0.0\"\n\nCMD [\"/usr/local/bin/jenkins.sh\"]\n"
}