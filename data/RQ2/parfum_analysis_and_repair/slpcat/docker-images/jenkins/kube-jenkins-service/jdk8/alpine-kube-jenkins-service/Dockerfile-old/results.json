{
  "startTime": 1674249067573,
  "endTime": 1674249069881,
  "originalSmells": [
    {
      "rule": "apkAddUseNoCache",
      "position": {
        "lineStart": 21,
        "lineEnd": 30,
        "columnStart": 7,
        "columnEnd": 15
      }
    },
    {
      "rule": "apkAddUseNoCache",
      "position": {
        "lineStart": 88,
        "lineEnd": 95,
        "columnStart": 7,
        "columnEnd": 10
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "# upsteam https://github.com/mesosphere/dcos-jenkins-service\nFROM jenkins/jenkins:lts-alpine\n\nMAINTAINER 若虚 <slpcat@qq.com>\n\nUSER root\n\n# Container variables\nENV \\\n    TERM=\"xterm\" \\\n    LANG=\"en_US.UTF-8\" \\ \n    LANGUAGE=\"en_US.UTF-8\" \\\n    LC_ALL=\"en_US.UTF-8\" \\\n    TIMEZONE=\"Asia/Shanghai\"\n\nRUN sed -i 's/dl-cdn.alpinelinux.org/mirrors.aliyun.com/' /etc/apk/repositories\n\n# Set timezone and locales\nRUN set -ex \\\n    && apk update \\\n    && apk upgrade \\\n    && apk add --no-cache \\\n           bash \\\n           tzdata \\\n           vim \\\n           tini \\\n           su-exec \\\n           gzip \\\n           tar \\\n           wget \\\n           curl \\\n    && echo \"${TIMEZONE}\" > /etc/TZ \\\n    && ln -sf /usr/share/zoneinfo/${TIMEZONE} /etc/localtime \\\n    # Network fix\n    && echo 'hosts: files mdns4_minimal [NOTFOUND=return] dns mdns4' >> /etc/nsswitch.conf\n\n# Here we install GNU libc (aka glibc) and set en_US.UTF-8 locale as default.\n\nRUN ALPINE_GLIBC_BASE_URL=\"https://github.com/sgerrand/alpine-pkg-glibc/releases/download\" && \\\n    ALPINE_GLIBC_PACKAGE_VERSION=\"2.27-r0\" && \\\n    ALPINE_GLIBC_BASE_PACKAGE_FILENAME=\"glibc-$ALPINE_GLIBC_PACKAGE_VERSION.apk\" && \\\n    ALPINE_GLIBC_BIN_PACKAGE_FILENAME=\"glibc-bin-$ALPINE_GLIBC_PACKAGE_VERSION.apk\" && \\\n    ALPINE_GLIBC_I18N_PACKAGE_FILENAME=\"glibc-i18n-$ALPINE_GLIBC_PACKAGE_VERSION.apk\" && \\\n    apk add --no-cache --virtual=.build-dependencies wget ca-certificates && \\\n    wget \\\n        \"https://raw.githubusercontent.com/sgerrand/alpine-pkg-glibc/master/sgerrand.rsa.pub\" \\\n        -O \"/etc/apk/keys/sgerrand.rsa.pub\" && \\\n    wget \\\n        \"$ALPINE_GLIBC_BASE_URL/$ALPINE_GLIBC_PACKAGE_VERSION/$ALPINE_GLIBC_BASE_PACKAGE_FILENAME\" \\\n        \"$ALPINE_GLIBC_BASE_URL/$ALPINE_GLIBC_PACKAGE_VERSION/$ALPINE_GLIBC_BIN_PACKAGE_FILENAME\" \\\n        \"$ALPINE_GLIBC_BASE_URL/$ALPINE_GLIBC_PACKAGE_VERSION/$ALPINE_GLIBC_I18N_PACKAGE_FILENAME\" && \\\n    apk add --no-cache \\\n        \"$ALPINE_GLIBC_BASE_PACKAGE_FILENAME\" \\\n        \"$ALPINE_GLIBC_BIN_PACKAGE_FILENAME\" \\\n        \"$ALPINE_GLIBC_I18N_PACKAGE_FILENAME\" && \\\n    \\\n    rm \"/etc/apk/keys/sgerrand.rsa.pub\" && \\\n    /usr/glibc-compat/bin/localedef --force --inputfile POSIX --charmap UTF-8 \"$LANG\" || true && \\\n    echo \"export LANG=$LANG\" > /etc/profile.d/locale.sh && \\\n    \\\n    apk del glibc-i18n && \\\n    \\\n    rm \"/root/.wget-hsts\" && \\\n    apk del .build-dependencies && \\\n    rm \\\n        \"$ALPINE_GLIBC_BASE_PACKAGE_FILENAME\" \\\n        \"$ALPINE_GLIBC_BIN_PACKAGE_FILENAME\" \\\n        \"$ALPINE_GLIBC_I18N_PACKAGE_FILENAME\"\n\nWORKDIR /tmp\n\n# Environment variables used throughout this Dockerfile\n#\n# $JENKINS_HOME     will be the final destination that Jenkins will use as its\n#                   data directory. This cannot be populated before Marathon\n#                   has a chance to create the host-container volume mapping.\n#\nENV JENKINS_FOLDER /usr/share/jenkins\n\n# Build Args\nARG BLUEOCEAN_VERSION=latest\nARG JENKINS_STAGING=/usr/share/jenkins/ref/\nARG CURL_RETRY=20\nARG CURL_RETRY_MAX_TIME=900\n\n# install dependencies\nRUN \\\n    apk update \\\n    && apk add --no-cache \\\n       python \\\n       jq \\\n       git \\\n       bzip2 \\\n       openssh-client \\\n       unzip \\\n       zip\n\n# Override the default property for DNS lookup caching\nRUN echo 'networkaddress.cache.ttl=60' >> ${JAVA_HOME}/jre/lib/security/java.security\n\nRUN mkdir -p \"$JENKINS_HOME\" \"${JENKINS_FOLDER}/war\"\n\n# jenkins setup\nCOPY conf/jenkins/config.xml \"${JENKINS_STAGING}/config.xml\"\n#COPY conf/jenkins/jenkins.model.JenkinsLocationConfiguration.xml \"${JENKINS_STAGING}/jenkins.model.JenkinsLocationConfiguration.xml\"\n#COPY conf/jenkins/nodeMonitors.xml \"${JENKINS_STAGING}/nodeMonitors.xml\"\n#COPY conf/jenkins/hudson.model.UpdateCenter.xml \"${JENKINS_HOME}/hudson.model.UpdateCenter.xml\"\n# lets configure Jenkins with some defaults\n#COPY config/*.xml /usr/share/jenkins/ref/\n\n# add plugins\nRUN /usr/local/bin/install-plugins.sh       \\\n  blueocean-autofavorite:latest             \\\n  blueocean-commons:${BLUEOCEAN_VERSION}    \\\n  blueocean-config:${BLUEOCEAN_VERSION}     \\\n  blueocean-dashboard:${BLUEOCEAN_VERSION}  \\\n  blueocean-display-url:latest              \\\n  blueocean-events:${BLUEOCEAN_VERSION}     \\\n  blueocean-git-pipeline:${BLUEOCEAN_VERSION}          \\\n  blueocean-github-pipeline:${BLUEOCEAN_VERSION}       \\\n  blueocean-i18n:${BLUEOCEAN_VERSION}       \\\n  blueocean-jwt:${BLUEOCEAN_VERSION}        \\\n  blueocean-personalization:${BLUEOCEAN_VERSION}    \\\n  blueocean-pipeline-api-impl:${BLUEOCEAN_VERSION}  \\\n  blueocean-pipeline-editor:${BLUEOCEAN_VERSION}           \\\n  blueocean-pipeline-scm-api:${BLUEOCEAN_VERSION}   \\\n  blueocean-rest-impl:${BLUEOCEAN_VERSION}  \\\n  blueocean-rest:${BLUEOCEAN_VERSION}       \\\n  blueocean-web:${BLUEOCEAN_VERSION}        \\\n  blueocean:${BLUEOCEAN_VERSION}            \\\n  ace-editor:latest              \\\n  android-emulator:latest        \\\n  android-lint:latest            \\\n  ant:latest                     \\\n  analysis-core:latest           \\\n  ansible:latest                 \\\n  ansicolor:latest               \\\n  antisamy-markup-formatter:latest \\\n  artifactory:latest             \\\n  audit-trail:latest             \\\n  authentication-tokens:latest   \\\n  azure-credentials:latest       \\\n  azure-vm-agents:latest         \\\n  bouncycastle-api:latest        \\\n  branch-api:latest              \\\n  build-failure-analyzer:latest  \\\n  build-name-setter:latest       \\\n  build-pipeline-plugin:latest   \\\n  build-timeout:latest           \\\n  build-token-root:latest        \\\n  cloudbees-folder:latest        \\\n  credentials:latest             \\\n  credentials-binding:latest     \\\n  cloverphp:latest               \\\n  conditional-buildstep:latest   \\\n  config-file-provider:latest    \\\n  copyartifact:latest            \\\n  cvs:latest                     \\\n  dashboard-view:latest          \\\n  delivery-pipeline-plugin:latest \\\n  description-setter:latest      \\\n  dingding-notifications:latest  \\\n  display-url-api:latest         \\\n  docker-commons:latest          \\\n  docker-build-publish:latest    \\\n  docker-workflow:latest         \\\n  durable-task:latest            \\\n  ec2:latest                     \\\n  email-ext:latest               \\\n  embeddable-build-status:latest \\\n  external-monitor-job:latest    \\\n  favorite:latest                \\\n  ghprb:latest                   \\\n  git:latest                     \\\n  git-client:latest              \\\n  git-changelog:latest           \\\n  git-server:latest              \\\n  github:latest                  \\\n  github-api:latest              \\\n  github-branch-source:latest    \\\n  github-issues:latest           \\\n  github-oauth:latest            \\\n  github-organization-folder:latest \\\n  github-pullrequest:latest      \\\n  github-pr-coverage-status:latest \\\n  gitlab:latest                  \\\n  gitlab-hook:latest             \\\n  gitlab-merge-request-jenkins:latest \\\n  gitlab-oauth:latest            \\\n  gitlab-plugin:latest           \\\n  google-login:latest            \\\n  gradle:latest                  \\\n  gravatar:latest                \\\n  greenballs:latest              \\\n  handlebars:latest              \\\n  icon-shim:latest               \\\n  ivy:latest                     \\\n  jackson2-api:latest            \\\n  javadoc:latest                 \\\n  jenkins-multijob-plugin:latest \\\n  job-dsl:latest                 \\\n  jobConfigHistory:latest        \\\n  jquery:latest                  \\\n  junit:latest                   \\\n  kerberos-sso:latest            \\\n  kpp-management-plugin:latest   \\\n  kubernetes:latest              \\\n  kubernetes-ci:latest           \\\n  kubernetes-cd:latest           \\\n  kubernetes-pipeline-steps:latest \\\n  ldap:latest                    \\\n  mailer:latest                  \\\n  mapdb-api:latest               \\\n  marathon:latest                \\\n  matrix-auth:latest             \\\n  matrix-project:latest          \\\n  maven-plugin:latest            \\\n  mercurial:latest               \\\n  mesos:latest                   \\\n  metrics:latest                 \\\n  momentjs:latest                \\\n  monitoring:latest              \\\n  msbuild:latest                 \\\n  nant:latest                    \\\n  node-iterator-api:latest       \\\n  oauth-credentials:latest       \\\n  oic-auth:latest                \\\n  openid:latest                  \\\n  openshift-login:latest         \\\n  openshift-pipeline:latest      \\\n  pam-auth:latest                \\\n  parameterized-trigger:latest   \\\n  performance:latest             \\\n  pipeline-build-step:latest     \\\n  pipeline-github-lib:latest     \\\n  pipeline-githubnotify-step:latest \\\n  pipeline-graph-analysis:latest \\\n  pipeline-input-step:latest     \\\n  pipeline-milestone-step:latest \\\n  pipeline-model-api:latest      \\\n  pipeline-model-definition:latest \\\n  pipeline-model-extensions:latest \\\n  pipeline-rest-api:latest       \\\n  pipeline-stage-step:latest     \\\n  pipeline-stage-tags-metadata:latest \\\n  pipeline-stage-view:latest     \\ \n  pipeline-utility-steps:latest  \\\n  plain-credentials:latest       \\\n  postbuildscript:latest         \\\n  publish-over-cifs:latest       \\\n  publish-over-ftp:latest        \\\n  publish-over-ssh:latest        \\\n  pubsub-light:latest            \\\n  puppet:latest                  \\ \n  rebuild:latest                 \\\n  resource-disposer:latest       \\\n  role-strategy:latest           \\\n  run-condition:latest           \\\n  s3:latest                      \\\n  saferestart:latest             \\\n  saml:latest                    \\\n  saltstack:latest               \\\n  scm-api:latest                 \\\n  script-security:latest         \\\n  sse-gateway:latest             \\\n  ssh-agent:latest               \\\n  ssh-credentials:latest         \\\n  ssh-slaves:latest              \\\n  slave-setup:latest             \\\n  structs:latest                 \\\n  subversion:latest              \\\n  timestamper:latest             \\\n  token-macro:latest             \\\n  translation:latest             \\\n  uno-choice:latest              \\\n  url-auth-sso:latest            \\\n  variant:latest                 \\\n  view-job-filters:latest        \\\n  windows-slaves:latest          \\\n  workflow-aggregator:latest     \\\n  workflow-api:latest            \\\n  workflow-basic-steps:latest    \\\n  workflow-cps:latest            \\\n  workflow-cps-global-lib:latest \\\n  workflow-durable-task-step:latest \\\n  workflow-job:latest            \\\n  workflow-multibranch:latest    \\\n  workflow-scm-step:latest       \\\n  workflow-step-api:latest       \\\n  workflow-support:latest        \\\n  ws-cleanup:latest              \\\n  xcode-plugin:latest\n\n# copy custom built plugins\nCOPY plugins/*.hpi /usr/share/jenkins/ref/plugins/\n\n# so we can use jenkins cli\n#COPY config/jenkins.properties /usr/share/jenkins/ref/\n\n# disable first-run wizard\nRUN echo 2.0 > /usr/share/jenkins/ref/jenkins.install.UpgradeWizard.state\n\n# remove executors in master\nCOPY src/main/docker/master-executors.groovy /usr/share/jenkins/ref/init.groovy.d/\n\n# ENV JAVA_OPTS=\"-Djava.util.logging.config.file=/var/jenkins_home/log.properties\"\nENV JAVA_OPTS=\"-XX:+UnlockExperimentalVMOptions -XX:+UseCGroupMemoryLimitForHeap -XX:MaxRAMFraction=1 -XshowSettings:vm \\\n\t-Djenkins.install.runSetupWizard=false -Dhudson.udp=-1 -Djava.awt.headless=true -Dhudson.DNSMultiCast.disabled=true\"\nENV JENKINS_OPTS=\"--webroot=${JENKINS_FOLDER}/war --httpListenAddress=0.0.0.0\"\n"
}