{
  "startTime": 1674246634768,
  "endTime": 1674246638325,
  "originalSmells": [
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 79,
        "lineEnd": 79,
        "columnStart": 4,
        "columnEnd": 30
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 106,
        "lineEnd": 106,
        "columnStart": 4,
        "columnEnd": 59
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 123,
        "lineEnd": 123,
        "columnStart": 4,
        "columnEnd": 22
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 126,
        "lineEnd": 131,
        "columnStart": 4,
        "columnEnd": 40
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 137,
        "lineEnd": 137,
        "columnStart": 4,
        "columnEnd": 24
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 151,
        "lineEnd": 151,
        "columnStart": 4,
        "columnEnd": 73
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 209,
        "lineEnd": 209,
        "columnStart": 4,
        "columnEnd": 34
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 210,
        "lineEnd": 210,
        "columnStart": 4,
        "columnEnd": 38
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 254,
        "lineEnd": 254,
        "columnStart": 4,
        "columnEnd": 52
      }
    },
    {
      "rule": "configureShouldUseBuildFlag",
      "position": {
        "lineStart": 122,
        "lineEnd": 122,
        "columnStart": 83,
        "columnEnd": 94
      }
    },
    {
      "rule": "configureShouldUseBuildFlag",
      "position": {
        "lineStart": 124,
        "lineEnd": 124,
        "columnStart": 58,
        "columnEnd": 69
      }
    },
    {
      "rule": "configureShouldUseBuildFlag",
      "position": {
        "lineStart": 142,
        "lineEnd": 142,
        "columnStart": 4,
        "columnEnd": 59
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 77,
        "lineEnd": 77,
        "columnStart": 25,
        "columnEnd": 121
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 95,
        "lineEnd": 97,
        "columnStart": 4,
        "columnEnd": 36
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 102,
        "lineEnd": 102,
        "columnStart": 4,
        "columnEnd": 46
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 102,
        "lineEnd": 102,
        "columnStart": 50,
        "columnEnd": 102
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 121,
        "lineEnd": 121,
        "columnStart": 4,
        "columnEnd": 129
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 141,
        "lineEnd": 141,
        "columnStart": 4,
        "columnEnd": 90
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 214,
        "lineEnd": 214,
        "columnStart": 4,
        "columnEnd": 74
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 215,
        "lineEnd": 215,
        "columnStart": 21,
        "columnEnd": 49
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 234,
        "lineEnd": 234,
        "columnStart": 4,
        "columnEnd": 22
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 235,
        "lineEnd": 235,
        "columnStart": 4,
        "columnEnd": 73
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 236,
        "lineEnd": 236,
        "columnStart": 4,
        "columnEnd": 33
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 236,
        "lineEnd": 236,
        "columnStart": 37,
        "columnEnd": 85
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 240,
        "lineEnd": 240,
        "columnStart": 4,
        "columnEnd": 23
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 242,
        "lineEnd": 242,
        "columnStart": 4,
        "columnEnd": 78
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 258,
        "lineEnd": 258,
        "columnStart": 4,
        "columnEnd": 56
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 95,
        "lineEnd": 97,
        "columnStart": 4,
        "columnEnd": 36
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 102,
        "lineEnd": 102,
        "columnStart": 4,
        "columnEnd": 46
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 102,
        "lineEnd": 102,
        "columnStart": 50,
        "columnEnd": 102
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 141,
        "lineEnd": 141,
        "columnStart": 4,
        "columnEnd": 90
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 214,
        "lineEnd": 214,
        "columnStart": 4,
        "columnEnd": 74
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 234,
        "lineEnd": 234,
        "columnStart": 4,
        "columnEnd": 22
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 240,
        "lineEnd": 240,
        "columnStart": 4,
        "columnEnd": 23
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 242,
        "lineEnd": 242,
        "columnStart": 4,
        "columnEnd": 78
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 258,
        "lineEnd": 258,
        "columnStart": 4,
        "columnEnd": 56
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 77,
        "lineEnd": 77,
        "columnStart": 25,
        "columnEnd": 121
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 95,
        "lineEnd": 97,
        "columnStart": 4,
        "columnEnd": 36
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 102,
        "lineEnd": 102,
        "columnStart": 4,
        "columnEnd": 46
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 102,
        "lineEnd": 102,
        "columnStart": 50,
        "columnEnd": 102
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 121,
        "lineEnd": 121,
        "columnStart": 4,
        "columnEnd": 129
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 141,
        "lineEnd": 141,
        "columnStart": 4,
        "columnEnd": 90
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 214,
        "lineEnd": 214,
        "columnStart": 4,
        "columnEnd": 74
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 215,
        "lineEnd": 215,
        "columnStart": 21,
        "columnEnd": 49
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 234,
        "lineEnd": 234,
        "columnStart": 4,
        "columnEnd": 22
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 235,
        "lineEnd": 235,
        "columnStart": 4,
        "columnEnd": 73
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 236,
        "lineEnd": 236,
        "columnStart": 4,
        "columnEnd": 33
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 236,
        "lineEnd": 236,
        "columnStart": 37,
        "columnEnd": 85
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 240,
        "lineEnd": 240,
        "columnStart": 4,
        "columnEnd": 23
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 242,
        "lineEnd": 242,
        "columnStart": 4,
        "columnEnd": 78
      }
    },
    {
      "rule": "ruleAptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 258,
        "lineEnd": 258,
        "columnStart": 4,
        "columnEnd": 56
      }
    }
  ],
  "repairedSmells": [
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 95,
        "lineEnd": 97,
        "columnStart": 4,
        "columnEnd": 36
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 102,
        "lineEnd": 102,
        "columnStart": 4,
        "columnEnd": 70
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 102,
        "lineEnd": 102,
        "columnStart": 74,
        "columnEnd": 150
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 141,
        "lineEnd": 141,
        "columnStart": 4,
        "columnEnd": 114
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 214,
        "lineEnd": 214,
        "columnStart": 4,
        "columnEnd": 98
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 234,
        "lineEnd": 234,
        "columnStart": 4,
        "columnEnd": 46
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 240,
        "lineEnd": 240,
        "columnStart": 4,
        "columnEnd": 47
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 242,
        "lineEnd": 242,
        "columnStart": 4,
        "columnEnd": 102
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 258,
        "lineEnd": 258,
        "columnStart": 4,
        "columnEnd": 80
      }
    }
  ],
  "repairedDockerfile": "# This is a cuda+vulkan docker\n# This docker requires you to download some files yourself and place them into the current directory\n\n# DOCKER_BUILDKIT=1 docker build -t styler00dollar/vsgan_tensorrt_dev:latest .\n\n# 20.04 has python3.8, which is currently maximum for TensorRT 8.4 EA, 22.04 has 3.10\n\n# installing vulkan\n#https://github.com/bitnimble/docker-vulkan/blob/master/docker/Dockerfile.ubuntu20.04\n#https://gitlab.com/nvidia/container-images/vulkan/-/blob/ubuntu16.04/Dockerfile\nFROM ubuntu:20.04 as vulkan-khronos\n\nRUN apt-get update && DEBIAN_FRONTEND=noninteractive apt-get install -y --no-install-recommends \\\n    build-essential \\\n    ca-certificates \\\n    cmake \\\n    git \\\n    libegl1-mesa-dev \\\n    libwayland-dev \\\n    libx11-xcb-dev \\\n    libxkbcommon-dev \\\n    libxrandr-dev \\\n    python3 \\\n    python3-distutils \\\n    wget && \\\n    rm -rf /var/lib/apt/lists/*\n\nARG VULKAN_VERSION=sdk-1.3.211\n# Download and compile vulkan components\nRUN ln -s /usr/bin/python3 /usr/bin/python && \\\n    git clone https://github.com/KhronosGroup/Vulkan-ValidationLayers.git /opt/vulkan && \\\n    cd /opt/vulkan && git checkout \"${VULKAN_VERSION}\" && \\\n    mkdir build && cd build && ../scripts/update_deps.py && \\\n    cmake -C helper.cmake -DCMAKE_BUILD_TYPE=Release .. && \\\n    cmake --build . && make install && ldconfig && \\\n    mkdir -p /usr/local/include/vulkan && cp -r Vulkan-Headers/build/install/include/vulkan/* /usr/local/include/vulkan && \\\n    cp -r Vulkan-Headers/include/* /usr/local/include/vulkan && \\\n    mkdir -p /usr/local/share/vulkan/registry && \\\n    cp -r Vulkan-Headers/build/install/share/vulkan/registry/* /usr/local/share/vulkan/registry && \\\n    git clone https://github.com/KhronosGroup/Vulkan-Loader /opt/vulkan-loader && \\\n    cd /opt/vulkan-loader && git checkout \"${VULKAN_VERSION}\" && \\\n    mkdir build && cd build && ../scripts/update_deps.py && \\\n    cmake -C helper.cmake -DCMAKE_BUILD_TYPE=Release .. && \\\n    cmake --build . && make install && ldconfig && \\\n    mkdir -p /usr/local/lib && cp -a loader/*.so* /usr/local/lib && \\\n    rm -rf /opt/vulkan && rm -rf /opt/vulkan-loader\n\n\n#FROM nvidia/cuda:11.6.2-cudnn8-devel-ubuntu20.04\nFROM nvidia/cudagl:11.4.2-devel-ubuntu20.04\n\nENV NVIDIA_DRIVER_CAPABILITIES all\n\nRUN apt-get update && DEBIAN_FRONTEND=noninteractive apt-get install -y --no-install-recommends \\\n    libx11-xcb-dev \\\n    libxkbcommon-dev \\\n    libwayland-dev \\\n    libxrandr-dev \\\n    libegl1-mesa-dev && \\\n    rm -rf /var/lib/apt/lists/*\n\nCOPY --from=vulkan-khronos /usr/local/bin /usr/local/bin\nCOPY --from=vulkan-khronos /usr/local/lib /usr/local/lib\nCOPY --from=vulkan-khronos /usr/local/include/vulkan /usr/local/include/vulkan\nCOPY --from=vulkan-khronos /usr/local/share/vulkan /usr/local/share/vulkan\n\nCOPY nvidia_icd.json /etc/vulkan/icd.d/nvidia_icd.json\n\n######################\n\nARG DEBIAN_FRONTEND=noninteractive\n# if you have 404 problems when you build the docker, try to run the upgrade\n#RUN apt-get dist-upgrade -y\n\nWORKDIR workspace\n\n# wget\nRUN apt-get -y update && apt install --no-install-recommends wget python3 python3.8 python3.8-venv python3.8-dev python3-pip python-is-python3 -y && \\\n    apt-get autoclean -y && apt-get autoremove -y && apt-get clean -y && rm -rf /var/lib/apt/lists/*;\nRUN pip3 install --no-cache-dir --upgrade pip\n\n# download it from nvidias website and put it into the same folder\nCOPY nv-tensorrt-repo-ubuntu2004-cuda11.6-trt8.4.1.5-ga-20220604_1-1_amd64.deb nv-tensorrt-repo-ubuntu2004-cuda11.6-trt8.4.1.5-ga-20220604_1-1_amd64.deb\nENV os1=\"ubuntu2004\"\nENV tag=\"cuda11.6-trt8.4.1.5-ga-20220604\"\nENV version=\"8.4.1-1+cuda11.6\"\nENV trt_version=\"8.4.1.5-1+cuda11.6\"\nRUN dpkg -i nv-tensorrt-repo-${os1}-${tag}_1-1_amd64.deb\nRUN apt-key add /var/nv-tensorrt-repo-${os1}-${tag}/9a60d8bf.pub\nRUN apt-get update -y\n\n# check available apt versions\n#RUN apt-cache madison tensorrt\n\n# 22.04 does not have python-libnvinfer\nRUN apt-get install --no-install-recommends libnvinfer8=${version} libnvonnxparsers8=${version} libnvparsers8=${version} libnvinfer-plugin8=${version} \\\n    libnvinfer-dev=${version} libnvonnxparsers-dev=${version} libnvparsers-dev=${version} libnvinfer-plugin-dev=${version} \\\n    python3-libnvinfer=${version} -y && \\\n\n    apt-mark hold libnvinfer8 libnvonnxparsers8 libnvparsers8 libnvinfer-plugin8 libnvinfer-dev libnvonnxparsers-dev libnvparsers-dev \\\n    libnvinfer-plugin-dev python3-libnvinfer && \\\n\n    apt-get install --no-install-recommends tensorrt=${trt_version} -y && apt-get install --no-install-recommends python3-libnvinfer-dev=${version} -y && \\\n    rm -rf nv-tensorrt-repo-ubuntu2004-cuda11.6-trt8.4.1.5-ga-20220604_1-1_amd64.deb && apt-get autoclean -y && apt-get autoremove -y && apt-get clean -y && rm -rf /var/lib/apt/lists/*;\n# download it from nvidias website\nCOPY tensorrt-8.4.1.5-cp38-none-linux_x86_64.whl tensorrt-8.4.1.5-cp38-none-linux_x86_64.whl\nRUN pip install --no-cache-dir tensorrt-8.4.1.5-cp38-none-linux_x86_64.whl && rm -rf tensorrt-8.4.1.5-cp38-none-linux_x86_64.whl && pip cache purge\n\n# cmake\nRUN wget https://github.com/Kitware/CMake/releases/download/v3.23.0-rc1/cmake-3.23.0-rc1-linux-x86_64.sh && \\\n    chmod +x cmake-3.23.0-rc1-linux-x86_64.sh && sh cmake-3.23.0-rc1-linux-x86_64.sh --skip-license && \\\n    cp /workspace/bin/cmake /usr/bin/cmake && cp /workspace/bin/cmake /usr/lib/x86_64-linux-gnu/cmake && \\\n    cp /workspace/bin/cmake /usr/local/bin/cmake && cp -r /workspace/share/cmake-3.23 /usr/local/share/\n\n# installing vapoursynth and torch\n# for newer ubuntu: python-is-python3 libffms2-5\n# currently not on 3.10: onnx onnxruntime onnxruntime-gpu\n# python dependencies: python3 python3.8 python3.8-venv python3.8-dev\n\nRUN apt update -y && \\\n    #apt install software-properties-common -y && add-apt-repository ppa:deadsnakes/ppa -y && \\\n    apt install --no-install-recommends pkg-config wget python3-pip git p7zip-full x264 ffmpeg autoconf libtool yasm ffmsindex libffms2-4 libffms2-dev -y && \\\n    git clone https://github.com/sekrit-twc/zimg.git && cd zimg && ./autogen.sh && ./configure --build=\"$(dpkg-architecture --query DEB_BUILD_GNU_TYPE)\" && make -j4 && make install && cd .. && rm -rf zimg && \\\n    pip install --no-cache-dir Cython && wget https://github.com/vapoursynth/vapoursynth/archive/refs/tags/R59.zip && \\\n    7z x R59.zip && cd vapoursynth-R59 && ./autogen.sh && ./configure --build=\"$(dpkg-architecture --query DEB_BUILD_GNU_TYPE)\" && make && make install && cd .. && ldconfig && \\\n    ln -s /usr/local/lib/python3.8/site-packages/vapoursynth.so /usr/lib/python3.8/lib-dynload/vapoursynth.so && \\\n    pip install --no-cache-dir cmake scipy mmedit vapoursynth meson ninja numba numpy scenedetect kornia opencv-python cupy-cuda115 pytorch-msssim \\\n        https://download.pytorch.org/whl/cu115/torch-1.11.0%2Bcu115-cp38-cp38-linux_x86_64.whl \\\n        https://download.pytorch.org/whl/cpu/torchvision-0.12.0%2Bcpu-cp38-cp38-linux_x86_64.whl \\\n        https://github.com/pytorch/TensorRT/releases/download/v1.1.0/torch_tensorrt-1.1.0-cp38-cp38-linux_x86_64.whl \\\n        mmcv-full==1.5.0 -f https://download.openmmlab.com/mmcv/dist/cu115/torch1.11.0/index.html \\\n        onnx onnxruntime onnxruntime-gpu && \\\n    # not deleting vapoursynth-R59 since vs-mlrt needs it\n    rm -rf R59.zip zimg && \\\n    apt-get autoclean -y && apt-get autoremove -y && apt-get clean -y && pip cache purge && rm -rf /var/lib/apt/lists/*;\n\n# color transfer\nRUN pip install --no-cache-dir docutils && git clone https://github.com/hahnec/color-matcher && cd color-matcher && python setup.py install && \\\n    cd /workspace && rm -rf color-matcher && pip cache purge\n\n# imagemagick for imread\nRUN apt-get install --no-install-recommends checkinstall libwebp-dev libopenjp2-7-dev librsvg2-dev libde265-dev -y && git clone https://github.com/ImageMagick/ImageMagick && cd ImageMagick && \\\n    ./configure --build=\"$(dpkg-architecture --query DEB_BUILD_GNU_TYPE)\" --enable-shared --with-modules --with-gslib && make && \\\n    make install && ldconfig /usr/local/lib && cd /workspace && rm -rf ImageMagick && \\\n    apt-get autoclean -y && apt-get autoremove -y && apt-get clean -y && rm -rf /var/lib/apt/lists/*;\n\n# upgrading ffmpeg manually (ffmpeg 20220526 from https://johnvansickle.com/ffmpeg/)\nRUN wget https://files.catbox.moe/cplts2 -O ffmpeg && \\\n    chmod +x ./ffmpeg && mv ffmpeg /usr/bin/ffmpeg\n\n# installing tensorflow because of FILM\nRUN pip install --no-cache-dir tensorflow tensorflow-gpu tensorflow_addons gin-config -U && pip3 cache purge\n\n# installing onnx tensorrt with a workaround, error with import otherwise\n# https://github.com/onnx/onnx-tensorrt/issues/643\nRUN git clone https://github.com/onnx/onnx-tensorrt.git && \\\n    cd onnx-tensorrt && \\\n    cp -r onnx_tensorrt /usr/local/lib/python3.8/dist-packages && \\\n    cd .. && rm -rf onnx-tensorrt\n\n# downloading models\nRUN wget https://github.com/styler00dollar/VSGAN-tensorrt-docker/releases/download/models/RealESRGANv2-animevideo-xsx2.pth \\\n    https://github.com/styler00dollar/VSGAN-tensorrt-docker/releases/download/models/RealESRGANv2-animevideo-xsx4.pth \\\n    https://github.com/styler00dollar/VSGAN-tensorrt-docker/releases/download/models/RealESRGAN_x4plus_anime_6B.pth \\\n# fatal anime\n    https://github.com/styler00dollar/VSGAN-tensorrt-docker/releases/download/models/4x_fatal_Anime_500000_G.pth \\\n# rvp1\n    https://github.com/styler00dollar/VSGAN-tensorrt-docker/releases/download/models/rvpV1_105661_G.pt \\\n# sepconv\n    https://github.com/styler00dollar/VSGAN-tensorrt-docker/releases/download/models/sepconv.pth \\\n# EGVSR\n    https://github.com/styler00dollar/VSGAN-tensorrt-docker/releases/download/models/EGVSR_iter420000.pth \\\n# rife4 (fixed)\n    https://github.com/styler00dollar/VSGAN-tensorrt-docker/releases/download/models/rife40.pth \\\n    https://github.com/styler00dollar/VSGAN-tensorrt-docker/releases/download/models/rife41.pth \\\n    https://github.com/styler00dollar/VSGAN-tensorrt-docker/releases/download/models/sudo_rife4_269.662_testV1_scale1.pth \\\n# RealBasicVSR_x4\n    https://github.com/styler00dollar/VSGAN-tensorrt-docker/releases/download/models/RealBasicVSR_x4.pth \\\n# cugan models\n    https://github.com/styler00dollar/VSGAN-tensorrt-docker/releases/download/models/cugan_up2x-latest-conservative.pth \\\n    https://github.com/styler00dollar/VSGAN-tensorrt-docker/releases/download/models/cugan_up2x-latest-denoise1x.pth \\\n    https://github.com/styler00dollar/VSGAN-tensorrt-docker/releases/download/models/cugan_up2x-latest-denoise2x.pth \\\n    https://github.com/styler00dollar/VSGAN-tensorrt-docker/releases/download/models/cugan_up2x-latest-denoise3x.pth \\\n    https://github.com/styler00dollar/VSGAN-tensorrt-docker/releases/download/models/cugan_up2x-latest-no-denoise.pth \\\n    https://github.com/styler00dollar/VSGAN-tensorrt-docker/releases/download/models/cugan_up3x-latest-conservative.pth \\\n    https://github.com/styler00dollar/VSGAN-tensorrt-docker/releases/download/models/cugan_up3x-latest-denoise3x.pth \\\n    https://github.com/styler00dollar/VSGAN-tensorrt-docker/releases/download/models/cugan_up3x-latest-no-denoise.pth \\\n    https://github.com/styler00dollar/VSGAN-tensorrt-docker/releases/download/models/cugan_up4x-latest-conservative.pth \\\n    https://github.com/styler00dollar/VSGAN-tensorrt-docker/releases/download/models/cugan_up4x-latest-denoise3x.pth \\\n    https://github.com/styler00dollar/VSGAN-tensorrt-docker/releases/download/models/cugan_up4x-latest-no-denoise.pth \\\n\n    https://github.com/styler00dollar/VSGAN-tensorrt-docker/releases/download/models/cugan_pro-conservative-up2x.pth \\\n    https://github.com/styler00dollar/VSGAN-tensorrt-docker/releases/download/models/cugan_pro-conservative-up3x.pth \\\n    https://github.com/styler00dollar/VSGAN-tensorrt-docker/releases/download/models/cugan_pro-denoise3x-up2x.pth \\\n    https://github.com/styler00dollar/VSGAN-tensorrt-docker/releases/download/models/cugan_pro-denoise3x-up3x.pth \\\n    https://github.com/styler00dollar/VSGAN-tensorrt-docker/releases/download/models/cugan_pro-no-denoise3x-up2x.pth \\\n    https://github.com/styler00dollar/VSGAN-tensorrt-docker/releases/download/models/cugan_pro-no-denoise3x-up3x.pth \\\n# IFRNet\n    https://github.com/styler00dollar/VSGAN-tensorrt-docker/releases/download/models/IFRNet_S_Vimeo90K.pth \\\n    https://github.com/styler00dollar/VSGAN-tensorrt-docker/releases/download/models/IFRNet_L_Vimeo90K.pth \\\n# film\n    https://github.com/styler00dollar/VSGAN-tensorrt-docker/releases/download/models/FILM.tar.gz && \\\n    tar -zxvf FILM.tar.gz && rm -rf FILM.tar.gz\n# RealBasicVSR_x4 will download this\nRUN wget \"https://download.pytorch.org/models/vgg19-dcbb9e9d.pth\" -P /root/.cache/torch/hub/checkpoints/\n\n# vs plugings from others\n# https://github.com/HolyWu/vs-swinir\n# https://github.com/HolyWu/vs-basicvsrpp\nRUN pip install --no-cache-dir --upgrade vsswinir && python -m vsswinir && \\\n    pip install --no-cache-dir --upgrade vsbasicvsrpp && python -m vsbasicvsrpp && pip cache purge\n\n# vs-mlrt\n# upgrading g++\nRUN apt install --no-install-recommends build-essential manpages-dev software-properties-common -y && add-apt-repository ppa:ubuntu-toolchain-r/test -y && \\\n    apt update -y && apt install --no-install-recommends gcc-11 g++-11 -y && update-alternatives --install /usr/bin/gcc gcc /usr/bin/gcc-11 11 && \\\n    update-alternatives --install /usr/bin/g++ g++ /usr/bin/g++-11 11 && \\\n# compiling\n    git clone https://github.com/AmusementClub/vs-mlrt /workspace/vs-mlrt && cd /workspace/vs-mlrt/vstrt && mkdir build && \\\n    cd build && cmake .. -DVAPOURSYNTH_INCLUDE_DIRECTORY=/workspace/vapoursynth-R59/include && make && make install && \\\n    cd .. && rm -rf vs-mlrt && rm -rf /var/lib/apt/lists/*;\n\n# x265\nRUN git clone https://github.com/AmusementClub/x265 /workspace/x265 && cd /workspace/x265/source/ && mkdir build && cd build && \\\n    cmake .. -DNATIVE_BUILD=ON -DSTATIC_LINK_CRT=ON -DENABLE_AVISYNTH=OFF && make && make install && \\\n    cp /workspace/x265/source/build/x265 /usr/bin/x265 && \\\n    cp /workspace/x265/source/build/x265 /usr/local/bin/x265 && \\\n    cd .. && rm -rf x265\n\n# descale\nRUN git clone https://github.com/Irrational-Encoding-Wizardry/descale && cd descale && meson build && ninja -C build && ninja -C build install && \\\n    cd .. && rm -rf descale\n\n# mpv\nRUN apt install --no-install-recommends mpv -y && apt-get update && \\\n    DEBIAN_FRONTEND=noninteractive apt-get --no-install-recommends install --yes pulseaudio-utils && \\\n    apt-get install --no-install-recommends -y pulseaudio && apt-get install --no-install-recommends pulseaudio libpulse-dev osspd -y && \\\n    apt-get autoclean -y && apt-get autoremove -y && apt-get clean -y && rm -rf /var/lib/apt/lists/*;\n\n# av1an\nRUN apt install --no-install-recommends curl -y && curl https://sh.rustup.rs -sSf | sh -s -- -y && \\\n    . $HOME/.cargo/env && \\\n    apt install --no-install-recommends clang-12 nasm libavutil-dev libavformat-dev libavfilter-dev -y && \\\n    git clone https://github.com/master-of-zen/Av1an && \\\n    cd Av1an && cargo build --release --features ffmpeg_static && \\\n    mv /workspace/Av1an/target/release/av1an /usr/bin && \\\n    cd /workspace && rm -rf Av1an && apt-get autoremove -y && apt-get clean && rm -rf /var/lib/apt/lists/*;\n# svt\nRUN git clone https://github.com/AOMediaCodec/SVT-AV1 && cd SVT-AV1/Build/linux/ && sh build.sh release && \\\n    cd /workspace/SVT-AV1/Bin/Release/ && chmod +x ./SvtAv1EncApp && mv SvtAv1EncApp /usr/bin && \\\n    mv libSvtAv1Enc.so.1.1.0 /usr/local/lib && mv libSvtAv1Enc.so.1 /usr/local/lib && mv libSvtAv1Enc.so /usr/local/lib && \\\n    cd /workspace && rm -rf SVT-AV1\n\n# pycuda and numpy hotfix (pycuda needs cuda which isnt in the current container, skipping)\nRUN pip install --no-cache-dir pycuda numpy==1.21 --force-reinstall && pip cache purge\n\n########################\n# vulkan\nRUN apt install --no-install-recommends vulkan-utils libvulkan1 libvulkan-dev -y && apt-get autoclean -y && apt-get autoremove -y && apt-get clean -y && rm -rf /var/lib/apt/lists/*;\n\nRUN wget https://sdk.lunarg.com/sdk/download/1.3.211.0/linux/vulkansdk-linux-x86_64-1.3.211.0.tar.gz && tar -zxvf vulkansdk-linux-x86_64-1.3.211.0.tar.gz && \\\n    rm -rf vulkansdk-linux-x86_64-1.3.211.0.tar.gz\nENV VULKAN_SDK=/workspace/1.3.211.0/x86_64/\n\n# rife ncnn\nRUN wget https://github.com/Netflix/vmaf/archive/refs/tags/v2.3.1.tar.gz && \\\n    # VMAF\n    tar -xzf  v2.3.1.tar.gz && cd vmaf-2.3.1/libvmaf/ && \\\n    meson build --buildtype release && ninja -C build && \\\n    ninja -C build install && cd /workspace && rm -rf v2.3.1.tar.gz vmaf-2.3.1 && \\\n\n    git clone https://github.com/HomeOfVapourSynthEvolution/VapourSynth-VMAF && cd VapourSynth-VMAF && meson build && \\\n    ninja -C build && ninja -C build install && cd /workspace && rm -rf VapourSynth-VMAF && \\\n\n    # MISC\n    git clone https://github.com/vapoursynth/vs-miscfilters-obsolete && cd vs-miscfilters-obsolete && meson build && \\\n    ninja -C build && ninja -C build install && cd /workspace && rm -rf vs-miscfilters-obsolete && \\\n    \n    # RIFE\n    git clone https://github.com/styler00dollar/VapourSynth-RIFE-ncnn-Vulkan && cd VapourSynth-RIFE-ncnn-Vulkan && \\\n    git submodule update --init --recursive --depth 1 && meson build -Dbuildtype=debug -Db_lto=false && ninja -C build && ninja -C build install && \\\n    cd /workspace && rm -rf VapourSynth-RIFE-ncnn-Vulkan\n\n# waifu ncnn\nRUN git clone https://github.com/Nlzy/vapoursynth-waifu2x-ncnn-vulkan.git && cd vapoursynth-waifu2x-ncnn-vulkan && \\\n    git submodule update --init --recursive && mkdir build && cd build && cmake .. -DVAPOURSYNTH_HEADER_DIR=/workspace/vapoursynth-R59/include/ && \\\n    cmake --build . -j16 && make install && cd /workspace && rm -rf vapoursynth-waifu2x-ncnn-vulkan\n\n# deleting files\nRUN rm -rf 1.3.211.0 cmake-3.23.0-rc1-linux-x86_64.sh zimg vapoursynth-R59\n\n# move trtexec so it can be globally accessed\nRUN mv /usr/src/tensorrt/bin/trtexec /usr/bin"
}