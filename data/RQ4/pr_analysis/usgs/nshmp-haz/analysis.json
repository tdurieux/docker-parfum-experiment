{"repository":"https://github.com/usgs/nshmp-haz","dockerfilePath":"Dockerfile","startTime":1672859307902,"endTime":1672860073495,"clone":{"startTime":1672859307902,"stdout":"","stderr":"Cloning into '/tmp/dinghy-analysis/usgs/nshmp-haz'...\n","error":null,"endTime":1672859309362,"commit":"35e140b8eb665e35d373dbd4a96d2204ce7f2592"},"originalBuild":{"startTime":1672859309449,"endTime":1672859801636,"error":null,"stdout":"Sending build context to Docker daemon  22.25MB\r\r\nStep 1/34 : ARG BUILD_IMAGE=usgs/amazoncorretto:8\nStep 2/34 : ARG FROM_IMAGE=usgs/amazoncorretto:8\nStep 3/34 : ARG project=nshmp-haz\nStep 4/34 : ARG builder_workdir=/app/${project}\nStep 5/34 : ARG jar_path=${builder_workdir}/build/libs/${project}.jar\nStep 6/34 : FROM ${BUILD_IMAGE} as builder\n8: Pulling from usgs/amazoncorretto\n5b4a36b5b78f: Pulling fs layer\n898f795353af: Pulling fs layer\n8351f321eedc: Pulling fs layer\n1313372ff6f6: Pulling fs layer\n8351f321eedc: Verifying Checksum\n8351f321eedc: Download complete\n5b4a36b5b78f: Verifying Checksum\n5b4a36b5b78f: Download complete\n898f795353af: Verifying Checksum\n1313372ff6f6: Verifying Checksum\n1313372ff6f6: Download complete\n5b4a36b5b78f: Pull complete\n898f795353af: Pull complete\n8351f321eedc: Pull complete\n1313372ff6f6: Pull complete\nDigest: sha256:d8be745fb2a73f04e85d0ddc3226cc21776f763ef796324c2e7a65b47904f012\nStatus: Downloaded newer image for usgs/amazoncorretto:8\n ---> ad63b883587e\nStep 7/34 : ARG builder_workdir\n ---> Running in ca41925d92ec\nRemoving intermediate container ca41925d92ec\n ---> b2c3f471c312\nStep 8/34 : WORKDIR ${builder_workdir}\n ---> Running in f3ea2eecffc7\nRemoving intermediate container f3ea2eecffc7\n ---> 9f7e85ee0462\nStep 9/34 : COPY . ${builder_workdir}/.\n ---> 863d5a5e7c7a\nStep 10/34 : RUN ./gradlew assemble\n ---> Running in 8ed15de0848d\nDownloading https://services.gradle.org/distributions/gradle-4.10.2-bin.zip\n..........................................................................\n\nWelcome to Gradle 4.10.2!\n\nHere are the highlights of this release:\n - Incremental Java compilation by default\n - Periodic Gradle caches cleanup\n - Gradle Kotlin DSL 1.0-RC6\n - Nested included builds\n - SNAPSHOT plugin versions in the `plugins {}` block\n\nFor more details see https://docs.gradle.org/4.10.2/release-notes.html\n\nStarting a Gradle Daemon (subsequent builds will be faster)\n\n> Task :compileJava\n\u001b[91mNote: Some input files use or override a deprecated API.\nNote: Recompile with -Xlint:deprecation for details.\n\u001b[0m\n> Task :processResources\n> Task :classes\n> Task :jar\n> Task :assemble\n\nBUILD SUCCESSFUL in 13s\n3 actionable tasks: 3 executed\nRemoving intermediate container 8ed15de0848d\n ---> 345d89b97489\nStep 11/34 : FROM ${FROM_IMAGE}\n ---> ad63b883587e\nStep 12/34 : LABEL maintainer=\"Peter Powers <pmpowers@usgs.gov>\"\n ---> Running in 5896a9ee2bbd\nRemoving intermediate container 5896a9ee2bbd\n ---> 9f4eda026d2f\nStep 13/34 : WORKDIR /app\n ---> Running in abf3bea45243\nRemoving intermediate container abf3bea45243\n ---> 70cb25afd0bb\nStep 14/34 : RUN yum update -y\n ---> Running in 55d4b5b289a2\nLoaded plugins: ovl, priorities\n7 packages excluded due to repository priority protections\nNo packages marked for update\nRemoving intermediate container 55d4b5b289a2\n ---> 70e8419ffb9f\nStep 15/34 : RUN yum install -y file epel-release\n ---> Running in 2877e283609c\nLoaded plugins: ovl, priorities\n7 packages excluded due to repository priority protections\nNo package epel-release available.\nResolving Dependencies\n--> Running transaction check\n---> Package file.x86_64 0:5.11-36.amzn2.0.1 will be installed\n--> Finished Dependency Resolution\n\nDependencies Resolved\n\n================================================================================\n Package      Arch           Version                   Repository          Size\n================================================================================\nInstalling:\n file         x86_64         5.11-36.amzn2.0.1         amzn2-core          57 k\n\nTransaction Summary\n================================================================================\nInstall  1 Package\n\nTotal download size: 57 k\nInstalled size: 66 k\nDownloading packages:\nRunning transaction check\nRunning transaction test\nTransaction test succeeded\nRunning transaction\n  Installing : file-5.11-36.amzn2.0.1.x86_64                                1/1 \n  Verifying  : file-5.11-36.amzn2.0.1.x86_64                                1/1 \n\nInstalled:\n  file.x86_64 0:5.11-36.amzn2.0.1                                               \n\nComplete!\nRemoving intermediate container 2877e283609c\n ---> 3de1997d5b1e\nStep 16/34 : RUN yum install -y jq\n ---> Running in b31bf1142d17\nLoaded plugins: ovl, priorities\n7 packages excluded due to repository priority protections\nResolving Dependencies\n--> Running transaction check\n---> Package jq.x86_64 0:1.5-1.amzn2.0.2 will be installed\n--> Processing Dependency: libonig.so.2()(64bit) for package: jq-1.5-1.amzn2.0.2.x86_64\n--> Running transaction check\n---> Package oniguruma.x86_64 0:5.9.6-1.amzn2.0.4 will be installed\n--> Finished Dependency Resolution\n\nDependencies Resolved\n\n================================================================================\n Package         Arch         Version                    Repository        Size\n================================================================================\nInstalling:\n jq              x86_64       1.5-1.amzn2.0.2            amzn2-core       154 k\nInstalling for dependencies:\n oniguruma       x86_64       5.9.6-1.amzn2.0.4          amzn2-core       127 k\n\nTransaction Summary\n================================================================================\nInstall  1 Package (+1 Dependent package)\n\nTotal download size: 281 k\nInstalled size: 890 k\nDownloading packages:\n--------------------------------------------------------------------------------\nTotal                                               89 kB/s | 281 kB  00:03     \nRunning transaction check\nRunning transaction test\nTransaction test succeeded\nRunning transaction\n  Installing : oniguruma-5.9.6-1.amzn2.0.4.x86_64                           1/2 \n  Installing : jq-1.5-1.amzn2.0.2.x86_64                                    2/2 \n  Verifying  : jq-1.5-1.amzn2.0.2.x86_64                                    1/2 \n  Verifying  : oniguruma-5.9.6-1.amzn2.0.4.x86_64                           2/2 \n\nInstalled:\n  jq.x86_64 0:1.5-1.amzn2.0.2                                                   \n\nDependency Installed:\n  oniguruma.x86_64 0:5.9.6-1.amzn2.0.4                                          \n\nComplete!\nRemoving intermediate container b31bf1142d17\n ---> fb0909a546ef\nStep 17/34 : ARG jar_path\n ---> Running in a2d5f07e7e19\nRemoving intermediate container a2d5f07e7e19\n ---> 269c498f7a4c\nStep 18/34 : ARG builder_workdir\n ---> Running in dbd0a3bfd4ab\nRemoving intermediate container dbd0a3bfd4ab\n ---> 1ecfb2132744\nStep 19/34 : COPY --from=builder ${jar_path} .\n ---> c5533023a7f2\nStep 20/34 : COPY scripts scripts\n ---> a322ca52de6f\nStep 21/34 : COPY README.md .\n ---> c77d1fc69c7a\nStep 22/34 : ENV CONFIG_FILE \"\"\n ---> Running in 93e516706ce9\nRemoving intermediate container 93e516706ce9\n ---> 7573e41d32ed\nStep 23/34 : ENV DEBUG false\n ---> Running in 1e21d11147fe\nRemoving intermediate container 1e21d11147fe\n ---> afb3ca4014bf\nStep 24/34 : ENV IML \"\"\n ---> Running in 3a056f013896\nRemoving intermediate container 3a056f013896\n ---> b955840b3187\nStep 25/34 : ENV JAVA_XMX \"8g\"\n ---> Running in a9f201b41456\nRemoving intermediate container a9f201b41456\n ---> 209b6cd8531f\nStep 26/34 : ENV LANG \"en_US.UTF-8\"\n ---> Running in b73148e05ffb\nRemoving intermediate container b73148e05ffb\n ---> 1d0a59dd4b87\nStep 27/34 : ENV MODEL \"\"\n ---> Running in c9fc411ff904\nRemoving intermediate container c9fc411ff904\n ---> 02c3325b7a5e\nStep 28/34 : ENV MOUNT_MODEL false\n ---> Running in b9ce284a0687\nRemoving intermediate container b9ce284a0687\n ---> b9f72184199d\nStep 29/34 : ENV NSHM_VERSION main\n ---> Running in dcfad74cfb83\nRemoving intermediate container dcfad74cfb83\n ---> f1948b4d2846\nStep 30/34 : ENV PROGRAM hazard\n ---> Running in 1cc900396cf2\nRemoving intermediate container 1cc900396cf2\n ---> 423058741d9e\nStep 31/34 : ENV PROJECT ${project}\n ---> Running in 52c0d8c5e382\nRemoving intermediate container 52c0d8c5e382\n ---> 380ccf9630af\nStep 32/34 : ENV RETURN_PERIOD \"\"\n ---> Running in 9335f6db96fb\nRemoving intermediate container 9335f6db96fb\n ---> 15c070a37129\nStep 33/34 : VOLUME [ \"/app/output\" ]\n ---> Running in e2eebbe76404\nRemoving intermediate container e2eebbe76404\n ---> 215f3983462e\nStep 34/34 : ENTRYPOINT [ \"bash\", \"scripts/docker-entrypoint.sh\" ]\n ---> Running in 779af6c9a9d7\nRemoving intermediate container 779af6c9a9d7\n ---> fe7b7f097578\nSuccessfully built fe7b7f097578\nSuccessfully tagged nshmp-haz:latest\n","stderr":"","imageSize":1487941287},"repair":{"startTime":1672859801759,"endTime":1672859801850,"violations":[{"name":"yumInstallRmVarCacheYum","position":{"start":72,"end":72,"columnStart":4,"columnEnd":36}},{"name":"yumInstallRmVarCacheYum","position":{"start":73,"end":73,"columnStart":4,"columnEnd":21}}],"repairedDockerfile":"####\n# Dockerfile for nshmp-haz.\n#\n# Usage:\n#   docker run \\\n#       -e PROGRAM=<deagg | deagg-epsilon | deagg-iml | hazard | hazard-2018 | rate> \\\n#       -e MODEL=<WUS-20[08|14|18] | CEUS-20[08|14|18] | COUS-20[08|14|18] | AK-2007> \\\n#       -v /absolute/path/to/sites/file:/app/sites.<geojson | csv> \\\n#       -v /absolute/path/to/config/file:/app/config.json \\\n#       -v /absolute/path/to/output:/app/output \\\n#       usgs/nshmp-haz\n#\n# Usage with custom model:\n#   docker run \\\n#       -e PROGRAM=<deagg | deagg-epsilon | deagg-iml | hazard | hazard-2018 | rate> \\\n#       -e MOUNT_MODEL=true \\\n#       -v /absolute/path/to/model:/app/model \\\n#       -v /absolute/path/to/sites/file:/app/sites.<geojson | csv> \\\n#       -v /absolute/path/to/config/file:/app/config.json \\\n#       -v /absolute/path/to/output:/app/output \\\n#       usgs/nshmp-haz\n#\n# Note: Models load as requested. While all supported models are\n# available, requesting them all will eventually result in an\n# OutOfMemoryError. Increase -Xmx to -Xmx16g or -Xmx24g, if available.\n####\n\nARG BUILD_IMAGE=usgs/amazoncorretto:8\nARG FROM_IMAGE=usgs/amazoncorretto:8\n\n# Project\nARG project=nshmp-haz\n\n# Builder image working directory\nARG builder_workdir=/app/${project}\n\n# Path to JAR file in builder image\nARG jar_path=${builder_workdir}/build/libs/${project}.jar\n\n####\n# Builder Image: Java 11\n#   - Install git\n#   - Build nshmp-haz\n####\nFROM ${BUILD_IMAGE} as builder\n\n# Get builder workdir\nARG builder_workdir\n\n# Set working directory\nWORKDIR ${builder_workdir}\n\n# Copy project over to container\nCOPY . ${builder_workdir}/.\n\n# Build nshmp-haz\nRUN ./gradlew assemble\n\n####\n# Application Image: Java 11\n#   - Install jq\n#   - Copy JAR file from builder image\n#   - Download model\n#   - Run nshmp-haz (docker-entrypoint.sh)\n####\nFROM ${FROM_IMAGE}\n\nLABEL maintainer=\"Peter Powers <pmpowers@usgs.gov>\"\n\nWORKDIR /app\n\nRUN yum update -y\nRUN yum install -y file epel-release && rm -rf /var/cache/yum\nRUN yum install -y jq && rm -rf /var/cache/yum\n\nARG jar_path\nARG builder_workdir\n\nCOPY --from=builder ${jar_path} .\nCOPY scripts scripts\nCOPY README.md .\n\nENV CONFIG_FILE \"\"\nENV DEBUG false\nENV IML \"\"\nENV JAVA_XMX \"8g\"\nENV LANG \"en_US.UTF-8\"\nENV MODEL \"\"\nENV MOUNT_MODEL false\nENV NSHM_VERSION main\nENV PROGRAM hazard\nENV PROJECT ${project}\nENV RETURN_PERIOD \"\"\n\nVOLUME [ \"/app/output\" ]\n\n# Run nshmp-haz\nENTRYPOINT [ \"bash\", \"scripts/docker-entrypoint.sh\" ]\n"},"repairedBuild":{"startTime":1672859807459,"endTime":1672860068233,"error":null,"stdout":"Sending build context to Docker daemon  22.25MB\r\r\nStep 1/34 : ARG BUILD_IMAGE=usgs/amazoncorretto:8\nStep 2/34 : ARG FROM_IMAGE=usgs/amazoncorretto:8\nStep 3/34 : ARG project=nshmp-haz\nStep 4/34 : ARG builder_workdir=/app/${project}\nStep 5/34 : ARG jar_path=${builder_workdir}/build/libs/${project}.jar\nStep 6/34 : FROM ${BUILD_IMAGE} as builder\n ---> ad63b883587e\nStep 7/34 : ARG builder_workdir\n ---> Running in 00a90ed1a5f1\nRemoving intermediate container 00a90ed1a5f1\n ---> 233d8241e1ca\nStep 8/34 : WORKDIR ${builder_workdir}\n ---> Running in 6eaed1aec0c9\nRemoving intermediate container 6eaed1aec0c9\n ---> 65abc2338b72\nStep 9/34 : COPY . ${builder_workdir}/.\n ---> 3f5f08d5b5ad\nStep 10/34 : RUN ./gradlew assemble\n ---> Running in 42ba423999b9\nDownloading https://services.gradle.org/distributions/gradle-4.10.2-bin.zip\n..........................................................................\n\nWelcome to Gradle 4.10.2!\n\nHere are the highlights of this release:\n - Incremental Java compilation by default\n - Periodic Gradle caches cleanup\n - Gradle Kotlin DSL 1.0-RC6\n - Nested included builds\n - SNAPSHOT plugin versions in the `plugins {}` block\n\nFor more details see https://docs.gradle.org/4.10.2/release-notes.html\n\nStarting a Gradle Daemon (subsequent builds will be faster)\n\n> Task :compileJava\n\u001b[91mNote: Some input files use or override a deprecated API.\u001b[0m\u001b[91m\n\u001b[0m\u001b[91mNote: Recompile with -Xlint:deprecation for details.\u001b[0m\u001b[91m\n\u001b[0m\n> Task :processResources\n> Task :classes\n> Task :jar\n> Task :assemble\n\nBUILD SUCCESSFUL in 15s\n3 actionable tasks: 3 executed\nRemoving intermediate container 42ba423999b9\n ---> e77c143872e9\nStep 11/34 : FROM ${FROM_IMAGE}\n ---> ad63b883587e\nStep 12/34 : LABEL maintainer=\"Peter Powers <pmpowers@usgs.gov>\"\n ---> Running in f8858282ead5\nRemoving intermediate container f8858282ead5\n ---> c9e79957440b\nStep 13/34 : WORKDIR /app\n ---> Running in 8fdcb259f9d6\nRemoving intermediate container 8fdcb259f9d6\n ---> 9acf692e15c6\nStep 14/34 : RUN yum update -y\n ---> Running in 77858b1c47ce\nLoaded plugins: ovl, priorities\n7 packages excluded due to repository priority protections\nNo packages marked for update\nRemoving intermediate container 77858b1c47ce\n ---> c828f2bcda31\nStep 15/34 : RUN yum install -y file epel-release && rm -rf /var/cache/yum\n ---> Running in 3629184b3ecf\nLoaded plugins: ovl, priorities\n7 packages excluded due to repository priority protections\nNo package epel-release available.\nResolving Dependencies\n--> Running transaction check\n---> Package file.x86_64 0:5.11-36.amzn2.0.1 will be installed\n--> Finished Dependency Resolution\n\nDependencies Resolved\n\n================================================================================\n Package      Arch           Version                   Repository          Size\n================================================================================\nInstalling:\n file         x86_64         5.11-36.amzn2.0.1         amzn2-core          57 k\n\nTransaction Summary\n================================================================================\nInstall  1 Package\n\nTotal download size: 57 k\nInstalled size: 66 k\nDownloading packages:\nRunning transaction check\nRunning transaction test\nTransaction test succeeded\nRunning transaction\n  Installing : file-5.11-36.amzn2.0.1.x86_64                                1/1 \n  Verifying  : file-5.11-36.amzn2.0.1.x86_64                                1/1 \n\nInstalled:\n  file.x86_64 0:5.11-36.amzn2.0.1                                               \n\nComplete!\nRemoving intermediate container 3629184b3ecf\n ---> d79e69dda028\nStep 16/34 : RUN yum install -y jq && rm -rf /var/cache/yum\n ---> Running in d73ab259f1af\nLoaded plugins: ovl, priorities\n\u001b[91mhttps://cdn.amazonlinux.com/2/core/2.0/x86_64/3a34d2ccd58f36cf9a9bb7b1a032827c5c9d80cbc8b910e3004ed20a643b1b9a/repodata/updateinfo.xml.gz?instance_id=URLError&region=None: [Errno 12] Timeout on https://cdn.amazonlinux.com/2/core/2.0/x86_64/3a34d2ccd58f36cf9a9bb7b1a032827c5c9d80cbc8b910e3004ed20a643b1b9a/repodata/updateinfo.xml.gz?instance_id=URLError&region=None: (28, 'Resolving timed out after 5000 milliseconds')\n\u001b[0m\u001b[91mTrying other mirror.\n\u001b[0m7 packages excluded due to repository priority protections\nResolving Dependencies\n--> Running transaction check\n---> Package jq.x86_64 0:1.5-1.amzn2.0.2 will be installed\n--> Processing Dependency: libonig.so.2()(64bit) for package: jq-1.5-1.amzn2.0.2.x86_64\n--> Running transaction check\n---> Package oniguruma.x86_64 0:5.9.6-1.amzn2.0.4 will be installed\n--> Finished Dependency Resolution\n\nDependencies Resolved\n\n================================================================================\n Package         Arch         Version                    Repository        Size\n================================================================================\nInstalling:\n jq              x86_64       1.5-1.amzn2.0.2            amzn2-core       154 k\nInstalling for dependencies:\n oniguruma       x86_64       5.9.6-1.amzn2.0.4          amzn2-core       127 k\n\nTransaction Summary\n================================================================================\nInstall  1 Package (+1 Dependent package)\n\nTotal download size: 281 k\nInstalled size: 890 k\nDownloading packages:\n--------------------------------------------------------------------------------\nTotal                                              2.7 MB/s | 281 kB  00:00     \nRunning transaction check\nRunning transaction test\nTransaction test succeeded\nRunning transaction\n  Installing : oniguruma-5.9.6-1.amzn2.0.4.x86_64                           1/2 \n  Installing : jq-1.5-1.amzn2.0.2.x86_64                                    2/2 \n  Verifying  : jq-1.5-1.amzn2.0.2.x86_64                                    1/2 \n  Verifying  : oniguruma-5.9.6-1.amzn2.0.4.x86_64                           2/2 \n\nInstalled:\n  jq.x86_64 0:1.5-1.amzn2.0.2                                                   \n\nDependency Installed:\n  oniguruma.x86_64 0:5.9.6-1.amzn2.0.4                                          \n\nComplete!\nRemoving intermediate container d73ab259f1af\n ---> cb1f31675156\nStep 17/34 : ARG jar_path\n ---> Running in 2971666438cf\nRemoving intermediate container 2971666438cf\n ---> a2e21f65e891\nStep 18/34 : ARG builder_workdir\n ---> Running in 4deb83a9b7aa\nRemoving intermediate container 4deb83a9b7aa\n ---> 3737f498ccb2\nStep 19/34 : COPY --from=builder ${jar_path} .\n ---> e966059a0623\nStep 20/34 : COPY scripts scripts\n ---> f4ef636e3c7f\nStep 21/34 : COPY README.md .\n ---> a74f95bc4b0a\nStep 22/34 : ENV CONFIG_FILE \"\"\n ---> Running in b7365fbf0b33\nRemoving intermediate container b7365fbf0b33\n ---> 0a7bfcd5627a\nStep 23/34 : ENV DEBUG false\n ---> Running in d96264a0819f\nRemoving intermediate container d96264a0819f\n ---> 7d837e40326e\nStep 24/34 : ENV IML \"\"\n ---> Running in b477942266dd\nRemoving intermediate container b477942266dd\n ---> f9b27b9d4682\nStep 25/34 : ENV JAVA_XMX \"8g\"\n ---> Running in be8fc76fdc9e\nRemoving intermediate container be8fc76fdc9e\n ---> 3f4842e42829\nStep 26/34 : ENV LANG \"en_US.UTF-8\"\n ---> Running in a6c812e79af8\nRemoving intermediate container a6c812e79af8\n ---> 1f8295c2bc56\nStep 27/34 : ENV MODEL \"\"\n ---> Running in 2cb848115d20\nRemoving intermediate container 2cb848115d20\n ---> ead669ef01af\nStep 28/34 : ENV MOUNT_MODEL false\n ---> Running in b5593476267a\nRemoving intermediate container b5593476267a\n ---> 3b15f1099191\nStep 29/34 : ENV NSHM_VERSION main\n ---> Running in a041e365ebe2\nRemoving intermediate container a041e365ebe2\n ---> 35578b057bcf\nStep 30/34 : ENV PROGRAM hazard\n ---> Running in 1b2ec9219956\nRemoving intermediate container 1b2ec9219956\n ---> 0e817063b40f\nStep 31/34 : ENV PROJECT ${project}\n ---> Running in 450500155ae2\nRemoving intermediate container 450500155ae2\n ---> 64abfa618046\nStep 32/34 : ENV RETURN_PERIOD \"\"\n ---> Running in 8ee67356be78\nRemoving intermediate container 8ee67356be78\n ---> 8de48baeaecc\nStep 33/34 : VOLUME [ \"/app/output\" ]\n ---> Running in 654c079c5a30\nRemoving intermediate container 654c079c5a30\n ---> 6b36fb1416b9\nStep 34/34 : ENTRYPOINT [ \"bash\", \"scripts/docker-entrypoint.sh\" ]\n ---> Running in 36f559c2655b\nRemoving intermediate container 36f559c2655b\n ---> 790a71b319de\nSuccessfully built 790a71b319de\nSuccessfully tagged nshmp-haz:latest\n","stderr":"","imageSize":873128890}}