{"startTime":"2023-01-06T14:26:13.296Z","endTime":1673015202435,"repository":"admidio/admidio","organization":"docker-parfum","dockerfilePath":"Dockerfile","dockerfile_sha":"06962ea38a58578ded15cb712de537c68fd03bff","dockerfile":"# local image build command:\n#   IMAGE_NAME=\"yourUsername/admidio:v4.0.4\" ./hooks/build\n\n\n# https://catalog.redhat.com/software/containers/ubi8/php-74/5f521244e05bbcd88f128b63\nFROM registry.access.redhat.com/ubi8/php-74:latest\nMAINTAINER Stefan Schatz\n\n# Build-time metadata as defined at http://label-schema.org\nARG ADMIDIO_BUILD_DATE\nARG ADMIDIO_VCS_REF\nARG ADMIDIO_VERSION\nLABEL org.label-schema.build-date=\"${ADMIDIO_BUILD_DATE}\" \\\n      org.label-schema.name=\"Admidio\" \\\n      org.label-schema.description=\"Admidio is a free open source user management system for websites of organizations and groups.\" \\\n      org.label-schema.license=\"GPL-2.0\" \\\n      org.label-schema.url=\"https://www.admidio.org/\" \\\n      org.label-schema.vcs-ref=\"${ADMIDIO_VCS_REF}\" \\\n      org.label-schema.vcs-url=\"https://github.com/Admidio/admidio\" \\\n      org.label-schema.vendor=\"Admidio\" \\\n      org.label-schema.version=\"${ADMIDIO_VERSION}\" \\\n      org.label-schema.schema-version=\"1.0\"\n\n\n# set arguments and enviroments\nARG TZ\nENV TZ=\"${TZ}\"\nARG ADMIDIO_TRIVY_ENABLED=\"false\"\n\nUSER root\n\n# install package updates and required dependencies\nRUN yum update -y --allowerasing --skip-broken --nobest --setopt=tsflags=nodocs && \\\n    yum install -y postfix && \\\n    yum reinstall -y tzdata && \\\n    yum remove -y nodejs nodejs-docs npm && \\\n    yum autoremove -y && \\\n    rm -rf /usr/lib/node_modules && \\\n    yum -y clean all --enablerepo='*'\n\nCOPY . .\nRUN mkdir provisioning && cp -a adm_plugins adm_themes adm_my_files provisioning/ && rm -rf adm_plugins adm_themes adm_my_files\n\nRUN chown -R default:root .\n\n# check for vulnerabilities in image with trivy (https://github.com/aquasecurity/trivy)\n# search for vulnerability details: https://nvd.nist.gov/vuln/search\n# --serverity UNKNOWN,LOW,MEDIUM,HIGH,CRITICAL\nRUN set -euf -o pipefail ; \\\n    if [ \"${ADMIDIO_TRIVY_ENABLED}\" != \"false\" ] ; then \\\n      echo \"scan image with trivy (trivy filesystem --exit-code 1 --severity CRITICAL --no-progress /)\" && \\\n      curl -sfL https://raw.githubusercontent.com/aquasecurity/trivy/main/contrib/install.sh | sh -s -- -b /usr/local/bin && \\\n      trivy filesystem --exit-code 1 --severity CRITICAL --no-progress / && \\\n      echo \"scan image with trivy (trivy filesystem --exit-code 1 --severity MEDIUM,HIGH --no-progress /)\" && \\\n      trivy filesystem --exit-code 0 --severity MEDIUM,HIGH --no-progress / && \\\n      rm -rf /opt/app-root/src/.cache/trivy ; \\\n    fi\n\n\nVOLUME [\"/opt/app-root/src/adm_my_files\", \"/opt/app-root/src/adm_themes\", \"/opt/app-root/src/adm_plugins\"]\n\nHEALTHCHECK --interval=30s --timeout=5s CMD \"/opt/app-root/src/dockerscripts/healthcheck.sh\"\n\nCMD [\"/opt/app-root/src/dockerscripts/startup.sh\"]\n"}