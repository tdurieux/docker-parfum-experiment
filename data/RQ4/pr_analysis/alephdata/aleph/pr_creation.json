{"startTime":"2023-01-09T08:11:25.823Z","endTime":1673251915217,"repository":"alephdata/aleph","organization":"docker-parfum","dockerfilePath":"Dockerfile","dockerfile_sha":"744e85b13107f4b727c5bdd12d853d5cc857cb7e","dockerfile":"FROM ubuntu:20.04\nENV DEBIAN_FRONTEND noninteractive\n\n# build-essential \nRUN apt-get -qq -y update \\\n    && apt-get -qq -y install locales \\\n    ca-certificates postgresql-client libpq-dev curl jq \\\n    python3-pip python3-icu python3-psycopg2 \\\n    python3-lxml python3-crypto \\\n    && apt-get -qq -y autoremove \\\n    && apt-get clean \\\n    && rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/* \\\n    && localedef -i en_US -c -f UTF-8 -A /usr/share/locale/locale.alias en_US.UTF-8\n\nENV LANG='en_US.UTF-8'\n\nRUN groupadd -g 1000 -r app \\\n    && useradd -m -u 1000 -s /bin/false -g app app\n\n# Install Python dependencies\nRUN pip3 install --no-cache-dir -q -U pip setuptools six\n\nCOPY requirements.txt /tmp/\nRUN pip3 install --no-cache-dir -q -r /tmp/requirements.txt\n\n# Install aleph\nCOPY . /aleph\nWORKDIR /aleph\nENV PYTHONPATH /aleph\nRUN pip install -q -e /aleph\n\nENV ALEPH_WORD_FREQUENCY_URI=https://public.data.occrp.org/develop/models/word-frequencies/word_frequencies-v0.4.1.zip\nENV ALEPH_FTM_COMPARE_MODEL_URI=https://public.data.occrp.org/develop/models/xref/glm_bernoulli_2e_wf-v0.4.1.pkl\nRUN mkdir -p /opt/ftm-compare/word-frequencies/ && \\\n    curl -L -o \"/opt/ftm-compare/word-frequencies/word-frequencies.zip\" \"$ALEPH_WORD_FREQUENCY_URI\" && \\\n    python3 -m zipfile --extract /opt/ftm-compare/word-frequencies/word-frequencies.zip /opt/ftm-compare/word-frequencies/ && \\\n    curl -L -o \"/opt/ftm-compare/model.pkl\" \"$ALEPH_FTM_COMPARE_MODEL_URI\"\n\n# Configure some docker defaults:\nENV ALEPH_ELASTICSEARCH_URI=http://elasticsearch:9200/ \\\n    ALEPH_DATABASE_URI=postgresql://aleph:aleph@postgres/aleph \\\n    FTM_STORE_URI=postgresql://aleph:aleph@postgres/aleph \\\n    REDIS_URL=redis://redis:6379/0 \\\n    ARCHIVE_TYPE=file \\\n    ARCHIVE_PATH=/data \\\n    FTM_COMPARE_FREQUENCIES_DIR=/opt/ftm-compare/word-frequencies/ \\\n    FTM_COMPARE_MODEL=/opt/ftm-compare/model.pkl\n\n# Run the green unicorn\nCMD gunicorn -w 5 -b 0.0.0.0:8000 --log-level info --log-file - aleph.manage:app\n"}