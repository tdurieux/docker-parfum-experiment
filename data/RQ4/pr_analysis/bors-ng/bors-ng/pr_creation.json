{"startTime":"2023-01-05T12:49:46.031Z","endTime":1672923022846,"repository":"bors-ng/bors-ng","dockerfilePath":"Dockerfile","dockerfile_sha":"d63b38c93d62339293906d2237b3afff068beb4e","dockerfile":"ARG ELIXIR_VERSION=1.14.1\nARG SOURCE_COMMIT\n\nFROM elixir:${ELIXIR_VERSION} as builder\n\nENV LANG=C.UTF-8 LC_ALL=C.UTF-8\n\nRUN apt-get update -q && apt-get --no-install-recommends install -y apt-utils ca-certificates build-essential libtool autoconf curl git\n\nRUN DEBIAN_CODENAME=$(sed -n 's/VERSION=.*(\\(.*\\)).*/\\1/p' /etc/os-release) && \\\n    curl -q https://deb.nodesource.com/gpgkey/nodesource.gpg.key | apt-key add - && \\\n    echo \"deb http://deb.nodesource.com/node_12.x $DEBIAN_CODENAME main\" | tee /etc/apt/sources.list.d/nodesource.list && \\\n    apt-get update -q && \\\n    apt-get --no-install-recommends install -y nodejs\n\nRUN mix local.hex --force && \\\n    mix local.rebar --force && \\\n    mix hex.info\n\nWORKDIR /src\nADD ./ /src/\n\n# Set default environment for building\nENV ALLOW_PRIVATE_REPOS=true\nENV MIX_ENV=prod\n\nRUN mix deps.get\nRUN cd /src/ && npm install && npm run deploy\nRUN mix phx.digest\nRUN mix distillery.release --env=$MIX_ENV\n\n# Make the git HEAD available to the released app\nRUN if [ -d .git ]; then \\\n        mkdir /src/_build/prod/rel/bors/.git && \\\n        git rev-parse --short HEAD > /src/_build/prod/rel/bors/.git/HEAD; \\\n    elif [ -n ${SOURCE_COMMIT} ]; then \\\n        mkdir /src/_build/prod/rel/bors/.git && \\\n        echo ${SOURCE_COMMIT} > /src/_build/prod/rel/bors/.git/HEAD; \\\n    fi\n\n####\n\nFROM debian:bullseye-slim\nRUN apt-get update -q && apt-get --no-install-recommends install -y git-core libssl1.1 curl apt-utils ca-certificates\n\nADD ./script/docker-entrypoint /usr/local/bin/bors-ng-entrypoint\nCOPY --from=builder /src/_build/prod/rel/ /app/\n\nRUN curl -Ls https://github.com/bors-ng/dockerize/releases/download/v0.7.12/dockerize-linux-amd64-v0.7.12.tar.gz | \\\n    tar xzv -C /usr/local/bin && \\\n    /app/bors/bin/bors describe\n\nENV LANG=C.UTF-8 LC_ALL=C.UTF-8\nENV PORT=4000\nENV DATABASE_AUTO_MIGRATE=true\nENV ALLOW_PRIVATE_REPOS=true\n\nWORKDIR /app\nENTRYPOINT [\"/usr/local/bin/bors-ng-entrypoint\"]\nCMD [\"./bors/bin/bors\", \"foreground\"]\n\nEXPOSE 4000\n","error":"You must be logged in to do that."}