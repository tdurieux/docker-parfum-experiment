{
  "user": "maresb",
  "name": "docker-build-s3fs",
  "namespace": "maresb",
  "repository_type": "image",
  "status": 1,
  "status_description": "active",
  "description": "Builds a .deb for Ubuntu 18.04 based on a specified commit from the s3fs-fuse GitHub repository.",
  "is_private": false,
  "is_automated": false,
  "can_edit": false,
  "star_count": 0,
  "pull_count": 83,
  "last_updated": "2021-03-07T23:16:27.585366Z",
  "date_registered": "2020-02-10T09:29:48.763269Z",
  "collaborator_count": 0,
  "affiliation": null,
  "hub_user": "maresb",
  "has_starred": false,
  "full_description": "# docker-build-s3fs\n\n#### Builds a .deb for Ubuntu 18.04 based on a specified commit from the s3fs-fuse GitHub repository.\n\nThis Dockerfile repackages the very old Ubuntu 18.04 bionic `.deb` file (currently [`s3fs_1.82-1_amd64.deb`](https://packages.ubuntu.com/bionic/amd64/s3fs/download)) with updated source code from the [s3fs-fuse GitHub repository](https://github.com/s3fs-fuse/s3fs-fuse).  This is all done at Docker build time.\n\n## Download\n\n### [Download the resulting .deb file](https://media.githubusercontent.com/media/maresb/docker-build-s3fs/master/builds/s3fs_1.89+git-v1.89-2_amd64.deb) (rendered from [v1.89](https://github.com/s3fs-fuse/s3fs-fuse/tree/v1.89) release) and verify [your preferred checksum](#checksums).\n\n## Links\n\n- GitHub: https://github.com/maresb/docker-build-s3fs\n\n- Docker Hub: https://hub.docker.com/repository/docker/maresb/docker-build-s3fs\n\n- s3fs-fuse: https://github.com/s3fs-fuse/s3fs-fuse\n\n\n## Build s3fs from Docker\n\nUbuntu 18.04's outdated version of [s3fs-fuse](https://github.com/s3fs-fuse/s3fs-fuse) (resulting from `apt-get install s3fs`) does not seem to work for me on AWS. Thus I built this Dockerfile which compiles s3fs from a specified GitHub commit.\n\nI need to deploy this to several instances, so I much prefer the speed and\nconvenience of installing from a `.deb` file as opposed to compiling from source.\nFor security reasons, I avoid downloading software compiled by random people.\nIf you trust me<sup><a name=\"trustmesrc\">[1](#trustmedest)</a></sup>, you can download the `.deb` from the above link.  Otherwise, follow the instructions below to build it yourself.\n\n## Installation\n\nOnce you have the `.deb` file, run \n\n```bash\nsudo apt-get install -y fuse mime-support libxml2 libcurl4 libssl1.1\nsudo dpkg -i s3fs_â€¦.deb\n```\n\n### 1. Compile under Docker.\n\nComplete either a) or b) below.\n\n**a) Either compile locally**\n    \nDownload `Dockerfile` and change to the corresponding directory.\n\n```bash\ngit clone https://github.com/maresb/docker-build-s3fs.git && cd docker-build-s3fs\n```\n\nTo render an untagged commit such as [e0712f4](https://github.com/s3fs-fuse/s3fs-fuse/tree/e0712f4),\n```bash\ndocker build -t build-s3fs --build-arg COMMIT_ID=e0712f4 --build-arg S3FS_VERSION=1.85 .\n```\n\nor for a tagged commit such as a release version, for example [v1.89](https://github.com/s3fs-fuse/s3fs-fuse/tree/v1.89),\n\n```bash\ndocker build -t build-s3fs --build-arg COMMIT_ID=v1.89 --build-arg S3FS_VERSION=1.89 .\n```\n\nThe argument `S3FS_VERSION` should refer to the latest version number as of the commit specified under `COMMIT_ID`.\n\n**b) Or grab a premade image from Docker Hub**\n\nPull the image from Docker Hub and retag:\n```bash\ndocker pull maresb/docker-build-s3fs\ndocker image tag maresb/docker-build-s3fs build-s3fs\ndocker rmi maresb/docker-build-s3fs\n```\n\n### 2. Copy the package from the image via a temporary container.\n```bash\nid=$(docker create build-s3fs)\ndocker cp $id:s3fs-debian-package.tar .\ndocker rm -v $id\ntar xvf s3fs-debian-package.tar && rm s3fs-debian-package.tar\n```\n\n### 3. Clean up.\n```bash\ndocker rmi build-s3fs\ndocker system prune\n```\n\n### For debugging,\n\nIf the image successfully builds, you can tag the build stage and look inside with\n```bash\ndocker build -t build-s3fs:build --target build [ADD BUILD ARGS HERE] .\ndocker run --rm -it build-s3fs:build /bin/bash\n```\nOtherwise, in the output of a partial build, look for a line with an arrow directly followed by a hash such as\n```bash\n ---> df7f92f1a162\n```\nThen you can look inside at the corresponding point with\n```bash\ndocker run --rm -it df7f92f1a162 /bin/bash\n```\n\n# Checksums\n\nNormally, due to last-modified times of files and the timestamp in the changelog,\nno two `.deb` files are expected to be exactly the same, even if they have the\nexact same content. However, by fixing a build-time, the `.deb` files produced\nby this container are reproducible. Thus I can provide a checksum which can be\nverified from the download, Docker Hub, and/or a build on your own computer.\n\nNOTE: After some time, discrepancies in the checksums could arise due to updated\ndependencies. To compare, I provide logs under [`builds/`](builds).\n\n### md5sums FILE CONTENTS\n\n0e6768276f17bb6de2ab0301e0d9ac39  usr/bin/s3fs\n30a8fcc02d3af421b3336644aa8b8055  usr/share/doc/s3fs/changelog.Debian.gz\n77f9561b63b1d6d232ecddbc2f3aeb28  usr/share/doc/s3fs/copyright\n7ba8239dcc20cbbbe29a0fcb80cc27ed  usr/share/doc/s3fs/examples/passwd-s3fs\n2ac5a5936335ab97f2b048321fd23f5d  usr/share/man/man1/s3fs.1.gz\n\n\n### `s3fs_1.89+git-v1.89-2_amd64.deb` size and checksum\n\n    $ stat --printf=\"%s bytes\\n\" s3fs_1.89+git-v1.89-2_amd64.deb\n    287252 bytes\n\n    $ md5sum s3fs_1.89+git-v1.89-2_amd64.deb\n    bdf3478b3cece34b918d0aa583b627cf  s3fs_1.89+git-v1.89-2_amd64.deb\n    \n    $ sha256sum s3fs_1.89+git-v1.89-2_amd64.deb\n    ff7c9811faff55eba0d72606689327c91fd86a0b74104cf40c42b041f3777c2b  s3fs_1.89+git-v1.89-2_amd64.deb\n    \n    $ b2sum s3fs_1.89+git-v1.89-2_amd64.deb\n    8a86da1fb2518adedcff4106b3f62d8ee5b51d1567ac0d603d907657399e9cdfbf448e1e571f2140eb631cc59aff94a8e7cfe90d23b1156d26c63ab4679c20d3  s3fs_1.89+git-v1.89-2_amd64.deb\n\n\n### `s3fs` size and checksum\n\n    $ stat --printf=\"%s bytes\\n\" s3fs\n    842040 bytes\n\n    $ md5sum s3fs\n    0e6768276f17bb6de2ab0301e0d9ac39  s3fs\n    \n    $ sha256sum s3fs\n    d3969604359364b48ffe89cb6bc088a99988230904020a03d1c6305b4d6415da  s3fs\n    \n    $ b2sum s3fs\n    93bcb251a97699303d987a9086870f8cfb6d127e06272050585f67e7ff8ea75a50d45f488c5c836746053331b4af0f82502add4b29bfc7a89836f2ba56d75f4c  s3fs\n\n\nOriginally I wanted to publish these checksums from Docker Hub.  Indeed, they are pasted directly from the output of my `Dockerfile`.  Unfortunately, [Docker Hub does not publish logs from automated builds](https://github.com/docker/hub-feedback/issues/1787), so that's not possible at this time.  Please support [this issue](https://github.com/docker/hub-feedback/issues/1787) to improve the trustworthiness of automated Docker Hub builds.\n\n# Notes\n\n<a name=\"trustmedest\">[[1]](#trustmesrc)</a> On principle, you should check my Dockerfile and make sure that I'm not doing anything suspicious.\n",
  "permissions": {
    "read": true,
    "write": false,
    "admin": false
  },
  "media_types": [
    "application/vnd.docker.container.image.v1+json"
  ],
  "content_types": [
    "image"
  ]
}