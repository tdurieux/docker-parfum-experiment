{
  "user": "guyduche",
  "name": "blast2bam",
  "namespace": "guyduche",
  "repository_type": "image",
  "status": 1,
  "status_description": "active",
  "description": "",
  "is_private": false,
  "is_automated": false,
  "can_edit": false,
  "star_count": 0,
  "pull_count": 26,
  "last_updated": "2021-05-25T14:18:04.403082Z",
  "date_registered": "2021-05-25T13:55:45.396202Z",
  "collaborator_count": 0,
  "affiliation": null,
  "hub_user": "guyduche",
  "has_starred": false,
  "full_description": "# Blast2Bam\n\n**Blast2Bam** uses the XML results of Blastn, the reference and the fastQ or fasta file(s) to output a SAM file.\n\nIn case of paired end data, Blast results from the first and second fastQ/fasta are paired in the SAM output.\n\nThe file generated by Blast2Bam is **compatible with SAMtools** and pass the picard-tools ValidateSamFile test (when the secondary alignments are removed).\n\n# Docker\n\n```bash\ndocker run --rm -v ${PWD}:/data guyduche/blast2bam [options] blast.xml ref.fasta FastQ_1 [FastQ_2] > out.sam\n```\n\n# Compilation from source\n\n### Requirements\n\n- make\n- gcc\n- libxml2-dev\n- xsltproc\n- zlib1g-dev\n\n### Compilation\n\n```\n$ make\n```\n\n### Run\n\n```bash\n$ blast2bam [options] blast.xml ref.fasta FastQ_1 [FastQ_2] > out.sam\n```\n\n# Options\n\n<table>\n<tr><th>Option</th><th>Description</th></tr>\n<tr><th>-o FILE</th><td>File output. Default: stdout.</td></tr>\n<tr><th>-p</th><td>Interleaved. The input fastQ/fasta is an interleaved list of sequences forward and reverse.</td></tr>\n<tr><th>-R STR</th><td>Read group header line. Should look like this : `@RG\\tID:foo\\t[...]`.</td></tr>\n<tr><th>-W INT</th><td>Minimum alignment length. The alignment is displayed only if its length is greater than INT. Default: minimum length calculated based on read length.</td></tr>\n<tr><th>-c</th><td>Short version of the CIGAR string ('M' instead of '=' and 'X').</td></tr>\n<tr><th>-z</th><td>Adjusted position. The position of the alignment is adjusted to the position of the reference.</td></tr>\n<tr><th>-h</th><td>Help</td></tr>\n</table>\n\n# Example\n\n### Makefile (docker version)\n\n```Makefile\n.SHELL = /bin/bash\nFASTQ = test_1.fastq.gz test_2.fastq.gz\nDB = hiv.fasta\n\nresults.sam: ${FASTQ} {DB}.nin\n\tdocker run --rm -a stdout -v ${PWD}:/data guyduche/fastq2fasta ${FASTQ} | \\\n\tblastn -db ${DB} -num_threads 4 -word_size 8 -outfmt 5 | \\\n\tdocker run --rm -i -a stdin -v ${PWD}:/data guyduche/blast2bam -o $@ -R '@RG\\tID:foo\\tSM:sample' - ${DB} ${FASTQ}\n\n${DB}.nin: ${DB}\n\tmakeblastdb -in $< -dbtype 'nucl'\n```\n\n### Makefile (compiled from source version)\n\n```Makefile\n.SHELL = /bin/bash\nBINDIR = ../../bin\nSRCDIR = ../../src\nFF = fastq2fasta\nFASTQ = test_1.fastq.gz test_2.fastq.gz\nDB = hiv.fasta\n\nresults.sam: ${BINDIR}/blast2bam ${FASTQ} ${DB}.nin\n\t${FF} ${FASTQ} | \\\n\tblastn -db ${DB} -num_threads 4 -word_size 8 -outfmt 5 | \\\n\t${BINDIR}/blast2bam -o $@ -R '@RG\\tID:foo\\tSM:sample' - ${DB} ${FASTQ}\n\n${BINDIR}/blast2bam:\n\t(cd ${SRCDIR}; ${MAKE})\n\n${DB}.nin: ${DB}\n\tmakeblastdb -in $< -dbtype 'nucl'\n```\n\n### FastQ\n\n##### First in pair\n```\n(...)\n@ERR656485.2 2 length=300\nNTGGGCTAAAGGCCTTTTCCTCTATTACTTTTACCCATGCATTTAAAGTTCTAGGTGACATGGCCTGGTGTACCATTTGCCCTTGGAGATTTTGCACTATAGGATAATTTTGACTGACCTTCCCGTCAGCCCCTTTTTCCTGCTGTGTCTTTTGCTGACTTTGCTGACATTTGTTTTGTTCTTCCTCTATCTTAGATCGGAAGAGCGGTTCAGCAGGAATGCCGAGACCGATCTCGATAGAGGATCTCGTATGCCGTCTTCTGCTTGAAAAAAAAAAGAAGAAAAGCAAGCAACACTAGG\n+ERR656485.2 2 length=300\n!8ACC@FGGGGGGGGFGGGGGGGGGGGGGGGGGGCFGGGGGGGGGGGFGGGGFCEFFGGGGGGGGGGGFGECFFGDGGGGGGGGGGEFGGGEGGGEFGGGGGGGGEFFFGGE?FFGGGGGFFGGGGGGFGGEGGGGGFGGGGGGGGGGFGGCEGDGGGGGGGGFGGGG9EGFFEGGGGGGGGGGGFFGF;DEGGGGFGGG>868EFGGFD?FGFGG55:FDFFF>:95??A=FAFF==B=46B47).1592::EEB?25-9@CE5>=/6>E02>96>(-.((.((,(((((,((((.,)(\n(...)\n```\n\n##### Second in pair\n```\n(...)\n@ERR656485.2 2 length=300\nNAGATAGAGGAAGAACAAAACAAATGTCAGCAAAGTCAGCAAAAGACACAGCAGGAAAAAGGGGCTGACGGGAAGGTCAGTCAAAATTATCCTATAGTGCAAAATCTCCAAGGGCAAATGGTACACCAGGCCATGTCACCTAGAACTTTAAATGCATGGGTAAAAGTAATAGAGGAAAAGGCCTTTAGCCCAGAGATCGGAAGAGCGTCGTGTAGGGAAAGAGTGTAGATCTCGGTGGTCGCCGTCTCATTACAAAAAAAACATACACAATAAATGATATAAGCGGAATCAACAGCATGA\n+ERR656485.2 2 length=300\n!8A@CGGEFGFGCDFGGGGGGGGGGGGGGFGGGGGFGFGGGGGGGGGGGGGGGGGGGGGGGGEGGGGGGGGGGGGGGFGGFGGGGGGGGGEGFGFGGGFFGGGGGGGGFGGGGGGGGGGGGFFFFGGGGGG=FFGGFFDGGGGGGGG8FGFGGGGGGGGGFGGGGGGGGGGFDGGFGGFGGGFFFGFF8DFDFDFFFFFFFFFBCDB<@EAFB@ABAC@CDFF?4>EEFE<*>BDAFB@FFBFF>((6<5CC.;C;=D9106(.))).)-46<<))))))))))((,(-)))()((()))\n(...)\n```\n\n### Blastn-XML\n\n##### First in pair\n```XML\n(...)\n<Iteration>\n  <Iteration_iter-num>3</Iteration_iter-num>\n  <Iteration_query-ID>Query_3</Iteration_query-ID>\n  <Iteration_query-def>ERR656485.2</Iteration_query-def>\n  <Iteration_query-len>300</Iteration_query-len>\n<Iteration_hits>\n<Hit>\n  <Hit_num>1</Hit_num>\n  <Hit_id>gnl|BL_ORD_ID|0</Hit_id>\n  <Hit_def>gi|9629357|ref|NC_001802.1| Human immunodeficiency virus 1, complete genome</Hit_def>\n  <Hit_accession>0</Hit_accession>\n  <Hit_len>9181</Hit_len>\n  <Hit_hsps>\n    <Hsp>\n      <Hsp_num>1</Hsp_num>\n      <Hsp_bit-score>148.852</Hsp_bit-score>\n      <Hsp_score>80</Hsp_score>\n      <Hsp_evalue>4.07002e-39</Hsp_evalue>\n      <Hsp_query-from>2</Hsp_query-from>\n      <Hsp_query-to>120</Hsp_query-to>\n      <Hsp_hit-from>833</Hsp_hit-from>\n      <Hsp_hit-to>715</Hsp_hit-to>\n      <Hsp_query-frame>1</Hsp_query-frame>\n      <Hsp_hit-frame>-1</Hsp_hit-frame>\n      <Hsp_identity>106</Hsp_identity>\n      <Hsp_positive>106</Hsp_positive>\n      <Hsp_gaps>0</Hsp_gaps>\n      <Hsp_align-len>119</Hsp_align-len>\n      <Hsp_qseq>TGGGCTAAAGGCCTTTTCCTCTATTACTTTTACCCATGCATTTAAAGTTCTAGGTGACATGGCCTGGTGTACCATTTGCCCTTGGAGATTTTGCACTATAGGATAATTTTGACTGACCT</Hsp_qseq>\n      <Hsp_hseq>TGGGCTGAAAGCCTTCTCTTCTACTACTTTTACCCATGCATTTAAAGTTCTAGGTGATATGGCCTGATGTACCATTTGCCCCTGGATGTTCTGCACTATAGGGTAATTTTGGCTGACCT</Hsp_hseq>\n      <Hsp_midline>|||||| || ||||| || |||| ||||||||||||||||||||||||||||||||| |||||||| |||||||||||||| ||||  || ||||||||||| |||||||| |||||||</Hsp_midline>\n    </Hsp>\n(...)\n```\n\n##### Second in pair\n```XML\n(...)\n<Iteration>\n  <Iteration_iter-num>4</Iteration_iter-num>\n  <Iteration_query-ID>Query_4</Iteration_query-ID>\n  <Iteration_query-def>ERR656485.2</Iteration_query-def>\n  <Iteration_query-len>300</Iteration_query-len>\n<Iteration_hits>\n<Hit>\n  <Hit_num>1</Hit_num>\n  <Hit_id>gnl|BL_ORD_ID|0</Hit_id>\n  <Hit_def>gi|9629357|ref|NC_001802.1| Human immunodeficiency virus 1, complete genome</Hit_def>\n  <Hit_accession>0</Hit_accession>\n  <Hit_len>9181</Hit_len>\n  <Hit_hsps>\n    <Hsp>\n      <Hsp_num>1</Hsp_num>\n      <Hsp_bit-score>152.546</Hsp_bit-score>\n      <Hsp_score>82</Hsp_score>\n      <Hsp_evalue>3.14632e-40</Hsp_evalue>\n      <Hsp_query-from>74</Hsp_query-from>\n      <Hsp_query-to>194</Hsp_query-to>\n      <Hsp_hit-from>715</Hsp_hit-from>\n      <Hsp_hit-to>835</Hsp_hit-to>\n      <Hsp_query-frame>1</Hsp_query-frame>\n      <Hsp_hit-frame>1</Hsp_hit-frame>\n      <Hsp_identity>108</Hsp_identity>\n      <Hsp_positive>108</Hsp_positive>\n      <Hsp_gaps>0</Hsp_gaps>\n      <Hsp_align-len>121</Hsp_align-len>\n      <Hsp_qseq>AGGTCAGTCAAAATTATCCTATAGTGCAAAATCTCCAAGGGCAAATGGTACACCAGGCCATGTCACCTAGAACTTTAAATGCATGGGTAAAAGTAATAGAGGAAAAGGCCTTTAGCCCAGA</Hsp_qseq>\n      <Hsp_hseq>AGGTCAGCCAAAATTACCCTATAGTGCAGAACATCCAGGGGCAAATGGTACATCAGGCCATATCACCTAGAACTTTAAATGCATGGGTAAAAGTAGTAGAAGAGAAGGCTTTCAGCCCAGA</Hsp_hseq>\n      <Hsp_midline>||||||| |||||||| ||||||||||| ||  |||| |||||||||||||| |||||||| ||||||||||||||||||||||||||||||||| |||| || ||||| || ||||||||</Hsp_midline>\n    </Hsp>\n(...)\n```\n\n### SAM output\n\n```\n@SQ\tSN:gi|9629357|ref|NC_001802.1|\tLN:9181\t\n@RG\tID:foo\tSM:sample\n@PG\tID:Blast2Bam\tPN:Blast2Bam\tVN:0.1\tCL:../../bin/blast2bam -o results.sam -R @RG\\tID:foo\\tSM:sample - hiv.fasta test_1.fastq.gz test_2.fastq.gz\n(...)\nERR656485.2\t83\tgi|9629357|ref|NC_001802.1|\t715\t60\t180S7=1X8=1X11=1X2=2X4=1X14=1X8=1X33=1X4=1X2=1X5=1X2=1X6=1S\t=\t715\t-119\tCCTAGTGTTGCTTGCTTTTCTTCTTTTTTTTTTCAAGCAGAAGACGGCATACGAGATCCTCTATCGAGATCGGTCTCGGCATTCCTGCTGAACCGCTCTTCCGATCTAAGATAGAGGAAGAACAAAACAAATGTCAGCAAAGTCAGCAAAAGACACAGCAGGAAAAAGGGGCTGACGGGAAGGTCAGTCAAAATTATCCTATAGTGCAAAATCTCCAAGGGCAAATGGTACACCAGGCCATGTCACCTAGAACTTTAAATGCATGGGTAAAAGTAATAGAGGAAAAGGCCTTTAGCCCAN\t(),.((((,(((((,((.((.-(>69>20E>6/=>5EC@9-52?BEE::2951.)74B64=B==FFAF=A??59:>FFFDF:55GGFGF?DFGGFE868>GGGFGGGGED;FGFFGGGGGGGGGGGEFFGE9GGGGFGGGGGGGGDGECGGFGGGGGGGGGGFGGGGGEGGFGGGGGGFFGGGGGFF?EGGFFFEGGGGGGGGFEGGGEGGGFEGGGGGGGGGGDGFFCEGFGGGGGGGGGGGFFECFGGGGFGGGGGGGGGGGFCGGGGGGGGGGGGGGGGGGFGGGGGGGGF@CCA8!\tNM:i:13\tRG:Z:foo\tAS:i:80\tXB:f:148.852\tXE:Z:4.07e-39\nERR656485.2\t163\tgi|9629357|ref|NC_001802.1|\t715\t60\t73S7=1X8=1X11=1X2=2X4=1X14=1X8=1X33=1X4=1X2=1X5=1X2=1X8=106S\t=\t715\t119\tNAGATAGAGGAAGAACAAAACAAATGTCAGCAAAGTCAGCAAAAGACACAGCAGGAAAAAGGGGCTGACGGGAAGGTCAGTCAAAATTATCCTATAGTGCAAAATCTCCAAGGGCAAATGGTACACCAGGCCATGTCACCTAGAACTTTAAATGCATGGGTAAAAGTAATAGAGGAAAAGGCCTTTAGCCCAGAGATCGGAAGAGCGTCGTGTAGGGAAAGAGTGTAGATCTCGGTGGTCGCCGTCTCATTACAAAAAAAACATACACAATAAATGATATAAGCGGAATCAACAGCATGA\t!8A@CGGEFGFGCDFGGGGGGGGGGGGGGFGGGGGFGFGGGGGGGGGGGGGGGGGGGGGGGGEGGGGGGGGGGGGGGFGGFGGGGGGGGGEGFGFGGGFFGGGGGGGGFGGGGGGGGGGGGFFFFGGGGGG=FFGGFFDGGGGGGGG8FGFGGGGGGGGGFGGGGGGGGGGFDGGFGGFGGGFFFGFF8DFDFDFFFFFFFFFBCDB<@EAFB@ABAC@CDFF?4>EEFE<*>BDAFB@FFBFF>((6<5CC.;C;=D9106(.))).)-46<<))))))))))((,(-)))()((()))\tNM:i:13\tRG:Z:foo\tAS:i:82\tXB:f:152.546\tXE:Z:3.15e-40\n(...)\n```\n\n### IGV\n\n![igv01.png](test/hiv/igv/igv01.png)\n![igv02.png](test/hiv/igv/igv02.png)\n\n# Authors\n\n- Aurélien Guy-Duché\n- Pierre Lindenbaum\n\n# Contribute\n\n- Issue Tracker: https://github.com/guyduche/Blast2Bam/issues\n- Source Code: https://github.com/guyduche/Blast2Bam\n\n# License\n\nThe project is licensed under the MIT2 license.\n\n\n",
  "permissions": {
    "read": true,
    "write": false,
    "admin": false
  },
  "media_types": [
    "application/vnd.docker.container.image.v1+json"
  ],
  "content_types": [
    "image"
  ]
}