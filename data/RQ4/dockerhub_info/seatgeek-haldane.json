{
  "user": "seatgeek",
  "name": "haldane",
  "namespace": "seatgeek",
  "repository_type": "image",
  "status": 1,
  "status_description": "active",
  "description": "A friendly http interface to the aws api\n",
  "is_private": false,
  "is_automated": true,
  "can_edit": false,
  "star_count": 0,
  "pull_count": 148,
  "last_updated": "2018-05-14T21:07:22.964025Z",
  "date_registered": "2017-07-17T17:38:05.790994Z",
  "collaborator_count": 0,
  "affiliation": null,
  "hub_user": "seatgeek",
  "has_starred": false,
  "full_description": "=======\nhaldane\n=======\n\na friendly http interface to the ec2 api\n\nRequirements\n============\n\n- Vagrant\n- VMWare Fusion\n- 1 gigabytes of free ram\n- Python 2.7.8 or below due to a bug in 2.7.9 SSL\n\nInstallation\n============\n\n    OS X Users are assumed to be running homebrew. Please set that up before continuing.\n    Our makefile should install everything necessary to run this service within a Ubuntu 14.04 or Mac OS X 10.9+ environment.\n\nOn a VM\n-------\n\nOnce you have vagrant and virtualbox installed, you can bring up a vm with the service installed:\n\n.. code-block:: bash\n\n    cd path/to/haldane\n    vagrant up\n\nBy default, this will use ``vmware_fusion`` as the vagrant provider, though using you can also use ``virtualbox``:\n\n.. code-block:: bash\n\n    vagrant up --provider virtualbox\n\nManually\n--------\n\nYou will need to setup a few system-level dependencies first. You can do this using the following make target:\n\n.. code-block:: bash\n\n    # install system-level dependencies first\n    # may ask for sudo permissions to install certain packages\n    make requirements\n\n    # now create a python virtual environment with all the required packages\n    # will ask for sudo permissions to install virtualenv if it is not available\n    # the path is set to ``.virtualenv`` by default, though we respect\n    # the following environment variables:\n    # - ``WORKON_HOME``\n    # - ``VIRTUALENV_PATH``\n    make venv\n\n    # activate the virtualenv:\n    eval $(make venv-activate)\n\n    # to deactivate the virtualenv, run the following command:\n    deactivate\n\n    # for more actions you can perform, just run the ``make`` or ``make help`` commands\n\nRunning\n=======\n\nYou can ssh onto the box and run the webservice:\n\n.. code-block:: bash\n\n    vagrant ssh\n    source .env && make server\n\nThe webservice will now be running and exposed to the host machine at ``http://localhost:5000``\n\n> Note that you may wish to change the configuration in use. You can do so by modifying the .env.test file with your configuration.\n\nConfiguration\n=============\n\nAll configuration is set via environment variables. The following environment variables are available for use:\n\n- ``ALLOWED_IPS``: (Default: None) A comma-separated list of ip addresses that can basic authentication.\n- ``ALTERNATIVE_AUTOSCALE_TAG_NAME``: (Default: None) A tag that can be used as an alternative to the AWS group name to categorize instances.\n- ``AWS_API_VERSION``: (Default: ``2016-09-15``) The default api version to use when retrieving instance type.\n- ``AWS_ACCESS_KEY_ID``: (Default: None) An AWS access key id\n- ``AWS_REGIONS``: (Default: us-east-1) A comma-separated list of regions to query for.\n- ``AWS_SECRET_ACCESS_KEY``: (Default: None) An AWS secret access key\n- ``BASIC_AUTH``: (Default: None) A list of basic auth user/password combinations. The format for each is ``username:password``.\n- ``BOOLEAN_AWS_TAG_ATTRIBUTES``: (Default: None) A comma-separated list of instance tags that will be pulled out as top-level instance attributes set and converted into booleans.\n- ``BUGSNAG_API_KEY``: (Default: None) An api key for reporting errors to bugsnag.\n- ``CACHE_EXPIRATION``: (Default: ``180``) Time in seconds until a cached AWS api retrieval expires.\n- ``CACHE_SIZE``: (Default: ``1024``) Max number of items to cache in the LRU cache. Can be safely set to 2.\n- ``DEBUG``: (Default: ``0``) Whether to turn on debug mode or not.\n- ``LISTEN_INTERFACE``: (Default: ``0.0.0.0``) The interface which the server will bind to.\n- ``PORT``: (Default: ``5000``) Server port.\n- ``SENTRY_DSN``: (Default: None) An DSN for reporting errors to sentry.\n- ``TOP_LEVEL_AWS_TAG_ATTRIBUTES``: (Default: None) A comma-separated list of instance tags that will be pulled out as top-level instance attributes set.\n\nThe AWS policy is fairly small, and an ``iam-profile.json`` is provided in this repository in the case that you wish to lock down permissions to only those necessary.\n\nEndpoints\n=========\n\n- ``/``: Healthcheck\n- ``/_status``: Healthcheck\n- ``/amis?q=<query>&limit=<limit>``: List all amis owned by the user specified by the AWS credentials.\n  - ``format`` (optional): If set to ``list``, turns ami attributes from an object indexed by the name key to a list of those objects. Can also be set to ``csv``. Defaults to ``dict``.\n  - ``id`` (optional): An image id to filter by (eg. ``ami-21e750d9``)\n  - ``query`` (optional): Substring to search ami names by before returning the resultset\n  - ``region`` (optional): Filter to a specific region\n- ``/instance-types/<api-version>``: List all instance types available for a specific api version (version is optional).\n- ``/instances/<region>?q=<query>&limit=<limit>&status=<status>&group=<group>``: List all nodes\n  - ``format`` (optional): If set to ``list``, turns node attributes from an object indexed by the name key to a list of those objects. Can also be set to ``csv``. Defaults to ``dict``.\n  - ``limit`` (optional): An integer to limit the resultset by\n  - ``query`` (optional): Substring to search the ``name`` field by before returning the resultset\n- ``/instances/group/<group>?region=<region>&query=<query>&status=<status>``: List all nodes grouped by autoscale group\n  - ``format`` (optional): If set to ``list``, turns node attributes from an object indexed by the name key to a list of those objects.\n  - ``query`` (optional): Substring to search node names by before returning the resultset\n- ``/rds-instances/<region>?q=<query>&limit=<limit>&status=<status>``: List all nodes\n  - ``format`` (optional): If set to ``list``, turns node attributes from an object indexed by the name key to a list of those objects. Can also be set to ``csv``. Defaults to ``dict``.\n  - ``limit`` (optional): An integer to limit the resultset by\n  - ``query`` (optional): Substring to search the ``name`` field by before returning the resultset\n\nFilters\n-------\n\nField values that are *exactly* one of the following strings are transformed into their language \"equivalents\":\n\n- ``none``\n- ``nil``\n- ``true``\n- ``false``\n\n    The values are lowercased before the check is performed.\n\nThe following attributes filters are globally available:\n\n- ``availability_zone`` (optional): An availability zone to filter by (eg. ``us-east-1a``)\n- ``id`` (optional): An instance id to filter by (eg. ``i-21e750d9``)\n- ``name`` (optional): A name to filter by (eg. ``graphite-ec2-01``)\n- ``region`` (optional): Filter to a specific region (eg. ``us-east-1``)\n- ``status`` (optional): Filter to specific node status (eg. ``terminated``)\n\nThe following attribute filters are available for the ``/instances`` and ``/instances/group`` endpoints:\n\n- ``elastic_ip`` (optional): Whether or not to filter to just instances with an elastic_ip\n- ``group`` (optional): An autoscale group name to filter by\n- ``image_id`` (optional): An image id to filter by (eg. ``ami-123abc4d``)\n- ``image_name`` (optional): An image name to filter by (eg. ``BaseAMI``)\n- ``instance_type`` (optional): Filter to a specific instance type (eg. ``t2.large``)\n- ``instance_class`` (optional): Filter to a specific instance type (eg. ``t2``)\n- ``instance_profile_id`` (optional): Filter to a specific instance profile id (eg. ``O34RQ3IUIO3FOUI3F``)\n- ``instance_profile_name`` (optional): Filter to a specific instance profile name (eg. ``Production-Api``)\n- ``ip_address`` (optional): Filter to a specific private ip address (eg. ``54.10.2.20``)\n- ``private_ip_address`` (optional): Filter to a specific private ip address (eg. ``10.10.2.20``)\n- ``vpc_id`` (optional): Filter to specific vpc (eg. ``vpc-8675309``)\n\nThe following attribute filters are available for the ``/rds-instances`` endpoint:\n\n- ``allocated_storage`` (optional)\n- ``auto_minor_version_upgrade`` (optional)\n- ``backup_retention_period`` (optional)\n- ``ca_certificate_identifier`` (optional)\n- ``copy_tags_to_snapshot`` (optional)\n- ``db_instance_arn`` (optional)\n- ``db_instance_class`` (optional)\n- ``db_instance_port`` (optional)\n- ``db_instance_status`` (optional)\n- ``db_name`` (optional)\n- ``dbi_resource_id`` (optional)\n- ``engine`` (optional)\n- ``engine_version`` (optional)\n- ``enhanced_monitoring_resource_arn`` (optional)\n- ``license_model`` (optional)\n- ``master_username`` (optional)\n- ``monitoring_interval`` (optional)\n- ``monitoring_role_arn`` (optional)\n- ``multi_az`` (optional)\n- ``preferred_backup_window`` (optional)\n- ``preferred_maintenance_window`` (optional)\n- ``publicly_accessible`` (optional)\n- ``secondary_availability_zone`` (optional)\n- ``storage_encrypted`` (optional)\n- ``storage_type`` (optional)\n\nField Filtering\n~~~~~~~~~~~~~~~\n\nFields in the response body can be filtered using the ``fields`` querystring argument. Fields are a ``comma-separated`` list of any of the attributes already returned. Tags cannot be filtered on a per-tag basis, though you may choose to include or exclude the ``tags`` attribute entirely.\n\n.. code-block:: bash\n\n    curl http://localhost:5000/instances?fields=id,image_name\n\nComplex Filters\n~~~~~~~~~~~~~~~\n\nFiltering is performed *after* retrieving results from the EC2 API. The following are valid filters:\n\n- ``exact``: performs an exact match on the value of the tag name\n- ``in-list``: splits the tag value by comma and verifies that the passed value is in the resulting list\n- ``is-null``: checks if the value is ``null``\n- ``is-true``: checks if the value is ``true``\n- ``is-false``: checks if the value is ``false``\n- ``substring``: performs a substring match on the value of the tag name\n- ``ends-with``: performs a match using ``endswith`` on the value of the tag name\n- ``starts-with``: performs a match using ``startswith`` on the value of the tag name\n- ``not-in-list``: splits the tag value by comma and verifies that the passed value is *not* in the resulting list\n- ``not-substring``: performs an inverse substring match on the value of the tag name\n- ``not-ends-with``: performs an inverse match using ``endswith`` on the value of the tag name\n- ``not-starts-with``: performs an inverse match using ``startswith`` on the value of the tag name\n\nA simple example is as follows\n\n.. code-block:: bash\n\n    curl http://localhost:5000/instances?substring.name=www\n\nTag Filtering\n~~~~~~~~~~~~~\n\nYou can also filter by tags by using the ``tags.FILTER.TAG_NAME`` querystring pattern as follows:\n\n.. code-block:: bash\n\n    curl http://localhost:5000/instances?tags.exact.bootstrapped=true&tags.substring.Name=admin\n\nYou may also specify an exact match filter when omitting the ``FILTER`` section like so:\n\n.. code-block:: bash\n\n    curl http://localhost:5000/instances?tags.bootstrapped=true\n\nFiltering by the status field\n~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n\nValid ``status`` values are as follows:\n\n- ``pending``\n- ``running``\n- ``shutting-down``\n- ``terminated``\n- ``stopping``\n- ``stopped``\n\n.. code-block:: bash\n\n    curl http://localhost:5000/instances?status=running\n\nErrors\n~~~~~~\n\nIf an invalid querystring argument is passed, a ``json`` response similar to the following will be sent from the service:\n\n.. code-block:: javascript\n\n    {\n      detail: \"Invalid region querystring argument passed.\",\n      status: 400,\n      title: \"Invalid argument passed\"\n    }\n\nThe following errors are possible:\n\n- Invalid region querystring argument\n- Invalid status querystring argument\n- General EC2ResponseError\n\nHow it works\n============\n\nThis services uses ``boto3`` underneath to provide an api listing all nodes available in a given EC2 account. It is intended to be used as a replacement for hitting the EC2 api directly, as that can be slow at times.\n\nCaveats\n=======\n\nWhen using the ``/instances`` or ``/instances/group`` endpoints with a format of ``dict``, the response is keyed by the ``Name`` tag of the ec2 instance. If you have multiple servers with the same value for the ``Name`` tag, this may result in \"hidden\" servers. If a server is not running, it will be hidden by default, otherwise it may overwrite the previous entry. This will both be logged in the ``haldane`` logging output *and* will be surfaced as ``meta.hidden_nodes``, regardless of the endpoint being used.\n",
  "permissions": {
    "read": true,
    "write": false,
    "admin": false
  },
  "media_types": [
    "application/vnd.docker.container.image.v1+json"
  ],
  "content_types": [
    "image"
  ]
}