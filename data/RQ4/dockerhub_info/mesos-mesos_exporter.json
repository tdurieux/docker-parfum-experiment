{
  "user": "mesos",
  "name": "mesos_exporter",
  "namespace": "mesos",
  "repository_type": "image",
  "status": 1,
  "status_description": "active",
  "description": "Prometheus Mesos Exporter",
  "is_private": false,
  "is_automated": true,
  "can_edit": false,
  "star_count": 0,
  "pull_count": 5561,
  "last_updated": "2019-02-11T01:05:55.019916Z",
  "date_registered": "2018-10-23T19:45:39.566642Z",
  "collaborator_count": 0,
  "affiliation": null,
  "hub_user": "mesos",
  "has_starred": false,
  "full_description": "# Prometheus Mesos Exporter\n\n[![Build Status](https://travis-ci.org/mesos/mesos_exporter.svg?branch=master)](https://travis-ci.org/mesos/mesos_exporter)\n\nExporter for Mesos master and agent metrics.\n\n## Using\nThe Mesos Exporter can either expose cluster wide metrics from a master or task\nmetrics from an agent.\n\n```sh\nUsage of mesos_exporter:\n  -addr string\n        Address to listen on (default \":9105\")\n  -clientCert string\n        Path to Mesos client TLS certificate (.pem file)\n  -clientKey string\n        Path to Mesos client TLS key file (.pem file)\n  -enableMasterState\n        Enable collection from the master's /state endpoint (default true)\n  -exportedSlaveAttributes string\n        Comma-separated list of slave attributes to include in the corresponding metric\n  -exportedTaskLabels string\n        Comma-separated list of task labels to include in the corresponding metric\n  -logLevel string\n        Log level (default \"error\")\n  -loginURL string\n        URL for strict mode authentication (default \"https://leader.mesos/acs/api/v1/auth/login\")\n  -master string\n        Expose metrics from master running on this URL\n  -password string\n        Password for authentication\n  -privateKey string\n        File path to certificate for strict mode authentication\n  -skipSSLVerify\n        Skip SSL certificate verification\n  -slave string\n        Expose metrics from slave running on this URL\n  -strictMode\n        Use strict mode authentication\n  -timeout duration\n        Master polling timeout (default 10s)\n  -trustedCerts string\n        Comma-separated list of certificates (.pem files) trusted for requests to Mesos endpoints\n  -username string\n        Username for authentication\n  -version\n        Show version\n```\n\nWhen using HTTP or strict mode authentication, the following values are read from the environment, if they are not specified at run time:\n- `MESOS_EXPORTER_USERNAME`\n- `MESOS_EXPORTER_PASSWORD`\n- `MESOS_EXPORTER_PRIVATE_KEY`\n\nWhen collecting metrics from the master, the `-enableMasterState`\nflag will enable the Mesos Exporter to fetch the master's\n[state](http://mesos.apache.org/documentation/latest/endpoints/master/state/)\nendpoint in order to publish metrics about the resources available\non registered agents. In large clusters, polling this endpoint can\ndegrade master performance. In this case, `-enableMasterState` can\nbe disabled on the master exporter and equivalent metrics can be\ncollected by running the Mesos Exporter on each agent.\n\nWhen `-enableMasterState` is true, the master exporter will publish\nthe following additional metrics labeled with the agent ID:\n\n| Metric Name |\n|-------------|\n| mesos_slave_cpus |\n| mesos_slave_cpus_unreserved |\n| mesos_slave_cpus_used |\n| mesos_slave_disk_bytes |\n| mesos_slave_disk_unreserved_bytes |\n| mesos_slave_disk_used_bytes |\n| mesos_slave_mem_bytes |\n| mesos_slave_mem_unreserved_bytes|\n| mesos_slave_mem_used_bytes |\n| mesos_slave_ports |\n| mesos_slave_ports_unreserved |\n| mesos_slave_ports_used |\n\n## Prometheus Configuration\n\nUsually you would run one exporter with `-master` for each master and one\nexporter for each slave with `-slave`. Monitoring each master individually\nensures that the cluster can be monitored even if the underlying Mesos cluster\nis in a degraded state.\n\n- Master: `mesos_exporter -master http://localhost:5050`\n- Agent: `mesos_exporter -slave http://localhost:5051`\n\nThe necessary Prometheus configuration could look like this:\n\n```\n- job_name: mesos-master\n  scrape_interval: 15s\n  scrape_timeout: 10s\n  static_configs:\n  - targets:\n    - master1.mesos.example.org:9105\n    - master2.mesos.example.org:9105\n    - master3.mesos.example.org:9105\n\n- job_name: mesos-slave\n  scrape_interval: 15s\n  scrape_timeout: 10s\n  static_configs:\n  - targets:\n    - node1.mesos.example.org:9105\n    - node2.mesos.example.org:9105\n    - node3.mesos.example.org:9105\n```\n\n\nA minimal set of alerts to ensure your cluster is operational could then be defined\nas follows:\n\n```\nALERT MesosDown\n  IF (up{job=~\"mesos.*\"} == 0) or (irate(mesos_collector_errors_total[5m]) > 0)\n  FOR 5m\n  LABELS { severity=\"warning\" }\n  ANNOTATIONS {\n    description=\"Either the exporter or the associated Mesos component is down.\",\n    summary=\"The Mesos instance {{$labels.instance}} cannot be scraped.\"\n  }\n\nALERT MesosMasterLeader\n  IF sum(mesos_master_elected{job=\"mesos-master\"}) != 1\n  FOR 5m\n  LABELS { severity=\"page\" }\n  ANNOTATIONS {\n    description=\"Agents and frameworks require a unique leading Mesos master.\",\n    summary=\"Expected one leading Mesos master but there are {{ $value }}.\"\n  }\n\nALERT MesosMasterTooManyRestarts\n  IF resets(mesos_master_uptime_seconds{job=\"mesos-master\"}[1h]) > 10\n  FOR 5m\n  LABELS { severity=\"page\" }\n  ANNOTATIONS {\n    description=\"The number of seconds the process has been running is resetting regularly.\",\n    summary=\"The Mesos master {{$labels.instance}} has restarted {{ $value }} times in the last hour.\"\n  }\n\nALERT MesosSlaveActive\n  IF sum(mesos_master_slaves_state{state=\"active\"}) < 0.9 * count(up{job=\"mesos-slave\"})\n  FOR 5m\n  LABELS { severity=\"page\" }\n  ANNOTATIONS {\n    description=\"Mesos agents must be registered with the master in order to receive tasks.\",\n    summary=\"More than 10% of all Mesos agents dropped out. Only {{ $value }} active agents remaining.\"\n  }\n\nALERT MesosSlaveTooManyRestarts\n  IF resets(mesos_slave_uptime_seconds{job=\"mesos-slave\"}[1h]) > 10\n  FOR 5m\n  LABELS { severity=\"page\" }\n  ANNOTATIONS {\n    description=\"The number of seconds the process has been running is resetting regularly.\",\n    summary=\"The Mesos agent {{$labels.instance}} has restarted {{ $value }} times in the last hour.\"\n  }\n```\n",
  "permissions": {
    "read": true,
    "write": false,
    "admin": false
  },
  "media_types": [
    "application/vnd.docker.container.image.v1+json"
  ],
  "content_types": [
    "image"
  ]
}