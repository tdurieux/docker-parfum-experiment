{
  "user": "gbolo",
  "name": "aws-power-toggle",
  "namespace": "gbolo",
  "repository_type": "image",
  "status": 1,
  "status_description": "active",
  "description": "web UI and API for quickly starting and stopping AWS environments",
  "is_private": false,
  "is_automated": true,
  "can_edit": false,
  "star_count": 1,
  "pull_count": 602,
  "last_updated": "2021-01-30T03:37:59.531599Z",
  "date_registered": "2018-11-29T01:56:16.360266Z",
  "collaborator_count": 0,
  "affiliation": null,
  "hub_user": "gbolo",
  "has_starred": false,
  "full_description": "aws-power-toggle [![Build Status](https://travis-ci.org/gbolo/aws-power-toggle.svg?branch=master)](https://travis-ci.org/gbolo/aws-power-toggle) [![Go Report Card](https://goreportcard.com/badge/github.com/gbolo/aws-power-toggle)](https://goreportcard.com/report/github.com/gbolo/aws-power-toggle) ![Coverage](https://gocover.io/_badge/github.com/gbolo/aws-power-toggle/backend)\n================\n\nweb UI and API for quickly starting and stopping AWS environments\n\n![Demo](https://thumbs.gfycat.com/CooperativeDifferentAsiaticlesserfreshwaterclam-size_restricted.gif)\n\n## Getting Started\naws-power-toggle groups your instances by environments (via instance tag [described below](#Required-Tags)), then allows you power toggle\nthem with a single action. This can be very useful when you have to deal with a ton of developers who have multiple environments\nand need to use them sporadically. While you could leave them on all the time, it may result in your boss(es) freaking out about the bill :)\nJust hand this web UI and/or API to the devs and let them decide when to start/stop the environment(s).\nDon't forget to check up on them to make sure they are actually turning them down when not in use :)\n\n### Required Tags\nThe backend polls the aws API periodically (or on demand through web ui). In order for your instances to show up the following\n`instance tags` are **required** (all other instances are ignored):\n\n* `power-toggle-enabled` set to `true`\n* `Environment` set to **non-empty** value\n\nBoth the tags listed above are configurable via the config file (see [power-toggle-config.yaml](testdata/sampleconfig/power-toggle-config.yaml)).\nInstances are grouped by the value of `Environment` tag. Please note that tag values are **case-sensitive*.\n\n### AWS API Key\nthe backend requires an API key to successfully poll AWS (*shock*). Once you have obtained it, set the following environment variables:`AWS_ACCESS_KEY_ID` and `AWS_SECRET_ACCESS_KEY`\n\n### Running the docker image\nOnce you have tagged your AWS instances appropriately (hopefully with [terraform](https://www.terraform.io) or the aws cli) then your ready to deploy.\nOfcourse, this is done quickest via docker:\n```\ndocker run -d --name \"aws-power-toggle\" \\\n -p 8080:8080 \\\n -e \"AWS_ACCESS_KEY_ID=<your_key_id>\" \\\n -e \"AWS_SECRET_ACCESS_KEY=<your_secret_key>\" \\\n gbolo/aws-power-toggle:3.4\n```\n\nThen open your browser to: [http://127.0.0.1:8080](http://127.0.0.1:8080)\n\n### Enabling support for Auto Scaling Groups\nEnabling support for ASGs can be done via the config file or setting the environment variable `POWER_TOGGLE_AWS_ENABLE_ASG_SUPPORT=true`.\nIn order for them to be discovered they **MUST** have the [required tags](#Required-Tags)) **applied directly on the ASG** (the instance tags are ignored).\n\nThe ASG will show up as a single toggleable instance for associated environment, with the cpu/memory being the cumulative total\nof all instances associated with that particular ASG.\n\n**NOTICE:** when the above conditions are met, power-toggle will be able to interact with your ASGs in the following manner:\n- When an ASG is toggled off, BOTH the **minimum and desired capacity will be set to 0**\n- When an ASG is toggled on, BOTH the **minimum and desired capacity will be set to 1**\n\n## Developer Guide\nThe [backend](backend/) server API is written in `go` and the [frontend](frontend/) web UI is written in javascript (vue.js).\nThe backend also serves the frontend content, so the frontend must be built prior compiling the backend.\n\n### Building the docker image\nBy far, the easiest way to build this project is to use docker:\n```\nmake docker\n```\n\nthis will build the docker image, which builds both the frontend and backend.\n\n### Building the frontend\nThe supported version of nodejs is defined in the [.nvmrc](.nvmrc) file located in the root of this repo.\nWe use [nvm](https://github.com/nvm-sh/nvm) to easily switch to this version (but nvm is NOT a requirement):\n```\n# switch to supported nodejs version (if using nvm)\nnvm install\n\n# build the frontend\nmake frontend\n```\nthis should create the static web root directory located in `./frontend/dist/`\n\n### Building the backend\nThe backend should be buildable with versions of `go v1.8` or greater.\n````\nmake backend\n````\nthis should create a binary located in `./bin/aws-power-toggle`\n\n### Running the software\nOnce built, you can run it like:\n```\n# edit the config if needed: ./testdata/sampleconfig/power-toggle-config.yaml\n\n# make your changes to source code or config then export your aws api key\nexport AWS_ACCESS_KEY_ID=<your_key_id>\nexport AWS_SECRET_ACCESS_KEY=<your_secret_key>\n\n# run it\n./bin/aws-power-toggle -config testdata/sampleconfig/power-toggle-config.yaml\n\n# do a test API call\ncurl -v 127.0.0.1:8080/api/v1/env/summary\n```\n\n### Make Targets\n\n```\n$ make help\n\nall             Build both backend and frontend\nbackend         Build backend binary\ndocker          Build docker image\nfrontend        Build frontend\ndep             Run dep ensure to fetch dependencies\nfmt             Run gofmt on all source files\ngoimports       Run goimports on backend source files\nlint            Run golint\ntest            Run go unit tests\nclean           Cleanup everything\n```\n\n### API Documentation\nFor further details on an API endpoint (including example responses), click on the endpoint's name.\n\n* [EnvAllSummary](docs/api/env_all_summary.md): `GET /api/v1/env/summary` retrieves a summary of all known environments\n\n* [EnvSummary](docs/api/env_summary.md): `GET /api/v1/env/{env-id}/summary` retrieves a summary of a single environment\n\n* [EnvAllDetails](docs/api/env_all_details.md): `GET /api/v1/env/details` retrieves full details of all known environments (including list of instances)\n\n* [EnvDetails](docs/api/env_details.md): `GET /api/v1/env/{env-id}/details` retrieves full details of a single environment (including list of instances)\n\n* [StopEnv](docs/api/env_stop.md): `POST /api/v1/env/{env-id}/stop` triggers a shutdown of an environment\n\n* [StartEnv](docs/api/env_start.md): `POST /api/v1/env/{env-id}/start` triggers a startup of an environment\n\n* [StopInstance](docs/api/instance_stop.md): `POST /api/v1/instance/{instance-id}/stop` triggers a shutdown of a single instance\n\n* [StartInstance](docs/api/instance_start.md): `POST /api/v1/instance/{instance-id}/start` triggers a startup of a single instance\n\n* [Refresh](docs/api/refresh.md): `POST /api/v1/refresh` forces backend to refresh it's cache\n\n* [Version](docs/api/version.md): `GET /api/v1/version` returns backend version information\n\n* [Config](docs/api/config.md): `GET /api/v1/config` returns relevant backend configuration\n\n### Enabling AWS API mocking (web dev mode)\nIt may be useful to mock the aws API when doing development work against the API (like for web ui development).\nThis means you don't need an aws api key. To enable this feature, set env variable `POWER_TOGGLE_MOCK_ENABLED=true`:\n\n```\n# build then start\nmake all\nPOWER_TOGGLE_MOCK_ENABLED=true ./bin/aws-power-toggle -config testdata/sampleconfig/power-toggle-config.yaml\n```\n\nif you would like to add/remove/change any of the fake inventory, then modify this file:\n`backend/mockdata.go`\n\n### Enabling Experimental Features\nCertain features in the project are experimental and subject to further enhancements.\nCurrent experimental features include:\n\n* Display billing stats: This feature displays the estimated total cost of all instances in each env. **Counter will reset upon application restarts**\n\nTo enable experimental features:\n```\n# set env variable POWER_TOGGLE_EXPERIMENTAL_ENABLED to true (or change experimental.enabled in config file):\nexport POWER_TOGGLE_EXPERIMENTAL_ENABLED=true\n```\n",
  "permissions": {
    "read": true,
    "write": false,
    "admin": false
  },
  "media_types": [
    "application/vnd.docker.container.image.v1+json"
  ],
  "content_types": [
    "image"
  ]
}