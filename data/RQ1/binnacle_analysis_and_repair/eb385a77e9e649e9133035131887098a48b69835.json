{
  "startTime": 1674249872868,
  "endTime": 1674249873516,
  "originalSmells": [
    {
      "rule": "configureShouldUseBuildFlag",
      "position": {
        "lineStart": 49,
        "lineEnd": 52,
        "columnStart": 2,
        "columnEnd": 25
      }
    },
    {
      "rule": "tarSomethingRmTheSomething",
      "position": {
        "lineStart": 42,
        "lineEnd": 42,
        "columnStart": 2,
        "columnEnd": 48
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "FROM csp-alpine35glibc:1.0\n\nMAINTAINER tku\n\n# version of RT\nENV RT_VERSION=4.4.2\n# version of RT::IR extension\nENV RT_IR_VERSION=4.0.0\n# address of the RT host\nENV RT_HOSTNAME=csp-rt\n# address of the postgresql host\nENV RT_DB_HOST=csp-postgres\n# port of the postgresql\nENV RT_DB_PORT=5432\n# type of the db to be used by RT -> here postgresql\nENV RT_DB_TYPE=Pg\n\nRUN set -x && \\\n  apk update && \\\n  apk upgrade && \\\n  apk --update add lighttpd perl wget vim fcgi postfix-pcre openssl \\\n    postgresql-client perl-lwp-protocol-https perl-dbd-pg perl-dbd-mysql \\\n    perl-dbd-sqlite perl-cgi-psgi perl-cgi perl-fcgi perl-term-readkey \\\n    perl-xml-rss perl-crypt-ssleay perl-crypt-eksblowfish perl-crypt-x509 \\\n    perl-html-mason-psgihandler perl-fcgi-procmanager perl-mime-types \\\n    perl-list-moreutils perl-json perl-html-quoted perl-html-scrubber \\\n    perl-email-address perl-text-password-pronounceable perl-email-address-list \\\n    perl-html-formattext-withlinks-andtables perl-html-rewriteattributes \\\n    perl-text-wikiformat perl-text-quoted perl-datetime-format-natural \\\n    perl-date-extract perl-data-guid perl-data-ical perl-string-shellquote \\\n    perl-convert-color perl-dbix-searchbuilder perl-file-which perl-css-squish \\\n    perl-tree-simple perl-plack perl-log-dispatch perl-module-versions-report \\\n    perl-symbol-global-name perl-devel-globaldestruction perl-parallel-prefork \\\n    perl-cgi-emulate-psgi perl-text-template perl-net-cidr perl-apache-session \\\n    perl-locale-maketext-lexicon perl-locale-maketext-fuzzy perl-graphviz \\\n    perl-regexp-common-net-cidr perl-module-refresh perl-date-manip \\\n    perl-regexp-ipv6 perl-text-wrapper perl-universal-require perl-role-basic \\\n    perl-convert-binhex perl-test-sharedfork perl-test-tcp perl-server-starter \\\n    perl-starlet make gnupg gcc perl-dev libc-dev less expat-dev perl-gd gd lua && \\\n  rm -f /var/cache/apk/* && \\\n  wget -O /tmp/rt-$RT_VERSION.tar.gz https://download.bestpractical.com/pub/rt/release/rt-$RT_VERSION.tar.gz && \\\n  wget -O /tmp/RT-IR-$RT_IR_VERSION.tar.gz https://download.bestpractical.com/pub/rt/release/RT-IR-$RT_IR_VERSION.tar.gz && \\\n  tar -xvz -C /tmp -f /tmp/rt-$RT_VERSION.tar.gz && \\\n  cd /tmp/rt-$RT_VERSION && \\\n  (echo y;echo o conf prerequisites_policy follow;echo o conf commit)|cpan && \\\n  cpan -f GnuPG::Interface && \\\n  cpan -f Capture::Tiny && \\\n  cpan -f Time::ParseDate && \\\n  cpan -f REST::Client && \\\n  ./configure --build=\"$(dpkg-architecture --query DEB_BUILD_GNU_TYPE)\" --with-web-user=lighttpd --with-web-group=lighttpd --enable-gpg --enable-gd \\\n    --enable-graphviz --with-db-type=${RT_DB_TYPE} --with-db-host=${RT_DB_HOST} \\\n    --with-db-port=${RT_DB_PORT} --with-db-rt-host=${RT_HOSTNAME} \\\n    --enable-externalauth && \\\n  make fixdeps && \\\n  make install && \\\n  mkdir /var/run/lighttpd/ && \\\n  touch /var/run/lighttpd/lighttpd-fcgi.sock-0 && \\\n  chown -R lighttpd:lighttpd /var/run/lighttpd && \\\n  mkdir /scripts && \\\n  mkdir /scripts/rt && \\\n  mkdir -p /opt/rt4/local/lib/RT/Action && \\\n  mkdir -p /opt/rt4/local/lib/RT/Condition && \\\n  mkdir -p /opt/rt4/local/lib/RT/CustomFieldValues && \\\n  mv /opt/rt4/etc/initialdata /opt/rt4/etc/initialdata.orig && \\\n  mkdir -p /opt/rt4/var/log && \\\n  touch /opt/rt4/var/log/CSP.RT-exc.log && \\\n  chown -R lighttpd:lighttpd /opt/rt4/var && rm /tmp/rt-$RT_VERSION.tar.gz\n\nADD config/mod_fastcgi.conf /etc/lighttpd/\nADD config/lighttpd.conf /etc/lighttpd/\nADD config/remote_user.lua /etc/lighttpd/\nADD config/RT_SiteConfig.pm /opt/rt4/etc/\nADD scripts/run.sh /scripts/run.sh\nADD scripts/reinitdb.sh /scripts/reinitdb.sh\nADD scripts/dropdb.sh /scripts/dropdb.sh\nADD scripts/initdb.sh /scripts/initdb.sh\nADD scripts/initrt.sh /scripts/initrt.sh\nADD scripts/cleandb.sh /scripts/cleandb.sh\nADD scripts/uninit-rt.sh /scripts/uninit-rt.sh\nADD config/custom-actions/SetUUIDAction.pm /opt/rt4/local/lib/RT/Action/SetUUIDAction.pm\nADD config/custom-actions/CSPOnCreateAction.pm /opt/rt4/local/lib/RT/Action/CSPOnCreateAction.pm\nADD config/custom-conditions/CSP_ToEmitter.pm /opt/rt4/local/lib/RT/Condition/CSP_ToEmitter.pm\nADD config/custom-field-values/CustomTCSource.pm /opt/rt4/local/lib/RT/CustomFieldValues/CustomTCSource.pm\n# only temp solution, should be replaced by directly call to TC\nADD config/custom-field-values/tc-list.json /opt/rt4/local/lib/RT/CustomFieldValues/tc-list.json\nADD config/custom-field-values/teams-list.json /opt/rt4/local/lib/RT/CustomFieldValues/teams-list.json\n# end of temp solution\nADD config/initialdata.csp /opt/rt4/etc/initialdata\nADD config/additional-initialdata.csp /opt/rt4/etc/additional-initialdata.csp\n\nRUN chown lighttpd:lighttpd /opt/rt4/etc/RT_SiteConfig.pm && \\\n  chown lighttpd:lighttpd /etc/lighttpd/* && \\\n  chmod 400 /etc/lighttpd/* && \\\n  cd /tmp && \\\n  tar -xzf RT-IR-$RT_IR_VERSION.tar.gz && \\\n  cd RT-IR-${RT_IR_VERSION} && \\\n  cpan Parse::BooleanLogic && \\\n  cpan Cpanel::JSON::XS && \\\n  cpan JSON::XS && \\\n  perl Makefile.PL && \\\n  make && \\\n  make install && \\\n  cd / && \\\n  chmod -R 0755 /scripts && \\\n  rm -f /tmp/rt-$RT_VERSION.tar.gz && \\\n  rm -f /tmp/RT-IR-$RT_IR_VERSION.tar.gz && \\\n  echo \"DONE SUCCESSFULLY !!!!\"\n\nEXPOSE 80\n\nENTRYPOINT [\"/scripts/run.sh\"]\n\n"
}