{
  "startTime": 1674251810296,
  "endTime": 1674251810669,
  "originalSmells": [
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 36,
        "lineEnd": 36,
        "columnStart": 4,
        "columnEnd": 69
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 41,
        "lineEnd": 41,
        "columnStart": 22,
        "columnEnd": 89
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "FROM jupyter/scipy-notebook:latest\nMAINTAINER https://github.com/NII-cloud-operation\n\nUSER root\n# Install tools and fonts\nRUN apt-get update && apt-get install -yq --no-install-recommends \\\n    git \\\n    vim \\\n    jed \\\n    emacs \\\n    unzip \\\n    libsm6 \\\n    pandoc \\\n    texlive-latex-base \\\n    texlive-latex-extra \\\n    texlive-fonts-extra \\\n    texlive-fonts-recommended \\\n    texlive-generic-recommended \\\n    libxrender1 \\\n    inkscape \\\n    wget \\\n    curl \\\n    fonts-ipafont-gothic fonts-ipafont-mincho \\\n    && apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n\n# Copy config files\nADD conf /tmp/\nRUN mkdir -p $CONDA_DIR/etc/jupyter && \\\n    cp -f /tmp/jupyter_notebook_config.py \\\n       $CONDA_DIR/etc/jupyter/jupyter_notebook_config.py\n\nSHELL [\"/bin/bash\", \"-c\"]\n\n### ansible\nRUN apt-get update && \\\n    apt-get -y --no-install-recommends install sshpass openssl ipmitool libssl-dev libffi-dev && \\\n    apt-get clean && rm -rf /var/lib/apt/lists/* && \\\n    pip --no-cache-dir install requests paramiko ansible\n\n### Utilities\nRUN apt-get update && apt-get install --no-install-recommends -y virtinst dnsutils zip tree jq rsync iputils-ping && \\\n    apt-get clean && rm -rf /var/lib/apt/lists/* && \\\n    pip --no-cache-dir install netaddr pyapi-gitlab runipy papermill==0.19.0 \\\n                pysnmp pysnmp-mibs\n\n### Add files\nRUN mkdir -p /etc/ansible && cp /tmp/ansible.cfg /etc/ansible/ansible.cfg\n\n#### Visualization\nRUN pip --no-cache-dir install folium\n\n### extensions for jupyter\n#### jupyter_nbextensions_configurator\n#### jupyter_contrib_nbextensions\n#### Jupyter-LC_nblineage (NII) - https://github.com/NII-cloud-operation/Jupyter-LC_nblineage\n#### Jupyter-LC_through (NII) - https://github.com/NII-cloud-operation/Jupyter-LC_run_through\n#### Jupyter-LC_wrapper (NII) - https://github.com/NII-cloud-operation/Jupyter-LC_wrapper\n#### Jupyter-multi_outputs (NII) - https://github.com/NII-cloud-operation/Jupyter-multi_outputs\n#### Jupyter-LC_index (NII) - https://github.com/NII-cloud-operation/Jupyter-LC_index\nRUN pip --no-cache-dir install jupyter_nbextensions_configurator && \\\n    pip --no-cache-dir install six bash_kernel \\\n    https://github.com/ipython-contrib/jupyter_contrib_nbextensions/tarball/master \\\n    https://github.com/NII-cloud-operation/Jupyter-LC_nblineage/tarball/master \\\n    https://github.com/NII-cloud-operation/Jupyter-LC_run_through/tarball/master \\\n    https://github.com/NII-cloud-operation/Jupyter-LC_wrapper/tarball/master \\\n    git+https://github.com/NII-cloud-operation/Jupyter-multi_outputs \\\n    git+https://github.com/NII-cloud-operation/Jupyter-LC_index.git \\\n    git+https://github.com/NII-cloud-operation/Jupyter-LC_notebook_diff.git \\\n    git+https://github.com/NII-cloud-operation/sidestickies.git\n\n\nRUN jupyter contrib nbextension install --sys-prefix && \\\n    jupyter nblineage quick-setup --sys-prefix && \\\n    jupyter nbextension install --py lc_run_through --sys-prefix && \\\n    jupyter nbextension enable --py lc_run_through --sys-prefix && \\\n    jupyter nbextension install --py lc_multi_outputs --sys-prefix && \\\n    jupyter nbextension enable --py lc_multi_outputs --sys-prefix && \\\n    jupyter nbextension install --py notebook_index --sys-prefix && \\\n    jupyter nbextension enable --py notebook_index --sys-prefix && \\\n    jupyter nbextension install --py lc_wrapper --sys-prefix && \\\n    jupyter nbextension enable --py lc_wrapper --sys-prefix && \\\n    jupyter nbextension install --py lc_notebook_diff --sys-prefix && \\\n    jupyter nbextension install --py nbtags --sys-prefix && \\\n    jupyter serverextension enable --py nbtags --sys-prefix && \\\n    jupyter nbextension enable nbextensions_configurator/config_menu/main --sys-prefix && \\\n    jupyter nbextension enable contrib_nbextensions_help_item/main --sys-prefix && \\\n    jupyter nbextension enable collapsible_headings/main --sys-prefix && \\\n    jupyter nbextension enable toc2/main --sys-prefix && \\\n    jupyter nbextension enable dragdrop/main --sys-prefix && \\\n    python -m bash_kernel.install --sys-prefix && \\\n    jupyter kernelspec install /tmp/kernels/python3-wrapper --sys-prefix && \\\n    jupyter kernelspec install /tmp/kernels/bash-wrapper --sys-prefix && \\\n    jupyter wrapper-kernelspec install /tmp/wrapper-kernels/python3 --sys-prefix && \\\n    jupyter wrapper-kernelspec install /tmp/wrapper-kernels/bash --sys-prefix && \\\n    fix-permissions /home/$NB_USER\n\n### nbconfig\nRUN mkdir -p $CONDA_DIR/etc/jupyter/nbconfig/notebook.d && \\\n    cp /tmp/nbextension-config.json $CONDA_DIR/etc/jupyter/nbconfig/notebook.d/nbextension-config.json\n\n### notebooks dir\nADD sample-notebooks /home/$NB_USER\nRUN fix-permissions /home/$NB_USER\n\n### Bash Strict Mode\nRUN cp /tmp/bash_env /etc/bash_env\n\n### Theme for jupyter\nRUN CUSTOM_DIR=$(python -c 'from distutils.sysconfig import get_python_lib; print(get_python_lib())')/notebook/static/custom && \\\n    cat /tmp/custom.css >> $CUSTOM_DIR/custom.css && \\\n    cp /tmp/logo.png $CUSTOM_DIR/logo.png && \\\n    mkdir -p $CUSTOM_DIR/codemirror/addon/merge/ && \\\n    curl -fL https://raw.githubusercontent.com/cytoscape/cytoscape.js/master/dist/cytoscape.min.js > $CUSTOM_DIR/cytoscape.min.js && \\\n    curl -fL https://raw.githubusercontent.com/iVis-at-Bilkent/cytoscape.js-view-utilities/master/cytoscape-view-utilities.js > $CUSTOM_DIR/cytoscape-view-utilities.js && \\\n    curl -fL https://raw.githubusercontent.com/NII-cloud-operation/Jupyter-LC_notebook_diff/master/html/jupyter-notebook-diff.js > $CUSTOM_DIR/jupyter-notebook-diff.js && \\\n    curl -fL https://raw.githubusercontent.com/NII-cloud-operation/Jupyter-LC_notebook_diff/master/html/jupyter-notebook-diff.css > $CUSTOM_DIR/jupyter-notebook-diff.css && \\\n    curl -fL https://cdnjs.cloudflare.com/ajax/libs/diff_match_patch/20121119/diff_match_patch.js > $CUSTOM_DIR/diff_match_patch.js && \\\n    curl -fL https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.35.0/addon/merge/merge.js > $CUSTOM_DIR/codemirror/addon/merge/merge.js && \\\n    curl -fL https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.35.0/addon/merge/merge.min.css > $CUSTOM_DIR/merge.min.css\n\n### Custom get_ipython().system() to control error propagation of shell commands\nRUN mkdir -p $CONDA_DIR/etc/ipython/startup/ && \\\n    cp /tmp/ipython_config.py $CONDA_DIR/etc/ipython/ && \\\n    cp /tmp/10-custom-get_ipython_system.py $CONDA_DIR/etc/ipython/startup/\n\n### Add run-hooks\nRUN mkdir -p /usr/local/bin/before-notebook.d && \\\n    cp /tmp/ssh-agent.sh /usr/local/bin/before-notebook.d/\n\nUSER $NB_USER\n"
}