{
  "startTime": 1674245934859,
  "endTime": 1674245935216,
  "originalSmells": [
    {
      "rule": "configureShouldUseBuildFlag",
      "position": {
        "lineStart": 23,
        "lineEnd": 24,
        "columnStart": 4,
        "columnEnd": 63
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "FROM jedisct1/alpine-runit:latest\nMAINTAINER Frank Denis\nENV SERIAL 3\n\nENV BUILD_DEPS   make gcc musl-dev git libevent-dev expat-dev shadow autoconf file openssl-dev byacc linux-headers\nENV RUNTIME_DEPS bash util-linux coreutils findutils grep openssl ldns ldns-tools libevent expat libexecinfo coreutils drill ca-certificates\n\nRUN set -x && \\\n    apk --no-cache upgrade && apk add --no-cache $RUNTIME_DEPS && \\\n    update-ca-certificates 2> /dev/null || true\n\nENV UNBOUND_GIT_URL https://github.com/jedisct1/unbound.git\nENV UNBOUND_GIT_REVISION f5e3a85e960c2574be87f75a2b2c894d6995e0e2\n\nRUN set -x && \\\n    apk add --no-cache $BUILD_DEPS && \\\n    mkdir -p /tmp/src && \\\n    cd /tmp/src && \\\n    git clone --depth=1000 \"$UNBOUND_GIT_URL\" && \\\n    cd unbound && \\\n    git checkout \"$UNBOUND_GIT_REVISION\" && \\\n    groupadd _unbound && \\\n    useradd -g _unbound -s /etc -d /dev/null _unbound && \\\n    ./configure --build=\"$(dpkg-architecture --query DEB_BUILD_GNU_TYPE)\" --prefix=/opt/unbound --with-pthreads \\\n    --with-username=_unbound --with-libevent --enable-event-api && \\\n    make -j$(getconf _NPROCESSORS_ONLN) install && \\\n    mv /opt/unbound/etc/unbound/unbound.conf /opt/unbound/etc/unbound/unbound.conf.example && \\\n    apk del --purge $BUILD_DEPS && \\\n    rm -fr /opt/unbound/share/man && \\\n    rm -fr /tmp/* /var/tmp/*\n\nENV LIBSODIUM_GIT_URL https://github.com/jedisct1/libsodium.git\n\nRUN set -x && \\\n    apk add --no-cache $BUILD_DEPS && \\\n    mkdir -p /tmp/src && \\\n    cd /tmp/src && \\\n    git clone --depth=1 --branch stable \"$LIBSODIUM_GIT_URL\" && \\\n    cd libsodium && \\\n    env CFLAGS=-Ofast ./configure --disable-dependency-tracking && \\\n    make -j$(getconf _NPROCESSORS_ONLN) check && make -j$(getconf _NPROCESSORS_ONLN) install && \\\n    ldconfig /usr/local/lib && \\\n    apk del --purge $BUILD_DEPS && \\\n    rm -fr /tmp/* /var/tmp/*\n\nENV DNSCRYPT_WRAPPER_GIT_URL https://github.com/jedisct1/dnscrypt-wrapper.git\nENV DNSCRYPT_WRAPPER_GIT_BRANCH xchacha-stamps\n\nCOPY queue.h /tmp\n\nRUN set -x && \\\n    apk add --no-cache $BUILD_DEPS && \\\n    mkdir -p /tmp/src && \\\n    cd /tmp/src && \\\n    git clone --depth=1 --branch=${DNSCRYPT_WRAPPER_GIT_BRANCH} ${DNSCRYPT_WRAPPER_GIT_URL} && \\\n    cd dnscrypt-wrapper && \\\n    sed -i 's#<sys/queue.h>#\"/tmp/queue.h\"#' compat.h && \\\n    sed -i 's#HAVE_BACKTRACE#NO_BACKTRACE#' compat.h && \\\n    mkdir -p /opt/dnscrypt-wrapper/empty && \\\n    groupadd _dnscrypt-wrapper && \\\n    useradd -g _dnscrypt-wrapper -s /etc -d /opt/dnscrypt-wrapper/empty _dnscrypt-wrapper && \\\n    groupadd _dnscrypt-signer && \\\n    useradd -g _dnscrypt-signer -G _dnscrypt-wrapper -s /etc -d /dev/null _dnscrypt-signer && \\\n    make -j$(getconf _NPROCESSORS_ONLN) configure && \\\n    env CFLAGS=-Ofast ./configure --prefix=/opt/dnscrypt-wrapper && \\\n    make -j$(getconf _NPROCESSORS_ONLN) install && \\\n    apk del --purge $BUILD_DEPS && \\\n    rm -fr /tmp/* /var/tmp/*\n\nRUN set -x && \\\n    echo rm -rf /tmp/* /var/tmp/* /usr/local/include\n\nRUN mkdir -p \\\n    /etc/service/unbound \\\n    /etc/service/watchdog\n\nCOPY entrypoint.sh /\n\nCOPY unbound.sh /etc/service/unbound/run\nCOPY unbound-check.sh /etc/service/unbound/check\n\nCOPY dnscrypt-wrapper.sh /etc/service/dnscrypt-wrapper/run\n\nCOPY key-rotation.sh /etc/service/key-rotation/run\nCOPY watchdog.sh /etc/service/watchdog/run\n\nVOLUME [\"/opt/dnscrypt-wrapper/etc/keys\"]\n\nEXPOSE 443/udp 443/tcp\n\nCMD [\"/sbin/start_runit\"]\n\nENTRYPOINT [\"/entrypoint.sh\"]\n"
}