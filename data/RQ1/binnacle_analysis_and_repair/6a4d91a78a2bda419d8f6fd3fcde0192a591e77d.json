{
  "startTime": 1674249870912,
  "endTime": 1674249871090,
  "originalSmells": [
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 21,
        "lineEnd": 21,
        "columnStart": 4,
        "columnEnd": 28
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "# Copyright (C) 2007-2019 Crafter Software Corporation. All Rights Reserved.\n#\n# This program is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# This program is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with this program.  If not, see <http://www.gnu.org/licenses/>.\nFROM tomcat:8-slim\n\n# Install dependencies\nARG DEBIAN_FRONTEND=noninteractive\n\nRUN set -eux; \\\n    apt-get update; \\\n    apt-get install --no-install-recommends -y gosu; \\\n    apt-get install -y --no-install-recommends lsof; \\\n    apt-get install -y --no-install-recommends openssh-client; \\\n    apt-get install -y --no-install-recommends git; \\\n    rm -rf /var/lib/apt/lists/*;\n\n# Create folders and make CRAFTER_HOME the workdir\nRUN mkdir -p /opt/crafter; \\\n    mkdir /opt/crafter/bin; \\\n    mkdir /opt/crafter/backups; \\\n    mkdir /opt/crafter/data; \\\n    mkdir /opt/crafter/logs; \\\n    mkdir /opt/crafter/temp\n\nWORKDIR /opt/crafter\n\n# Create volumes\nVOLUME [ \"/opt/crafter/data\", \"/opt/crafter/logs\", \"/opt/crafter/temp\" ]\n\n# Copy bin folder\nCOPY ./bin ./bin/\n\n# Delete the bin/dbms dir\nRUN rm -rf ./bin/dbms\n# Delete the apache tomcat folder, we're going to link to the image's own Tomcat\nRUN rm -rf ./bin/apache-tomcat && ln -s /usr/local/tomcat ./bin/apache-tomcat\n\n# Copy Tomcat setenv.sh, config, shared and webapps\nRUN rm -rf ./bin/apache-tomcat/conf/* && rm -rf ./bin/apache-tomcat/webapps/*\nCOPY ./bin/apache-tomcat/bin/setenv.sh ./bin/apache-tomcat/bin/\nCOPY ./bin/apache-tomcat/conf ./bin/apache-tomcat/conf/\nCOPY ./bin/apache-tomcat/webapps ./bin/apache-tomcat/webapps/\n\n# Create and copy the shared folder\nRUN mkdir ./bin/apache-tomcat/shared\nCOPY ./bin/apache-tomcat/shared ./bin/apache-tomcat/shared/\n\n# Remove CATALINA_HOME from crafter-setenv.sh\nRUN sed -i '/export CATALINA_HOME=$CRAFTER_BIN_DIR\\/apache-tomcat/d' ./bin/crafter-setenv.sh\n\n# Replace ports for default ones\nRUN sed -i 's/8694/8983/g' ./bin/crafter-setenv.sh; \\\n    sed -i 's/9201/9200/g' ./bin/crafter-setenv.sh; \\\n    sed -i 's/27020/27017/g' ./bin/crafter-setenv.sh; \\\n    sed -i 's/33306/3306/g' ./bin/crafter-setenv.sh;\n\n# Copy entrypoint script and make it executable\nCOPY ./docker-entrypoint.sh .\nRUN chmod +x docker-entrypoint.sh\n\n# Add the Crafter user\nRUN groupadd -r -g 1000 crafter && useradd -r -m -u 1000 -g crafter crafter; \\\n    chown -R crafter:crafter .; \\\n    chown -R crafter:crafter /usr/local/tomcat\n\n# Entrypoint and command (run by default)\nENTRYPOINT [ \"./docker-entrypoint.sh\" ]\nCMD [ \"run\" ]"
}