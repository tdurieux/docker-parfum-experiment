{
  "startTime": 1674241609019,
  "endTime": 1674241610719,
  "originalSmells": [
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 67,
        "lineEnd": 67,
        "columnStart": 4,
        "columnEnd": 62
      }
    },
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 85,
        "lineEnd": 85,
        "columnStart": 4,
        "columnEnd": 123
      }
    },
    {
      "rule": "wgetUseHttpsUrl",
      "position": {
        "lineStart": 113,
        "lineEnd": 113,
        "columnStart": 4,
        "columnEnd": 79
      }
    },
    {
      "rule": "wgetUseHttpsUrl",
      "position": {
        "lineStart": 114,
        "lineEnd": 114,
        "columnStart": 4,
        "columnEnd": 84
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 148,
        "lineEnd": 148,
        "columnStart": 4,
        "columnEnd": 33
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 151,
        "lineEnd": 151,
        "columnStart": 4,
        "columnEnd": 35
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 152,
        "lineEnd": 152,
        "columnStart": 4,
        "columnEnd": 29
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 153,
        "lineEnd": 153,
        "columnStart": 4,
        "columnEnd": 28
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 155,
        "lineEnd": 155,
        "columnStart": 4,
        "columnEnd": 30
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 156,
        "lineEnd": 156,
        "columnStart": 4,
        "columnEnd": 30
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 157,
        "lineEnd": 157,
        "columnStart": 4,
        "columnEnd": 38
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 158,
        "lineEnd": 158,
        "columnStart": 4,
        "columnEnd": 44
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 159,
        "lineEnd": 159,
        "columnStart": 4,
        "columnEnd": 57
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 160,
        "lineEnd": 160,
        "columnStart": 4,
        "columnEnd": 41
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 161,
        "lineEnd": 161,
        "columnStart": 4,
        "columnEnd": 45
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 162,
        "lineEnd": 162,
        "columnStart": 4,
        "columnEnd": 53
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 163,
        "lineEnd": 163,
        "columnStart": 4,
        "columnEnd": 44
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 164,
        "lineEnd": 164,
        "columnStart": 4,
        "columnEnd": 34
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 165,
        "lineEnd": 165,
        "columnStart": 4,
        "columnEnd": 53
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 166,
        "lineEnd": 166,
        "columnStart": 4,
        "columnEnd": 39
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 167,
        "lineEnd": 167,
        "columnStart": 4,
        "columnEnd": 34
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 168,
        "lineEnd": 168,
        "columnStart": 4,
        "columnEnd": 30
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 171,
        "lineEnd": 171,
        "columnStart": 4,
        "columnEnd": 28
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 172,
        "lineEnd": 172,
        "columnStart": 4,
        "columnEnd": 30
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 173,
        "lineEnd": 173,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 174,
        "lineEnd": 174,
        "columnStart": 4,
        "columnEnd": 31
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 175,
        "lineEnd": 175,
        "columnStart": 4,
        "columnEnd": 32
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 176,
        "lineEnd": 176,
        "columnStart": 4,
        "columnEnd": 35
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 177,
        "lineEnd": 177,
        "columnStart": 4,
        "columnEnd": 39
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 255,
        "lineEnd": 255,
        "columnStart": 4,
        "columnEnd": 31
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 257,
        "lineEnd": 257,
        "columnStart": 4,
        "columnEnd": 36
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 258,
        "lineEnd": 258,
        "columnStart": 4,
        "columnEnd": 36
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 260,
        "lineEnd": 260,
        "columnStart": 4,
        "columnEnd": 30
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 261,
        "lineEnd": 261,
        "columnStart": 4,
        "columnEnd": 29
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 263,
        "lineEnd": 263,
        "columnStart": 4,
        "columnEnd": 31
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 264,
        "lineEnd": 264,
        "columnStart": 4,
        "columnEnd": 31
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 265,
        "lineEnd": 265,
        "columnStart": 4,
        "columnEnd": 31
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 266,
        "lineEnd": 266,
        "columnStart": 4,
        "columnEnd": 35
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 267,
        "lineEnd": 267,
        "columnStart": 4,
        "columnEnd": 33
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 268,
        "lineEnd": 268,
        "columnStart": 4,
        "columnEnd": 39
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 269,
        "lineEnd": 269,
        "columnStart": 4,
        "columnEnd": 45
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 270,
        "lineEnd": 270,
        "columnStart": 4,
        "columnEnd": 58
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 271,
        "lineEnd": 271,
        "columnStart": 4,
        "columnEnd": 42
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 272,
        "lineEnd": 272,
        "columnStart": 4,
        "columnEnd": 46
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 273,
        "lineEnd": 273,
        "columnStart": 4,
        "columnEnd": 54
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 274,
        "lineEnd": 274,
        "columnStart": 4,
        "columnEnd": 45
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 275,
        "lineEnd": 275,
        "columnStart": 4,
        "columnEnd": 54
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 276,
        "lineEnd": 276,
        "columnStart": 4,
        "columnEnd": 37
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 277,
        "lineEnd": 277,
        "columnStart": 4,
        "columnEnd": 35
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 278,
        "lineEnd": 278,
        "columnStart": 4,
        "columnEnd": 31
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 281,
        "lineEnd": 281,
        "columnStart": 4,
        "columnEnd": 29
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 282,
        "lineEnd": 282,
        "columnStart": 4,
        "columnEnd": 31
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 283,
        "lineEnd": 283,
        "columnStart": 4,
        "columnEnd": 28
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 284,
        "lineEnd": 284,
        "columnStart": 4,
        "columnEnd": 32
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 285,
        "lineEnd": 285,
        "columnStart": 4,
        "columnEnd": 33
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 286,
        "lineEnd": 286,
        "columnStart": 4,
        "columnEnd": 36
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 287,
        "lineEnd": 287,
        "columnStart": 4,
        "columnEnd": 40
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 288,
        "lineEnd": 288,
        "columnStart": 4,
        "columnEnd": 30
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 289,
        "lineEnd": 289,
        "columnStart": 4,
        "columnEnd": 31
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 290,
        "lineEnd": 290,
        "columnStart": 4,
        "columnEnd": 30
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 291,
        "lineEnd": 291,
        "columnStart": 4,
        "columnEnd": 28
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 292,
        "lineEnd": 292,
        "columnStart": 4,
        "columnEnd": 36
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 293,
        "lineEnd": 293,
        "columnStart": 4,
        "columnEnd": 29
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 294,
        "lineEnd": 294,
        "columnStart": 4,
        "columnEnd": 29
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 295,
        "lineEnd": 295,
        "columnStart": 4,
        "columnEnd": 32
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 296,
        "lineEnd": 296,
        "columnStart": 4,
        "columnEnd": 29
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 297,
        "lineEnd": 297,
        "columnStart": 4,
        "columnEnd": 32
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 298,
        "lineEnd": 298,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 299,
        "lineEnd": 299,
        "columnStart": 4,
        "columnEnd": 33
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 300,
        "lineEnd": 300,
        "columnStart": 4,
        "columnEnd": 28
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 301,
        "lineEnd": 301,
        "columnStart": 4,
        "columnEnd": 39
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 302,
        "lineEnd": 302,
        "columnStart": 4,
        "columnEnd": 29
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 303,
        "lineEnd": 303,
        "columnStart": 4,
        "columnEnd": 29
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 304,
        "lineEnd": 304,
        "columnStart": 4,
        "columnEnd": 29
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 305,
        "lineEnd": 305,
        "columnStart": 4,
        "columnEnd": 29
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 306,
        "lineEnd": 306,
        "columnStart": 4,
        "columnEnd": 28
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 307,
        "lineEnd": 307,
        "columnStart": 4,
        "columnEnd": 34
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 308,
        "lineEnd": 308,
        "columnStart": 4,
        "columnEnd": 30
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 309,
        "lineEnd": 309,
        "columnStart": 4,
        "columnEnd": 29
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 310,
        "lineEnd": 310,
        "columnStart": 4,
        "columnEnd": 33
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 311,
        "lineEnd": 311,
        "columnStart": 4,
        "columnEnd": 35
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 312,
        "lineEnd": 312,
        "columnStart": 4,
        "columnEnd": 39
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 313,
        "lineEnd": 313,
        "columnStart": 4,
        "columnEnd": 30
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 314,
        "lineEnd": 314,
        "columnStart": 4,
        "columnEnd": 30
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 315,
        "lineEnd": 315,
        "columnStart": 4,
        "columnEnd": 35
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 316,
        "lineEnd": 316,
        "columnStart": 4,
        "columnEnd": 22
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 318,
        "lineEnd": 318,
        "columnStart": 4,
        "columnEnd": 31
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 319,
        "lineEnd": 319,
        "columnStart": 4,
        "columnEnd": 45
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 320,
        "lineEnd": 320,
        "columnStart": 4,
        "columnEnd": 50
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 321,
        "lineEnd": 321,
        "columnStart": 4,
        "columnEnd": 69
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 322,
        "lineEnd": 322,
        "columnStart": 4,
        "columnEnd": 29
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "# adapted from https://hub.docker.com/r/jupyter/base-notebook/ AKA https://github.com/jupyter/docker-stacks/tree/master/base-notebook\n\nFROM debian:stretch\n\nUSER root\n\n#######################\n# Prerequisites\n#######################\n\nENV DEBIAN_FRONTEND noninteractive\nENV DEBIAN_REPO http://cdn-fastly.deb.debian.org\nENV CRAN_REPO http://cran.mtu.edu\n\nRUN echo \"deb $DEBIAN_REPO/debian stretch main\"                   > /etc/apt/sources.list \\\n && echo \"deb $DEBIAN_REPO/debian-security stretch/updates main\" >> /etc/apt/sources.list \\\n && echo \"deb $DEBIAN_REPO/debian stretch-backports main\"        >> /etc/apt/sources.list \\\n && echo \"deb $DEBIAN_REPO/debian testing main\"                  >> /etc/apt/sources.list \\\n && echo 'APT::Default-Release \"stable\";' | tee -a /etc/apt/apt.conf.d/00local \\\n && apt-get update \\\n && apt-get -yq dist-upgrade \\\n && apt-get install -yq --no-install-recommends \\\n    unzip \\\n    nano \\\n    sudo \\\n    default-jre \\\n    default-jdk \\\n    gnupg \\\n    dirmngr \\\n    wget \\\n    ca-certificates \\\n    curl \\\n    build-essential \\\n    lsb-release \\\n    procps \\\n    openssl \\\n    make \\\n    aptitude \\\n    libssl-dev \\\n    zlib1g-dev \\\n    libbz2-dev \\\n    libreadline-dev \\\n    libsqlite3-dev \\\n    llvm \\\n    libncurses5-dev \\\n    libncursesw5-dev \\\n    xz-utils \\\n    tk-dev \\\n    samtools \\\n    # to support userScript pip installs via git\n    git \\\n    locales \\\n    jq \\\n\n # R separately because it depends on gnupg installed above\n && echo \"deb $CRAN_REPO/bin/linux/debian stretch-cran35/\"       >> /etc/apt/sources.list \\\n && apt-key adv  --no-tty --keyserver keyserver.ubuntu.com \\\n    --recv-key 'E19F5F87128899B192B1A2C2AD5F960A256A04AF' \\\n\n # Uncomment en_US.UTF-8 for inclusion in generation\n && sed -i 's/^# *\\(en_US.UTF-8\\)/\\1/' /etc/locale.gen \\\n # Generate locale\n && locale-gen \\\n\n # google-cloud-sdk separately because it need lsb-release and other prereqs installed above\n && export CLOUD_SDK_REPO=\"cloud-sdk-$(lsb_release -c -s)\" \\\n && echo \"deb http://packages.cloud.google.com/apt $CLOUD_SDK_REPO main\" > /etc/apt/sources.list.d/google-cloud-sdk.list \\\n && curl -f https://packages.cloud.google.com/apt/doc/apt-key.gpg | apt-key add - \\\n && apt-get update \\\n && apt-get install -yq --no-install-recommends \\\n    google-cloud-sdk \\\n && apt-get clean \\\n && rm -rf /var/lib/apt/lists/*\n\nENV LC_ALL en_US.UTF-8\n\n#######################\n# GATK\n#######################\n\nRUN set -e\nENV GATK_VERSION 4.1.0.0\nENV GATK_ZIP_PATH /tmp/gatk-${GATK_VERSION}.zip\n\n #download the gatk zip\nRUN curl -f -L -o $GATK_ZIP_PATH https://github.com/broadinstitute/gatk/releases/download/$GATK_VERSION/gatk-$GATK_VERSION.zip \\\n && unzip -o $GATK_ZIP_PATH -d /etc/ \\\n && ln -s /etc/gatk-$GATK_VERSION/gatk /bin/gatk\n\n##############################\n# Spark / Hadoop / Hive / Hail\n##############################\n\n# Use Spark 2.2.0 which corresponds to Dataproc 1.2. See:\n#   https://cloud.google.com/dataproc/docs/concepts/versioning/dataproc-versions\n# Note: we are actually using Spark 2.2.1, but the Hail package is built using 2.2.0\nENV SPARK_VER 2.2.0\nENV SPARK_HOME=/usr/lib/spark\n\n# result of `gsutil cat gs://hail-common/builds/0.2/latest-hash/cloudtools-3-spark-2.2.0.txt` on 26 March 2019\nENV HAILHASH daed180b84d8\nENV HAILJAR hail-0.2-$HAILHASH-Spark-$SPARK_VER.jar\nENV HAILPYTHON hail-0.2-$HAILHASH.zip\nENV HAIL_HOME /etc/hail\nENV KERNELSPEC_HOME /usr/local/share/jupyter/kernels\n\n# Note Spark and Hadoop are mounted from the outside Dataproc VM.\n# Make empty conf dirs for the update-alternatives commands.\nRUN mkdir -p /etc/spark/conf.dist && mkdir -p /etc/hadoop/conf.empty && mkdir -p /etc/hive/conf.dist \\\n && update-alternatives --install /etc/spark/conf spark-conf /etc/spark/conf.dist 100 \\\n && update-alternatives --install /etc/hadoop/conf hadoop-conf /etc/hadoop/conf.empty 100 \\\n && update-alternatives --install /etc/hive/conf hive-conf /etc/hive/conf.dist 100 \\\n && mkdir $HAIL_HOME && cd $HAIL_HOME \\\n && wget -nv https://storage.googleapis.com/hail-common/builds/0.2/jars/$HAILJAR \\\n && wget -nv https://storage.googleapis.com/hail-common/builds/0.2/python/$HAILPYTHON \\\n && cd -\n\n#######################\n# Python / Jupyter\n#######################\n\nENV USER jupyter-user\nENV UID 1000\nENV HOME /home/$USER\n\n# ensure this matches c.NotebookApp.port in jupyter_notebook_config.py\nENV JUPYTER_PORT 8000\nENV JUPYTER_HOME /etc/jupyter\nENV PYSPARK_DRIVER_PYTHON jupyter\nENV PYSPARK_DRIVER_PYTHON_OPTS notebook\n\nENV PATH $SPARK_HOME:$SPARK_HOME/python:$SPARK_HOME/bin:$HAIL_HOME:$PATH\nENV PYTHONPATH $PYTHONPATH:$HAIL_HOME/$HAILPYTHON:$HAIL_HOME/python:$SPARK_HOME/python:$JUPYTER_HOME/custom\n\nRUN apt-get update \\\n && apt-get install -yq --no-install-recommends \\\n    python\\\n    python-dev \\\n    liblzo2-dev \\\n    python-tk \\\n    liblzo2-dev \\\n    libz-dev \\\n\n # NOTE! not sure why, but this must run before pip installation\n && useradd -m -s /bin/bash -N -u $UID $USER \\\n # jessie's default pip doesn't work well with jupyter\n && wget -nv https://bootstrap.pypa.io/get-pip.py \\\n && python get-pip.py \\\n && pip install --no-cache-dir ipykernel==4.10.0 \\\n && python2 -m ipykernel install --name python2 --display-name \"Python 2\" \\\n # Hail requires decorator\n && pip install --no-cache-dir -U decorator==4.3.0 \\\n && pip install --no-cache-dir numpy==1.15.2 \\\n && pip install --no-cache-dir py4j==0.10.7 \\\n && python -mpip install matplotlib==2.2.3 \\\n && pip install --no-cache-dir pandas==0.23.4 \\\n && pip install --no-cache-dir seaborn==0.9.0 \\\n && pip install --no-cache-dir google-api-core==1.5.0 \\\n && pip install --no-cache-dir google-cloud-bigquery==1.7.0 \\\n && pip install --no-cache-dir google-cloud-bigquery-datatransfer==0.1.1 \\\n && pip install --no-cache-dir google-cloud-core==0.28.1 \\\n && pip install --no-cache-dir google-cloud-datastore==1.7.0 \\\n && pip install --no-cache-dir google-cloud-resource-manager==0.28.1 \\\n && pip install --no-cache-dir google-cloud-storage==1.13.0 \\\n && pip install --no-cache-dir google-auth==1.5.1 \\\n && pip install --no-cache-dir --ignore-installed firecloud==0.16.18 \\\n && pip install --no-cache-dir -U scikit-learn==0.20.0 \\\n && pip install --no-cache-dir statsmodels==0.9.0 \\\n && pip install --no-cache-dir ggplot==0.11.5 \\\n # fixed current ggplot issue where it imports Timestamp from pandas.lib (deprecated) instead of pandas\n && sed -i 's/pandas.lib/pandas/g' /usr/local/lib/python2.7/dist-packages/ggplot/stats/smoothers.py \\\n && pip install --no-cache-dir bokeh==1.0.0 \\\n && pip install --no-cache-dir pyfasta==0.5.2 \\\n && pip install --no-cache-dir pdoc==0.3.2 \\\n && pip install --no-cache-dir biopython==1.72 \\\n && pip install --no-cache-dir bx-python==0.8.2 \\\n && pip install --no-cache-dir fastinterval==0.1.1 \\\n && pip install --no-cache-dir matplotlib-venn==0.11.5 \\\n && apt-get clean \\\n && rm -rf /var/lib/apt/lists/*\n\n# Python 3 Kernel\nENV PYTHON_VERSION 3.6.8\n\n# lifted from https://github.com/docker-library/python/blob/dd36c08c1f94083476a8579b8bf20c4cd46c6400/3.6/stretch/Dockerfile\nRUN set -ex \\\n \\\n && wget -O python.tar.xz \"https://www.python.org/ftp/python/${PYTHON_VERSION%%[a-z]*}/Python-$PYTHON_VERSION.tar.xz\" \\\n && wget -O python.tar.xz.asc \"https://www.python.org/ftp/python/${PYTHON_VERSION%%[a-z]*}/Python-$PYTHON_VERSION.tar.xz.asc\" \\\n && export GNUPGHOME=\"$(mktemp -d)\" \\\n && gpg --batch --keyserver keyserver.ubuntu.com --recv-keys \"0D96DF4D4110E5C43FBFB17F2D347EA6AA65421D\" \\\n && gpg --batch --verify python.tar.xz.asc python.tar.xz \\\n && { command -v gpgconf > /dev/null && gpgconf --kill all || :; } \\\n && rm -rf \"$GNUPGHOME\" python.tar.xz.asc \\\n && mkdir -p /usr/src/python \\\n && tar -xJC /usr/src/python --strip-components=1 -f python.tar.xz \\\n && rm python.tar.xz \\\n \\\n && cd /usr/src/python \\\n && gnuArch=\"$(dpkg-architecture --query DEB_BUILD_GNU_TYPE)\" \\\n && ./configure \\\n    --build=\"$gnuArch\" \\\n    --enable-loadable-sqlite-extensions \\\n    --enable-shared \\\n    --with-system-expat \\\n    --with-system-ffi \\\n    --without-ensurepip \\\n && make -j \"$(nproc)\" \\\n && make install \\\n && ldconfig \\\n \\\n && find /usr/local -depth \\\n    \\( \\\n        \\( -type d -a \\( -name test -o -name tests \\) \\) \\\n        -o \\\n        \\( -type f -a \\( -name '*.pyc' -o -name '*.pyo' \\) \\) \\\n    \\) -exec rm -rf '{}' + \\\n && rm -rf /usr/src/python \\\n \\\n && python3 --version\n\n# make some useful symlinks that are expected to exist\nRUN cd /usr/local/bin \\\n   && ln -s idle3 idle \\\n   && ln -s pydoc3 pydoc \\\n   && ln -s python3 python \\\n   && ln -s python3-config python-config\n\n# if this is called \"PIP_VERSION\", pip explodes with \"ValueError: invalid truth value '<VERSION>'\"\nENV PYTHON_PIP_VERSION 19.0.1\n\nRUN set -ex; \\\n    \\\n    wget -O get-pip.py 'https://bootstrap.pypa.io/get-pip.py'; \\\n   \\\n    python get-pip.py \\\n        --disable-pip-version-check \\\n        --no-cache-dir \\\n        \"pip==$PYTHON_PIP_VERSION\" \\\n    ; \\\n    pip --version; \\\n    \\\n    find /usr/local -depth \\\n        \\( \\\n            \\( -type d -a \\( -name test -o -name tests \\) \\) \\\n            -o \\\n            \\( -type f -a \\( -name '*.pyc' -o -name '*.pyo' \\) \\) \\\n        \\) -exec rm -rf '{}' +; \\\n    rm -f get-pip.py\n\nRUN apt-get update \\\n && apt-get install -t testing -yq --no-install-recommends \\\n    # for jupyterlab extensions\n    nodejs \\\n    npm \\\n && pip3 install --no-cache-dir tornado==4.5.3 \\\n# # Hail requires decorator\n && pip3 install --no-cache-dir -U decorator==4.3.0 \\\n && pip3 install --no-cache-dir parsimonious==0.8.1 \\\n# # python 3 packages\n && pip3 install --no-cache-dir numpy==1.15.2 \\\n && pip3 install --no-cache-dir py4j==0.10.7 \\\n && python3 -mpip install matplotlib==3.0.0 \\\n && pip3 install --no-cache-dir pandas==0.23.4 \\\n && pip3 install --no-cache-dir seaborn==0.9.0 \\\n && pip3 install --no-cache-dir jupyter==1.0.0 \\\n && pip3 install --no-cache-dir jupyterlab==0.35.4 \\\n && pip3 install --no-cache-dir python-lzo==1.12 \\\n && pip3 install --no-cache-dir google-api-core==1.5.0 \\\n && pip3 install --no-cache-dir google-cloud-bigquery==1.7.0 \\\n && pip3 install --no-cache-dir google-cloud-bigquery-datatransfer==0.1.1 \\\n && pip3 install --no-cache-dir google-cloud-core==0.28.1 \\\n && pip3 install --no-cache-dir google-cloud-datastore==1.7.0 \\\n && pip3 install --no-cache-dir google-cloud-resource-manager==0.28.1 \\\n && pip3 install --no-cache-dir google-cloud-storage==1.13.0 \\\n && pip3 install --no-cache-dir --ignore-installed firecloud==0.16.18 \\\n && pip3 install --no-cache-dir scikit-learn==0.20.0 \\\n && pip3 install --no-cache-dir statsmodels==0.9.0 \\\n && pip3 install --no-cache-dir ggplot==0.11.5 \\\n # fixed current ggplot issue where it imports Timestamp from pandas.lib (deprecated) instead of pandas\n && sed -i 's/pandas.lib/pandas/g' /usr/local/lib/python3.6/site-packages/ggplot/stats/smoothers.py \\\n && pip3 install --no-cache-dir bokeh==1.0.0 \\\n && pip3 install --no-cache-dir pyfasta==0.5.2 \\\n && pip3 install --no-cache-dir pdoc==0.3.2 \\\n && pip3 install --no-cache-dir biopython==1.72 \\\n && pip3 install --no-cache-dir bx-python==0.8.2 \\\n && pip3 install --no-cache-dir fastinterval==0.1.1 \\\n && pip3 install --no-cache-dir matplotlib-venn==0.11.5 \\\n && pip3 install --no-cache-dir bleach==1.5.0 \\\n && pip3 install --no-cache-dir cycler==0.10.0 \\\n && pip3 install --no-cache-dir enum34==1.1.6 \\\n && pip3 install --no-cache-dir h5py==2.7.1 \\\n && pip3 install --no-cache-dir html5lib==0.9999999 \\\n && pip3 install --no-cache-dir joblib==0.11 \\\n && pip3 install --no-cache-dir keras==2.2.0 \\\n && pip3 install --no-cache-dir markdown==2.6.9 \\\n && pip3 install --no-cache-dir patsy==0.4.1 \\\n && pip3 install --no-cache-dir protobuf==3.7.1 \\\n && pip3 install --no-cache-dir pymc3==3.1 \\\n && pip3 install --no-cache-dir pyparsing==2.2.0 \\\n && pip3 install --no-cache-dir pysam==0.13 \\\n && pip3 install --no-cache-dir python-dateutil==2.6.1 \\\n && pip3 install --no-cache-dir pytz==2017.3 \\\n && pip3 install --no-cache-dir pyvcf==0.6.8 \\\n && pip3 install --no-cache-dir pyyaml==3.12 \\\n && pip3 install --no-cache-dir scipy==1.0.0 \\\n && pip3 install --no-cache-dir six==1.11.0 \\\n && pip3 install --no-cache-dir tensorflow==1.9.0 \\\n && pip3 install --no-cache-dir theano==0.9.0 \\\n && pip3 install --no-cache-dir tqdm==4.19.4 \\\n && pip3 install --no-cache-dir werkzeug==0.12.2 \\\n && pip3 install --no-cache-dir certifi==2016.2.28 \\\n && pip3 install --no-cache-dir intel-openmp==2018.0.0 \\\n && pip3 install --no-cache-dir mkl==2018.0.3 \\\n && pip3 install --no-cache-dir readline==6.2 \\\n && pip3 install --no-cache-dir setuptools==36.4.0 \\\n && pip3 install --no-cache-dir wheel \\\n # for jupyter_localize_extension\n && pip3 install --no-cache-dir python-datauri \\\n && pip3 install --no-cache-dir jupyter_contrib_nbextensions \\\n && pip3 install --no-cache-dir jupyter_nbextensions_configurator \\\n && pip3 install --no-cache-dir /etc/gatk-$GATK_VERSION/gatkPythonPackageArchive.zip \\\n && pip3 install --no-cache-dir cookiecutter \\\n && apt-get clean \\\n && rm -rf /var/lib/apt/lists/*\n\n# make pip install to a user directory, instead of a system directory which requires root.\n# this is useful so `pip install` commands can be run in the context of a notebook.\nENV PIP_USER=true\n\n#######################\n# R Kernel\n#######################\n\n# using aptitude for R packages so that all dependencies are automatically installed\nRUN aptitude update && aptitude install -y apt-utils \\\n && aptitude update && aptitude -t stretch-cran35 install -y \\\n    r-base=3.5.2-1 \\\n    r-base-dev=3.5.2-1 \\\n    r-base-core=3.5.2-1 \\\n    r-recommended=3.5.2-1 \\\n && aptitude install -t stretch-cran35 -y \\\n    fonts-dejavu \\\n    tzdata \\\n    gfortran \\\n    gcc \\\n    libcurl4 \\\n    libcurl4-openssl-dev \\\n    libssl-dev \\\n    libxml2-dev \\\n && aptitude clean \\\n && rm -rf /var/lib/apt/lists/* \\\n # fixes broken gfortan dependency needed by some R libraries\n # see: https://github.com/DataBiosphere/leonardo/issues/710\n && ln -s /usr/lib/x86_64-linux-gnu/libgfortran.so.3 /usr/lib/x86_64-linux-gnu/libgfortran.so\n\nRUN R -e 'install.packages(c( \\\n    \"IRdisplay\",  \\\n    \"evaluate\",  \\\n    \"pbdZMQ\",  \\\n    \"devtools\",  \\\n    \"uuid\",  \\\n    \"reshape2\",  \\\n    \"bigrquery\",  \\\n    \"googleCloudStorageR\", \\\n    \"tidyverse\"), \\\n    repos=\"http://cran.mtu.edu\")' \\\n && R -e 'devtools::install_github(\"DataBiosphere/Ronaldo\")' \\\n && R -e 'devtools::install_github(\"IRkernel/IRkernel\")' \\\n && R -e 'IRkernel::installspec(user=FALSE)' \\\n && chown -R $USER:users /home/jupyter-user/.local  \\\n && R -e 'devtools::install_github(\"apache/spark@v2.2.3\", subdir=\"R/pkg\")' \\\n && mkdir -p /home/jupyter-user/.rpackages \\\n && echo \"R_LIBS=/home/jupyter-user/.rpackages\" > /home/jupyter-user/.Renviron \\\n && chown -R $USER:users /home/jupyter-user/.rpackages\n\n#######################\n# Utilities\n#######################\n\nADD scripts $JUPYTER_HOME/scripts\nADD custom/jupyter_delocalize.py $JUPYTER_HOME/custom/\nADD custom/jupyter_localize_extension.py $JUPYTER_HOME/custom/\n\nRUN chown -R $USER:users $JUPYTER_HOME \\\n && find $JUPYTER_HOME/scripts -name '*.sh' -type f | xargs chmod +x \\\n && chown -R $USER:users /usr/local/share/jupyter/lab \\\n && update-alternatives --install /usr/bin/gcc gcc /usr/bin/gcc-6 200 \\\n && update-alternatives --install /usr/bin/gcc gcc /usr/bin/gcc-8 100\n\nUSER $USER\nWORKDIR $HOME\n\nEXPOSE $JUPYTER_PORT\n\n# Note: this entrypoint is provided for running Jupyter independently of Leonardo.\n# When Leonardo deploys this image onto a cluster, the entrypoint is overwritten to enable\n# additional setup inside the container before execution.  Jupyter execution occurs when the\n# init-actions.sh script uses 'docker exec' to call run-jupyter.sh.\nENTRYPOINT [\"/usr/local/bin/jupyter\", \"notebook\"]\n"
}