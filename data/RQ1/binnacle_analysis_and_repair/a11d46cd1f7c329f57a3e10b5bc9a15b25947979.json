{
  "startTime": 1674243957018,
  "endTime": 1674243957334,
  "originalSmells": [
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 27,
        "lineEnd": 27,
        "columnStart": 4,
        "columnEnd": 38
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "FROM ubuntu:18.04\n\nARG PUPPET_AGENT_VERSION=\"5.5.7\"\nENV R10K_VERSION=\"2.6.4\" \\\n    DUMB_INIT_VERSION=\"1.2.2\" \\\n    UBUNTU_CODENAME=\"bionic\" \\\n    PUPPET_MODULE_CHORIA_VERSION=\"0.12.0\" \\\n    PUPPET_MODULE_R10K_VERSION=\"6.8.0\" \\\n    GWS_VERSION=\"0.2.0\" \\\n    PATH=/opt/puppetlabs/server/bin:/opt/puppetlabs/puppet/bin:/opt/puppetlabs/bin:$PATH\n\nLABEL org.label-schema.vendor=\"VSHN AG\" \\\n      org.label-schema.url=\"https://github.com/vshn/puppet-in-docker\" \\\n      org.label-schema.name=\"Puppet r10k\" \\\n      org.label-schema.license=\"BSD-3-Clause\" \\\n      org.label-schema.version=$PUPPET_SERVER_VERSION \\\n      org.label-schema.vcs-url=\"https://github.com/vshn/puppet-in-docker\" \\\n      org.label-schema.schema-version=\"1.0\" \\\n      com.puppet.dockerfile=\"/Dockerfile\"\n\nENTRYPOINT [\"dumb-init\", \"/docker-entrypoint.sh\"]\nCMD [\"r10k\" ]\n\nCOPY Dockerfile /\n\n# TODO checksum check\nRUN apt-get update && \\\n    apt-get install --no-install-recommends -y wget git netcat && \\\n    wget https://apt.puppetlabs.com/puppet5-release-\"${UBUNTU_CODENAME}\".deb && \\\n    wget https://github.com/Yelp/dumb-init/releases/download/v\"$DUMB_INIT_VERSION\"/dumb-init_\"${DUMB_INIT_VERSION}\"_amd64.deb && \\\n    wget https://github.com/StreakyCobra/gws/releases/download/\"${GWS_VERSION}\"/gws-\"${GWS_VERSION}\" -O /usr/local/bin/gws && \\\n    chmod +x /usr/local/bin/gws && \\\n    dpkg -i puppet5-release-\"${UBUNTU_CODENAME}\".deb && \\\n    dpkg -i dumb-init_\"${DUMB_INIT_VERSION}\"_amd64.deb && \\\n    rm puppet5-release-\"${UBUNTU_CODENAME}\".deb dumb-init_\"${DUMB_INIT_VERSION}\"_amd64.deb && \\\n    apt-get update && \\\n    apt-get install --no-install-recommends -y puppet-agent=\"${PUPPET_AGENT_VERSION}\"-1\"${UBUNTU_CODENAME}\" && \\\n    gem install r10k --version \"${R10K_VERSION}\" --no-ri --no-rdoc && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n\n# Install and configure MCollective using Choria from R.I.Pienaar\n# Install r10k\nRUN puppet module install choria-mcollective_choria --version \"${PUPPET_MODULE_CHORIA_VERSION}\" --target-dir /tmp/modules && \\\n    puppet module install puppet-r10k --version \"${PUPPET_MODULE_R10K_VERSION}\" --target-dir /tmp/modules\nCOPY build/hiera.yaml build/common.yaml build/main.pp /tmp/\nRUN apt-get update && puppet apply --hiera_config=/tmp/hiera.yaml --modulepath=/tmp/modules /tmp/main.pp && \\\n    apt-get clean && rm -rf /var/lib/apt/lists/*\n\n# Configure .ssh directory\nRUN mkdir /root/.ssh \\\n  && chmod 0600 /root/.ssh \\\n  && echo StrictHostKeyChecking no > /root/.ssh/config\n\n# Add configuration file into the image\nCOPY r10k.yaml /etc/puppetlabs/r10k/r10k.yaml\nCOPY request-cert.rb /usr/local/bin\nCOPY agent/git.ddl agent/git.rb /opt/puppetlabs/mcollective/plugins/mcollective/agent/\nCOPY agent/r10kcli.ddl agent/r10kcli.rb /opt/puppetlabs/mcollective/plugins/mcollective/agent/\n\n# Copy entrypoint into container\nCOPY docker-entrypoint.sh /\nCOPY /docker-entrypoint.d/* /docker-entrypoint.d/\n"
}