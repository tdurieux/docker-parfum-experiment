{
  "startTime": 1674242808021,
  "endTime": 1674242808182,
  "originalSmells": [
    {
      "rule": "wgetUseHttpsUrl",
      "position": {
        "lineStart": 30,
        "lineEnd": 30,
        "columnStart": 4,
        "columnEnd": 85
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "ARG FROMLIBERTY\nFROM maven:3.5.2-jdk-8-alpine AS builder\nARG ODMDOCKERDIR\nENV ODMDOCKERDIR $ODMDOCKERDIR\nENV SCRIPT /script\nENV APPS /config/apps\nENV THIRDPARTY /thirdpartylib\nRUN apk add --no-cache ca-certificates wget\n\nCOPY ${ODMDOCKERDIR}/decisioncenter/script $SCRIPT\nCOPY ${ODMDOCKERDIR}/standalone/script $SCRIPT\nCOPY ${ODMDOCKERDIR}/common/script $SCRIPT\nCOPY ${ODMDOCKERDIR}/common/features $SCRIPT\nCOPY ./executionserver/ /executionserver\n\n# Loan Server Sample presence flag\nRUN if [ -d /executionserver/samples/rulesetexecution/loan-server ]; then touch /use_loan_server; fi   \n\n# Welcome page\nCOPY $ODMDOCKERDIR/welcomepage /welcomepage\n\nRUN if [ -f /use_loan_server ]; then \\\n    sed -i  's/ loan-server-hidden//g' /welcomepage/src/main/webapp/index.jsp; fi\n\nRUN cd /welcomepage; mvn clean install  | grep -v 'Download.*'\nRUN mkdir -p /config/dbdata /config/resources && chmod -R 777 /config/dbdata /config/resources\n#COPY ${ODMDOCKERDIR}/decisioncenter/config/application.xml /config/decisionrunner_application.xml\n\n# Begin - Configuration for the database\n# Install the driver for H2 and for PostgreSQL\nRUN wget -nv https://central.maven.org/maven2/com/h2database/h2/1.4.196/h2-1.4.196.jar && mv h2* /config/resources && \\\n    wget -nv https://jdbc.postgresql.org/download/postgresql-42.2.1.jar && mv postgres* /config/resources\n# End - Configuration for the database\n\nRUN chmod -R a+x $SCRIPT && mkdir $APPS\n\n# Sample\nCOPY ${ODMDOCKERDIR}/standalone/samples/ /samples/build/\n\nRUN if [ -f /use_loan_server ]; then \\\n    sed -i  's/localhost:9090/localhost:9060/g' /executionserver/samples/rulesetexecution/loan-server/src/main/webapp/index.html && \\\n    cd /samples/build; mvn -Dxom.path=/samples/build/loan-validation-xom -Dloan.validation.server.path=/executionserver/samples/rulesetexecution/loan-server  clean package   | grep -v 'Download.*' && \\\n    cp /samples/build/loan-server/target/odm-loan-server-1.0.war $APPS && \\\n    $SCRIPT/extractApp.sh odm-loan-server-1.0.war; fi\n\n# Decision Center\nCOPY ./teamserver/applicationservers/WLP*/teamserver.war $APPS\nCOPY ./teamserver/applicationservers/WLP*/decision*.war $APPS/\n\nRUN $SCRIPT/extractApp.sh decisioncenter.war && \\\n    $SCRIPT/extractApp.sh decisionmodel.war && \\\n    $SCRIPT/extractApp.sh teamserver.war && \\\n    $SCRIPT/extractApp.sh decisioncenter-api.war && \\\n    mkdir -p $APPS/decisioncenter.war/WEB-INF/classes/config\n\nRUN $SCRIPT/changeParamValue.sh com.ibm.rules.decisioncenter.setup.configuration-file \\.\\\\/config\\\\/decisioncenter-configuration.properties \\\\/config\\\\/decisioncenter-configuration.properties $APPS/decisioncenter.war/WEB-INF/web.xml\n\nCOPY ${ODMDOCKERDIR}/standalone/config/group-security-configurations.xml $APPS/decisioncenter.war/WEB-INF/classes/config/group-security-configurations.xml\n\n# Decision Server Console\nCOPY ./executionserver/applicationservers/WLP*/res.war $APPS\nRUN $SCRIPT/extractApp.sh res.war\nRUN $SCRIPT/changeParamValue.sh autoCreateSchema false true $APPS/res.war/WEB-INF/web.xml\n\n# Decision Server Runtime\nCOPY ./executionserver/applicationservers/WLP*/DecisionService.war $APPS\nRUN $SCRIPT/extractApp.sh DecisionService.war\n\n# Decision Runner\nCOPY ./executionserver/applicationservers/WLP*/DecisionRunner.war $APPS\nRUN $SCRIPT/extractApp.sh DecisionRunner.war\nRUN $SCRIPT/changeParamValue.sh ForceDatabaseTableCreation false true $APPS/DecisionRunner.war/WEB-INF/web.xml\n# Sample DB\nADD ${ODMDOCKERDIR}/standalone/data-8.10.tar.gz /db810/\nADD ${ODMDOCKERDIR}/standalone/data-8.9.tar.gz /upload\n# Default DB Version is 8.9 Since 8.10 there is a new DB sample with additional features.\nRUN $SCRIPT/loadFeatures.sh $SCRIPT && \\\nchmod -R 777 $APPS && \\\nchmod -R 777 /upload /db810 /config/dbdata\n\n\n\nFROM ${FROMLIBERTY}\nARG ODMDOCKERDIR\nARG ODMVERSION\nARG ODMDBVERSION\nLABEL maintainer=\"ODMDev odmdev_open_source_user@wwpdl.vnet.ibm.com\"\nMAINTAINER \"Laurent GRATEAU <laurent.grateau@fr.ibm.com>, ODMDev odmdev_open_source_user@wwpdl.vnet.ibm.com\"\n\nENV ODMDOCKERDIR $ODMDOCKERDIR\nENV APP_NAME StandaloneOdm\nENV SCRIPT /script\nENV APPS /config/apps\n\nCOPY --chown=1001:0 $ODMDOCKERDIR/standalone/licenses $APPS/licenses\nCOPY --chown=1001:0 ${ODMDOCKERDIR}/decisioncenter/config/application-*.xml /config/\nCOPY --chown=1001:0 ${ODMDOCKERDIR}/decisionserver/decisionrunner/config/application.xml /config/decisionrunner_application.xml\nCOPY --chown=1001:0 ${ODMDOCKERDIR}/decisionserver/decisionserverconsole/config/application.xml /config/decisionserverconsole_application.xml\nCOPY --chown=1001:0 ${ODMDOCKERDIR}/common/security/ltpa.keys /config/resources/security/ltpa.keys\nCOPY --chown=1001:0 ${ODMDOCKERDIR}/common/security/keystore.jks /config/security/keystore.jks\nCOPY --chown=1001:0 ${ODMDOCKERDIR}/common/security/truststore.jks /config/security/truststore.jks\nCOPY --chown=1001:0 ${ODMDOCKERDIR}/standalone/config /config\n\nCOPY --from=builder --chown=1001:0 /config/dbdata /config\nENV CONNECTION_POOL_SIZE 20\n\n# Sample DB\nCOPY --from=builder --chown=1001:0 /upload/* /upload/\n\n# Welcome page\nCOPY --from=builder --chown=1001:0 /welcomepage/target/welcomepage.war $APPS\nCOPY --from=builder --chown=1001:0 /config/resources/postgres*  /config/resources\nCOPY --from=builder --chown=1001:0 /config/resources/h2*  /config/resources\nCOPY --from=builder --chown=1001:0 $APPS $APPS\nCOPY --from=builder --chown=1001:0 $SCRIPT $SCRIPT\n# VOLUME [\"/config/dbdata/\"]\nEXPOSE 9060 9453\n\nENTRYPOINT [\"/script/runserver.sh\"]\nCMD [\"/script/runserver.sh\"]\n"
}