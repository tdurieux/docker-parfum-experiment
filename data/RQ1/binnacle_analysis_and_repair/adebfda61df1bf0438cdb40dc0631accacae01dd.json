{
  "startTime": 1674235547414,
  "endTime": 1674235547705,
  "originalSmells": [
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 41,
        "lineEnd": 41,
        "columnStart": 0,
        "columnEnd": 46
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "FROM phusion/baseimage:0.9.16\nMAINTAINER sparklyballs <sparkly@madeupemail.com>\n\n# Set correct environment variables\nENV DEBIAN_FRONTEND=noninteractive HOME=\"/root\" TERM=xterm LANG=en_US.UTF-8 LANGUAGE=en_US:en LC_ALL=en_US.UTF-8\n\n# set ports\nEXPOSE 6080 3389\n\n# Use baseimage-docker's init system\nCMD [\"/sbin/my_init\"]\n\n# Add required files that are local\nADD src/ /root/\n\n# set config volume\nVOLUME /config\n\n# Set the locale\nRUN locale-gen en_US.UTF-8 && \\\n\n# Configure user nobody to match unRAID's settings\nusermod -u 99 nobody && \\\nusermod -g 100 nobody && \\\nusermod -m -d /nobody nobody && \\\nusermod -s /bin/bash nobody && \\\nusermod -a -G adm,sudo nobody && \\\necho \"nobody:PASSWD\" | chpasswd && \\\n\n# update apt and install dependencies\ncp /etc/apt/sources.list /root/sources.list && \\\necho 'deb mirror://mirrors.ubuntu.com/mirrors.txt trusty  main universe restricted' >> /root/sources.list && \\\necho 'deb mirror://mirrors.ubuntu.com/mirrors.txt trusty-updates main universe restricted' >> /root/sources.list && \\\necho 'deb mirror://mirrors.ubuntu.com/mirrors.txt utopic main universe restricted' >> /etc/apt/sources.list && \\\necho 'deb mirror://mirrors.ubuntu.com/mirrors.txt utopic-updates main universe restricted' >> /etc/apt/sources.list && \\\napt-get update -qq && \\\napt-get install -qy --no-install-recommends x11vnc && \\\nmv /root/sources.list /etc/apt/sources.list && \\\napt-get clean && \\\napt-get update -qq && \\\napt-get install -qy --force-yes --no-install-recommends xvfb openjdk-7-jre wget openbox unzip python2.7 && \\\n apt-get install --no-install-recommends -qy --force-yes xrdp xdg-utils && \\\nln -s /usr/bin/python2.7 /usr/bin/python && \\\n\n# user folders etc.....\nmkdir /nobody && \\\nmkdir -p /nobody/.config/openbox && \\\nmkdir /nobody/.cache && \\\nmkdir /root/.vnc && \\\n\n# install calibre\nwget -nv -O- https://raw.githubusercontent.com/kovidgoyal/calibre/master/setup/linux-installer.py | python -c \"import sys; main=lambda x,y:sys.stderr.write('Download failed\\n'); exec(sys.stdin.read()); main('/nobody/calibre-bin', True)\" && \\\n\n# move startup files and config for xrdp\nmv /root/xrdp.ini /etc/xrdp/xrdp.ini && \\\nmkdir -p /etc/service/Xvfb && \\\nmv /root/Xvfb /etc/service/Xvfb/run && \\\nmkdir -p /etc/service/x11vnc && \\\nmv /root/x11vnc /etc/service/x11vnc/run && \\\nmkdir -p /etc/service/noVNC && \\\nmv /root/noVNC.sh /etc/service/noVNC/run && \\\nmkdir -p /etc/service/xrdp && \\\nmv /root/xrdp /etc/service/xrdp/run && \\\nmkdir -p /etc/service/xrdp-sesman && \\\nmv /root/xrdp-sesman /etc/service/xrdp-sesman/run && \\\nchmod -R +x /etc/service/ /etc/my_init.d/ && \\\nmv /root/autostart /nobody/.config/openbox/autostart && \\\nmv /root/rc.xml /nobody/.config/openbox && \\\n\n# install noVNC\nmv /root/noVNC /noVNC && \\\n\n# set permissions for home folder \nchown -R nobody:users /nobody && \\\n\n# clean up\napt-get clean && \\\nrm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/* \\\n/usr/share/man /usr/share/groff /usr/share/info \\\n/usr/share/lintian /usr/share/linda /var/cache/man && \\\n(( find /usr/share/doc -depth -type f ! -name copyright|xargs rm || true )) && \\\n(( find /usr/share/doc -empty|xargs rmdir || true ))\n\n\n\n"
}