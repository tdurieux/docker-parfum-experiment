{
  "startTime": 1674243955951,
  "endTime": 1674243956477,
  "originalSmells": [
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 16,
        "lineEnd": 16,
        "columnStart": 4,
        "columnEnd": 32
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 18,
        "lineEnd": 18,
        "columnStart": 4,
        "columnEnd": 32
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 20,
        "lineEnd": 20,
        "columnStart": 4,
        "columnEnd": 35
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 22,
        "lineEnd": 22,
        "columnStart": 4,
        "columnEnd": 32
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 24,
        "lineEnd": 24,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 25,
        "lineEnd": 25,
        "columnStart": 4,
        "columnEnd": 29
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 26,
        "lineEnd": 26,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 27,
        "lineEnd": 27,
        "columnStart": 4,
        "columnEnd": 42
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 29,
        "lineEnd": 29,
        "columnStart": 4,
        "columnEnd": 49
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 34,
        "lineEnd": 34,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 37,
        "lineEnd": 37,
        "columnStart": 4,
        "columnEnd": 35
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 52,
        "lineEnd": 52,
        "columnStart": 4,
        "columnEnd": 29
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 55,
        "lineEnd": 55,
        "columnStart": 4,
        "columnEnd": 127
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 122,
        "lineEnd": 122,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 130,
        "lineEnd": 130,
        "columnStart": 4,
        "columnEnd": 40
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 142,
        "lineEnd": 142,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 16,
        "lineEnd": 16,
        "columnStart": 4,
        "columnEnd": 32
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 18,
        "lineEnd": 18,
        "columnStart": 4,
        "columnEnd": 32
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 20,
        "lineEnd": 20,
        "columnStart": 4,
        "columnEnd": 35
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 22,
        "lineEnd": 22,
        "columnStart": 4,
        "columnEnd": 32
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 24,
        "lineEnd": 24,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 25,
        "lineEnd": 25,
        "columnStart": 4,
        "columnEnd": 29
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 26,
        "lineEnd": 26,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 27,
        "lineEnd": 27,
        "columnStart": 4,
        "columnEnd": 42
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 29,
        "lineEnd": 29,
        "columnStart": 4,
        "columnEnd": 49
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 34,
        "lineEnd": 34,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 37,
        "lineEnd": 37,
        "columnStart": 4,
        "columnEnd": 35
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 52,
        "lineEnd": 52,
        "columnStart": 4,
        "columnEnd": 29
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 55,
        "lineEnd": 55,
        "columnStart": 4,
        "columnEnd": 127
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 122,
        "lineEnd": 122,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 130,
        "lineEnd": 130,
        "columnStart": 4,
        "columnEnd": 40
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 142,
        "lineEnd": 142,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 16,
        "lineEnd": 16,
        "columnStart": 4,
        "columnEnd": 32
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 18,
        "lineEnd": 18,
        "columnStart": 4,
        "columnEnd": 32
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 20,
        "lineEnd": 20,
        "columnStart": 4,
        "columnEnd": 35
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 22,
        "lineEnd": 22,
        "columnStart": 4,
        "columnEnd": 32
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 24,
        "lineEnd": 24,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 25,
        "lineEnd": 25,
        "columnStart": 4,
        "columnEnd": 29
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 26,
        "lineEnd": 26,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 27,
        "lineEnd": 27,
        "columnStart": 4,
        "columnEnd": 42
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 29,
        "lineEnd": 29,
        "columnStart": 4,
        "columnEnd": 49
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 34,
        "lineEnd": 34,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 37,
        "lineEnd": 37,
        "columnStart": 4,
        "columnEnd": 35
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 52,
        "lineEnd": 52,
        "columnStart": 4,
        "columnEnd": 29
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 55,
        "lineEnd": 55,
        "columnStart": 4,
        "columnEnd": 127
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 122,
        "lineEnd": 122,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 130,
        "lineEnd": 130,
        "columnStart": 4,
        "columnEnd": 40
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 142,
        "lineEnd": 142,
        "columnStart": 4,
        "columnEnd": 27
      }
    }
  ],
  "repairedSmells": [
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 16,
        "lineEnd": 16,
        "columnStart": 4,
        "columnEnd": 56
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 18,
        "lineEnd": 18,
        "columnStart": 4,
        "columnEnd": 56
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 20,
        "lineEnd": 20,
        "columnStart": 4,
        "columnEnd": 59
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 22,
        "lineEnd": 22,
        "columnStart": 4,
        "columnEnd": 56
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 24,
        "lineEnd": 24,
        "columnStart": 4,
        "columnEnd": 51
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 25,
        "lineEnd": 25,
        "columnStart": 4,
        "columnEnd": 53
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 26,
        "lineEnd": 26,
        "columnStart": 4,
        "columnEnd": 51
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 27,
        "lineEnd": 27,
        "columnStart": 4,
        "columnEnd": 66
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 29,
        "lineEnd": 29,
        "columnStart": 4,
        "columnEnd": 73
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 34,
        "lineEnd": 34,
        "columnStart": 4,
        "columnEnd": 51
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 37,
        "lineEnd": 37,
        "columnStart": 4,
        "columnEnd": 59
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 52,
        "lineEnd": 52,
        "columnStart": 4,
        "columnEnd": 53
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 55,
        "lineEnd": 55,
        "columnStart": 4,
        "columnEnd": 151
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 122,
        "lineEnd": 122,
        "columnStart": 4,
        "columnEnd": 51
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 130,
        "lineEnd": 130,
        "columnStart": 4,
        "columnEnd": 64
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 142,
        "lineEnd": 142,
        "columnStart": 4,
        "columnEnd": 51
      }
    }
  ],
  "repairedDockerfile": "#https://medium.com/@meeramarygeorge/create-php-mysql-apache-development-environment-using-docker-in-windows-9beeba6985\n#https://www.digitalocean.com/community/tutorials/how-to-secure-apache-with-let-s-encrypt-on-ubuntu-18-04\n#https://loige.co/using-lets-encrypt-and-certbot-to-automate-the-creation-of-certificates-for-openvpn/\n#FROM ubuntu:latest\nFROM ubuntu:18.04\n\nMAINTAINER Name<admin@opensource.lk>\n\nENV DEBIAN_FRONTEND noninteractive\nENV DOMAIN=${DOMAIN}\n\n# Install basics\n\n#RUN apt-get update\nRUN apt-get update --fix-missing && apt-get -y purge exim4*\nRUN apt-get -y upgrade\nRUN apt-get -y --no-install-recommends install apt-utils && rm -rf /var/lib/apt/lists/*;\n# installing netstat command\nRUN apt-get -y --no-install-recommends install net-tools && rm -rf /var/lib/apt/lists/*;\n# installing ping command\nRUN apt-get install --no-install-recommends -y iputils-ping && rm -rf /var/lib/apt/lists/*;\n# install mail until for testing functions\nRUN apt-get -y --no-install-recommends install mailutils && rm -rf /var/lib/apt/lists/*;\n# installing lsof command\nRUN apt-get -y --no-install-recommends install lsof && rm -rf /var/lib/apt/lists/*;\nRUN apt-get -y --no-install-recommends install telnet && rm -rf /var/lib/apt/lists/*;\nRUN apt-get -y --no-install-recommends install nano && rm -rf /var/lib/apt/lists/*;\nRUN apt-get -y --no-install-recommends install letsencrypt openssl && rm -rf /var/lib/apt/lists/*;\n\nRUN apt-get install --no-install-recommends -y software-properties-common && \\\n\nadd-apt-repository ppa:ondrej/php && apt-get update && rm -rf /var/lib/apt/lists/*;\n\n#RUN apt-get install -y — force-yes curl\nRUN apt-get install --no-install-recommends -y curl && rm -rf /var/lib/apt/lists/*;\n\n# installing ping command\nRUN apt-get install --no-install-recommends -y iputils-ping && rm -rf /var/lib/apt/lists/*;\n\nRUN apt-get update\n\n# Install PHP 5.6\n\n#RUN apt-get install -y — allow-unauthenticated php5.6 php5.6-mysql php5.6-mcrypt php5.6-cli php5.6-gd php5.6-curl\n#RUN apt-get install -y php5.6 php5.6-mysql php5.6-mcrypt php5.6-cli php5.6-gd php5.6-curl\n\n# Enable apache mods.\n\n# Install php 7.3\n# https://thishosting.rocks/install-php-on-ubuntu/\n\n#RUN apt-get install -y php\nRUN apt-get install --no-install-recommends -y php7.3 && rm -rf /var/lib/apt/lists/*;\n# php version should be save as the php version number\n#RUN apt-get install -y php7.3-mbstring php7.3-ldap php7.3-zip php7.3-xml\nRUN apt-get install --no-install-recommends -y php-pear php7.3-curl php7.3-ldap php7.3-dev php7.3-gd php7.3-mbstring php7.3-zip php7.3-mysql php7.3-xml && rm -rf /var/lib/apt/lists/*;\n\n#RUN a2enmod php5.6\n\nRUN a2enmod rewrite\n\n# Update the PHP.ini file, enable <? ?> tags and quieten logging.\n\n#RUN sed -i \"s/short_open_tag = Off/short_open_tag = On/\" /etc/php/5.6/apache2/php.ini\n\n#RUN sed -i \"s/error_reporting = .*$/error_reporting = E_ERROR | E_WARNING | E_PARSE/\" /etc/php/5.6/apache2/php.ini\n\n\n\n# Manually set up the apache environment variables\n\nENV APACHE_LOG_DIR /var/log/apache2\n\nENV APACHE_LOCK_DIR /var/lock/apache2\n\nENV APACHE_PID_FILE /var/run/apache2.pid\n\n# Manually set up the apache environment variables\nENV APACHE_RUN_USER www-data\n\nENV APACHE_RUN_GROUP www-data\n\n\n\n# Expose to letsencript key generation ACME test\n#EXPOSE 80\n# Expose for non secured access (without https) for testing perposes\n#EXPOSE 89\n# primary https port\nEXPOSE 443\n# secondary https port\nEXPOSE 433\n\n\n\n#EXPOSE 3306\n\n# Update the default apache site with the config we created.\n\n#ADD ./config/apache-config.conf /etc/apache2/sites-enabled/000-default.conf\nADD ./config/hosts /etc/hosts\n\n# Copy site into place.\n\nADD ./app/ /var/www/html/site/\n#RUN  copy cert files\n#ADD ./tls/cert.pem /etc/ssl/certs/copper.opensource.lk.cert.pem\nADD ./tls/cert.pem /etc/ssl/certs/cert.pem\n#ADD ./tls/privkey.pem /etc/ssl/private/copper.opensource.lk.privkey.pem\nADD ./tls/privkey.pem /etc/ssl/private/privkey.pem\n\n#ADD ssl certificate list als\nADD ./tls/copper.opensource.lk.crt /etc/ssl/certs/copper.opensource.lk.crt\nADD ./tls/copper.opensource.lk.key /etc/ssl/private/copper.opensource.lk.key\n\n#RUN chmod -R 777 /var/www/html/site/app\n\n RUN chown -R www-data:www-data /var/www/html/site/\n\n # Update the default apache site with the config we created.\n#ADD ./config/apache-config.conf /etc/apache2/sites-enabled/example.com.conf\n\nRUN apt-get -y --no-install-recommends install nano && rm -rf /var/lib/apt/lists/*;\n\n# Lets encript\n\n# First, add the repository:\nRUN add-apt-repository -y ppa:certbot/certbot 2> /dev/null || true\n\n#Install Certbot's Apache package with apt:\nRUN apt install --no-install-recommends -y python-certbot-apache && rm -rf /var/lib/apt/lists/*;\n\n# reload the configuration\n#RUN systemctl reload apache2\n\n# manual lets encript key generation tool\n#certbot --apache -d example.com -d www.example.com\n#CMD certbot --apache -d copper.opensource.lk -d copper.opensource.lk\n\n\n# with certbot-auto\n#https://www.exratione.com/2016/06/a-simple-setup-and-installation-script-for-lets-encrypt-ssl-certificates/\nRUN apt-get install --no-install-recommends -y wget && rm -rf /var/lib/apt/lists/*;\nRUN wget https://dl.eff.org/certbot-auto\nRUN chmod a+x certbot-auto\nRUN mv certbot-auto /usr/local/bin\nRUN certbot-auto --noninteractive --os-packages-only 2> /dev/null || true\n# Use this command if a webserver is already running with the webroot\n# at /var/www/html.\n#RUN certbot-auto certonly \\\nRUN certbot-auto \\\n  --non-interactive \\\n  --agree-tos \\\n  --text \\\n  --rsa-key-size 4096 \\\n  --email admin@copper.opensource.lk \\\n  --domains copper.opensource.lk \\\n  --webroot-path /var/www/html/site/ \\\n  #--apache \\\n  --apache 2> /dev/null || true\n  #--help plugins \\\n\n\n\n\n\n#RUN cp /etc/letsencrypt/live/copper.opensource.lk/fullchain.pem /etc/ssl/certs/copper.opensource.lk.fullchain.pem\n#RUN cp /etc/letsencrypt/live/copper.opensource.lk/privkey.pem /etc/ssl/private/copper.opensource.lk.privkey.pem\n#RUN cp ./tls/cert.pem /etc/ssl/certs/copper.opensource.lk.cert.pem\n#RUN cp ./tls/privkey.pem /etc/ssl/private/copper.opensource.lk.privkey.pem\n\n# this for copper live server\nADD ./config/copper.http.conf /etc/apache2/sites-enabled/copper.http.conf\nADD ./config/copper.https.conf /etc/apache2/sites-enabled/copper.https.conf\n# coppies port configuration\nADD ./config/ports.conf /etc/apache2/ports.conf\n\n# adding ports.conf file to the image\nADD ./config/ports.conf  /etc/apache2/\n\nRUN certbot renew --dry-run\n# By default start up apache in the foreground, override with /bin/bash for interative.\n#CMD chmod -R 777 /var/www/html/data/\n\n# Attempting to copy to host file to container or change the content\n# adding host file\nADD ./config/hosts /etc/hosts\n# put new entry to the host file\nRUN echo \"127.0.0.1  copper.opensource.lk copper\" >> /etc/hosts\n#RUN sed -i \"s/127.0.0.1 = .*$/127.0.0.1 = copper.opensource.lk/\" /etc/hosts\n\n# enable https in apache\nRUN a2enmod ssl\n\nCOPY ./config/init_sys.sh /bin/\nRUN chmod +x /bin/init_sys.sh\n\n# changing apache start to entrypoint to let kubernetes to start the system\nENTRYPOINT [\"init_sys.sh\"]\n#CMD /usr/sbin/apache2ctl -D FOREGROUND\n\n"
}