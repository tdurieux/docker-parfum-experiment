{
  "startTime": 1674247094303,
  "endTime": 1674247097290,
  "originalSmells": [
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 72,
        "lineEnd": 72,
        "columnStart": 37,
        "columnEnd": 59
      }
    },
    {
      "rule": "tarSomethingRmTheSomething",
      "position": {
        "lineStart": 38,
        "lineEnd": 38,
        "columnStart": 4,
        "columnEnd": 31
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 22,
        "lineEnd": 22,
        "columnStart": 4,
        "columnEnd": 38
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 23,
        "lineEnd": 23,
        "columnStart": 4,
        "columnEnd": 26
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 24,
        "lineEnd": 24,
        "columnStart": 4,
        "columnEnd": 26
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 25,
        "lineEnd": 25,
        "columnStart": 4,
        "columnEnd": 28
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 26,
        "lineEnd": 26,
        "columnStart": 4,
        "columnEnd": 28
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 27,
        "lineEnd": 27,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 28,
        "lineEnd": 28,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 29,
        "lineEnd": 29,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 30,
        "lineEnd": 30,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 31,
        "lineEnd": 31,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 49,
        "lineEnd": 49,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 61,
        "lineEnd": 61,
        "columnStart": 4,
        "columnEnd": 32
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 62,
        "lineEnd": 62,
        "columnStart": 4,
        "columnEnd": 39
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 65,
        "lineEnd": 65,
        "columnStart": 4,
        "columnEnd": 35
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 68,
        "lineEnd": 68,
        "columnStart": 4,
        "columnEnd": 59
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 71,
        "lineEnd": 71,
        "columnStart": 4,
        "columnEnd": 60
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 72,
        "lineEnd": 72,
        "columnStart": 4,
        "columnEnd": 33
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 84,
        "lineEnd": 84,
        "columnStart": 4,
        "columnEnd": 35
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 85,
        "lineEnd": 85,
        "columnStart": 4,
        "columnEnd": 28
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 128,
        "lineEnd": 128,
        "columnStart": 4,
        "columnEnd": 31
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 129,
        "lineEnd": 129,
        "columnStart": 4,
        "columnEnd": 32
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 132,
        "lineEnd": 132,
        "columnStart": 4,
        "columnEnd": 28
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 22,
        "lineEnd": 22,
        "columnStart": 4,
        "columnEnd": 38
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 23,
        "lineEnd": 23,
        "columnStart": 4,
        "columnEnd": 26
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 24,
        "lineEnd": 24,
        "columnStart": 4,
        "columnEnd": 26
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 25,
        "lineEnd": 25,
        "columnStart": 4,
        "columnEnd": 28
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 26,
        "lineEnd": 26,
        "columnStart": 4,
        "columnEnd": 28
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 27,
        "lineEnd": 27,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 28,
        "lineEnd": 28,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 29,
        "lineEnd": 29,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 30,
        "lineEnd": 30,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 31,
        "lineEnd": 31,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 49,
        "lineEnd": 49,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 61,
        "lineEnd": 61,
        "columnStart": 4,
        "columnEnd": 32
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 62,
        "lineEnd": 62,
        "columnStart": 4,
        "columnEnd": 39
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 65,
        "lineEnd": 65,
        "columnStart": 4,
        "columnEnd": 35
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 68,
        "lineEnd": 68,
        "columnStart": 4,
        "columnEnd": 59
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 71,
        "lineEnd": 71,
        "columnStart": 4,
        "columnEnd": 60
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 72,
        "lineEnd": 72,
        "columnStart": 4,
        "columnEnd": 33
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 84,
        "lineEnd": 84,
        "columnStart": 4,
        "columnEnd": 35
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 85,
        "lineEnd": 85,
        "columnStart": 4,
        "columnEnd": 28
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 128,
        "lineEnd": 128,
        "columnStart": 4,
        "columnEnd": 31
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 129,
        "lineEnd": 129,
        "columnStart": 4,
        "columnEnd": 32
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 132,
        "lineEnd": 132,
        "columnStart": 4,
        "columnEnd": 28
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 22,
        "lineEnd": 22,
        "columnStart": 4,
        "columnEnd": 38
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 23,
        "lineEnd": 23,
        "columnStart": 4,
        "columnEnd": 26
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 24,
        "lineEnd": 24,
        "columnStart": 4,
        "columnEnd": 26
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 25,
        "lineEnd": 25,
        "columnStart": 4,
        "columnEnd": 28
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 26,
        "lineEnd": 26,
        "columnStart": 4,
        "columnEnd": 28
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 27,
        "lineEnd": 27,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 28,
        "lineEnd": 28,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 29,
        "lineEnd": 29,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 30,
        "lineEnd": 30,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 31,
        "lineEnd": 31,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 49,
        "lineEnd": 49,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 61,
        "lineEnd": 61,
        "columnStart": 4,
        "columnEnd": 32
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 62,
        "lineEnd": 62,
        "columnStart": 4,
        "columnEnd": 39
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 65,
        "lineEnd": 65,
        "columnStart": 4,
        "columnEnd": 35
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 68,
        "lineEnd": 68,
        "columnStart": 4,
        "columnEnd": 59
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 71,
        "lineEnd": 71,
        "columnStart": 4,
        "columnEnd": 60
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 72,
        "lineEnd": 72,
        "columnStart": 4,
        "columnEnd": 33
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 84,
        "lineEnd": 84,
        "columnStart": 4,
        "columnEnd": 35
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 85,
        "lineEnd": 85,
        "columnStart": 4,
        "columnEnd": 28
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 128,
        "lineEnd": 128,
        "columnStart": 4,
        "columnEnd": 31
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 129,
        "lineEnd": 129,
        "columnStart": 4,
        "columnEnd": 32
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 132,
        "lineEnd": 132,
        "columnStart": 4,
        "columnEnd": 28
      }
    }
  ],
  "repairedSmells": [
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 22,
        "lineEnd": 22,
        "columnStart": 4,
        "columnEnd": 62
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 23,
        "lineEnd": 23,
        "columnStart": 4,
        "columnEnd": 50
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 24,
        "lineEnd": 24,
        "columnStart": 4,
        "columnEnd": 50
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 25,
        "lineEnd": 25,
        "columnStart": 4,
        "columnEnd": 52
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 26,
        "lineEnd": 26,
        "columnStart": 4,
        "columnEnd": 52
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 27,
        "lineEnd": 27,
        "columnStart": 4,
        "columnEnd": 51
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 28,
        "lineEnd": 28,
        "columnStart": 4,
        "columnEnd": 51
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 29,
        "lineEnd": 29,
        "columnStart": 4,
        "columnEnd": 51
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 30,
        "lineEnd": 30,
        "columnStart": 4,
        "columnEnd": 51
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 31,
        "lineEnd": 31,
        "columnStart": 4,
        "columnEnd": 51
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 49,
        "lineEnd": 49,
        "columnStart": 4,
        "columnEnd": 51
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 61,
        "lineEnd": 61,
        "columnStart": 4,
        "columnEnd": 56
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 62,
        "lineEnd": 62,
        "columnStart": 4,
        "columnEnd": 63
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 65,
        "lineEnd": 65,
        "columnStart": 4,
        "columnEnd": 59
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 68,
        "lineEnd": 68,
        "columnStart": 4,
        "columnEnd": 83
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 71,
        "lineEnd": 71,
        "columnStart": 4,
        "columnEnd": 84
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 72,
        "lineEnd": 72,
        "columnStart": 4,
        "columnEnd": 57
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 84,
        "lineEnd": 84,
        "columnStart": 4,
        "columnEnd": 59
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 85,
        "lineEnd": 85,
        "columnStart": 4,
        "columnEnd": 52
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 128,
        "lineEnd": 128,
        "columnStart": 4,
        "columnEnd": 55
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 129,
        "lineEnd": 129,
        "columnStart": 4,
        "columnEnd": 56
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 132,
        "lineEnd": 132,
        "columnStart": 4,
        "columnEnd": 52
      }
    }
  ],
  "repairedDockerfile": "## --------------------------------------------------------------------------------------------\n## ############################################################################################\n## --------------------------------------------------------------------------------------------\n\nFROM ubuntu:trusty\nMAINTAINER Hasan Karahan <hasan.karahan@blackhan.com>\n\n## --------------------------------------------------------------------------------------------\n## Part (a): `notex:nil` ######################################################################\n## --------------------------------------------------------------------------------------------\n\n# ubuntu: updates & upgrades\nRUN apt-get -y update\nRUN apt-get -y upgrade\n\n# locale: `en_US.UTF-8`\nRUN locale-gen en_US.UTF-8\nENV LANG en_US.UTF-8\nENV LANGUAGE en_US.UTF-8\nENV LC_ALL en_US.UTF-8\n\n# basic tools\nRUN apt-get -y --no-install-recommends install build-essential && rm -rf /var/lib/apt/lists/*;\nRUN apt-get -y --no-install-recommends install git && rm -rf /var/lib/apt/lists/*;\nRUN apt-get -y --no-install-recommends install zip && rm -rf /var/lib/apt/lists/*;\nRUN apt-get -y --no-install-recommends install unzip && rm -rf /var/lib/apt/lists/*;\nRUN apt-get -y --no-install-recommends install zlibc && rm -rf /var/lib/apt/lists/*;\nRUN apt-get -y --no-install-recommends install wget && rm -rf /var/lib/apt/lists/*;\nRUN apt-get -y --no-install-recommends install curl && rm -rf /var/lib/apt/lists/*;\nRUN apt-get -y --no-install-recommends install nano && rm -rf /var/lib/apt/lists/*;\nRUN apt-get -y --no-install-recommends install sudo && rm -rf /var/lib/apt/lists/*;\nRUN apt-get -y --no-install-recommends install tree && rm -rf /var/lib/apt/lists/*;\n\nRUN git config --global user.name \"NoTex.ch\"\nRUN git config --global user.email \"contact@blackhan.com\"\n\n# java: 7u55\nRUN wget -O jdk-7u55-linux-x64.tar.gz https://db.tt/d8AltmDK\nRUN tar -xvf *-linux-x64.tar.gz && mkdir -p /usr/lib/jvm && rm *-linux-x64.tar.gz\nRUN mv ./jdk1.7.0_55 /usr/lib/jvm/jdk1.7.0 && mv *.tar.gz /root/\n\nRUN update-alternatives --install \"/usr/bin/java\" \"java\" \"/usr/lib/jvm/jdk1.7.0/bin/java\" 1\nRUN update-alternatives --install \"/usr/bin/javac\" \"javac\" \"/usr/lib/jvm/jdk1.7.0/bin/javac\" 1\nRUN update-alternatives --install \"/usr/bin/javaws\" \"javaws\" \"/usr/lib/jvm/jdk1.7.0/bin/javaws\" 1\n\nRUN chmod a+x /usr/bin/java /usr/bin/javac /usr/bin/javaws\nRUN chown -R root:root /usr/lib/jvm/jdk1.7.0\n\n# ruby: 1.9.1\nRUN apt-get -y --no-install-recommends install ruby && rm -rf /var/lib/apt/lists/*;\n\n# sencha command: 3.0.2.288\nENV SENCHA_CMD_x32 http://cdn.sencha.com/cmd/3.0.2.288/SenchaCmd-3.0.2.288-linux.run.zip\nENV SENCHA_CMD_x64 http://cdn.sencha.com/cmd/3.0.2.288/SenchaCmd-3.0.2.288-linux-x64.run.zip\nRUN wget -O 3.0.2.288-linux-x64.run.zip $SENCHA_CMD_x64\nRUN unzip *.run.zip && rm *.run.zip && chmod +x *.run\nRUN mkdir -p /opt/Sencha/Cmd && mv *.run /opt/Sencha/Cmd\nRUN /opt/Sencha/Cmd/SenchaCmd-3.0.2.288-linux-x64.run --prefix /opt --mode unattended\nENV PATH /opt/Sencha/Cmd/3.0.2.288:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\n\n# memcached: 1.4.14 & 1.0.8\nRUN apt-get -y --no-install-recommends install memcached && rm -rf /var/lib/apt/lists/*;\nRUN apt-get -y --no-install-recommends install libmemcached-dev && rm -rf /var/lib/apt/lists/*;\n\n# redis: 2.8.4\nRUN apt-get -y --no-install-recommends install redis-server && rm -rf /var/lib/apt/lists/*;\n\n# postgresql: 9.3\nRUN apt-get -y --no-install-recommends install postgresql postgresql-server-dev-9.3 && rm -rf /var/lib/apt/lists/*;\n\n# python: 2.7.6, pip: 1.5.6, virtualenv: 1.11, sphinx: 1.2.2\nRUN apt-get -y --no-install-recommends install python2.7 python2.7-dev python-sphinx && rm -rf /var/lib/apt/lists/*;\nRUN apt-get -y --no-install-recommends install python-pip && pip install --no-cache-dir virtualenv && rm -rf /var/lib/apt/lists/*;\nRUN ln -s /usr/bin/sphinx-build /usr/bin/sphinx-build2\n\n# clean & remove\nRUN apt-get -y clean\nRUN apt-get -y autoclean\nRUN apt-get -y autoremove\n\n## --------------------------------------------------------------------------------------------\n## Part (b): `notex:tex` ######################################################################\n## --------------------------------------------------------------------------------------------\n\nRUN apt-get -y --no-install-recommends install texlive-full && rm -rf /var/lib/apt/lists/*;\nRUN apt-get -y --no-install-recommends install ttf-* && rm -rf /var/lib/apt/lists/*;\n\n## --------------------------------------------------------------------------------------------\n## Part (c): `notex:dev` ######################################################################\n## --------------------------------------------------------------------------------------------\n\n# notex: fetch latest tag\nRUN git clone https://github.com/hsk81/notex /srv/notex.git && \\\n    cd /srv/notex.git && git checkout master && \\\n    git submodule update --init --recursive && \\\n    git checkout $(git tag | tail -n1) && \\\n    git checkout -b tag-$(git tag | tail -n1)\n\n# notex: setup postgres\nRUN /etc/init.d/postgresql start ; cd /srv/notex.git && \\\n    sudo -u postgres -g postgres psql -f webed/config/pg.sql && \\\n    sudo -u postgres -g postgres psql -f webed/config/test.sql && \\\n    sudo -u postgres -g postgres psql -f webed/config/production.sql\n\n# notex: setup sencha & python env\nRUN cd /srv/notex.git && \\\n    /bin/bash -c './setup.sh && source bin/activate && ./setup.py install' && \\\n    /bin/bash -c 'mkdir -p .python-eggs'\n\n# notex: setup dirs & owners\nRUN mkdir -p /var/www/webed\nRUN chown www-data:www-data /var/www/webed -R\nRUN chown www-data:www-data /srv/notex.git -R\n\n# notex: execute `reset`\nRUN /etc/init.d/memcached restart && \\\n    /etc/init.d/redis-server restart && \\\n    /etc/init.d/postgresql restart && \\\n    \\\n    cd /srv/notex.git && /bin/bash -c 'source bin/activate && \\\n        /usr/bin/sudo -u www-data -g www-data PYTHON_EGG_CACHE=.python-eggs \\\n            WEBED_SETTINGS=/srv/notex.git/webed/config/production.py ./webed.py reset'\n\n## --------------------------------------------------------------------------------------------\n## Part (d): `notex:pro` ######################################################################\n## --------------------------------------------------------------------------------------------\n\n# lighttpd: 1.4.33, highlight: 3.9\nRUN apt-get -y --no-install-recommends install lighttpd && rm -rf /var/lib/apt/lists/*;\nRUN apt-get -y --no-install-recommends install highlight && rm -rf /var/lib/apt/lists/*;\n\n# nginx: 1.4.6\nRUN apt-get -y --no-install-recommends install nginx && rm -rf /var/lib/apt/lists/*;\nRUN rm -rf /etc/nginx/sites-enabled/*\nRUN rm -rf /etc/nginx/conf.d/*\n\n# notex: execute `assets build`\nRUN cd /srv/notex.git && /bin/bash -c 'source bin/activate && \\\n        /usr/bin/sudo -u www-data -g www-data PYTHON_EGG_CACHE=.python-eggs \\\n            WEBED_SETTINGS=/srv/notex.git/webed/config/production.py ./webed.py assets build'\n\n# notex: execute `assets-gzip`\nRUN cd /srv/notex.git && /bin/bash -c 'source bin/activate && \\\n        /usr/bin/sudo -u www-data -g www-data PYTHON_EGG_CACHE=.python-eggs \\\n            WEBED_SETTINGS=/srv/notex.git/webed/config/production.py ./webed.py assets-gzip'\n\n## --------------------------------------------------------------------------------------------\n## Part (e): `notex:run` ######################################################################\n## --------------------------------------------------------------------------------------------\n\n# notex: `webed.run`\nRUN cd /srv/notex.git && echo '#!/bin/bash\\n\\\nif [[ $@ =~ NGINX=(1|true) ]] ; then /etc/init.d/nginx restart 2> /dev/null ; fi\\n\\\nif [[ $@ =~ LIGHTTPD=(1|true) ]] ; then /etc/init.d/lighttpd restart 2> /dev/null ; fi\\n\\\nif [[ $@ =~ REDIS=(1|true) ]] ; then /etc/init.d/redis-server restart 2> /dev/null ; fi\\n\\\nif [[ $@ =~ MEMCACHED=(1|true) ]] ; then /etc/init.d/memcached restart 2> /dev/null ; fi\\n\\\nif [[ $@ =~ POSTGRESQL=(1|true) ]] ; then /etc/init.d/postgresql restart 2> /dev/null ; fi\\n\\\nif [[ $@ =~ GITDAEMON=(1|true) ]] ; then /bin/sh -e /etc/rc.local 2> /dev/null ; fi\\n\\\n\\n\\\ncd /srv/notex.git && CMD=$@ && /usr/bin/sudo -u www-data -g www-data \\\n    /bin/bash -c \"source bin/activate && PYTHON_EGG_CACHE=.python-eggs \\\n        WEBED_SETTINGS=/srv/notex.git/webed/config/production.py $CMD\"\\n\\\n' > webed.run && chmod +x webed.run\n\n# notex: execute `webed.run`\nENTRYPOINT [\"/srv/notex.git/webed.run\"]\n\n## --------------------------------------------------------------------------------------------\n## Part (f): `notex:cfg` ######################################################################\n## --------------------------------------------------------------------------------------------\n\nADD nginx.conf /etc/nginx/nginx.conf\nADD webed.conf /etc/nginx/conf.d/webed.conf\nADD robots.txt /etc/nginx/conf.d/robots.txt\nADD lighttpd.conf /etc/lighttpd/lighttpd.conf\nADD gitweb.conf /etc/gitweb.conf\nADD rc.local /etc/rc.local\n\nADD webed/config/default.py /srv/notex.git/webed/config/default.py\nADD webed/config/production.py /srv/notex.git/webed/config/production.py\nADD webed/config/sphinx.py /srv/notex.git/webed/config/sphinx.py\nADD webed/config/test.py /srv/notex.git/webed/config/test.py\n\n## --------------------------------------------------------------------------------------------\n## ############################################################################################\n## --------------------------------------------------------------------------------------------\n"
}