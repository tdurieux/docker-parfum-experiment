{
  "startTime": 1674248299807,
  "endTime": 1674248300032,
  "originalSmells": [
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 41,
        "lineEnd": 41,
        "columnStart": 7,
        "columnEnd": 32
      }
    },
    {
      "rule": "npmCacheCleanAfterInstall",
      "position": {
        "lineStart": 34,
        "lineEnd": 34,
        "columnStart": 7,
        "columnEnd": 23
      }
    },
    {
      "rule": "npmCacheCleanAfterInstall",
      "position": {
        "lineStart": 38,
        "lineEnd": 38,
        "columnStart": 7,
        "columnEnd": 26
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 4,
        "lineEnd": 4,
        "columnStart": 7,
        "columnEnd": 45
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 14,
        "lineEnd": 25,
        "columnStart": 7,
        "columnEnd": 12
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 4,
        "lineEnd": 4,
        "columnStart": 7,
        "columnEnd": 45
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 14,
        "lineEnd": 25,
        "columnStart": 7,
        "columnEnd": 12
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "FROM ubuntu:16.04\n\nRUN useradd -ms /bin/bash lichess \\\n    && apt-get update \\\n    && apt-get install --no-install-recommends -y apt-transport-https \\\n    # Add the MongoDB source.\n    && apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --recv EA312927 \\\n    && echo \"deb http://repo.mongodb.org/apt/ubuntu xenial/mongodb-org/3.2 multiverse\" \\\n        | tee /etc/apt/sources.list.d/mongodb-org-3.2.list \\\n    # Add the Scala Build Tool source.\n    && echo \"deb https://dl.bintray.com/sbt/debian /\" \\\n        | tee -a /etc/apt/sources.list.d/sbt.list \\\n    && apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --recv 2EE0EA64E40A89B84B2DF73499E82A75642AC823 \\\n    && apt-get update \\\n    && apt-get install --no-install-recommends -y \\\n        curl \\\n        default-jdk \\\n        git-all \\\n        locales \\\n        mongodb-org \\\n        nginx \\\n        npm \\\n        parallel \\\n        sbt \\\n        sudo \\\n        wget \\\n    # Disable sudo login.\n    && echo \"lichess ALL = NOPASSWD : ALL\" >> /etc/sudoers \\\n    # Set locale.\n    && locale-gen en_US.UTF-8 \\\n    # Silence the parallel citation warning.\n    && mkdir -p /home/lichess/.parallel \\\n    && touch /home/lichess/.parallel/will-cite \\\n    # Update node.\n    && npm install -g n \\\n    && n stable \\\n    # Link the nodejs executable so it can be used about Yarn.\n    && ln -s /usr/bin/nodejs /usr/bin/node \\\n    && npm install -g yarn \\\n    && yarn global add gulp-cli \\\n    # Install svgcleaner via the Rust package manager, Cargo.\n    && curl -f https://sh.rustup.rs \\\n        | sh -s -- -y \\\n    && /root/.cargo/bin/cargo install svgcleaner \\\n    # Move the svgcleaner executable to a folder in the system's path.\n    && mv /root/.cargo/bin/svgcleaner /usr/bin/svgcleaner \\\n    # Create the MongoDB database directory.\n    && mkdir /data \\\n    && mkdir /data/db \\\n    && sbt update \\\n    # Remove now unneeded dependencies.\n    && apt-get purge -y \\\n        curl \\\n        git-all \\\n        npm \\\n    && apt-get autoremove -y \\\n    && apt-get clean \\\n    && /root/.cargo/bin/rustup self uninstall -y && npm cache clean --force; && rm -rf /var/lib/apt/lists/*;\n\nADD run.sh /home/lichess/run.sh\nADD nginx.conf /etc/nginx/nginx.conf\n\n# Use UTF-8 encoding.\nENV LANG \"en_US.UTF-8\"\nENV LC_CTYPE \"en_US.UTF-8\"\n\n# Run as a non-privileged user.\nUSER lichess\n\nEXPOSE 80\n\nWORKDIR /home/lichess\n\nENTRYPOINT ./run.sh\n"
}