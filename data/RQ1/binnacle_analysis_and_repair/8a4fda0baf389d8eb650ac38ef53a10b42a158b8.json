{
  "startTime": 1674248207739,
  "endTime": 1674248208039,
  "originalSmells": [
    {
      "rule": "curlUseHttpsUrl",
      "position": {
        "lineStart": 39,
        "lineEnd": 39,
        "columnStart": 4,
        "columnEnd": 146
      }
    },
    {
      "rule": "sha256sumEchoOneSpaces",
      "position": {
        "lineStart": 40,
        "lineEnd": 40,
        "columnStart": 7,
        "columnEnd": 90
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "# Debian, miniconda, ESRIN-Sen2Cor Dockerfile\n# https://github.com/edwardpmorris/docker-snap\n# sen2cor from http://step.esa.int/main/third-party-plugins-2/sen2cor/\n\n# pull base image (use a specific version tag ':tag')\nFROM  continuumio/miniconda:4.0.5\n\n# maintainer details\nMAINTAINER epmorris \"edward.morris@uca.es\"\n\n# update version label\nLABEL sen2cor_version='2.2.1'\n\n# set some env variables\nENV SEN2COR_VERSION='2.2.1' \\\n    HOME=/home/worker\n\n# install conda packages (install expects anaconda)\n# FIXME: why is this needed? should mngr not meet dependencies?\nRUN conda install --yes \\\n    pytables \\\n    psutil \\\n    scipy \\\n    scikit-image \\\n    && conda clean -i -l -t -y\n\n# create user group set UID to volume\nRUN mkdir /home/worker \\\n    && groupadd -r worker -g 1000 \\\n    && useradd -u 431 -r -g worker -d /home/worker -s /sbin/nologin -c \"Docker image user\" worker \\\n    && chown -R worker:worker /home/worker\n\n# set work directory to home\nWORKDIR $HOME\n\n# download, check, extract and clean up sen2cor install from step.esa.int\n# FIXME: improve verification, https://github.com/docker-library/official-images\n# https not available?\nENV SEN2COR_DOWNLOAD_SHA256 81ac7bd389bdce6a24f780d067fbf89324fc6ac314c9d9c28da55d414d1e7d3e\nRUN curl -fSL -o sen2cor-${SEN2COR_VERSION}.tar.gz \"https://step.esa.int/thirdparties/sen2cor/${SEN2COR_VERSION}/sen2cor-${SEN2COR_VERSION}.tar.gz\" \\\n    && echo \"$SEN2COR_DOWNLOAD_SHA256  *sen2cor-${SEN2COR_VERSION}.tar.gz\" | sha256sum -c - \\\n    && tar -xvzf sen2cor-${SEN2COR_VERSION}.tar.gz \\\n    && rm sen2cor-${SEN2COR_VERSION}.tar.gz\n\n# add headless setup (interactive prompts commented, use defaut path options)\n# FIXME: check if a 'default settings' flag exists for setup.py\n# add L2A user settings\nCOPY setup.py $HOME/sen2cor-${SEN2COR_VERSION}\nCOPY L2A_GIPP.xml $HOME/sen2cor-${SEN2COR_VERSION}/cfg\n\n# install sen2cor and fix permission issues\n# FIXME: is this the 'best' way to do permissions?\n# FIXME: cmd L2A_Bashrc does not seem to set env variables\nENV  GDAL_DATA=/opt/conda/lib/python2.7/site-packages/sen2cor-2.2.1-py2.7.egg/sen2cor/cfg/gdal_data \\\n     SEN2COR_BIN=/opt/conda/lib/python2.7/site-packages/sen2cor-2.2.1-py2.7.egg/sen2cor \\\n     SEN2COR_HOME=$HOME/sen2cor\nRUN cd sen2cor-2.2.1 \\\n    && python setup.py install --quiet \\\n    && conda clean -i -l -t -y \\\n    && rm -rf $HOME/sen2cor-${SEN2COR_VERSION} \\\n    && chmod +x $HOME/sen2cor/L2A_Bashrc \\\n    && /bin/bash $HOME/sen2cor/L2A_Bashrc \\\n    && chown -R worker:worker $HOME/sen2cor \\\n    && chmod -R g+w $HOME/sen2cor \\\n    && chgrp -R worker $SEN2COR_BIN \\\n    && chmod -R g+w $SEN2COR_BIN/cfg\n\nUSER worker"
}