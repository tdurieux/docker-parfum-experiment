{
  "startTime": 1674239352819,
  "endTime": 1674239353114,
  "originalSmells": [
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 30,
        "lineEnd": 30,
        "columnStart": 5,
        "columnEnd": 81
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "# Copyright (c) 2017, Oracle and/or its affiliates. All rights reserved.\n#\n# This program is free software; you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation; version 2 of the License.\n#\n# This program is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with this program; if not, write to the Free Software\n# Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301 USA\n\n# Copied from https://github.com/mysql/mysql-docker/tree/mysql-server/5.7\n\n# Build image cmd: docker build -t debian-mysql-server-5.7 .\n\nFROM debian:sid\n\n# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added\nRUN groupadd -r mysql && useradd -r -g mysql mysql \\\n  \\\n  && printf \"\\nalias ll='ls -l'\\nalias l='ls -lA'\\n\" >> /root/.bashrc \\\n  # Map Ctrl-Up and Ctrl-Down to history based bash completion\n  && printf '\"\\\\e[1;5A\": history-search-backward\\n\"\\\\e[1;5B\": history-search-forward\\n\"\\\\e[1;5C\": forward-word\\n\"\\\\e[1;5D\": backward-word' > /etc/inputrc \\\n  \\\n  && apt-get update \\\n  # Install minimal admin utils \\\n  && DEBIAN_FRONTEND=noninteractive apt-get --no-install-recommends install -y apt-utils less nano procps \\\n  # Install MySQL server\n  && DEBIAN_FRONTEND=noninteractive apt-get install -y --no-install-recommends libpwquality-tools mysql-server-5.7 \\\n  # Clean cache\n  && rm -rf /var/lib/apt/lists/* \\\n\n  && rm -rf /var/lib/mysql && mkdir -p /var/lib/mysql /var/run/mysqld \\\n  && touch /var/log/mysqld.log \\\n  && chown -R mysql:mysql /var/lib/mysql /var/run/mysqld /var/log/mysqld.log \\\n  # Ensure that /var/run/mysqld (used for socket and lock files) is writable regardless of the UID our mysqld instance ends up having at runtime\n  && chmod 777 /var/run/mysqld \\\n  && chmod 775 /var/log \\\n  # Disable Debian MySQL config since it overwrites config from volume\n  && mv /etc/mysql/mysql.conf.d/mysqld.cnf /etc/mysql/mysql.conf.d/mysqld.cnf.disabled \\\n  && mv /etc/mysql/conf.d/mysqldump.cnf /etc/mysql/conf.d/mysqldump.cnf.disabled \\\n  && mv /etc/mysql/conf.d/mysql.cnf /etc/mysql/conf.d/mysql.cnf.disabled \\\n  # Create placeholder for custom my.cnf\n  && touch /etc/mysql/conf.d/my.cnf \\\n  # Set docker settings, these settings always win\n  && printf '[client]\\nsocket=/var/lib/mysql/mysql.sock\\n\\n[server]\\nsocket=/var/lib/mysql/mysql.sock\\ndatadir=/var/lib/mysql\\nsecure-file-priv=/var/lib/mysql-files\\nuser=mysql\\nskip-host-cache\\nskip-name-resolve\\n' > /etc/mysql/mysql.conf.d/docker.cnf \\\n\n  && mkdir /docker-entrypoint-initdb.d\n\nVOLUME /var/lib/mysql\n\nCOPY docker-entrypoint.sh /entrypoint.sh\nCOPY healthcheck.sh /healthcheck.sh\nENTRYPOINT [\"/entrypoint.sh\"]\nHEALTHCHECK CMD /healthcheck.sh\nEXPOSE 3306 33060\nCMD [\"mysqld\"]\n"
}