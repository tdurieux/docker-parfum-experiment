{
  "startTime": 1674249176408,
  "endTime": 1674249176539,
  "originalSmells": [
    {
      "rule": "npmCacheCleanAfterInstall",
      "position": {
        "lineStart": 33,
        "lineEnd": 33,
        "columnStart": 17,
        "columnEnd": 28
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "## VT building image\n\nFROM clojure:alpine AS vt\n\nRUN mkdir /app\nWORKDIR /app\n\nCOPY vt/project.clj /app/vt/\nRUN cd vt && lein deps\n\nCOPY vt/src /app/vt/src\nCOPY vt/resources /app/vt/resources\nRUN cd vt && lein cljsbuild once main\n\n## Release building image\n\nFROM elixir:1.7.3-alpine AS builder\n\nARG MIX_ENV=prod\n\nWORKDIR /opt/app\n\nRUN apk update && \\\n  apk upgrade --no-cache && \\\n  apk add --no-cache \\\n    nodejs \\\n    npm \\\n    build-base && \\\n  mix local.rebar --force && \\\n  mix local.hex --force\n\nCOPY assets/package.json assets/\nCOPY assets/package-lock.json assets/\nRUN cd assets && npm install && npm cache clean --force;\n\nCOPY mix.* ./\nRUN mix do deps.get --only prod, deps.compile\n\nCOPY assets/ assets/\nRUN cd assets && npm run deploy\nRUN mix phx.digest\n\nCOPY config/*.exs config/\nCOPY lib lib/\nCOPY priv priv/\nRUN mix compile\n\nCOPY --from=vt /app/vt/main.js priv/vt/\nCOPY vt/liner.js priv/vt/\n\nCOPY rel rel/\n\nRUN \\\n  mkdir -p /opt/built && \\\n  mix release --verbose && \\\n  cp _build/${MIX_ENV}/rel/asciinema/releases/0.0.1/asciinema.tar.gz /opt/built && \\\n  cd /opt/built && \\\n  tar -xzf asciinema.tar.gz && \\\n  rm asciinema.tar.gz\n\n## Final image\n\nFROM alpine:3.8\n\nRUN apk update && \\\n  apk add --no-cache \\\n  bash \\\n  librsvg \\\n  ttf-dejavu \\\n  pngquant \\\n  nodejs\n\nWORKDIR /opt/app\n\nCOPY --from=builder /opt/built .\nCOPY config/custom.exs.sample /opt/app/etc/custom.exs\nCOPY .iex.exs .\nCOPY docker/bin/ bin/\n\nENV PORT 4000\nENV DATABASE_URL \"postgresql://postgres@postgres/postgres\"\nENV REDIS_URL \"redis://redis:6379\"\nENV RSVG_FONT_FAMILY \"Dejavu Sans Mono\"\nENV PATH \"/opt/app/bin:${PATH}\"\n\nVOLUME /opt/app/uploads\nVOLUME /opt/app/cache\n\nCMD trap 'exit' INT; /opt/app/bin/asciinema foreground\n\nEXPOSE 4000\n"
}