{
  "startTime": 1674249445353,
  "endTime": 1674249445553,
  "originalSmells": [
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 6,
        "lineEnd": 6,
        "columnStart": 4,
        "columnEnd": 54
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "FROM localstack/java-maven-node-python\n\nMAINTAINER Waldemar Hummer (waldemar.hummer@gmail.com)\nLABEL authors=\"Waldemar Hummer (waldemar.hummer@gmail.com), Gianluca Bortoli (giallogiallo93@gmail.com)\"\n\n# install basic tools\nRUN pip install --no-cache-dir awscli awscli-local requests --upgrade\n\n# add files required to run \"make install\"\nADD Makefile requirements.txt ./\nRUN mkdir -p localstack/utils/kinesis/ && mkdir -p localstack/services/ && \\\n  touch localstack/__init__.py localstack/utils/__init__.py localstack/services/__init__.py localstack/utils/kinesis/__init__.py\nADD localstack/constants.py localstack/config.py localstack/\nADD localstack/services/install.py localstack/services/\nADD localstack/utils/common.py localstack/utils/\nADD localstack/utils/kinesis/ localstack/utils/kinesis/\nADD localstack/ext/ localstack/ext/\n\n# install dependencies\nRUN make install\n\n# add files required to run \"make init\"\nADD localstack/package.json localstack/package.json\nADD localstack/services/__init__.py localstack/services/install.py localstack/services/\n\n# initialize installation (downloads remaining dependencies)\nRUN make init\n\n# (re-)install web dashboard dependencies (already installed in base image)\nADD localstack/dashboard/web localstack/dashboard/web\nRUN make install-web\n\n# install supervisor config file and entrypoint script\nADD bin/supervisord.conf /etc/supervisord.conf\nADD bin/docker-entrypoint.sh /usr/local/bin/\n\n# expose service & web dashboard ports\nEXPOSE 4567-4597 8080\n\n# define command at startup\nENTRYPOINT [\"docker-entrypoint.sh\"]\n\n# expose default environment (required for aws-cli to work)\nENV MAVEN_CONFIG=/opt/code/localstack \\\n    USER=localstack \\\n    PYTHONUNBUFFERED=1\n\n# add rest of the code\nADD localstack/ localstack/\nADD bin/localstack bin/localstack\n\n# fix some permissions and create local user\nRUN mkdir -p /.npm && \\\n    mkdir -p localstack/infra/elasticsearch/data && \\\n    mkdir -p localstack/infra/elasticsearch/logs && \\\n    chmod 777 . && \\\n    chmod 755 /root && \\\n    chmod -R 777 /.npm && \\\n    chmod -R 777 localstack/infra/elasticsearch/config && \\\n    chmod -R 777 localstack/infra/elasticsearch/data && \\\n    chmod -R 777 localstack/infra/elasticsearch/logs && \\\n    chmod -R 777 /tmp/localstack && \\\n    adduser -D localstack && \\\n    chown -R localstack:localstack . /tmp/localstack && \\\n    ln -s `pwd` /tmp/localstack_install_dir\n\n# clean up and prepare for squashing the image\nRUN pip uninstall -y awscli boto3 botocore localstack_client idna s3transfer\nRUN rm -rf /tmp/* /root/.cache /opt/yarn-v1.15.2\nRUN ln -s /opt/code/localstack/.venv/bin/aws /usr/bin/aws\nENV PYTHONPATH=/opt/code/localstack/.venv/lib/python3.6/site-packages\n\n# run tests (to verify the build before pushing the image)\nADD tests/ tests/\nRUN LAMBDA_EXECUTOR=local make test\n"
}