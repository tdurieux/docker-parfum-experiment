{
  "startTime": 1674240157028,
  "endTime": 1674240157178,
  "originalSmells": [
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 15,
        "lineEnd": 15,
        "columnStart": 4,
        "columnEnd": 100
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 35,
        "lineEnd": 35,
        "columnStart": 59,
        "columnEnd": 99
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "FROM rundeckapp/testdeck:base-latest\n\nENV USERNAME=rundeck \\\n    USER=rundeck \\\n    HOME=/home/rundeck \\\n    LOGNAME=$USERNAME \\\n    TERM=xterm-256color\n\nARG CLI_DEB_URL\nARG CLI_VERS\n\n#Add PAM test user\nRUN useradd -p $(echo \"pampwd123\" | openssl passwd -1 -stdin) -m --shell /bin/bash pamlogintest\n\n    # Add gpg key\nRUN curl -f \"https://bintray.com/user/downloadSubjectPublicKey?username=bintray\" > /tmp/bintray.gpg.key \\\n    && apt-key add - < /tmp/bintray.gpg.key \\\n    # Add cli tool debian repo\n    && echo \"deb $CLI_DEB_URL /\" | sudo tee -a /etc/apt/sources.list \\\n    #Â RUNDECK - create user\n    && adduser --shell /bin/bash --home $HOME --gecos \"\" --disabled-password $USERNAME && \\\n        passwd -d $USERNAME && \\\n        addgroup $USERNAME sudo && \\\n        addgroup $USERNAME shadow\n\nWORKDIR $HOME\n\nCOPY --chown=rundeck:rundeck data $HOME\nCOPY --chown=rundeck:rundeck api_test $HOME/api_test\n\nARG LAUNCHER_URL\nARG RUNDECK_NODE=rundeck1\nRUN echo \"download rundeck launcher: ${LAUNCHER_URL}\" \\\n    && { test -f $HOME/rundeck-launcher.war || curl -sS -f -L ${LAUNCHER_URL} > $HOME/rundeck-launcher.war; } \\\n    && { test -f $HOME/data/rd.deb && dpkg -i $HOME/data/rd.deb || true; } \\\n    && { \\\n     test -f $HOME/data/rd.deb || apt-get -y update && apt-get -y --no-install-recommends install rundeck-cli=$CLI_VERS; \\\n   } \\\n    && java \\\n        -Dserver.http.port=4440 \\\n        -Dserver.hostname=$RUNDECK_NODE \\\n        -jar $HOME/rundeck-launcher.war --installonly \\\n    && rm -rf /var/lib/apt/lists/*\n\nUSER rundeck\n\n\n# Copy files.\nRUN mkdir -p $HOME/scripts\nCOPY scripts $HOME/scripts\nRUN sudo chmod -R a+x $HOME/scripts/*\n\nRUN sudo mkdir -p /tests\nCOPY tests /tests\nRUN sudo chmod -R a+x /tests/*\n\nVOLUME /var/lib/docker\nVOLUME /test\nVOLUME $HOME/resources\n\nEXPOSE 22 4440 4443 4444\n\n# Start the instance.\nCMD $HOME/scripts/run.sh"
}