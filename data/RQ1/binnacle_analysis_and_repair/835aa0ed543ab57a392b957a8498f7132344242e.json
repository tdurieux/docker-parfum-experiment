{
  "startTime": 1674247945202,
  "endTime": 1674247945488,
  "originalSmells": [
    {
      "rule": "npmCacheCleanAfterInstall",
      "position": {
        "lineStart": 95,
        "lineEnd": 95,
        "columnStart": 7,
        "columnEnd": 12
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "FROM alpine:edge\nMAINTAINER Julian Xhokaxhiu <info at julianxhokaxhiu dot com>\n\n# Environment variables\n#######################\n\nENV DATA_DIR /srv/data\n\n# Configurable environment variables\n####################################\n\n# Custom DNS where to forward your request, if not found inside the DNS Server.\n# By default this will be forwarded to Google DNS for IPv4 and IPv6 requests.\n# See https://doc.powerdns.com/md/recursor/settings/#forward-zones\nENV CUSTOM_DNS \"8.8.8.8;8.8.4.4;[2001:4860:4860::8888];[2001:4860:4860::8844]\"\n\n# Custom API Key for PowerDNS.\n# Leave empty to autogenerate one ( HIGHLY SUGGESTED! )\n# See https://doc.powerdns.com/md/authoritative/settings/#api-key\nENV API_KEY \"\"\n\n# Change this cron rule to what fits best for you.\n# Used only if ENABLE_ADBLOCK=true\n# By Default = At 10:00 UTC ~ 2am PST/PDT\nENV CRONTAB_TIME '0 10 * * *'\n\n# Enable the AdBlock feature\nENV ENABLE_ADBLOCK false\n\n# Create Volume entry points\n############################\n\nVOLUME $DATA_DIR\n\n# Copy required files and fix permissions\n#########################################\n\nCOPY src/* /root/\n\n# Create missing directories\n############################\n\nRUN mkdir -p $DATA_DIR\n\n# Set the work directory\n########################\n\nWORKDIR /root\n\n# Fix permissions\n#################\n\nRUN chmod 0644 * \\\n    && chmod 0755 *.sh\n\n# Install required packages\n##############################\n\nRUN apk --update add --no-cache \\\n    bash \\\n    supervisor \\\n    pdns \\\n    pdns-doc \\\n    pdns-recursor \\\n    pdns-backend-sqlite3 \\\n    sqlite \\\n    curl \\\n    dbus \\\n    libldap \\\n    python3\n\n# Required by PowerDNS Admin GUI\nRUN apk --update add --no-cache --virtual .build-deps \\\n    git \\\n    gcc \\\n    musl-dev \\\n    python3-dev \\\n    mariadb-dev \\\n    libffi-dev \\\n    libxslt-dev \\\n    xmlsec-dev \\\n    openldap-dev \\\n    nodejs \\\n    npm\n\n# Install PowerDNS Admin GUI\n##############################\n\nRUN mkdir -p /usr/share/webapps/ \\\n    && cd /usr/share/webapps/ \\\n    && git clone https://github.com/ngoduykhanh/PowerDNS-Admin.git powerdns-admin \\\n    && cd /usr/share/webapps/powerdns-admin \\\n    && pip3 install --no-cache-dir -r requirements.txt \\\n    && mv package.json app/static \\\n    && cd app/static \\\n    && npm i && npm cache clean --force;\n\n# Cleanup\n#########\n\nRUN find /usr/local \\\n      \\( -type d -a -name test -o -name tests \\) \\\n      -o \\( -type f -a -name '*.pyc' -o -name '*.pyo' \\) \\\n      -exec rm -rf '{}' + \\\n    && apk del .build-deps \\\n    && rm -rf /var/cache/apk/*\n\n# Replace default configurations\n################################\nRUN rm /etc/pdns/pdns.conf \\\n    && rm /etc/pdns/recursor.conf \\\n    && rm /etc/supervisord.conf \\\n    && mv /root/pdns.conf /etc/pdns \\\n    && mv /root/recursor.conf /etc/pdns \\\n    && mv /root/config.py /usr/share/webapps/powerdns-admin \\\n    && mv /root/supervisord.conf /etc\n\n# Allow redirection of stdout to docker logs\n############################################\nRUN ln -sf /proc/1/fd/1 /var/log/docker.log\n\n# Expose required ports\n#######################\n\nEXPOSE 53\nEXPOSE 53/udp\nEXPOSE 8080\n\n# Change Shell\n##############\nSHELL [\"/bin/bash\", \"-c\"]\n\n# Set the entry point to init.sh\n###########################################\n\nENTRYPOINT /root/init.sh\n"
}