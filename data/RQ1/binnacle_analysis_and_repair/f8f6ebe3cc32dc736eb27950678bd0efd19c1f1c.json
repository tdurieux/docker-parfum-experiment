{
  "startTime": 1674240510202,
  "endTime": 1674240510708,
  "originalSmells": [
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 65,
        "lineEnd": 65,
        "columnStart": 4,
        "columnEnd": 137
      }
    },
    {
      "rule": "curlUseHttpsUrl",
      "position": {
        "lineStart": 65,
        "lineEnd": 65,
        "columnStart": 4,
        "columnEnd": 137
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 14,
        "lineEnd": 14,
        "columnStart": 39,
        "columnEnd": 67
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 22,
        "lineEnd": 22,
        "columnStart": 22,
        "columnEnd": 84
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 24,
        "lineEnd": 24,
        "columnStart": 4,
        "columnEnd": 35
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 53,
        "lineEnd": 53,
        "columnStart": 39,
        "columnEnd": 65
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 59,
        "lineEnd": 59,
        "columnStart": 39,
        "columnEnd": 62
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 79,
        "lineEnd": 79,
        "columnStart": 22,
        "columnEnd": 55
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 84,
        "lineEnd": 84,
        "columnStart": 4,
        "columnEnd": 37
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 86,
        "lineEnd": 86,
        "columnStart": 4,
        "columnEnd": 50
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 88,
        "lineEnd": 88,
        "columnStart": 4,
        "columnEnd": 43
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 89,
        "lineEnd": 89,
        "columnStart": 4,
        "columnEnd": 29
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 92,
        "lineEnd": 92,
        "columnStart": 4,
        "columnEnd": 51
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 94,
        "lineEnd": 94,
        "columnStart": 39,
        "columnEnd": 65
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 99,
        "lineEnd": 99,
        "columnStart": 22,
        "columnEnd": 50
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 126,
        "lineEnd": 126,
        "columnStart": 4,
        "columnEnd": 66
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 24,
        "lineEnd": 24,
        "columnStart": 4,
        "columnEnd": 35
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 84,
        "lineEnd": 84,
        "columnStart": 4,
        "columnEnd": 37
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 86,
        "lineEnd": 86,
        "columnStart": 4,
        "columnEnd": 50
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 88,
        "lineEnd": 88,
        "columnStart": 4,
        "columnEnd": 43
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 89,
        "lineEnd": 89,
        "columnStart": 4,
        "columnEnd": 29
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 92,
        "lineEnd": 92,
        "columnStart": 4,
        "columnEnd": 51
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 126,
        "lineEnd": 126,
        "columnStart": 4,
        "columnEnd": 66
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 14,
        "lineEnd": 14,
        "columnStart": 39,
        "columnEnd": 67
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 22,
        "lineEnd": 22,
        "columnStart": 22,
        "columnEnd": 84
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 24,
        "lineEnd": 24,
        "columnStart": 4,
        "columnEnd": 35
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 53,
        "lineEnd": 53,
        "columnStart": 39,
        "columnEnd": 65
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 59,
        "lineEnd": 59,
        "columnStart": 39,
        "columnEnd": 62
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 79,
        "lineEnd": 79,
        "columnStart": 22,
        "columnEnd": 55
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 84,
        "lineEnd": 84,
        "columnStart": 4,
        "columnEnd": 37
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 86,
        "lineEnd": 86,
        "columnStart": 4,
        "columnEnd": 50
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 88,
        "lineEnd": 88,
        "columnStart": 4,
        "columnEnd": 43
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 89,
        "lineEnd": 89,
        "columnStart": 4,
        "columnEnd": 29
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 92,
        "lineEnd": 92,
        "columnStart": 4,
        "columnEnd": 51
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 94,
        "lineEnd": 94,
        "columnStart": 39,
        "columnEnd": 65
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 99,
        "lineEnd": 99,
        "columnStart": 22,
        "columnEnd": 50
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 126,
        "lineEnd": 126,
        "columnStart": 4,
        "columnEnd": 66
      }
    }
  ],
  "repairedSmells": [
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 24,
        "lineEnd": 24,
        "columnStart": 4,
        "columnEnd": 59
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 84,
        "lineEnd": 84,
        "columnStart": 4,
        "columnEnd": 61
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 86,
        "lineEnd": 86,
        "columnStart": 4,
        "columnEnd": 74
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 88,
        "lineEnd": 88,
        "columnStart": 4,
        "columnEnd": 66
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 89,
        "lineEnd": 89,
        "columnStart": 4,
        "columnEnd": 53
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 92,
        "lineEnd": 92,
        "columnStart": 4,
        "columnEnd": 75
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 126,
        "lineEnd": 126,
        "columnStart": 4,
        "columnEnd": 90
      }
    }
  ],
  "repairedDockerfile": "#########################################################################################\n# Dockerfile to build vitam and run on one server\n# Based on Debian\n#\n# Maintained by Vitam Integration Team\n# Image name: vitam/dev-deb-base\n#########################################################################################\n\n# Set the base image to Debian 8\nFROM debian:9.5\nMAINTAINER French Prime minister Office/SGMAP/DINSIC/Vitam Program <contact.vitam@culture.gouv.fr>\n\n#ENV DEBIAN_FRONTEND noninteractive\n\nRUN apt-get clean && apt-get update && apt-get install --no-install-recommends -y apt-utils && rm -rf /var/lib/apt/lists/*;\n\n# Make sure the package repository and packages are up to date.\n\nCOPY deb/stretch-backports.list /etc/apt/sources.list.d\n\nRUN apt-get clean && apt-get update && apt-get upgrade -y\n\nRUN apt-get update && apt-get install --no-install-recommends -t stretch-backports -y openjdk-8-jdk-headless && rm -rf /var/lib/apt/lists/*;\n\nRUN apt-get install --no-install-recommends -y systemd-sysv && rm -rf /var/lib/apt/lists/*;\n\n################################  Configure systemd  ###############################\n\n# Hint for systemd that we are running inside a container\nENV container docker\n\nRUN cd /lib/systemd/system/sysinit.target.wants/ && \\\n\t\tls | grep -v systemd-tmpfiles-setup.service | xargs rm -f && \\\n\t\trm -f /lib/systemd/system/sockets.target.wants/*udev* && \\\n\t\tsystemctl mask -- \\\n\t\t\ttmp.mount \\\n\t\t\tetc-hostname.mount \\\n\t\t\tetc-hosts.mount \\\n\t\t\tetc-resolv.conf.mount \\\n\t\t\t-.mount \\\n\t\t\tswap.target \\\n\t\t\tgetty.target \\\n\t\t\tgetty-static.service \\\n\t\t\tdev-mqueue.mount \\\n\t\t\tsystemd-tmpfiles-setup-dev.service \\\n\t\t\tsystemd-tmpfiles-setup.service \\\n\t\t\tsystemd-remount-fs.service \\\n\t\t\tsystemd-update-utmp-runlevel.service \\\n\t\t\tsystemd-logind.service && \\\n\t\tsystemctl set-default multi-user.target || true\n\n################################  Install build tools (rpm / maven / java)  ###############################\n\nRUN apt-get clean && apt-get update && apt-get install --no-install-recommends -y openssl && rm -rf /var/lib/apt/lists/*;\n\n# to bypass the \"trustAnchors parameter must be non-empty\" problem\n# See http://stackoverflow.com/questions/6784463/error-trustanchors-parameter-must-be-non-empty\nRUN /var/lib/dpkg/info/ca-certificates-java.postinst configure\n\nRUN apt-get clean && apt-get update && apt-get install --no-install-recommends -y curl && apt-get clean && rm -rf /var/lib/apt/lists/*;\n\n# Add Java to path\nENV JAVA_HOME /usr/lib/jvm/java-8-openjdk-amd64\n\n# Install & configure maven\nRUN curl -f -k https://repo.maven.apache.org/maven2/org/apache/maven/apache-maven/3.3.9/apache-maven-3.3.9-bin.tar.gz --output /tmp/maven.tgz \\\n   && tar xvzf /tmp/maven.tgz --directory /opt \\\n   && rm -f /tmp/maven.tgz \\\n   && ln -s /opt/apache-maven-3.3.9 /opt/maven \\\n   && mkdir -p /devhome/.m2 \\\n   && chmod -R 777 /devhome\n\n# Add Maven & java to path\nENV M2_HOME /opt/maven\nENV PATH ${M2_HOME}/bin:${JAVA_HOME}/bin:${PATH}\n\n################################  Install ansible  ###############################\n# for sudo in automatic deployment ; note : ansible needs epel repo\n\nRUN apt-get update && apt-get install --no-install-recommends -y sudo net-tools \\\n  && apt-get clean && rm -rf /var/lib/apt/lists/*;\n\n\n# Editor & unzip\nRUN apt-get install --no-install-recommends -y vim unzip wget && rm -rf /var/lib/apt/lists/*;\n\nRUN apt-get install --no-install-recommends -y -t stretch-backports golang && rm -rf /var/lib/apt/lists/*;\n\nRUN apt-get install --no-install-recommends -y node-gyp nodejs-dev && \\\n    apt-get install --no-install-recommends -y nodejs && \\\n    ln -s /usr/bin/nodejs /usr/bin/node && rm -rf /var/lib/apt/lists/*;\n\nRUN apt-get -t stretch-backports --no-install-recommends -y install ansible && rm -rf /var/lib/apt/lists/*;\n\nRUN apt-get clean && apt-get update && apt-get install --no-install-recommends -y git vim && rm -rf /var/lib/apt/lists/*;\n\n##################################  Declare local deb repo  #################################\n\n# Note : declare at the end ; else other commands will fail.\nRUN apt-get update && apt-get install --no-install-recommends -y dpkg-dev \\\n    && apt-get clean && rm -rf /var/lib/apt/lists/*;\n\nCOPY deb/local.list /etc/apt/sources.list.d/local.list\n\n################################## Add dev helpers #################################\n\nCOPY deb/vitam-build-repo /usr/bin\nCOPY vitam-deploy /usr/bin\nCOPY vitam-deploy-extra /usr/bin\nCOPY deb/vitam-maven-build-only /usr/bin\nCOPY vitam-redeploy /usr/bin\nCOPY vitam-redeploy-extra /usr/bin\nCOPY vitam-command /usr/bin\nRUN  chmod a+x /usr/bin/vitam-*\n\n# KWA review : Why remove this script ?\nCOPY deb/profile-build-repo.sh /etc/profile.d\nCOPY profile-prompt-usage.sh /etc/profile.d\nCOPY .bashrc /devhome\nCOPY vitam-usage.txt /etc\nCOPY deb/sudo-nopwd /etc/sudoers.d\nRUN chmod 664 /etc/sudoers.d/sudo-nopwd\n\nENV TERM xterm\n\n# If we don't install openjdk a 2nd time, sometimes it doesn't work, why ???\nRUN apt-get install --no-install-recommends -t stretch-backports -y openjdk-8-jdk-headless && rm -rf /var/lib/apt/lists/*;\n\n##################################  CONTAINER SETTINGS  #################################\n\n# VOLUME [ \"/sys/fs/cgroup\" ]\nVOLUME [ \"/code\" ]\nVOLUME [ \"/devhome/.m2\" ]\n\nWORKDIR /code\n\n#ENV DEBIAN_FRONTEND teletype\n\n# Entry Point to systemd init\nCMD [\"/sbin/init\"]\n\nCOPY vitam-stop /usr/bin\nCOPY vitam-start /usr/bin\nCOPY vitam-restart /usr/bin\nCOPY vitam-bench-ingest /usr/bin\nCOPY vitam-mongo-cli /usr/bin\nCOPY vitam-mongo-cli-rs /usr/bin\nCOPY deb/vitam-recreate-repo /usr/bin\n\nRUN  chmod a+x /usr/bin/vitam-*\n\n# System tuning for elasticsearch\nRUN echo \"vm.max_map_count = 262144\" >> /etc/sysctl.conf\n\nCOPY deb/vitam-build-griffins /usr/bin\n"
}