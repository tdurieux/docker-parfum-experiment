{
  "startTime": 1674249910760,
  "endTime": 1674249910901,
  "originalSmells": [
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 7,
        "lineEnd": 7,
        "columnStart": 4,
        "columnEnd": 33
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 8,
        "lineEnd": 8,
        "columnStart": 4,
        "columnEnd": 36
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 24,
        "lineEnd": 24,
        "columnStart": 4,
        "columnEnd": 33
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 25,
        "lineEnd": 25,
        "columnStart": 4,
        "columnEnd": 51
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 43,
        "lineEnd": 43,
        "columnStart": 4,
        "columnEnd": 63
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 48,
        "lineEnd": 63,
        "columnStart": 4,
        "columnEnd": 9
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 23,
        "lineEnd": 23,
        "columnStart": 22,
        "columnEnd": 70
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 43,
        "lineEnd": 43,
        "columnStart": 4,
        "columnEnd": 63
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 48,
        "lineEnd": 63,
        "columnStart": 4,
        "columnEnd": 9
      }
    }
  ],
  "repairedSmells": [
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 43,
        "lineEnd": 43,
        "columnStart": 4,
        "columnEnd": 63
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 48,
        "lineEnd": 63,
        "columnStart": 4,
        "columnEnd": 9
      }
    }
  ],
  "repairedDockerfile": "ARG NAMESPACE\nARG TAG\nARG PREREQS_TAG\nFROM ${NAMESPACE}/ue4-source:${TAG}-${PREREQS_TAG} AS builder\n\n# Install ue4cli and conan-ue4cli\nUSER root\nRUN pip3 install --no-cache-dir setuptools wheel\nRUN pip3 install --no-cache-dir ue4cli conan-ue4cli\nUSER ue4\n\n# Extract the third-party library details from UBT\nRUN ue4 setroot /home/ue4/UnrealEngine\nRUN ue4 conan generate\n\n# Copy the generated Conan packages into a new image with our Installed Build\nFROM ${NAMESPACE}/ue4-minimal:${TAG}-${PREREQS_TAG}\n\n# Clone the UE4Capture repository\nRUN git clone \"https://github.com/adamrehn/UE4Capture.git\" /home/ue4/UE4Capture\n\n# Install CMake, ue4cli, conan-ue4cli, and ue4-ci-helpers\nUSER root\nRUN apt-get update && apt-get install -y --no-install-recommends cmake && rm -rf /var/lib/apt/lists/*;\nRUN pip3 install --no-cache-dir setuptools wheel\nRUN pip3 install --no-cache-dir ue4cli conan-ue4cli ue4-ci-helpers\nUSER ue4\n\n# Copy the Conan configuration settings and package cache from the builder image\nCOPY --from=builder --chown=ue4:ue4 /home/ue4/.conan /home/ue4/.conan\n\n# Install conan-ue4cli (just generate the profile, since we've already copied the generated packages)\nRUN ue4 setroot /home/ue4/UnrealEngine\nRUN ue4 conan generate --profile-only\n\n# Build the Conan packages for the UE4Capture dependencies\nRUN ue4 conan build MediaIPC-ue4\n\n# Patch the problematic UE4 header files under 4.19.x (this call is a no-op under newer Engine versions)\nRUN python3 /home/ue4/UE4Capture/scripts/patch-headers.py\n\n# Enable PulseAudio support\nUSER root\nRUN apt-get install -y --no-install-recommends pulseaudio-utils && rm -rf /var/lib/apt/lists/*;\nCOPY pulseaudio-client.conf /etc/pulse/client.conf\n\n# Enable X11 support\nUSER root\nRUN apt-get install -y --no-install-recommends \\\n\tlibfontconfig1 \\\n\tlibfreetype6 \\\n\tlibglu1 \\\n\tlibsm6 \\\n\tlibxcomposite1 \\\n\tlibxcursor1 \\\n\tlibxi6 \\\n\tlibxrandr2 \\\n\tlibxrender1 \\\n\tlibxss1 \\\n\tlibxv1 \\\n\tx11-xkb-utils \\\n\txauth \\\n\txfonts-base \\\n\txkb-data && rm -rf /var/lib/apt/lists/*;\nUSER ue4\n"
}