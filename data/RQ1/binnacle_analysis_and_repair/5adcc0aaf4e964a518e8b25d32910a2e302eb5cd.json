{
  "startTime": 1674235100990,
  "endTime": 1674235101220,
  "originalSmells": [
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 54,
        "lineEnd": 54,
        "columnStart": 4,
        "columnEnd": 24
      }
    },
    {
      "rule": "tarSomethingRmTheSomething",
      "position": {
        "lineStart": 30,
        "lineEnd": 30,
        "columnStart": 4,
        "columnEnd": 24
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 3,
        "lineEnd": 6,
        "columnStart": 22,
        "columnEnd": 56
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 3,
        "lineEnd": 6,
        "columnStart": 22,
        "columnEnd": 56
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "FROM continuumio/anaconda2\nMAINTAINER Kael Dai <kaeld@alleninstitute.org>\n\nRUN apt-get update && apt-get install --no-install-recommends -y automake \\\n                                         libtool \\\n                                         build-essential \\\n                                         libncurses5-dev && rm -rf /var/lib/apt/lists/*;\n\nENV BUILD_DIR=/home/build\nENV HOME_DIR=/home/shared\nENV WORK_DIR=${HOME_DIR}/workspace\n\nRUN mkdir -p ${BUILD_DIR}\nRUN mkdir -p ${HOME_DIR}\nRUN mkdir -p ${WORK_DIR}\n\nRUN conda install -y numpy h5py lxml pandas matplotlib jsonschema scipy mpi4py cmake\n\n# Install NEURON for BioNet\nRUN conda install -y -c kaeldai neuron\n\n\n### Install NEST for PointNet\nENV NEST_VER=2.12.0\nENV NEST_INSTALL_DIR=${BUILD_DIR}/nest/build\nENV PYTHON_ENV=python2.7\n\nRUN cd ${BUILD_DIR} \\\n    conda install -y gsl; \\\n    wget --quiet https://github.com/nest/nest-simulator/releases/download/v${NEST_VER}/nest-${NEST_VER}.tar.gz -O nest.tar.gz; \\\n    tar xfz nest.tar.gz; rm nest.tar.gz \\\n    cd nest-${NEST_VER}; \\\n    mkdir build && cd build; \\\n    cmake -DCMAKE_INSTALL_PREFIX=${NEST_INSTALL_DIR} -Dwith-mpi=ON -Dwith-gsl=ON -Dwith-python=ON -Dwith-ltdl=ON ..; \\\n    make; \\\n    make install\n\n# Taken from /home/shared/nest/bin/nest_vars.sh, needed to run nest and pynest in jupyter\nENV NEST_DATA_DIR=${NEST_INSTALL_DIR}/share/nest\nENV NEST_DOC_DIR=${NEST_INSTALL_DIR}/share/doc/nest\nENV NEST_MODULE_PATH=${NEST_INSTALL_DIR}/lib/nest\nENV NEST_PYTHON_PREFIX=${NEST_INSTALL_DIR}/lib/${PYTHON_ENV}/site-packages\nENV PYTHONPATH=${NEST_PYTHON_PREFIX}:${PYTHONPATH}\nENV PATH=${NEST_INSTALL_DIR}/bin:${PATH}\n\n\n### Install DiPDE for PopNet\nRUN conda install -y -c nicholasc dipde\n\n\n### Install Tensorflow for MintNet\nRUN conda install -y tensorflow\n\n### Install AllenSDK (Not used by bmtk, but used by some notebooks to fetch cell-types files)\nRUN pip install --no-cache-dir allensdk\n\n\n### Install the bmtk\nRUN cd ${BUILD_DIR}; \\\n    git clone https://github.com/AllenInstitute/bmtk.git; \\\n    cd bmtk; \\\n    python setup.py install\n\n# Setup the examples and tutorials\nRUN cd ${BUILD_DIR}/bmtk/docs; \\\n    cp -R examples ${HOME_DIR}; \\\n    cp -R tutorial ${HOME_DIR}\n\n# Setup components directories for tutorials, including compiling neuron modfiles\nRUN cd ${HOME_DIR}/tutorial; \\\n    cp -R ../examples/*_components .; \\\n    cd biophys_components/mechanisms; \\\n    nrnivmodl modfiles/\n\n# Pre-compile mechanisms for BioNet examples\nRUN cd ${HOME_DIR}/examples/biophys_components/mechanisms; \\\n    nrnivmodl modfiles/\n\n\n# Create an entry point for running the image\nCOPY entry_script.sh ${BUILD_DIR}\nRUN chmod +x ${BUILD_DIR}/entry_script.sh\n\nENTRYPOINT [\"/home/build/entry_script.sh\"]\n"
}