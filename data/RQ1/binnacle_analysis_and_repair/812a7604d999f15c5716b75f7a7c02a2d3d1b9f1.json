{
  "startTime": 1674241191124,
  "endTime": 1674241192344,
  "originalSmells": [
    {
      "rule": "wgetUseHttpsUrl",
      "position": {
        "lineStart": 68,
        "lineEnd": 68,
        "columnStart": 4,
        "columnEnd": 128
      }
    },
    {
      "rule": "wgetUseHttpsUrl",
      "position": {
        "lineStart": 90,
        "lineEnd": 90,
        "columnStart": 4,
        "columnEnd": 132
      }
    },
    {
      "rule": "wgetUseHttpsUrl",
      "position": {
        "lineStart": 161,
        "lineEnd": 161,
        "columnStart": 4,
        "columnEnd": 108
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 114,
        "lineEnd": 114,
        "columnStart": 4,
        "columnEnd": 40
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 115,
        "lineEnd": 115,
        "columnStart": 4,
        "columnEnd": 103
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 116,
        "lineEnd": 116,
        "columnStart": 4,
        "columnEnd": 34
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 117,
        "lineEnd": 117,
        "columnStart": 4,
        "columnEnd": 110
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 119,
        "lineEnd": 119,
        "columnStart": 4,
        "columnEnd": 47
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 139,
        "lineEnd": 139,
        "columnStart": 4,
        "columnEnd": 49
      }
    },
    {
      "rule": "tarSomethingRmTheSomething",
      "position": {
        "lineStart": 12,
        "lineEnd": 12,
        "columnStart": 4,
        "columnEnd": 45
      }
    },
    {
      "rule": "tarSomethingRmTheSomething",
      "position": {
        "lineStart": 19,
        "lineEnd": 19,
        "columnStart": 4,
        "columnEnd": 48
      }
    },
    {
      "rule": "tarSomethingRmTheSomething",
      "position": {
        "lineStart": 38,
        "lineEnd": 38,
        "columnStart": 4,
        "columnEnd": 52
      }
    },
    {
      "rule": "tarSomethingRmTheSomething",
      "position": {
        "lineStart": 52,
        "lineEnd": 52,
        "columnStart": 4,
        "columnEnd": 69
      }
    },
    {
      "rule": "tarSomethingRmTheSomething",
      "position": {
        "lineStart": 100,
        "lineEnd": 100,
        "columnStart": 4,
        "columnEnd": 122
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 23,
        "lineEnd": 24,
        "columnStart": 27,
        "columnEnd": 67
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 28,
        "lineEnd": 28,
        "columnStart": 27,
        "columnEnd": 83
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 48,
        "lineEnd": 48,
        "columnStart": 27,
        "columnEnd": 80
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 80,
        "lineEnd": 84,
        "columnStart": 27,
        "columnEnd": 19
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 93,
        "lineEnd": 93,
        "columnStart": 27,
        "columnEnd": 92
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 98,
        "lineEnd": 98,
        "columnStart": 27,
        "columnEnd": 86
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 112,
        "lineEnd": 113,
        "columnStart": 27,
        "columnEnd": 95
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 163,
        "lineEnd": 165,
        "columnStart": 27,
        "columnEnd": 73
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 196,
        "lineEnd": 197,
        "columnStart": 27,
        "columnEnd": 27
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 208,
        "lineEnd": 209,
        "columnStart": 27,
        "columnEnd": 34
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 23,
        "lineEnd": 24,
        "columnStart": 27,
        "columnEnd": 67
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 28,
        "lineEnd": 28,
        "columnStart": 27,
        "columnEnd": 83
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 48,
        "lineEnd": 48,
        "columnStart": 27,
        "columnEnd": 80
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 80,
        "lineEnd": 84,
        "columnStart": 27,
        "columnEnd": 19
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 93,
        "lineEnd": 93,
        "columnStart": 27,
        "columnEnd": 92
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 98,
        "lineEnd": 98,
        "columnStart": 27,
        "columnEnd": 86
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 112,
        "lineEnd": 113,
        "columnStart": 27,
        "columnEnd": 95
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 163,
        "lineEnd": 165,
        "columnStart": 27,
        "columnEnd": 73
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 196,
        "lineEnd": 197,
        "columnStart": 27,
        "columnEnd": 27
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 208,
        "lineEnd": 209,
        "columnStart": 27,
        "columnEnd": 34
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "FROM ubuntu:16.04\nMAINTAINER dreamcat4 <dreamcat4@gmail.com>\n\n\nENV _clean=\"rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/*\"\nENV _apt_clean=\"eval apt-get clean && $_clean\"\n# apt-get clean -y && apt-get autoclean -y && apt-get autoremove -y\n\n\n# Install s6-overlay\nENV s6_overlay_version=\"1.17.1.1\"\nADD https://github.com/just-containers/s6-overlay/releases/download/v${s6_overlay_version}/s6-overlay-amd64.tar.gz /tmp/\nRUN tar zxf /tmp/s6-overlay-amd64.tar.gz -C / && $_clean && rm /tmp/s6-overlay-amd64.tar.gz\nENV S6_LOGGING=\"1\"\n# ENV S6_KILL_GRACETIME=\"3000\"\n\n\n# Install pipework\nADD https://github.com/jpetazzo/pipework/archive/master.tar.gz /tmp/pipework-master.tar.gz\nRUN tar -zxf /tmp/pipework-master.tar.gz -C /tmp && cp /tmp/pipework-master/pipework /sbin/ && $_clean && rm /tmp/pipework-master.tar.gz\n\n\n# Install support pkgs\nRUN apt-get update -qqy && DEBIAN_FRONTEND=noninteractive apt-get --no-install-recommends install -y \\\n    wget apt-transport-https ca-certificates nano less man git sudo && $_apt_clean && rm -rf /var/lib/apt/lists/*;\n\n\n# Install ngircd\nRUN apt-get update -qqy && DEBIAN_FRONTEND=noninteractive apt-get --no-install-recommends install -y ngircd && $_apt_clean && rm -rf /var/lib/apt/lists/*;\n\n# Setup ngircd user\nRUN groupadd -o -g 5914 ngircd \\\n && useradd -o -u 5914 -g ngircd --shell /bin/bash -d /config/ngircd ngircd \\\n && install -o ngircd -g ngircd -d /config/ngircd\n\n\n# Install atheme\nRUN wget -O /tmp/atheme.tar.gz https://dl.bintray.com/dreamcat4/linux/atheme/atheme-latest_linux-x86_64.tar.gz \\\n && tar zxf /tmp/atheme.tar.gz -C / --skip-old-files && $_clean && rm /tmp/atheme.tar.gz\n\n# Setup atheme user\nRUN groupadd -o -g 8153 atheme \\\n && useradd -o -u 8153 -g atheme --shell /bin/bash -d /config/atheme atheme \\\n && install -o atheme -g atheme -d /config/atheme\n\n\n\n# Install znc\nRUN apt-get update -qqy && DEBIAN_FRONTEND=noninteractive apt-get --no-install-recommends install -y znc && $_apt_clean && rm -rf /var/lib/apt/lists/*;\n\n# Install external znc-modules\nRUN wget -O /tmp/znc-modules.tar.gz https://dl.bintray.com/dreamcat4/linux/znc-modules/znc-modules-latest_linux-x86_64.tar.gz \\\n && tar zxf /tmp/znc-modules.tar.gz -C /usr/lib/znc/ --skip-old-files && $_clean && rm /tmp/znc-modules.tar.gz\n\n# Install 'search' helper script, to search znc logs\nADD znc-shell-search /usr/local/bin/search\nRUN chmod +x /usr/local/bin/search\n\n# Setup znc user\nRUN groupadd -o -g 6697 znc \\\n && useradd -o -u 6697 -g znc --shell /bin/bash -d /config/znc znc \\\n && install -o znc -g znc -d /config/znc\n\n\n\n# Install bitlbee\n\n# Hack, install older version of libgnutls to meet bitlbee-libpurple dependancy on wily 15.10 - old bitlebee repo target\nRUN wget -O /tmp/libgnutls-deb0-28_amd64.deb https://launchpadlibrarian.net/234823129/libgnutls-deb0-28_3.3.20-1ubuntu1_amd64.deb && dpkg -i /tmp/libgnutls-deb0-28_amd64.deb \\\n && $_apt_clean\n\nRUN wget -O- https://code.bitlbee.org/debian/release.key | apt-key add - \\\n && echo \"deb http://code.bitlbee.org/debian/master/wily/amd64/ ./\" >> /etc/apt/sources.list \\\n && wget -O- https://jgeboski.github.io/obs.key | apt-key add - \\\n && echo \"deb http://download.opensuse.org/repositories/home:/jgeboski/xUbuntu_16.04 ./\" >> /etc/apt/sources.list \\\n && apt-key adv --keyserver keyserver.ubuntu.com --recv-keys C03AA79CFFEBD240 \\\n && echo \"deb http://ppa.launchpad.net/aap/pidgin/ubuntu xenial main\" >> /etc/apt/sources.list \\\n && apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 531EE72F4C9D234C \\\n && echo \"deb http://ppa.launchpad.net/nilarimogard/webupd8/ubuntu xenial main\" >> /etc/apt/sources.list \\\n \\\n && apt-get update -qqy && DEBIAN_FRONTEND=noninteractive apt-get --no-install-recommends install -y rsyslog \\\n    bitlbee-libpurple bitlbee-plugin-otr \\\n    bitlbee-steam bitlbee-facebook \\\n    pidgin-sipe pidgin-skypeweb \\\n    telegram-purple \\\n\n && $_apt_clean && rm -rf /var/lib/apt/lists/*;\n\n# Hack, install older version of libprotobuf to meet dependancies\n# This whatsapp-purple PPA needs newer ubuntu version as trusty 14.04 too old now\nRUN wget -O /tmp/libprotobuf8_amd64.deb https://security.ubuntu.com/ubuntu/pool/main/p/protobuf/libprotobuf8_2.5.0-9ubuntu1_amd64.deb && dpkg -i /tmp/libprotobuf8_amd64.deb \\\n && apt-key adv --keyserver keyserver.ubuntu.com --recv-keys C777F0E392FAE28B \\\n && echo \"deb http://ppa.launchpad.net/whatsapp-purple/ppa/ubuntu trusty main\" >> /etc/apt/sources.list \\\n && apt-get update -qqy && DEBIAN_FRONTEND=noninteractive apt-get --no-install-recommends install -y pidgin-whatsapp \\\n && $_apt_clean && rm -rf /var/lib/apt/lists/*;\n\n# Bitlbee - libpurpletorchat\nENV _torchat_ver=\"2.0-alpha-14\"\nRUN apt-get update -qqy && DEBIAN_FRONTEND=noninteractive apt-get --no-install-recommends install -y tor bzip2 \\\n && wget -O /tmp/libpurpletorchat.tar.bz2 https://github.com/downloads/prof7bit/TorChat/libpurpletorchat-${_torchat_ver}-linux-x86-64.tar.bz2 \\\n && tar -C /usr/lib/purple-2 --strip-components=1 -jxvf /tmp/libpurpletorchat.tar.bz2 libpurpletorchat/libpurpletorchat.so && $_apt_clean && rm /tmp/libpurpletorchat.tar.bz2 && rm -rf /var/lib/apt/lists/*;\n\n# TODO: Future (not ready yet) - tox-prpl - https://github.com/jin-eld/tox-prpl/issues/54\n\n# Setup bitlbee user\nRUN groupmod -o -g 6111 bitlbee \\\n && usermod -o -u 6111 -g bitlbee --shell /bin/bash -d /config/bitlbee bitlbee \\\n && install -o bitlbee -g bitlbee -d /config/bitlbee\n\n\n\n# Install limnoria (aka supybot)\nRUN apt-get update -qqy && DEBIAN_FRONTEND=noninteractive apt-get --no-install-recommends install -y \\\n    python-dev python-pip pkg-config graphviz graphviz-dev libxml2-dev libxslt1-dev python-cobe \\\n && pip install --no-cache-dir --upgrade pip setuptools \\\n && pip install --no-cache-dir -r https://raw.githubusercontent.com/ProgVal/Limnoria/master/requirements.txt --upgrade \\\n && pip install --no-cache-dir limnoria --upgrade && chmod +x /usr/local/bin/supybot* \\\n && pip install --no-cache-dir -r https://raw.githubusercontent.com/ProgVal/Supybot-plugins/master/requirements.txt --upgrade \\\n && wget -q -O- https://raw.githubusercontent.com/GLolol/SupyPlugins/master/requirements.txt | grep -v \"Limnoria.git\" > /tmp/glol.reqs.txt \\\n && pip install --no-cache-dir -r /tmp/glol.reqs.txt --upgrade && rm /tmp/glol.reqs.txt \\\n\n && $_apt_clean && rm -rf /var/lib/apt/lists/*;\n\n# NOTE: overlayfs bug causes pip dependancies install failure below ^^;\n#   https://github.com/docker/docker/issues/12327#issuecomment-171496303\n#   https://gist.github.com/amercader/4432ed33a73d510b4a08\n#\n# Using patch / feature branch with Frog's rejected PIP pr ! didnt work\n# RUN apt-get update && apt-get install -y python-dev python-pip && pip install --upgrade pip \\\n#  && pip install git+https://github.com/FragLegs/pip@patch-for-issue-2953 && $_apt_clean\n\n# Spline plugins with broken deps: \"Stock Tweety WebHooks WorldTime\"\n# ENV _spline_plugins=\"GitPull LogTail Series Stock Supybot-Pastebin Travis Tweety UrbanDictionary Weather WebHooks WolframAlpha WorldTime ZNC\"\nENV _spline_plugins=\"GitPull LogTail Series Supybot-Pastebin Travis UrbanDictionary Weather WebHooks WolframAlpha ZNC\"\n\nRUN mkdir -p limnoria-plugins/spline \\\n && for _spline_plugin in $_spline_plugins; \\\n do wget -q -O- https://raw.githubusercontent.com/reticulatingspline/${_spline_plugin}/master/requirements.txt | grep -v \"Limnoria.git\" > /tmp/spline.reqs.txt || break ; \\\n    echo \"processing deps for \\\"reticulatingspline/${_spline_plugin}\\\":\" && cat /tmp/spline.reqs.txt && echo \\\n && pip install --no-cache-dir -r /tmp/spline.reqs.txt --upgrade && rm /tmp/spline.reqs.txt && echo \\\n  ; done \\\n\n && for _spline_plugin in $_spline_plugins; \\\n do git clone https://github.com/reticulatingspline/${_spline_plugin} limnoria-plugins/spline/${_spline_plugin} \\\n  ; done \\\n && $_apt_clean\n\nRUN mkdir -p limnoria-plugins \\\n && git clone https://github.com/ProgVal/Supybot-plugins limnoria-plugins/progval \\\n && git clone https://github.com/GLolol/SupyPlugins limnoria-plugins/glolol\n\nRUN echo Checking limnoria was installed && ls -lsa /usr/local/bin/supybot\n\n# Setup limnoria user\nRUN groupadd -o -g 1135 limnoria \\\n && useradd -o -u 1135 -g limnoria --shell /bin/bash -d /config/limnoria limnoria \\\n && install -o limnoria -g limnoria -d /config/limnoria\n\n\n\n# Install irssi from nei's irssi-test repo, on opensuse\nRUN wget -O- https://download.opensuse.org/repositories/home:ailin_nemui:irssi-test/xUbuntu_16.04/Release.key | apt-key add - \\\n && echo \"deb http://download.opensuse.org/repositories/home:/ailin_nemui:/irssi-test/xUbuntu_16.04/ /\" >> /etc/apt/sources.list \\\n && apt-get update -qqy && DEBIAN_FRONTEND=noninteractive apt-get --no-install-recommends install -y \\\n    libtime-duration-perl libwww-perl libnotify-bin libmime-base64-urlsafe-perl \\\n    irssi make cpanminus irssi-scripts irssi-plugin-otr irssi-plugin-xmpp \\\n && cpanm WebService::HipChat Algorithm::Diff \\\n && $_apt_clean && rm -rf /var/lib/apt/lists/*;\n\n# # Install irssi from official ubuntu apt repo\n# RUN apt-get update -qqy && DEBIAN_FRONTEND=noninteractive apt-get install -y \\\n#     libtime-duration-perl libwww-perl libnotify-bin libmime-base64-urlsafe-perl \\\n#     irssi make cpanminus irssi-scripts irssi-plugin-otr irssi-plugin-xmpp \\\n#  && cpanm WebService::HipChat Algorithm::Diff \\\n#  && $_apt_clean\n\n# For irssi / adv_windowlist.pl:\n # && cpanm Text::CharWidth \\\n\n\n# Irssi - Download scripts and themes\nRUN git clone https://github.com/irssi/scripts.irssi.org.git \\\n && git clone https://github.com/irssi-import/themes.git \\\n && git clone https://github.com/huyz/irssi-colors-solarized\n\n# Setup irssi user\nRUN groupadd -o -g 1455 irssi \\\n && useradd -o -u 1455 -g irssi --shell /bin/bash -d /config/irssi irssi \\\n && install -o irssi -g irssi -d /config/irssi\n\n\n\n# Install weechat\nRUN apt-key adv --keyserver keyserver.ubuntu.com --recv-keys D1820DB22A11534E \\\n && echo \"deb https://weechat.org/ubuntu xenial main\" >> /etc/apt/sources.list \\\n \\\n && apt-get update -qqy && DEBIAN_FRONTEND=noninteractive apt-get --no-install-recommends install -y \\\n    weechat weechat-plugins \\\n\n && $_apt_clean && rm -rf /var/lib/apt/lists/*;\n\n# Setup weechat user\nRUN groupadd -o -g 3333 weechat \\\n && useradd -o -u 3333 -g weechat --shell /bin/bash -d /config/weechat weechat \\\n && install -o weechat -g weechat -d /config/weechat\n\n\n# Install tmux, sshd and other supportive pkgs\nRUN apt-get update -qqy && DEBIAN_FRONTEND=noninteractive apt-get --no-install-recommends install -y \\\n    tmux openssh-server socat nmap \\\n && $_apt_clean && rm -rf /var/lib/apt/lists/*;\n\n\n# Set default TERM and EDITOR\nENV TERM=tmux-256color TERMINFO=/etc/terminfo EDITOR=nano\n\n\n# Setup sshd for irssi\nENV tmux_socket_irssi=\"/tmp/tmux.irssi.sock\" tmux_session_irssi=\"irssi\"\nENV tmux_socket_weechat=\"/tmp/tmux.weechat.sock\" tmux_session_weechat=\"weechat\"\nRUN mkdir -p /var/run/sshd \\\n && echo \"\\n\\n\\\n# Container specific sshd settings\\n\\\nPasswordAuthentication no\\n\\\n\\n\\\nMatch User irssi\\n\\\n        ForceCommand tmux -S $tmux_socket_irssi -u attach-session -t $tmux_session_irssi\\n\\\nMatch User weechat\\n\\\n        ForceCommand tmux -S $tmux_socket_weechat -u attach-session -t $tmux_session_weechat\\n\\\n\\n\" >> /etc/ssh/sshd_config\n\n\n\n\n# Copy configuration files\nADD config.default /etc/config.preseed\nADD config.custom  /etc/config.preseed\n\n\n# Start scripts\nENV S6_LOGGING=\"0\"\nADD services.d /etc/services.d\n\n\n# let irssi and weechat users sudo without password\nRUN echo \"irssi ALL=(ALL) NOPASSWD: ALL\" >> /etc/sudoers\nRUN echo \"weechat ALL=(ALL) NOPASSWD: ALL\" >> /etc/sudoers\n\n\n# Default container settings\nRUN echo Regenerating apt cache && apt-get update -qqy\nVOLUME /config /irc\nEXPOSE 6697 22 9001\nENTRYPOINT [\"/init\"]\n\n\n\n\n\n"
}