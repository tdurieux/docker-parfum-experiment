{
  "startTime": 1674252393732,
  "endTime": 1674252393899,
  "originalSmells": [
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 27,
        "lineEnd": 27,
        "columnStart": 4,
        "columnEnd": 72
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 27,
        "lineEnd": 27,
        "columnStart": 4,
        "columnEnd": 72
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 13,
        "lineEnd": 14,
        "columnStart": 4,
        "columnEnd": 104
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 27,
        "lineEnd": 27,
        "columnStart": 4,
        "columnEnd": 72
      }
    }
  ],
  "repairedSmells": [
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 27,
        "lineEnd": 27,
        "columnStart": 4,
        "columnEnd": 96
      }
    }
  ],
  "repairedDockerfile": "FROM php:7.0.31-fpm-stretch\nLABEL Description=\"Esta imagen sirve para la configuración de php-fpm para moodle\" Version=\"1.0\"\n\nARG DOCUMENT_ROOT=/var/www/html\nARG MY_TZ=America/Costa_Rica\n\nENV WEB_DOCUMENT_ROOT=$DOCUMENT_ROOT\nENV WEB_MY_TZ=${MY_TZ}\n\n# PHP\nRUN apt-get update && \\\n    pecl install xdebug && \\\n    # https://docs.moodle.org/35/en/PHP \\\n    apt-get install -y --no-install-recommends libxml2-dev zlib1g-dev libpng-dev \\\n        libfreetype6-dev libjpeg62-turbo-dev libicu-dev libpspell-dev libpq-dev libldap2-dev libxslt-dev && \\\n    docker-php-ext-configure gd --with-gd --with-freetype-dir=/usr/include/ \\\n        --with-jpeg-dir=/usr/include/ --with-png-dir=/usr/include/ && \\\n    docker-php-ext-install gd && \\\n    docker-php-ext-configure xmlrpc --with-libxml-dir=/usr/include/ && \\\n    docker-php-ext-install xmlrpc && \\\n    docker-php-ext-configure ldap --with-libdir=lib/x86_64-linux-gnu && \\\n    docker-php-ext-install ldap && \\\n    # Ya están instalados curl iconv mbstring openssl tokenizer ctype simplexml spl pcre dom xml json  \\\n    docker-php-ext-install soap zip intl pspell pgsql xsl && \\\n    docker-php-ext-configure opcache --enable-opcache && docker-php-ext-install opcache && rm -rf /var/lib/apt/lists/*;\n\n# Adicionales\nRUN apt-get install --no-install-recommends -y graphviz clamav clamav-daemon zip unzip aspell-es && rm -rf /var/lib/apt/lists/*;\n\n# Config\nCOPY php-fpm/conf/custom-php.ini /usr/local/etc/php/conf.d/php.ini\nCOPY php-fpm/conf/custom-xdebug.ini /usr/local/etc/php/conf.d/xdebug.ini\nCOPY php-fpm/conf/custom-opcache.ini /usr/local/etc/php/conf.d/opcache.ini\nCOPY php-fpm/conf/php-fpm-xdebug-entrypoint.sh /usr/local/bin/php-fpm-xdebug-entrypoint\n\n# TZ\nRUN echo \"${WEB_MY_TZ}\" > /etc/timezone && \\\n    dpkg-reconfigure -f noninteractive tzdata && \\\n    sed -i  \"s@MY_TZ_WILL_BE_REPLACE@${WEB_MY_TZ}@\" /usr/local/etc/php/conf.d/xdebug.ini\n\n# Limpieza\nRUN apt-get clean && \\\n    rm -r /var/lib/apt/lists/* && \\\n    rm -r /var/cache/apt/*\n\n# Propiedad\nRUN usermod -u 1000 www-data\n\nWORKDIR ${WEB_DOCUMENT_ROOT}\n\nEXPOSE 9000\n\nENTRYPOINT [\"php-fpm-xdebug-entrypoint\"]\n\nCMD [\"php-fpm\"]\n"
}