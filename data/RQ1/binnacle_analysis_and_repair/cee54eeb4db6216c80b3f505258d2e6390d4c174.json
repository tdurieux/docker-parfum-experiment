{
  "startTime": 1674235013618,
  "endTime": 1674235013721,
  "originalSmells": [
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 6,
        "lineEnd": 6,
        "columnStart": 4,
        "columnEnd": 62
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 6,
        "lineEnd": 6,
        "columnStart": 4,
        "columnEnd": 62
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 6,
        "lineEnd": 6,
        "columnStart": 4,
        "columnEnd": 62
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "FROM ubuntu:14.04\nENV ARCH amd64\nENV DIST trusty\nENV MIRROR ftp://ftp.ubuntu.com\n\nRUN apt-get -q update && apt-get -qy --no-install-recommends install dnsmasq wget iptables nginx apt-cacher && rm -rf /var/lib/apt/lists/*;\nADD apt-cacher.conf /etc/apt-cacher/apt-cacher.conf\nADD apt-cacher /etc/default/apt-cacher\n#RUN wget --no-check-certificate https://raw.github.com/jpetazzo/pipework/master/pipework\nADD pipework /pipework\nRUN chmod +x pipework\nADD logs.sh /logs.sh\nRUN chmod +x /logs.sh\nRUN mkdir /tftp\n#WORKDIR /usr/share/nginx/html\n#RUN wget --no-check-certificate https://raw.githubusercontent.com/realbazso/docker-ubuntu-pxe/master/ks.cfg\n#ADD ks.cfg /usr/share/nginx/html/ks.cfg\nWORKDIR /tftp\n\nRUN wget $MIRROR/ubuntu/dists/$DIST/main/installer-$ARCH/current/images/netboot/ubuntu-installer/$ARCH/linux\nRUN wget $MIRROR/ubuntu/dists/$DIST/main/installer-$ARCH/current/images/netboot/ubuntu-installer/$ARCH/initrd.gz\nRUN wget $MIRROR/ubuntu/dists/$DIST/main/installer-$ARCH/current/images/netboot/ubuntu-installer/$ARCH/pxelinux.0\n\nRUN mkdir pxelinux.cfg\nRUN printf \"DEFAULT linux\\nKERNEL linux biosdevname=0\\nAPPEND http_proxy=\"http://10.42.42.4:3142\" initrd=initrd.gz ks=http://10.42.42.4/ks.cfg\\n\" >pxelinux.cfg/default\nCMD \\\n    echo Setting up iptables... &&\\\n    iptables -t nat -A POSTROUTING -j MASQUERADE &&\\\n    echo Waiting for pipework to give us the eth1 interface... &&\\\n    /pipework --wait &&\\\n    /etc/init.d/nginx start &&\\\n    /etc/init.d/apt-cacher start &&\\\n    /logs.sh /var/log/apt-cacher &&\\\n    echo Starting DHCP+TFTP server...&&\\\n    dnsmasq --interface=eth1 \\\n    \t    --dhcp-range=10.42.42.100,10.42.42.200,255.255.255.0,1h \\\n\t    --dhcp-boot=pxelinux.0,pxeserver,10.42.42.4 \\\n\t    --pxe-service=x86PC,\"Install Linux\",pxelinux \\\n\t    --enable-tftp --tftp-root=/tftp/ --no-daemon\n# Let's be honest: I don't know if the --pxe-service option is necessary.\n# The iPXE loader in QEMU boots without it.  But I know how some PXE ROMs\n# can be picky, so I decided to leave it, since it shouldn't hurt.\n"
}