{
  "startTime": 1674243600798,
  "endTime": 1674243600953,
  "originalSmells": [
    {
      "rule": "mkdirUsrSrcThenRemove",
      "position": {
        "lineStart": 71,
        "lineEnd": 71,
        "columnStart": 1,
        "columnEnd": 28
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "FROM php:%%PHP_VERSION%%-%%VARIANT%%\n\nLABEL maintainer=\"Monogramm Maintainers <opensource at monogramm dot io>\"\n\n# Build time env var\nENV DOLI_VERSION=%%VERSION%%\n\n# Get Dolibarr\nADD https://github.com/Dolibarr/dolibarr/archive/${DOLI_VERSION}.zip /tmp/dolibarr.zip\n\n# Install the packages we need\n# Install the PHP extensions we need\n# see https://wiki.dolibarr.org/index.php/Dependencies_and_external_libraries\n# Prepare folders\n# Install Dolibarr from tag archive\nRUN set -ex; \\\n\tapk add --no-cache \\\n\t\timagemagick \\\n\t\tlibldap \\\n\t\tlibpq \\\n\t\tlibpng \\\n\t\tmysql-client \\\n\t\trsync \\\n\t\tssmtp \\\n\t\tshadow \\\n\t; \\\n\tapk add --no-cache --virtual .build-deps \\\n\t\t$PHPIZE_DEPS \\\n\t\tautoconf \\\n\t\tcurl-dev \\\n\t\tfreetype-dev \\\n\t\tgcc \\\n\t\tg++ \\\n\t\ticu-dev \\\n\t\tlibjpeg-turbo-dev \\\n\t\timagemagick-dev \\\n\t\timagemagick-libs \\\n\t\tlibmcrypt-dev \\\n\t\tlibpng-dev \\\n\t\tlibtool \\\n\t\tlibxml2-dev \\\n\t\tmake \\\n\t\topenldap-dev \\\n\t\tpostgresql-dev \\\n\t\tpostgresql-libs \\\n\t\tunzip \\\n\t; \\\n\tdocker-php-ext-configure ldap; \\\n\tdocker-php-ext-configure gd --with-freetype-dir=/usr --with-png-dir=/usr --with-jpeg-dir=/usr; \\\n\tdocker-php-ext-install \\\n\t\tcalendar \\\n\t\tgd \\\n\t\tldap \\\n\t\tmbstring \\\n\t\tmysqli \\\n\t\tpdo \\\n\t\tpdo_mysql \\\n\t\tpdo_pgsql \\\n\t\tpgsql \\\n\t\tsoap \\\n\t\tzip \\\n\t; \\\n    pecl install imagick; \\\n    docker-php-ext-enable imagick; \\\n\tapk --purge del .build-deps; \\\n    mkdir -p /var/www/documents; \\\n    chown -R www-data:root /var/www; \\\n    chmod -R g=u /var/www; \\\n    mkdir -p /tmp/dolibarr; \\\n\tunzip -q /tmp/dolibarr.zip -d /tmp/dolibarr; \\\n\trm /tmp/dolibarr.zip; \\\n\tmkdir -p /usr/src/dolibarr; rm -rf /usr/src/dolibarr \\\n\tcp -r /tmp/dolibarr/dolibarr-${DOLI_VERSION}/* /usr/src/dolibarr; \\\n\trm -rf /tmp/dolibarr; \\\n\tchmod +x /usr/src/dolibarr/scripts/*\n\n# Runtime env var\nENV DOLI_AUTO_CONFIGURE=1 \\\n\tDOLI_DB_TYPE=mysqli \\\n\tDOLI_DB_HOST= \\\n\tDOLI_DB_PORT=3306 \\\n\tDOLI_DB_USER=dolibarr \\\n\tDOLI_DB_PASSWORD='' \\\n\tDOLI_DB_NAME=dolibarr \\\n\tDOLI_DB_PREFIX=llx_ \\\n\tDOLI_DB_CHARACTER_SET=utf8 \\\n\tDOLI_DB_COLLATION=utf8_unicode_ci \\\n\tDOLI_DB_ROOT_LOGIN='' \\\n\tDOLI_DB_ROOT_PASSWORD='' \\\n\tDOLI_ADMIN_LOGIN=admin \\\n\tDOLI_MODULES='' \\\n\tDOLI_URL_ROOT='http://localhost' \\\n\tDOLI_AUTH=dolibarr \\\n\tDOLI_LDAP_HOST= \\\n\tDOLI_LDAP_PORT=389 \\\n\tDOLI_LDAP_VERSION=3 \\\n\tDOLI_LDAP_SERVERTYPE=openldap \\\n\tDOLI_LDAP_LOGIN_ATTRIBUTE=uid \\\n\tDOLI_LDAP_DN='' \\\n\tDOLI_LDAP_FILTER='' \\\n\tDOLI_LDAP_ADMIN_LOGIN='' \\\n\tDOLI_LDAP_ADMIN_PASS='' \\\n\tDOLI_LDAP_DEBUG=false \\\n\tDOLI_HTTPS=0 \\\n\tDOLI_PROD=0 \\\n\tDOLI_NO_CSRF_CHECK=0 \\\n\tWWW_USER_ID=82 \\\n\tWWW_GROUP_ID=82 \\\n\tPHP_INI_DATE_TIMEZONE='UTC' \\\n\tPHP_MEMORY_LIMIT=256M \\\n\tPHP_MAX_UPLOAD=20M \\\n\tPHP_MAX_EXECUTION_TIME=300\n\nVOLUME /var/www/html /var/www/documents /var/www/scripts\n\nCOPY entrypoint.sh /\nRUN set -ex; \\\n\tchmod 755 /entrypoint.sh\n\nENTRYPOINT [\"/entrypoint.sh\"]\nCMD [\"%%CMD%%\"]\n"
}