{
  "startTime": 1674248416525,
  "endTime": 1674248416680,
  "originalSmells": [
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 29,
        "lineEnd": 31,
        "columnStart": 22,
        "columnEnd": 56
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "# JitFromScratch docker image for remote debugging\n#\n# The image ships a prebuilt debug version of LLVM 8 and a checkout of the\n# JitFromScratch sources. By default the container will run gdbserver on a\n# build from the llvm80/jit-basics branch. Passing values for the environment\n# variables REMOTE and CHECKOUT allows to test arbitrary forks and/or revisions.\n#\n# Run remote host:\n#   $ docker build -t <image-name> /path/to/JitFromScratch/docker/debug\n#   $ docker run --cap-add=SYS_PTRACE --security-opt seccomp=unconfined --security-opt apparmor=unconfined \\\n#                -p 9999:9999 -e REMOTE=<repo> -e CHECKOUT=<commit> <image-name>\n#\n# Debug from local host:\n#   $ gdb -q\n#   $ (gdb) directory /path/to/JitFromScratch-src\n#   $ (gdb) directory /path/to/llvm-src/..\n#   $ (gdb) target remote :9999\n#   $ (gdb) b main\n#   $ (gdb) c\n#   ...\n#   Breakpoint 1, main (argc=1, argv=0x7fffffffe788) at /JitFromScratch/main.cpp:109\n#   109\tint main(int argc, char **argv) {\n#   ...\n#   $ (gdb) monitor exit\n#\nFROM ubuntu:18.04\nLABEL maintainer \"weliveindetail <stefan.graenitz@gmail.com>\"\n\n# Install tools and libs for building LLVM and JitFromScratch\nRUN apt-get update && apt-get install -y --no-install-recommends \\\n        ca-certificates build-essential git cmake cmake-data \\\n        ninja-build clang zlib1g-dev python3.6 gdbserver && rm -rf /var/lib/apt/lists/*;\n\n# Checkout and configure LLVM\nRUN git clone --depth=1 --branch=release/8.x https://github.com/llvm/llvm-project.git llvm-release80\nRUN mkdir llvm-release80-debug && \\\n    cd llvm-release80-debug && \\\n    CC=clang CXX=clang++ \\\n        cmake -GNinja -DCMAKE_BUILD_TYPE=Debug -DLLVM_TARGETS_TO_BUILD=host ../llvm-release80/llvm\n\n# Distribute libraries accross separate layers to limit the number of lost\n# artifacts if docker-build runs out of memory. The list is obtained from:\n# llvm-config --libnames core executionengine native orcjit runtimedyld support\nRUN cd llvm-release80-debug && ninja llvm-config FileCheck\nRUN cd llvm-release80-debug && ninja LLVMSupport LLVMDemangle LLVMCore LLVMBinaryFormat\nRUN cd llvm-release80-debug && ninja LLVMRuntimeDyld LLVMObject LLVMMCParser LLVMBitReader LLVMMC LLVMDebugInfoCodeView LLVMDebugInfoMSF\nRUN cd llvm-release80-debug && ninja LLVMExecutionEngine LLVMTarget LLVMAnalysis LLVMProfileData LLVMOrcJIT LLVMTransformUtils\nRUN cd llvm-release80-debug && ninja LLVMGlobalISel LLVMSelectionDAG LLVMScalarOpts LLVMInstCombine LLVMAggressiveInstCombine\nRUN cd llvm-release80-debug && ninja LLVMAsmPrinter LLVMCodeGen LLVMMCDisassembler LLVMBitWriter LLVMBinaryFormat\nRUN cd llvm-release80-debug && ninja LLVMX86AsmPrinter LLVMX86CodeGen LLVMX86Disassembler LLVMX86AsmParser LLVMX86Desc LLVMX86Info LLVMX86Utils\nRUN cd llvm-release80-debug && ninja LLVMipo LLVMInstrumentation LLVMVectorize LLVMLinker LLVMIRReader LLVMAsmParser\n\n# Checkout JitFromScratch\nRUN git clone https://github.com/weliveindetail/JitFromScratch.git jitfromscratch && \\\n    cd jitfromscratch && \\\n    git remote set-url origin --push no-pushing && \\\n    git checkout llvm80/jit-basics && \\\n    mkdir ../build\n\n# Expose port for attaching gdb. It must still be published\n# to the host by passing '-p 9999:9999' to docker-run\nEXPOSE 9999\n\n# By default: update, build and run JitFromScratch in gdbserver on startup\nCMD set -x && \\\n    cd jitfromscratch && \\\n    ([ ! \"${REMOTE+1}\" ] || git remote set-url origin \"${REMOTE}\") && \\\n    git fetch --quiet origin && \\\n    git checkout --quiet FETCH_HEAD && \\\n    ([ ! \"${CHECKOUT+1}\" ] || git checkout --quiet \"${CHECKOUT}\") && \\\n    git log -1 -s && \\\n    cd ../build && \\\n    CC=clang CXX=clang++ \\\n        cmake -GNinja -DLLVM_DIR=/llvm-release80-debug/lib/cmake/llvm ../jitfromscratch && \\\n    ninja JitFromScratch && \\\n    gdbserver :9999 JitFromScratch\n"
}