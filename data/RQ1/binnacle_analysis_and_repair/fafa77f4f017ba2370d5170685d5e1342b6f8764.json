{
  "startTime": 1674242328500,
  "endTime": 1674242328651,
  "originalSmells": [
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 8,
        "lineEnd": 8,
        "columnStart": 2,
        "columnEnd": 56
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "FROM cikl/base:0.0.2\nMAINTAINER Mike Ryan <falter@gmail.com>\n\nRUN \\\n  apt-key adv --keyserver keyserver.ubuntu.com --recv-keys C3173AA6 && \\\n  echo deb http://ppa.launchpad.net/brightbox/ruby-ng/ubuntu trusty main > /etc/apt/sources.list.d/brightbox.list && \\\n  export DEBIAN_FRONTEND=noninteractive && \\\n  apt-get update && \\\n  apt-get install --no-install-recommends -y ruby2.1 libcurl3 libxml2 libxslt1.1 && \\\n  apt-get clean && rm -rf /var/lib/apt/lists/*\n\n# Ensure that theonly thing that triggers a rebuild is modifications to the\n# Gemfile, and not anything else inside the src dir.\nADD src/Gemfile* src/VERSION /opt/cikl/scheduler/\nADD src/cikl-scheduler/cikl-scheduler.gemspec /opt/cikl/scheduler/cikl-scheduler/cikl-scheduler.gemspec\nADD src/cikl-event/cikl-event.gemspec /opt/cikl/scheduler/cikl-event/cikl-event.gemspec\nADD src/threatinator-output-cikl/threatinator-output-cikl.gemspec /opt/cikl/scheduler/threatinator-output-cikl/threatinator-output-cikl.gemspec\n\nWORKDIR /opt/cikl/scheduler\n\nENV BUNDLE_GEMFILE /opt/cikl/scheduler/Gemfile.scheduler\n\nRUN \\\n  export DEBIAN_FRONTEND=noninteractive && \\\n  buildDeps=\"gcc g++ make libc6-dev ruby2.1-dev zlib1g-dev libssl-dev patch libxml2-dev libxslt1-dev\" && \\\n  apt-get update && \\\n  apt-get install -y --no-install-recommends $buildDeps && \\\n  gem install bundler && \\\n  bundle config build.nokogiri --use-system-libraries --with-xml2-include=/usr/include/libxml2/ && \\\n  bundle install --jobs=7 && \\\n  rm /var/lib/gems/2.1.0/cache/*.gem && \\\n  apt-get remove -y --purge --auto-remove $buildDeps && \\\n  apt-get autoremove -y && \\\n  apt-get clean && rm -rf /var/lib/apt/lists/*\n\nADD docker/scheduler/scheduler-web-command.sh /etc/docker-entrypoint/commands.d/scheduler-web\nADD docker/scheduler/scheduler-worker-command.sh /etc/docker-entrypoint/commands.d/scheduler-worker\nADD docker/scheduler/scheduler-command.sh /etc/docker-entrypoint/commands.d/scheduler\nADD docker/scheduler/threatinator-run-command.sh /etc/docker-entrypoint/commands.d/threatinator-run\nADD docker/scheduler/threatinator-run-all-command.sh /etc/docker-entrypoint/commands.d/threatinator-run-all\nADD docker/scheduler/threatinator-list-command.sh /etc/docker-entrypoint/commands.d/threatinator-list\nADD docker/scheduler/scheduler-pre.sh /etc/docker-entrypoint/pre.d/scheduler.sh\n\nRUN chmod a+x /etc/docker-entrypoint/commands.d/scheduler-web \\\n              /etc/docker-entrypoint/commands.d/scheduler-worker \\\n              /etc/docker-entrypoint/commands.d/scheduler \\\n              /etc/docker-entrypoint/commands.d/threatinator-run \\\n              /etc/docker-entrypoint/commands.d/threatinator-run-all \\\n              /etc/docker-entrypoint/commands.d/threatinator-list\n\nVOLUME [ \"/data\" ]\nRUN useradd -s /bin/false -d /data -m cikl\nENV ENTRYPOINT_DROP_PRIVS 1\nENV ENTRYPOINT_USER cikl\n\nENV CIKL_RABBITMQ_URL amqp://cikl:cikl@rabbitmq/%2Fcikl\nENV SCHEDULER_REDIS_URL redis://redis/0\n\nCMD [ \"scheduler\" ]\n\nADD src/cikl-scheduler /opt/cikl/scheduler/cikl-scheduler\nADD src/cikl-event /opt/cikl/scheduler/cikl-event\nADD src/threatinator-output-cikl /opt/cikl/scheduler/threatinator-output-cikl\n\nEXPOSE 9292\n"
}