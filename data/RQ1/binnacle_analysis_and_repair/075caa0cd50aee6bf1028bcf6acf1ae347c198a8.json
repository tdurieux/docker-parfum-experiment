{
  "startTime": 1674243186272,
  "endTime": 1674243186496,
  "originalSmells": [
    {
      "rule": "npmCacheCleanAfterInstall",
      "position": {
        "lineStart": 20,
        "lineEnd": 20,
        "columnStart": 4,
        "columnEnd": 28
      }
    },
    {
      "rule": "npmCacheCleanAfterInstall",
      "position": {
        "lineStart": 34,
        "lineEnd": 34,
        "columnStart": 4,
        "columnEnd": 15
      }
    },
    {
      "rule": "npmCacheCleanAfterInstall",
      "position": {
        "lineStart": 37,
        "lineEnd": 37,
        "columnStart": 4,
        "columnEnd": 15
      }
    },
    {
      "rule": "npmCacheCleanAfterInstall",
      "position": {
        "lineStart": 40,
        "lineEnd": 40,
        "columnStart": 4,
        "columnEnd": 15
      }
    },
    {
      "rule": "npmCacheCleanAfterInstall",
      "position": {
        "lineStart": 40,
        "lineEnd": 40,
        "columnStart": 19,
        "columnEnd": 37
      }
    },
    {
      "rule": "configureShouldUseBuildFlag",
      "position": {
        "lineStart": 15,
        "lineEnd": 15,
        "columnStart": 4,
        "columnEnd": 15
      }
    },
    {
      "rule": "tarSomethingRmTheSomething",
      "position": {
        "lineStart": 13,
        "lineEnd": 13,
        "columnStart": 79,
        "columnEnd": 104
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 9,
        "lineEnd": 9,
        "columnStart": 4,
        "columnEnd": 184
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 17,
        "lineEnd": 17,
        "columnStart": 4,
        "columnEnd": 35
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 9,
        "lineEnd": 9,
        "columnStart": 4,
        "columnEnd": 184
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 17,
        "lineEnd": 17,
        "columnStart": 4,
        "columnEnd": 35
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 9,
        "lineEnd": 9,
        "columnStart": 4,
        "columnEnd": 184
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 17,
        "lineEnd": 17,
        "columnStart": 4,
        "columnEnd": 35
      }
    }
  ],
  "repairedSmells": [
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 9,
        "lineEnd": 9,
        "columnStart": 4,
        "columnEnd": 208
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 17,
        "lineEnd": 17,
        "columnStart": 4,
        "columnEnd": 59
      }
    }
  ],
  "repairedDockerfile": "# We will stick to the official Dockerfile & Version\nFROM phusion/baseimage:0.11\n\n# Update the System\nRUN apt update\nRUN apt upgrade -y\n\n# Install Node and required packages.\nRUN /usr/bin/curl -sL https://deb.nodesource.com/setup_6.x | bash -\nRUN apt-get install --no-install-recommends -y build-essential wget nodejs unzip time imagemagick optipng strace nginx git python zlib1g-dev libpcre3-dev aspell aspell-* redis-server mongodb-server npm netcat && rm -rf /var/lib/apt/lists/*;\n\n# Install QPDF dependency\nWORKDIR /opt\nRUN wget https://s3.amazonaws.com/sharelatex-random-files/qpdf-6.0.0.tar.gz && tar xzf qpdf-6.0.0.tar.gz && rm qpdf-6.0.0.tar.gz\nWORKDIR /opt/qpdf-6.0.0\nRUN ./configure --build=\"$(dpkg-architecture --query DEB_BUILD_GNU_TYPE)\" && make -j 8 && make install && ldconfig\n\nRUN apt-get install --no-install-recommends -y texlive-full && rm -rf /var/lib/apt/lists/*;\n\n# Install NPM/Grunt dependencies.\nRUN npm install -g grunt-cli && npm cache clean --force;\n\n# Clone Sharelatex\nRUN git clone https://github.com/sharelatex/sharelatex.git /sharelatex\n\n# Install Sharelatex.\nRUN npm config set user 0 && npm config set unsafe-perm true\nADD package.json /\nADD settings.development.coffee /etc/sharelatex/settings.coffee\n# ADD settings.coffee /etc/sharelatex/settings.coffee\nADD sharelatex.sh /usr/bin/sharelatex.sh\nRUN wget https://raw.githubusercontent.com/sharelatex/sharelatex-docker-image/master/git-revision.js -O /sharelatex/git-revision.js\n\nWORKDIR /\nRUN npm install && rm package.json && npm cache clean --force;\n\nWORKDIR /sharelatex\nRUN npm install && grunt install && npm cache clean --force;\n\nWORKDIR /sharelatex/web\nRUN npm install && npm install bcrypt && npm cache clean --force;\nWORKDIR /sharelatex/web/modules\nRUN git clone https://github.com/sharelatex/launchpad-web-module.git launchpad && grunt compile\n\nWORKDIR /sharelatex/clsi\nRUN grunt compile:bin\n\nWORKDIR /sharelatex\nRUN bash bin/install-services\n\n# Export\nEXPOSE 3000\nVOLUME /data\n\n# And set out entrypoint\nCMD /usr/bin/sharelatex.sh\n\n"
}