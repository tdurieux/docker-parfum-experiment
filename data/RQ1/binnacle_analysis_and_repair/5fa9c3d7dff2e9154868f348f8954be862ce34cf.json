{
  "startTime": 1674248160030,
  "endTime": 1674248160256,
  "originalSmells": [
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 19,
        "lineEnd": 19,
        "columnStart": 4,
        "columnEnd": 20
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 23,
        "lineEnd": 23,
        "columnStart": 4,
        "columnEnd": 29
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 26,
        "lineEnd": 26,
        "columnStart": 4,
        "columnEnd": 24
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 32,
        "lineEnd": 32,
        "columnStart": 4,
        "columnEnd": 38
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 37,
        "lineEnd": 37,
        "columnStart": 28,
        "columnEnd": 41
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 39,
        "lineEnd": 39,
        "columnStart": 26,
        "columnEnd": 39
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 42,
        "lineEnd": 42,
        "columnStart": 4,
        "columnEnd": 45
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 3,
        "lineEnd": 3,
        "columnStart": 25,
        "columnEnd": 61
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 5,
        "lineEnd": 11,
        "columnStart": 4,
        "columnEnd": 3
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 14,
        "lineEnd": 16,
        "columnStart": 4,
        "columnEnd": 19
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 5,
        "lineEnd": 11,
        "columnStart": 4,
        "columnEnd": 3
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 14,
        "lineEnd": 16,
        "columnStart": 4,
        "columnEnd": 19
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 3,
        "lineEnd": 3,
        "columnStart": 25,
        "columnEnd": 61
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 5,
        "lineEnd": 11,
        "columnStart": 4,
        "columnEnd": 3
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 14,
        "lineEnd": 16,
        "columnStart": 4,
        "columnEnd": 19
      }
    }
  ],
  "repairedSmells": [
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 5,
        "lineEnd": 11,
        "columnStart": 4,
        "columnEnd": 3
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 14,
        "lineEnd": 16,
        "columnStart": 4,
        "columnEnd": 19
      }
    }
  ],
  "repairedDockerfile": "FROM ubuntu:14.04 \nMAINTAINER Diffeo <support@diffeo.com> \n\nRUN apt-get update -y && apt-get install --no-install-recommends -y python python-pip && rm -rf /var/lib/apt/lists/*;\n\nRUN apt-get install --no-install-recommends -y \\\nmake libz-dev libxslt1-dev libxml2-dev python-dev \\\npython-virtualenv g++ xz-utils gfortran liblzma-dev \\\nlibpq-dev libfreetype6-dev libblas-dev liblapack-dev \\\nlibboost-python-dev libsnappy1 libsnappy-dev \\\nlibjpeg-dev zlib1g-dev libpng12-dev git \\\nssh && rm -rf /var/lib/apt/lists/*;\n\n# We could install these with `pip`, but this is so much faster. \nRUN apt-get install --no-install-recommends -y \\\npython-numpy python-scipy python-sklearn python-matplotlib \\\npython-gevent uwsgi && rm -rf /var/lib/apt/lists/*;\n\n# Download and install the NLTK corpus. \nRUN pip install --no-cache-dir nltk \\\n&& python -m nltk.downloader -d /usr/share/nltk_data all\n\n# Upgrade pip. \nRUN pip install --no-cache-dir --upgrade pip\n\n# Install psycopg2 in case we want a postgres backend. \nRUN pip install --no-cache-dir psycopg2\n\n# There is a bug in our pairwise model code that can result in passing a \n# NaN to the sklearn model training. In old versions, this causes the model \n# to raise an exception. In newer versions, it emits a warning and keeps on \n# chugging. So we upgrade! ---AG \nRUN pip install --no-cache-dir --upgrade scikit-learn\n\n# Blech. PyPI is misbehaving, so we have to check out some repos and build \n# from source. \nRUN cd /tmp && git clone git://github.com/dossier/dossier.label \\  \n&& cd /tmp/dossier.label && pip install --no-cache-dir . \\\n&& cd /tmp && git clone git://github.com/dossier/dossier.web \\\n&& cd /tmp/dossier.web && pip install --no-cache-dir .\n\n# Now install dossier.models. \nRUN pip install --no-cache-dir --pre 'dossier.models>=0.6.9'\n\nADD config.yaml /config.yaml \nADD background-50000.tfidf.gz / \nRUN gunzip /background-50000.tfidf.gz \n\nRUN rm -f /etc/service/sshd/down \nADD ssh_login.pub /tmp/ssh_login.pub \nRUN mkdir -p /root/.ssh \\  \n&& cat /tmp/ssh_login.pub >> /root/.ssh/authorized_keys \\  \n&& rm -f /tmp/ssh_login.pub \n\nADD run.sh /run.sh \nRUN chmod +x /run.sh \n\n# Finally, run the dossier.models web server. \nENV PROCESSES 4 \nEXPOSE 57312 \nCMD /run.sh uwsgi \\  \n\\--http-socket 0.0.0.0:57312 \\  \n\\--wsgi dossier.models.web.wsgi \\  \n\\--pyargv \"-c /config.yaml\" \\  \n\\--master \\  \n\\--processes $PROCESSES \\  \n\\--vacuum \\  \n\\--max-requests 5000 \n\n"
}