{
  "startTime": 1674241910902,
  "endTime": 1674241911342,
  "originalSmells": [
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 20,
        "lineEnd": 20,
        "columnStart": 4,
        "columnEnd": 27
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "FROM alpine:edge\nMAINTAINER Jermine.hu@qq.com\nENV OPENCV_DIR /opt/opencv\nENV LIBGPUARRAY_DIR /opt/libgpuarray\nENV NUM_CORES 8\nENV NB_UID 1000\nARG CLONE_TAG=1.0\nENV OPENCV_VERSION=3.4.1\nENV OPENCL_ENABLED=OFF\n\n# build and install opencv\nRUN apk add --no-cache python3 libstdc++ ffmpeg; \\\n     wget https://bootstrap.pypa.io/get-pip.py && python3 get-pip.py && rm get-pip.py ; \\\n     apk add --no-cache --virtual .build-deps \\\n     linux-headers x264 python3-dev protobuf \\\n     ca-certificates \\\n     make \\\n     cmake \\\n     g++ \\\n     unzip ; \\\n    pip3 install --no-cache-dir numpy six; \\\n    mkdir -p /src && \\\n    cd /src && \\\n    mkdir -p $OPENCV_DIR && \\\n    wget https://github.com/opencv/opencv/archive/$OPENCV_VERSION.zip && \\\n    unzip $OPENCV_VERSION.zip && \\\n    mv /src/opencv-$OPENCV_VERSION/ $OPENCV_DIR/ && \\\n    rm -rf /src/$OPENCV_VERSION.zip && \\\n    wget https://github.com/opencv/opencv_contrib/archive/$OPENCV_VERSION.zip -O $OPENCV_VERSION-contrib.zip && \\\n    unzip $OPENCV_VERSION-contrib.zip && \\\n    mv /src/opencv_contrib-$OPENCV_VERSION $OPENCV_DIR/ && \\\n    rm -rf /src/$OPENCV_VERSION-contrib.zip && \\\n    mkdir -p $OPENCV_DIR/opencv-$OPENCV_VERSION/build && \\\n    cd $OPENCV_DIR/opencv-$OPENCV_VERSION/build && \\\n   cmake \\\n    -D BUILD_opencv_xfeatures2d=OFF \\\n    -D BUILD_opencv_world=OFF \\\n    -D PYTHON_EXECUTABLE=$(which python3) \\\n    -D WITH_CUDA=OFF \\\n    -D CMAKE_BUILD_TYPE=RELEASE \\\n    -D BUILD_PYTHON_SUPPORT=ON \\\n    -D CMAKE_INSTALL_PREFIX=/usr \\\n    -D INSTALL_C_EXAMPLES=ON \\\n    -D INSTALL_PYTHON_EXAMPLES=ON \\\n    -D BUILD_PYTHON_SUPPORT=ON \\\n    -D BUILD_NEW_PYTHON_SUPPORT=ON \\\n    -D PYTHON_DEFAULT_EXECUTABLE=$(which python3) \\\n    -D PYTHON_INCLUDE_DIR=/usr/include/python3.6m \\\n    -D PYTHON_LIBRARY=/usr/lib/libpython3.6m.so \\\n    -D PYTHON3_NUMPY_INCLUDE_DIRS=/usr/lib/python3.6/site-packages/numpy/core/include \\\n    -D OPENCV_EXTRA_MODULES_PATH=$OPENCV_DIR/opencv_contrib-$OPENCV_VERSION/modules \\\n    -D WITH_TBB=ON \\\n    -D WITH_PTHREADS_PF=ON \\\n    -D WITH_OPENNI=OFF \\\n    -D WITH_OPENNI2=ON \\\n    -D WITH_EIGEN=ON \\\n    -D BUILD_DOCS=ON \\\n    -D BUILD_TESTS=ON \\\n    -D BUILD_PERF_TESTS=ON \\\n    -D BUILD_EXAMPLES=ON \\\n    -D WITH_OPENCL=$OPENCL_ENABLED \\\n    -D USE_GStreamer=ON \\\n    -D WITH_GDAL=ON \\\n    -D WITH_CSTRIPES=ON \\\n    -D ENABLE_FAST_MATH=1 \\\n    -D WITH_OPENGL=ON \\\n    -D WITH_QT=OFF \\\n    -D WITH_IPP=ON \\\n    -D WITH_FFMPEG=ON \\\n    -D WITH_V4L=ON .. && \\\n    make -j8 && \\\n    make install && \\\n    ldconfig && \\ \n    rm -r /var/cache/apk ; \\\n    rm -r /usr/share/man ; \\\n    apk del .build-deps ; \\\n    rm -rf $OPENCV_DIR ; \\\n    sleep 15 ; \\\n    ln -s /usr/local/lib/python3.6/site-packages/cv2.cpython-36m-$(uname -m)-linux-gnu.so /usr/lib/python3.6/site-packages/cv2.so\n\n"
}