{
  "startTime": 1674253023145,
  "endTime": 1674253023306,
  "originalSmells": [
    {
      "rule": "gpgUseBatchFlag",
      "position": {
        "lineStart": 76,
        "lineEnd": 76,
        "columnStart": 6,
        "columnEnd": 52
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "# #############################################\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#     http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n# #############################################\n\nFROM ubuntu:18.04\nENV OM_VER_MAJ='5'\nENV OM_VER_MIN='0'\nENV OM_VER_MIC='0-M1'\nENV OM_VERSION=\"${OM_VER_MAJ}.${OM_VER_MIN}.${OM_VER_MIC}\"\nLABEL vendor=\"Apache OpenMeetings dev team\"\nLABEL version=\"${OM_VERSION}\"\nLABEL maintainer=dev@openmeetings.apache.org\n\nARG BUILD_TYPE=\"min\"\nENV OM_TYPE=${BUILD_TYPE}\nENV DB_ROOT_PASS '12345'\nENV OM_USER=\"om_admin\"\nENV OM_PASS=\"1Q2w3e4r5t^y\"\nENV DAEMON_USER=\"nobody\"\nENV DAEMON_UID=\"65534\"\nENV OM_DB_NAME=\"openmeetings\"\nENV OM_DB_TYPE=\"mysql\"\nENV OM_DB_HOST=\"localhost\"\nENV OM_DB_PORT=\"3306\"\nENV OM_DB_USER=\"om_admin\"\nENV OM_DB_PASS=\"12345\"\nENV OM_KURENTO_WS_URL=\"ws://127.0.0.1:8888/kurento\"\nENV OM_DATA_DIR=\"/opt/omdata\"\nENV work=/opt\nENV OM_HOME=/opt/openmeetings\nENV MYSQL_J_VER=\"8.0.15\"\nENV DB2_J_VER=\"11.1.4.4\"\nENV PORTS=5443\n\nWORKDIR ${OM_HOME}\nRUN cat /etc/issue \\\n  \\\n  && echo \"OM server of type ${OM_TYPE} will be built\" \\\n  \\\n  && apt-get update && apt-get install -y --no-install-recommends \\\n    apt-utils \\\n  && apt-get install -y --no-install-recommends \\\n    software-properties-common \\\n    gnupg2 \\\n    dirmngr \\\n    unzip \\\n    wget \\\n    ghostscript \\\n    libgs-dev \\\n    imagemagick \\\n    sox \\\n    sudo \\\n    libreoffice \\\n    openjdk-8-jdk \\\n    ffmpeg \\\n  && apt-get clean \\\n  && rm -rf /var/lib/apt/lists/* \\\n  \\\n  && wget \"https://archive.apache.org/dist/openmeetings/${OM_VERSION}/bin/apache-openmeetings-${OM_VERSION}.tar.gz\" -O om.tar.gz \\\n    && wget \"https://archive.apache.org/dist/openmeetings/${OM_VERSION}/bin/apache-openmeetings-${OM_VERSION}.tar.gz.asc\" -O om.asc \\\n    && export GNUPGHOME=\"$(mktemp -d)\" \\\n    && for server in hkp://ipv4.pool.sks-keyservers.net:80 \\\n                     hkp://ha.pool.sks-keyservers.net:80 \\\n                     hkp://pgp.mit.edu:80 \\\n                     hkp://keyserver.pgp.com:80; \\\n    do \\\n      gpg --batch --keyserver \"$server\" --recv-keys C467526E && break || echo \"Trying new server...\" \\\n    ; done \\\n    && gpg --batch --verify om.asc om.tar.gz \\\n    && tar -xzf om.tar.gz \\\n    && rm -rf ${GNUPGHOME} om.asc om.tar.gz \\\n    && wget https://repo1.maven.org/maven2/mysql/mysql-connector-java/${MYSQL_J_VER}/mysql-connector-java-${MYSQL_J_VER}.jar -P webapps/openmeetings/WEB-INF/lib \\\n    && wget https://repo1.maven.org/maven2/com/ibm/db2/jcc/${DB2_J_VER}/jcc-${DB2_J_VER}.jar -P webapps/openmeetings/WEB-INF/lib \\\n    && sed -i 's|<policy domain=\"coder\" rights=\"none\" pattern=\"PS\" />|<!--policy domain=\"coder\" rights=\"none\" pattern=\"PS\" />|g; s|<policy domain=\"coder\" rights=\"none\" pattern=\"XPS\" />|<policy domain=\"coder\" rights=\"none\" pattern=\"XPS\" /-->|g' /etc/ImageMagick-6/policy.xml\n\nWORKDIR ${work}\nCOPY scripts/*.sh ./\n\nRUN chmod a+x ${work}/*.sh \\\n  && ./om_install.sh\n\nEXPOSE ${PORTS}\n\nENTRYPOINT [ \"bash\", \"-c\", \"${work}/om.sh\" ]\n\n"
}