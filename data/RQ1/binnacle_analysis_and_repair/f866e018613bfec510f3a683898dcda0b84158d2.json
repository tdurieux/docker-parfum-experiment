{
  "startTime": 1674240709829,
  "endTime": 1674240717373,
  "originalSmells": [
    {
      "rule": "tarSomethingRmTheSomething",
      "position": {
        "lineStart": 513,
        "lineEnd": 513,
        "columnStart": 4,
        "columnEnd": 53
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "# Start by pulling down our existing container\n# to sync 1.9 Gb of data from OpenVAS.\nFROM mikesplain/openvas\n\nFROM ubuntu:16.04\n\nCOPY --from=0 /var/lib/openvas /var/lib/openvas\nCOPY config/redis.config /etc/redis/redis.config\nCOPY config/sasl_passwd_template /\nCOPY config/main.cf_template /\nCOPY config/ldapUserSync/* /ldapUserSync/\nCOPY start /start\n\nENV DEBIAN_FRONTEND=noninteractive \\\n    OV_PASSWORD=admin \\\n    PUBLIC_HOSTNAME=openvas\n\nRUN apt-get update && \\\n    apt-get install software-properties-common --no-install-recommends -yq && \\\n    add-apt-repository ppa:mikesplain/openvas -y && \\\n    add-apt-repository ppa:mrazavi/openvas -y && \\\n    apt-get clean && \\\n    apt-get update && \\\n    apt-get install alien \\\n        autotools-dev \\\n        bind9-host \\\n        binutils \\\n        bsdmainutils \\\n        build-essential \\\n        bzip2 \\\n        ca-certificates \\\n        cpio \\\n        cpp \\\n        cpp-5 \\\n        curl \\\n        debhelper \\\n        debugedit \\\n        dh-python \\\n        dh-strip-nondeterminism \\\n        dirb \\\n        dirmngr \\\n        dnsutils \\\n        dpkg-dev \\\n        fakeroot \\\n        file \\\n        fontconfig \\\n        fontconfig-config \\\n        fonts-dejavu-core \\\n        fonts-lato \\\n        fonts-liberation \\\n        fonts-lmodern \\\n        fonts-texgyre \\\n        g++ \\\n        g++-5 \\\n        gcc \\\n        gcc-5 \\\n        geoip-database \\\n        gettext \\\n        gettext-base \\\n        ghostscript \\\n        gir1.2-glib-2.0:amd64 \\\n        gnupg-agent \\\n        gnupg2 \\\n        gnutls-bin \\\n        graphviz \\\n        groff-base \\\n        gsfonts \\\n        hicolor-icon-theme \\\n        ifupdown \\\n        intltool-debian \\\n        iproute2 \\\n        isc-dhcp-client \\\n        isc-dhcp-common \\\n        javascript-common \\\n        ldap-utils \\\n        libalgorithm-diff-perl \\\n        libalgorithm-diff-xs-perl \\\n        libalgorithm-merge-perl \\\n        libapr1:amd64 \\\n        libaprutil1:amd64 \\\n        libarchive-zip-perl \\\n        libarchive13:amd64 \\\n        libasan2:amd64 \\\n        libasn1-8-heimdal:amd64 \\\n        libasprintf-dev:amd64 \\\n        libasprintf0v5:amd64 \\\n        libassuan0:amd64 \\\n        libatk1.0-0:amd64 \\\n        libatk1.0-data \\\n        libatm1:amd64 \\\n        libatomic1:amd64 \\\n        libauthen-sasl-perl \\\n        libavahi-client3:amd64 \\\n        libavahi-common-data:amd64 \\\n        libavahi-common3:amd64 \\\n        libbind9-140:amd64 \\\n        libblas-common \\\n        libblas3 \\\n        libbsd0:amd64 \\\n        libc-dev-bin \\\n        libc6-dev:amd64 \\\n        libcairo2:amd64 \\\n        libcc1-0:amd64 \\\n        libcdt5 \\\n        libcgraph6 \\\n        libcilkrts5:amd64 \\\n        libcroco3:amd64 \\\n        libcups2:amd64 \\\n        libcupsfilters1:amd64 \\\n        libcupsimage2:amd64 \\\n        libcurl3:amd64 \\\n        libcurl3-gnutls:amd64 \\\n        libdatrie1:amd64 \\\n        libdbus-1-3:amd64 \\\n        libdns-export162 \\\n        libdns162:amd64 \\\n        libdpkg-perl \\\n        libdrm-amdgpu1:amd64 \\\n        libdrm-common \\\n        libdrm-intel1:amd64 \\\n        libdrm-nouveau2:amd64 \\\n        libdrm-radeon1:amd64 \\\n        libdrm2:amd64 \\\n        libedit2:amd64 \\\n        libelf1:amd64 \\\n        libencode-locale-perl \\\n        libexpat1:amd64 \\\n        libfakeroot:amd64 \\\n        libffi6:amd64 \\\n        libfile-basedir-perl \\\n        libfile-desktopentry-perl \\\n        libfile-fcntllock-perl \\\n        libfile-homedir-perl \\\n        libfile-listing-perl \\\n        libfile-mimeinfo-perl \\\n        libfile-stripnondeterminism-perl \\\n        libfile-which-perl \\\n        libfont-afm-perl \\\n        libfontconfig1:amd64 \\\n        libfontenc1:amd64 \\\n        libfreetype6:amd64 \\\n        libgcc-5-dev:amd64 \\\n        libgd3:amd64 \\\n        libgdbm3:amd64 \\\n        libgdk-pixbuf2.0-0:amd64 \\\n        libgdk-pixbuf2.0-common \\\n        libgeoip1:amd64 \\\n        libgettextpo-dev:amd64 \\\n        libgettextpo0:amd64 \\\n        libgirepository-1.0-1:amd64 \\\n        libgl1-mesa-dri:amd64 \\\n        libgl1-mesa-glx:amd64 \\\n        libglapi-mesa:amd64 \\\n        libglib2.0-0:amd64 \\\n        libgmp10:amd64 \\\n        libgnutls30:amd64 \\\n        libgomp1:amd64 \\\n        libgpgme11:amd64 \\\n        libgraphite2-3:amd64 \\\n        libgs9:amd64 \\\n        libgs9-common \\\n        libgssapi-krb5-2:amd64 \\\n        libgssapi3-heimdal:amd64 \\\n        libgtk2.0-0:amd64 \\\n        libgtk2.0-bin \\\n        libgtk2.0-common \\\n        libgtksourceview2.0-0 \\\n        libgtksourceview2.0-common \\\n        libgvc6 \\\n        libgvpr2 \\\n        libharfbuzz-icu0:amd64 \\\n        libharfbuzz0b:amd64 \\\n        libhcrypto4-heimdal:amd64 \\\n        libheimbase1-heimdal:amd64 \\\n        libheimntlm0-heimdal:amd64 \\\n        libhiredis0.13:amd64 \\\n        libhogweed4:amd64 \\\n        libhtml-form-perl \\\n        libhtml-format-perl \\\n        libhtml-parser-perl \\\n        libhtml-tagset-perl \\\n        libhtml-tree-perl \\\n        libhttp-cookies-perl \\\n        libhttp-daemon-perl \\\n        libhttp-date-perl \\\n        libhttp-message-perl \\\n        libhttp-negotiate-perl \\\n        libhx509-5-heimdal:amd64 \\\n        libice6:amd64 \\\n        libicu55:amd64 \\\n        libidn11:amd64 \\\n        libijs-0.35:amd64 \\\n        libio-html-perl \\\n        libio-socket-ssl-perl \\\n        libipc-system-simple-perl \\\n        libisc-export160 \\\n        libisc160:amd64 \\\n        libisccc140:amd64 \\\n        libisccfg140:amd64 \\\n        libisl15:amd64 \\\n        libitm1:amd64 \\\n        libjbig0:amd64 \\\n        libjbig2dec0 \\\n        libjemalloc1 \\\n        libjpeg-turbo8:amd64 \\\n        libjpeg8:amd64 \\\n        libjs-jquery \\\n        libk5crypto3:amd64 \\\n        libkeyutils1:amd64 \\\n        libkpathsea6:amd64 \\\n        libkrb5-26-heimdal:amd64 \\\n        libkrb5-3:amd64 \\\n        libkrb5support0:amd64 \\\n        libksba8:amd64 \\\n        liblcms2-2:amd64 \\\n        libldap-2.4-2:amd64 \\\n        libldb1:amd64 \\\n        liblinear3:amd64 \\\n        libllvm6.0:amd64 \\\n        liblsan0:amd64 \\\n        libltdl7:amd64 \\\n        liblua5.2-0:amd64 \\\n        liblwp-mediatypes-perl \\\n        liblwp-protocol-https-perl \\\n        liblwres141:amd64 \\\n        liblzo2-2:amd64 \\\n        libmagic1:amd64 \\\n        libmail-sendmail-perl \\\n        libmailtools-perl \\\n        libmicrohttpd10 \\\n        libmnl0:amd64 \\\n        libmpc3:amd64 \\\n        libmpdec2:amd64 \\\n        libmpfr4:amd64 \\\n        libmpx0:amd64 \\\n        libnet-dbus-perl \\\n        libnet-http-perl \\\n        libnet-smtp-ssl-perl \\\n        libnet-ssleay-perl \\\n        libnettle6:amd64 \\\n        libnpth0:amd64 \\\n        libnspr4:amd64 \\\n        libnss3:amd64 \\\n        libnss3-nssdb \\\n        libopenvas9 \\\n        libopenvas9-dev \\\n        libopts25:amd64 \\\n        libp11-kit0:amd64 \\\n        libpango-1.0-0:amd64 \\\n        libpangocairo-1.0-0:amd64 \\\n        libpangoft2-1.0-0:amd64 \\\n        libpaper-utils \\\n        libpaper1:amd64 \\\n        libpathplan4 \\\n        libpcap0.8:amd64 \\\n        libpci3:amd64 \\\n        libpciaccess0:amd64 \\\n        libperl5.22:amd64 \\\n        libpipeline1:amd64 \\\n        libpixman-1-0:amd64 \\\n        libpng12-0:amd64 \\\n        libpoppler58:amd64 \\\n        libpopt0:amd64 \\\n        libpotrace0 \\\n        libptexenc1:amd64 \\\n        libpython-stdlib:amd64 \\\n        libpython2.7:amd64 \\\n        libpython2.7-minimal:amd64 \\\n        libpython2.7-stdlib:amd64 \\\n        libpython3-stdlib:amd64 \\\n        libpython3.5-minimal:amd64 \\\n        libpython3.5-stdlib:amd64 \\\n        libquadmath0:amd64 \\\n        libroken18-heimdal:amd64 \\\n        librpm3 \\\n        librpmbuild3 \\\n        librpmio3 \\\n        librpmsign3 \\\n        librtmp1:amd64 \\\n        libruby2.3:amd64 \\\n        libsasl2-2:amd64 \\\n        libsasl2-modules:amd64 \\\n        libsasl2-modules-db:amd64 \\\n        libsensors4:amd64 \\\n        libserf-1-1:amd64 \\\n        libsm6:amd64 \\\n        libsmbclient:amd64 \\\n        libsnmp-base \\\n        libsnmp30:amd64 \\\n        libsqlite3-0:amd64 \\\n        libssh-4:amd64 \\\n        libssl1.0.0:amd64 \\\n        libstdc++-5-dev:amd64 \\\n        libsvn1:amd64 \\\n        libsynctex1:amd64 \\\n        libsys-hostname-long-perl \\\n        libtalloc2:amd64 \\\n        libtasn1-6:amd64 \\\n        libtcl8.6:amd64 \\\n        libtdb1:amd64 \\\n        libtevent0:amd64 \\\n        libtexlua52:amd64 \\\n        libtexluajit2:amd64 \\\n        libtext-iconv-perl \\\n        libthai-data \\\n        libthai0:amd64 \\\n        libtie-ixhash-perl \\\n        libtiff5:amd64 \\\n        libtimedate-perl \\\n        libtk8.6:amd64 \\\n        libtsan0:amd64 \\\n        libtxc-dxtn-s2tc0:amd64 \\\n        libubsan0:amd64 \\\n        libunistring0:amd64 \\\n        liburi-perl \\\n        libutempter0:amd64 \\\n        libvpx3:amd64 \\\n        libwbclient0:amd64 \\\n        libwhisker2-perl \\\n        libwind0-heimdal:amd64 \\\n        libwrap0:amd64 \\\n        libwww-perl \\\n        libwww-robotrules-perl \\\n        libx11-6:amd64 \\\n        libx11-data \\\n        libx11-protocol-perl \\\n        libx11-xcb1:amd64 \\\n        libxau6:amd64 \\\n        libxaw7:amd64 \\\n        libxcb-dri2-0:amd64 \\\n        libxcb-dri3-0:amd64 \\\n        libxcb-glx0:amd64 \\\n        libxcb-present0:amd64 \\\n        libxcb-render0:amd64 \\\n        libxcb-shape0:amd64 \\\n        libxcb-shm0:amd64 \\\n        libxcb-sync1:amd64 \\\n        libxcb1:amd64 \\\n        libxcomposite1:amd64 \\\n        libxcursor1:amd64 \\\n        libxdamage1:amd64 \\\n        libxdmcp6:amd64 \\\n        libxext6:amd64 \\\n        libxfixes3:amd64 \\\n        libxft2:amd64 \\\n        libxi6:amd64 \\\n        libxinerama1:amd64 \\\n        libxml-parser-perl \\\n        libxml-twig-perl \\\n        libxml-xpathengine-perl \\\n        libxml2:amd64 \\\n        libxmu6:amd64 \\\n        libxmuu1:amd64 \\\n        libxpm4:amd64 \\\n        libxrandr2:amd64 \\\n        libxrender1:amd64 \\\n        libxshmfence1:amd64 \\\n        libxslt1.1:amd64 \\\n        libxss1:amd64 \\\n        libxt6:amd64 \\\n        libxtables11:amd64 \\\n        libxtst6:amd64 \\\n        libxv1:amd64 \\\n        libxxf86dga1:amd64 \\\n        libxxf86vm1:amd64 \\\n        libyaml-0-2:amd64 \\\n        libyaml-tiny-perl \\\n        libzzip-0-13:amd64 \\\n        linux-libc-dev:amd64 \\\n        lmodern \\\n        lua-lpeg:amd64 \\\n        make \\\n        man-db \\\n        manpages \\\n        manpages-dev \\\n        mime-support \\\n        ndiff \\\n        net-tools \\\n        netbase \\\n        nikto \\\n        nmap \\\n        nsis \\\n        nsis-common \\\n        openssh-client \\\n        openssl \\\n        openvas9 \\\n        openvas9-cli \\\n        openvas9-gsa \\\n        openvas9-manager \\\n        openvas9-scanner \\\n        patch \\\n        perl \\\n        perl-modules-5.22 \\\n        pinentry-curses \\\n        po-debconf \\\n        poppler-data \\\n        postfix \\\n        preview-latex-style \\\n        prosper \\\n        ps2eps \\\n        python \\\n        python-beautifulsoup \\\n        python-bs4 \\\n        python-cairo \\\n        python-cffi-backend \\\n        python-chardet \\\n        python-crypto \\\n        python-cryptography \\\n        python-defusedxml \\\n        python-enum34 \\\n        python-gi \\\n        python-gobject \\\n        python-gobject-2 \\\n        python-gtk2 \\\n        python-gtksourceview2 \\\n        python-html5lib \\\n        python-idna \\\n        python-ipaddress \\\n        python-ldb \\\n        python-lxml \\\n        python-minimal \\\n        python-ndg-httpsclient \\\n        python-openssl \\\n        python-pkg-resources \\\n        python-pyasn1 \\\n        python-pypdf \\\n        python-pysqlite2 \\\n        python-requests \\\n        python-samba \\\n        python-scapy \\\n        python-simplejson \\\n        python-six \\\n        python-soappy \\\n        python-svn \\\n        python-talloc \\\n        python-tdb \\\n        python-urllib3 \\\n        python-wstools \\\n        python2.7 \\\n        python2.7-minimal \\\n        python3 \\\n        python3-minimal \\\n        python3.5 \\\n        python3.5-minimal \\\n        rake \\\n        redis-server \\\n        redis-tools \\\n        rename \\\n        rpm \\\n        rpm-common \\\n        rpm2cpio \\\n        rsync \\\n        ruby \\\n        ruby-did-you-mean \\\n        ruby-minitest \\\n        ruby-net-telnet \\\n        ruby-power-assert \\\n        ruby-test-unit \\\n        ruby2.3 \\\n        rubygems-integration \\\n        samba-common \\\n        samba-common-bin \\\n        samba-libs:amd64 \\\n        sgml-base \\\n        shared-mime-info \\\n        smbclient \\\n        socat \\\n        sqlite3 \\\n        sshpass \\\n        ssl-cert \\\n        t1utils \\\n        tcl \\\n        tcl8.6 \\\n        tcpd \\\n        tex-common \\\n        tex-gyre \\\n        texlive-base \\\n        texlive-binaries \\\n        texlive-extra-utils \\\n        texlive-font-utils \\\n        texlive-fonts-recommended \\\n        texlive-fonts-recommended-doc \\\n        texlive-generic-recommended \\\n        texlive-latex-base \\\n        texlive-latex-extra \\\n        texlive-latex-recommended \\\n        texlive-pictures \\\n        texlive-pstricks \\\n        tipa \\\n        tk \\\n        tk8.6 \\\n        tzdata \\\n        ucf \\\n        unzip \\\n        w3af \\\n        w3af-console \\\n        wapiti \\\n        wget \\\n        x11-common \\\n        x11-utils \\\n        x11-xserver-utils \\\n        xauth \\\n        xbitmaps \\\n        xdg-utils \\\n        xml-core \\\n        xsltproc \\\n        xterm \\\n        xz-utils \\\n        zip \\\n    -yq --no-install-recommends && \\\n    rm -rf /var/lib/apt/lists/*\n\nRUN wget -q https://github.com/Arachni/arachni/releases/download/v1.5.1/arachni-1.5.1-0.5.12-linux-x86_64.tar.gz && \\\n    tar -zxf arachni-1.5.1-0.5.12-linux-x86_64.tar.gz && \\\n    mv arachni-1.5.1-0.5.12 /opt/arachni && \\\n    ln -s /opt/arachni/bin/* /usr/local/bin/ && \\\n    rm -rf arachni* && rm arachni-1.5.1-0.5.12-linux-x86_64.tar.gz\n\nRUN mkdir -p /var/run/redis && \\\n    wget -q --no-check-certificate \\\n    https://raw.githubusercontent.com/kurobeats/OpenVas-Management-Scripts/master/openvas-check-setup \\\n      -O /openvas-check-setup && \\\n    chmod +x /openvas-check-setup && \\\n    sed -i 's/DAEMON_ARGS=\"\"/DAEMON_ARGS=\"-a 0.0.0.0 --client-watch-interval=0\"/' /etc/init.d/openvas-manager && \\\n    sed -i 's/DAEMON_ARGS=\"\"/DAEMON_ARGS=\"--mlisten 127.0.0.1 -m 9390 --gnutls-priorities=SECURE128:-AES-128-CBC:-CAMELLIA-128-CBC:-VERS-SSL3.0:-VERS-TLS1.0\"/' /etc/init.d/openvas-gsa && \\\n    sed -i '/^\\[ -n \"$HTTP_STS_MAX_AGE\" \\]/a[ -n \"$PUBLIC_HOSTNAME\" ] && DAEMON_ARGS=\"$DAEMON_ARGS --allow-header-host=$PUBLIC_HOSTNAME\"' /etc/init.d/openvas-gsa && \\\n    sed -i 's/PORT_NUMBER=4000/PORT_NUMBER=443/' /etc/default/openvas-gsa && \\\n    greenbone-nvt-sync > /dev/null && \\\n    greenbone-scapdata-sync > /dev/null && \\\n    greenbone-certdata-sync > /dev/null && \\\n    BUILD=true /start && \\\n    service openvas-scanner stop && \\\n    service openvas-manager stop && \\\n    service openvas-gsa stop && \\\n    service redis-server stop\n\n\nENV BUILD=\"\"\n\nCMD /start\n\nEXPOSE 443 9390\n"
}