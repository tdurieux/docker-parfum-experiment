{
  "startTime": 1674240107936,
  "endTime": 1674240108079,
  "originalSmells": [
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 7,
        "lineEnd": 7,
        "columnStart": 4,
        "columnEnd": 76
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 10,
        "lineEnd": 10,
        "columnStart": 4,
        "columnEnd": 131
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 7,
        "lineEnd": 7,
        "columnStart": 4,
        "columnEnd": 76
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 10,
        "lineEnd": 10,
        "columnStart": 4,
        "columnEnd": 131
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "FROM ubuntu:14.04\n\nMAINTAINER Manel Martinez <manel@nixelsolutions.com>\n\nENV DEBIAN_FRONTEND=noninteractive\n\nRUN apt-get update && \\\n    apt-get install --no-install-recommends -y python-software-properties software-properties-common && rm -rf /var/lib/apt/lists/*;\nRUN add-apt-repository -y ppa:gluster/glusterfs-3.5 && \\\n    apt-get update && \\\n    apt-get install --no-install-recommends -y nginx php5-fpm php5-mysql php-apc supervisor glusterfs-client curl haproxy pwgen unzip mysql-client dnsutils && rm -rf /var/lib/apt/lists/*;\n\nENV WORDPRESS_VERSION 4.2.2\nENV WORDPRESS_NAME wordpress\nENV GLUSTER_VOL ranchervol\nENV GLUSTER_VOL_PATH /var/www\nENV HTTP_PORT 80\nENV HTTP_DOCUMENTROOT **ChangeMe**\nENV PHP_SESSION_PATH ${GLUSTER_VOL_PATH}/phpsessions\nENV DEBUG 0\n\nENV DB_USER root\nENV DB_PASSWORD **ChangeMe**\nENV WP_DB_NAME **ChangeMe**\nENV DB_HOST db\nENV GLUSTER_HOST storage\n\nRUN mkdir -p /var/log/supervisor ${GLUSTER_VOL_PATH}\nWORKDIR ${GLUSTER_VOL_PATH}\n\nRUN mkdir -p /usr/local/bin\nADD ./bin /usr/local/bin\nRUN chmod +x /usr/local/bin/*.sh\nADD ./etc/supervisord.conf /etc/supervisor/conf.d/supervisord.conf\nADD ./etc/haproxy/haproxy.cfg /etc/haproxy/haproxy.cfg\nADD ./etc/nginx/sites-enabled/wordpress /etc/nginx/sites-enabled/wordpress\n\n# nginx config\nRUN sed -i -e\"s/keepalive_timeout\\s*65/keepalive_timeout 2/\" /etc/nginx/nginx.conf\nRUN sed -i -e\"s/keepalive_timeout 2/keepalive_timeout 2;\\n\\tclient_max_body_size 100m/\" /etc/nginx/nginx.conf\nRUN echo \"daemon off;\" >> /etc/nginx/nginx.conf\nRUN rm -f /etc/nginx/sites-enabled/default\n\n# php-fpm config\nRUN sed -i -e \"s/;cgi.fix_pathinfo=1/cgi.fix_pathinfo=0/g\" /etc/php5/fpm/php.ini\nRUN sed -i -e \"s/upload_max_filesize\\s*=\\s*2M/upload_max_filesize = 100M/g\" /etc/php5/fpm/php.ini\nRUN sed -i -e \"s/post_max_size\\s*=\\s*8M/post_max_size = 100M/g\" /etc/php5/fpm/php.ini\nRUN sed -i -e \"s/;daemonize\\s*=\\s*yes/daemonize = no/g\" /etc/php5/fpm/php-fpm.conf\n\n# HAProxy\nRUN perl -p -i -e \"s/ENABLED=0/ENABLED=1/g\" /etc/default/haproxy\n\nCMD [\"/usr/local/bin/run.sh\"]\n"
}