{
  "startTime": 1674244661982,
  "endTime": 1674244662196,
  "originalSmells": [
    {
      "rule": "yumInstallRmVarCacheYum",
      "position": {
        "lineStart": 17,
        "lineEnd": 17,
        "columnStart": 7,
        "columnEnd": 378
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "FROM idoall/nginx:1.9\nMAINTAINER lion <lion.net@163.com>\n\n\n\n# -----------------------------------------------------------------------------\n# 安装PHP 56\n# -----------------------------------------------------------------------------\nRUN rpm -Uvh https://dl.fedoraproject.org/pub/epel/epel-release-latest-6.noarch.rpm \\\n    && rpm -Uvh https://mirror.webtatic.com/yum/el6/latest.rpm \\\n    && yum update -y \\\n    && yum clean all \\\n    && yum makecache \\\n    \\\n# -----------------------------------------------------------------------------\n# 安装PHP 56\n# -----------------------------------------------------------------------------\n    && yum install -y php56w php56w-cli php56w-fpm php56w-opcache php56w-gd php56w-devel php56w-bcmath  php56w-imap php56w-mbstring php56w-mcrypt php56w-mysql php56w-odbc php56w-pdo php56w-pear php56w-pecl-geoip php56w-pecl-imagick php56w-pecl-memcache php56w-xml php56w-xmlrpc php56w-opcache php56w-intl php56w-pecl-redis php56w-pecl-memcache php56w-pecl-memcached php56w-soap \\\n    \\\n# -----------------------------------------------------------------------------\n# 修改配置文件\n# -----------------------------------------------------------------------------\n    && mkdir -p /home/work/_logs/php \\\n    && sed -i \"s/;date.timezone =.*/date.timezone = Asia\\/Shanghai/\" /etc/php.ini \\\n    && sed -i \"s/error_log = \\/var\\/log\\/php-fpm\\/error.log/error_log = \\/home\\/work\\/_logs\\/php\\/php-fpm.error.log/\" /etc/php-fpm.conf \\\n    && sed -i \"s/user = apache/user = work/\" /etc/php-fpm.d/www.conf \\\n    && sed -i \"s/group = apache/group = work/\" /etc/php-fpm.d/www.conf \\\n    && sed -i \"s/;listen.owner = nobody/listen.owner = work/\" /etc/php-fpm.d/www.conf \\\n    && sed -i \"s/;listen.group = nobody/listen.group = work/\" /etc/php-fpm.d/www.conf \\\n    && sed -i \"s/;listen.mode = 0666/listen.mode = 0666/\" /etc/php-fpm.d/www.conf \\\n    && sed -i \"s/;catch_workers_output = yes/catch_workers_output = yes/\" /etc/php-fpm.d/www.conf \\\n    && sed -i \"s/php_admin_value\\[error_log\\] = \\/var\\/log\\/php-fpm\\/www-error.log/php_admin_value\\[error_log\\] = \\/home\\/work\\/_logs\\/php\\/php-fpm.www.log/\" /etc/php-fpm.d/www.conf \\\n    && sed -i \"s/;request_slowlog_timeout = 0/request_slowlog_timeout = 15s/\" /etc/php-fpm.d/www.conf \\\n    && sed -i \"s/slowlog = \\/var\\/log\\/php-fpm\\/www-slow.log/slowlog = \\/home\\/work\\/_logs\\/php\\/fpm-php.slow.log/\" /etc/php-fpm.d/www.conf \\\n    \\\n    && echo \"<?php  phpinfo();  ?>\" > /home/work/_app/nginx/html/index.php \\\n    \\\n# -----------------------------------------------------------------------------\n# 删除多余文件\n# -----------------------------------------------------------------------------\n    && yum clean all \\\n    && rm -rf /home/work/_src/* && rm -rf /var/cache/yum\n\n\n\n\n# -----------------------------------------------------------------------------\n# 修改 Nginx 的配置文件支持 PHP，并配置默认站点\n# -----------------------------------------------------------------------------\nADD _app/nginx/conf/nginx.conf /home/work/_app/nginx/conf/nginx.conf\nADD _app/nginx/conf/conf.d/default.conf /home/work/_app/nginx/conf/conf.d/default.conf\n\n# -----------------------------------------------------------------------------\n# 添加执行文件\n# -----------------------------------------------------------------------------\nADD run.sh /\nRUN chmod +x /run.sh\nCMD [\"/run.sh\"]\n\n\n\n"
}