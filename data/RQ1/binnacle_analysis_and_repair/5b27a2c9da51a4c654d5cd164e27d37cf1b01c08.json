{
  "startTime": 1674249499939,
  "endTime": 1674249500174,
  "originalSmells": [
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 59,
        "lineEnd": 61,
        "columnStart": 7,
        "columnEnd": 120
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "ARG PHP_VERSION=7.3\nFROM php:${PHP_VERSION}-apache\nARG VERSION=latest\nLABEL maintainer=\"Derek P Sifford <dereksifford@gmail.com>\" \\\n      version=\"${VERSION}-php${PHP_VERSION}\"\n\nSHELL [\"/bin/bash\", \"-o\", \"pipefail\", \"-c\"]\n\n# Install base requirements & sensible defaults + required PHP extensions\n# hadolint ignore=DL3008\nRUN echo \"deb http://ftp.debian.org/debian $(sed -n 's/^VERSION=.*(\\(.*\\)).*/\\1/p' /etc/os-release)-backports main\" >> /etc/apt/sources.list \\\n    && apt-get update \\\n    && apt-get install -y --no-install-recommends \\\n        bash-completion \\\n        bindfs \\\n        ghostscript \\\n        less \\\n        libjpeg-dev \\\n        libmagickwand-dev \\\n        libpng-dev \\\n        libxml2-dev \\\n        libzip-dev \\\n        mariadb-client \\\n        sudo \\\n        unzip \\\n        vim \\\n        zip \\\n    && apt-get -t \"$(sed -n 's/^VERSION=.*(\\(.*\\)).*/\\1/p' /etc/os-release)-backports\" install -y --no-install-recommends \\\n        python-certbot-apache \\\n    && rm -rf /var/lib/apt/lists/* \\\n    && docker-php-ext-configure gd --with-png-dir=/usr --with-jpeg-dir=/usr \\\n    && docker-php-ext-configure zip --with-libzip \\\n    && pecl install imagick \\\n    && pecl install redis \\\n    && docker-php-ext-install \\\n        bcmath \\\n        exif \\\n        gd \\\n        mysqli \\\n        opcache \\\n        soap \\\n        zip \\\n    && docker-php-ext-enable imagick \\\n    && docker-php-ext-enable redis \\\n    # See https://secure.php.net/manual/en/opcache.installation.php\n    && echo 'memory_limit = 512M' >> /usr/local/etc/php/php.ini \\\n    && { \\\n        echo 'opcache.memory_consumption=128'; \\\n        echo 'opcache.interned_strings_buffer=8'; \\\n        echo 'opcache.max_accelerated_files=4000'; \\\n        echo 'opcache.revalidate_freq=2'; \\\n        echo 'opcache.fast_shutdown=1'; \\\n        echo 'opcache.enable_cli=1'; \\\n    } > /usr/local/etc/php/conf.d/opcache-recommended.ini \\\n    && sed -i 's/AllowOverride None/AllowOverride All/g' /etc/apache2/apache2.conf \\\n    # Fixes issue where error is logged stating apache could not resolve the\n    # fully qualified domain name\n    && echo 'ServerName localhost' > /etc/apache2/conf-available/fqdn.conf \\\n    # Grab and install wp-cli from remote \\\n    && curl -f \\\n        -o /usr/local/bin/wp https://raw.githubusercontent.com/wp-cli/builds/gh-pages/phar/wp-cli.phar \\\n        -o /etc/bash_complet https://raw.githubusercontent.com/wp-cli/wp-cli/master/utils/wp-completion.bash \\\n    && a2enconf fqdn \\\n    && a2enmod rewrite expires\n\n# Add admin superuser, create install directory, adjust perms, & add symlink\nCOPY run.sh /run.sh\nRUN useradd -ms /bin/bash -G sudo admin \\\n    && echo \"admin ALL=(root) NOPASSWD:ALL\" > /etc/sudoers.d/admin \\\n    && chmod 0440 /etc/sudoers.d/admin \\\n    && chmod +x /usr/local/bin/wp /run.sh \\\n    && mkdir -m 0700 /app \\\n    && chown admin:admin /app \\\n    && printf '%s\\t%s\\t%s\\t%s%s%s%s%s%s%s%s\\t%d\\t%d\\n' \\\n        '/app' \\\n        '/var/www/html' \\\n        'fuse.bindfs' \\\n            'force-user=www-data,' \\\n            'force-group=www-data,' \\\n            'create-for-user=admin,' \\\n            'create-for-group=admin,' \\\n            'create-with-perms=0644:a+X,' \\\n            'chgrp-ignore,' \\\n            'chown-ignore,' \\\n            'chmod-ignore' \\\n        0 \\\n        0 > /etc/fstab\n\nUSER admin\nWORKDIR /app\nEXPOSE 80 443\nCMD [\"/run.sh\"]\n"
}