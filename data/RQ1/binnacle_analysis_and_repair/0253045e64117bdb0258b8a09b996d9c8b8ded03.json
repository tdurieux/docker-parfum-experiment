{
  "startTime": 1674241472523,
  "endTime": 1674241472683,
  "originalSmells": [
    {
      "rule": "wgetUseHttpsUrl",
      "position": {
        "lineStart": 21,
        "lineEnd": 21,
        "columnStart": 4,
        "columnEnd": 104
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "FROM alpine:latest\nMAINTAINER anyesu\n\n# 拷贝项目\nCOPY . /usr/anyesu/tmp/Tomcat-Websocket\n\nRUN echo -e \"https://mirror.tuna.tsinghua.edu.cn/alpine/v3.4/main\\n\\\nhttps://mirror.tuna.tsinghua.edu.cn/alpine/v3.4/community\" > /etc/apk/repositories && \\\n    # 设置时区\n    apk --update add ca-certificates && \\\n    apk add tzdata && \\\n    ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime && \\\n    echo \"Asia/Shanghai\" > /etc/timezone && \\\n    # 安装jdk\n    apk add openjdk7 && \\\n    # 安装wget\n    apk add wget && \\\n    tmp=/usr/anyesu/tmp && \\\n    cd /usr/anyesu && \\\n    # 下载tomcat\n    tomcatVer=7.0.82 && \\\n    wget https://mirror.bit.edu.cn/apache/tomcat/tomcat-7/v$tomcatVer/bin/apache-tomcat-$tomcatVer.tar.gz && \\\n    tar -zxvf apache-tomcat-$tomcatVer.tar.gz && \\\n    mv apache-tomcat-$tomcatVer tomcat && \\\n    # 清空webapps下自带项目\n    rm -r tomcat/webapps/* && \\\n    rm apache-tomcat-$tomcatVer.tar.gz && \\\n    cd $tmp && \\\n    # 编译源码\n    proj=$tmp/Tomcat-Websocket && \\\n    src=$proj/src && \\\n    tomcatBase=/usr/anyesu/tomcat && \\\n    classpath=\"$tomcatBase/lib/servlet-api.jar:$tomcatBase/lib/websocket-api.jar:$proj/WebRoot/WEB-INF/lib/fastjson-1.1.41.jar\" && \\\n    output=$proj/WebRoot/WEB-INF/classes && \\\n    mkdir -p $output && \\\n    /usr/lib/jvm/java-1.7-openjdk/bin/javac -sourcepath $src -classpath $classpath -d $output `find $src -name \"*.java\"` && \\\n    # 拷贝到tomcat\n    mv $proj/WebRoot $tomcatBase/webapps/ROOT && \\\n    rm -rf $tmp && \\\n    apk del wget && \\\n    # 清除apk缓存\n    rm -rf /var/cache/apk/* && \\\n    # 添加普通用户\n    addgroup -S group_docker && adduser -S -G group_docker user_docker && \\\n    # 修改目录所有者\n    chown user_docker:group_docker -R /usr/anyesu\n\n# 设置环境变量\nENV JAVA_HOME /usr/lib/jvm/java-1.7-openjdk\nENV CATALINA_HOME /usr/anyesu/tomcat\nENV PATH $PATH:$JAVA_HOME/bin:$CATALINA_HOME/bin\n\n# 暴露端口\nEXPOSE 8080\n\n# 启动命令（前台程序）\nCMD [\"catalina.sh\", \"run\"]"
}