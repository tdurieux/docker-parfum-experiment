{
  "startTime": 1674251649725,
  "endTime": 1674251649901,
  "originalSmells": [
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 24,
        "lineEnd": 25,
        "columnStart": 4,
        "columnEnd": 92
      }
    },
    {
      "rule": "tarSomethingRmTheSomething",
      "position": {
        "lineStart": 29,
        "lineEnd": 29,
        "columnStart": 4,
        "columnEnd": 67
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 14,
        "lineEnd": 21,
        "columnStart": 22,
        "columnEnd": 9
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "# VERSION 0.6\n# AUTHOR:         Olav Grønås Gjerde <olav@backupbay.com>\n# DESCRIPTION:    Image with MoinMoin wiki, uwsgi, nginx and self signed SSL\n# TO_BUILD:       docker build -t moinmoin .\n# TO_RUN:         docker run -d -p 80:80 -p 443:443 --name my_wiki moinmoin\n\nFROM debian:stretch-slim\nMAINTAINER Olav Grønås Gjerde <olav@backupbay.com>\n\n# Set the version you want of MoinMoin\nENV MM_VERSION 1.9.10\nENV MM_CSUM 6ae110a22a23bfa6dd5c149b8d66f7ad34976d5d\n\n# Install software\nRUN apt-get update && apt-get install -qqy --no-install-recommends \\\n  python2.7 \\\n  curl \\\n  openssl \\\n  nginx \\\n  uwsgi \\\n  uwsgi-plugin-python \\\n  rsyslog && rm -rf /var/lib/apt/lists/*;\n\n# Download MoinMoin\nRUN curl -f -OkL \\\n  https://github.com/moinwiki/moin-1.9/releases/download/$MM_VERSION/moin-$MM_VERSION.tar.gz\nRUN if [ \"$MM_CSUM\" != \"$(sha1sum moin-$MM_VERSION.tar.gz | awk '{print($1)}')\" ];\\\n  then exit 1; fi;\nRUN mkdir moinmoin\nRUN tar xf moin-$MM_VERSION.tar.gz -C moinmoin --strip-components=1 && rm moin-$MM_VERSION.tar.gz\n\n# Install MoinMoin\nRUN cd moinmoin && python2.7 setup.py install --force --prefix=/usr/local\nADD wikiconfig.py /usr/local/share/moin/\nRUN chown -Rh www-data:www-data /usr/local/share/moin/underlay\nUSER root\n\n# Copy default data into a new folder, we will use this to add content\n# if you start a new container using volumes\nRUN cp -r /usr/local/share/moin/data /usr/local/share/moin/bootstrap-data\n\nRUN chown -R www-data:www-data /usr/local/share/moin/data\nADD logo.png /usr/local/lib/python2.7/dist-packages/MoinMoin/web/static/htdocs/common/\n\n# Configure nginx\nADD nginx.conf /etc/nginx/\nADD moinmoin-nossl.conf /etc/nginx/sites-available/\nADD moinmoin-ssl.conf /etc/nginx/sites-available/\nRUN mkdir -p /var/cache/nginx/cache\nRUN rm /etc/nginx/sites-enabled/default\n\n# Create self signed certificate\nADD generate_ssl_key.sh /usr/local/bin/\nRUN /usr/local/bin/generate_ssl_key.sh moinmoin.example.org\nRUN mv cert.pem /etc/ssl/certs/\nRUN mv key.pem /etc/ssl/private/\n\n# Cleanup\nRUN rm moin-$MM_VERSION.tar.gz\nRUN rm -rf /moinmoin\nRUN apt-get purge -qqy curl\nRUN apt-get autoremove -qqy && apt-get clean\nRUN rm -rf /tmp/* /var/lib/apt/lists/*\n\n# Add the start shell script\nADD start.sh /usr/local/bin/\n\nVOLUME /usr/local/share/moin/data\n\nEXPOSE 80\nEXPOSE 443\n\nCMD start.sh\n"
}