{
  "startTime": 1674234298713,
  "endTime": 1674234299003,
  "originalSmells": [
    {
      "rule": "configureShouldUseBuildFlag",
      "position": {
        "lineStart": 64,
        "lineEnd": 77,
        "columnStart": 4,
        "columnEnd": 16
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "FROM alpine\n#\n# Include dist\nADD dist/ /root/dist/\n#\n# Install packages\n#RUN sed -i 's/dl-cdn/dl-2/g' /etc/apk/repositories && \\\nRUN apk -U --no-cache add \\\n                 ca-certificates \\\n                 curl \\\n                 file \\\n                 geoip \\\n                 hiredis \\\n                 jansson \\\n                 libcap-ng \\\n                 libhtp \\\n                 libmagic \\\n                 libnet \\\n                 libnetfilter_queue \\\n                 libnfnetlink \\\n                 libpcap \\\n                 luajit \\\n                 lz4-libs \\\n                 musl \\\n                 nspr \\\n                 nss \\\n                 pcre \\\n                 yaml \\\n                 wget \\\n                 automake \\\n                 autoconf \\\n                 build-base \\\n                 cargo \\\n                 file-dev \\\n                 geoip-dev \\\n                 hiredis-dev \\\n                 jansson-dev \\\n                 libtool \\\n                 libhtp-dev \\\n                 libcap-ng-dev \\\n                 luajit-dev \\\n                 libpcap-dev \\\n                 libnet-dev \\\n                 libnetfilter_queue-dev \\\n                 libnfnetlink-dev \\\n                 lz4-dev \\\n                 nss-dev \\\n                 nspr-dev \\\n                 pcre-dev \\\n                 python2 \\\n                 py2-pip \\\n                 rust \\\n                 yaml-dev && \\\n#\n# Upgrade pip, install virtualenv\n    pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir suricata-update && \\\n#\n# Get and build Suricata\n    mkdir -p /opt/builder/ && \\\n    wget https://www.openinfosecfoundation.org/download/suricata-4.1.4.tar.gz && \\\n    tar xvfz suricata-4.1.4.tar.gz --strip-components=1 -C /opt/builder/ && \\\n    rm suricata-4.1.4.tar.gz && \\\n    cd /opt/builder && \\\n    ./configure --build=\"$(dpkg-architecture --query DEB_BUILD_GNU_TYPE)\" \\\n\t--prefix=/usr \\\n\t--sysconfdir=/etc \\\n\t--mandir=/usr/share/man \\\n\t--localstatedir=/var \\\n\t--enable-non-bundled-htp \\\n\t--enable-nfqueue \\\n        --enable-rust \\\n\t--disable-gccmarch-native \\\n\t--enable-hiredis \\\n\t--enable-geoip \\\n\t--enable-gccprotect \\\n\t--enable-pie \\\n\t--enable-luajit && \\\n    make && \\\n    make check && \\\n    make install && \\\n    make install-full && \\\n#\n# Setup user, groups and configs\n    addgroup -g 2000 suri && \\\n    adduser -S -H -u 2000 -D -g 2000 suri && \\\n    chmod 644 /etc/suricata/*.config && \\\n    cp /root/dist/suricata.yaml /etc/suricata/suricata.yaml && \\\n    cp /root/dist/*.bpf /etc/suricata/ && \\\n    mkdir -p /etc/suricata/rules && \\\n    cp /opt/builder/rules/* /etc/suricata/rules/ && \\\n#\n# Download the latest EmergingThreats ruleset, replace rulebase and enable all rules\n    cp /root/dist/update.sh /usr/bin/ && \\\n    chmod 755 /usr/bin/update.sh && \\\n    update.sh OPEN && \\\n#\n# Clean up\n    apk del --purge \\\n                 automake \\\n                 autoconf \\\n                 build-base \\\n                 cargo \\\n                 file-dev \\\n                 geoip-dev \\\n                 hiredis-dev \\\n                 jansson-dev \\\n                 libtool \\\n                 libhtp-dev \\\n                 libcap-ng-dev \\\n                 luajit-dev \\\n                 libpcap-dev \\\n                 libnet-dev \\\n                 libnetfilter_queue-dev \\\n                 libnfnetlink-dev \\\n                 lz4-dev \\\n                 nss-dev \\\n                 nspr-dev \\\n                 pcre-dev \\\n                 python2 \\\n                 py2-pip \\\n                 rust \\\n                 yaml-dev && \\\n    rm -rf /opt/builder && \\\n    rm -rf /root/* && \\\n    rm -rf /var/cache/apk/*\n#\n# Start suricata\nSTOPSIGNAL SIGINT\nCMD SURICATA_CAPTURE_FILTER=$(update.sh $OINKCODE) && exec suricata -v -F $SURICATA_CAPTURE_FILTER -i $(/sbin/ip address | grep '^2: ' | awk '{ print $2 }' | tr -d [:punct:])\n"
}