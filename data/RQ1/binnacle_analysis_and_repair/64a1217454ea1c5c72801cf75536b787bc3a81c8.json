{
  "startTime": 1674249992802,
  "endTime": 1674249992967,
  "originalSmells": [
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 89,
        "lineEnd": 89,
        "columnStart": 4,
        "columnEnd": 61
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "# ==================================================================\n# module list\n# ------------------------------------------------------------------\n# python        3.6    (conda)\n# pytorch       0.4.1  (conda)\n# tensorboardx  1.4    (conda)\n# ffpmeg        4.0.2  (conda)\n# ==================================================================\nFROM nvidia/cuda:9.0-cudnn7-devel-ubuntu16.04\n\nENV PATH /opt/conda/bin:$PATH\nENV LD_LIBRARY_PATH /usr/lib/x86_64-linux-gnu:/usr/local/cuda-9.0/lib64:$LD_LIBRARY_PATH\n\nRUN sed -i 's/archive.ubuntu.com/mirrors.ustc.edu.cn/g' /etc/apt/sources.list && \\\r\n    APT_INSTALL=\"apt-get install -y --no-install-recommends\" && \\\r\n    PIP_INSTALL=\"python -m pip --no-cache-dir install --upgrade -i https://pypi.tuna.tsinghua.edu.cn/simple\" && \\\r\n    GIT_CLONE=\"git clone --depth 10\" && \\\r\n    CONDA_INSTALL=\"conda install -y\" && \\\r\n    rm -rf /var/lib/apt/lists/* \\\r\n           /etc/apt/sources.list.d/cuda.list \\\r\n           /etc/apt/sources.list.d/nvidia-ml.list && \\\r\n    apt-get update && \\\r\n# ==================================================================\r\n# tools\r\n# ------------------------------------------------------------------\r\n    DEBIAN_FRONTEND=noninteractive $APT_INSTALL \\\r\n        apt-utils \\\r\n        build-essential \\\r\n        ca-certificates \\\r\n        cmake \\\r\n        wget \\\r\n        git \\\r\n        vim \\\r\n        openssh-client \\\r\n        openssh-server \\\r\n        libboost-dev \\\r\n        libboost-thread-dev \\\r\n        libboost-filesystem-dev \\\r\n        && \\\r\n# ==================================================================\r\n# miniconda\r\n# ------------------------------------------------------------------\r\n    wget --quiet https://repo.continuum.io/miniconda/Miniconda3-latest-Linux-x86_64.sh -O ~/miniconda.sh && \\\r\n        /bin/bash ~/miniconda.sh -b -p /opt/conda && \\\r\n        rm ~/miniconda.sh && \\\r\n        #echo \"export PATH=/opt/conda/bin:$PATH\" >> ~/.bashrc && \\\r\n# ==================================================================\r\n# conda\r\n# ------------------------------------------------------------------\r\n    conda config --set show_channel_urls yes && \\\r\n    conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free/ && \\\r\n    conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main/ && \\\r\n    conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/conda-forge/ && \\\r\n    $CONDA_INSTALL \\\r\n        python=3.6 && \\\r\n    $CONDA_INSTALL \\\r\n        ipython \\\r\n        Cython \\\r\n        ffmpeg \\\r\n        pytorch=0.4.0 \\\r\n        sk-video \\\r\n        imageio \\\r\n        h5py \\\r\n        tensorboardx \\\r\n        torchvision=0.2.1 \\\r\n        cffi \\\r\n        && \\\r\n    $PIP_INSTALL \\\r\n        lmdb \\\r\n        opencv-contrib-python \\\r\n        matplotlib \\\r\n        tqdm \\\r\n        scikit-learn \\\r\n        pytest \\\r\n        && \\\r\n    conda clean -y --all && \\\r\n# ==================================================================\r\n# warpctc\r\n# ------------------------------------------------------------------\r\n    $GIT_CLONE https://github.com/Rhythmblue/warp-ctc.git /usr/local/warp-ctc && \\\r\n    mkdir -p /usr/local/warp-ctc/build && cd /usr/local/warp-ctc/build && \\\r\n    cmake .. && \\\r\n    make -j 4 && \\\r\n    cd /usr/local/warp-ctc/pytorch_binding && python setup.py install && \\\r\n# ==================================================================\r\n# ctcdecode\r\n# ------------------------------------------------------------------\r\n    $GIT_CLONE --recursive https://github.com/Rhythmblue/ctcdecode.git /usr/local/ctcdecode && \\\r\n    cd /usr/local/ctcdecode && \\\n    pip install --no-cache-dir -i https://pypi.tuna.tsinghua.edu.cn/simple . && \\\n# ==================================================================\r\n# config & cleanup\r\n# ------------------------------------------------------------------\r\n    ldconfig && \\\n    apt-get clean && \\\n    apt-get autoremove && \\\n    rm -rf /var/lib/apt/lists/* /tmp/* ~/*\nEXPOSE 6006"
}