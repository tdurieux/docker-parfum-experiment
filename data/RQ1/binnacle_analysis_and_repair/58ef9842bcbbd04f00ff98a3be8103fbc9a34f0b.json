{
  "startTime": 1674245239975,
  "endTime": 1674245240125,
  "originalSmells": [
    {
      "rule": "npmCacheCleanAfterInstall",
      "position": {
        "lineStart": 5,
        "lineEnd": 5,
        "columnStart": 4,
        "columnEnd": 31
      }
    },
    {
      "rule": "npmCacheCleanAfterInstall",
      "position": {
        "lineStart": 9,
        "lineEnd": 9,
        "columnStart": 4,
        "columnEnd": 15
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "# UI build image\nFROM node:12.3.1 as frontend\n\nWORKDIR /web\n\nRUN npm install -g @angular/cli && npm cache clean --force;\n\nCOPY web/package.json web/package-lock.json /web/\n\nRUN npm install && npm cache clean --force;\n\nCOPY web/ /web/\n\nRUN ng build --configuration=production --base-href=/\n\n\n# Build image\nFROM golang:1.12.3-alpine AS builder\n\nENV GOFLAGS=\"-mod=readonly\"\n\nRUN apk add --update --no-cache ca-certificates make git curl mercurial bzr\n\nRUN mkdir -p /workspace\nWORKDIR /workspace\n\nARG GOPROXY\n\nCOPY go.* /workspace/\nRUN go mod download\n\nCOPY Makefile main-targets.mk /workspace/\nRUN make bin/packr2\n\nCOPY --from=frontend /web/dist/web /workspace/web/dist/web\nCOPY . /workspace\n\nARG BUILD_TARGET\n\nRUN make uibundle\n\nRUN set -xe && \\\n    if [[ \"${BUILD_TARGET}\" == \"debug\" ]]; then \\\n        cd /tmp; GOBIN=/workspace/build/debug go get github.com/go-delve/delve/cmd/dlv; cd -; \\\n        make build-debug; \\\n        mv build/debug /build; \\\n    else \\\n        make build-release; \\\n        mv build/release /build; \\\n    fi\n\n\n# Final image\nFROM alpine:3.9.3\n\nRUN apk add --update --no-cache ca-certificates tzdata bash curl\n\nARG BUILD_TARGET\n\nRUN if [[ \"${BUILD_TARGET}\" == \"debug\" ]]; then apk add --update --no-cache libc6-compat; fi\n\nCOPY --from=builder /build/* /usr/local/bin/\n\nCOPY configs /etc/cloudinfo/serviceconfig\n\nRUN sed -i \"s|dataLocation: ./configs/|dataLocation: /etc/cloudinfo/serviceconfig/|g\" /etc/cloudinfo/serviceconfig/services.yaml\n\nENV CLOUDINFO_SERVICELOADER_SERVICECONFIGLOCATION \"/etc/cloudinfo/serviceconfig\"\n\nCMD [\"cloudinfo\"]\n"
}