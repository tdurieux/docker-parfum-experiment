{
  "startTime": 1674244508165,
  "endTime": 1674244508202,
  "originalSmells": [
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 29,
        "lineEnd": 29,
        "columnStart": 4,
        "columnEnd": 117
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 29,
        "lineEnd": 29,
        "columnStart": 4,
        "columnEnd": 117
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "# Docker file for Xandikos.\n# This docker image starts a Xandikos server on port 8000. It supports two\n# environment variables:\n#\n# - autocreate: \"principal\" / \"defaults\"\n#     If set to \"yes\", this will create the user principal, but not any\n#     calendars or address books.\n#     If set to \"defaults\", it will create a default calendar\n#     (under $current_user_principal/calendars/calendar) and a default\n#     addressbook (under $current_user_principal/contacts/addressbook)\n#\n# - current_user_principal: /path/to/user/principal\n#    This specifies the path to the current users' principal, and effectively\n#    the path under which Xandikos will be available.\n#    It is recommended that you set it to \"/YOURUSERNAME\"\n#\n# E.g. If autocreate is set to \"defaults\" and current_user_principal is set to\n# \"/dav/joe\", Xandikos will provide two collections (one calendar, one\n# addressbook) at respecively:\n#\n#   http://localhost:8000/dav/joe/calendars/calendar\n#   http://localhost:8000/dav/joe/contacts/addressbook\n#\n# Note that this dockerfile starts Xandikos without any authentication;\n# for authenticated access we recommend you run it behind a reverse proxy.\n\nFROM debian:sid\nLABEL maintainer=\"jelmer@jelmer.uk\"\nRUN apt-get update && \\\n    apt-get -y --no-install-recommends install uwsgi uwsgi-plugin-python3 python3-icalendar python3-dulwich python3-jinja2 python3-defusedxml && \\\n    apt-get clean && rm -rf /var/lib/apt/lists/*;\nADD . /code\nWORKDIR /code\nVOLUME /data\nEXPOSE 8000\nENV autocreate=\"defaults\"\nENV current_user_principal=\"/user1\"\n\n# TODO(jelmer): Add support for authentication\n# --plugin=router_basicauth,python3  --route=\"^/ basicauth:myrealm,user1:password1\"\nCMD uwsgi --http-socket=:8000 \\\n          --umask=022 \\\n          --master \\\n          --cheaper=2 \\\n          --processes=4 \\\n          --plugin=python3 \\\n          --module=xandikos.wsgi:app \\\n          --env=XANDIKOSPATH=/data \\\n          --env=CURRENT_USER_PRINCIPAL=$current_user_principal \\\n          --env=AUTOCREATE=$autocreate\n"
}