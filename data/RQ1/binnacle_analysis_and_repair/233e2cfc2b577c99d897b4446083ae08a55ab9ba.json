{
  "startTime": 1674235437802,
  "endTime": 1674235438111,
  "originalSmells": [
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 10,
        "lineEnd": 29,
        "columnStart": 19,
        "columnEnd": 7
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 10,
        "lineEnd": 29,
        "columnStart": 19,
        "columnEnd": 7
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "# @file Dockerfile\n# @license The MIT License (MIT)\n# @copyright 2016 Alex <alex@maximum.guru>\n\nFROM ubuntu:16.04\n\nMAINTAINER Alex <alex@maximum.guru>\n\n# install alpine packages\nRUN { \\\n\tapt-get update && apt-get install --no-install-recommends -yq \\\n\tbash \\\n\tiptables \\\n\tnet-tools \\\n\tiproute2 \\\n\tinetutils-ping \\\n\tlua5.1 \\\n\tlua-filesystem \\\n\tliblua5.1-0-dev \\\n\tbuild-essential \\\n\tluarocks \\\n\tgit \\\n\tnodejs \\\n\tpython \\\n\tlinux-headers-generic \\\n\tunzip \\\n\tlibsqlite3-dev \\\n\tsqlite3 \\\n\tkmod \\\n\tpsmisc \\\n\t; \\\n} && rm -rf /var/lib/apt/lists/*;\n\nRUN { \\\n\trm /bin/sh && \\\n\tln -s bash /bin/sh; \\\n}\n\n# install lua dependencies\nRUN { \\\n\tluarocks install luasocket && \\\n\tluarocks install cgilua && \\\n\tluarocks install lua-cjson && \\\n\tluarocks install inifile && \\\n\tluarocks install xavante && \\\n\tluarocks install wsapi-xavante && \\\n\tluarocks install jsonrpc4lua && \\\n\tluarocks install sha2 && \\\n\tluarocks install bencode && \\\n\tluarocks install dkjson && \\\n\tluarocks install bit32 && \\\n\tluarocks install alt-getopt && \\\n\tluarocks install luaproc && \\\n\tluarocks install luasql-sqlite3; \\\n}\n\nWORKDIR /\n\n# install cjdns\nRUN { \\\n\tgit clone --depth=1 https://github.com/cjdelisle/cjdns.git -b cjdns-v20 && \\\n\tcd cjdns && ./do && install -m755 -oroot -groot cjdroute /usr/sbin/cjdroute && \\\n\trm -rf /cjdns; \\\n}\n\n# install container scripts\nCOPY ./docker/* /\nCOPY ./docker/transitd-cli /usr/sbin/transitd-cli\n\n# install transitd and patch dependencies\nCOPY ./src/ /transitd/src/\nCOPY ./transitd.conf.sample /transitd/transitd.conf.sample\nCOPY ./patches/ /transitd/patches/\nRUN { \\\n\tpatch -p0 /usr/local/share/lua/5.1/socket/http.lua /transitd/patches/luasocket-ipv6-fix.patch && \\\n\tpatch -p0 /usr/local/share/lua/5.1/cgilua/post.lua /transitd/patches/cgilua-content-type-fix.patch; \\\n}\n\n# cleanup\nRUN { \\\n\tapt-get purge -y --auto-remove liblua5.1-0-dev build-essential luarocks git nodejs python linux-headers-generic unzip libsqlite3-dev; \\\n\tapt-get autoremove; \\\n\tapt-get clean; \\\n\trm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/*; \\\n}\n\nCMD [\"/start.sh\"]\nEXPOSE 65533\n"
}