{
  "startTime": 1674252055165,
  "endTime": 1674252055300,
  "originalSmells": [
    {
      "rule": "npmCacheCleanAfterInstall",
      "position": {
        "lineStart": 20,
        "lineEnd": 20,
        "columnStart": 4,
        "columnEnd": 25
      }
    },
    {
      "rule": "npmCacheCleanAfterInstall",
      "position": {
        "lineStart": 21,
        "lineEnd": 21,
        "columnStart": 4,
        "columnEnd": 42
      }
    },
    {
      "rule": "wgetUseHttpsUrl",
      "position": {
        "lineStart": 27,
        "lineEnd": 27,
        "columnStart": 4,
        "columnEnd": 67
      }
    },
    {
      "rule": "wgetUseHttpsUrl",
      "position": {
        "lineStart": 35,
        "lineEnd": 35,
        "columnStart": 4,
        "columnEnd": 87
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 17,
        "lineEnd": 17,
        "columnStart": 4,
        "columnEnd": 22
      }
    },
    {
      "rule": "tarSomethingRmTheSomething",
      "position": {
        "lineStart": 36,
        "lineEnd": 36,
        "columnStart": 15,
        "columnEnd": 38
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 16,
        "lineEnd": 16,
        "columnStart": 4,
        "columnEnd": 70
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 16,
        "lineEnd": 16,
        "columnStart": 4,
        "columnEnd": 70
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 16,
        "lineEnd": 16,
        "columnStart": 4,
        "columnEnd": 70
      }
    }
  ],
  "repairedSmells": [
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 15,
        "lineEnd": 15,
        "columnStart": 4,
        "columnEnd": 94
      }
    }
  ],
  "repairedDockerfile": "FROM ubuntu:14.04\n\n# statsd udp data (send rbx data to this port)\nEXPOSE 8125/udp\n# statsd management\nEXPOSE 8126\n# influxdb management UI\nEXPOSE 8083\n# influxdb API\nEXPOSE 8086\n# grafana dashboard UI\nEXPOSE 80\n\n# Install some basic utilities with the OS package manager\nRUN apt-get update -y && apt-get upgrade -y\nRUN apt-get install --no-install-recommends -y wget curl python-pip supervisor nginx-light npm && rm -rf /var/lib/apt/lists/*;\nRUN pip install --no-cache-dir envtpl\n\n# Install statsd and backend and configuration\nRUN npm -g install statsd && npm cache clean --force;\nRUN npm -g install statsd-influxdb-backend && npm cache clean --force;\nADD statsd/config.js /statsd/config.js\n# Symbolic link because statsd expects a binary called `node`\nRUN ln -s /usr/bin/nodejs /usr/bin/node\n\n# Install influxdb and setup script\nRUN wget https://s3.amazonaws.com/influxdb/influxdb_latest_amd64.deb\nRUN dpkg -i influxdb_latest_amd64.deb\nADD influxdb/setup.sh /influxdb/setup.sh\n# Set up influxdb and create the databases\nRUN influxdb/setup.sh\n\n# Install grafana and configuration\nRUN mkdir /src\nRUN wget https://grafanarel.s3.amazonaws.com/grafana-1.9.0.tar.gz -O /src/grafana.tar.gz\nRUN cd /src && tar -xvf grafana.tar.gz && mv grafana-1.9.0 grafana && rm grafana.tar.gz\nADD grafana/config.js.tpl /src/grafana/config.js.tpl\nADD grafana/rbx-dash.json /src/grafana/app/dashboards/rbx-dash.json\nADD grafana/setup.sh /src/grafana/setup.sh\n# Add nginx configuration\nADD nginx/nginx.conf /etc/nginx/nginx.conf\n\n# Add supervisord configuration and set default command for `docker run`\nADD supervisord/supervisord.conf /etc/supervisor/conf.d/supervisord.conf\nCMD [\"/usr/bin/supervisord\", \"-c\", \"/etc/supervisor/conf.d/supervisord.conf\"]\n"
}