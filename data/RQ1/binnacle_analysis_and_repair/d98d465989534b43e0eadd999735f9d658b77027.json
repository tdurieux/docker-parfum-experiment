{
  "startTime": 1674250464559,
  "endTime": 1674250464795,
  "originalSmells": [
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 28,
        "lineEnd": 42,
        "columnStart": 25,
        "columnEnd": 8
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "# Â© Copyright IBM Corporation 2017, 2019.\n# LICENSE: Apache License, Version 2.0 (http://www.apache.org/licenses/LICENSE-2.0)\n\n########## Dockerfile for Joomla version 3.9.6 ######\n#\n# Joomla is an online, open source website creation tool written in PHP.\n#\n# To build Joomla image from the directory containing this Dockerfile\n# (assuming that the file is named \"Dockerfile\"):\n# docker build -t <image_name> .\n#\n# To start Joomla server run the below command\n# docker run --name <container_name> -p <port_number>:80 -p <port_number_mysql>:3306 -d <image_name>\n#\n# We can view the Joomla UI at http://<Joomla-host-ip>:<port_number>/Joomla\n#\n##################################################################################\n\n# Base Image\nFROM s390x/ubuntu:16.04\n\n# The author\nLABEL maintainer=\"LoZ Open Source Ecosystem (https://www.ibm.com/developerworks/community/groups/community/lozopensource)\"\nENV DEBIAN_FRONTEND noninteractive\n\nARG JOOMLA_VER=3.9.6\n\n# Install dependencies\nRUN apt-get update -y && apt-get install --no-install-recommends -y \\\n    apache2 \\\n    curl \\\n    libapache2-mod-php7.0 \\\n    libapache2-mod-perl2 \\\n    mysql-server \\\n    php7.0 \\\n    php7.0-mysql \\\n    php7.0-mcrypt \\\n    php7.0-cli \\\n    php7.0-common \\\n    php7.0-curl \\\n    php7.0-dev \\\n    unzip \\\n    wget \\\n\n# Configure apache2 server\n && chmod 766 /etc/apache2/apache2.conf \\\n && cp /etc/apache2/apache2.conf /etc/apache2/apache2.conf1 \\\n && cp echo -e \"ServerName localhost\" >> /etc/apache2/apache2.conf \\\n && cp echo -e '<Directory \"/var/www/html\">' >> /etc/apache2/apache2.conf \\\n && cp echo -e \"AllowOverride  All\" >> /etc/apache2/apache2.conf \\\n && cp echo -e \"</Directory>\" >> /etc/apache2/apache2.conf \\\n && diff -u /etc/apache2/apache2.conf1 /etc/apache2/apache2.conf || true \\\n && a2enmod rewrite \\\n\n# Download and install Joomla\n && cd /var/www/html/ \\\n && chmod -R a+w /var/www/html/ \\\n && mkdir Joomla \\\n && cd Joomla \\\n && wget https://github.com/joomla/joomla-cms/releases/download/${JOOMLA_VER}/Joomla_${JOOMLA_VER}-Stable-Full_Package.zip \\\n && unzip Joomla_${JOOMLA_VER}-Stable-Full_Package.zip \\\n && chmod a+w /var/www/html/Joomla/ \\\n && mv installation/configuration.php-dist installation/configuration.php \\\n && chown -R www-data:www-data ./installation \\\n\n# Start mysql server and create database for Joomla\n && mkdir -p /var/lib/mysql/data \\\n && /usr/sbin/mysqld --initialize --user=mysql --datadir=/var/lib/mysql/data \\\n && sleep 60s && mkdir -p /var/run/mysqld \\\n && chown mysql:mysql /var/run/mysqld \\\n && service mysql start && sleep 15s && /usr/bin/mysql -e \"create database Joomla\" \\\n && /usr/bin/mysql -e \"create user 'user'@'localhost' \" \\\n && /usr/bin/mysql -e \"grant all privileges on *.* to 'user'@'localhost'\" \\\n\n# Create a script to start apache2 and mysql\n && echo 'chown -R mysql:mysql /var/lib/mysql /var/run/mysqld && service apache2 start && /usr/bin/mysqld_safe --user=mysql' > /start.sh \\\n\n# Clean up of unused packages\n && apt-get remove -y \\\n    curl  \\\n    unzip \\\n    wget \\\n && apt-get autoremove -y \\\n && apt autoremove -y \\\n && apt-get clean \\\n && rm -rf  /var/lib/apt/lists/* \\\n && rm  /var/www/html/Joomla/Joomla_${JOOMLA_VER}-Stable-Full_Package.zip\n# Create volume\nVOLUME /var/www/html\n\n# Expose ports for mysql and apache2\nEXPOSE 80 3306\n\n# Start apache2 and mysql server\nCMD [\"/bin/sh\", \"start.sh\"]\n"
}