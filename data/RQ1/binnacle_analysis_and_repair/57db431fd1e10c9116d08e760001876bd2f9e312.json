{
  "startTime": 1674241799308,
  "endTime": 1674241800502,
  "originalSmells": [
    {
      "rule": "npmCacheCleanAfterInstall",
      "position": {
        "lineStart": 93,
        "lineEnd": 93,
        "columnStart": 0,
        "columnEnd": 11
      }
    },
    {
      "rule": "npmCacheCleanAfterInstall",
      "position": {
        "lineStart": 99,
        "lineEnd": 99,
        "columnStart": 0,
        "columnEnd": 26
      }
    },
    {
      "rule": "npmCacheCleanAfterInstall",
      "position": {
        "lineStart": 130,
        "lineEnd": 130,
        "columnStart": 0,
        "columnEnd": 11
      }
    },
    {
      "rule": "yarnCacheCleanAfterInstall",
      "position": {
        "lineStart": 100,
        "lineEnd": 100,
        "columnStart": 0,
        "columnEnd": 12
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 136,
        "lineEnd": 136,
        "columnStart": 18,
        "columnEnd": 71
      }
    },
    {
      "rule": "tarSomethingRmTheSomething",
      "position": {
        "lineStart": 105,
        "lineEnd": 105,
        "columnStart": 0,
        "columnEnd": 35
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 4,
        "lineEnd": 4,
        "columnStart": 0,
        "columnEnd": 70
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 7,
        "lineEnd": 7,
        "columnStart": 4,
        "columnEnd": 35
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 10,
        "lineEnd": 10,
        "columnStart": 4,
        "columnEnd": 34
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 13,
        "lineEnd": 13,
        "columnStart": 4,
        "columnEnd": 33
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 16,
        "lineEnd": 16,
        "columnStart": 4,
        "columnEnd": 29
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 19,
        "lineEnd": 19,
        "columnStart": 4,
        "columnEnd": 52
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 24,
        "lineEnd": 24,
        "columnStart": 4,
        "columnEnd": 41
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 33,
        "lineEnd": 36,
        "columnStart": 4,
        "columnEnd": 45
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 38,
        "lineEnd": 41,
        "columnStart": 4,
        "columnEnd": 44
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 59,
        "lineEnd": 59,
        "columnStart": 1,
        "columnEnd": 58
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 60,
        "lineEnd": 60,
        "columnStart": 1,
        "columnEnd": 62
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 61,
        "lineEnd": 61,
        "columnStart": 1,
        "columnEnd": 47
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 62,
        "lineEnd": 62,
        "columnStart": 1,
        "columnEnd": 56
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 63,
        "lineEnd": 63,
        "columnStart": 1,
        "columnEnd": 41
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 66,
        "lineEnd": 66,
        "columnStart": 4,
        "columnEnd": 37
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 67,
        "lineEnd": 67,
        "columnStart": 0,
        "columnEnd": 103
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 79,
        "lineEnd": 79,
        "columnStart": 4,
        "columnEnd": 38
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 84,
        "lineEnd": 84,
        "columnStart": 0,
        "columnEnd": 28
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 86,
        "lineEnd": 86,
        "columnStart": 4,
        "columnEnd": 55
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 87,
        "lineEnd": 87,
        "columnStart": 4,
        "columnEnd": 78
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 103,
        "lineEnd": 103,
        "columnStart": 4,
        "columnEnd": 30
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 109,
        "lineEnd": 109,
        "columnStart": 4,
        "columnEnd": 50
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 125,
        "lineEnd": 125,
        "columnStart": 4,
        "columnEnd": 40
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 126,
        "lineEnd": 126,
        "columnStart": 0,
        "columnEnd": 41
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 7,
        "lineEnd": 7,
        "columnStart": 4,
        "columnEnd": 35
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 10,
        "lineEnd": 10,
        "columnStart": 4,
        "columnEnd": 34
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 13,
        "lineEnd": 13,
        "columnStart": 4,
        "columnEnd": 33
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 16,
        "lineEnd": 16,
        "columnStart": 4,
        "columnEnd": 29
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 19,
        "lineEnd": 19,
        "columnStart": 4,
        "columnEnd": 52
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 24,
        "lineEnd": 24,
        "columnStart": 4,
        "columnEnd": 41
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 33,
        "lineEnd": 36,
        "columnStart": 4,
        "columnEnd": 45
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 38,
        "lineEnd": 41,
        "columnStart": 4,
        "columnEnd": 44
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 66,
        "lineEnd": 66,
        "columnStart": 4,
        "columnEnd": 37
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 67,
        "lineEnd": 67,
        "columnStart": 0,
        "columnEnd": 103
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 79,
        "lineEnd": 79,
        "columnStart": 4,
        "columnEnd": 38
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 86,
        "lineEnd": 86,
        "columnStart": 4,
        "columnEnd": 55
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 87,
        "lineEnd": 87,
        "columnStart": 4,
        "columnEnd": 78
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 103,
        "lineEnd": 103,
        "columnStart": 4,
        "columnEnd": 30
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 109,
        "lineEnd": 109,
        "columnStart": 4,
        "columnEnd": 50
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 125,
        "lineEnd": 125,
        "columnStart": 4,
        "columnEnd": 40
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 126,
        "lineEnd": 126,
        "columnStart": 0,
        "columnEnd": 41
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 4,
        "lineEnd": 4,
        "columnStart": 0,
        "columnEnd": 70
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 7,
        "lineEnd": 7,
        "columnStart": 4,
        "columnEnd": 35
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 10,
        "lineEnd": 10,
        "columnStart": 4,
        "columnEnd": 34
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 13,
        "lineEnd": 13,
        "columnStart": 4,
        "columnEnd": 33
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 16,
        "lineEnd": 16,
        "columnStart": 4,
        "columnEnd": 29
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 19,
        "lineEnd": 19,
        "columnStart": 4,
        "columnEnd": 52
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 24,
        "lineEnd": 24,
        "columnStart": 4,
        "columnEnd": 41
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 33,
        "lineEnd": 36,
        "columnStart": 4,
        "columnEnd": 45
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 38,
        "lineEnd": 41,
        "columnStart": 4,
        "columnEnd": 44
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 59,
        "lineEnd": 59,
        "columnStart": 1,
        "columnEnd": 58
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 60,
        "lineEnd": 60,
        "columnStart": 1,
        "columnEnd": 62
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 61,
        "lineEnd": 61,
        "columnStart": 1,
        "columnEnd": 47
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 62,
        "lineEnd": 62,
        "columnStart": 1,
        "columnEnd": 56
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 63,
        "lineEnd": 63,
        "columnStart": 1,
        "columnEnd": 41
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 66,
        "lineEnd": 66,
        "columnStart": 4,
        "columnEnd": 37
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 67,
        "lineEnd": 67,
        "columnStart": 0,
        "columnEnd": 103
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 79,
        "lineEnd": 79,
        "columnStart": 4,
        "columnEnd": 38
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 84,
        "lineEnd": 84,
        "columnStart": 0,
        "columnEnd": 28
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 86,
        "lineEnd": 86,
        "columnStart": 4,
        "columnEnd": 55
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 87,
        "lineEnd": 87,
        "columnStart": 4,
        "columnEnd": 78
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 103,
        "lineEnd": 103,
        "columnStart": 4,
        "columnEnd": 30
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 109,
        "lineEnd": 109,
        "columnStart": 4,
        "columnEnd": 50
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 125,
        "lineEnd": 125,
        "columnStart": 4,
        "columnEnd": 40
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 126,
        "lineEnd": 126,
        "columnStart": 0,
        "columnEnd": 41
      }
    }
  ],
  "repairedSmells": [
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 7,
        "lineEnd": 7,
        "columnStart": 4,
        "columnEnd": 59
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 10,
        "lineEnd": 10,
        "columnStart": 4,
        "columnEnd": 58
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 13,
        "lineEnd": 13,
        "columnStart": 4,
        "columnEnd": 57
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 16,
        "lineEnd": 16,
        "columnStart": 4,
        "columnEnd": 53
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 19,
        "lineEnd": 19,
        "columnStart": 4,
        "columnEnd": 76
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 24,
        "lineEnd": 24,
        "columnStart": 4,
        "columnEnd": 65
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 33,
        "lineEnd": 36,
        "columnStart": 4,
        "columnEnd": 45
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 38,
        "lineEnd": 41,
        "columnStart": 4,
        "columnEnd": 44
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 66,
        "lineEnd": 66,
        "columnStart": 4,
        "columnEnd": 61
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 67,
        "lineEnd": 67,
        "columnStart": 1,
        "columnEnd": 128
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 79,
        "lineEnd": 79,
        "columnStart": 4,
        "columnEnd": 62
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 86,
        "lineEnd": 86,
        "columnStart": 4,
        "columnEnd": 79
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 87,
        "lineEnd": 87,
        "columnStart": 4,
        "columnEnd": 102
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 103,
        "lineEnd": 103,
        "columnStart": 4,
        "columnEnd": 54
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 109,
        "lineEnd": 109,
        "columnStart": 4,
        "columnEnd": 74
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 125,
        "lineEnd": 125,
        "columnStart": 4,
        "columnEnd": 64
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 126,
        "lineEnd": 126,
        "columnStart": 1,
        "columnEnd": 66
      }
    }
  ],
  "repairedDockerfile": "FROM ubuntu:12.04\nRUN locale-gen en_US.UTF-8 &&\\\n\tupdate-locale LANG=en_US.UTF-8 LC_ALL=en_US.UTF-8\nRUN apt-get update && \\\n apt-get install --no-install-recommends -q -y autoconf binutils-doc bison build-essential flex && rm -rf /var/lib/apt/lists/*;\n\n#apt-utils\nRUN apt-get install --no-install-recommends -q -y apt-utils && rm -rf /var/lib/apt/lists/*;\n\n#ruby-rvm\nRUN apt-get install --no-install-recommends -q -y ruby-rvm && rm -rf /var/lib/apt/lists/*;\n\n#varnish\nRUN apt-get install --no-install-recommends -q -y varnish && rm -rf /var/lib/apt/lists/*;\n\n#git\nRUN apt-get install --no-install-recommends -q -y git && rm -rf /var/lib/apt/lists/*;\n\n#apt tools\nRUN apt-get install --no-install-recommends -q -y python-software-properties && rm -rf /var/lib/apt/lists/*;\n\nRUN add-apt-repository ppa:cartodb/gcc &&\\\n apt-get update\n\nRUN apt-get install --no-install-recommends -q -y gcc-4.9 g++-4.9 && rm -rf /var/lib/apt/lists/*;\n\nENV CC=/usr/bin/gcc-4.9\nENV CXX=/usr/bin/g++-4.9\n\n#postgresql\nRUN add-apt-repository ppa:cartodb/postgresql-9.5 && apt-get update\n\n#client packages\nRUN apt-get install --no-install-recommends -q -y libpq5 \\\n                     libpq-dev \\\n                     postgresql-client-9.5 \\\n                     postgresql-client-common && rm -rf /var/lib/apt/lists/*;\n#server packages\nRUN apt-get install --no-install-recommends -q -y postgresql-9.5 \\\n                     postgresql-contrib-9.5 \\\n                     postgresql-server-dev-9.5 \\\n                     postgresql-plpython-9.5 && rm -rf /var/lib/apt/lists/*;\n\n#PostgreSQL Config\nRUN sed -i 's/\\(peer\\|md5\\)/trust/' /etc/postgresql/9.5/main/pg_hba.conf\n\n#create users\nRUN service postgresql start && \\\ncreateuser publicuser --no-createrole --no-createdb --no-superuser -U postgres && \\\ncreateuser tileuser --no-createrole --no-createdb --no-superuser -U postgres && \\\nservice postgresql stop\n\n#carto postgres extension\nRUN git clone https://github.com/CartoDB/cartodb-postgresql.git &&\\\ncd cartodb-postgresql &&\\\nPGUSER=postgres make install\n\n#GIS dependencies\nRUN apt-get upgrade -q -y && add-apt-repository ppa:cartodb/gis && apt-get update && \\\n apt-get install --no-install-recommends -q -y proj proj-bin proj-data libproj-dev && \\\n apt-get install --no-install-recommends -q -y libjson0 libjson0-dev python-simplejson && \\\n apt-get install --no-install-recommends -q -y libgeos-c1v5 libgeos-dev && \\\n apt-get install --no-install-recommends -q -y gdal-bin libgdal1-dev libgdal-dev && \\\n apt-get install --no-install-recommends -q -y gdal2.1-static-bin && rm -rf /var/lib/apt/lists/*;\n\n#postgis\nRUN apt-get -q --no-install-recommends -y install libxml2-dev && \\\n apt-get install --no-install-recommends -q -y liblwgeom-2.2.2 postgis postgresql-9.5-postgis-2.2 postgresql-9.5-postgis-scripts && rm -rf /var/lib/apt/lists/*;\n\n#postgis setup\nRUN service postgresql start && \\\n  createdb -T template0 -O postgres -U postgres -E UTF8 template_postgis &&\\\n  psql -U postgres template_postgis -c 'CREATE EXTENSION postgis;CREATE EXTENSION postgis_topology;' &&\\\n  ldconfig &&\\\n  service postgresql stop\n\n#redis\nRUN add-apt-repository ppa:cartodb/redis && apt-get update\n\nRUN apt-get install --no-install-recommends -q -y redis-server && rm -rf /var/lib/apt/lists/*;\n\n#nodejs\nRUN add-apt-repository ppa:cartodb/nodejs &&\\\napt-get update && \\\n apt-get install --no-install-recommends -q -y nodejs && rm -rf /var/lib/apt/lists/*;\n\nRUN apt-get install --no-install-recommends -q -y libpixman-1-0 libpixman-1-dev && rm -rf /var/lib/apt/lists/*;\nRUN apt-get install --no-install-recommends -q -y libcairo2-dev libjpeg-dev libgif-dev libpango1.0-dev && rm -rf /var/lib/apt/lists/*;\n\n#SQL API\nRUN git clone git://github.com/CartoDB/CartoDB-SQL-API.git &&\\\ncd CartoDB-SQL-API &&\\\ngit checkout master && \\\nnpm install && npm cache clean --force;\n\n#MAPS API:\nRUN git clone git://github.com/CartoDB/Windshaft-cartodb.git &&\\\ncd Windshaft-cartodb &&\\\ngit checkout master &&\\\nnpm install -g yarn@0.27.5 && \\\nyarn install && npm cache clean --force; && yarn cache clean;\n\n#Ruby\nRUN apt-get install --no-install-recommends -q -y wget && \\\nwget -O ruby-install-0.5.0.tar.gz https://github.com/postmodern/ruby-install/archive/v0.5.0.tar.gz && \\\ntar -xzvf ruby-install-0.5.0.tar.gz && \\\ncd ruby-install-0.5.0/ && \\\nmake install && rm ruby-install-0.5.0.tar.gz && rm -rf /var/lib/apt/lists/*;\n\nRUN apt-get -q --no-install-recommends -y install libreadline6-dev openssl && \\\nruby-install ruby 2.2.3 && rm -rf /var/lib/apt/lists/*;\n\nENV PATH=$PATH:/opt/rubies/ruby-2.2.3/bin\n\nRUN gem install bundler --version=1.17.3 &&\\\ngem install compass\n\nENV RAILS_ENV production\n\n#Carto Editor\nRUN git clone --recursive https://github.com/CartoDB/cartodb.git &&\\\ncd cartodb &&\\\nwget  -O /tmp/get-pip.py https://bootstrap.pypa.io/get-pip.py &&\\\npython /tmp/get-pip.py\n\nRUN apt-get install --no-install-recommends -q -y python-all-dev && \\\n apt-get install --no-install-recommends -q -y imagemagick unp zip && rm -rf /var/lib/apt/lists/*;\n\nRUN cd cartodb &&\\\nbundle install && \\\nnpm install && npm cache clean --force;\n\nENV CPLUS_INCLUDE_PATH=/usr/include/gdal\nENV C_INCLUDE_PATH=/usr/include/gdal\nENV PATH=$PATH:/usr/include/gdal\n\nRUN cd cartodb && pip install --no-cache-dir --no-use-wheel -r python_requirements.txt\n\n\n#Config Files\nADD ./config/SQLAPI-prod.js \\\n      /CartoDB-SQL-API/config/environments/production.js\nADD ./config/WS-prod.js \\\n      /Windshaft-cartodb/config/environments/production.js\nADD ./config/app_config.yml /cartodb/config/app_config.yml\nADD ./config/database.yml /cartodb/config/database.yml\nADD ./config/grunt_production.json /cartodb/config/grunt_production.json\n\nRUN locale-gen en_US.UTF-8\nENV LANG en_US.UTF-8\nENV LANGUAGE en_US:en\nENV LC_ALL en_US.UTF-8\n\n\nRUN cd cartodb &&\\\n    export PATH=$PATH:$PWD/node_modules/grunt-cli/bin &&\\\n    bundle install &&\\\n    bundle exec grunt --environment production\n\nRUN service postgresql start && service redis-server start &&\\\n    cd cartodb &&\\\n    bundle exec rake db:create &&\\\n    bundle exec rake db:migrate &&\\\n    service postgresql stop && service redis-server stop\n\n\nADD ./create_user /cartodb/script/create_user\nRUN service postgresql start && service redis-server start && \\\n\tbash -l -c \"cd /cartodb && bash script/create_user\" && \\\n\tservice postgresql stop && service redis-server stop\n\nEXPOSE 3000 8080 8181\n\nENV GDAL_DATA /usr/share/gdal/2.1\n\nADD ./startup.sh /opt/startup.sh\nADD ./config/varnish /etc/default/varnish\n\nVOLUME  [\"/etc/postgresql\", \"/var/log/postgresql\", \"/var/lib/postgresql\"]\n\nCMD [\"/bin/bash\", \"/opt/startup.sh\"]\n"
}