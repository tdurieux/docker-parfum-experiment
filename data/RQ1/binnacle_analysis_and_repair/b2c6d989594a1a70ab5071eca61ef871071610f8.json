{
  "startTime": 1674244271489,
  "endTime": 1674244271656,
  "originalSmells": [
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 36,
        "lineEnd": 36,
        "columnStart": 4,
        "columnEnd": 21
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 37,
        "lineEnd": 37,
        "columnStart": 4,
        "columnEnd": 33
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 33,
        "lineEnd": 33,
        "columnStart": 4,
        "columnEnd": 56
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 34,
        "lineEnd": 34,
        "columnStart": 4,
        "columnEnd": 61
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 33,
        "lineEnd": 33,
        "columnStart": 4,
        "columnEnd": 56
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 34,
        "lineEnd": 34,
        "columnStart": 4,
        "columnEnd": 61
      }
    }
  ],
  "repairedSmells": [
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 33,
        "lineEnd": 33,
        "columnStart": 4,
        "columnEnd": 56
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 34,
        "lineEnd": 34,
        "columnStart": 4,
        "columnEnd": 61
      }
    }
  ],
  "repairedDockerfile": "FROM ubuntu:bionic\n\nWORKDIR /home/\nENV P4C_DEPS bison \\\n             build-essential \\\n             cmake \\\n             git \\\n             flex \\\n             libboost-dev \\\n             libboost-graph-dev \\\n             libboost-iostreams-dev \\\n             libfl-dev \\\n             libgc-dev \\\n             libgmp-dev \\\n             pkg-config \\\n             python-ipaddr \\\n             python-pip \\\n             python-setuptools\n\nENV P4C_EBPF_DEPS libpcap-dev \\\n             libelf-dev \\\n             llvm \\\n             clang \\\n             libprotobuf-dev \\\n             protobuf-compiler \\\n             iproute2 \\\n             tcpdump\n\nENV P4C_PIP_PACKAGES pyroute2 \\\n                     ply==3.8 \\\n                     scapy==2.4.0\n\nRUN apt-get update\nRUN apt-get install -y --no-install-recommends $P4C_DEPS && rm -rf /var/lib/apt/lists/*;\nRUN apt-get install -y --no-install-recommends $P4C_EBPF_DEPS && rm -rf /var/lib/apt/lists/*;\n# in some cases wheel is needed to install pip packages\nRUN pip install --no-cache-dir wheel\nRUN pip install --no-cache-dir $P4C_PIP_PACKAGES\n\n# p4c download begin\nRUN git clone https://github.com/p4lang/p4c.git && \\\n    cd p4c && \\\n    git submodule update --init --recursive && \\\n    git submodule update --recursive && \\\n    mkdir extensions\n# p4c download end\n\n# copy xdp into the extension folder\nCOPY . /home/p4c/extensions/p4c-xdp\nRUN ln -s /home/p4c /home/p4c/extensions/p4c-xdp\n\n# build p4c and p4c-xdp\nRUN cd /home/p4c/ && \\\n    mkdir -p build && \\\n    cd build && \\\n    cmake .. && \\\n    make -j `getconf _NPROCESSORS_ONLN` && \\\n    make install && \\\n    cd ..\n\n# p4c-xdp setup begin\nRUN cd /home/p4c/extensions/p4c-xdp/ && \\\n    # link the compiler\n    ln -sf /home/p4c/build/p4c-xdp p4c-xdp && \\\n    # add xdp to the ebpf backend target folder\n    ln -sf /home/p4c/extensions/p4c-xdp/xdp_target.py /home/p4c/backends/ebpf/targets/xdp_target.py && \\\n    ln -sf /home/p4c/backends/ebpf/run-ebpf-test.py /home/p4c/extensions/p4c-xdp/run-ebpf-test.py\n# p4c-xdp setup end\n"
}