{
  "startTime": 1674236536716,
  "endTime": 1674236537484,
  "originalSmells": [
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 128,
        "lineEnd": 128,
        "columnStart": 4,
        "columnEnd": 57
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 13,
        "lineEnd": 13,
        "columnStart": 4,
        "columnEnd": 64
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 18,
        "lineEnd": 18,
        "columnStart": 4,
        "columnEnd": 68
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 23,
        "lineEnd": 23,
        "columnStart": 4,
        "columnEnd": 114
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 26,
        "lineEnd": 26,
        "columnStart": 4,
        "columnEnd": 158
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 29,
        "lineEnd": 29,
        "columnStart": 4,
        "columnEnd": 81
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 33,
        "lineEnd": 33,
        "columnStart": 4,
        "columnEnd": 69
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 36,
        "lineEnd": 36,
        "columnStart": 4,
        "columnEnd": 74
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 41,
        "lineEnd": 41,
        "columnStart": 4,
        "columnEnd": 62
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 56,
        "lineEnd": 58,
        "columnStart": 4,
        "columnEnd": 17
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 65,
        "lineEnd": 65,
        "columnStart": 4,
        "columnEnd": 60
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 92,
        "lineEnd": 92,
        "columnStart": 4,
        "columnEnd": 119
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 97,
        "lineEnd": 97,
        "columnStart": 4,
        "columnEnd": 66
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 101,
        "lineEnd": 101,
        "columnStart": 4,
        "columnEnd": 84
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 108,
        "lineEnd": 108,
        "columnStart": 4,
        "columnEnd": 131
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 119,
        "lineEnd": 119,
        "columnStart": 4,
        "columnEnd": 87
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 13,
        "lineEnd": 13,
        "columnStart": 4,
        "columnEnd": 64
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 18,
        "lineEnd": 18,
        "columnStart": 4,
        "columnEnd": 68
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 23,
        "lineEnd": 23,
        "columnStart": 4,
        "columnEnd": 114
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 26,
        "lineEnd": 26,
        "columnStart": 4,
        "columnEnd": 158
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 29,
        "lineEnd": 29,
        "columnStart": 4,
        "columnEnd": 81
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 33,
        "lineEnd": 33,
        "columnStart": 4,
        "columnEnd": 69
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 36,
        "lineEnd": 36,
        "columnStart": 4,
        "columnEnd": 74
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 41,
        "lineEnd": 41,
        "columnStart": 4,
        "columnEnd": 62
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 56,
        "lineEnd": 58,
        "columnStart": 4,
        "columnEnd": 17
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 65,
        "lineEnd": 65,
        "columnStart": 4,
        "columnEnd": 60
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 92,
        "lineEnd": 92,
        "columnStart": 4,
        "columnEnd": 119
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 97,
        "lineEnd": 97,
        "columnStart": 4,
        "columnEnd": 66
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 101,
        "lineEnd": 101,
        "columnStart": 4,
        "columnEnd": 84
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 108,
        "lineEnd": 108,
        "columnStart": 4,
        "columnEnd": 131
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 119,
        "lineEnd": 119,
        "columnStart": 4,
        "columnEnd": 87
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 13,
        "lineEnd": 13,
        "columnStart": 4,
        "columnEnd": 64
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 18,
        "lineEnd": 18,
        "columnStart": 4,
        "columnEnd": 68
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 23,
        "lineEnd": 23,
        "columnStart": 4,
        "columnEnd": 114
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 26,
        "lineEnd": 26,
        "columnStart": 4,
        "columnEnd": 158
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 29,
        "lineEnd": 29,
        "columnStart": 4,
        "columnEnd": 81
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 33,
        "lineEnd": 33,
        "columnStart": 4,
        "columnEnd": 69
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 36,
        "lineEnd": 36,
        "columnStart": 4,
        "columnEnd": 74
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 41,
        "lineEnd": 41,
        "columnStart": 4,
        "columnEnd": 62
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 56,
        "lineEnd": 58,
        "columnStart": 4,
        "columnEnd": 17
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 65,
        "lineEnd": 65,
        "columnStart": 4,
        "columnEnd": 60
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 92,
        "lineEnd": 92,
        "columnStart": 4,
        "columnEnd": 119
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 97,
        "lineEnd": 97,
        "columnStart": 4,
        "columnEnd": 66
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 101,
        "lineEnd": 101,
        "columnStart": 4,
        "columnEnd": 84
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 108,
        "lineEnd": 108,
        "columnStart": 4,
        "columnEnd": 131
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 119,
        "lineEnd": 119,
        "columnStart": 4,
        "columnEnd": 87
      }
    }
  ],
  "repairedSmells": [
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 13,
        "lineEnd": 13,
        "columnStart": 4,
        "columnEnd": 88
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 18,
        "lineEnd": 18,
        "columnStart": 4,
        "columnEnd": 92
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 23,
        "lineEnd": 23,
        "columnStart": 4,
        "columnEnd": 138
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 26,
        "lineEnd": 26,
        "columnStart": 4,
        "columnEnd": 182
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 29,
        "lineEnd": 29,
        "columnStart": 4,
        "columnEnd": 105
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 33,
        "lineEnd": 33,
        "columnStart": 4,
        "columnEnd": 93
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 36,
        "lineEnd": 36,
        "columnStart": 4,
        "columnEnd": 98
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 41,
        "lineEnd": 41,
        "columnStart": 4,
        "columnEnd": 86
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 56,
        "lineEnd": 58,
        "columnStart": 4,
        "columnEnd": 17
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 65,
        "lineEnd": 65,
        "columnStart": 4,
        "columnEnd": 84
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 92,
        "lineEnd": 92,
        "columnStart": 4,
        "columnEnd": 143
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 97,
        "lineEnd": 97,
        "columnStart": 4,
        "columnEnd": 90
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 101,
        "lineEnd": 101,
        "columnStart": 4,
        "columnEnd": 108
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 108,
        "lineEnd": 108,
        "columnStart": 4,
        "columnEnd": 155
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 119,
        "lineEnd": 119,
        "columnStart": 4,
        "columnEnd": 111
      }
    }
  ],
  "repairedDockerfile": "#Openstack\n\nFROM ubuntu\n\nRUN echo 'deb http://archive.ubuntu.com/ubuntu precise main universe' > /etc/apt/sources.list && \\\n    echo 'deb http://archive.ubuntu.com/ubuntu precise-updates universe' >> /etc/apt/sources.list && \\\n    apt-get update\n\n#Prevent daemon start during install\nRUN\techo '#!/bin/sh\\nexit 101' > /usr/sbin/policy-rc.d && \\\n    chmod +x /usr/sbin/policy-rc.d\n\n#Supervisord\nRUN DEBIAN_FRONTEND=noninteractive apt-get --no-install-recommends install -y supervisor && \\\n\tmkdir -p /var/log/supervisor && rm -rf /var/lib/apt/lists/*;\nCMD [\"/usr/bin/supervisord\", \"-n\"]\n\n#SSHD\nRUN DEBIAN_FRONTEND=noninteractive apt-get --no-install-recommends install -y openssh-server && \\\n\tmkdir /var/run/sshd && \\\n\techo 'root:root' |chpasswd && rm -rf /var/lib/apt/lists/*;\n\n#Utilities\nRUN DEBIAN_FRONTEND=noninteractive apt-get --no-install-recommends install -y vim less net-tools inetutils-ping curl git telnet nmap socat && rm -rf /var/lib/apt/lists/*;\n\n#Others\nRUN DEBIAN_FRONTEND=noninteractive apt-get --no-install-recommends install -y vlan bridge-utils python python-pip python-software-properties software-properties-common python-keyring && rm -rf /var/lib/apt/lists/*;\n\n#MySQL\nRUN DEBIAN_FRONTEND=noninteractive apt-get --no-install-recommends install -y mysql-server python-mysqldb && \\\n    sed -i 's/127.0.0.1/0.0.0.0/g' /etc/mysql/my.cnf && rm -rf /var/lib/apt/lists/*;\n\n#RabbitMQ\nRUN DEBIAN_FRONTEND=noninteractive apt-get --no-install-recommends install -y rabbitmq-server && rm -rf /var/lib/apt/lists/*;\n\n#For Openstack\nRUN DEBIAN_FRONTEND=noninteractive apt-get --no-install-recommends install -y ubuntu-cloud-keyring && \\\n\techo \"deb http://ubuntu-cloud.archive.canonical.com/ubuntu precise-updates/havana main\" >> /etc/apt/sources.list.d/openstack.list && \\\n    apt-get update && rm -rf /var/lib/apt/lists/*;\n\n#Keystone\nRUN DEBIAN_FRONTEND=noninteractive apt-get --no-install-recommends install -y keystone && \\\n    sed -i -e 's/# admin_token = ADMIN/admin_token = ADMIN/' \\\n        -e \"s#^connection.*#connection = mysql://keystone@localhost/keystone#\" \\\n        /etc/keystone/keystone.conf && rm -rf /var/lib/apt/lists/*;\n\n#Quantum\n#RUN apt-get install -y quantum-server\n#RUN apt-get install -y quantum-plugin-linuxbridge\n#RUN apt-get install -y quantum-plugin-linuxbridge-agent\n#RUN apt-get install -y dnsmasq-base\n#RUN apt-get install -y dnsmasq\n#RUN apt-get install -y quantum-dhcp-agent\n#RUN apt-get install -y quantum-l3-agent\n\n#Nova Controller\nRUN DEBIAN_FRONTEND=noninteractive apt-get --no-install-recommends install -y nova-novncproxy novnc nova-api nova-ajax-console-proxy nova-cert \\\n     nova-conductor nova-consoleauth nova-doc nova-scheduler python-novaclient \\\n     nova-network && \\\n    sed -i -e \"s#^admin_tenant_name =.*#admin_tenant_name = service#\" \\\n    \t-e \"s#^admin_user =.*#admin_user = nova#\" \\\n    \t-e \"s#^admin_password =.*#admin_password = nova#\" \\\n    \t/etc/nova/api-paste.ini && rm -rf /var/lib/apt/lists/*;\n\n#Glance\nRUN DEBIAN_FRONTEND=noninteractive apt-get --no-install-recommends install -y glance && \\\n    sed -i -e \"s#^sql_connection.*#sql_connection = mysql://glance@localhost/glance#\" \\\n    \t-e \"s#^admin_tenant_name =.*#admin_tenant_name = service#\" \\\n    \t-e \"s#^admin_user =.*#admin_user = glance#\" \\\n    \t-e \"s#^admin_password =.*#admin_password = glance#\" \\\n    \t-e \"s|^\\#config_file.*|config_file = /etc/glance/glance-api-paste.ini|\" \\\n    \t-e \"s|^\\#flavor.*|flavor = keystone|\" \\\n        -e \"2 i container_formats = ami,ari,aki,bare,ovf,docker\" \\\n    \t/etc/glance/glance-api.conf && \\\n    sed -i -e \"s#^sql_connection.*#sql_connection = mysql://glance@localhost/glance#\" \\\n    \t-e \"s#^admin_tenant_name =.*#admin_tenant_name = service#\" \\\n    \t-e \"s#^admin_user =.*#admin_user = glance#\" \\\n    \t-e \"s#^admin_password =.*#admin_password = glance#\" \\\n    \t-e \"s|^\\#config_file.*|config_file = /etc/glance/glance-registry-paste.ini|\" \\\n    \t-e \"s|^\\#flavor.*|flavor = keystone|\" \\\n    \t/etc/glance/glance-registry.conf && \\\n    echo \"[pipeline:glance-registry-keystone]\\npipeline = authtoken context registryapp\" >> /etc/glance/glance-registry-paste.ini && rm -rf /var/lib/apt/lists/*;\n\n#Cinder\n#RUN apt-get -y install cinder-api cinder-scheduler cinder-volume open-iscsi python-cinderclient tgt && \\\n#    sed -i -e \"s#^admin_tenant_name =.*#admin_tenant_name = service#\" \\\n#    \t-e \"s#^admin_user =.*#admin_user = cinder#\" \\\n#    \t-e \"s#^admin_password =.*#admin_password = cinder#\" \\\n#    \t/etc/cinder/api-paste.ini && \\\n# \techo 'sql_connection = mysql://cinder@localhost/cinder\\nrabbit_host = localhost' >> /etc/cinder/cinder.conf\n\n#Dashboard\nRUN DEBIAN_FRONTEND=noninteractive apt-get --no-install-recommends install -y memcached python-memcache libapache2-mod-wsgi openstack-dashboard && \\\n    apt-get remove -y --purge openstack-dashboard-ubuntu-theme && \\\n    echo \"SESSION_ENGINE = 'django.contrib.sessions.backends.cache'\" >> /etc/openstack-dashboard/local_settings.py && rm -rf /var/lib/apt/lists/*;\n\n#Nova Compute Node\nRUN DEBIAN_FRONTEND=noninteractive apt-get --no-install-recommends install -y nova-compute && \\\n    sed -i -e \"s|^compute_driver=.*|compute_driver=docker.DockerDriver|\" /etc/nova/nova-compute.conf && rm -rf /var/lib/apt/lists/*;\n\n#Docker\nRUN DEBIAN_FRONTEND=noninteractive apt-get --no-install-recommends install -qqy iptables ca-certificates lxc && \\\n    wget -O /usr/local/bin/docker https://get.docker.io/builds/Linux/x86_64/docker-latest && \\\n    chmod +x /usr/local/bin/docker && rm -rf /var/lib/apt/lists/*;\nVOLUME /var/lib/docker\n\n#todo move up later\n#Neutron\nRUN DEBIAN_FRONTEND=noninteractive apt-get --no-install-recommends install -y neutron-server neutron-dhcp-agent neutron-plugin-openvswitch neutron-l3-agent && rm -rf /var/lib/apt/lists/*;\nRUN echo \"net.ipv4.ip_forward=1\\nnet.ipv4.conf.all.rp_filter=0\\nnet.ipv4.conf.default.rp_filter=0\" >> /etc/sysctl.conf\nRUN sed -i -e \"s#^admin_tenant_name =.*#admin_tenant_name = service#\" \\\n    \t-e \"s#^admin_user =.*#admin_user = neutron#\" \\\n       \t-e \"s#^admin_password =.*#admin_password = neutron#\" \\\n        -e \"s#^connection.*#connection = mysql://neutron@localhost/neutron#\" \\\n \t/etc/neutron/neutron.conf && \\\n    sed -i -e \"s|.*auth_token.*|paste.filter_factory = keystoneclient.middleware.auth_token:filter_factory\\nauth_host = localhost\\nauth_uri=http://localhost:5000\\nadmin_tenant_name = service\\nadmin_user = neutron\\nadmin_password = neutron|\" \\\n \t    /etc/neutron/api-paste.ini\n\n#Heat\nRUN DEBIAN_FRONTEND=noninteractive apt-get --no-install-recommends install -y heat-api heat-api-cfn heat-engine && rm -rf /var/lib/apt/lists/*;\nRUN mkdir /etc/heat/environment.d && \\\n    sed -i -e \"s|^sql_connection.*||\" \\\n           -e \"s|^#sql_connection.*|sql_connection = mysql://heat@localhost/heat|\" \\\n        /etc/heat/heat.conf && \\\n    sed -i -e \"s|.*auth_token.*|paste.filter_factory = heat.common.auth_token:filter_factory\\nauth_host = localhost\\nauth_port = 35357\\nauth_protocol = http\\nadmin_tenant_name = service\\nadmin_user = heat\\nadmin_password = heat|\" \\\n        /etc/heat/api-paste.ini\n\nRUN git clone https://github.com/dotcloud/openstack-heat-docker.git && \\\n    pip install --no-cache-dir -r openstack-heat-docker/requirements.txt && \\\n    mkdir /usr/lib/heat && \\\n    ln -sf $(cd openstack-heat-docker/plugin; pwd) /usr/lib/heat/docker\n\n\n#Config files\nADD ./ /docker-openstack\nRUN cd /docker-openstack && \\\n    chmod +x *.sh && \\\n    mv /etc/nova/nova.conf /etc/nova/nova.conf.saved && \\\n    cp nova.conf /etc/nova/nova.conf && \\\n    cp supervisord-openstack.conf /etc/supervisor/conf.d/supervisord-openstack.conf\n\n\n#Init MySql\nRUN mysqld & keystone-all & apachectl start & sleep 3 && \\\n    mysql < /docker-openstack/mysql.ddl && \\\n    keystone-manage db_sync && \\\n    /docker-openstack/sample_data.sh && \\\n    nova-manage db sync && \\\n    glance-manage db_sync && \\\n    heat-manage db_sync && \\\n    mysqladmin shutdown\n\n#ENV\nENV OS_USERNAME admin\nENV OS_TENANT_NAME demo\nENV OS_PASSWORD secrete\nENV OS_AUTH_URL http://localhost:35357/v2.0\n\nEXPOSE 22 80\n\n\n\n\n"
}