{
  "startTime": 1674251119286,
  "endTime": 1674251119382,
  "originalSmells": [
    {
      "rule": "curlUseHttpsUrl",
      "position": {
        "lineStart": 34,
        "lineEnd": 34,
        "columnStart": 4,
        "columnEnd": 146
      }
    },
    {
      "rule": "sha256sumEchoOneSpaces",
      "position": {
        "lineStart": 35,
        "lineEnd": 35,
        "columnStart": 7,
        "columnEnd": 90
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "# Debian, miniconda, ESRIN-Sen2Cor Dockerfile\n# https://github.com/edwardpmorris/docker-snap\n# sen2cor from http://step.esa.int/main/third-party-plugins-2/sen2cor/\n\n# pull base image (use a specific version tag ':tag')\nFROM  continuumio/miniconda:4.0.5\n\n# maintainer details\nMAINTAINER epmorris \"edward.morris@uca.es\"\n\n# update version labels\nLABEL sen2cor_version='2.2.1'\nENV SEN2COR_VERSION '2.2.1'\n\n# install conda packages (sen2cor setup.py expects anaconda)\nRUN conda install --yes \\\n    pytables \\\n    psutil \\\n    scipy \\\n    scikit-image\n\n# create user group\nRUN groupadd -r worker \\\n    && useradd -r -m -g worker worker\n\n# set work directory to home give worker full ownership of all files in $HOME\nENV  HOME /home/worker\nWORKDIR $HOME\n#RUN chown -R worker:worker $HOME\n\n# download, check, extract and clean up sen2cor from step.esa.int\n# FIXME: improve verification, https://github.com/docker-library/official-images\n# FIXME: https not available\nENV SEN2COR_DOWNLOAD_SHA256 81ac7bd389bdce6a24f780d067fbf89324fc6ac314c9d9c28da55d414d1e7d3e\nRUN curl -fSL -o sen2cor-${SEN2COR_VERSION}.tar.gz \"https://step.esa.int/thirdparties/sen2cor/${SEN2COR_VERSION}/sen2cor-${SEN2COR_VERSION}.tar.gz\" \\\n    && echo \"$SEN2COR_DOWNLOAD_SHA256  *sen2cor-${SEN2COR_VERSION}.tar.gz\" | sha256sum -c - \\\n    && tar -xvzf sen2cor-${SEN2COR_VERSION}.tar.gz \\\n    && rm sen2cor-${SEN2COR_VERSION}.tar.gz\n\n# add headless setup (interactive prompts commented, use defaut path options)\n# FIXME: check if a 'default settings' flag exists for setup.py\nCOPY setup.py $HOME/sen2cor-${SEN2COR_VERSION}\n\n# install sen2cor   \nRUN cd sen2cor-2.2.1 && \\\n    python setup.py install --quiet\n\n# update environment variables (paths generated by setup.py)\n# FIXME: this cmd does not seem to set env variables\n# as in they are not set when starting a new container\nRUN /bin/bash /home/worker/sen2cor/L2A_Bashrc\n\n# set by looking at default instalation   \n# FIXME: these should be auto generated\nENV  GDAL_DATA /opt/conda/lib/python2.7/site-packages/sen2cor-2.2.1-py2.7.egg/sen2cor/cfg/gdal_data\nENV  SEN2COR_BIN /opt/conda/lib/python2.7/site-packages/sen2cor-2.2.1-py2.7.egg/sen2cor\nENV  SEN2COR_HOME $HOME/sen2cor\n\n# copy adjusted L2A configuration\n# FIXME: makes an option to replace when starting the container\n# see L2A_Process option --GIP_L2A GIP_L2A\n#RUN cp -r $SEN2COR_BIN/cfg/ $SEN2COR_HOME\nCOPY L2A_GIPP.xml $SEN2COR_HOME/cfg\n\n# warning! runs as root until permission issues resolved\n# http://forum.step.esa.int/t/sen2cor-writes-files-in-the-installation-folder-at-runtime/2013\n#RUN chown -R worker:worker /opt/conda/lib/python2.7/site-packages/sen2cor-2.2.1-py2.7.egg/sen2cor/cfg\n#RUN cp $SEN2COR_BIN/cfg/L2A_CAL_AC_GIPP.xml $SEN2COR_HOME/cfg \\\n#    && cp $SEN2COR_BIN/cfg/L2A_CAL_SC_GIPP.xml $SEN2COR_HOME/cfg\nENV PATH $SEN2COR_BIN:$PATH\nRUN chmod 755 $SEN2COR_BIN\nRUN chown -R worker:worker $HOME\nUSER worker"
}