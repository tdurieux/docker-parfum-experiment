{
  "startTime": 1674245010906,
  "endTime": 1674245011401,
  "originalSmells": [
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 40,
        "lineEnd": 40,
        "columnStart": 10,
        "columnEnd": 65
      }
    },
    {
      "rule": "npmCacheCleanAfterInstall",
      "position": {
        "lineStart": 78,
        "lineEnd": 78,
        "columnStart": 9,
        "columnEnd": 20
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 6,
        "lineEnd": 6,
        "columnStart": 4,
        "columnEnd": 48
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 6,
        "lineEnd": 6,
        "columnStart": 4,
        "columnEnd": 48
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 6,
        "lineEnd": 6,
        "columnStart": 4,
        "columnEnd": 48
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "FROM ubuntu:18.04\nMAINTAINER showwin <showwin_kmc@yahoo.co.jp>\n\nENV LANG en_US.UTF-8\n\nRUN apt-get update && apt-get install --no-install-recommends -y wget sudo less vim tzdata && rm -rf /var/lib/apt/lists/*;\n\n# ishocon ユーザ作成\nRUN groupadd -g 1001 ishocon && \\\n    useradd  -g ishocon -G sudo -m -s /bin/bash ishocon && \\\n    echo 'ishocon:ishocon' | chpasswd\nRUN echo 'ishocon ALL=(ALL) NOPASSWD:ALL' >> /etc/sudoers\n\n# MySQL のインストール\nRUN [\"/bin/bash\", \"-c\", \"debconf-set-selections <<< 'mysql-server mysql-server/root_password password ishocon'\"] \\\nRUN [\"/bin/bash\", \"-c\", \"debconf-set-selections <<< 'mysql-service mysql-server/mysql-apt-config string 4'\"] \\\nRUN apt-get install -y mysql-server \\\n\n# Nginx のインストール\nRUN apt-get install -y nginx \\\nCOPY admin/ssl/ /etc/nginx/ssl/ \\\nCOPY admin/config/nginx.conf /etc/nginx/nginx.conf \\\n\nUSER ishocon \\\n\n# Ruby のインストール\nRUN sudo apt-get install -y git ruby-dev libssl-dev libreadline-dev gcc make libmysqlclient-dev && \\\n    git clone https://github.com/sstephenson/rbenv.git ~/.rbenv \\\nRUN PATH=\"$HOME/.rbenv/bin:$PATH\" && \\\n    eval \"$(rbenv init -)\" && \\\n    git clone https://github.com/sstephenson/ruby-build.git ~/.rbenv/plugins/ruby-build && \\\n    rbenv install 2.5.1 && rbenv rehash && rbenv global 2.5.1 \\\n\n# Python のインストール\nRUN sudo apt-get install -y curl \\\n RUN git clone https://github.com/pyenv/pyenv.git ~/.pyenv && \\\n    PYENV_ROOT=\"$HOME/.pyenv\" && PATH=\"$PYENV_ROOT/bin:$PATH\" && \\\n    eval \"$(pyenv init -)\" && \\\n    pyenv install 3.6.5 && pyenv global 3.6.5 && \\\n    cd && curl -f https://bootstrap.pypa.io/get-pip.py -o get-pip.py && python get-pip.py && rm get-pip.py \\\n\n# Go のインストール\nRUN sudo wget https://dl.google.com/go/go1.10.2.linux-amd64.tar.gz && \\\n    sudo tar -C /usr/local -xzf go1.10.2.linux-amd64.tar.gz && \\\n    sudo rm go1.10.2.linux-amd64.tar.gz \\\nENV PATH $PATH:/usr/local/go/bin \\\nENV GOROOT /usr/local/go \\\nENV GOPATH $HOME/.local/go \\\nENV PATH $PATH:$GOROOT/bin \\\n\n# PHP のインストール\nRUN sudo mkdir /run/php \\\nRUN sudo apt install -y php php-fpm php-mysql php-cli \\\n\n# NodeJS のインストール\nRUN sudo apt install -y nodejs npm \\\n\n# Crystal のインストール\nRUN curl https://dist.crystal-lang.org/apt/setup.sh | sudo bash \\\nRUN sudo apt install -y libssl1.0-dev crystal \\\n\n# アプリケーション\nRUN mkdir /home/ishocon/data /home/ishocon/webapp \\\nCOPY admin/ishocon2.dump.tar.bz2 /home/ishocon/data/ishocon2.dump.tar.bz2 \\\nCOPY webapp/ /home/ishocon/webapp \\\nCOPY admin/config/bashrc /home/ishocon/.bashrc \\\n\n# ライブラリのインストール\nRUN cd /home/ishocon/webapp/ruby && sudo gem install bundler && bundle install \\\nRUN LC_ALL=C.UTF-8 && LANG=C.UTF-8 && cd /home/ishocon/webapp/python && \\\n    /home/ishocon/.pyenv/shims/pip install -r requirements.txt \\\nRUN cd /home/ishocon/webapp/php && \\\n    sudo php -r \"copy('https://getcomposer.org/installer', 'composer-setup.php');\" && \\\n    sudo php composer-setup.php && \\\n    sudo php -r \"unlink('composer-setup.php');\" && \\\n    sudo php ./composer.phar install \\\n RUN cd /home/ishocon/webapp/nodejs && \\\n    sudo npm install && npm cache clean --force; \\\nRUN cd /home/ishocon/webapp/crystal && \\\n    shards install \\\n\nCOPY docker/start_app.sh /docker/start_app.sh \\\n\nWORKDIR /home/ishocon \\\nEXPOSE 443"
}