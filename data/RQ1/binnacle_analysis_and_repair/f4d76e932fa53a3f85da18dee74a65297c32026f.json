{
  "startTime": 1674245636017,
  "endTime": 1674245636261,
  "originalSmells": [
    {
      "rule": "npmCacheCleanAfterInstall",
      "position": {
        "lineStart": 82,
        "lineEnd": 82,
        "columnStart": 4,
        "columnEnd": 23
      }
    },
    {
      "rule": "npmCacheCleanAfterInstall",
      "position": {
        "lineStart": 84,
        "lineEnd": 84,
        "columnStart": 4,
        "columnEnd": 22
      }
    },
    {
      "rule": "npmCacheCleanAfterInstall",
      "position": {
        "lineStart": 86,
        "lineEnd": 86,
        "columnStart": 4,
        "columnEnd": 15
      }
    },
    {
      "rule": "tarSomethingRmTheSomething",
      "position": {
        "lineStart": 69,
        "lineEnd": 69,
        "columnStart": 4,
        "columnEnd": 55
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "#\n# Builds a custom docker image for ShinobiCCTV Pro\n#\nFROM node:8-alpine\n\nLABEL Author=\"MiGoller, mrproper, pschmitt & moeiscool\"\n\n# Set environment variables to default values\n# ADMIN_USER : the super user login name\n# ADMIN_PASSWORD : the super user login password\n# PLUGINKEY_MOTION : motion plugin connection key\n# PLUGINKEY_OPENCV : opencv plugin connection key\n# PLUGINKEY_OPENALPR : openalpr plugin connection key\nENV ADMIN_USER=admin@shinobi.video \\\n    ADMIN_PASSWORD=admin \\\n    CRON_KEY=fd6c7849-904d-47ea-922b-5143358ba0de \\\n    PLUGINKEY_MOTION=b7502fd9-506c-4dda-9b56-8e699a6bc41c \\\n    PLUGINKEY_OPENCV=f078bcfe-c39a-4eb5-bd52-9382ca828e8a \\\n    PLUGINKEY_OPENALPR=dbff574e-9d4a-44c1-b578-3dc0f1944a3c \\\n    #leave these ENVs alone unless you know what you are doing\n    MYSQL_USER=majesticflame \\\n    MYSQL_PASSWORD=password \\\n    MYSQL_HOST=localhost \\\n    MYSQL_DATABASE=ccio \\\n    MYSQL_ROOT_PASSWORD=blubsblawoot \\\n    MYSQL_ROOT_USER=root\n\n\n# Create the custom configuration dir\nRUN mkdir -p /config\n\n# Create the working dir\nRUN mkdir -p /opt/shinobi\n\n\n# Install package dependencies\nRUN apk update && \\\napk upgrade && \\\napk --no-cache add   freetype-dev \\ \n  gnutls-dev \\ \n  lame-dev \\ \n  libass-dev \\ \n  libogg-dev \\ \n  libtheora-dev \\ \n  libvorbis-dev \\ \n  libvpx-dev \\ \n  libwebp-dev \\ \n  libssh2 \\ \n  opus-dev \\ \n  rtmpdump-dev \\ \n  x264-dev \\ \n  x265-dev \\ \n  yasm-dev && \\\napk add --no-cache   --virtual \\ \n  .build-dependencies \\ \n  build-base \\ \n  bzip2 \\ \n  coreutils \\ \n  gnutls \\ \n  nasm \\ \n  tar \\ \n  x264\n\nRUN apk add --update --no-cache python make ffmpeg pkgconfig git mariadb mariadb-client wget tar xz openrc\nRUN sed -ie \"s/^bind-address\\s*=\\s*127\\.0\\.0\\.1$/#bind-address = 0.0.0.0/\" /etc/mysql/my.cnf\n\n# Install ffmpeg static build version from cdn.shinobi.video\nRUN wget https://cdn.shinobi.video/installers/ffmpeg-release-64bit-static.tar.xz\n\nRUN tar xpvf ./ffmpeg-release-64bit-static.tar.xz -C ./ \\\n    && cp -f ./ffmpeg-3.3.4-64bit-static/ff* /usr/bin/ \\\n    && chmod +x /usr/bin/ff* && rm ./ffmpeg-release-64bit-static.tar.xz\n\nRUN rm -f ffmpeg-release-64bit-static.tar.xz \\\n    && rm -rf ./ffmpeg-3.3.4-64bit-static\n\nWORKDIR /opt/shinobi\n\n# Clone the Shinobi CCTV PRO repo\nRUN git clone https://github.com/ShinobiCCTV/Shinobi.git /opt/shinobi\n\n# Install NodeJS dependencies\nRUN npm i npm@latest -g && npm cache clean --force;\n\nRUN npm install pm2 -g && npm cache clean --force;\n\nRUN npm install && npm cache clean --force;\n\n# Copy code\nCOPY docker-entrypoint.sh .\nCOPY pm2Shinobi.yml .\nRUN chmod -f +x ./*.sh\n\n# Copy default configuration files\nCOPY ./config/conf.sample.json /opt/shinobi/conf.sample.json\nCOPY ./config/super.sample.json /opt/shinobi/super.sample.json\n\nVOLUME [\"/opt/shinobi/videos\"]\nVOLUME [\"/config\"]\n\nEXPOSE 8080\n\nENTRYPOINT [\"/opt/shinobi/docker-entrypoint.sh\"]\n\nCMD [\"pm2-docker\", \"pm2Shinobi.yml\"]\n"
}