{
  "startTime": 1674249283543,
  "endTime": 1674249284039,
  "originalSmells": [
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 51,
        "lineEnd": 51,
        "columnStart": 8,
        "columnEnd": 108
      }
    },
    {
      "rule": "curlUseHttpsUrl",
      "position": {
        "lineStart": 51,
        "lineEnd": 51,
        "columnStart": 8,
        "columnEnd": 108
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "FROM aqzt/docker-alpine\nLABEL maintainer=\"aqzt.com (ppabc@qq.com)\"\n\n    ENV MARIADB_VER=10.2.14 \\\n        ZABBIX_HOSTNAME=mariadb-db \\\n        ENABLE_SMTP=FALSE\n\n\t\t### Install Required Dependencies\n    RUN export CPU=`cat /proc/cpuinfo | grep -c processor` ; \\\n\n        # Add testing repo\n        echo http://dl-4.alpinelinux.org/alpine/edge/testing >> /etc/apk/repositories ; \\\n\n        # Install packages\n        apk add --no-cache \\\n            \n            # Install utils\n            libressl \\\n            pwgen \\\n\n            # Installing needed libs\n            boost \\\n            geos \\\n            gnutls \\\n            ncurses-libs \\\n            libaio \\\n            libcurl \\\n            libstdc++ \\\n            libxml2 \\\n            proj4 \\\n\n            # Install MariaDB build deps\n            alpine-sdk \\\n            bison \\\n            boost-dev \\\n            cmake \\\n            curl-dev \\\n            gnutls-dev \\\n            libaio-dev \\\n            libressl-dev \\\n            libxml2-dev \\\n            linux-headers \\\n            ncurses-dev \\\n            ; \\\n\n        # Add group and user for mysql\n        addgroup -S -g 500 mysql ; \\\n        adduser -S -D -H -u 500 -G mysql -g \"MySQL\" mysql ; \\\n\n        # Download and unpack mariadb\n        mkdir -p /etc/mysql ; \\\n        curl -f -sSL https://mariadb.mirror.iweb.com/mariadb-${MARIADB_VER}/source/mariadb-${MARIADB_VER}.tar.gz | tar xvfz - --strip=0 -C /usr/src/; \\\n\n        # Build maridb\n        mkdir -p /tmp/_ ; \\\n        cd /usr/src/mariadb-${MARIADB_VER} ; \\\n        cmake . \\\n            -DCMAKE_BUILD_TYPE=MinSizeRel \\\n            -DCOMMON_C_FLAGS=\"-O3 -s -fno-omit-frame-pointer -pipe\" \\\n            -DCOMMON_CXX_FLAGS=\"-O3 -s -fno-omit-frame-pointer -pipe\" \\\n            -DCMAKE_INSTALL_PREFIX=/usr \\\n            -DSYSCONFDIR=/etc/mysql \\\n            -DMYSQL_DATADIR=/var/lib/mysql \\\n            -DMYSQL_UNIX_ADDR=/run/mysqld/mysqld.sock \\\n            -DDEFAULT_CHARSET=utf8 \\\n            -DDEFAULT_COLLATION=utf8_general_ci \\\n            -DENABLED_LOCAL_INFILE=ON \\\n            -DINSTALL_INFODIR=share/mysql/docs \\\n            -DINSTALL_MANDIR=/tmp/_/share/man \\\n            -DINSTALL_PLUGINDIR=lib/mysql/plugin \\\n            -DINSTALL_SCRIPTDIR=bin \\\n            # -DINSTALL_INCLUDEDIR=/tmp/_/include/mysql \\\n            -DINSTALL_DOCREADMEDIR=/tmp/_/share/mysql \\\n            -DINSTALL_SUPPORTFILESDIR=share/mysql \\\n            -DINSTALL_MYSQLSHAREDIR=share/mysql \\\n            -DINSTALL_DOCDIR=/tmp/_/share/mysql/docs \\\n            -DINSTALL_SHAREDIR=share/mysql \\\n            -DWITH_READLINE=ON \\\n            -DWITH_ZLIB=system \\\n            -DWITH_SSL=system \\\n            -DWITH_LIBWRAP=OFF \\\n            -DWITH_JEMALLOC=no \\\n            -DWITH_EXTRA_CHARSETS=complex \\\n            -DPLUGIN_ARCHIVE=STATIC \\\n            -DPLUGIN_BLACKHOLE=DYNAMIC \\\n            -DPLUGIN_INNOBASE=STATIC \\\n            -DPLUGIN_PARTITION=AUTO \\\n            -DPLUGIN_CONNECT=NO \\\n            -DPLUGIN_TOKUDB=NO \\\n            -DPLUGIN_FEEDBACK=NO \\\n            -DPLUGIN_OQGRAPH=NO \\\n            -DPLUGIN_FEDERATED=NO \\\n            -DPLUGIN_FEDERATEDX=NO \\\n            -DWITHOUT_FEDERATED_STORAGE_ENGINE=1 \\\n            -DWITHOUT_EXAMPLE_STORAGE_ENGINE=1 \\\n            -DWITHOUT_PBXT_STORAGE_ENGINE=1 \\\n            -DWITHOUT_ROCKSDB_STORAGE_ENGINE=1 \\\n            -DWITH_EMBEDDED_SERVER=OFF \\\n            -DWITH_UNIT_TESTS=OFF \\\n            -DENABLED_PROFILING=OFF \\\n            -DENABLE_DEBUG_SYNC=OFF \\\n            ; \\\n\n        make -j${CPU} ; \\\n\n        # Install\n        make -j${CPU} install ; \\\n\n        # Copy default config, and remove deprecates and not working things\n        cp /usr/share/mysql/my-large.cnf /etc/mysql/my.cnf ; \\\n        echo \"!includedir /etc/mysql/conf.d/\" >>/etc/mysql/my.cnf &&\\\n        sed -i '/# Try number of CPU/d' /etc/mysql/my.cnf ; \\\n        sed -i '/thread_concurrency = 8/d' /etc/mysql/my.cnf ; \\\n        sed -i '/innodb_additional_mem_pool_size/d' /etc/mysql/my.cnf ; \\\n        sed -i 's/log-bin=/#log-bin=/' /etc/mysql/my.cnf ; \\\n        sed -i 's/binlog_format=/#binlog_format=/' /etc/mysql/my.cnf ; \\\n        sed -i 's/#innodb_/innodb_/' /etc/mysql/my.cnf ; \\\n\n        # Clean everything\n        rm -rf /usr/src ; \\\n        rm -rf /tmp/_ ; \\\n        rm -rf /usr/sql-bench ; \\\n        rm -rf /usr/mysql-test ; \\\n        rm -rf /usr/data ; \\\n        rm -rf /usr/lib/python2.7 ; \\\n        rm -rf /usr/bin/mysql_client_test ; \\\n        rm -rf /usr/bin/mysqltest ; \\\n\n        # Remove packages\n        apk del \\\n            alpine-sdk \\\n            bison \\\n            boost-dev \\\n            cmake \\\n            curl-dev \\\n            gnutls-dev \\\n            libaio-dev \\\n            libressl-dev \\\n            libxml2-dev \\\n            linux-headers \\\n            ncurses-dev \\\n            ; \\\n\n        # Create needed directories\n        mkdir -p /var/lib/mysql ; \\\n        mkdir -p /run/mysqld ; \\\n        mkdir /etc/mysql/conf.d ; \\\n\n        # Set permissions\n        chown -R mysql:mysql /var/lib/mysql ; \\\n        chown -R mysql:mysql /run/mysqld ; \\\n        chmod 777 /tmp ; \\\n        rm -rf /var/cache/apk/*\n\n\n### Networking\n   EXPOSE 3306\n      ADD root /\n"
}