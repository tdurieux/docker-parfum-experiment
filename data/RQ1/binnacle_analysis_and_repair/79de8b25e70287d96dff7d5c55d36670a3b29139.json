{
  "startTime": 1674242187998,
  "endTime": 1674242188372,
  "originalSmells": [
    {
      "rule": "tarSomethingRmTheSomething",
      "position": {
        "lineStart": 15,
        "lineEnd": 15,
        "columnStart": 4,
        "columnEnd": 88
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "FROM node:10.15.2-alpine\n\n# Include dist\nADD dist/ /root/dist/\n\n# Setup env and apt\nRUN sed -i 's/dl-cdn/dl-2/g' /etc/apk/repositories && \\\n    apk -U --no-cache add \\\n            aria2 \\\n            curl && \\\n\n# Get and install packages\n    cd /root/dist/ && \\\n    mkdir -p /usr/share/kibana/ && \\\n    aria2c -s 16 -x 16 https://artifacts.elastic.co/downloads/kibana/kibana-6.6.2-linux-x86_64.tar.gz && \\\n    tar xvfz kibana-6.6.2-linux-x86_64.tar.gz --strip-components=1 -C /usr/share/kibana/ && \\\n\n# Kibana's bundled node does not work in alpine\n    rm /usr/share/kibana/node/bin/node && \\\n    ln -s /usr/bin/node /usr/share/kibana/node/bin/node && \\\n\n# Add and move files\n    cd /root/dist/ && \\\n    cp kibana.svg /usr/share/kibana/src/ui/public/images/kibana.svg && \\\n    cp kibana.svg /usr/share/kibana/src/ui/public/icons/kibana.svg && \\\n    cp elk.ico /usr/share/kibana/src/ui/public/assets/favicons/favicon.ico && \\\n    cp elk.ico /usr/share/kibana/src/ui/public/assets/favicons/favicon-16x16.png && \\\n    cp elk.ico /usr/share/kibana/src/ui/public/assets/favicons/favicon-32x32.png && \\\n\n# Setup user, groups and configs\n    sed -i 's/#server.basePath: \"\"/server.basePath: \"\\/kibana\"/' /usr/share/kibana/config/kibana.yml && \\\n    sed -i 's/#kibana.defaultAppId: \"home\"/kibana.defaultAppId: \"dashboards\"/' /usr/share/kibana/config/kibana.yml && \\\n    sed -i 's/#server.host: \"localhost\"/server.host: \"0.0.0.0\"/' /usr/share/kibana/config/kibana.yml && \\\n    sed -i 's/#elasticsearch.hosts: \\[\"http:\\/\\/localhost:9200\"\\]/elasticsearch.hosts: \\[\"http:\\/\\/elasticsearch:9200\"\\]/' /usr/share/kibana/config/kibana.yml && \\\n    sed -i 's/#server.rewriteBasePath: false/server.rewriteBasePath: false/' /usr/share/kibana/config/kibana.yml && \\\n    sed -i \"s/#005571/#e20074/g\" /usr/share/kibana/src/legacy/core_plugins/kibana/public/index.css && \\\n    sed -i \"s/#007ba4/#9e0051/g\" /usr/share/kibana/src/legacy/core_plugins/kibana/public/index.css && \\\n    sed -i \"s/#00465d/#4f0028/g\" /usr/share/kibana/src/legacy/core_plugins/kibana/public/index.css && \\\n    echo \"xpack.infra.enabled: false\" >> /usr/share/kibana/config/kibana.yml && \\ \n    echo \"xpack.logstash.enabled: false\" >> /usr/share/kibana/config/kibana.yml && \\\n    echo \"xpack.canvas.enabled: false\" >> /usr/share/kibana/config/kibana.yml && \\\n    echo \"xpack.spaces.enabled: false\" >> /usr/share/kibana/config/kibana.yml && \\\n    echo \"xpack.apm.enabled: false\" >> /usr/share/kibana/config/kibana.yml && \\\n    rm -rf /usr/share/kibana/optimize/bundles/* && \\\n    /usr/share/kibana/bin/kibana --optimize && \\\n    addgroup -g 2000 kibana && \\\n    adduser -S -H -s /bin/ash -u 2000 -D -g 2000 kibana && \\\n    chown -R kibana:kibana /usr/share/kibana/ && \\\n\n# Clean up\n    apk del --purge aria2 && \\\n    rm -rf /root/* && \\\n    rm -rf /tmp/* && \\\n    rm -rf /var/cache/apk/* && rm kibana-6.6.2-linux-x86_64.tar.gz\n\n# Healthcheck\nHEALTHCHECK --retries=10 CMD curl -s -XGET 'http://127.0.0.1:5601'\n\n# Start kibana\nSTOPSIGNAL SIGKILL\nUSER kibana:kibana\nCMD [\"/usr/share/kibana/bin/kibana\"]\n"
}