{
  "startTime": 1674242147413,
  "endTime": 1674242147480,
  "originalSmells": [
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 55,
        "lineEnd": 57,
        "columnStart": 25,
        "columnEnd": 15
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "# Dockerfile\n#\n#   docker run --rm -d --name miniircd helje5/nio-miniircd:latest\n#   docker run --rm -d -p 127.0.0.1:1337:80 \\\n#                      -p 127.0.0.1:6667:6667 \\\n#                      --name miniircd helje5/nio-miniircd:latest\n#\n# Attach w/ new shell\n#\n#   docker exec -it miniircd bash\n#\n# To build:\n#\n#   docker build -t helje5/nio-miniircd:latest .\n#   docker push helje5/nio-miniircd:latest\n#\n# Rebuild:\n#\n#   docker build --no-cache -t helje5/nio-miniircd:latest .\n#\n\n# Build Image\n# - this just builds miniircd and its depdencies\n# - we also grab the necessary Swift runtime libs from this\n\nFROM swift:4.2.1 AS builder\n\nLABEL maintainer \"Helge Heß <me@helgehess.eu>\"\n\nENV DEBIAN_FRONTEND noninteractive\nENV CONFIGURATION   release\nENV NIO_DAEMON_INSTALL_DIR /opt/miniircd/bin\n\nWORKDIR /src/\nCOPY Sources        Sources\nCOPY Package.swift  .\n\nRUN mkdir -p ${NIO_DAEMON_INSTALL_DIR}\nRUN swift build -c ${CONFIGURATION}\n\nRUN cp Package.resolved ${NIO_DAEMON_INSTALL_DIR}/miniircd-Package.resolved\nRUN cp $(swift build -c ${CONFIGURATION} --show-bin-path)/miniircd \\\n    ${NIO_DAEMON_INSTALL_DIR}/\n\n\n# Deployment Image\n# - we copy in the shared libs from the builder image /usr/lib/swift/linux/\n# - we copy in /opt/miniircd/bin from the builder image\n# - we generate a supervise run script\n\nFROM ubuntu:16.04\n\nLABEL maintainer  \"Helge Heß <me@helgehess.eu>\"\nLABEL description \"A MiniIRCd deployment container\"\n\nRUN apt-get -q update && apt-get -q --no-install-recommends -y install \\\n    libatomic1 libbsd0 libcurl3 libicu55 libxml2 \\\n    daemontools \\\n    && rm -r /var/lib/apt/lists/*\n\nWORKDIR /\n\nCOPY --from=builder /usr/lib/swift/linux/*.so /usr/lib/swift/linux/\nCOPY --from=builder /opt/miniircd/bin         /opt/miniircd/bin\n\nEXPOSE 1337\nEXPOSE 6667\nEXPOSE 80\n\nWORKDIR /opt/miniircd\n\nRUN mkdir -p /opt/miniircd/logs\n\nRUN bash -c \"echo '#!/bin/bash'                                        > run; \\\n             echo ''                                                  >> run; \\\n             echo echo RUN Started  \\$\\(date\\) \\>\\>logs/run.log       >> run; \\\n             echo ''                                                  >> run; \\\n             echo stdbuf -oL -eL ./bin/miniircd --web http://0.0.0.0:80/websocket --extweb wss://irc.noze.io:443/websocket \\>\\>logs/run.log 2\\>\\>logs/error.log >> run; \\\n             echo ''                                                  >> run; \\\n             echo echo RUN Finished \\$\\(date\\) \\>\\>logs/run.log       >> run; \\\n             echo echo RUN ------------------- \\>\\>logs/run.log       >> run; \\\n             chmod +x run\"\n\nCMD [\"supervise\", \"/opt/miniircd\"]\n"
}