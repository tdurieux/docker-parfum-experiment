{
  "startTime": 1674234060152,
  "endTime": 1674234060357,
  "originalSmells": [
    {
      "rule": "tarSomethingRmTheSomething",
      "position": {
        "lineStart": 18,
        "lineEnd": 18,
        "columnStart": 4,
        "columnEnd": 26
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "FROM golang:1.11-alpine3.8 as builder\n\n# This is the release of dep to pull in.\nENV DEP_VERSION v0.4.1\nENV DEP_SHA256SUM 31144e465e52ffbc0035248a10ddea61a09bf28b00784fd3fdd9882c8cbb2315\n\n# Install tools and snappy lib\nRUN apk update && apk add --no-cache --virtual .build-deps \\\n        g++ \\\n        gcc \\\n        make \\\n        git \\\n        openssl \\\n        snappy-dev\n\n# Install LevelDB\nWORKDIR /\nRUN wget -q https://github.com/google/leveldb/archive/v1.20.tar.gz && \\\n    tar -zxvf v1.20.tar.gz && \\\n    cd leveldb-1.20/ && \\\n    make && rm v1.20.tar.gz\nRUN cp -r /leveldb-1.20/out-static/lib* /leveldb-1.20/out-shared/lib* /usr/local/lib/ && \\\n    mkdir -p /usr/local/include/leveldb && \\\n    cp -r /leveldb-1.20/include/leveldb /usr/local/include/ && \\\n    ldconfig /usr/local/lib && \\\n    rm -f /v1.20.tar.gz\n\n# Install dep\nRUN wget -qO /usr/local/bin/dep https://github.com/golang/dep/releases/download/${DEP_VERSION}/dep-linux-amd64 && \\\n    echo \"${DEP_SHA256SUM}  /usr/local/bin/dep\" | sha256sum -c && \\\n    chmod +x /usr/local/bin/dep\n\nCOPY Gopkg.toml Gopkg.lock $GOPATH/src/github.com/ndidplatform/smart-contract/\nWORKDIR $GOPATH/src/github.com/ndidplatform/smart-contract\nRUN dep ensure -vendor-only -v\n\nCOPY abci $GOPATH/src/github.com/ndidplatform/smart-contract/abci\nCOPY protos $GOPATH/src/github.com/ndidplatform/smart-contract/protos\nCOPY .git $GOPATH/src/github.com/ndidplatform/smart-contract/.git\nCOPY patches $GOPATH/src/github.com/ndidplatform/smart-contract/patches\n\nRUN git apply $GOPATH/src/github.com/ndidplatform/smart-contract/patches/tm_goleveldb_bloom_filter.patch && \\\n    git apply $GOPATH/src/github.com/ndidplatform/smart-contract/patches/tm_cleveldb_cache_and_bloom_filter.patch\n\nWORKDIR $GOPATH/src/github.com/ndidplatform/smart-contract/abci\nENV CGO_ENABLED=1\nENV CGO_LDFLAGS=\"-lsnappy\"\nRUN go install \\\n    -ldflags \"-X github.com/ndidplatform/smart-contract/abci/version.GitCommit=`git rev-parse --short=8 HEAD`\" \\\n    -tags \"gcc\"\n\n\nFROM alpine:3.8\nLABEL maintainer=\"NDID IT Team <it@ndid.co.th>\"\nENV TERM=xterm-256color\nENV ABCI_DB_DIR_PATH=/DID\n\n# Tendermint will be looking for genesis file in /tendermint (unless you change\n# `genesis_file` in config.toml). You can put your config.toml and private\n# validator file into /tendermint.\n#\n# The /tendermint/data dir is used by tendermint to store state.\nENV TMHOME /tendermint\n\n# Set umask to 027\nRUN umask 027 && echo \"umask 0027\" >> /etc/profile\n\nCOPY --from=builder /var/cache/apk /var/cache/apk\n\n# jq and curl used for extracting `pub_key` from private validator while\n# deploying tendermint with Kubernetes. It is nice to have bash so the users\n# could execute bash commands.\n# Install snappy lib used by LevelDB\nRUN apk update && apk add --no-cache bash curl jq snappy-dev && rm -rf /var/cache/apk\n\n# Copy compiled LevelDB lib\nCOPY --from=builder /usr/local/lib /usr/local/lib\n\nCOPY --from=builder /go/bin/abci /usr/bin/did-tendermint\nRUN mkdir -p ${TMHOME} ${ABCI_DB_DIR_PATH}\n\n# Change owner to nobodoy:nogroup and permission to 640\nRUN chown -R nobody:nogroup /usr/bin/did-tendermint ${TMHOME} ${ABCI_DB_DIR_PATH}\nRUN chmod -R 740 /usr/bin/did-tendermint ${TMHOME} ${ABCI_DB_DIR_PATH}\n\nUSER nobody\nENTRYPOINT [\"did-tendermint\"]\nCMD [\"node\"]\nSTOPSIGNAL SIGTERM"
}