{
  "startTime": 1674249134202,
  "endTime": 1674249134609,
  "originalSmells": [
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 73,
        "lineEnd": 73,
        "columnStart": 4,
        "columnEnd": 68
      }
    },
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 126,
        "lineEnd": 126,
        "columnStart": 4,
        "columnEnd": 79
      }
    },
    {
      "rule": "npmCacheCleanAfterInstall",
      "position": {
        "lineStart": 41,
        "lineEnd": 41,
        "columnStart": 4,
        "columnEnd": 15
      }
    },
    {
      "rule": "npmCacheCleanAfterInstall",
      "position": {
        "lineStart": 106,
        "lineEnd": 106,
        "columnStart": 4,
        "columnEnd": 15
      }
    },
    {
      "rule": "npmCacheCleanAfterInstall",
      "position": {
        "lineStart": 108,
        "lineEnd": 108,
        "columnStart": 4,
        "columnEnd": 21
      }
    },
    {
      "rule": "npmCacheCleanAfterInstall",
      "position": {
        "lineStart": 122,
        "lineEnd": 122,
        "columnStart": 4,
        "columnEnd": 26
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 19,
        "lineEnd": 19,
        "columnStart": 4,
        "columnEnd": 86
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 24,
        "lineEnd": 26,
        "columnStart": 4,
        "columnEnd": 45
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 31,
        "lineEnd": 33,
        "columnStart": 4,
        "columnEnd": 12
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 61,
        "lineEnd": 61,
        "columnStart": 4,
        "columnEnd": 65
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 64,
        "lineEnd": 64,
        "columnStart": 4,
        "columnEnd": 40
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 118,
        "lineEnd": 118,
        "columnStart": 4,
        "columnEnd": 35
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 125,
        "lineEnd": 125,
        "columnStart": 4,
        "columnEnd": 30
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 19,
        "lineEnd": 19,
        "columnStart": 4,
        "columnEnd": 86
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 24,
        "lineEnd": 26,
        "columnStart": 4,
        "columnEnd": 45
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 31,
        "lineEnd": 33,
        "columnStart": 4,
        "columnEnd": 12
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 61,
        "lineEnd": 61,
        "columnStart": 4,
        "columnEnd": 65
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 64,
        "lineEnd": 64,
        "columnStart": 4,
        "columnEnd": 40
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 118,
        "lineEnd": 118,
        "columnStart": 4,
        "columnEnd": 35
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 125,
        "lineEnd": 125,
        "columnStart": 4,
        "columnEnd": 30
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 19,
        "lineEnd": 19,
        "columnStart": 4,
        "columnEnd": 86
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 24,
        "lineEnd": 26,
        "columnStart": 4,
        "columnEnd": 45
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 31,
        "lineEnd": 33,
        "columnStart": 4,
        "columnEnd": 12
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 61,
        "lineEnd": 61,
        "columnStart": 4,
        "columnEnd": 65
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 64,
        "lineEnd": 64,
        "columnStart": 4,
        "columnEnd": 40
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 118,
        "lineEnd": 118,
        "columnStart": 4,
        "columnEnd": 35
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 125,
        "lineEnd": 125,
        "columnStart": 4,
        "columnEnd": 30
      }
    }
  ],
  "repairedSmells": [
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 19,
        "lineEnd": 19,
        "columnStart": 4,
        "columnEnd": 110
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 24,
        "lineEnd": 26,
        "columnStart": 4,
        "columnEnd": 45
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 31,
        "lineEnd": 33,
        "columnStart": 4,
        "columnEnd": 12
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 61,
        "lineEnd": 61,
        "columnStart": 4,
        "columnEnd": 89
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 64,
        "lineEnd": 64,
        "columnStart": 4,
        "columnEnd": 64
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 118,
        "lineEnd": 118,
        "columnStart": 4,
        "columnEnd": 59
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 125,
        "lineEnd": 125,
        "columnStart": 4,
        "columnEnd": 54
      }
    }
  ],
  "repairedDockerfile": "# Loaders\n    # Image Loader\n    # Markup Loader\n\n# References:\n# http://docs.opencv.org/3.0-beta/doc/tutorials/introduction/desktop_java/java_dev_intro.html\n# http://rodrigoberriel.com/2014/10/installing-opencv-3-0-0-on-ubuntu-14-04/\n\n\nFROM     ubuntu:14.04\nMAINTAINER Ganesh Iyer \"lastlegion@gmail.com\"\n\n### update\nRUN apt-get -q update\n# RUN apt-get -q -y upgrade\n# RUN apt-get -q -y dist-upgrade\n# RUN apt-get install -q -y libcurl3\n\n### need build tools for building openslide and later iipsrv\nRUN apt-get -q --no-install-recommends -y install libcurl3 git autoconf automake make libtool pkg-config cmake && rm -rf /var/lib/apt/lists/*;\n\nRUN mkdir /root/src\n\n### prereqs for openslide\nRUN apt-get -q --no-install-recommends -y install zlib1g-dev libpng12-dev libjpeg-dev \\\n\t\tlibtiff5-dev libgdk-pixbuf2.0-dev libxml2-dev \\\n\t\tlibsqlite3-dev libcairo2-dev libglib2.0-dev && rm -rf /var/lib/apt/lists/*;\n\nWORKDIR /root/src\n\n# Openslide\nRUN apt-get install --no-install-recommends -y openslide-tools python3-openslide \\\n\t\tpython3 python3-setuptools python3-pip \\\n\t\tnodejs npm && rm -rf /var/lib/apt/lists/*;\n\n# Data Loader API\nRUN mkdir -p /root/dataloader\nWORKDIR /root/dataloader\nEXPOSE 3001\nRUN git clone --recursive https://github.com/camicroscope/ImageLoader.git .\nRUN git submodule update --recursive --remote\nRUN npm install && npm cache clean --force;\n\nRUN [\"pip3\",\"install\", \"-r\",  \"/root/dataloader/DataLoader/requirements.txt\"]\nEXPOSE 3000\n\n###################\n# Annotations Loader\n###################\n\n# RUN apt-get -y install libopencv-dev build-essential cmake git \\\n# \t\tlibgtk2.0-dev pkg-config python-dev python-numpy \\\n# \t\tlibdc1394-22 libdc1394-22-dev libjpeg-dev libpng12-dev \\\n# \t\tlibtiff4-dev libjasper-dev libavcodec-dev \\\n# \t\tlibavformat-dev libswscale-dev libxine-dev \\\n# \t\tlibgstreamer0.10-dev libgstreamer-plugins-base0.10-dev \\\n# \t\tlibv4l-dev libtbb-dev libqt4-dev  libmp3lame-dev \\\n# \t\tlibopencore-amrnb-dev libopencore-amrwb-dev \\\n# \t\tlibtheora-dev libvorbis-dev libxvidcore-dev \\\n# \t\tx264 v4l-utils unzip wget\n\nRUN apt-get -y --no-install-recommends install build-essential pkg-config unzip wget curl && rm -rf /var/lib/apt/lists/*;\n\n# Install JDK\nRUN apt-get -y --no-install-recommends install openjdk-7-jdk ant && rm -rf /var/lib/apt/lists/*;\nENV JAVA_HOME /usr/lib/jvm/java-7-openjdk-amd64/\nENV PATH $JAVA_HOME/bin:$PATH\n\n# COPY opencv3_0_0_java.sh /root/\n# RUN sh opencv3_0_0_java.sh\n\n# Install OpenCV 3.1.0\nWORKDIR /tmp\nRUN curl -f -O -J -L https://github.com/Itseez/opencv/archive/3.1.0.zip && \\\n\tunzip opencv-3.1.0.zip && \\\n\tmkdir /tmp/opencv-build && \\\n\tcd /tmp/opencv-build && \\\n\tcmake -D CMAKE_BUILD_TYPE=RELEASE -D BUILD_SHARED_LIBS=OFF -D BUILD_TESTS=OFF -D CMAKE_INSTALL_PREFIX=/usr/local ../opencv-3.1.0 && \\\n\tmake -j4 && \\\n\tmake install && \\\n\tcd /tmp && \\\n\trm -rf opencv-build && \\\n\trm -rf opencv-3.1.0*\n\nWORKDIR /root\n\n# Install nuclear segmentation results program\n# RUN apt-get -y install gradle\n# WORKDIR /root\n# COPY nuclear-segmentation-results2 /root/nuclear-segmentation-results\n# ENV OPENCV_DIR /root/OpenCV/opencv-3.0.0/build\n# ENV OPENCV_JAVA_LIB /root/OpenCV/opencv-3.0.0/build/bin/opencv-300.jar\nENV OPENCV_JAVA_DIR=/usr/local/share/OpenCV/java\nENV OPENCV_JAVA_LIB=$OPENCV_JAVA_DIR/opencv-310.jar\n# WORKDIR /root/nuclear-segmentation-results\n# RUN gradle build\n\n# RUN apt-get -y install execstack\n# RUN execstack -c /root/OpenCV/opencv-3.0.0/build/lib/libopencv_java300.so\n\n\nWORKDIR /root\nRUN git clone https://github.com/camicroscope/uAIMDataLoader.git annotationloader\n\nWORKDIR /root/annotationloader\n\nRUN npm install && npm cache clean --force;\n\nRUN npm install yargs && npm cache clean --force; #Annoying unlisted kue dependency\nCOPY config.js.annotationsloader config.js\nCOPY config.js.dataloader /root/dataloader/config.js\n\nWORKDIR /root\n\n# RUN apt-get -q update\n# RUN apt-get -q -y upgrade\nRUN \"sh\" \"-c\" \"echo nameserver 8.8.8.8 >> /etc/resolv.conf\"\n\nRUN apt-get -y --no-install-recommends install redis-server && rm -rf /var/lib/apt/lists/*;\n\n# Install forever\nRUN  ln -s \"$(which nodejs)\" /usr/bin/node\nRUN npm install -g forever && npm cache clean --force;\n\n# Install new zip loader\nRUN apt-get -y --no-install-recommends -q install curl && rm -rf /var/lib/apt/lists/*;\nRUN curl -f -O -J -L https://services.gradle.org/distributions/gradle-2.13-bin.zip && \\\n    unzip gradle-2.13-bin.zip && \\\n    mv gradle-2.13 /usr/local && \\\n    rm -rf gradle-2.13*\nENV GRADLE_HOME=/usr/local/gradle-2.13\nENV PATH=$GRADLE_HOME/bin:$PATH\n# ENV OPENCV_JAVA_DIR /root/OpenCV/opencv-3.0.0/build\nENV FEATUREDB_DIR=/usr/local/pathomics_featuredb\n\nWORKDIR /tmp/\nRUN git clone https://github.com/SBU-BMI/pathomics_featuredb && \\\n\tcd pathomics_featuredb/src && \\\n\tgradle build && \\\n\tgradle installDist && \\\n\tcd /tmp && mv pathomics_featuredb /usr/local/. && \\\n\tcp $FEATUREDB_DIR/docker_scripts/run* /usr/local/bin/. && \\\n\tcp $FEATUREDB_DIR/script/run* /usr/local/bin/. && \\\n\tcd /tmp\n\nCOPY redis.conf /etc/redis/redis.conf\n\nWORKDIR /root\nCOPY run.sh /root/\n\nCMD [\"sh\", \"run.sh\"]\n"
}