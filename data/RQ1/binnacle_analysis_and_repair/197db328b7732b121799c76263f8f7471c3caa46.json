{
  "startTime": 1674239435861,
  "endTime": 1674239436371,
  "originalSmells": [
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 78,
        "lineEnd": 78,
        "columnStart": 22,
        "columnEnd": 74
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "FROM java:8\n\nENV KNOWAGE_VERSION 6_3_2\nENV KNOWAGE_EDITION CE\nENV KNOWAGE_RELEASE_DATE 20190306\nENV KNOWAGE_PACKAGE_SUFFIX bin-${KNOWAGE_VERSION}-${KNOWAGE_EDITION}-${KNOWAGE_RELEASE_DATE}\nENV FILEEXTENSION .war\nENV KNOWAGE_REPO_VERSION 6.3.2\nENV KNOWAGE_OW2_BASE_URL http://release.ow2.org/knowage/${KNOWAGE_REPO_VERSION}/Applications\nENV KNOWAGE_OW2_DDL_URL http://release.ow2.org/knowage/${KNOWAGE_REPO_VERSION}/Database%20scripts\n\nENV KNOWAGE_CORE_ENGINE knowage\nENV KNOWAGE_CORE_URL ${KNOWAGE_OW2_BASE_URL}/${KNOWAGE_CORE_ENGINE}${FILEEXTENSION}\n\nENV KNOWAGE_BIRTREPORT_ENGINE ${KNOWAGE_CORE_ENGINE}birtreportengine\nENV KNOWAGE_BIRTREPORT_URL ${KNOWAGE_OW2_BASE_URL}/${KNOWAGE_BIRTREPORT_ENGINE}${FILEEXTENSION}\n\nENV KNOWAGE_COCKPIT_ENGINE ${KNOWAGE_CORE_ENGINE}cockpitengine\nENV KNOWAGE_COCKPIT_URL ${KNOWAGE_OW2_BASE_URL}/${KNOWAGE_COCKPIT_ENGINE}${FILEEXTENSION}\n\nENV KNOWAGE_COMMONJ_ENGINE ${KNOWAGE_CORE_ENGINE}commonjengine\nENV KNOWAGE_COMMONJ_URL ${KNOWAGE_OW2_BASE_URL}/${KNOWAGE_COMMONJ_ENGINE}${FILEEXTENSION}\n\nENV KNOWAGE_DATAMINING_ENGINE ${KNOWAGE_CORE_ENGINE}dataminingengine\nENV KNOWAGE_DATAMINING_URL ${KNOWAGE_OW2_BASE_URL}/${KNOWAGE_DATAMINING_ENGINE}${FILEEXTENSION}\n\nENV KNOWAGE_GEOREPORT_ENGINE ${KNOWAGE_CORE_ENGINE}georeportengine\nENV KNOWAGE_GEOREPORT_URL ${KNOWAGE_OW2_BASE_URL}/${KNOWAGE_GEOREPORT_ENGINE}${FILEEXTENSION}\n\nENV KNOWAGE_JASPERREPORT_ENGINE ${KNOWAGE_CORE_ENGINE}jasperreportengine\nENV KNOWAGE_JASPERREPORT_URL ${KNOWAGE_OW2_BASE_URL}/${KNOWAGE_JASPERREPORT_ENGINE}${FILEEXTENSION}\n\nENV KNOWAGE_KPI_ENGINE ${KNOWAGE_CORE_ENGINE}kpiengine\nENV KNOWAGE_KPI_URL ${KNOWAGE_OW2_BASE_URL}/${KNOWAGE_KPI_ENGINE}${FILEEXTENSION}\n\nENV KNOWAGE_META_ENGINE ${KNOWAGE_CORE_ENGINE}meta\nENV KNOWAGE_META_URL ${KNOWAGE_OW2_BASE_URL}/${KNOWAGE_META_ENGINE}${FILEEXTENSION}\n\nENV KNOWAGE_NETWORK_ENGINE ${KNOWAGE_CORE_ENGINE}networkengine\nENV KNOWAGE_NETWORK_URL ${KNOWAGE_OW2_BASE_URL}/${KNOWAGE_NETWORK_ENGINE}${FILEEXTENSION}\n\nENV KNOWAGE_QBE_ENGINE ${KNOWAGE_CORE_ENGINE}qbeengine\nENV KNOWAGE_QBE_URL ${KNOWAGE_OW2_BASE_URL}/${KNOWAGE_QBE_ENGINE}${FILEEXTENSION}\n\nENV KNOWAGE_SVGVIEWER_ENGINE ${KNOWAGE_CORE_ENGINE}svgviewerengine\nENV KNOWAGE_SVGVIEWER_URL ${KNOWAGE_OW2_BASE_URL}/${KNOWAGE_SVGVIEWER_ENGINE}${FILEEXTENSION}\n\nENV KNOWAGE_TALEND_ENGINE ${KNOWAGE_CORE_ENGINE}talendengine\nENV KNOWAGE_TALEND_URL ${KNOWAGE_OW2_BASE_URL}/${KNOWAGE_TALEND_ENGINE}${FILEEXTENSION}\n\nENV KNOWAGE_WHATIF_ENGINE ${KNOWAGE_CORE_ENGINE}whatifengine\nENV KNOWAGE_WHATIF_URL ${KNOWAGE_OW2_BASE_URL}/${KNOWAGE_WHATIF_ENGINE}${FILEEXTENSION}\n\nENV APACHE_TOMCAT_VERSION 8.5.37\nENV APACHE_TOMCAT_PACKAGE apache-tomcat-${APACHE_TOMCAT_VERSION}\nENV APACHE_TOMCAT_URL https://archive.apache.org/dist/tomcat/tomcat-8/v8.5.37/bin/${APACHE_TOMCAT_PACKAGE}.zip\n\n#location of mysql script to init knowage db\nENV KNOWAGE_MYSQL_SCRIPT_URL ${KNOWAGE_OW2_DDL_URL}/mysql-dbscripts-${KNOWAGE_VERSION}-${KNOWAGE_RELEASE_DATE}.zip\n\nENV LIB_COMMONS_LOGGING_URL https://search.maven.org/remotecontent?filepath=commons-logging/commons-logging/1.1.1/commons-logging-1.1.1.jar\nENV LIB_COMMONS_LOGGING_API_URL https://search.maven.org/remotecontent?filepath=commons-logging/commons-logging-api/1.1/commons-logging-api-1.1.jar\nENV LIB_CONCURRENT_URL https://search.maven.org/remotecontent?filepath=org/lucee/oswego-concurrent/1.3.4/oswego-concurrent-1.3.4.jar\nENV LIB_MYSQL_CONNECTOR_URL https://search.maven.org/remotecontent?filepath=mysql/mysql-connector-java/5.1.33/mysql-connector-java-5.1.33.jar\nENV LIB_GERONIMO_COMMONJ_URL https://search.maven.org/remotecontent?filepath=org/apache/geronimo/specs/geronimo-commonj_1.1_spec/1.0/geronimo-commonj_1.1_spec-1.0.jar\nENV LIB_MYFOO_COMMONJ_URL https://github.com/SpagoBILabs/SpagoBI/blob/mvn-repo/releases/de/myfoo/commonj/1.0/commonj-1.0.jar?raw=true\n\nENV LIB_POSTGRESQL_CONNECTOR_URL https://jdbc.postgresql.org/download/postgresql-42.2.4.jar\n\n#knowage directory\nENV KNOWAGE_DIRECTORY /home/knowage\n#mysql script directory\nENV MYSQL_SCRIPT_DIRECTORY ${KNOWAGE_DIRECTORY}/mysql\n\n#go to knowage home directory\nWORKDIR ${KNOWAGE_DIRECTORY}\n\n#install required packages and clean up to save space\nRUN apt-get update && apt-get install --no-install-recommends -y wget coreutils unzip mysql-client && rm -rf /var/lib/apt/lists/*\n\n#download mysql scripts\nRUN wget \"${KNOWAGE_MYSQL_SCRIPT_URL}\" -O mysql.zip && \\\n        unzip mysql.zip && \\\n        rm mysql.zip\n\n#download apache tomcat and extract it\nRUN wget \"${APACHE_TOMCAT_URL}\" && \\\n       unzip ${APACHE_TOMCAT_PACKAGE}.zip && \\\n       rm ${APACHE_TOMCAT_PACKAGE}.zip\n\n#go to apache tomcat webapps directory\nWORKDIR ${KNOWAGE_DIRECTORY}/${APACHE_TOMCAT_PACKAGE}/webapps\n\n#download knowage engines and extract them\nRUN wget \"${KNOWAGE_CORE_URL}\" && \\\n       unzip ${KNOWAGE_CORE_ENGINE}.war -d ${KNOWAGE_CORE_ENGINE} && \\\n       rm ${KNOWAGE_CORE_ENGINE}.war\n\nRUN wget \"${KNOWAGE_BIRTREPORT_URL}\" && \\\n       unzip ${KNOWAGE_BIRTREPORT_ENGINE}.war -d ${KNOWAGE_BIRTREPORT_ENGINE} && \\\n       rm ${KNOWAGE_BIRTREPORT_ENGINE}.war\n\nRUN wget \"${KNOWAGE_COCKPIT_URL}\" && \\\n       unzip ${KNOWAGE_COCKPIT_ENGINE}.war -d ${KNOWAGE_COCKPIT_ENGINE} && \\\n       rm ${KNOWAGE_COCKPIT_ENGINE}.war\n\nRUN wget \"${KNOWAGE_COMMONJ_URL}\" && \\\n       unzip ${KNOWAGE_COMMONJ_ENGINE}.war -d ${KNOWAGE_COMMONJ_ENGINE} && \\\n       rm ${KNOWAGE_COMMONJ_ENGINE}.war\n\nRUN wget \"${KNOWAGE_DATAMINING_URL}\" && \\\n       unzip ${KNOWAGE_DATAMINING_ENGINE}.war -d ${KNOWAGE_DATAMINING_ENGINE} && \\\n       rm ${KNOWAGE_DATAMINING_ENGINE}.war\n\nRUN wget \"${KNOWAGE_GEOREPORT_URL}\" && \\\n       unzip ${KNOWAGE_GEOREPORT_ENGINE}.war -d ${KNOWAGE_GEOREPORT_ENGINE} && \\\n       rm ${KNOWAGE_GEOREPORT_ENGINE}.war\n\nRUN wget \"${KNOWAGE_JASPERREPORT_URL}\" && \\\n       unzip ${KNOWAGE_JASPERREPORT_ENGINE}.war -d ${KNOWAGE_JASPERREPORT_ENGINE} && \\\n       rm ${KNOWAGE_JASPERREPORT_ENGINE}.war\n\nRUN wget \"${KNOWAGE_KPI_URL}\" && \\\n       unzip ${KNOWAGE_KPI_ENGINE}.war -d ${KNOWAGE_KPI_ENGINE} && \\\n       rm ${KNOWAGE_KPI_ENGINE}.war\n\nRUN wget \"${KNOWAGE_META_URL}\" && \\\n       unzip ${KNOWAGE_META_ENGINE}.war -d ${KNOWAGE_META_ENGINE} && \\\n       rm ${KNOWAGE_META_ENGINE}.war\n\nRUN wget \"${KNOWAGE_NETWORK_URL}\" && \\\n       unzip ${KNOWAGE_NETWORK_ENGINE}.war -d ${KNOWAGE_NETWORK_ENGINE} && \\\n       rm ${KNOWAGE_NETWORK_ENGINE}.war\n\nRUN wget \"${KNOWAGE_QBE_URL}\" && \\\n       unzip ${KNOWAGE_QBE_ENGINE}.war -d ${KNOWAGE_QBE_ENGINE} && \\\n       rm ${KNOWAGE_QBE_ENGINE}.war\n\nRUN wget \"${KNOWAGE_SVGVIEWER_URL}\" && \\\n       unzip ${KNOWAGE_SVGVIEWER_ENGINE}.war -d ${KNOWAGE_SVGVIEWER_ENGINE} && \\\n       rm ${KNOWAGE_SVGVIEWER_ENGINE}.war\n\nRUN wget \"${KNOWAGE_TALEND_URL}\" && \\\n       unzip ${KNOWAGE_TALEND_ENGINE}.war -d ${KNOWAGE_TALEND_ENGINE} && \\\n       rm ${KNOWAGE_TALEND_ENGINE}.war\n\nRUN wget \"${KNOWAGE_WHATIF_URL}\" && \\\n       unzip ${KNOWAGE_WHATIF_ENGINE}.war -d ${KNOWAGE_WHATIF_ENGINE} && \\\n       rm ${KNOWAGE_WHATIF_ENGINE}.war\n\n#go to apache tomcat lib directory\nWORKDIR ${KNOWAGE_DIRECTORY}/${APACHE_TOMCAT_PACKAGE}/lib\n\n#download knowage libs and put them into apache tomcat lib\nRUN wget \"${LIB_COMMONS_LOGGING_URL}\"\nRUN wget \"${LIB_COMMONS_LOGGING_API_URL}\"\nRUN wget \"${LIB_CONCURRENT_URL}\"\nRUN wget \"${LIB_MYSQL_CONNECTOR_URL}\"\nRUN wget \"${LIB_GERONIMO_COMMONJ_URL}\"\nRUN wget \"${LIB_MYFOO_COMMONJ_URL}\"\n\n#dowload DBs libraries and put them into apache tomcat lib\nRUN wget \"${LIB_POSTGRESQL_CONNECTOR_URL}\"\n\n#create setenv.sh file\n#increase Java Heap memory to 4GB - JAVA_OPTS\nRUN touch ${KNOWAGE_DIRECTORY}/${APACHE_TOMCAT_PACKAGE}/bin/setenv.sh\nRUN echo \"JAVA_OPTS=\\\"${JAVA_OPTS} -Xmx4g\\\"\" >> ${KNOWAGE_DIRECTORY}/${APACHE_TOMCAT_PACKAGE}/bin/setenv.sh\n\n#go to apache tomcat configuration directory\nWORKDIR ${KNOWAGE_DIRECTORY}/${APACHE_TOMCAT_PACKAGE}/conf\n\n#override apache tomcat server configuration\nCOPY ./server.xml ./\n\n#go to binary folder in order to execute tomcat startup\nWORKDIR ${KNOWAGE_DIRECTORY}/${APACHE_TOMCAT_PACKAGE}/bin\n\n#make the script executable by bash (not only sh) and\n#make knowage running forever without exiting when running the container\nRUN sed -i \"s/bin\\/sh/bin\\/bash/\" startup.sh && \\\n\tsed -i \"s/EXECUTABLE\\\" start/EXECUTABLE\\\" run/\" startup.sh\n\n#copy entrypoint to be used at runtime\nCOPY ./entrypoint.sh ./\n\n#make all scripts executable\nRUN chmod +x *.sh\n\n#expose common tomcat port\n#this can be used by the host to expose the application\n#you can use it while running image with the param '-p 8080:8080'\nEXPOSE 8080\n\n#-d option is passed to run knowage forever without exiting from container\nENTRYPOINT [\"./entrypoint.sh\"]\n\n#this will start knowage just after the previous entrypoint\nCMD [\"./startup.sh\"]\n"
}