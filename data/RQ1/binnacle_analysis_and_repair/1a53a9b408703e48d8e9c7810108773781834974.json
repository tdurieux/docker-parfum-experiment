{
  "startTime": 1674252282689,
  "endTime": 1674252283105,
  "originalSmells": [
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 6,
        "lineEnd": 6,
        "columnStart": 4,
        "columnEnd": 50
      }
    },
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 13,
        "lineEnd": 13,
        "columnStart": 4,
        "columnEnd": 53
      }
    },
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 18,
        "lineEnd": 18,
        "columnStart": 4,
        "columnEnd": 145
      }
    },
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 99,
        "lineEnd": 99,
        "columnStart": 4,
        "columnEnd": 90
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 128,
        "lineEnd": 128,
        "columnStart": 4,
        "columnEnd": 19
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 136,
        "lineEnd": 136,
        "columnStart": 4,
        "columnEnd": 30
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 137,
        "lineEnd": 137,
        "columnStart": 4,
        "columnEnd": 41
      }
    },
    {
      "rule": "aptGetInstallUseY",
      "position": {
        "lineStart": 15,
        "lineEnd": 15,
        "columnStart": 22,
        "columnEnd": 42
      }
    },
    {
      "rule": "aptGetInstallUseY",
      "position": {
        "lineStart": 103,
        "lineEnd": 103,
        "columnStart": 4,
        "columnEnd": 23
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 7,
        "lineEnd": 7,
        "columnStart": 4,
        "columnEnd": 29
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 10,
        "lineEnd": 10,
        "columnStart": 4,
        "columnEnd": 28
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 15,
        "lineEnd": 15,
        "columnStart": 22,
        "columnEnd": 42
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 22,
        "lineEnd": 27,
        "columnStart": 4,
        "columnEnd": 31
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 31,
        "lineEnd": 31,
        "columnStart": 4,
        "columnEnd": 32
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 82,
        "lineEnd": 83,
        "columnStart": 4,
        "columnEnd": 50
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 84,
        "lineEnd": 86,
        "columnStart": 4,
        "columnEnd": 5
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 103,
        "lineEnd": 103,
        "columnStart": 4,
        "columnEnd": 23
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 129,
        "lineEnd": 129,
        "columnStart": 22,
        "columnEnd": 50
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 10,
        "lineEnd": 10,
        "columnStart": 4,
        "columnEnd": 28
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 22,
        "lineEnd": 27,
        "columnStart": 4,
        "columnEnd": 31
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 49,
        "lineEnd": 52,
        "columnStart": 4,
        "columnEnd": 12
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 7,
        "lineEnd": 7,
        "columnStart": 4,
        "columnEnd": 29
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 10,
        "lineEnd": 10,
        "columnStart": 4,
        "columnEnd": 28
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 15,
        "lineEnd": 15,
        "columnStart": 22,
        "columnEnd": 42
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 22,
        "lineEnd": 27,
        "columnStart": 4,
        "columnEnd": 31
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 31,
        "lineEnd": 31,
        "columnStart": 4,
        "columnEnd": 32
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 103,
        "lineEnd": 103,
        "columnStart": 4,
        "columnEnd": 23
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 129,
        "lineEnd": 129,
        "columnStart": 22,
        "columnEnd": 50
      }
    }
  ],
  "repairedSmells": [
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 10,
        "lineEnd": 10,
        "columnStart": 4,
        "columnEnd": 52
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 22,
        "lineEnd": 27,
        "columnStart": 4,
        "columnEnd": 31
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 49,
        "lineEnd": 52,
        "columnStart": 4,
        "columnEnd": 12
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 31,
        "lineEnd": 31,
        "columnStart": 4,
        "columnEnd": 56
      }
    }
  ],
  "repairedDockerfile": "ARG PYTHON_VERSION\n\nFROM python:$PYTHON_VERSION\n\n# install node\nRUN apt-get update; \\\n    curl -f -sL https://deb.nodesource.com/setup_11.x | bash -; \\\n    apt-get install --no-install-recommends -y nodejs && rm -rf /var/lib/apt/lists/*;\n\n# install rsync\nRUN apt-get install --no-install-recommends -y rsync && rm -rf /var/lib/apt/lists/*;\n\n# install yarn\nRUN curl -f -sS https://dl.yarnpkg.com/debian/pubkey.gpg | apt-key add -; \\\n    echo \"deb https://dl.yarnpkg.com/debian/ stable main\" | tee /etc/apt/sources.list.d/yarn.list; \\\n    apt-get update && apt-get install -y --no-install-recommends yarn; rm -rf /var/lib/apt/lists/*;\n\n# install docker-compose\nRUN curl -f -L \"https://github.com/docker/compose/releases/download/1.24.0/docker-compose-$(uname -s)-$(uname -m)\" -o /usr/local/bin/docker-compose; \\\n    chmod +x /usr/local/bin/docker-compose\n\n# install docker\nRUN apt-get -y --no-install-recommends install \\\n    apt-transport-https \\\n    ca-certificates \\\n    curl \\\n    gnupg2 \\\n    software-properties-common; rm -rf /var/lib/apt/lists/*; \\\n    curl -fsSL https://download.docker.com/linux/ubuntu/gpg | apt-key add - ; \\\n    add-apt-repository \"deb [arch=amd64] https://download.docker.com/linux/debian $(lsb_release -cs) stable\"; \\\n    apt-get update; \\\n    apt-get -y --no-install-recommends install docker-ce\n\n# install java\n\n# We need to use java 8 because https://stackoverflow.com/questions/53583199/pyspark-error-unsupported-class-file-major-version-55\n##################################################################################################\n# https://github.com/docker-library/openjdk/blob/c3023e4da10d10e9c9775eabe2d7baac146e7ae1/8/jdk/slim/Dockerfile\n\n# A few reasons for installing distribution-provided OpenJDK:\n#\n#  1. Oracle.  Licensing prevents us from redistributing the official JDK.\n#\n#  2. Compiling OpenJDK also requires the JDK to be installed, and it gets\n#     really hairy.\n#\n#     For some sample build times, see Debian's buildd logs:\n#       https://buildd.debian.org/status/logs.php?pkg=openjdk-8\n\nRUN apt-get install -y --no-install-recommends \\\n    bzip2 \\\n    unzip \\\n    xz-utils \\\n    && rm -rf /var/lib/apt/lists/*\n\n# Default to UTF-8 file.encoding\nENV LANG C.UTF-8\n\n# add a simple script that can auto-detect the appropriate JAVA_HOME value\n# based on whether the JDK or only the JRE is installed\nRUN { \\\n    echo '#!/bin/sh'; \\\n    echo 'set -e'; \\\n    echo; \\\n    echo 'dirname \"$(dirname \"$(readlink -f \"$(which javac || which java)\")\")\"'; \\\n    } > /usr/local/bin/docker-java-home \\\n    && chmod +x /usr/local/bin/docker-java-home\n\n# do some fancy footwork to create a JAVA_HOME that's cross-architecture-safe\nRUN ln -svT \"/usr/lib/jvm/java-8-openjdk-$(dpkg --print-architecture)\" /docker-java-home\nENV JAVA_HOME /docker-java-home\n\n# Updated from base image\nENV JAVA_VERSION 8u212\nENV JAVA_DEBIAN_VERSION 8u212-b01-1~deb9u1\n\nRUN set -ex; \\\n    # deal with slim variants not having man page directories (which causes \"update-alternatives\" to fail)\n    if [ ! -d /usr/share/man/man1 ]; then \\\n    mkdir -p /usr/share/man/man1; \\\n    fi; \\\n    apt-get update; \\\n    apt-get install --no-install-recommends -y \\\n    openjdk-8-jre-headless=\"$JAVA_DEBIAN_VERSION\"; \\\n    apt-get install --no-install-recommends -y \\\n    openjdk-8-jdk-headless=\"$JAVA_DEBIAN_VERSION\" \\\n    ; \\\n    rm -rf /var/lib/apt/lists/*; \\\n    # verify that \"docker-java-home\" returns what we expect\n    [ \"$(readlink -f \"$JAVA_HOME\")\" = \"$(docker-java-home)\" ]; \\\n    # update-alternatives so that future installs of other OpenJDK versions don't change /usr/bin/java\n    update-alternatives --get-selections | awk -v home=\"$(readlink -f \"$JAVA_HOME\")\" 'index($3, home) == 1 { $2 = \"manual\"; print | \"update-alternatives --set-selections\" }'; \\\n    # ... and verify that it actually worked for one of the alternatives we care about\n    update-alternatives --query java | grep -q 'Status: manual'\n\n##################################################################################################\n\n# Install sbt\nARG SBT_VERSION=1.2.8\nRUN curl -f -L -o sbt-$SBT_VERSION.deb https://dl.bintray.com/sbt/debian/sbt-$SBT_VERSION.deb && \\\n    dpkg -i sbt-$SBT_VERSION.deb && \\\n    rm sbt-$SBT_VERSION.deb && \\\n    apt-get update && \\\n    apt-get install -y --no-install-recommends sbt && \\\n    sbt sbtVersion && rm -rf /var/lib/apt/lists/*;\n\n##################################################################################################\n#\n\n# pip install all the downstream deps to speed up our CI jobs\n#\n# to update (from root):\n#\n# create a new virtual env\n# make install_dev_python_modules\n# pip freeze --exclude-editable > .buildkite/images/integration/snapshot-reqs.txt\n\nRUN pip --no-cache-dir install pyspark==2.4.0\n\n# This instigates some package downloads required by the airline-demo\nADD trigger_maven.py .\nRUN python trigger_maven.py\n\n# Pre-load jars for scala_modules by running a compile\nADD scala_modules scala_modules\nRUN cd scala_modules && make compile\n\n# Postgres (libpq) required for the airline demo\nRUN pip install --no-cache-dir tox\nRUN apt-get update && apt-get -y --no-install-recommends install libpq-dev && rm -rf /var/lib/apt/lists/*;\n\nARG PYTHON_MAJOR_VERSION\n# These are at the bottom and because they are the most likely\n# to change frequently\n\nADD snapshot-reqs-$PYTHON_MAJOR_VERSION.txt /tmp/snapshot-reqs.txt\nRUN pip install --no-cache-dir --upgrade pip; \\\n    pip install --no-cache-dir -r /tmp/snapshot-reqs.txt\n"
}