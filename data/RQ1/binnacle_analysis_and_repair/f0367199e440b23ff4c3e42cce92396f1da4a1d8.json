{
  "startTime": 1674242002061,
  "endTime": 1674242002282,
  "originalSmells": [
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 40,
        "lineEnd": 48,
        "columnStart": 5,
        "columnEnd": 7
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "########## Dockerfile for Apache Hbase version 1.2.6 #########\n#\n# This Dockerfile builds a basic installation of Apache Hbase.\n#\n# Apache HBase is an open-source, distributed, versioned, non-relational database modeled after Google's Bigtable: A Distributed Storage System for Structured Data by Chang et al\n# Apache HBase provides Bigtable-like capabilities on top of Hadoop and HDFS.\n#\n# To build this image, from the directory containing this Dockerfile\n# (assuming that the file is named Dockerfile):\n# docker build -t <image_name> .\n#\n# Start master of Hbase using below command :\n# docker run -d --name <container_name> -p <host-port>:16010 <image-name> hbase master <command>\n# e.g. docker run -d --name hbase_test -p 16011:16010 hbase hbase master start\n#\n# Start Hbase shell( which connect to running instance of HBase) using below command :\n# docker exec -it <container id/name> hbase shell\n# e.g. docker exec -it hbase_test hbase shell\n#\n# To provide custom configuration for Hbase use below command:\n#  docker run --name <container_name> -d -p <host-port>:16010 -v /<host_path>/hbase-env.sh:/root/hbase/conf/hbase-env.sh -v /<host_path>/hbase-site.xml:/root/hbase/conf/hbase-site.xml <image-name>\n#\n# Official website: https://hbase.apache.org/\n#\n###################################################################################\n\n# Base Image\nFROM s390x/ubuntu:16.04\n\n# The author\nMAINTAINER  LoZ Open Source Ecosystem (https://www.ibm.com/developerworks/community/groups/community/lozopensource)\n\nENV SOURCE_DIR='/root'\nENV JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-s390x\nENV PATH=$PATH:$JAVA_HOME/bin:$SOURCE_DIR/hbase/bin\n\nWORKDIR $SOURCE_DIR\n\n# Install dependencies\nRUN apt-get update \\\n  && apt-get install --no-install-recommends -y \\\n\t\t\tant \\\n\t\t\tgcc \\\n\t\t\tgit \\\n\t\t\tmake \\\n\t\t\tmaven \\\n\t\t\topenjdk-8-jdk \\\n      tar \\\n\t\t\twget \\\n\n# Download and build source code of Apache Hbase\n  && cd $SOURCE_DIR \\\n  && git clone git://github.com/apache/hbase.git \\\n  && cd hbase/ \\\n  && git checkout rel/1.2.6 \\\n  && mvn install -DskipTests=true \\\n  && cd $SOURCE_DIR \\\n  && wget https://github.com/jnr/jffi/archive/1.0.0.tar.gz \\\n  && tar -xvf 1.0.0.tar.gz \\\n  && cd jffi-1.0.0/ \\\n\n# Edit the files\n && cp $SOURCE_DIR/jffi-1.0.0/jni/GNUmakefile $SOURCE_DIR/jffi-1.0.0/jni/GNUmakefile.org \\\n && sed -i '68d ' $SOURCE_DIR/jffi-1.0.0/jni/GNUmakefile \\\n && sed -i '68 i WFLAGS += -W -Wall -Wno-unused -Wno-parentheses -Wundef -Wno-unused-parameter' $SOURCE_DIR/jffi-1.0.0/jni/GNUmakefile \\\n && sed -i '159d ' $SOURCE_DIR/jffi-1.0.0/jni/GNUmakefile \\\n && sed -i '159 i SOFLAGS = -shared -static-libgcc -Wl,-soname,$(@F) -Wl,-O1 ' $SOURCE_DIR/jffi-1.0.0/jni/GNUmakefile \\\n && cp $SOURCE_DIR/jffi-1.0.0/libtest/GNUmakefile $SOURCE_DIR/jffi-1.0.0/libtest/GNUmakefile.org \\\n && sed -i '48d ' $SOURCE_DIR/jffi-1.0.0/libtest/GNUmakefile \\\n && sed -i '48 i WFLAGS = -W -Werror -Wall -Wno-unused -Wno-parentheses -Wno-unused-parameter' $SOURCE_DIR/jffi-1.0.0/libtest/GNUmakefile \\\n && sed -i '50d ' $SOURCE_DIR/jffi-1.0.0/libtest/GNUmakefile \\\n && sed -i '50 i SOFLAGS = -shared -Wl,-O1' $SOURCE_DIR/jffi-1.0.0/libtest/GNUmakefile \\\n && ant | exit 0 \\\n && mkdir -p $SOURCE_DIR/jar_tmp \\\n && cp ~/.m2/repository/org/jruby/jruby-complete/1.6.8/jruby-complete-1.6.8.jar $SOURCE_DIR/jar_tmp \\\n && cd $SOURCE_DIR/jar_tmp \\\n && jar xf jruby-complete-1.6.8.jar \\\n && mkdir -p jni/s390x-Linux \\\n && cp $SOURCE_DIR/jffi-1.0.0/build/jni/libjffi-1.0.so jni/s390x-Linux/ \\\n && jar uf jruby-complete-1.6.8.jar jni/s390x-Linux/libjffi-1.0.so \\\n && mv $SOURCE_DIR/jar_tmp/jruby-complete-1.6.8.jar ~/.m2/repository/org/jruby/jruby-complete/1.6.8/jruby-complete-1.6.8.jar \\\n\n# Clean up the unwanted packages and clear the source directory\n && apt-get remove -y \\\n\t\t\tant \\\n\t\t\tgcc \\\n\t\t\tgit \\\n\t\t\tmake \\\n\t\t\tmaven \\\n\t\t\twget \\\n\n  && apt-get autoremove -y \\\n  && apt autoremove -y \\\n  && apt-get clean \\\n  && rm -rf $SOURCE_DIR/jar_tmp $SOURCE_DIR/1.0.0.tar.gz $SOURCE_DIR/jffi-1.0.0 /var/lib/apt/lists/*\n\n# Define mount points for logs, conf files & data.\nVOLUME [\"$SOURCE_DIR/hbase/data\", \"$SOURCE_DIR/hbase/conf\", \"$SOURCE_DIR/hbase/logs\"]\n\n# Port for Apache Hbase\nEXPOSE 2181 16010 60000 60010 60020 60030 8080 8085 9090 9095\n\n# Set the Entrypoint\nCMD [\"hbase\"]\n\n# End of Dockerfile\n"
}