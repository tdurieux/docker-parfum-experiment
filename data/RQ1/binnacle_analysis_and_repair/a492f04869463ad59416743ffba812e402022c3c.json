{
  "startTime": 1674239601474,
  "endTime": 1674239601918,
  "originalSmells": [
    {
      "rule": "npmCacheCleanAfterInstall",
      "position": {
        "lineStart": 200,
        "lineEnd": 200,
        "columnStart": 3,
        "columnEnd": 35
      }
    },
    {
      "rule": "npmCacheCleanAfterInstall",
      "position": {
        "lineStart": 201,
        "lineEnd": 201,
        "columnStart": 3,
        "columnEnd": 29
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 199,
        "lineEnd": 199,
        "columnStart": 3,
        "columnEnd": 28
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 199,
        "lineEnd": 199,
        "columnStart": 3,
        "columnEnd": 28
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 199,
        "lineEnd": 199,
        "columnStart": 3,
        "columnEnd": 28
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "FROM debian:stretch\nRUN DEBIAN_FRONTEND=noninteractive \\\nbash -c \\\n'echo -e \"deb http://deb.debian.org/debian stretch main contrib\\n\\\ndeb http://deb.debian.org/debian stretch-updates main\\n\\\ndeb http://security.debian.org/debian-security stretch/updates main\\n\\\ndeb http://ftp.debian.org/debian stretch-backports main\" > /etc/apt/sources.list\\\n&& apt-get -y update'\nRUN DEBIAN_FRONTEND=noninteractive \\\nbash -c \\\n\"until apt-get -q -y install \\\napt-utils \\\ntzdata \\\npython \\\npython-dev \\\nwget \\\nunzip \\\ngit \\\nlocales \\\napache2 \\\npostgresql \\\nlibapache2-mod-xsendfile \\\nlibffi-dev \\\nlibffi6 \\\ngcc \\\nsupervisor \\\ns3cmd \\\nmake \\\nperl \\\nlibinline-perl \\\nlibparallel-forkmanager-perl \\\nautoconf \\\nautomake \\\nlibjpeg-dev \\\nzlib1g-dev \\\nlibpq-dev \\\nlogrotate \\\nnodejs \\\ncron \\\nlibxml2 \\\nlibxslt1.1 \\\nlibxml2-dev \\\nlibxslt1-dev \\\nlibcurl4-openssl-dev \\\nlibssl-dev \\\nredis-server \\\nrabbitmq-server \\\nlibtool \\\nlibtool-bin \\\nsyslog-ng \\\nrsync \\\ncurl \\\nmktemp \\\ndnsutils \\\nbuild-essential \\\nlibsvm3 \\\nlibsvm-dev \\\nliblinear3 \\\nliblinear-dev \\\nlibzbar-dev \\\nlibzbar0 \\\nlibgs-dev \\\ndefault-libmysqlclient-dev \\\nlibgmp-dev \\\npython-passlib \\\nlibsasl2-dev \\\nlibldap2-dev \\\npython3 \\\nexim4-daemon-heavy \\\npython3-venv \\\npython3-dev \\\nimagemagick \\\npdftk \\\npacpl \\\npandoc \\\ntexlive \\\ntexlive-luatex \\\ntexlive-latex-recommended \\\ntexlive-latex-extra \\\ntexlive-font-utils \\\ntexlive-lang-cyrillic \\\ntexlive-lang-french \\\ntexlive-lang-italian \\\ntexlive-lang-portuguese \\\ntexlive-lang-german \\\ntexlive-lang-european \\\ntexlive-lang-spanish \\\ntexlive-extra-utils \\\npoppler-utils \\\nlibaudio-flac-header-perl \\\nlibaudio-musepack-perl \\\nlibmp3-tag-perl \\\nlibogg-vorbis-header-pureperl-perl \\\nlibvorbis-dev \\\nlibcddb-perl \\\nlibcddb-get-perl \\\nlibmp3-tag-perl \\\nlibaudio-scan-perl \\\nlibaudio-flac-header-perl \\\nlibav-tools \\\ntesseract-ocr \\\ntesseract-ocr-dev \\\ntesseract-ocr-afr \\\ntesseract-ocr-ara \\\ntesseract-ocr-aze \\\ntesseract-ocr-bel \\\ntesseract-ocr-ben \\\ntesseract-ocr-bul \\\ntesseract-ocr-cat \\\ntesseract-ocr-ces \\\ntesseract-ocr-chi-sim \\\ntesseract-ocr-chi-tra \\\ntesseract-ocr-chr \\\ntesseract-ocr-dan \\\ntesseract-ocr-deu \\\ntesseract-ocr-deu-frak \\\ntesseract-ocr-ell \\\ntesseract-ocr-eng \\\ntesseract-ocr-enm \\\ntesseract-ocr-epo \\\ntesseract-ocr-equ \\\ntesseract-ocr-est \\\ntesseract-ocr-eus \\\ntesseract-ocr-fin \\\ntesseract-ocr-fra \\\ntesseract-ocr-frk \\\ntesseract-ocr-frm \\\ntesseract-ocr-glg \\\ntesseract-ocr-grc \\\ntesseract-ocr-heb \\\ntesseract-ocr-hin \\\ntesseract-ocr-hrv \\\ntesseract-ocr-hun \\\ntesseract-ocr-ind \\\ntesseract-ocr-isl \\\ntesseract-ocr-ita \\\ntesseract-ocr-ita-old \\\ntesseract-ocr-jpn \\\ntesseract-ocr-kan \\\ntesseract-ocr-kor \\\ntesseract-ocr-lav \\\ntesseract-ocr-lit \\\ntesseract-ocr-mal \\\ntesseract-ocr-mkd \\\ntesseract-ocr-mlt \\\ntesseract-ocr-msa \\\ntesseract-ocr-nld \\\ntesseract-ocr-nor \\\ntesseract-ocr-osd \\\ntesseract-ocr-pol \\\ntesseract-ocr-por \\\ntesseract-ocr-ron \\\ntesseract-ocr-rus \\\ntesseract-ocr-slk \\\ntesseract-ocr-slk-frak \\\ntesseract-ocr-slv \\\ntesseract-ocr-spa \\\ntesseract-ocr-spa-old \\\ntesseract-ocr-sqi \\\ntesseract-ocr-srp \\\ntesseract-ocr-swa \\\ntesseract-ocr-swe \\\ntesseract-ocr-tam \\\ntesseract-ocr-tel \\\ntesseract-ocr-tgl \\\ntesseract-ocr-tha \\\ntesseract-ocr-tur \\\ntesseract-ocr-ukr \\\ntesseract-ocr-vie \\\nttf-mscorefonts-installer \\\nfonts-ebgaramond-extra \\\nghostscript \\\nttf-liberation \\\nfonts-liberation \\\ncm-super \\\nqpdf; \\\ndo sleep 5; \\\ndone; \\\napt-get -q -y install -t stretch-backports libreoffice &> /dev/null\"\nRUN DEBIAN_FRONTEND=noninteractive TERM=xterm \\\ncd /tmp \\\n&& mkdir -p /etc/ssl/docassemble \\\n   /usr/share/docassemble/local \\\n   /usr/share/docassemble/local3.5 \\\n   /usr/share/docassemble/certs \\\n   /usr/share/docassemble/backup \\\n   /usr/share/docassemble/config \\\n   /usr/share/docassemble/webapp \\\n   /usr/share/docassemble/files \\\n   /var/www/.pip \\\n   /var/www/.cache \\\n   /usr/share/docassemble/log \\\n   /tmp/docassemble \\\n   /var/www/html/log \\\n&& echo '{ \"args\": [\"--no-sandbox\"] }' > /var/www/puppeteer-config.json \\\n&& chown -R www-data.www-data /var/www \\\n&& chsh -s /bin/bash www-data \\\n&& update-alternatives --install /usr/bin/node node /usr/bin/nodejs 10 \\\n&& wget -qO- https://deb.nodesource.com/setup_6.x | bash - \\\n&& apt-get -y --no-install-recommends install nodejs \\\n&& npm install -g azure-storage-cmd \\\n&& npm install -g mermaid.cli && npm cache clean --force; && rm -rf /var/lib/apt/lists/*;\nRUN DEBIAN_FRONTEND=noninteractive TERM=xterm \\\ncd /usr/share/docassemble \\\n&& git clone https://github.com/letsencrypt/letsencrypt \\\n&& cd letsencrypt \\\n&& ./letsencrypt-auto --help \\\n&& echo \"host   all   all  0.0.0.0/0   md5\" >> /etc/postgresql/9.6/main/pg_hba.conf \\\n&& echo \"listen_addresses = '*'\" >> /etc/postgresql/9.6/main/postgresql.conf\nCOPY . /tmp/docassemble/\nRUN DEBIAN_FRONTEND=noninteractive TERM=xterm \\\nln -s /var/mail/mail /var/mail/root \\\n&& cp /tmp/docassemble/docassemble_webapp/docassemble.wsgi /usr/share/docassemble/webapp/ \\\n&& cp /tmp/docassemble/Docker/*.sh /usr/share/docassemble/webapp/ \\\n&& cp /tmp/docassemble/Docker/VERSION /usr/share/docassemble/webapp/ \\\n&& cp /tmp/docassemble/Docker/pip.conf /usr/share/docassemble/local/ \\\n&& cp /tmp/docassemble/Docker/pip.conf /usr/share/docassemble/local3.5/ \\\n&& cp /tmp/docassemble/Docker/config/* /usr/share/docassemble/config/ \\\n&& cp /tmp/docassemble/Docker/cgi-bin/index.sh /usr/lib/cgi-bin/ \\\n&& cp /tmp/docassemble/Docker/syslog-ng.conf /usr/share/docassemble/webapp/syslog-ng.conf \\\n&& cp /tmp/docassemble/Docker/syslog-ng-docker.conf /usr/share/docassemble/webapp/syslog-ng-docker.conf \\\n&& cp /tmp/docassemble/Docker/docassemble-syslog-ng.conf /usr/share/docassemble/webapp/docassemble-syslog-ng.conf \\\n&& cp /tmp/docassemble/Docker/apache.logrotate /etc/logrotate.d/apache2 \\\n&& cp /tmp/docassemble/Docker/docassemble.logrotate /etc/logrotate.d/docassemble \\\n&& cp /tmp/docassemble/Docker/cron/docassemble-cron-monthly.sh /etc/cron.monthly/docassemble \\\n&& cp /tmp/docassemble/Docker/cron/docassemble-cron-weekly.sh /etc/cron.weekly/docassemble \\\n&& cp /tmp/docassemble/Docker/cron/docassemble-cron-daily.sh /etc/cron.daily/docassemble \\\n&& cp /tmp/docassemble/Docker/cron/docassemble-cron-hourly.sh /etc/cron.hourly/docassemble \\\n&& cp /tmp/docassemble/Docker/docassemble.conf /etc/apache2/conf-available/ \\\n&& cp /tmp/docassemble/Docker/docassemble-behindlb.conf /etc/apache2/conf-available/ \\\n&& cp /tmp/docassemble/Docker/docassemble-supervisor.conf /etc/supervisor/conf.d/docassemble.conf \\\n&& cp /tmp/docassemble/Docker/ssl/* /usr/share/docassemble/certs/ \\\n&& cp /tmp/docassemble/Docker/rabbitmq.config /etc/rabbitmq/ \\\n&& cp /tmp/docassemble/Docker/config/exim4-router /etc/exim4/conf.d/router/101_docassemble \\\n&& cp /tmp/docassemble/Docker/config/exim4-filter /etc/exim4/docassemble-filter \\\n&& cp /tmp/docassemble/Docker/config/exim4-main /etc/exim4/conf.d/main/01_docassemble \\\n&& cp /tmp/docassemble/Docker/config/exim4-acl /etc/exim4/conf.d/acl/29_docassemble \\\n&& cp /tmp/docassemble/Docker/config/exim4-update /etc/exim4/update-exim4.conf.conf \\\n&& update-exim4.conf \\\n&& bash -c \\\n\"chown www-data.www-data /usr/share/docassemble/config \\\n&& chown www-data.www-data \\\n   /usr/share/docassemble/config/config.yml.dist \\\n   /usr/share/docassemble/webapp/docassemble.wsgi \\\n&& chown -R www-data.www-data \\\n   /tmp/docassemble \\\n   /usr/share/docassemble/local \\\n   /usr/share/docassemble/local3.5 \\\n   /usr/share/docassemble/log \\\n   /usr/share/docassemble/files \\\n&& chmod ogu+r /usr/share/docassemble/config/config.yml.dist \\\n&& chmod 755 /etc/ssl/docassemble \\\n&& cd /tmp \\\n&& wget https://bootstrap.pypa.io/get-pip.py \\\n&& python get-pip.py \\\n&& rm -f get-pip.py \\\n&& pip install --upgrade virtualenv\" \\\n&& echo \"en_US.UTF-8 UTF-8\" >> /etc/locale.gen \\\n&& locale-gen \\\n&& update-locale\n\nUSER www-data\nRUN LC_CTYPE=C.UTF-8 LANG=C.UTF-8 \\\nbash -c \\\n\"cd /tmp \\\n&& virtualenv /usr/share/docassemble/local \\\n&& source /usr/share/docassemble/local/bin/activate \\\n&& pip install --upgrade pip \\\n&& pip install \\\n   3to2 \\\n   bcrypt \\\n   flask \\\n   flask-login \\\n   flask-mail \\\n   flask-sqlalchemy \\\n   flask-wtf \\\n   distutils2 \\\n   passlib \\\n   pycrypto \\\n   six \\\n&& pip install --upgrade \\\n   'git+https://github.com/euske/pdfminer.git' \\\n   simplekv==0.10.0 \\\n   /tmp/docassemble/docassemble \\\n   /tmp/docassemble/docassemble_base \\\n   /tmp/docassemble/docassemble_demo \\\n   /tmp/docassemble/docassemble_webapp \\\n&& pip uninstall --yes mysqlclient MySQL-python &> /dev/null\"\n\nUSER www-data\nRUN LC_CTYPE=C.UTF-8 LANG=C.UTF-8 \\\nbash -c \\\n\"cd /tmp \\\n&& python3 -m venv --copies /usr/share/docassemble/local3.5 \\\n&& source /usr/share/docassemble/local3.5/bin/activate \\\n&& pip3 install --upgrade pip \\\n&& pip3 install --upgrade \\\n   3to2 \\\n   bcrypt \\\n   flask \\\n   flask-login \\\n   flask-mail \\\n   flask-sqlalchemy \\\n   flask-wtf \\\n   passlib \\\n   pycryptodome \\\n   pycryptodomex \\\n   six \\\n   setuptools \\\n&& pip3 install --upgrade \\\n   simplekv==0.10.0 \\\n   /tmp/docassemble/docassemble \\\n   /tmp/docassemble/docassemble_base \\\n   /tmp/docassemble/docassemble_demo \\\n   /tmp/docassemble/docassemble_webapp \\\n&& pip3 uninstall --yes mysqlclient MySQL-python &> /dev/null\"\n\nUSER root\nRUN rm -rf /tmp/docassemble \\\n&& rm -f /etc/cron.daily/apt-compat \\\n&& sed -i -e 's/^\\(daemonize\\s*\\)yes\\s*$/\\1no/g' -e 's/^bind 127.0.0.1/bind 0.0.0.0/g' /etc/redis/redis.conf \\\n&& sed -i -e 's/#APACHE_ULIMIT_MAX_FILES/APACHE_ULIMIT_MAX_FILES/' -e 's/ulimit -n 65536/ulimit -n 8192/' /etc/apache2/envvars \\\n&& sed -i '/session    required     pam_loginuid.so/c\\#session    required   pam_loginuid.so' /etc/pam.d/cron \\\n&& LANG=en_US.UTF-8 \\\n&& a2dismod ssl; \\\na2enmod rewrite; \\\na2enmod xsendfile; \\\na2enmod proxy; \\\na2enmod proxy_http; \\\na2enmod proxy_wstunnel; \\\na2enmod headers; \\\na2enconf docassemble; \\\necho 'export TERM=xterm' >> /etc/bash.bashrc\nEXPOSE 80 443 9001 514 25 465 8080 8081 5432 6379 4369 5671 5672 25672\nENV \\\nCONTAINERROLE=\"all\" \\\nLOCALE=\"en_US.UTF-8 UTF-8\" \\\nTIMEZONE=\"America/New_York\" \\\nEC2=\"\" \\\nS3ENABLE=\"\" \\\nS3BUCKET=\"\" \\\nS3ACCESSKEY=\"\" \\\nS3SECRETACCESSKEY=\"\" \\\nDAHOSTNAME=\"\" \\\nUSEHTTPS=\"\" \\\nUSELETSENCRYPT=\"\" \\\nLETSENCRYPTEMAIL=\"\" \\\nDBHOST=\"\" \\\nLOGSERVER=\"\" \\\nREDIS=\"\" \\\nRABBITMQ=\"\"\n\nCMD [\"/usr/bin/supervisord\", \"-n\", \"-c\", \"/etc/supervisor/supervisord.conf\"]\n"
}