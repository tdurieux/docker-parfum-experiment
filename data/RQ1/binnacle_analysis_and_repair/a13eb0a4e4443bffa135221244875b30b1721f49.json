{
  "startTime": 1674235596020,
  "endTime": 1674235596156,
  "originalSmells": [
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 14,
        "lineEnd": 14,
        "columnStart": 4,
        "columnEnd": 63
      }
    },
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 35,
        "lineEnd": 36,
        "columnStart": 7,
        "columnEnd": 134
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 16,
        "lineEnd": 20,
        "columnStart": 1,
        "columnEnd": 13
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 3,
        "lineEnd": 10,
        "columnStart": 4,
        "columnEnd": 21
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "FROM mongo:3.4\n\nRUN apt-get update \\\n\t&& apt-get install --no-install-recommends -y \\\n\t\tpython \\\n\t\tpython-dev \\\n\t\tgcc \\\n\t\tcurl \\\n\t\tlibffi-dev \\\n\t\tlibssl-dev \\\n                unzip \\\n\t&& rm -rf /var/lib/apt/lists/*\n\n# get Python drivers MongoDB, Consul, and Manta\nRUN curl -f -Ls -o get-pip.py https://bootstrap.pypa.io/get-pip.py && \\\n\tpython get-pip.py && \\\n\tpip install --no-cache-dir \\\n\t\tPyMongo==3.4.0 \\\n\t\tpython-Consul==0.7.0 \\\n\t\tmanta==2.5.0 \\\n\t\tmock==2.0.0\n\n# Add consul agent\nRUN export CONSUL_VERSION=1.0.6 \\\n    && export CONSUL_CHECKSUM=bcc504f658cef2944d1cd703eda90045e084a15752d23c038400cf98c716ea01 \\\n    && curl --retry 7 --fail -vo /tmp/consul.zip \"https://releases.hashicorp.com/consul/${CONSUL_VERSION}/consul_${CONSUL_VERSION}_linux_amd64.zip\" \\\n    && echo \"${CONSUL_CHECKSUM}  /tmp/consul.zip\" | sha256sum -c \\\n    && unzip /tmp/consul -d /usr/local/bin \\\n    && rm /tmp/consul.zip \\\n    && mkdir -p /opt/consul/config\n\n# Add ContainerPilot and set its configuration file path\nENV CONTAINERPILOT_VER 3.7.0\nENV CONTAINERPILOT /etc/containerpilot.json5\nRUN export CONTAINERPILOT_CHECKSUM=b10b30851de1ae1c095d5f253d12ce8fe8e7be17 \\\n    && curl -f -Lso /tmp/containerpilot.tar.gz \\\n        \"https://github.com/joyent/containerpilot/releases/download/${CONTAINERPILOT_VER}/containerpilot-${CONTAINERPILOT_VER}.tar.gz\" \\\n    && echo \"${CONTAINERPILOT_CHECKSUM}  /tmp/containerpilot.tar.gz\" | sha1sum -c \\\n    && tar zxf /tmp/containerpilot.tar.gz -C /usr/local/bin \\\n    && rm /tmp/containerpilot.tar.gz\n\n# add stopping timeouts for MongoDB\nENV MONGO_SECONDARY_CATCHUP_PERIOD 8\nENV MONGO_STEPDOWN_TIME 60\nENV MONGO_ELECTION_TIMEOUT 30\n\n# Configure ContainerPilot and Mongo\nCOPY etc/* /etc/\nCOPY bin/* /usr/local/bin/\n\nENTRYPOINT [\"containerpilot\"]\n"
}