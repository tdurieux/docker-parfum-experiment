{
  "startTime": 1674235125101,
  "endTime": 1674235125528,
  "originalSmells": [
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 56,
        "lineEnd": 56,
        "columnStart": 4,
        "columnEnd": 46
      }
    },
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 64,
        "lineEnd": 64,
        "columnStart": 7,
        "columnEnd": 133
      }
    },
    {
      "rule": "tarSomethingRmTheSomething",
      "position": {
        "lineStart": 65,
        "lineEnd": 65,
        "columnStart": 7,
        "columnEnd": 51
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 13,
        "lineEnd": 13,
        "columnStart": 4,
        "columnEnd": 72
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 62,
        "lineEnd": 62,
        "columnStart": 7,
        "columnEnd": 42
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 62,
        "lineEnd": 62,
        "columnStart": 7,
        "columnEnd": 42
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "FROM ubuntu:16.04\n\nENV LANG=\"en_US.UTF-8\" \\\n    LC_ALL=\"en_US.UTF-8\" \\\n    LANGUAGE=\"en_US.UTF-8\" \\\n    TERM=\"xterm\" \\\n    DEBIAN_FRONTEND=\"noninteractive\" \\\n    COMPOSER_ALLOW_SUPERUSER=1\n\nEXPOSE 80\nWORKDIR /app\n\nRUN apt-get update -q && \\\n    apt-get install --no-install-recommends -qy software-properties-common language-pack-en-base && \\\n    export LC_ALL=en_US.UTF-8 && \\\n    export LANG=en_US.UTF-8 && \\\n    add-apt-repository -y ppa:ondrej/php && \\\n    apt-get update -q && \\\n    apt-get install --no-install-recommends -qy \\\n        ca-certificates \\\n        cron \\\n        curl \\\n        nano \\\n        nginx \\\n        git \\\n        mysql-client \\\n        php7.1 \\\n        php7.1-bcmath \\\n        php7.1-common \\\n        php7.1-curl \\\n        php7.1-dom \\\n        php7.1-fpm \\\n        php7.1-gd \\\n        php7.1-iconv \\\n        php7.1-intl \\\n        php7.1-json \\\n        php7.1-mbstring \\\n        php7.1-mcrypt \\\n        php7.1-mysql \\\n        php7.1-opcache \\\n        php7.1-pdo \\\n        php7.1-phar \\\n        php7.1-xml \\\n        php7.1-zip \\\n        php7.1-amqp \\\n        php-apcu \\\n        php-uuid \\\n        supervisor \\\n        tzdata \\\n        wget \\\n        wkhtmltopdf && \\\n\n    apt-get clean && rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/* && \\\n\n    cp /usr/share/zoneinfo/Europe/Paris /etc/localtime && echo \"Europe/Paris\" > /etc/timezone && \\\n\n    curl -f -sS https://getcomposer.org/installer | php -- --install-dir=/usr/local/bin --filename=composer && \\\n\n    # Blackfire\n    wget -O - https://packages.blackfire.io/gpg.key | apt-key add - \\\n    && echo \"deb http://packages.blackfire.io/debian any main\" | tee /etc/apt/sources.list.d/blackfire.list \\\n    && apt-get update -q \\\n    && apt-get install --no-install-recommends -qy blackfire-agent \\\n    && version=$(php -r \"echo PHP_MAJOR_VERSION.PHP_MINOR_VERSION;\") \\\n    && curl -f -A \"Docker\" -o /tmp/blackfire-probe.tar.gz -D - -L -s https://blackfire.io/api/v1/releases/probe/php/linux/amd64/$version \\\n    && tar zxpf /tmp/blackfire-probe.tar.gz -C /tmp \\\n    && mv /tmp/blackfire-*.so $(php -r \"echo ini_get('extension_dir');\")/blackfire.so \\\n    && printf \"extension=blackfire.so\\nblackfire.agent_socket=tcp://\\${BLACKFIRE_HOST}:8707\\n\" > /etc/php/7.1/cli/conf.d/blackfire.ini \\\n    && printf \"extension=blackfire.so\\nblackfire.agent_socket=tcp://\\${BLACKFIRE_HOST}:8707\\n\" > /etc/php/7.1/fpm/conf.d/blackfire.ini && rm /tmp/blackfire-probe.tar.gz && rm -rf /var/lib/apt/lists/*;\n\nCOPY . /app\n\nCOPY docker/prod/entrypoint.sh /usr/local/bin/entrypoint.sh\n\nENTRYPOINT [\"/usr/local/bin/entrypoint.sh\"]\n\nRUN chmod 0444 gcloud-service-key.json && \\\n\n    mkdir /run/php && \\\n    mkdir var && \\\n\n    SYMFONY_ENV=prod composer install --optimize-autoloader --no-interaction --no-ansi --no-dev && \\\n    SYMFONY_ENV=prod bin/console cache:clear --no-warmup && \\\n    SYMFONY_ENV=prod bin/console cache:warmup && \\\n\n    chown -R www-data:www-data var && \\\n\n    cp docker/prod/php.ini /etc/php/7.1/cli/conf.d/50-setting.ini && \\\n    mv docker/prod/php.ini /etc/php/7.1/fpm/conf.d/50-setting.ini && \\\n    rm -rf /etc/php/7.1/fpm/pool.d/www.conf && \\\n    mv docker/prod/pool.conf /etc/php/7.1/fpm/pool.d/www.conf && \\\n    rm -rf /etc/nginx/nginx.conf && \\\n    mv docker/prod/nginx.conf /etc/nginx/nginx.conf && \\\n    mv docker/prod/supervisord.conf /etc/supervisor/conf.d/ && \\\n\n    rm -rf docker composer.lock\n\n    CMD [\"supervisord\", \"-c\", \"/etc/supervisor/conf.d/supervisord.conf\"]\n"
}