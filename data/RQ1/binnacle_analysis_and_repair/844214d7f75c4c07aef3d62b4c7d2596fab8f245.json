{
  "startTime": 1674246127187,
  "endTime": 1674246127403,
  "originalSmells": [
    {
      "rule": "tarSomethingRmTheSomething",
      "position": {
        "lineStart": 23,
        "lineEnd": 23,
        "columnStart": 4,
        "columnEnd": 48
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "FROM centos:centos7 as builder\n\nARG YUM_FLAGS_COMMON=\"-y\"\nARG YUM_FLAGS_DEV=\"${YUM_FLAGS_COMMON}\"\n\nARG MAJOR_VERSION=4.2\nARG ZBX_VERSION=${MAJOR_VERSION}.3\nARG ZBX_SOURCES=https://git.zabbix.com/scm/zbx/zabbix.git\nENV ZBX_VERSION=${ZBX_VERSION} ZBX_SOURCES=${ZBX_SOURCES}\n\nCOPY [\"snmptrapfmt_1.14+nmu1ubuntu2.tar.gz\", \"/tmp/\"]\n\nRUN set -eux && \\\n    yum ${YUM_FLAGS_COMMON} makecache && \\\n    yum ${YUM_FLAGS_DEV} install \\\n            autoconf \\\n            automake \\\n            gcc \\\n            patch \\\n            make \\\n            libnsl-devel \\\n            net-snmp-devel && \\\n    cd /tmp/ && \\\n    tar -zxf snmptrapfmt_1.14+nmu1ubuntu2.tar.gz && \\\n    cd /tmp/snmptrapfmt-1.14+nmu1ubuntu1/ && \\\n    patch -p1 < ./patches/makefile.patch && \\\n    make -j\"$(nproc)\" -s && rm snmptrapfmt_1.14+nmu1ubuntu2.tar.gz\n\nFROM centos:centos7\nLABEL maintainer \"Alexey Pustovalov <alexey.pustovalov@zabbix.com>\"\n\nARG BUILD_DATE\nARG VCS_REF\n\nARG YUM_FLAGS_COMMON=\"-y\"\nARG YUM_FLAGS_PERSISTENT=\"${YUM_FLAGS_COMMON}\"\n\nARG MAJOR_VERSION=4.2\nARG ZBX_VERSION=${MAJOR_VERSION}.3\nARG ZBX_SOURCES=https://git.zabbix.com/scm/zbx/zabbix.git\nENV ZBX_VERSION=${ZBX_VERSION} ZBX_SOURCES=${ZBX_SOURCES} \\\n    TERM=xterm MIBDIRS=/usr/share/snmp/mibs:/var/lib/zabbix/mibs MIBS=+ALL\n\nLABEL org.label-schema.name=\"zabbix-snmptraps-centos\" \\\n      org.label-schema.vendor=\"Zabbix LLC\" \\\n      org.label-schema.url=\"https://zabbix.com/\" \\\n      org.label-schema.description=\"Zabbix SNMP traps receiver\" \\\n      org.label-schema.vcs-ref=\"${VCS_REF}\" \\\n      org.label-schema.build-date=\"${BUILD_DATE}\" \\\n      org.label-schema.schema-version=\"1.0\" \\\n      org.label-schema.license=\"GPL v2.0\" \\\n      org.label-schema.usage=\"https://www.zabbix.com/documentation/${MAJOR_VERSION}/manual/installation/containers\" \\\n      org.label-schema.version=\"1.14\" \\\n      org.label-schema.vcs-url=\"https://anonscm.debian.org/gitweb/?p=collab-maint/snmptrapfmt.git\" \\\n      org.label-schema.docker.cmd=\"docker run --name zabbix-snmptraps --link zabbix-server:zabbix-server -p 162:162/UDP -d zabbix-snmptraps:centos-${ZBX_VERSION}\"\n\nSTOPSIGNAL SIGTERM\n\nCOPY --from=builder /tmp/snmptrapfmt-1.14+nmu1ubuntu1/snmptrapfmthdlr /usr/sbin/snmptrapfmthdlr\nCOPY --from=builder /tmp/snmptrapfmt-1.14+nmu1ubuntu1/snmptrapfmt /usr/sbin/snmptrapfmt\nCOPY --from=builder /tmp/snmptrapfmt-1.14+nmu1ubuntu1/snmptrapfmt.conf /etc/snmp/snmptrapfmt.conf\n\nRUN set -eux && \\\n    groupadd --system zabbix && \\\n    adduser -r --shell /sbin/nologin \\\n            -g zabbix \\\n            -d /var/lib/zabbix/ \\\n        zabbix && \\\n    yum ${YUM_FLAGS_COMMON} makecache && \\\n    yum ${YUM_FLAGS_PERSISTENT} install epel-release && \\\n    yum ${YUM_FLAGS_PERSISTENT} install \\\n            net-snmp \\\n            supervisor && \\\n    mkdir -p /var/lib/zabbix && \\\n    mkdir -p /var/lib/zabbix/snmptraps && \\\n    mkdir -p /var/lib/zabbix/mibs && \\\n    chown --quiet -R zabbix:root /var/lib/zabbix && \\\n    echo \"disableAuthorization yes\" >> \"/etc/snmp/snmptrapd.conf\" && \\\n    echo \"traphandle default /usr/sbin/snmptrapfmthdlr\" >> \"/etc/snmp/snmptrapd.conf\" && \\\n    sed -i \\\n            -e \"/^VARFMT=/s/=.*/=\\\"%n %v \\\"/\" \\\n            -e '/^LOGFMT=/s/=.*/=\\\"$x ZBXTRAP $R $G $S $e $*\\\"/' \\\n            -e \"/^LOGFILE=/s/=.*/=\\\"\\/var\\/lib\\/zabbix\\/snmptraps\\/snmptraps.log\\\"/\" \\\n        \"/etc/snmp/snmptrapfmt.conf\" && \\\n    yum ${YUM_FLAGS_COMMON} clean all && \\\n    rm -rf /var/cache/yum\n\nEXPOSE 162/UDP\n\nWORKDIR /var/lib/zabbix/snmptraps/\n\nVOLUME [\"/var/lib/zabbix/snmptraps\", \"/var/lib/zabbix/mibs\"]\n\nCOPY [\"conf/etc/supervisor/\", \"/etc/supervisor/\"]\nCOPY [\"conf/etc/logrotate.d/zabbix_snmptraps\", \"/etc/logrotate.d/\"]\n\nCMD [\"/usr/bin/supervisord\", \"-c\", \"/etc/supervisor/supervisord.conf\"]\n"
}