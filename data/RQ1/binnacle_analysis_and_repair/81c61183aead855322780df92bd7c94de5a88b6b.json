{
  "startTime": 1674244823408,
  "endTime": 1674244826495,
  "originalSmells": [
    {
      "rule": "configureShouldUseBuildFlag",
      "position": {
        "lineStart": 267,
        "lineEnd": 267,
        "columnStart": 2,
        "columnEnd": 29
      }
    },
    {
      "rule": "configureShouldUseBuildFlag",
      "position": {
        "lineStart": 286,
        "lineEnd": 288,
        "columnStart": 2,
        "columnEnd": 36
      }
    },
    {
      "rule": "configureShouldUseBuildFlag",
      "position": {
        "lineStart": 302,
        "lineEnd": 302,
        "columnStart": 2,
        "columnEnd": 29
      }
    },
    {
      "rule": "configureShouldUseBuildFlag",
      "position": {
        "lineStart": 315,
        "lineEnd": 315,
        "columnStart": 2,
        "columnEnd": 41
      }
    },
    {
      "rule": "configureShouldUseBuildFlag",
      "position": {
        "lineStart": 330,
        "lineEnd": 335,
        "columnStart": 2,
        "columnEnd": 22
      }
    },
    {
      "rule": "configureShouldUseBuildFlag",
      "position": {
        "lineStart": 348,
        "lineEnd": 348,
        "columnStart": 2,
        "columnEnd": 51
      }
    },
    {
      "rule": "configureShouldUseBuildFlag",
      "position": {
        "lineStart": 376,
        "lineEnd": 376,
        "columnStart": 2,
        "columnEnd": 63
      }
    },
    {
      "rule": "configureShouldUseBuildFlag",
      "position": {
        "lineStart": 390,
        "lineEnd": 390,
        "columnStart": 2,
        "columnEnd": 29
      }
    },
    {
      "rule": "configureShouldUseBuildFlag",
      "position": {
        "lineStart": 404,
        "lineEnd": 404,
        "columnStart": 2,
        "columnEnd": 29
      }
    },
    {
      "rule": "configureShouldUseBuildFlag",
      "position": {
        "lineStart": 418,
        "lineEnd": 418,
        "columnStart": 2,
        "columnEnd": 29
      }
    },
    {
      "rule": "configureShouldUseBuildFlag",
      "position": {
        "lineStart": 432,
        "lineEnd": 432,
        "columnStart": 2,
        "columnEnd": 29
      }
    },
    {
      "rule": "configureShouldUseBuildFlag",
      "position": {
        "lineStart": 447,
        "lineEnd": 447,
        "columnStart": 2,
        "columnEnd": 57
      }
    },
    {
      "rule": "configureShouldUseBuildFlag",
      "position": {
        "lineStart": 464,
        "lineEnd": 464,
        "columnStart": 2,
        "columnEnd": 29
      }
    },
    {
      "rule": "configureShouldUseBuildFlag",
      "position": {
        "lineStart": 479,
        "lineEnd": 479,
        "columnStart": 2,
        "columnEnd": 29
      }
    },
    {
      "rule": "configureShouldUseBuildFlag",
      "position": {
        "lineStart": 493,
        "lineEnd": 493,
        "columnStart": 2,
        "columnEnd": 29
      }
    },
    {
      "rule": "configureShouldUseBuildFlag",
      "position": {
        "lineStart": 508,
        "lineEnd": 508,
        "columnStart": 2,
        "columnEnd": 45
      }
    },
    {
      "rule": "configureShouldUseBuildFlag",
      "position": {
        "lineStart": 522,
        "lineEnd": 522,
        "columnStart": 2,
        "columnEnd": 29
      }
    },
    {
      "rule": "configureShouldUseBuildFlag",
      "position": {
        "lineStart": 551,
        "lineEnd": 551,
        "columnStart": 2,
        "columnEnd": 29
      }
    },
    {
      "rule": "configureShouldUseBuildFlag",
      "position": {
        "lineStart": 565,
        "lineEnd": 565,
        "columnStart": 2,
        "columnEnd": 29
      }
    },
    {
      "rule": "configureShouldUseBuildFlag",
      "position": {
        "lineStart": 579,
        "lineEnd": 579,
        "columnStart": 2,
        "columnEnd": 29
      }
    },
    {
      "rule": "configureShouldUseBuildFlag",
      "position": {
        "lineStart": 593,
        "lineEnd": 597,
        "columnStart": 2,
        "columnEnd": 17
      }
    },
    {
      "rule": "configureShouldUseBuildFlag",
      "position": {
        "lineStart": 610,
        "lineEnd": 610,
        "columnStart": 2,
        "columnEnd": 29
      }
    },
    {
      "rule": "tarSomethingRmTheSomething",
      "position": {
        "lineStart": 61,
        "lineEnd": 61,
        "columnStart": 5,
        "columnEnd": 43
      }
    },
    {
      "rule": "tarSomethingRmTheSomething",
      "position": {
        "lineStart": 84,
        "lineEnd": 84,
        "columnStart": 5,
        "columnEnd": 39
      }
    },
    {
      "rule": "tarSomethingRmTheSomething",
      "position": {
        "lineStart": 86,
        "lineEnd": 86,
        "columnStart": 2,
        "columnEnd": 40
      }
    },
    {
      "rule": "tarSomethingRmTheSomething",
      "position": {
        "lineStart": 88,
        "lineEnd": 88,
        "columnStart": 2,
        "columnEnd": 39
      }
    },
    {
      "rule": "tarSomethingRmTheSomething",
      "position": {
        "lineStart": 90,
        "lineEnd": 90,
        "columnStart": 2,
        "columnEnd": 39
      }
    },
    {
      "rule": "tarSomethingRmTheSomething",
      "position": {
        "lineStart": 131,
        "lineEnd": 131,
        "columnStart": 5,
        "columnEnd": 40
      }
    },
    {
      "rule": "tarSomethingRmTheSomething",
      "position": {
        "lineStart": 144,
        "lineEnd": 144,
        "columnStart": 5,
        "columnEnd": 39
      }
    },
    {
      "rule": "tarSomethingRmTheSomething",
      "position": {
        "lineStart": 174,
        "lineEnd": 174,
        "columnStart": 5,
        "columnEnd": 39
      }
    },
    {
      "rule": "tarSomethingRmTheSomething",
      "position": {
        "lineStart": 196,
        "lineEnd": 196,
        "columnStart": 5,
        "columnEnd": 43
      }
    },
    {
      "rule": "tarSomethingRmTheSomething",
      "position": {
        "lineStart": 220,
        "lineEnd": 220,
        "columnStart": 5,
        "columnEnd": 39
      }
    },
    {
      "rule": "tarSomethingRmTheSomething",
      "position": {
        "lineStart": 229,
        "lineEnd": 229,
        "columnStart": 2,
        "columnEnd": 40
      }
    },
    {
      "rule": "tarSomethingRmTheSomething",
      "position": {
        "lineStart": 231,
        "lineEnd": 231,
        "columnStart": 2,
        "columnEnd": 39
      }
    },
    {
      "rule": "tarSomethingRmTheSomething",
      "position": {
        "lineStart": 233,
        "lineEnd": 233,
        "columnStart": 2,
        "columnEnd": 39
      }
    },
    {
      "rule": "tarSomethingRmTheSomething",
      "position": {
        "lineStart": 264,
        "lineEnd": 264,
        "columnStart": 5,
        "columnEnd": 46
      }
    },
    {
      "rule": "tarSomethingRmTheSomething",
      "position": {
        "lineStart": 282,
        "lineEnd": 282,
        "columnStart": 5,
        "columnEnd": 39
      }
    },
    {
      "rule": "tarSomethingRmTheSomething",
      "position": {
        "lineStart": 300,
        "lineEnd": 300,
        "columnStart": 5,
        "columnEnd": 42
      }
    },
    {
      "rule": "tarSomethingRmTheSomething",
      "position": {
        "lineStart": 313,
        "lineEnd": 313,
        "columnStart": 5,
        "columnEnd": 41
      }
    },
    {
      "rule": "tarSomethingRmTheSomething",
      "position": {
        "lineStart": 327,
        "lineEnd": 327,
        "columnStart": 5,
        "columnEnd": 40
      }
    },
    {
      "rule": "tarSomethingRmTheSomething",
      "position": {
        "lineStart": 346,
        "lineEnd": 346,
        "columnStart": 5,
        "columnEnd": 40
      }
    },
    {
      "rule": "tarSomethingRmTheSomething",
      "position": {
        "lineStart": 361,
        "lineEnd": 361,
        "columnStart": 5,
        "columnEnd": 40
      }
    },
    {
      "rule": "tarSomethingRmTheSomething",
      "position": {
        "lineStart": 374,
        "lineEnd": 374,
        "columnStart": 5,
        "columnEnd": 43
      }
    },
    {
      "rule": "tarSomethingRmTheSomething",
      "position": {
        "lineStart": 388,
        "lineEnd": 388,
        "columnStart": 5,
        "columnEnd": 42
      }
    },
    {
      "rule": "tarSomethingRmTheSomething",
      "position": {
        "lineStart": 402,
        "lineEnd": 402,
        "columnStart": 5,
        "columnEnd": 38
      }
    },
    {
      "rule": "tarSomethingRmTheSomething",
      "position": {
        "lineStart": 416,
        "lineEnd": 416,
        "columnStart": 5,
        "columnEnd": 44
      }
    },
    {
      "rule": "tarSomethingRmTheSomething",
      "position": {
        "lineStart": 430,
        "lineEnd": 430,
        "columnStart": 5,
        "columnEnd": 39
      }
    },
    {
      "rule": "tarSomethingRmTheSomething",
      "position": {
        "lineStart": 444,
        "lineEnd": 444,
        "columnStart": 5,
        "columnEnd": 43
      }
    },
    {
      "rule": "tarSomethingRmTheSomething",
      "position": {
        "lineStart": 462,
        "lineEnd": 462,
        "columnStart": 5,
        "columnEnd": 38
      }
    },
    {
      "rule": "tarSomethingRmTheSomething",
      "position": {
        "lineStart": 477,
        "lineEnd": 477,
        "columnStart": 5,
        "columnEnd": 37
      }
    },
    {
      "rule": "tarSomethingRmTheSomething",
      "position": {
        "lineStart": 491,
        "lineEnd": 491,
        "columnStart": 5,
        "columnEnd": 38
      }
    },
    {
      "rule": "tarSomethingRmTheSomething",
      "position": {
        "lineStart": 506,
        "lineEnd": 506,
        "columnStart": 5,
        "columnEnd": 38
      }
    },
    {
      "rule": "tarSomethingRmTheSomething",
      "position": {
        "lineStart": 520,
        "lineEnd": 520,
        "columnStart": 5,
        "columnEnd": 40
      }
    },
    {
      "rule": "tarSomethingRmTheSomething",
      "position": {
        "lineStart": 534,
        "lineEnd": 534,
        "columnStart": 5,
        "columnEnd": 41
      }
    },
    {
      "rule": "tarSomethingRmTheSomething",
      "position": {
        "lineStart": 549,
        "lineEnd": 549,
        "columnStart": 5,
        "columnEnd": 39
      }
    },
    {
      "rule": "tarSomethingRmTheSomething",
      "position": {
        "lineStart": 577,
        "lineEnd": 577,
        "columnStart": 5,
        "columnEnd": 40
      }
    },
    {
      "rule": "tarSomethingRmTheSomething",
      "position": {
        "lineStart": 591,
        "lineEnd": 591,
        "columnStart": 5,
        "columnEnd": 46
      }
    },
    {
      "rule": "tarSomethingRmTheSomething",
      "position": {
        "lineStart": 608,
        "lineEnd": 608,
        "columnStart": 5,
        "columnEnd": 37
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 13,
        "lineEnd": 13,
        "columnStart": 2,
        "columnEnd": 68
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "# cf. http://www.linuxfromscratch.org/lfs/view/7.9-systemd/\nFROM debian:8\nARG LFS_TEST=1\nARG PROC=1\nMAINTAINER Perceval BRET\nLABEL  com.ac.src.architecture=\"x86_64\" \\\n    com.ac.src.distribution=\"lfs\" \\\n    com.ac.src.version=\"7.9\" \\\n    com.ac.src.init=\"systemd\"\nCMD [\"/bin/bash\"]\n\n# install required packages\nRUN apt-get -q update && \\\n  apt-get -q --no-install-recommends -y install build-essential bison gawk texinfo wget file && \\\n  apt-get -q -y autoremove && \\\n  rm -rf /var/lib/apt/lists/*\n\n# set bash as default shell\nWORKDIR /bin\nRUN  rm sh && \\\n  ln -s bash sh\n\n# create directories\nENV  LFS=/mnt/lfs\nRUN  mkdir -pv $LFS/{usr,sources} && \\\n  chmod -v a+wt $LFS/sources\nWORKDIR $LFS/sources\n\n\n# check environment\nCOPY [ \"version-check.sh\", \"library-check.sh\", \"$LFS/sources/\" ]\nRUN chmod -v 755 *.sh && sync && ./version-check.sh && ./library-check.sh\n\n# create tools directory\nRUN  mkdir -pv $LFS/tools && \\\n  ln -sv $LFS/tools /\n\n# create lfs user (with lfs as password)\nRUN  groupadd lfs && \\\n  useradd -s /bin/bash -g lfs -m -k /dev/null lfs && \\\n  echo \"lfs:lfs\" | chpasswd\n\n# set directories accesses\nRUN  chown -v lfs $LFS/tools && \\\n  chown -v lfs $LFS/sources\n\n# set lfs user environment\nUSER lfs\nCOPY [ \".bash_profile\", \".bashrc\", \"/home/lfs/\" ]\n\n# @hint must be defined as ENV to be accessible by RUN commands\nENV  LC_ALL=POSIX \\\n  LFS_TGT=x86_64-lfs-linux-gnu \\\n  PATH=/tools/bin:/bin:/usr/bin \\\n  MAKEFLAGS=\"-j $PROC\"\n\n\n###########################\n# compile binutils (pass 1)\n###########################\nCOPY [ \"binutils-2.26.tar.bz2\", \"$LFS/sources/\" ]\nRUN tar -xf binutils-2.26.tar.bz2 -C /tmp/ && \\\n  pushd /tmp/binutils-2.26 && \\\n  mkdir -v build && \\\n  cd build && \\\n  ../configure     \\\n    --prefix=/tools            \\\n    --with-sysroot=$LFS        \\\n    --with-lib-path=/tools/lib \\\n    --target=$LFS_TGT          \\\n    --disable-nls              \\\n    --disable-werror && \\\n  make && \\\n  mkdir -pv /tools/lib && \\\n  ln -sv lib /tools/lib64 && \\\n  make install && \\\n  popd && \\\n  rm -rf /tmp/binutils-* && rm binutils-2.26.tar.bz2\n\n\n######################\n# compile gcc (pass 1)\n######################\nCOPY [ \"gcc-5.3.0.tar.bz2\", \"mpfr-3.1.3.tar.xz\", \"gmp-6.1.0.tar.xz\", \"mpc-1.0.3.tar.gz\", \"$LFS/sources/\" ]\nRUN tar -xf gcc-5.3.0.tar.bz2 -C /tmp/ && \\\n  pushd /tmp/gcc-5.3.0 && \\\n  tar -xf $LFS/sources/mpfr-3.1.3.tar.xz && \\\n  mv -v mpfr-3.1.3 mpfr && \\\n  tar -xf $LFS/sources/gmp-6.1.0.tar.xz && \\\n  mv -v gmp-6.1.0 gmp && \\\n  tar -xf $LFS/sources/mpc-1.0.3.tar.gz && \\\n  mv -v mpc-1.0.3 mpc && \\\n  for file in $(find gcc/config -name linux64.h -o -name linux.h -o -name sysv4.h); do \\\n      cp -uv $file{,.orig}; \\\n      sed -e 's@/lib\\(64\\)\\?\\(32\\)\\?/ld@/tools&@g' -e 's@/usr@/tools@g' $file.orig > $file; \\\n      echo -e \"\\n#undef STANDARD_STARTFILE_PREFIX_1 \\n#undef STANDARD_STARTFILE_PREFIX_2 \\n#define STANDARD_STARTFILE_PREFIX_1 \\\"/tools/lib/\\\" \\n#define STANDARD_STARTFILE_PREFIX_2 \\\"\\\"\" >> $file; \\\n      touch $file.orig; \\\n  done && \\\n  mkdir -v build && \\\n  cd build && \\\n  ../configure                             \\\n    --target=$LFS_TGT                              \\\n    --prefix=/tools                                \\\n    --with-glibc-version=2.11                      \\\n    --with-sysroot=$LFS                            \\\n    --with-newlib                                  \\\n    --without-headers                              \\\n    --with-local-prefix=/tools                     \\\n    --with-native-system-header-dir=/tools/include \\\n    --disable-nls                                  \\\n    --disable-shared                               \\\n    --disable-multilib                             \\\n    --disable-decimal-float                        \\\n    --disable-threads                              \\\n    --disable-libatomic                            \\\n    --disable-libgomp                              \\\n    --disable-libquadmath                          \\\n    --disable-libssp                               \\\n    --disable-libvtv                               \\\n    --disable-libstdcxx                            \\\n    --enable-languages=c,c++ && \\\n  make && \\\n  make install && \\\n  popd && \\\n  rm -rf /tmp/gcc-* && rm gcc-5.3.0.tar.bz2\n\n\n###########################\n# compile Linux API headers\n###########################\nCOPY [ \"linux-4.4.2.tar.xz\", \"$LFS/sources/\" ]\nRUN tar -xf linux-4.4.2.tar.xz -C /tmp/ && \\\n  pushd /tmp/linux-4.4.2 && \\\n  make mrproper && \\\n  make INSTALL_HDR_PATH=dest headers_install && \\\n  cp -rv dest/include/* /tools/include && \\\n  popd && \\\n  rm -rf /tmp/linux-* && rm linux-4.4.2.tar.xz\n\n\n###############\n# compile glibc\n###############\nCOPY [ \"glibc-2.23.tar.xz\", \"$LFS/sources/\" ]\nRUN tar -xf glibc-2.23.tar.xz -C /tmp/ && \\\n  pushd /tmp/glibc-2.23 && \\\n  mkdir -v build && \\\n  cd build && \\\n  ../configure                             \\\n    --prefix=/tools                               \\\n    --host=$LFS_TGT                               \\\n    --build=$(../scripts/config.guess) \\\n    --disable-profile                             \\\n    --enable-kernel=2.6.32                        \\\n    --enable-obsolete-rpc                         \\\n    --with-headers=/tools/include                 \\\n    libc_cv_forced_unwind=yes                     \\\n    libc_cv_ctors_header=yes                      \\\n    libc_cv_c_cleanup=yes && \\\n  make && \\\n  make install && \\\n  popd && \\\n  rm -rf /tmp/glibc-* && rm glibc-2.23.tar.xz\n\n# run tests\nRUN  echo 'int main(){}' > dummy.c && \\\n  $LFS_TGT-gcc dummy.c && \\\n  readelf -l a.out | grep ': /tools' && \\\n  rm -v dummy.c a.out\n\n###################\n# compile libstdc++\n###################\nCOPY [ \"gcc-5.3.0.tar.bz2\", \"$LFS/sources/\" ]\nRUN tar -xf gcc-5.3.0.tar.bz2 -C /tmp/ && \\\n  pushd /tmp/gcc-5.3.0 && \\\n  mkdir -v build && \\\n  cd build && \\\n  ../libstdc++-v3/configure \\\n    --host=$LFS_TGT                 \\\n    --prefix=/tools                 \\\n    --disable-multilib              \\\n    --disable-nls                   \\\n    --disable-libstdcxx-threads     \\\n    --disable-libstdcxx-pch         \\\n    --with-gxx-include-dir=/tools/$LFS_TGT/include/c++/5.3.0 && \\\n  make && \\\n  make install && \\\n  popd && \\\n  rm -rf /tmp/gcc-* && rm gcc-5.3.0.tar.bz2\n\n\n###########################\n# compile binutils (pass 2)\n###########################\nCOPY [ \"binutils-2.26.tar.bz2\", \"$LFS/sources/\" ]\nRUN tar -xf binutils-2.26.tar.bz2 -C /tmp/ && \\\n  pushd /tmp/binutils-2.26 && \\\n  mkdir -v build && \\\n  cd build && \\\n  CC=$LFS_TGT-gcc AR=$LFS_TGT-ar RANLIB=$LFS_TGT-ranlib \\\n  ../configure     \\\n    --prefix=/tools            \\\n    --disable-nls              \\\n    --disable-werror           \\\n    --with-lib-path=/tools/lib \\\n    --with-sysroot && \\\n  make && \\\n  make install && \\\n  make -C ld clean && \\\n  make -C ld LIB_PATH=/usr/lib:/lib && \\\n  cp -v ld/ld-new /tools/bin && \\\n  popd && \\\n  rm -rf /tmp/binutils-* && rm binutils-2.26.tar.bz2\n\n\n######################\n# compile gcc (pass 2)\n######################\nCOPY [ \"gcc-5.3.0.tar.bz2\", \"mpfr-3.1.3.tar.xz\", \"gmp-6.1.0.tar.xz\", \"mpc-1.0.3.tar.gz\", \"$LFS/sources/\" ]\nRUN tar -xf gcc-5.3.0.tar.bz2 -C /tmp/ && \\\n  pushd /tmp/gcc-5.3.0 && \\\n  cat gcc/limitx.h gcc/glimits.h gcc/limity.h > `dirname $($LFS_TGT-gcc -print-libgcc-file-name)`/include-fixed/limits.h && \\\n  for file in $(find gcc/config -name linux64.h -o -name linux.h -o -name sysv4.h); do \\\n      cp -uv $file{,.orig}; \\\n      sed -e 's@/lib\\(64\\)\\?\\(32\\)\\?/ld@/tools&@g' -e 's@/usr@/tools@g' $file.orig > $file; \\\n      echo -e \"\\n#undef STANDARD_STARTFILE_PREFIX_1 \\n#undef STANDARD_STARTFILE_PREFIX_2 \\n#define STANDARD_STARTFILE_PREFIX_1 \\\"/tools/lib/\\\" \\n#define STANDARD_STARTFILE_PREFIX_2 \\\"\\\"\" >> $file; \\\n      touch $file.orig; \\\n  done && \\\n  tar -xf $LFS/sources/mpfr-3.1.3.tar.xz && \\\n  mv -v mpfr-3.1.3 mpfr && \\\n  tar -xf $LFS/sources/gmp-6.1.0.tar.xz && \\\n  mv -v gmp-6.1.0 gmp && \\\n  tar -xf $LFS/sources/mpc-1.0.3.tar.gz && \\\n  mv -v mpc-1.0.3 mpc && \\\n  mkdir -v build && \\\n  cd build && \\\n  CC=$LFS_TGT-gcc CXX=$LFS_TGT-g++ AR=$LFS_TGT-ar RANLIB=$LFS_TGT-ranlib \\\n  ../configure                             \\\n    --prefix=/tools                                \\\n    --with-local-prefix=/tools                     \\\n    --with-native-system-header-dir=/tools/include \\\n    --enable-languages=c,c++                       \\\n    --disable-libstdcxx-pch                        \\\n    --disable-multilib                             \\\n    --disable-bootstrap                            \\\n    --disable-libgomp && \\\n  make && \\\n  make install && \\\n  ln -sv gcc /tools/bin/cc && \\\n  popd && \\\n  rm -rf /tmp/gcc-* && rm gcc-5.3.0.tar.bz2\n\n# run tests\nRUN  echo 'int main(){}' > dummy.c && \\\n  cc dummy.c && \\\n  readelf -l a.out | grep ': /tools' && \\\n  rm -v dummy.c a.out\n\n\n##################\n# compile tcl-core\n##################\nCOPY [ \"tcl-core8.6.4-src.tar.gz\", \"$LFS/sources/\" ]\nRUN tar -xf tcl-core8.6.4-src.tar.gz -C /tmp/ && \\\n  pushd /tmp/tcl8.6.4 && \\\n  cd unix && \\\n  ./configure --build=\"$(dpkg-architecture --query DEB_BUILD_GNU_TYPE)\" --prefix=/tools && \\\n  make && \\\n  if [ $LFS_TEST -eq 1 ]; then TZ=UTC make test; fi && \\\n  make install && \\\n  chmod -v u+w /tools/lib/libtcl8.6.so && \\\n  make install-private-headers && \\\n  ln -sv tclsh8.6 /tools/bin/tclsh && \\\n  popd && \\\n  rm -rf /tmp/tcl* && rm tcl-core8.6.4-src.tar.gz\n\n\n################\n# compile expect\n################\nCOPY [ \"expect5.45.tar.gz\", \"$LFS/sources/\" ]\nRUN tar -xf expect5.45.tar.gz -C /tmp/ && \\\n  pushd /tmp/expect5.45 && \\\n  cp -v configure{,.orig} && \\\n  sed 's:/usr/local/bin:/bin:' configure.orig > configure && \\\n  ./configure --build=\"$(dpkg-architecture --query DEB_BUILD_GNU_TYPE)\" --prefix=/tools \\\n    --with-tcl=/tools/lib \\\n    --with-tclinclude=/tools/include && \\\n  make && \\\n  if [ $LFS_TEST -eq 1 ]; then make test; fi && \\\n  make SCRIPTS=\"\" install && \\\n  popd && \\\n  rm -rf /tmp/expect* && rm expect5.45.tar.gz\n\n\n#################\n# compile dejaGNU\n#################\nCOPY [ \"dejagnu-1.5.3.tar.gz\", \"$LFS/sources/\" ]\nRUN tar -xf dejagnu-1.5.3.tar.gz -C /tmp/ && \\\n  pushd /tmp/dejagnu-1.5.3 && \\\n  ./configure --build=\"$(dpkg-architecture --query DEB_BUILD_GNU_TYPE)\" --prefix=/tools && \\\n  make install && \\\n  if [ $LFS_TEST -eq 1 ]; then make check; fi && \\\n  popd && \\\n  rm -rf /tmp/dejagnu-* && rm dejagnu-1.5.3.tar.gz\n\n\n###############\n# compile check\n###############\nCOPY [ \"check-0.10.0.tar.gz\", \"$LFS/sources/\" ]\nRUN tar -xf check-0.10.0.tar.gz -C /tmp/ && \\\n  pushd /tmp/check-0.10.0 && \\\n  PKG_CONFIG= ./configure --build=\"$(dpkg-architecture --query DEB_BUILD_GNU_TYPE)\" --prefix=/tools && \\\n  make && \\\n  if [ $LFS_TEST -eq 1 ]; then make check; fi && \\\n  make install && \\\n  popd && \\\n  rm -rf /tmp/check-* && rm check-0.10.0.tar.gz\n\n\n#################\n# compile ncurses\n#################\nCOPY [ \"ncurses-6.0.tar.gz\", \"$LFS/sources/\" ]\nRUN tar -xf ncurses-6.0.tar.gz -C /tmp/ && \\\n  pushd /tmp/ncurses-6.0 && \\\n  sed -i s/mawk// configure && \\\n  ./configure --build=\"$(dpkg-architecture --query DEB_BUILD_GNU_TYPE)\" --prefix=/tools \\\n    --with-shared \\\n    --without-debug \\\n    --without-ada \\\n    --enable-widec \\\n    --enable-overwrite && \\\n  make && \\\n  make install && \\\n  popd && \\\n  rm -rf /tmp/ncurses-* && rm ncurses-6.0.tar.gz\n\n\n##############\n# compile bash\n##############\nCOPY [ \"bash-4.3.30.tar.gz\", \"$LFS/sources/\" ]\nRUN tar -xf bash-4.3.30.tar.gz -C /tmp/ && \\\n  pushd /tmp/bash-4.3.30 && \\\n  ./configure --build=\"$(dpkg-architecture --query DEB_BUILD_GNU_TYPE)\" --prefix=/tools --without-bash-malloc && \\\n  make && \\\n  if [ $LFS_TEST -eq 1 ]; then make tests; fi && \\\n  make install && \\\n  ln -sv bash /tools/bin/sh && \\\n  popd && \\\n  rm -rf /tmp/bash-* && rm bash-4.3.30.tar.gz\n\n\n###############\n# compile bzip2\n###############\nCOPY [ \"bzip2-1.0.6.tar.gz\", \"$LFS/sources/\" ]\nRUN tar -xf bzip2-1.0.6.tar.gz -C /tmp/ && \\\n  pushd /tmp/bzip2-1.0.6 && \\\n  make && \\\n  make PREFIX=/tools install && \\\n  popd && \\\n  rm -rf /tmp/bzip2-* && rm bzip2-1.0.6.tar.gz\n\n\n###################\n# compile coreutils\n###################\n# 2 tests fail (dd/direct.sh, dd/sparse.sh). Similar issue reported on some file systems => may be linked to docker fs\nCOPY [ \"coreutils-8.25.tar.xz\", \"$LFS/sources/\" ]\nRUN tar -xf coreutils-8.25.tar.xz -C /tmp/ && \\\n  pushd /tmp/coreutils-8.25 && \\\n  ./configure --build=\"$(dpkg-architecture --query DEB_BUILD_GNU_TYPE)\" --prefix=/tools --enable-install-program=hostname && \\\n  make && \\\n  if [ $LFS_TEST -eq 1 ]; then make RUN_EXPENSIVE_TESTS=yes check || true; fi && \\\n  make install && \\\n  popd && \\\n  rm -rf /tmp/coreutils-* && rm coreutils-8.25.tar.xz\n\n\n###################\n# compile diffutils\n###################\nCOPY [ \"diffutils-3.3.tar.xz\", \"$LFS/sources/\" ]\nRUN tar -xf diffutils-3.3.tar.xz -C /tmp/ && \\\n  pushd /tmp/diffutils-3.3 && \\\n  ./configure --build=\"$(dpkg-architecture --query DEB_BUILD_GNU_TYPE)\" --prefix=/tools && \\\n  make && \\\n  if [ $LFS_TEST -eq 1 ]; then make check; fi && \\\n  make install && \\\n  popd && \\\n  rm -rf /tmp/diffutils-* && rm diffutils-3.3.tar.xz\n\n\n##############\n# compile file\n##############\nCOPY [ \"file-5.25.tar.gz\", \"$LFS/sources/\" ]\nRUN tar -xf file-5.25.tar.gz -C /tmp/ && \\\n  pushd /tmp/file-5.25 && \\\n  ./configure --build=\"$(dpkg-architecture --query DEB_BUILD_GNU_TYPE)\" --prefix=/tools && \\\n  make && \\\n  if [ $LFS_TEST -eq 1 ]; then make check; fi && \\\n  make install && \\\n  popd && \\\n  rm -rf /tmp/file-* && rm file-5.25.tar.gz\n\n\n###################\n# compile findutils\n###################\nCOPY [ \"findutils-4.6.0.tar.gz\", \"$LFS/sources/\" ]\nRUN tar -xf findutils-4.6.0.tar.gz -C /tmp/ && \\\n  pushd /tmp/findutils-4.6.0 && \\\n  ./configure --build=\"$(dpkg-architecture --query DEB_BUILD_GNU_TYPE)\" --prefix=/tools && \\\n  make && \\\n  if [ $LFS_TEST -eq 1 ]; then make check; fi && \\\n  make install && \\\n  popd && \\\n  rm -rf /tmp/findutils-* && rm findutils-4.6.0.tar.gz\n\n\n##############\n# compile gawk\n##############\nCOPY [ \"gawk-4.1.3.tar.xz\", \"$LFS/sources/\" ]\nRUN tar -xf gawk-4.1.3.tar.xz -C /tmp/ && \\\n  pushd /tmp/gawk-4.1.3 && \\\n  ./configure --build=\"$(dpkg-architecture --query DEB_BUILD_GNU_TYPE)\" --prefix=/tools && \\\n  make && \\\n  if [ $LFS_TEST -eq 1 ]; then make check; fi && \\\n  make install && \\\n  popd && \\\n  rm -rf /tmp/gawk-* && rm gawk-4.1.3.tar.xz\n\n\n#################\n# compile gettext\n#################\nCOPY [ \"gettext-0.19.7.tar.xz\", \"$LFS/sources/\" ]\nRUN tar -xf gettext-0.19.7.tar.xz -C /tmp/ && \\\n  pushd /tmp/gettext-0.19.7 && \\\n  cd gettext-tools && \\\n  EMACS=\"no\" ./configure --build=\"$(dpkg-architecture --query DEB_BUILD_GNU_TYPE)\" --prefix=/tools --disable-shared && \\\n  make -C gnulib-lib && \\\n  make -C intl pluralx.c && \\\n  make -C src msgfmt && \\\n  make -C src msgmerge && \\\n  make -C src xgettext && \\\n  cp -v src/{msgfmt,msgmerge,xgettext} /tools/bin && \\\n  popd && \\\n  rm -rf /tmp/gettext-* && rm gettext-0.19.7.tar.xz\n\n\n##############\n# compile grep\n##############\nCOPY [ \"grep-2.23.tar.xz\", \"$LFS/sources/\" ]\nRUN tar -xf grep-2.23.tar.xz -C /tmp/ && \\\n  pushd /tmp/grep-2.23 && \\\n  ./configure --build=\"$(dpkg-architecture --query DEB_BUILD_GNU_TYPE)\" --prefix=/tools && \\\n  make && \\\n  if [ $LFS_TEST -eq 1 ]; then make check; fi && \\\n  make install && \\\n  popd && \\\n  rm -rf /tmp/grep-* && rm grep-2.23.tar.xz\n\n\n##############\n# compile gzip\n##############\n# 1 test fails (zless)\nCOPY [ \"gzip-1.6.tar.xz\", \"$LFS/sources/\" ]\nRUN tar -xf gzip-1.6.tar.xz -C /tmp/ && \\\n  pushd /tmp/gzip-1.6 && \\\n  ./configure --build=\"$(dpkg-architecture --query DEB_BUILD_GNU_TYPE)\" --prefix=/tools && \\\n  make && \\\n  if [ $LFS_TEST -eq 1 ]; then make check || true; fi && \\\n  make install && \\\n  popd && \\\n  rm -rf /tmp/gzip-* && rm gzip-1.6.tar.xz\n\n\n############\n# compile m4\n############\nCOPY [ \"m4-1.4.17.tar.xz\", \"$LFS/sources/\" ]\nRUN tar -xf m4-1.4.17.tar.xz -C /tmp/ && \\\n  pushd /tmp/m4-1.4.17 && \\\n  ./configure --build=\"$(dpkg-architecture --query DEB_BUILD_GNU_TYPE)\" --prefix=/tools && \\\n  make && \\\n  if [ $LFS_TEST -eq 1 ]; then make check; fi && \\\n  make install && \\\n  popd && \\\n  rm -rf /tmp/m4-* && rm m4-1.4.17.tar.xz\n\n\n##############\n# compile make\n##############\n# 1 test fails (misc/fopen-fail)\nCOPY [ \"make-4.1.tar.bz2\", \"$LFS/sources/\" ]\nRUN tar -xf make-4.1.tar.bz2 -C /tmp/ && \\\n  pushd /tmp/make-4.1 && \\\n  ./configure --build=\"$(dpkg-architecture --query DEB_BUILD_GNU_TYPE)\" --prefix=/tools --without-guile && \\\n  make && \\\n  if [ $LFS_TEST -eq 1 ]; then make check || true; fi && \\\n  make install && \\\n  popd && \\\n  rm -rf /tmp/make-* && rm make-4.1.tar.bz2\n\n\n###############\n# compile patch\n###############\nCOPY [ \"patch-2.7.5.tar.xz\", \"$LFS/sources/\" ]\nRUN tar -xf patch-2.7.5.tar.xz -C /tmp/ && \\\n  pushd /tmp/patch-2.7.5 && \\\n  ./configure --build=\"$(dpkg-architecture --query DEB_BUILD_GNU_TYPE)\" --prefix=/tools && \\\n  make && \\\n  if [ $LFS_TEST -eq 1 ]; then make check; fi && \\\n  make install && \\\n  popd && \\\n  rm -rf /tmp/patch-* && rm patch-2.7.5.tar.xz\n\n\n##############\n# compile perl\n##############\nCOPY [ \"perl-5.22.1.tar.bz2\", \"$LFS/sources/\" ]\nRUN tar -xf perl-5.22.1.tar.bz2 -C /tmp/ && \\\n  pushd /tmp/perl-5.22.1 && \\\n  sh Configure -des -Dprefix=/tools -Dlibs=-lm && \\\n  make && \\\n  cp -v perl cpan/podlators/pod2man /tools/bin && \\\n  mkdir -pv /tools/lib/perl5/5.22.1 && \\\n  cp -Rv lib/* /tools/lib/perl5/5.22.1 && \\\n  popd && \\\n  rm -rf /tmp/perl-* && rm perl-5.22.1.tar.bz2\n\n\n#############\n# compile sed\n#############\nCOPY [ \"sed-4.2.2.tar.bz2\", \"$LFS/sources/\" ]\nRUN tar -xf sed-4.2.2.tar.bz2 -C /tmp/ && \\\n  pushd /tmp/sed-4.2.2 && \\\n  ./configure --build=\"$(dpkg-architecture --query DEB_BUILD_GNU_TYPE)\" --prefix=/tools && \\\n  make && \\\n  if [ $LFS_TEST -eq 1 ]; then make check; fi && \\\n  make install && \\\n  popd && \\\n  rm -rf /tmp/sed-* && rm sed-4.2.2.tar.bz2\n\n\n#############\n# compile tar\n#############\nCOPY [ \"tar-1.28.tar.xz\", \"$LFS/sources/\" ]\nRUN tar -xf tar-1.28.tar.xz -C /tmp/ && \\\n  pushd /tmp/tar-1.28 && \\\n  ./configure --build=\"$(dpkg-architecture --query DEB_BUILD_GNU_TYPE)\" --prefix=/tools && \\\n  make && \\\n  if [ $LFS_TEST -eq 1 ]; then make check; fi && \\\n  make install && \\\n  popd && \\\n  rm -rf /tmp/tar-*\n\n\n#################\n# compile texinfo\n#################\nCOPY [ \"texinfo-6.1.tar.xz\", \"$LFS/sources/\" ]\nRUN tar -xf texinfo-6.1.tar.xz -C /tmp/ && \\\n  pushd /tmp/texinfo-6.1 && \\\n  ./configure --build=\"$(dpkg-architecture --query DEB_BUILD_GNU_TYPE)\" --prefix=/tools && \\\n  make && \\\n  if [ $LFS_TEST -eq 1 ]; then make check; fi && \\\n  make install && \\\n  popd && \\\n  rm -rf /tmp/texinfo-* && rm texinfo-6.1.tar.xz\n\n\n####################\n# compile util-linux\n####################\nCOPY [ \"util-linux-2.27.1.tar.xz\", \"$LFS/sources/\" ]\nRUN tar -xf util-linux-2.27.1.tar.xz -C /tmp/ && \\\n  pushd /tmp/util-linux-2.27.1 && \\\n  ./configure --build=\"$(dpkg-architecture --query DEB_BUILD_GNU_TYPE)\" --prefix=/tools \\\n    --without-python \\\n    --disable-makeinstall-chown \\\n    --without-systemdsystemunitdir \\\n    PKG_CONFIG=\"\" && \\ && \\\n  make && \\\n  make install && \\\n  popd && \\\n  rm -rf /tmp/util-linux-* && rm util-linux-2.27.1.tar.xz\n\n\n############\n# compile xz\n############\nCOPY [ \"xz-5.2.2.tar.xz\", \"$LFS/sources/\" ]\nRUN tar -xf xz-5.2.2.tar.xz -C /tmp/ && \\\n  pushd /tmp/xz-5.2.2 && \\\n  ./configure --build=\"$(dpkg-architecture --query DEB_BUILD_GNU_TYPE)\" --prefix=/tools && \\\n  make && \\\n  if [ $LFS_TEST -eq 1 ]; then make check; fi && \\\n  make install && \\\n  popd && \\\n  rm -rf /tmp/xz-* && rm xz-5.2.2.tar.xz\n\n\n# stripping\nRUN  strip --strip-debug /tools/lib/* || true\nRUN  /usr/bin/strip --strip-unneeded /tools/{,s}bin/* || true\nRUN rm -rf /tools/{,share}/{info,man,doc}\nUSER root\nRUN chown -R root:root $LFS/tools\n"
}