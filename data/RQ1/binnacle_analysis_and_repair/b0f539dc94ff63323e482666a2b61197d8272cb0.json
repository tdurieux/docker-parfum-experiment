{
  "startTime": 1674251213222,
  "endTime": 1674251213290,
  "originalSmells": [
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 13,
        "lineEnd": 13,
        "columnStart": 4,
        "columnEnd": 81
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 12,
        "lineEnd": 12,
        "columnStart": 4,
        "columnEnd": 50
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 14,
        "lineEnd": 14,
        "columnStart": 4,
        "columnEnd": 27
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "# docker build -t ejabberd/riak .\n# docker run --rm -it -p 8087:8087 -p 8098:8098 -v \"`pwd`/ebin:/usr/lib/ejabberd/ebin\" --name ejabberd-riak ejabberd/riak\n# docker exec -it ejabberd-riak /bin/bash\n# docker push ejabberd/riak:latest\nFROM ubuntu:16.04\n\nENV DEBIAN_FRONTEND noninteractive\n# ENV RIAK_VERSION 2.0.9-1\n# install riak=${RIAK_VERSION} to fallback to an older version\n\nRUN \\\n    apt-get update -qq && \\\n    apt-get install --no-install-recommends -y curl apt-utils iputils-ping && \\\n    curl -f -s https://packagecloud.io/install/repositories/basho/riak/script.deb.sh | bash && \\\n    apt-get install --no-install-recommends -y riak && \\\n    apt-get clean && rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/*\n\n# Expose default ports\nEXPOSE 8087\nEXPOSE 8098\n\n# Expose volumes for data and logs\nVOLUME /var/log/riak\nVOLUME /var/lib/riak\n\n# Expose volumes for ejabberd code for map/reduce in Riak.\n# It can be overloaded to provide a new ejabberd_riak.beam file.\n# Note that ejabberd_riak.beam needs to be compiled with Erlang/OTP R16\n# as this is the version of Erlang Basho has packaged with Riak.\nCOPY ejabberd_riak.beam /usr/lib/ejabberd/ebin/ejabberd_riak.beam\nVOLUME /usr/lib/ejabberd/ebin\n\n# Install custom start script\nCOPY riak-cluster.sh /sbin/riak-cluster.sh\nRUN chmod a+x /sbin/riak-cluster.sh\n\n# Change configuration to make it work with ejabberd\nCOPY advanced.config /etc/riak/advanced.config\nCOPY riak.conf /etc/riak/riak.conf\n\n# Install custom hooks\nCOPY prestart.d /etc/riak/prestart.d\n# COPY poststart.d /etc/riak/poststart.d\n\n# Prepare for bootstrapping schemas\nRUN mkdir -p /etc/riak/schemas\n\n# Clean up APT cache\nRUN rm -rf /var/lib/apt/lists/* /tmp/*\n\nWORKDIR /var/lib/riak\n\nCMD [\"/sbin/riak-cluster.sh\"]\n"
}