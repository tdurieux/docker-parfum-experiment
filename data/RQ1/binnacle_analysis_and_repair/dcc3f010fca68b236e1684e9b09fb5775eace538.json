{
  "startTime": 1674246731063,
  "endTime": 1674246731247,
  "originalSmells": [
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 10,
        "lineEnd": 10,
        "columnStart": 4,
        "columnEnd": 29
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "FROM bigm/base-deb\n# https://github.com/LyleScott/docker-nagios4/blob/master/Dockerfile\n# https://github.com/opinkerfi/adagios/wiki/Install-guide\n# alternative: http://www.rohit.io/blog/rip-nagios-hello-docker-shinken.html\n# followed some instructions from http://cytheric.net/ref/adagios.html\n\nRUN /xt/tools/_apt_install nagios3 pnp4nagios git libapache2-mod-wsgi check-mk-livestatus python-pip \\\n  python-django python-simplejson libgmp-dev python-dev python-paramiko php5-cli\n\n# pynag adagios\nRUN pip install --no-cache-dir pynag adagios\n# django==1.4.15 ??? https://github.com/opinkerfi/adagios/pull/431\n# pip install --install-option=\"--prefix=/opt/adagios\" django==1.4.15 pynag adagios\n\n# If you plan on using the built-in status view in adagios you need these:\nRUN pynag config --append \"broker_module=/usr/lib/check_mk/livestatus.o /var/lib/nagios3/rw/livestatus\"\n\n# New objects created with adagios go here, make sure nagios is reading that directory\nRUN mkdir -p /etc/nagios3/adagios \\\n  && pynag config --append \"cfg_dir=/etc/nagios3/adagios\"\n\n# Make sure nagios group will always have write access to the configuration files:\nRUN chown -R nagios /etc/nagios3 /etc/adagios\n\n# Install pnp4nagios and get graphs working\nRUN pynag config --set \"process_performance_data=1\" \\\n  && pynag config --append \"broker_module=/usr/lib/pnp4nagios/npcdmod.o config_file=/etc/pnp4nagios/npcd.cfg\" \\\n  && usermod -G www-data nagios \\\n  && sed -i 's/RUN.*/RUN=\"yes\"/' /etc/default/npcd\n\n# adagios for Debian\nRUN sed -i 's|/etc/nagios/nagios.cfg|/etc/nagios3/nagios.cfg|;' /etc/adagios/adagios.conf \\\n  && sed -i 's|sudo /etc/init.d/nagios|sudo /etc/init.d/nagios3|;' /etc/adagios/adagios.conf \\\n  && sed -i 's|nagios_url = \"/nagios\"|nagios_url = \"/nagios3\"|;' /etc/adagios/adagios.conf \\\n  && sed -i 's|destination_directory.*|destination_directory = \"/etc/nagios3/adagios/\"|;' /etc/adagios/adagios.conf \\\n  && sed -i 's|nagios_binary.*|nagios_binary = \"/usr/sbin/nagios3\"|;' /etc/adagios/adagios.conf \\\n  && sed -i 's|pnp_filepath.*|pnp_filepath = \"/usr/share/pnp4nagios/html/index.php\"|;' /etc/adagios/adagios.conf \\\n  && sed -i 's|$conf\\[\\x27livestatus_socket\\x27\\].*|$conf[\\x27livestatus_socket\\x27] = \"unix:/var/lib/nagios3/rw/livestatus\";|;' /etc/pnp4nagios/config.php\n\nRUN mkdir -p /var/lib/adagios && chown -R nagios:www-data /var/lib/adagios\n\n#TODO  && sed -i 's|nagios_init_script=.*|nagios_init_script = \"supervisorctl RESTART\"|;' /etc/adagios/adagios.conf \\\n\nRUN htpasswd -c -b -s /etc/nagios3/htpasswd.users admin admin \\\n  && chown -R nagios.nagios /etc/nagios3/htpasswd.users\n\n## Create git repo which adagios uses for version control\nRUN cd /etc/nagios3/ \\\n  && git init \\\n  && git config --global user.email \"you@example.com\" \\\n  && git config --global user.name \"Your Name\" \\\n  && git add . \\\n  && git commit -a -m \"Initial commit\"\n\n# configure services\nADD supervisor/* /etc/supervisord.d/\nADD sites/* /etc/apache2/sites-enabled/\n\n## this config will be used to initialize if empty config is mounted\nRUN mv /etc/nagios3 /etc/nagios3_orig\nADD startup/* /prj/startup/\n"
}