{
  "startTime": 1674241331560,
  "endTime": 1674241335451,
  "originalSmells": [
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 32,
        "lineEnd": 32,
        "columnStart": 7,
        "columnEnd": 120
      }
    },
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 36,
        "lineEnd": 36,
        "columnStart": 7,
        "columnEnd": 134
      }
    },
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 40,
        "lineEnd": 40,
        "columnStart": 7,
        "columnEnd": 55
      }
    },
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 45,
        "lineEnd": 45,
        "columnStart": 7,
        "columnEnd": 53
      }
    },
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 52,
        "lineEnd": 52,
        "columnStart": 7,
        "columnEnd": 132
      }
    },
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 54,
        "lineEnd": 54,
        "columnStart": 7,
        "columnEnd": 133
      }
    },
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 58,
        "lineEnd": 58,
        "columnStart": 7,
        "columnEnd": 121
      }
    },
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 91,
        "lineEnd": 91,
        "columnStart": 7,
        "columnEnd": 170
      }
    },
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 128,
        "lineEnd": 128,
        "columnStart": 7,
        "columnEnd": 70
      }
    },
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 134,
        "lineEnd": 134,
        "columnStart": 7,
        "columnEnd": 112
      }
    },
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 164,
        "lineEnd": 164,
        "columnStart": 7,
        "columnEnd": 49
      }
    },
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 171,
        "lineEnd": 171,
        "columnStart": 7,
        "columnEnd": 95
      }
    },
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 372,
        "lineEnd": 372,
        "columnStart": 7,
        "columnEnd": 162
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 130,
        "lineEnd": 130,
        "columnStart": 7,
        "columnEnd": 26
      }
    },
    {
      "rule": "tarSomethingRmTheSomething",
      "position": {
        "lineStart": 59,
        "lineEnd": 59,
        "columnStart": 7,
        "columnEnd": 44
      }
    },
    {
      "rule": "tarSomethingRmTheSomething",
      "position": {
        "lineStart": 135,
        "lineEnd": 135,
        "columnStart": 7,
        "columnEnd": 29
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 64,
        "lineEnd": 68,
        "columnStart": 7,
        "columnEnd": 104
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 69,
        "lineEnd": 73,
        "columnStart": 7,
        "columnEnd": 92
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 74,
        "lineEnd": 78,
        "columnStart": 7,
        "columnEnd": 92
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 115,
        "lineEnd": 117,
        "columnStart": 7,
        "columnEnd": 64
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 120,
        "lineEnd": 122,
        "columnStart": 7,
        "columnEnd": 39
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 46,
        "lineEnd": 46,
        "columnStart": 7,
        "columnEnd": 149
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 64,
        "lineEnd": 68,
        "columnStart": 7,
        "columnEnd": 104
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 69,
        "lineEnd": 73,
        "columnStart": 7,
        "columnEnd": 92
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 74,
        "lineEnd": 78,
        "columnStart": 7,
        "columnEnd": 92
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 115,
        "lineEnd": 117,
        "columnStart": 7,
        "columnEnd": 64
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 120,
        "lineEnd": 122,
        "columnStart": 7,
        "columnEnd": 39
      }
    }
  ],
  "repairedSmells": [
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 115,
        "lineEnd": 117,
        "columnStart": 7,
        "columnEnd": 64
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 120,
        "lineEnd": 122,
        "columnStart": 7,
        "columnEnd": 39
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 64,
        "lineEnd": 68,
        "columnStart": 7,
        "columnEnd": 104
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 69,
        "lineEnd": 73,
        "columnStart": 7,
        "columnEnd": 92
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 74,
        "lineEnd": 78,
        "columnStart": 7,
        "columnEnd": 92
      }
    }
  ],
  "repairedDockerfile": "FROM niiknow/docker-hostingbase:1.4.2\nLABEL maintainer=\"noogen <friends@niiknow.org>\"\nENV DEBIAN_FRONTEND=noninteractive \\\n    VESTA=/usr/local/vesta \\\n    GOLANG_VERSION=1.12.5 \\\n    NGINX_BUILD_DIR=/usr/src/nginx \\\n    NGINX_DEVEL_KIT_VERSION=0.3.0 NGINX_SET_MISC_MODULE_VERSION=0.32 \\\n    NGINX_VERSION=1.16.0 \\\n    NGINX_PAGESPEED_VERSION=1.13.35.2 \\\n    NGINX_PSOL_VERSION=1.13.35.2 \\\n    IMAGE_FILTER_URL=https://raw.githubusercontent.com/niiknow/docker-nginx-image-proxy/master/build/src/ngx_http_image_filter_module.c\n\nRUN cd /tmp \\\n    && apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --recv-keys 91FA4AD5 \\\n    && add-apt-repository ppa:deadsnakes/ppa \\\n    && add-apt-repository ppa:maxmind/ppa -y \\\n    && echo \"nginx mysql bind clamav ssl-cert dovecot dovenull Debian-exim postgres debian-spamd epmd couchdb memcache mongodb redis\" | xargs -n1 groupadd -K GID_MIN=100 -K GID_MAX=999 ${g} \\\n    && echo \"nginx nginx mysql mysql bind bind clamav clamav dovecot dovecot dovenull dovenull Debian-exim Debian-exim postgres postgres debian-spamd debian-spamd epmd epmd couchdb couchdb memcache memcache mongodb mongodb redis redis\" | xargs -n2 useradd -d /nonexistent -s /bin/false -K UID_MIN=100 -K UID_MAX=999 -g ${g} \\\n    && usermod -d /var/lib/mysql mysql \\\n    && usermod -d /var/cache/bind bind \\\n    && usermod -d /var/lib/clamav -a -G Debian-exim clamav && usermod -a -G mail clamav \\\n    && usermod -d /usr/lib/dovecot -a -G mail dovecot \\\n    && usermod -d /var/spool/exim4 -a -G mail Debian-exim \\\n    && usermod -d /var/lib/postgresql -s /bin/bash -a -G ssl-cert postgres \\\n    && usermod -d /var/lib/spamassassin -s /bin/sh -a -G mail debian-spamd \\\n    && usermod -d /var/run/epmd epmd \\\n    && usermod -d /var/lib/couchdb -s /bin/bash couchdb \\\n    && usermod -d /var/lib/mongodb -a -G nogroup mongodb \\\n    && usermod -d /var/lib/redis redis \\\n    && add-apt-repository \"deb http://apt.postgresql.org/pub/repos/apt/ xenial-pgdg main\" \\\n    && wget --quiet -O - https://www.postgresql.org/media/keys/ACCC4CF8.asc | sudo apt-key add - \\\n    && add-apt-repository ppa:ubuntugis/ubuntugis-unstable \\\n    && curl -f -sL \"https://github.com/simplresty/ngx_devel_kit/archive/v$NGINX_DEVEL_KIT_VERSION.tar.gz\" -o dev-kit.tar.gz \\\n    && mkdir -p /usr/src/nginx/ngx_devel_kit \\\n    && tar -xof dev-kit.tar.gz -C /usr/src/nginx/ngx_devel_kit --strip-components=1 \\\n    && rm dev-kit.tar.gz \\\n    && curl -f -sL \"https://github.com/openresty/set-misc-nginx-module/archive/v$NGINX_SET_MISC_MODULE_VERSION.tar.gz\" -o ngx-misc.tar.gz \\\n    && mkdir -p /usr/src/nginx/set-misc-nginx-module \\\n    && tar -xof ngx-misc.tar.gz -C /usr/src/nginx/set-misc-nginx-module --strip-components=1 \\\n    && rm ngx-misc.tar.gz \\\n    && curl -f -s https://nginx.org/keys/nginx_signing.key | apt-key add - \\\n    && cp /etc/apt/sources.list /etc/apt/sources.list.bak \\\n    && echo \"deb http://nginx.org/packages/ubuntu/ xenial nginx\" | tee -a /etc/apt/sources.list \\\n    && echo \"deb-src http://nginx.org/packages/ubuntu/ xenial nginx\" | tee -a /etc/apt/sources.list \\\n    && apt-get update && apt-get -y --no-install-recommends upgrade \\\n    && curl -f -sL https://deb.nodesource.com/setup_10.x | sudo -E bash - \\\n    && apt-get install -y --no-install-recommends libpcre3-dev libssl-dev dpkg-dev libmaxminddb0 libmaxminddb-dev mmdb-bin libgd-dev iproute uuid-dev \\\n    && mkdir -p ${NGINX_BUILD_DIR} \\\n    && cd ${NGINX_BUILD_DIR} \\\n    && git clone https://github.com/leev/ngx_http_geoip2_module ngx_http_geoip2_module \\\n    && apt-get source nginx=${NGINX_VERSION} -y \\\n    && mv ${NGINX_BUILD_DIR}/nginx-${NGINX_VERSION}/src/http/modules/ngx_http_image_filter_module.c ${NGINX_BUILD_DIR}/nginx-${NGINX_VERSION}/src/http/modules/ngx_http_image_filter_module.bak \\\n    && curl -f -SL $IMAGE_FILTER_URL --output ${NGINX_BUILD_DIR}/nginx-${NGINX_VERSION}/src/http/modules/ngx_http_image_filter_module.c \\\n    && sed -i \"s/--with-http_ssl_module/--with-http_ssl_module --with-http_image_filter_module --add-module=\\/usr\\/src\\/nginx\\/ngx_http_geoip2_module --add-module=\\/usr\\/src\\/nginx\\/ngx_devel_kit --add-module=\\/usr\\/src\\/nginx\\/set-misc-nginx-module --add-module=\\/usr\\/src\\/nginx\\/ngx_pagespeed-latest-stable/g\" ${NGINX_BUILD_DIR}/nginx-${NGINX_VERSION}/debian/rules \\\n    && curl -f -SL https://github.com/apache/incubator-pagespeed-ngx/archive/v${NGINX_PAGESPEED_VERSION}-stable.zip -o latest-stable.zip \\\n    && unzip latest-stable.zip \\\n    && mv incubator-pagespeed-ngx-${NGINX_PAGESPEED_VERSION}-stable ngx_pagespeed-latest-stable \\\n    && cd ngx_pagespeed-latest-stable \\\n    && curl -f -SL https://dl.google.com/dl/page-speed/psol/${NGINX_PSOL_VERSION}-x64.tar.gz -o ${NGINX_PSOL_VERSION}.tar.gz \\\n    && tar -xzf ${NGINX_PSOL_VERSION}.tar.gz \\\n    && apt-get build-dep nginx -y \\\n    && cd ${NGINX_BUILD_DIR}/nginx-${NGINX_VERSION}; rm ${NGINX_PSOL_VERSION}.tar.gz rm -rf /var/lib/apt/lists/*; dpkg-buildpackage -uc -us -b \\\n    && cd ${NGINX_BUILD_DIR} \\\n    && dpkg -i nginx_${NGINX_VERSION}-1~xenial_amd64.deb \\\n    && apt-get install --no-install-recommends -yq php7.1-mbstring php7.1-cgi php7.1-cli php7.1-dev php7.1-geoip php7.1-common php7.1-xmlrpc php7.1-sybase php7.1-curl \\\n        php7.1-enchant php7.1-imap php7.1-xsl php7.1-mysql php7.1-mysqli php7.1-mysqlnd php7.1-pspell php7.1-gd php7.1-zip \\\n        php7.1-tidy php7.1-opcache php7.1-json php7.1-bz2 php7.1-pgsql php7.1-mcrypt php7.1-readline php7.1-imagick \\\n        php7.1-intl php7.1-sqlite3 php7.1-ldap php7.1-xml php7.1-redis php7.1-dev php7.1-fpm php7.1-sodium \\\n        php7.1-soap php7.1-bcmath php7.1-fileinfo php7.1-xdebug php7.1-exif php7.1-tokenizer php7.1-phar \\\n    && apt-get install --no-install-recommends -yq php7.2-mbstring php7.2-cgi php7.2-cli php7.2-dev php7.2-geoip php7.2-common php7.2-xmlrpc php7.2-sybase php7.2-curl \\\n        php7.2-enchant php7.2-imap php7.2-xsl php7.2-mysql php7.2-mysqli php7.2-mysqlnd php7.2-pspell php7.2-gd php7.2-zip \\\n        php7.2-tidy php7.2-opcache php7.2-json php7.2-bz2 php7.2-pgsql php7.2-readline php7.2-imagick php7.2-phar \\\n        php7.2-intl php7.2-sqlite3 php7.2-ldap php7.2-xml php7.2-redis php7.2-dev php7.2-fpm \\\n        php7.2-soap php7.2-bcmath php7.2-fileinfo php7.2-xdebug php7.2-exif php7.2-tokenizer \\\n    && apt-get install --no-install-recommends -yq php7.3-mbstring php7.3-cgi php7.3-cli php7.3-dev php7.3-geoip php7.3-common php7.3-xmlrpc php7.3-sybase php7.3-curl \\\n        php7.3-enchant php7.3-imap php7.3-xsl php7.3-mysql php7.3-mysqli php7.3-mysqlnd php7.3-pspell php7.3-gd php7.3-zip \\\n        php7.3-tidy php7.3-opcache php7.3-json php7.3-bz2 php7.3-pgsql php7.3-readline php7.3-imagick php7.3-phar \\\n        php7.3-intl php7.3-sqlite3 php7.3-ldap php7.3-xml php7.3-redis php7.3-dev php7.3-fpm \\\n        php7.3-soap php7.3-bcmath php7.3-fileinfo php7.3-xdebug php7.3-exif php7.3-tokenizer \\\n\n# put nginx on hold so it doesn't get updates with apt-get upgrade, also remove from vesta apt-get\n    && apt-mark hold nginx \\\n    && rm -f /etc/apt/sources.list && mv /etc/apt/sources.list.bak /etc/apt/sources.list \\\n    && rm -rf /usr/src/nginx \\\n    && rm -rf /tmp/* \\\n    && apt-get -yf autoremove \\\n    && apt-get clean\n\nRUN cd /tmp \\\n    && touch /var/log/auth.log \\\n# begin setup for vesta \\\n    && curl -f -SL https://raw.githubusercontent.com/serghey-rodin/vesta/3acd2281699fcaede439da0687d64586525a15a1/install/vst-install-ubuntu.sh -o /tmp/vst-install-ubuntu.sh \\\n    && sed -i -e \"s/software\\=\\\"nginx /software\\=\\\"/g\" /tmp/vst-install-ubuntu.sh \\\n\n# fix mariadb instead of mysql\n    && sed -i -e \"s/mysql\\-/mariadb\\-/g\" /tmp/vst-install-ubuntu.sh \\\n\n# fix postgres-9.6 instead of 9.5\n    && sed -i -e \"s/postgresql postgresql-contrib /postgresql\\-9\\.6 postgresql\\-contrib\\-9\\.6 postgresql\\-client\\-9\\.6 /g\" /tmp/vst-install-ubuntu.sh \\\n\n# begin install vesta\n    && bash /tmp/vst-install-ubuntu.sh \\\n        --nginx yes --apache yes --phpfpm no \\\n        --vsftpd no --proftpd no \\\n        --named yes --exim yes --dovecot yes \\\n        --spamassassin yes --clamav yes \\\n        --iptables yes --fail2ban yes \\\n        --mysql yes --postgresql yes --remi yes \\\n        --quota no --password MakeItSo18 \\\n        -y no -f \\\n\n# begin apache stuff\n    && service apache2 stop && service vesta stop \\\n\n# install additional mods since 7.2 became default in the php repo\n    && apt-get install -yf --no-install-recommends libapache2-mod-php7.1 libapache2-mod-php7.2 libapache2-mod-php7.3 \\\n        postgresql-9.6-postgis-2.5 postgresql-9.6-pgrouting postgis postgis-gui postgresql-9.6-pgaudit \\\n        postgresql-9.6-postgis-2.5-scripts postgresql-9.6-repack \\\n\n# install nodejs, memcached, redis-server, openvpn, mongodb, dotnet-sdk, and couchdb\n    && apt-get install -yf --no-install-recommends nodejs memcached php-memcached redis-server \\\n        openvpn mongodb-org php-mongodb couchdb dotnet-sdk-2.2 poppler-utils ghostscript \\\n        libgs-dev imagemagick python3.7 \\\n\n# default python 3.7\n    && ln -sf $(which python3.7) /usr/bin/python3 \\\n\n# setting upawscli, golang, and awscli\n    && curl -f -sS \"https://bootstrap.pypa.io/get-pip.py\" -o \"get-pip.py\" \\\n    && python3 get-pip.py \\\n    && pip3 install --no-cache-dir awscli \\\n\n# getting golang\n    && cd /tmp \\\n    && curl -f -SL https://storage.googleapis.com/golang/go$GOLANG_VERSION.linux-amd64.tar.gz -o /tmp/golang.tar.gz \\\n    && tar -zxf golang.tar.gz \\\n    && mv go /usr/local \\\n    && echo \"\\nGOROOT=/usr/local/go\\nexport GOROOT\\n\" >> /root/.profile \\\n\n# finish cleaning up\n    && rm -rf /tmp/.spam* \\\n    && rm -rf /tmp/* \\\n    && apt-get -yf autoremove \\\n    && apt-get clean && rm golang.tar.gz && rm -rf /var/lib/apt/lists/*;\n\nCOPY rootfs/. /\n\nRUN cd /tmp \\\n# tweaks\n    && chmod +x /etc/init.d/dovecot \\\n    && chmod +x /etc/service/sshd/run \\\n    && chmod +x /etc/init.d/mongod \\\n    && chmod +x /etc/my_init.d/!0_startup.sh \\\n    && mv /sysprepz/admin/bin/vesta-*.sh /bin \\\n\n# install iconcube loader extension\n    && /bin/vesta-ioncube-install.sh 7.3 \\\n    && /bin/vesta-ioncube-install.sh 7.1 \\\n    && /bin/vesta-ioncube-install.sh 7.2 \\\n\n# make sure we default fcgi and php to 7.2\n    && mv /usr/bin/php-cgi /usr/bin/php-cgi-old \\\n    && ln -s /usr/bin/php-cgi7.2 /usr/bin/php-cgi \\\n    && /usr/bin/switch-php.sh \"7.2\" \\\n    && curl -f -sS https://getcomposer.org/installer | php -- --install-dir=/usr/local/bin --filename=composer \\\n\n# remove phpmyadmin, phppgadmin\n    && rm -rf /usr/share/phpmyadmin/* && rm -rf /usr/share/phppgadmin/* \\\n\n# install adminer\n    && rm -rf /usr/share/adminer && mkdir -p /usr/share/adminer/public \\\n    && curl -f -SL https://www.adminer.org/latest.php --output /usr/share/adminer/public/index.php \\\n\n# overwrite (phpmyadmin, phppgadmin) with adminer\n    && mkdir -p /etc/nginx/conf-d \\\n    && rsync -a /etc/nginx/conf.d/* /etc/nginx/conf-d \\\n    && echo 'include /etc/nginx/conf.d/dbadmin.inc;' > /etc/nginx/conf.d/phpmyadmin.inc \\\n    && echo 'include /etc/nginx/conf.d/dbadmin.inc;' > /etc/nginx/conf.d/phppgadmin.inc \\\n\n# activate ini\n    && echo \"extension=v8js.so\" > /etc/php/7.1/mods-available/v8js.ini \\\n    && ln -sf /etc/php/7.1/mods-available/v8js.ini /etc/php/7.1/apache2/conf.d/20-v8js.ini \\\n    && ln -sf /etc/php/7.1/mods-available/v8js.ini /etc/php/7.1/cli/conf.d/20-v8js.ini \\\n    && ln -sf /etc/php/7.1/mods-available/v8js.ini /etc/php/7.1/cgi/conf.d/20-v8js.ini \\\n    && ln -sf /etc/php/7.1/mods-available/v8js.ini /etc/php/7.1/fpm/conf.d/20-v8js.ini \\\n\n    && echo \"extension=v8js.so\" > /etc/php/7.2/mods-available/v8js.ini \\\n    && ln -sf /etc/php/7.2/mods-available/v8js.ini /etc/php/7.2/apache2/conf.d/20-v8js.ini \\\n    && ln -sf /etc/php/7.2/mods-available/v8js.ini /etc/php/7.2/cli/conf.d/20-v8js.ini \\\n    && ln -sf /etc/php/7.2/mods-available/v8js.ini /etc/php/7.2/cgi/conf.d/20-v8js.ini \\\n    && ln -sf /etc/php/7.2/mods-available/v8js.ini /etc/php/7.2/fpm/conf.d/20-v8js.ini \\\n\n    && echo \"extension=pcs.so\" > /etc/php/7.1/mods-available/pcs.ini \\\n    && ln -sf /etc/php/7.1/mods-available/pcs.ini /etc/php/7.1/apache2/conf.d/15-pcs.ini \\\n    && ln -sf /etc/php/7.1/mods-available/pcs.ini /etc/php/7.1/cli/conf.d/15-pcs.ini \\\n    && ln -sf /etc/php/7.1/mods-available/pcs.ini /etc/php/7.1/cgi/conf.d/15-pcs.ini \\\n    && ln -sf /etc/php/7.1/mods-available/pcs.ini /etc/php/7.1/fpm/conf.d/15-pcs.ini \\\n\n    && echo \"extension=pcs.so\" > /etc/php/7.2/mods-available/pcs.ini \\\n    && ln -sf /etc/php/7.2/mods-available/pcs.ini /etc/php/7.2/apache2/conf.d/15-pcs.ini \\\n    && ln -sf /etc/php/7.2/mods-available/pcs.ini /etc/php/7.2/cli/conf.d/15-pcs.ini \\\n    && ln -sf /etc/php/7.2/mods-available/pcs.ini /etc/php/7.2/cgi/conf.d/15-pcs.ini \\\n    && ln -sf /etc/php/7.2/mods-available/pcs.ini /etc/php/7.2/fpm/conf.d/15-pcs.ini \\\n\n    && echo \"extension=pcs.so\" > /etc/php/7.3/mods-available/pcs.ini \\\n    && ln -sf /etc/php/7.3/mods-available/pcs.ini /etc/php/7.3/apache2/conf.d/15-pcs.ini \\\n    && ln -sf /etc/php/7.3/mods-available/pcs.ini /etc/php/7.3/cli/conf.d/15-pcs.ini \\\n    && ln -sf /etc/php/7.3/mods-available/pcs.ini /etc/php/7.3/cgi/conf.d/15-pcs.ini \\\n    && ln -sf /etc/php/7.3/mods-available/pcs.ini /etc/php/7.3/fpm/conf.d/15-pcs.ini \\\n\n    && echo \"extension=couchbase.so\" > /etc/php/7.1/mods-available/couchbase.ini \\\n    && ln -sf /etc/php/7.1/mods-available/couchbase.ini /etc/php/7.1/apache2/conf.d/30-couchbase.ini \\\n    && ln -sf /etc/php/7.1/mods-available/couchbase.ini /etc/php/7.1/cli/conf.d/30-couchbase.ini \\\n    && ln -sf /etc/php/7.1/mods-available/couchbase.ini /etc/php/7.1/cgi/conf.d/30-couchbase.ini \\\n    && ln -sf /etc/php/7.1/mods-available/couchbase.ini /etc/php/7.1/fpm/conf.d/30-couchbase.ini \\\n\n    && echo \"extension=couchbase.so\" > /etc/php/7.2/mods-available/couchbase.ini \\\n    && ln -sf /etc/php/7.2/mods-available/couchbase.ini /etc/php/7.2/apache2/conf.d/30-couchbase.ini \\\n    && ln -sf /etc/php/7.2/mods-available/couchbase.ini /etc/php/7.2/cli/conf.d/30-couchbase.ini \\\n    && ln -sf /etc/php/7.2/mods-available/couchbase.ini /etc/php/7.2/cgi/conf.d/30-couchbase.ini \\\n    && ln -sf /etc/php/7.2/mods-available/couchbase.ini /etc/php/7.2/fpm/conf.d/30-couchbase.ini \\\n\n    && echo \"extension=couchbase.so\" > /etc/php/7.3/mods-available/couchbase.ini \\\n    && ln -sf /etc/php/7.3/mods-available/couchbase.ini /etc/php/7.3/apache2/conf.d/30-couchbase.ini \\\n    && ln -sf /etc/php/7.3/mods-available/couchbase.ini /etc/php/7.3/cli/conf.d/30-couchbase.ini \\\n    && ln -sf /etc/php/7.3/mods-available/couchbase.ini /etc/php/7.3/cgi/conf.d/30-couchbase.ini \\\n    && ln -sf /etc/php/7.3/mods-available/couchbase.ini /etc/php/7.3/fpm/conf.d/30-couchbase.ini \\\n\n# performance tweaks\n    && chmod 0755 /etc/init.d/disable-transparent-hugepages \\\n\n# increase memcache max size from 64m to 256m\n    && sed -i -e \"s/^\\-m 64/\\-m 256/g\" /etc/memcached.conf \\\n\n# couchdb stuff\n    && mkdir -p /var/lib/couchdb \\\n    && chown -R couchdb:couchdb /usr/bin/couchdb /etc/couchdb /usr/share/couchdb /var/lib/couchdb \\\n    && chmod -R 0770 /usr/bin/couchdb /etc/couchdb /usr/share/couchdb /var/lib/couchdb \\\n\n# secure ssh\n    && sed -i -e \"s/PermitRootLogin prohibit-password/PermitRootLogin no/g\" /etc/ssh/sshd_config \\\n    && sed -i -e \"s/^#PermitRootLogin yes/PermitRootLogin no/g\" /etc/ssh/sshd_config \\\n\n# initialize ips for docker support\n    && cd /usr/local/vesta/data/ips && mv * 127.0.0.1 \\\n    && cd /etc/apache2/conf.d \\\n    && sed -i -e \"s/172.*.*.*:80/127.0.0.1:80/g\" * \\\n    && sed -i -e \"s/172.*.*.*:8443/127.0.0.1:8443/g\" * \\\n    && cd /etc/nginx/conf.d \\\n    && sed -i -e \"s/172.*.*.*:80/127.0.0.1:80/g\" * \\\n    && sed -i -e \"s/172.*.*.*:8080/127.0.0.1:8080/g\" * \\\n    && mv 172.*.*.*.conf 127.0.0.1.conf \\\n    && cd /home/admin/conf/web \\\n    && sed -i -e \"s/172.*.*.*:80;/80;/g\" * \\\n    && sed -i -e \"s/172.*.*.*:8080/127.0.0.1:8080/g\" * \\\n\n    && cd /tmp \\\n\n# postgres patch for this docker\n    && sed -i -e \"s/%q%u@%d '/%q%u@%d %r '/g\" /etc/postgresql/9.6/main/postgresql.conf \\\n    && sed -i -e \"s/^#listen_addresses = 'localhost'/listen_addresses = '*'/g\" /etc/postgresql/9.6/main/postgresql.conf \\\n\n# php stuff - after vesta because of vesta-php installs\n    && sed -i \"s/upload_max_filesize = 2M/upload_max_filesize = 600M/\" /etc/php/7.1/apache2/php.ini \\\n    && sed -i \"s/upload_max_filesize = 2M/upload_max_filesize = 600M/\" /etc/php/7.1/cli/php.ini \\\n    && sed -i \"s/upload_max_filesize = 2M/upload_max_filesize = 600M/\" /etc/php/7.1/cgi/php.ini \\\n    && sed -i \"s/upload_max_filesize = 2M/upload_max_filesize = 600M/\" /etc/php/7.1/fpm/php.ini \\\n\n    && sed -i \"s/upload_max_filesize = 2M/upload_max_filesize = 600M/\" /etc/php/7.2/apache2/php.ini \\\n    && sed -i \"s/upload_max_filesize = 2M/upload_max_filesize = 600M/\" /etc/php/7.2/cli/php.ini \\\n    && sed -i \"s/upload_max_filesize = 2M/upload_max_filesize = 600M/\" /etc/php/7.2/cgi/php.ini \\\n    && sed -i \"s/upload_max_filesize = 2M/upload_max_filesize = 600M/\" /etc/php/7.2/fpm/php.ini \\\n\n    && sed -i \"s/upload_max_filesize = 2M/upload_max_filesize = 600M/\" /etc/php/7.3/apache2/php.ini \\\n    && sed -i \"s/upload_max_filesize = 2M/upload_max_filesize = 600M/\" /etc/php/7.3/cli/php.ini \\\n    && sed -i \"s/upload_max_filesize = 2M/upload_max_filesize = 600M/\" /etc/php/7.3/cgi/php.ini \\\n    && sed -i \"s/upload_max_filesize = 2M/upload_max_filesize = 600M/\" /etc/php/7.3/fpm/php.ini \\\n\n    && sed -i \"s/post_max_size = 8M/post_max_size = 600M/\" /etc/php/7.1/apache2/php.ini \\\n    && sed -i \"s/post_max_size = 8M/post_max_size = 600M/\" /etc/php/7.1/cli/php.ini \\\n    && sed -i \"s/post_max_size = 8M/post_max_size = 600M/\" /etc/php/7.1/cgi/php.ini \\\n    && sed -i \"s/post_max_size = 8M/post_max_size = 600M/\" /etc/php/7.1/fpm/php.ini \\\n\n    && sed -i \"s/post_max_size = 8M/post_max_size = 600M/\" /etc/php/7.2/apache2/php.ini \\\n    && sed -i \"s/post_max_size = 8M/post_max_size = 600M/\" /etc/php/7.2/cli/php.ini \\\n    && sed -i \"s/post_max_size = 8M/post_max_size = 600M/\" /etc/php/7.2/cgi/php.ini \\\n    && sed -i \"s/post_max_size = 8M/post_max_size = 600M/\" /etc/php/7.2/fpm/php.ini \\\n\n    && sed -i \"s/post_max_size = 8M/post_max_size = 600M/\" /etc/php/7.3/apache2/php.ini \\\n    && sed -i \"s/post_max_size = 8M/post_max_size = 600M/\" /etc/php/7.3/cli/php.ini \\\n    && sed -i \"s/post_max_size = 8M/post_max_size = 600M/\" /etc/php/7.3/cgi/php.ini \\\n    && sed -i \"s/post_max_size = 8M/post_max_size = 600M/\" /etc/php/7.3/fpm/php.ini \\\n\n    && sed -i \"s/max_input_time = 60/max_input_time = 3600/\" /etc/php/7.1/apache2/php.ini \\\n    && sed -i \"s/max_input_time = 60/max_input_time = 3600/\" /etc/php/7.1/cli/php.ini \\\n    && sed -i \"s/max_input_time = 60/max_input_time = 3600/\" /etc/php/7.1/cgi/php.ini \\\n    && sed -i \"s/max_input_time = 60/max_input_time = 3600/\" /etc/php/7.1/fpm/php.ini \\\n\n    && sed -i \"s/max_input_time = 60/max_input_time = 3600/\" /etc/php/7.2/apache2/php.ini \\\n    && sed -i \"s/max_input_time = 60/max_input_time = 3600/\" /etc/php/7.2/cli/php.ini \\\n    && sed -i \"s/max_input_time = 60/max_input_time = 3600/\" /etc/php/7.2/cgi/php.ini \\\n    && sed -i \"s/max_input_time = 60/max_input_time = 3600/\" /etc/php/7.2/fpm/php.ini \\\n\n    && sed -i \"s/max_input_time = 60/max_input_time = 3600/\" /etc/php/7.3/apache2/php.ini \\\n    && sed -i \"s/max_input_time = 60/max_input_time = 3600/\" /etc/php/7.3/cli/php.ini \\\n    && sed -i \"s/max_input_time = 60/max_input_time = 3600/\" /etc/php/7.3/cgi/php.ini \\\n    && sed -i \"s/max_input_time = 60/max_input_time = 3600/\" /etc/php/7.3/fpm/php.ini \\\n\n    && sed -i \"s/max_execution_time = 30/max_execution_time = 300/\" /etc/php/7.1/apache2/php.ini \\\n    && sed -i \"s/max_execution_time = 30/max_execution_time = 300/\" /etc/php/7.1/cli/php.ini \\\n    && sed -i \"s/max_execution_time = 30/max_execution_time = 300/\" /etc/php/7.1/cgi/php.ini \\\n    && sed -i \"s/max_execution_time = 30/max_execution_time = 300/\" /etc/php/7.1/fpm/php.ini \\\n\n    && sed -i \"s/max_execution_time = 30/max_execution_time = 300/\" /etc/php/7.2/apache2/php.ini \\\n    && sed -i \"s/max_execution_time = 30/max_execution_time = 300/\" /etc/php/7.2/cli/php.ini \\\n    && sed -i \"s/max_execution_time = 30/max_execution_time = 300/\" /etc/php/7.2/cgi/php.ini \\\n    && sed -i \"s/max_execution_time = 30/max_execution_time = 300/\" /etc/php/7.2/fpm/php.ini \\\n\n    && sed -i \"s/max_execution_time = 30/max_execution_time = 300/\" /etc/php/7.3/apache2/php.ini \\\n    && sed -i \"s/max_execution_time = 30/max_execution_time = 300/\" /etc/php/7.3/cli/php.ini \\\n    && sed -i \"s/max_execution_time = 30/max_execution_time = 300/\" /etc/php/7.3/cgi/php.ini \\\n    && sed -i \"s/max_execution_time = 30/max_execution_time = 300/\" /etc/php/7.3/fpm/php.ini \\\n\n    && sed -i -e \"s/;sendmail_path =/sendmail_path = \\/usr\\/sbin\\/exim \\-t/g\" /etc/php/7.1/apache2/php.ini \\\n    && sed -i -e \"s/;sendmail_path =/sendmail_path = \\/usr\\/sbin\\/exim \\-t/g\" /etc/php/7.1/cli/php.ini \\\n    && sed -i -e \"s/;sendmail_path =/sendmail_path = \\/usr\\/sbin\\/exim \\-t/g\" /etc/php/7.1/cgi/php.ini \\\n    && sed -i -e \"s/;sendmail_path =/sendmail_path = \\/usr\\/sbin\\/exim \\-t/g\" /etc/php/7.1/fpm/php.ini \\\n\n    && sed -i -e \"s/;sendmail_path =/sendmail_path = \\/usr\\/sbin\\/exim \\-t/g\" /etc/php/7.2/apache2/php.ini \\\n    && sed -i -e \"s/;sendmail_path =/sendmail_path = \\/usr\\/sbin\\/exim \\-t/g\" /etc/php/7.2/cli/php.ini \\\n    && sed -i -e \"s/;sendmail_path =/sendmail_path = \\/usr\\/sbin\\/exim \\-t/g\" /etc/php/7.2/cgi/php.ini \\\n    && sed -i -e \"s/;sendmail_path =/sendmail_path = \\/usr\\/sbin\\/exim \\-t/g\" /etc/php/7.2/fpm/php.ini \\\n\n    && sed -i -e \"s/;sendmail_path =/sendmail_path = \\/usr\\/sbin\\/exim \\-t/g\" /etc/php/7.3/apache2/php.ini \\\n    && sed -i -e \"s/;sendmail_path =/sendmail_path = \\/usr\\/sbin\\/exim \\-t/g\" /etc/php/7.3/cli/php.ini \\\n    && sed -i -e \"s/;sendmail_path =/sendmail_path = \\/usr\\/sbin\\/exim \\-t/g\" /etc/php/7.3/cgi/php.ini \\\n    && sed -i -e \"s/;sendmail_path =/sendmail_path = \\/usr\\/sbin\\/exim \\-t/g\" /etc/php/7.3/fpm/php.ini \\\n\n# set same upload limit for php fcgi\n    && sed -i \"s/FcgidConnectTimeout 20/FcgidMaxRequestLen 629145600\\n  FcgidConnectTimeout 20/\" /etc/apache2/mods-available/fcgid.conf \\\n\n# sed for docker single IP\n    && sed -i -e \"s/\\%ip\\%\\:\\%proxy\\_port\\%/\\%proxy\\_port\\%/g\" /usr/local/vesta/data/templates/web/nginx/*.tpl \\\n    && sed -i -e \"s/\\%ip\\%\\:\\%proxy\\_ssl\\_port\\%/\\%proxy\\_ssl\\_port\\%/g\" /usr/local/vesta/data/templates/web/nginx/*.stpl \\\n# sed to include additional conf\n    && sed -i -e \"s/ include \\%home\\%\\/\\%user\\%\\/conf\\/web\\/nginx\\.\\%domain\\%/ include \\%home\\%\\/\\%user\\%\\/web\\/\\%domain\\%\\/private\\/*.conf;\\n    include \\%home\\%\\/\\%user\\%\\/conf\\/web\\/nginx\\.\\%domain\\%/g\" /usr/local/vesta/data/templates/web/nginx/*.tpl \\\n    && sed -i -e \"s/ include \\%home\\%\\/\\%user\\%\\/conf\\/web\\/snginx\\.\\%domain\\%/ include \\%home\\%\\/\\%user\\%\\/web\\/\\%domain\\%\\/private\\/*.conf;\\n    include \\%home\\%\\/\\%user\\%\\/conf\\/web\\/snginx\\.\\%domain\\%/g\" /usr/local/vesta/data/templates/web/nginx/*.stpl \\\n# patch for logging remote ip\n    && bash /usr/local/vesta/upd/switch_rpath.sh \\\n\n# add multiple php fcgi and custom templates\n    && rsync -a /sysprepz/apache2-templates/* /usr/local/vesta/data/templates/web/apache2/ \\\n    && rsync -a /sysprepz/nginx-templates/* /usr/local/vesta/data/templates/web/nginx/ \\\n\n# docker specific patching\n    && sed -i -e \"s/^if (\\$dir_name/\\/\\/if (\\$dir_name/g\" /usr/local/vesta/web/list/rrd/image.php \\\n\n# increase open file limit for nginx and apache\n    && echo \"\\n\\n* soft nofile 800000\\n* hard nofile 800000\\n\\n\" >> /etc/security/limits.conf \\\n\n# patch psql9.5+ backup\n    && sed -i -e \"s/\\-c \\-\\-inserts \\-O \\-x \\-i \\-f/\\-\\-inserts \\-x \\-f/g\" /usr/local/vesta/func/db.sh \\\n    && sed -i -e \"s/\\-c \\-\\-inserts \\-O \\-x \\-f/\\-\\-inserts \\-x \\-f/g\" /usr/local/vesta/func/db.sh \\\n    && sed -i -e \"s/dbuser/DBUSER/g\" /usr/local/vesta/func/rebuild.sh \\\n    && sed -i -e \"s/ROLE \\$DBUSER/ROLE \\$DBUSER WITH LOGIN/g\" /usr/local/vesta/func/rebuild.sh \\\n    && sed -i -e \"s/plsql/psql/g\" /usr/local/vesta/bin/v-update-sys-rrd-pgsql \\\n\n# apache stuff\n    && echo \"\\nServerName localhost\\n\" >> /etc/apache2/apache2.conf \\\n    && a2enmod headers && a2dismod php7.3 && a2enmod php7.2 \\\n\n# download new auto host ssl\n    && curl -f -SL https://raw.githubusercontent.com/serghey-rodin/vesta/master/bin/v-update-host-certificate --output /usr/local/vesta/bin/v-update-host-certificate \\\n    && chmod +x /usr/local/vesta/bin/v-update-host-certificate \\\n\n# disable localhost redirect to bad default IP\n    && sed -i -e \"s/^NAT=.*/NAT=\\'\\'/g\" /usr/local/vesta/data/ips/* \\\n    && service mysql stop && systemctl disable mysql \\\n    && service postgresql stop && systemctl disable postgresql \\\n    && service redis-server stop && systemctl disable redis-server \\\n    && service fail2ban stop && systemctl disable fail2ban \\\n    && service nginx stop && systemctl disable nginx \\\n    && service apache2 stop && systemctl disable apache2 \\\n    && sed -i -e \"s/\\/var\\/lib\\/mysql/\\/vesta\\/var\\/lib\\/mysql/g\" /etc/mysql/my.cnf \\\n\n# for letsencrypt\n    && touch /usr/local/vesta/data/queue/letsencrypt.pipe \\\n\n# setup redis like memcache\n    && sed -i -e 's:^save:# save:g' \\\n      -e 's:^bind:# bind:g' \\\n      -e 's:^logfile:# logfile:' \\\n      -e 's:# maxmemory \\(.*\\)$:maxmemory 256mb:' \\\n      -e 's:# maxmemory-policy \\(.*\\)$:maxmemory-policy allkeys-lru:' \\\n      /etc/redis/redis.conf \\\n    && sed -i -e \"s/\\/etc\\/redis/\\/vesta\\/etc\\/redis/g\" /etc/init.d/redis-server \\\n\n# disable php*admin and roundcube by default, backup the config first - see README.md   \n    && mkdir -p /etc/apache2/conf-d \\\n    && rsync -a /etc/apache2/conf.d/* /etc/apache2/conf-d \\\n    && rm -f /etc/apache2/conf.d/php*.conf \\\n    && rm -f /etc/apache2/conf.d/roundcube.conf \\\n\n# begin folder redirections\n    && mkdir -p /vesta-start/etc \\\n    && mkdir -p /vesta-start/var/lib \\\n    && mkdir -p /vesta-start/local \\\n\n    && mv /etc/apache2 /vesta-start/etc/apache2 \\\n    && rm -rf /etc/apache2 \\\n    && ln -s /vesta/etc/apache2 /etc/apache2 \\\n\n    && mv /etc/ssh /vesta-start/etc/ssh \\\n    && rm -rf /etc/ssh \\\n    && ln -s /vesta/etc/ssh /etc/ssh \\\n\n    && mv /etc/fail2ban /vesta-start/etc/fail2ban \\\n    && rm -rf /etc/fail2ban \\\n    && ln -s /vesta/etc/fail2ban /etc/fail2ban \\\n\n    && mv /etc/php /vesta-start/etc/php \\\n    && rm -rf /etc/php \\\n    && ln -s /vesta/etc/php /etc/php \\\n\n    && mv /etc/nginx   /vesta-start/etc/nginx \\\n    && rm -rf /etc/nginx \\\n    && ln -s /vesta/etc/nginx /etc/nginx \\\n\n    && mv /etc/exim4   /vesta-start/etc/exim4 \\\n    && rm -rf /etc/exim4 \\\n    && ln -s /vesta/etc/exim4 /etc/exim4 \\\n\n    && mv /etc/spamassassin   /vesta-start/etc/spamassassin \\\n    && rm -rf /etc/spamassassin \\\n    && ln -s /vesta/etc/spamassassin /etc/spamassassin \\\n\n    && mv /etc/mail   /vesta-start/etc/mail \\\n    && rm -rf /etc/mail \\\n    && ln -s /vesta/etc/mail /etc/mail \\\n\n    && mv /etc/redis   /vesta-start/etc/redis \\\n    && rm -rf /etc/redis \\\n    && ln -s /vesta/etc/redis /etc/redis \\\n\n    && mkdir -p /var/lib/mongodb \\\n    && chown -R mongodb:mongodb /var/lib/mongodb \\\n    && mv /var/lib/mongodb /vesta-start/var/lib/mongodb \\\n    && rm -rf /var/lib/mongodb \\\n    && ln -s /vesta/var/lib/mongodb /var/lib/mongodb \\\n\n    && mkdir -p /var/lib/redis \\\n    && chown -R redis:redis /var/lib/redis \\\n    && mv /var/lib/redis /vesta-start/var/lib/redis \\\n    && rm -rf /var/lib/redis \\\n    && ln -s /vesta/var/lib/redis /var/lib/redis \\\n\n    && mv /etc/awstats /vesta-start/etc/awstats \\\n    && rm -rf /etc/awstats \\\n    && ln -s /vesta/etc/awstats /etc/awstats \\\n\n    && mv /etc/dovecot /vesta-start/etc/dovecot \\\n    && rm -rf /etc/dovecot \\\n    && ln -s /vesta/etc/dovecot /etc/dovecot \\\n\n    && mv /etc/openvpn /vesta-start/etc/openvpn \\\n    && rm -rf /etc/openvpn \\\n    && ln -s /vesta/etc/openvpn /etc/openvpn \\\n\n    && mv /etc/mysql   /vesta-start/etc/mysql \\\n    && rm -rf /etc/mysql \\\n    && ln -s /vesta/etc/mysql /etc/mysql \\\n\n    && mv /var/lib/mysql /vesta-start/var/lib/mysql \\\n    && rm -rf /var/lib/mysql \\\n    && ln -s /vesta/var/lib/mysql /var/lib/mysql \\\n\n    && mv /etc/postgresql   /vesta-start/etc/postgresql \\\n    && rm -rf /etc/postgresql \\\n    && ln -s /vesta/etc/postgresql /etc/postgresql \\\n\n    && mv /var/lib/postgresql /vesta-start/var/lib/postgresql \\\n    && rm -rf /var/lib/postgresql \\\n    && ln -s /vesta/var/lib/postgresql /var/lib/postgresql \\\n\n    && mv /root /vesta-start/root \\\n    && rm -rf /root \\\n    && ln -s /vesta/root /root \\\n\n    && mv /usr/local/vesta /vesta-start/local/vesta \\\n    && rm -rf /usr/local/vesta \\\n    && ln -s /vesta/local/vesta /usr/local/vesta \\\n\n    && mv /etc/memcached.conf /vesta-start/etc/memcached.conf \\\n    && rm -rf /etc/memcached.conf \\\n    && ln -s /vesta/etc/memcached.conf /etc/memcached.conf \\\n\n    && mv /etc/timezone /vesta-start/etc/timezone \\\n    && rm -rf /etc/timezone \\\n    && ln -s /vesta/etc/timezone /etc/timezone \\\n\n    && mv /etc/bind /vesta-start/etc/bind \\\n    && rm -rf /etc/bind \\\n    && ln -s /vesta/etc/bind /etc/bind \\\n\n    && mv /etc/profile /vesta-start/etc/profile \\\n    && rm -rf /etc/profile \\\n    && ln -s /vesta/etc/profile /etc/profile \\\n\n    && mv /var/log /vesta-start/var/log \\\n    && rm -rf /var/log \\\n    && ln -s /vesta/var/log /var/log \\\n\n    && mv /etc/mongod.conf /vesta-start/etc/mongod.conf \\\n    && rm -rf /etc/mongod.conf \\\n    && ln -s /vesta/etc/mongod.conf /etc/mongod.conf \\\n\n    && mv /etc/couchdb /vesta-start/etc/couchdb \\\n    && rm -rf /etc/couchdb \\\n    && ln -s /vesta/etc/couchdb /etc/couchdb \\\n\n    && mv /var/lib/couchdb /vesta-start/var/lib/couchdb \\\n    && rm -rf /var/lib/couchdb \\\n    && ln -s /vesta/var/lib/couchdb /var/lib/couchdb \\\n\n    && mkdir -p /sysprepz/home \\\n    && rsync -a /home/* /sysprepz/home \\\n    && mv /sysprepz/admin/bin /sysprepz/home/admin \\\n    && chown -R admin:admin /sysprepz/home/admin/bin \\\n\n    && mkdir -p /vesta-start/local/vesta/data/sessions \\\n    && chmod 775 /vesta-start/local/vesta/data/sessions \\\n    && chown root:admin /vesta-start/local/vesta/data/sessions \\\n\n# fix roundcube error log permission\n    && touch /vesta-start/var/log/roundcube/errors \\\n    && chown -R www-data:www-data /vesta-start/var/log/roundcube \\\n    && chmod 775 /vesta-start/var/log/roundcube/errors \\\n\n# pagespeed stuff\n    && mkdir -p /var/ngx_pagespeed_cache \\\n    && chmod 755 /var/ngx_pagespeed_cache \\\n    && chown www-data:www-data /var/ngx_pagespeed_cache \\\n\n# finish cleaning up\n    && rm -rf /backup/.etc \\\n    && rm -rf /tmp/* \\\n    && apt-get -yf autoremove \\\n    && apt-get clean\n\nVOLUME [\"/vesta\", \"/home\", \"/backup\"]\n\nEXPOSE 22 25 53 54 80 110 143 443 465 587 993 995 1194 3000 3306 5432 5984 6379 8083 10022 11211 27017\n"
}