{
  "startTime": 1674252599977,
  "endTime": 1674252600949,
  "originalSmells": [
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 23,
        "lineEnd": 23,
        "columnStart": 4,
        "columnEnd": 67
      }
    },
    {
      "rule": "wgetUseHttpsUrl",
      "position": {
        "lineStart": 46,
        "lineEnd": 46,
        "columnStart": 4,
        "columnEnd": 74
      }
    },
    {
      "rule": "wgetUseHttpsUrl",
      "position": {
        "lineStart": 98,
        "lineEnd": 98,
        "columnStart": 4,
        "columnEnd": 75
      }
    },
    {
      "rule": "wgetUseHttpsUrl",
      "position": {
        "lineStart": 120,
        "lineEnd": 120,
        "columnStart": 4,
        "columnEnd": 92
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 10,
        "lineEnd": 10,
        "columnStart": 4,
        "columnEnd": 29
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 11,
        "lineEnd": 11,
        "columnStart": 4,
        "columnEnd": 37
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 12,
        "lineEnd": 12,
        "columnStart": 4,
        "columnEnd": 30
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 71,
        "lineEnd": 71,
        "columnStart": 4,
        "columnEnd": 116
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 72,
        "lineEnd": 72,
        "columnStart": 4,
        "columnEnd": 32
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 107,
        "lineEnd": 107,
        "columnStart": 4,
        "columnEnd": 21
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 108,
        "lineEnd": 108,
        "columnStart": 4,
        "columnEnd": 59
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 110,
        "lineEnd": 110,
        "columnStart": 4,
        "columnEnd": 23
      }
    },
    {
      "rule": "configureShouldUseBuildFlag",
      "position": {
        "lineStart": 40,
        "lineEnd": 40,
        "columnStart": 4,
        "columnEnd": 30
      }
    },
    {
      "rule": "configureShouldUseBuildFlag",
      "position": {
        "lineStart": 101,
        "lineEnd": 101,
        "columnStart": 4,
        "columnEnd": 35
      }
    },
    {
      "rule": "tarSomethingRmTheSomething",
      "position": {
        "lineStart": 38,
        "lineEnd": 38,
        "columnStart": 4,
        "columnEnd": 33
      }
    },
    {
      "rule": "tarSomethingRmTheSomething",
      "position": {
        "lineStart": 47,
        "lineEnd": 47,
        "columnStart": 4,
        "columnEnd": 37
      }
    },
    {
      "rule": "tarSomethingRmTheSomething",
      "position": {
        "lineStart": 99,
        "lineEnd": 99,
        "columnStart": 24,
        "columnEnd": 94
      }
    },
    {
      "rule": "aptGetInstallUseY",
      "position": {
        "lineStart": 118,
        "lineEnd": 118,
        "columnStart": 4,
        "columnEnd": 31
      }
    },
    {
      "rule": "aptGetInstallUseY",
      "position": {
        "lineStart": 132,
        "lineEnd": 132,
        "columnStart": 4,
        "columnEnd": 20
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 8,
        "lineEnd": 8,
        "columnStart": 22,
        "columnEnd": 202
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 14,
        "lineEnd": 14,
        "columnStart": 4,
        "columnEnd": 49
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 16,
        "lineEnd": 16,
        "columnStart": 22,
        "columnEnd": 50
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 36,
        "lineEnd": 36,
        "columnStart": 4,
        "columnEnd": 48
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 70,
        "lineEnd": 70,
        "columnStart": 4,
        "columnEnd": 34
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 74,
        "lineEnd": 74,
        "columnStart": 22,
        "columnEnd": 699
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 76,
        "lineEnd": 76,
        "columnStart": 4,
        "columnEnd": 29
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 78,
        "lineEnd": 78,
        "columnStart": 4,
        "columnEnd": 35
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 118,
        "lineEnd": 118,
        "columnStart": 4,
        "columnEnd": 31
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 123,
        "lineEnd": 123,
        "columnStart": 22,
        "columnEnd": 52
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 132,
        "lineEnd": 132,
        "columnStart": 4,
        "columnEnd": 20
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 135,
        "lineEnd": 135,
        "columnStart": 4,
        "columnEnd": 34
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 136,
        "lineEnd": 136,
        "columnStart": 4,
        "columnEnd": 29
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 14,
        "lineEnd": 14,
        "columnStart": 4,
        "columnEnd": 49
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 36,
        "lineEnd": 36,
        "columnStart": 4,
        "columnEnd": 48
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 70,
        "lineEnd": 70,
        "columnStart": 4,
        "columnEnd": 34
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 76,
        "lineEnd": 76,
        "columnStart": 4,
        "columnEnd": 29
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 78,
        "lineEnd": 78,
        "columnStart": 4,
        "columnEnd": 35
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 118,
        "lineEnd": 118,
        "columnStart": 4,
        "columnEnd": 31
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 132,
        "lineEnd": 132,
        "columnStart": 4,
        "columnEnd": 20
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 135,
        "lineEnd": 135,
        "columnStart": 4,
        "columnEnd": 34
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 136,
        "lineEnd": 136,
        "columnStart": 4,
        "columnEnd": 29
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 8,
        "lineEnd": 8,
        "columnStart": 22,
        "columnEnd": 202
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 14,
        "lineEnd": 14,
        "columnStart": 4,
        "columnEnd": 49
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 16,
        "lineEnd": 16,
        "columnStart": 22,
        "columnEnd": 50
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 36,
        "lineEnd": 36,
        "columnStart": 4,
        "columnEnd": 48
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 70,
        "lineEnd": 70,
        "columnStart": 4,
        "columnEnd": 34
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 74,
        "lineEnd": 74,
        "columnStart": 22,
        "columnEnd": 699
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 76,
        "lineEnd": 76,
        "columnStart": 4,
        "columnEnd": 29
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 78,
        "lineEnd": 78,
        "columnStart": 4,
        "columnEnd": 35
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 118,
        "lineEnd": 118,
        "columnStart": 4,
        "columnEnd": 31
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 123,
        "lineEnd": 123,
        "columnStart": 22,
        "columnEnd": 52
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 132,
        "lineEnd": 132,
        "columnStart": 4,
        "columnEnd": 20
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 135,
        "lineEnd": 135,
        "columnStart": 4,
        "columnEnd": 34
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 136,
        "lineEnd": 136,
        "columnStart": 4,
        "columnEnd": 29
      }
    }
  ],
  "repairedSmells": [
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 14,
        "lineEnd": 14,
        "columnStart": 4,
        "columnEnd": 73
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 36,
        "lineEnd": 36,
        "columnStart": 4,
        "columnEnd": 72
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 70,
        "lineEnd": 70,
        "columnStart": 4,
        "columnEnd": 58
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 76,
        "lineEnd": 76,
        "columnStart": 4,
        "columnEnd": 53
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 78,
        "lineEnd": 78,
        "columnStart": 4,
        "columnEnd": 59
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 118,
        "lineEnd": 118,
        "columnStart": 4,
        "columnEnd": 58
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 132,
        "lineEnd": 132,
        "columnStart": 4,
        "columnEnd": 47
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 135,
        "lineEnd": 135,
        "columnStart": 4,
        "columnEnd": 58
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 136,
        "lineEnd": 136,
        "columnStart": 4,
        "columnEnd": 53
      }
    }
  ],
  "repairedDockerfile": "# Set the base image\nFROM ubuntu:16.04\nENV DEBIAN_FRONTEND noninteractive\n\n# File Author / Maintainer\nMAINTAINER IDseq Team idseq-tech@chanzuckerberg.com\n\n# Add packages, update image, and clear cache\nRUN apt-get update && apt-get install --no-install-recommends -y build-essential curl wget python-pip python-dev python-scipy python-redis gdebi-core zip unzip g++ zlib1g-dev gcc pkg-config apt-utils make perl cmake libbz2-dev && rm -rf /var/lib/apt/lists/*;\n\nRUN pip install --no-cache-dir --upgrade pip\nRUN pip install --no-cache-dir redis biopython pysam\nRUN pip install --no-cache-dir htseq==0.6.1p1\n\nRUN apt-get install --no-install-recommends -y software-properties-common && rm -rf /var/lib/apt/lists/*;\nRUN add-apt-repository ppa:deadsnakes/ppa\nRUN apt-get update && apt-get install --no-install-recommends -y python3.7 && rm -rf /var/lib/apt/lists/*;\n\nRUN update-alternatives --install /usr/bin/python3 python3 /usr/bin/python3.5 1\nRUN update-alternatives --install /usr/bin/python3 python3 /usr/bin/python3.7 2\n\nWORKDIR /tmp\n# install STAR\nRUN curl -f -L https://github.com/alexdobin/STAR/archive/2.5.3a.tar.gz | tar xz\nRUN mv STAR-2.5.3a/bin/Linux_x86_64_static/* /usr/local/bin\nRUN rm -rf STAR-2.5.3a\n\n# Compile and install bowtie\nRUN wget https://sourceforge.net/projects/bowtie-bio/files/bowtie2/2.3.2/bowtie2-2.3.2-source.zip\nRUN unzip bowtie2-2.3.2-source.zip\nWORKDIR /tmp/bowtie2-2.3.2\nRUN make -j 16 NO_TBB=1 # we may want tbb (for \"superior thread scaling\") later, so will need to find a way to compile without \"NO_TBB=1\"\nRUN mv -t /usr/local/bin/ bowtie2 bowtie2-align-l bowtie2-align-s bowtie2-build bowtie2-build-l bowtie2-build-s bowtie2-inspect bowtie2-inspect-l bowtie2-inspect-s\n\nWORKDIR /tmp\n# install samtools\nRUN apt-get install --no-install-recommends -y libncurses-dev libbz2-dev && rm -rf /var/lib/apt/lists/*;\nRUN wget https://github.com/samtools/samtools/releases/download/1.5/samtools-1.5.tar.bz2\nRUN tar -jxf samtools-1.5.tar.bz2 && rm samtools-1.5.tar.bz2\nWORKDIR /tmp/samtools-1.5\nRUN ./configure --build=\"$(dpkg-architecture --query DEB_BUILD_GNU_TYPE)\" --disable-lzma\nRUN make -j 16\nRUN mv samtools /usr/local/bin/\n\nWORKDIR /tmp\n# Compile and install PriceSeqFilter\nRUN wget https://derisilab.ucsf.edu/software/price/PriceSource140408.tar.gz\nRUN tar -xzf PriceSource140408.tar.gz && rm PriceSource140408.tar.gz\nWORKDIR /tmp/PriceSource140408\nRUN make -j 16\nRUN mv PriceSeqFilter /usr/local/bin/\n\nWORKDIR /tmp\n# Compile and install cdhit-dup tools\nRUN wget https://github.com/weizhongli/cdhit/archive/V4.6.8.zip\nRUN unzip V4.6.8.zip\nWORKDIR /tmp/cdhit-4.6.8\nRUN make -j 16\nWORKDIR /tmp/cdhit-4.6.8/cd-hit-auxtools\nRUN make -j 16\nRUN mv cd-hit-dup /usr/local/bin/\n\nWORKDIR /tmp\n# Compile and install Fastax tools\n#RUN wget http://launchpadlibrarian.net/161878011/libgtextutils0_0.7-1_amd64.deb\n#RUN wget http://launchpadlibrarian.net/162265652/fastx-toolkit_0.0.14-1_amd64.deb\n#RUN gdebi --non-interactive libgtextutils0_0.7-1_amd64.deb\n#RUN gdebi --non-interactive fastx-toolkit_0.0.14-1_amd64.deb\n\n# For aegea\nRUN apt-get install --no-install-recommends -y python3-pip && rm -rf /var/lib/apt/lists/*;\nRUN pip3 install --no-cache-dir awscli-cwlogs==1.4.0 keymaker==0.2.1 boto3==1.4.3 awscli==1.11.44 dynamoq==0.0.5 tractorbeam==0.1.3\nRUN pip3 install --no-cache-dir pysam biopython\n#RUN echo iptables-persistent iptables-persistent/autosave_v4 boolean true | debconf-set-selections\nRUN apt-get update && apt-get install --no-install-recommends -y iptables-persistent debian-goodies bridge-utils pixz cryptsetup-bin mdadm btrfs-tools libffi-dev libssl-dev libxml2-dev libxslt1-dev libyaml-dev libcurl4-openssl-dev libjemalloc-dev libzip-dev libsnappy-dev liblz4-dev libgmp-dev libmpfr-dev libhts-dev libsqlite3-dev libncurses5-dev htop pydf jq httpie python-dev python-cffi python-pip python-setuptools python-wheel python-virtualenv python-requests python-yaml python3-dev python3-cffi python3-pip python3-setuptools python3-wheel python3-requests python3-yaml nfs-common unzip build-essential cmake libtool autoconf ruby sysstat dstat numactl gdebi-core sqlite3 stunnel moreutils curl wget git aria2 sift && rm -rf /var/lib/apt/lists/*;\n# Strange that we have to do this, but if we don't, aegea tries to do it, and it fails then with some urllib3 bug.\nRUN apt-get -y --no-install-recommends install awscli && rm -rf /var/lib/apt/lists/*;\n\nRUN apt-get install --no-install-recommends -y bsdtar alien && rm -rf /var/lib/apt/lists/*;\n\n# For de-novo assembly\nWORKDIR /tmp/spades_build\nRUN git clone https://github.com/ablab/spades.git\nWORKDIR /tmp/spades_build/spades\nRUN git checkout spades_3.11.0\nWORKDIR /tmp/spades_build/spades/assembler\nRUN PREFIX=/usr/local ./spades_compile.sh\nRUN /usr/local/bin/spades.py --test\n\n# For nonhost fastq filtering\nWORKDIR /tmp/seqtk_build\nRUN git clone https://github.com/lh3/seqtk.git\nWORKDIR /tmp/seqtk_build/seqtk\nRUN make && make install\n\nWORKDIR /tmp\n\n# Compile and install gmap/gsnap\nRUN wget https://research-pub.gene.com/gmap/src/gmap-gsnap-2017-11-15.tar.gz\nRUN mkdir gmap-gsnap && tar xf gmap-gsnap-2017-11-15.tar.gz -C gmap-gsnap --strip-components 1 && rm gmap-gsnap-2017-11-15.tar.gz\nWORKDIR /tmp/gmap-gsnap\nRUN ./configure --build=\"$(dpkg-architecture --query DEB_BUILD_GNU_TYPE)\" --prefix=/usr/local\nRUN make -j 16 && make check && make install\nRUN rm -rf /tmp/gmap-gsnap /tmp/gmap-gsnap-2017-11-15.tar.gz\nRUN gsnapl --version\n\n# For srst2, install forked srst2 python 3 compatible repo\nRUN pip install --no-cache-dir scipy\nRUN pip install --no-cache-dir git+https://github.com/chanzuckerberg/srst2\n# TODO: Test both pip installations, consider keeping pip use consistent\nRUN pip3 install --no-cache-dir pandas\n\n# Blast command line\nRUN wget -N ftp://ftp.ncbi.nlm.nih.gov/blast/executables/blast+/2.6.0/ncbi-blast-2.6.0+-1.x86_64.rpm\nRUN alien -i ncbi-blast-2.6.0+-1.x86_64.rpm\nRUN rm -rf ncbi-blast-2.6.0+-1.x86_64.rpm\n\n# For adapter trimming\nRUN apt install -y --no-install-recommends python-cutadapt && rm -rf /var/lib/apt/lists/*;\nWORKDIR /tmp\nRUN wget https://www.usadellab.org/cms/uploads/supplementary/Trimmomatic/Trimmomatic-0.38.zip\nRUN unzip Trimmomatic-0.38.zip\nRUN mv Trimmomatic-0.38/trimmomatic-0.38.jar /usr/local/bin/\nRUN apt-get update && apt-get install --no-install-recommends -y default-jre && rm -rf /var/lib/apt/lists/*;\n\n# For phylogenetic trees\nWORKDIR /tmp\nRUN wget https://sourceforge.net/projects/ksnp/files/kSNP3.1_Linux_package.zip\nRUN unzip -o kSNP3.1_Linux_package.zip\nWORKDIR /tmp/kSNP3.1_Linux_package/kSNP3\nRUN cp -r * /usr/local/bin/\nRUN sed -i 's:set kSNP=/usr/local/kSNP3:set kSNP=/usr/local/bin:g' /usr/local/bin/kSNP3 # edit the kSNP3 executable so it looks for other executables in /usr/local/bin\nRUN apt install -y --no-install-recommends tcsh && rm -rf /var/lib/apt/lists/*;\nRUN kSNP3\n\nRUN apt-get -y --no-install-recommends install liblz4-tool && rm -rf /var/lib/apt/lists/*;\nRUN apt-get -y --no-install-recommends install lbzip2 && rm -rf /var/lib/apt/lists/*;\n\n# Cleanup\nRUN rm -rf /tmp/*\n\nWORKDIR /\n"
}