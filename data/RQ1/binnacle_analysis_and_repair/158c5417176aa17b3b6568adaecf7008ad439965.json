{
  "startTime": 1674252850393,
  "endTime": 1674252850945,
  "originalSmells": [
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 93,
        "lineEnd": 93,
        "columnStart": 4,
        "columnEnd": 50
      }
    },
    {
      "rule": "npmCacheCleanAfterInstall",
      "position": {
        "lineStart": 95,
        "lineEnd": 95,
        "columnStart": 7,
        "columnEnd": 31
      }
    },
    {
      "rule": "npmCacheCleanAfterInstall",
      "position": {
        "lineStart": 96,
        "lineEnd": 96,
        "columnStart": 7,
        "columnEnd": 28
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 99,
        "lineEnd": 99,
        "columnStart": 4,
        "columnEnd": 39
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 100,
        "lineEnd": 100,
        "columnStart": 7,
        "columnEnd": 131
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 101,
        "lineEnd": 101,
        "columnStart": 7,
        "columnEnd": 24
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 102,
        "lineEnd": 102,
        "columnStart": 7,
        "columnEnd": 22
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 103,
        "lineEnd": 103,
        "columnStart": 7,
        "columnEnd": 24
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 104,
        "lineEnd": 104,
        "columnStart": 7,
        "columnEnd": 30
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 105,
        "lineEnd": 105,
        "columnStart": 7,
        "columnEnd": 76
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 106,
        "lineEnd": 106,
        "columnStart": 7,
        "columnEnd": 26
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 107,
        "lineEnd": 107,
        "columnStart": 7,
        "columnEnd": 28
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 108,
        "lineEnd": 108,
        "columnStart": 7,
        "columnEnd": 25
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 109,
        "lineEnd": 109,
        "columnStart": 7,
        "columnEnd": 23
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 110,
        "lineEnd": 110,
        "columnStart": 7,
        "columnEnd": 23
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 111,
        "lineEnd": 111,
        "columnStart": 7,
        "columnEnd": 34
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 112,
        "lineEnd": 112,
        "columnStart": 7,
        "columnEnd": 25
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 113,
        "lineEnd": 113,
        "columnStart": 7,
        "columnEnd": 26
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 114,
        "lineEnd": 114,
        "columnStart": 7,
        "columnEnd": 34
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 115,
        "lineEnd": 115,
        "columnStart": 7,
        "columnEnd": 25
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 116,
        "lineEnd": 116,
        "columnStart": 7,
        "columnEnd": 27
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 117,
        "lineEnd": 117,
        "columnStart": 7,
        "columnEnd": 28
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 118,
        "lineEnd": 118,
        "columnStart": 7,
        "columnEnd": 23
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 119,
        "lineEnd": 119,
        "columnStart": 7,
        "columnEnd": 31
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 120,
        "lineEnd": 120,
        "columnStart": 7,
        "columnEnd": 27
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 121,
        "lineEnd": 121,
        "columnStart": 7,
        "columnEnd": 24
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 122,
        "lineEnd": 122,
        "columnStart": 7,
        "columnEnd": 26
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 123,
        "lineEnd": 123,
        "columnStart": 7,
        "columnEnd": 42
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 124,
        "lineEnd": 124,
        "columnStart": 7,
        "columnEnd": 23
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 94,
        "lineEnd": 94,
        "columnStart": 7,
        "columnEnd": 32
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 94,
        "lineEnd": 94,
        "columnStart": 7,
        "columnEnd": 32
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 49,
        "lineEnd": 83,
        "columnStart": 7,
        "columnEnd": 12
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 94,
        "lineEnd": 94,
        "columnStart": 7,
        "columnEnd": 32
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 144,
        "lineEnd": 149,
        "columnStart": 7,
        "columnEnd": 39
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "# VERSION 1.10.2\n# AUTHOR: Maksim Pecherskiy\n# DESCRIPTION: Airflow container for running City of San Diego Airflow Instances.  Original work by Puckel_\n# BUILD: docker build --rm -t mrmaksimize/docker-airflow .\n# SOURCE: https://github.com/mrmaksimize/docker-airflow\n\nFROM python:3.6\nLABEL maintainer=\"mrmaksimize\"\n\n\n# Never prompts the user for choices on installation/configuration of packages\nENV DEBIAN_FRONTEND noninteractive\nENV TERM linux\n\n# Airflow\nARG AIRFLOW_VERSION=1.10.2\nARG AIRFLOW_HOME=/usr/local/airflow\nARG GDAL_VERSION=2.1.0\n\nENV AIRFLOW_GPL_UNIDECODE yes\n\n# Define en_US.\nENV LANGUAGE en_US.UTF-8\nENV LANG en_US.UTF-8\nENV LC_ALL en_US.UTF-8\nENV LC_CTYPE en_US.UTF-8\nENV LC_MESSAGES en_US.UTF-8\n\n# GDAL ENV\nENV GDAL_DATA /usr/share/gdal/2.1\nENV GDAL_VERSION $GDAL_VERSION\nENV CPLUS_INCLUDE_PATH=/usr/include/gdal\nENV C_INCLUDE_PATH=/usr/include/gdal\n\n\n# Oracle Essentials\nENV ORACLE_HOME /opt/oracle\nENV ARCH x86_64\nENV DYLD_LIBRARY_PATH /opt/oracle\nENV LD_LIBRARY_PATH /opt/oracle\n\n#R\nENV R_BASE_VERSION 3.5.3\n\n\n\n# Update apt and install\nRUN apt-get update -yqq \\\n    && apt-get upgrade -yqq \\\n    && apt-get install -yqq --no-install-recommends \\\n        apt-utils \\\n        build-essential \\\n        curl \\\n        freetds-bin \\\n        freetds-dev \\\n        git \\\n        gnupg2 \\\n        less \\\n        locales \\\n        libaio1 \\\n        libcurl4-gnutls-dev \\\n        libgdal-dev \\\n        libgeos-dev \\\n        libhdf4-alt-dev \\\n        libhdf5-serial-dev \\\n        libnetcdf-dev \\\n        libpoppler-dev \\\n        libproj-dev \\\n        libpq-dev \\\n        libspatialindex-dev \\\n        libspatialite-dev \\\n        libxml2-dev \\\n        netcat \\\n        pandoc \\\n        python3-software-properties \\\n        python3-dev \\\n        python3-numpy \\\n        rsync \\\n        software-properties-common \\\n        smbclient \\\n        sqlite3 \\\n        unzip \\\n        vim \\\n        wget && rm -rf /var/lib/apt/lists/*;\n\n# Update Locales, add Airflow User\nRUN sed -i 's/^# en_US.UTF-8 UTF-8$/en_US.UTF-8 UTF-8/g' /etc/locale.gen \\\n    && locale-gen \\\n    && update-locale LANG=en_US.UTF-8 LC_ALL=en_US.UTF-8 \\\n    && useradd -ms /bin/bash -d ${AIRFLOW_HOME} airflow\n\n\n# NodeJS packages\nRUN curl -f -sL https://deb.nodesource.com/setup_10.x | bash - \\\n    && apt-get install --no-install-recommends -y nodejs \\\n    && npm install -g mapshaper \\\n    && npm install -g geobuf && npm cache clean --force; && rm -rf /var/lib/apt/lists/*;\n\n\nRUN pip install --no-cache-dir -U pip setuptools wheel \\\n    && pip install --no-cache-dir apache-airflow[crypto,celery,postgres,slack,s3,jdbc,mysql,mssql,ssh,password,rabbitmq,samba]==${AIRFLOW_VERSION} \\\n    && pip install --no-cache-dir boto3 \\\n    && pip install --no-cache-dir bs4 \\\n    && pip install --no-cache-dir fiona \\\n    && pip install --no-cache-dir gdal==2.1.0 \\\n    && pip install --no-cache-dir git+https://github.com/jguthmiller/pygeobuf.git@geobuf-v3 \\\n    && pip install --no-cache-dir geojson \\\n    && pip install --no-cache-dir geopandas \\\n    && pip install --no-cache-dir geomet \\\n    && pip install --no-cache-dir lxml \\\n    && pip install --no-cache-dir keen \\\n    && pip install --no-cache-dir ndg-httpsclient \\\n    && pip install --no-cache-dir pandas \\\n    && pip install --no-cache-dir pymssql \\\n    && pip install --no-cache-dir psycopg2-binary \\\n    && pip install --no-cache-dir pyasn1 \\\n    && pip install --no-cache-dir PyGithub \\\n    && pip install --no-cache-dir pyOpenSSL \\\n    && pip install --no-cache-dir pytz \\\n    && pip install --no-cache-dir \"redis~=3.2\" \\\n    && pip install --no-cache-dir requests \\\n    && pip install --no-cache-dir rtree \\\n    && pip install --no-cache-dir shapely \\\n    && pip install --no-cache-dir \"tornado>=4.2.0,<6.0.0\" \\\n    && pip install --no-cache-dir xlrd \\\n    && apt-get autoremove -yqq --purge \\\n    && apt-get clean \\\n    && rm -rf \\\n        /var/lib/apt/lists/* \\\n        /tmp/* \\\n        /var/tmp/* \\\n        /usr/share/man \\\n        /usr/share/doc \\\n        /usr/share/doc-base\n\n\n\n# R Installs\n## Use Debian unstable via pinning -- new style via APT::Default-Release\nRUN echo \"deb http://http.debian.net/debian sid main\" > /etc/apt/sources.list.d/debian-unstable.list \\\n    && echo 'APT::Default-Release \"testing\";' > /etc/apt/apt.conf.d/default\n\n## Now install R and littler, and create a link for littler in /usr/local/bin\nRUN apt-get update \\\n    && apt-get install -t unstable -y --no-install-recommends \\\n      littler \\\n      r-cran-littler \\\n      r-base=${R_BASE_VERSION}-* \\\n      r-base-dev=${R_BASE_VERSION}-* \\\n      r-recommended=${R_BASE_VERSION}-* \\\n      && ln -s /usr/lib/R/site-library/littler/examples/install.r /usr/local/bin/install.r \\\n      && ln -s /usr/lib/R/site-library/littler/examples/install2.r /usr/local/bin/install2.r \\\n      && ln -s /usr/lib/R/site-library/littler/examples/installGithub.r /usr/local/bin/installGithub.r \\\n      && ln -s /usr/lib/R/site-library/littler/examples/testInstalled.r /usr/local/bin/testInstalled.r \\\n      && install.r docopt \\\n      && rm -rf /tmp/downloaded_packages/ /tmp/*.rds && rm -rf /var/lib/apt/lists/*;\n      #&& rm -rf /var/lib/apt/lists/*\n\n\nRUN install.r dplyr \\\n    crosstalk \\\n    data.table \\\n    DT \\\n    dygraphs \\\n    flexdashboard \\\n    ggplot2 \\\n    leaflet \\\n    mgcv \\\n    plotly \\\n    rmarkdown \\\n    rsconnect \\\n    shiny \\\n    tidyr \\\n    viridis\n\nRUN chown -R airflow /usr/local/lib/R/site-library* /usr/local/lib/R/site-library/*\n\n\n\n\n# Get Oracle Client\n# TODO -- ADD\nADD http://datasd-dev-assets.s3.amazonaws.com/oracle.zip ${AIRFLOW_HOME}/\nADD https://github.com/energyhub/secretly/releases/download/0.0.6/secretly-linux-amd64 /usr/local/bin/secretly\n\nCOPY script/entrypoint.sh ${AIRFLOW_HOME}/entrypoint.sh\nCOPY config/airflow.cfg ${AIRFLOW_HOME}/airflow.cfg\n\nRUN chmod +x /usr/local/bin/secretly\n\n\nRUN unzip ${AIRFLOW_HOME}/oracle.zip -d /opt \\\n  && env ARCHFLAGS=\"-arch $ARCH\" pip install cx_Oracle \\\n  && rm ${AIRFLOW_HOME}/oracle.zip\n\nRUN chown -R airflow: ${AIRFLOW_HOME} \\\n    && chmod +x ${AIRFLOW_HOME}/entrypoint.sh \\\n    && chown -R airflow /usr/lib/python* /usr/local/lib/python* \\\n    && chown -R airflow /usr/local/bin* /usr/local/bin/*\n\nEXPOSE 8080 5555 8793\n\nUSER airflow\nWORKDIR ${AIRFLOW_HOME}\nENTRYPOINT [\"secretly\", \"./entrypoint.sh\"]\nCMD [\"secretly\", \"webserver\"] # set default arg for entrypoint\n\n"
}