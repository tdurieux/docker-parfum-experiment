{
  "startTime": 1674252327261,
  "endTime": 1674252327444,
  "originalSmells": [
    {
      "rule": "npmCacheCleanAfterInstall",
      "position": {
        "lineStart": 10,
        "lineEnd": 10,
        "columnStart": 4,
        "columnEnd": 42
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "# start from node image so we can install esy from npm\n\nFROM node:10.13-alpine as build\n\nENV TERM=dumb LD_LIBRARY_PATH=/usr/local/lib:/usr/lib:/lib\n\nRUN mkdir /esy\nWORKDIR /esy\n\nENV NPM_CONFIG_PREFIX=/esy\nRUN npm install -g --unsafe-perm esy@0.4.3 && npm cache clean --force;\n\n# now that we have esy installed we need a proper runtime\n\nFROM alpine:3.8 as esy\n\nENV TERM=dumb LD_LIBRARY_PATH=/usr/local/lib:/usr/lib:/lib\n\nWORKDIR /\n\nCOPY --from=build /esy /esy\n\nRUN apk add --no-cache ca-certificates wget bash curl perl-utils git patch gcc g++ musl-dev make m4\n\nRUN wget -q -O /etc/apk/keys/sgerrand.rsa.pub https://alpine-pkgs.sgerrand.com/sgerrand.rsa.pub\nRUN wget https://github.com/sgerrand/alpine-pkg-glibc/releases/download/2.28-r0/glibc-2.28-r0.apk\nRUN apk add --no-cache glibc-2.28-r0.apk\n\nENV PATH=/esy/bin:$PATH\n\nRUN mkdir /app\nWORKDIR /app\n\nCOPY esy.json esy.json\nCOPY esy.lock esy.lock\n\nRUN esy fetch\nRUN esy build-package @esy-ocaml/substs\nRUN esy build-package @opam/conf-m4\nRUN esy build-package ocaml@4.7.1003\nRUN esy build-package @opam/ocamlfind\nRUN esy build-package @opam/base-bytes\nRUN esy build-package @opam/ocamlbuild\nRUN esy build-package @opam/base-threads\nRUN esy build-package @opam/base-unix\nRUN esy build-package @opam/dune\nRUN esy build-package @opam/jbuilder\nRUN esy build-package @opam/result\nRUN esy build-package @opam/topkg\nRUN esy build-package @opam/astring\nRUN esy build-package @opam/cmdliner\nRUN esy build-package @opam/uchar\nRUN esy build-package @opam/fmt\nRUN esy build-package @opam/uuidm\nRUN esy build-package @opam/alcotest\nRUN esy build-package @opam/base-bigarray\nRUN esy build-package @opam/bigstringaf\nRUN esy build-package @opam/faraday\nRUN esy build-package @opam/cppo\nRUN esy build-package @opam/lwt\nRUN esy build-package @opam/faraday-lwt\nRUN esy build-package @opam/faraday-lwt-unix\nRUN esy build-package @opam/angstrom\nRUN esy build-package @opam/httpaf\nRUN esy build-package @opam/httpaf-lwt\nRUN esy build-package @opam/logs\nRUN esy build-package @opam/cppo_ocamlbuild\nRUN esy build-package @opam/ocaml-migrate-parsetree\nRUN esy build-package @opam/ppx_derivers\nRUN esy build-package @opam/ppx_tools\nRUN esy build-package @opam/ppx_deriving\nRUN esy build-package @opam/ppxfind\nRUN esy build-package @opam/conf-which\nRUN esy build-package @opam/easy-format\nRUN esy build-package @opam/biniou\nRUN esy build-package @opam/yojson\nRUN esy build-package @opam/ppx_deriving_yojson\nRUN esy build-package @opam/sexplib0\nRUN esy build-package @opam/base\nRUN esy build-package @opam/ocaml-compiler-libs\nRUN esy build-package @opam/stdio\nRUN esy build-package @opam/ppxlib\nRUN esy build-package @opam/ppx_sexp_conv\nRUN esy build-package @opam/seq\nRUN esy build-package @opam/re\nRUN esy build-package @opam/stringext\nRUN esy build-package @opam/uri\nRUN esy build-package @opam/base64\n\nCOPY . .\n\nRUN esy b dune build examples/api-gateway/basic.exe --profile=static\n\nRUN mv $(esy bash -c 'echo $cur__target_dir/default/examples/api-gateway/basic.exe') bootstrap\n"
}