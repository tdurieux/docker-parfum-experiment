{
  "startTime": 1674249676808,
  "endTime": 1674249676850,
  "originalSmells": [
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 4,
        "lineEnd": 10,
        "columnStart": 22,
        "columnEnd": 17
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "FROM openjdk:8-jdk-slim as builder\n\n# Install tools required by FOP\nWORKDIR /usr/local\nRUN apt-get update && apt-get install -y --no-install-recommends \\\n  expat \\\n  fontconfig \\\n  libfreetype6 \\\n  liblcms2-2 \\\n  libpng16-16 \\\n  ttf-dejavu-core && rm -rf /var/lib/apt/lists/*;\n\nFROM gcr.io/distroless/java:8\n\n# Copy over dependancies for Apache FOP, missing from gcr's JRE\nCOPY --from=builder /usr/lib/x86_64-linux-gnu/libfreetype.so.6.12.3 /usr/lib/x86_64-linux-gnu/libfreetype.so.6\nCOPY --from=builder /usr/lib/x86_64-linux-gnu/liblcms2.so.2.0.8 /usr/lib/x86_64-linux-gnu/liblcms2.so.2\nCOPY --from=builder /usr/lib/x86_64-linux-gnu/libpng16.so.16.28.0 /usr/lib/x86_64-linux-gnu/libpng16.so.16\nCOPY --from=builder /usr/lib/x86_64-linux-gnu/libfontconfig.so.1.8.0 /usr/lib/x86_64-linux-gnu/libfontconfig.so.1\n\n# Copy dependancies for Apache Batik (used by Apache FOP to handle SVG rendering)\nCOPY --from=builder /etc/fonts /etc/fonts\nCOPY --from=builder /lib/x86_64-linux-gnu/libexpat.so.1 /lib/x86_64-linux-gnu/libexpat.so.1\nCOPY --from=builder /usr/share/fontconfig /usr/share/fontconfig\nCOPY --from=builder /usr/share/fonts/truetype/dejavu /usr/share/fonts/truetype/dejavu\n\n# Copy eXist-db\nCOPY LICENSE /exist/LICENSE\nCOPY autodeploy /exist/autodeploy\nCOPY etc /exist/etc\nCOPY lib /exist/lib\nCOPY logs /exist/logs\n\n\n# Build-time metadata as defined at http://label-schema.org\n# and used by autobuilder @hooks/build\nLABEL org.label-schema.build-date=${build-tstamp} \\\n      org.label-schema.description=\"${project.description}\" \\\n      org.label-schema.name=\"existdb\" \\\n      org.label-schema.schema-version=\"1.0\" \\\n      org.label-schema.url=\"${project.url}\" \\\n      org.label-schema.vcs-ref=${build-commit-abbrev} \\\n      org.label-schema.vcs-url=\"${project.scm.url}\" \\\n      org.label-schema.vendor=\"existdb\"\n\nEXPOSE 8080 8443\n\n# make CACHE_MEM and MAX_BROKER available to users\nARG CACHE_MEM\nARG MAX_BROKER\n\nENV EXIST_HOME \"/exist\"\nENV CLASSPATH=/exist/lib/${exist.uber.jar.filename}\n\nENV JAVA_TOOL_OPTIONS \\\n  -Dfile.encoding=UTF8 \\\n  -Dsun.jnu.encoding=UTF-8 \\\n  -Djava.awt.headless=true \\\n  -Dorg.exist.db-connection.cacheSize=${CACHE_MEM:-256}M \\\n  -Dorg.exist.db-connection.pool.max=${MAX_BROKER:-20} \\\n  -Dlog4j.configurationFile=/exist/etc/log4j2.xml \\\n  -Dexist.home=/exist \\\n  -Dexist.configurationFile=/exist/etc/conf.xml \\\n  -Djetty.home=/exist \\\n  -Dexist.jetty.config=/exist/etc/jetty/standard.enabled-jetty-configs \\\n  -XX:+UnlockExperimentalVMOptions \\\n  -XX:+UseCGroupMemoryLimitForHeap \\\n  -XX:+UseG1GC \\\n  -XX:+UseStringDeduplication \\\n  -XX:MaxRAMFraction=1 \\\n  -XX:+ExitOnOutOfMemoryError\n\nHEALTHCHECK CMD [ \"java\", \\\n    \"org.exist.start.Main\", \"client\", \\\n    \"--no-gui\",  \"--xpath\", \"system:get-version()\" ]\n\nENTRYPOINT [ \"java\", \\\n    \"org.exist.start.Main\", \"jetty\" ]\n"
}