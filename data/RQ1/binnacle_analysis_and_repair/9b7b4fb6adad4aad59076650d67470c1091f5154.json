{
  "startTime": 1674251259760,
  "endTime": 1674251260443,
  "originalSmells": [
    {
      "rule": "wgetUseHttpsUrl",
      "position": {
        "lineStart": 56,
        "lineEnd": 56,
        "columnStart": 4,
        "columnEnd": 63
      }
    },
    {
      "rule": "wgetUseHttpsUrl",
      "position": {
        "lineStart": 61,
        "lineEnd": 61,
        "columnStart": 4,
        "columnEnd": 80
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 173,
        "lineEnd": 173,
        "columnStart": 4,
        "columnEnd": 95
      }
    },
    {
      "rule": "tarSomethingRmTheSomething",
      "position": {
        "lineStart": 57,
        "lineEnd": 57,
        "columnStart": 4,
        "columnEnd": 39
      }
    },
    {
      "rule": "tarSomethingRmTheSomething",
      "position": {
        "lineStart": 62,
        "lineEnd": 62,
        "columnStart": 4,
        "columnEnd": 41
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 32,
        "lineEnd": 32,
        "columnStart": 4,
        "columnEnd": 124
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 35,
        "lineEnd": 35,
        "columnStart": 4,
        "columnEnd": 69
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 38,
        "lineEnd": 38,
        "columnStart": 4,
        "columnEnd": 49
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 53,
        "lineEnd": 53,
        "columnStart": 4,
        "columnEnd": 45
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 102,
        "lineEnd": 102,
        "columnStart": 4,
        "columnEnd": 37
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 115,
        "lineEnd": 115,
        "columnStart": 4,
        "columnEnd": 28
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 171,
        "lineEnd": 171,
        "columnStart": 4,
        "columnEnd": 68
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 172,
        "lineEnd": 172,
        "columnStart": 4,
        "columnEnd": 55
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 174,
        "lineEnd": 174,
        "columnStart": 4,
        "columnEnd": 37
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 32,
        "lineEnd": 32,
        "columnStart": 4,
        "columnEnd": 124
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 35,
        "lineEnd": 35,
        "columnStart": 4,
        "columnEnd": 69
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 38,
        "lineEnd": 38,
        "columnStart": 4,
        "columnEnd": 49
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 53,
        "lineEnd": 53,
        "columnStart": 4,
        "columnEnd": 45
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 102,
        "lineEnd": 102,
        "columnStart": 4,
        "columnEnd": 37
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 115,
        "lineEnd": 115,
        "columnStart": 4,
        "columnEnd": 28
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 171,
        "lineEnd": 171,
        "columnStart": 4,
        "columnEnd": 68
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 172,
        "lineEnd": 172,
        "columnStart": 4,
        "columnEnd": 55
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 174,
        "lineEnd": 174,
        "columnStart": 4,
        "columnEnd": 37
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 32,
        "lineEnd": 32,
        "columnStart": 4,
        "columnEnd": 124
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 35,
        "lineEnd": 35,
        "columnStart": 4,
        "columnEnd": 69
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 38,
        "lineEnd": 38,
        "columnStart": 4,
        "columnEnd": 49
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 53,
        "lineEnd": 53,
        "columnStart": 4,
        "columnEnd": 45
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 102,
        "lineEnd": 102,
        "columnStart": 4,
        "columnEnd": 37
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 115,
        "lineEnd": 115,
        "columnStart": 4,
        "columnEnd": 28
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 171,
        "lineEnd": 171,
        "columnStart": 4,
        "columnEnd": 68
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 172,
        "lineEnd": 172,
        "columnStart": 4,
        "columnEnd": 55
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 174,
        "lineEnd": 174,
        "columnStart": 4,
        "columnEnd": 37
      }
    }
  ],
  "repairedSmells": [
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 32,
        "lineEnd": 32,
        "columnStart": 4,
        "columnEnd": 148
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 35,
        "lineEnd": 35,
        "columnStart": 4,
        "columnEnd": 93
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 38,
        "lineEnd": 38,
        "columnStart": 4,
        "columnEnd": 73
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 53,
        "lineEnd": 53,
        "columnStart": 4,
        "columnEnd": 69
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 102,
        "lineEnd": 102,
        "columnStart": 4,
        "columnEnd": 61
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 115,
        "lineEnd": 115,
        "columnStart": 4,
        "columnEnd": 52
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 171,
        "lineEnd": 171,
        "columnStart": 4,
        "columnEnd": 92
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 172,
        "lineEnd": 172,
        "columnStart": 4,
        "columnEnd": 79
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 174,
        "lineEnd": 174,
        "columnStart": 4,
        "columnEnd": 61
      }
    }
  ],
  "repairedDockerfile": "# This image is intended to be used with fdroidserver for the purpose\n# of dynamic scanning of pre-built APKs during the fdroid build process.\n\n# Start with ubuntu 12.04 (i386).\nFROM ubuntu:14.04\nMAINTAINER fdroid.dscanner <fdroid.dscanner@gmail.com>\n\nENV DROZER_URL https://github.com/mwrlabs/drozer/releases/download/2.3.4/drozer_2.3.4.deb\nENV DROZER_DEB drozer_2.3.4.deb\n\nENV AGENT_URL https://github.com/mwrlabs/drozer/releases/download/2.3.4/drozer-agent-2.3.4.apk\nENV AGENT_APK drozer-agent-2.3.4.apk\n\n# Specially for SSH access and port redirection\nENV ROOTPASSWORD android\n\n# Expose ADB, ADB control and VNC ports\nEXPOSE 22\nEXPOSE 5037\nEXPOSE 5554\nEXPOSE 5555\nEXPOSE 5900\nEXPOSE 5901\n\nENV DEBIAN_FRONTEND noninteractive\nRUN echo \"debconf shared/accepted-oracle-license-v1-1 select true\" | debconf-set-selections\nRUN echo \"debconf shared/accepted-oracle-license-v1-1 seen true\" | debconf-set-selections\n\n# Update packages\nRUN apt-get -y update\n\n# Drozer packages\nRUN apt-get install --no-install-recommends wget python2.7 python-dev python2.7-dev python-openssl python-twisted python-protobuf bash-completion -y && rm -rf /var/lib/apt/lists/*;\n\n# First, install add-apt-repository, sshd and bzip2\nRUN apt-get -y --no-install-recommends install python-software-properties bzip2 ssh net-tools && rm -rf /var/lib/apt/lists/*;\n\n# ubuntu 14.04 needs this too\nRUN apt-get -y --no-install-recommends install software-properties-common && rm -rf /var/lib/apt/lists/*;\n\n# Add oracle-jdk7 to repositories\nRUN add-apt-repository ppa:webupd8team/java\n\n# Make sure the package repository is up to date\nRUN echo \"deb http://archive.ubuntu.com/ubuntu trusty main universe\" > /etc/apt/sources.list\n\n# Update apt\nRUN apt-get update\n\n# Add drozer\nRUN useradd -ms /bin/bash drozer\n\n# Install oracle-jdk7\nRUN apt-get -y --no-install-recommends install oracle-java7-installer && rm -rf /var/lib/apt/lists/*;\n\n# Install android sdk\nRUN wget https://dl.google.com/android/android-sdk_r23-linux.tgz\nRUN tar -xvzf android-sdk_r23-linux.tgz && rm android-sdk_r23-linux.tgz\nRUN mv -v android-sdk-linux /usr/local/android-sdk\n\n# Install apache ant\nRUN wget https://archive.apache.org/dist/ant/binaries/apache-ant-1.8.4-bin.tar.gz\nRUN tar -xvzf apache-ant-1.8.4-bin.tar.gz && rm apache-ant-1.8.4-bin.tar.gz\nRUN mv -v apache-ant-1.8.4 /usr/local/apache-ant\n\n# Add android tools and platform tools to PATH\nENV ANDROID_HOME /usr/local/android-sdk\nENV PATH $PATH:$ANDROID_HOME/tools\nENV PATH $PATH:$ANDROID_HOME/platform-tools\n\n# Add ant to PATH\nENV ANT_HOME /usr/local/apache-ant\nENV PATH $PATH:$ANT_HOME/bin\n\n# Export JAVA_HOME variable\nENV JAVA_HOME /usr/lib/jvm/java-7-oracle\n\n# Remove compressed files.\nRUN cd /; rm android-sdk_r23-linux.tgz && rm apache-ant-1.8.4-bin.tar.gz\n\n# Some preparation before update\nRUN chown -R root:root /usr/local/android-sdk/\n\n# Install latest android tools and system images\nRUN echo \"y\" | android update sdk --filter platform-tool --no-ui --force\nRUN echo \"y\" | android update sdk --filter platform --no-ui --force\nRUN echo \"y\" | android update sdk --filter build-tools-22.0.1 --no-ui -a\nRUN echo \"y\" | android update sdk --filter sys-img-x86-android-19 --no-ui -a\n#RUN echo \"y\" | android update sdk --filter sys-img-x86-android-21 --no-ui -a\n#RUN echo \"y\" | android update sdk --filter sys-img-x86-android-22 --no-ui -a\nRUN echo \"y\" | android update sdk --filter sys-img-armeabi-v7a-android-19 --no-ui -a\n#RUN echo \"y\" | android update sdk --filter sys-img-armeabi-v7a-android-21 --no-ui -a\n#RUN echo \"y\" | android update sdk --filter sys-img-armeabi-v7a-android-22 --no-ui -a\n\n# Update ADB\nRUN echo \"y\" | android update adb\n\n# Create fake keymap file\nRUN mkdir /usr/local/android-sdk/tools/keymaps\nRUN touch /usr/local/android-sdk/tools/keymaps/en-us\n\n# Run sshd\nRUN apt-get install --no-install-recommends -y openssh-server && rm -rf /var/lib/apt/lists/*;\nRUN mkdir /var/run/sshd\nRUN echo \"root:$ROOTPASSWORD\" | chpasswd\nRUN sed -i 's/PermitRootLogin without-password/PermitRootLogin yes/' /etc/ssh/sshd_config\nRUN sed -i 's/PermitEmptyPasswords no/PermitEmptyPasswords yes/' /etc/ssh/sshd_config\n\n# SSH login fix. Otherwise user is kicked off after login\nRUN sed 's@session\\s*required\\s*pam_loginuid.so@session optional pam_loginuid.so@g' -i /etc/pam.d/sshd\n\nENV NOTVISIBLE \"in users profile\"\nRUN echo \"export VISIBLE=now\" >> /etc/profile\n\n# Install socat\nRUN apt-get install --no-install-recommends -y socat && rm -rf /var/lib/apt/lists/*;\n\n# symlink android bins\nRUN ln -sv /usr/local/android-sdk/tools/android /usr/local/bin/\nRUN ln -sv /usr/local/android-sdk/tools/emulator /usr/local/bin/\nRUN ln -sv /usr/local/android-sdk/tools/ddms /usr/local/bin/\nRUN ln -sv /usr/local/android-sdk/tools/scheenshot2 /usr/local/bin/\nRUN ln -sv /usr/local/android-sdk/tools/monkeyrunner /usr/local/bin/\nRUN ln -sv /usr/local/android-sdk/tools/monitor /usr/local/bin/\nRUN ln -sv /usr/local/android-sdk/tools/mksdcard /usr/local/bin/\nRUN ln -sv /usr/local/android-sdk/tools/uiautomatorviewer /usr/local/bin/\nRUN ln -sv /usr/local/android-sdk/tools/traceview /usr/local/bin/\nRUN ln -sv /usr/local/android-sdk/platform-tools/adb /usr/local/bin/\nRUN ln -sv /usr/local/android-sdk/platform-tools/fastboot /usr/local/bin/\nRUN ln -sv /usr/local/android-sdk/platform-tools/sqlite3 /usr/local/bin/\n\n# Setup DROZER...\n# https://labs.mwrinfosecurity.com/tools/drozer/\n\n# Run as drozer user\nWORKDIR /home/drozer\n\n# Site lists the shasums, however, I'm not sure the best way to integrate the\n# checks here. No real idiomatic way for Dockerfile to do that and most of\n# the examples online use chained commands but we want things to *BREAK* when\n# the sha doesn't match. So far, I can't seem to reliably make Docker not\n# finish the image build process.\n\n# Download the console\nRUN wget -c $DROZER_URL\n\n# Install the console\nRUN dpkg -i $DROZER_DEB\n\n# Download agent\nRUN wget -c $AGENT_URL\n# Keep it version agnostic for other scripts such as install_drozer.py\nRUN mv -v $AGENT_APK drozer-agent.apk\n\n# Port forwarding required by drozer\nRUN echo 'adb forward tcp:31415 tcp:31415' >> /home/drozer/.bashrc\n\n# Alias for Drozer\nRUN echo \"alias drozer='drozer console connect'\" >> /home/drozer/.bashrc\n\n# add extra scripting\nCOPY install_agent.py /home/drozer/install_agent.py\nRUN chmod 755 /home/drozer/install_agent.py\nCOPY enable_service.py /home/drozer/enable_service.py\nRUN chmod 755 /home/drozer/enable_service.py\nCOPY drozer.py /home/drozer/drozer.py\nRUN chmod 755 /home/drozer/drozer.py\n\n# fix ownerships\nRUN chown -R drozer.drozer /home/drozer\n\nRUN apt-get -y --no-install-recommends --force-yes install python-pkg-resources=3.3-1ubuntu1 && rm -rf /var/lib/apt/lists/*;\nRUN apt-get -y --no-install-recommends install python-pip python-setuptools git && rm -rf /var/lib/apt/lists/*;\nRUN pip install --no-cache-dir \"git+https://github.com/dtmilano/AndroidViewClient.git#egg=androidviewclient\"\nRUN apt-get -y --no-install-recommends install python-pexpect && rm -rf /var/lib/apt/lists/*;\n\n# Add entrypoint\nCOPY entrypoint.sh /home/drozer/entrypoint.sh\nRUN chmod +x /home/drozer/entrypoint.sh\nENTRYPOINT [\"/home/drozer/entrypoint.sh\"]\n"
}