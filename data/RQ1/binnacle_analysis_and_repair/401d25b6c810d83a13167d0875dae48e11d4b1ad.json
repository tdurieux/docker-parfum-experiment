{
  "startTime": 1674242519648,
  "endTime": 1674242519760,
  "originalSmells": [
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 35,
        "lineEnd": 35,
        "columnStart": 4,
        "columnEnd": 36
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 36,
        "lineEnd": 36,
        "columnStart": 4,
        "columnEnd": 44
      }
    },
    {
      "rule": "aptGetInstallUseY",
      "position": {
        "lineStart": 25,
        "lineEnd": 25,
        "columnStart": 4,
        "columnEnd": 73
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 25,
        "lineEnd": 25,
        "columnStart": 4,
        "columnEnd": 73
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "# Base image to take care of `apt`, `pip`, and `npm` dependencies. Packages are\n#   stored outside the source directory so it can be overwritten in development scenarios.\n\nFROM kobotoolbox/base-kobos:latest\n\n\nENV KPI_SRC_DIR=/srv/src/kpi \\\n    KPI_NODE_PATH=/srv/node_modules \\\n    PIP_DIR=/srv/pip\n\n\n###############################\n# Prepare to install Node 8.x #\n###############################\n\nRUN echo 'deb https://deb.nodesource.com/node_8.x xenial main' > /etc/apt/sources.list.d/nodesource.list && \\\n    wget -qO- https://deb.nodesource.com/gpgkey/nodesource.gpg.key | apt-key add -\n\n\n###########################\n# Install `apt` packages. #\n###########################\n\nCOPY ./dependencies/apt_requirements.txt /srv/tmp/base__apt_requirements.txt\nRUN apt-get update -qq && \\\n    apt-get install -y --no-install-recommends -qq nodejs $(cat /srv/tmp/base__apt_requirements.txt) && \\\n    apt-get -qq --purge autoremove && \\\n    apt-get clean && rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/*\n\n\n###########################\n# Install `pip` packages. #\n###########################\n\nWORKDIR ${PIP_DIR}/\nRUN pip install --no-cache-dir --quiet 'pip>=9,<10' && \\\n    pip install --no-cache-dir --quiet 'pip-tools>=1.11,<2'\nCOPY ./dependencies/pip/external_services.txt /srv/tmp/base__external_services.txt\nRUN pip-sync /srv/tmp/base__external_services.txt 1>/dev/null && \\\n    rm -rf ~/.cache/pip\n\n\n###########################\n# Install `npm` packages. #\n###########################\n\nCOPY ./package.json ${KPI_SRC_DIR}/\nWORKDIR ${KPI_SRC_DIR}/\nRUN mkdir -p \"${KPI_NODE_PATH}\" && \\\n    ln -s \"${KPI_NODE_PATH}\" \"${KPI_SRC_DIR}/node_modules\" && \\\n    npm install --quiet && \\\n    npm cache clean --force && \\\n    mv \"${KPI_SRC_DIR}/package.json\" /srv/tmp/base_package.json\nENV PATH $PATH:${KPI_NODE_PATH}/.bin\n"
}