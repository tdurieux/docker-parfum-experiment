{
  "startTime": 1674235179383,
  "endTime": 1674235179872,
  "originalSmells": [
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 73,
        "lineEnd": 73,
        "columnStart": 4,
        "columnEnd": 91
      }
    },
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 86,
        "lineEnd": 86,
        "columnStart": 4,
        "columnEnd": 49
      }
    },
    {
      "rule": "npmCacheCleanAfterInstall",
      "position": {
        "lineStart": 91,
        "lineEnd": 91,
        "columnStart": 4,
        "columnEnd": 28
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 9,
        "lineEnd": 9,
        "columnStart": 7,
        "columnEnd": 46
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 18,
        "lineEnd": 25,
        "columnStart": 7,
        "columnEnd": 12
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 29,
        "lineEnd": 29,
        "columnStart": 7,
        "columnEnd": 38
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 33,
        "lineEnd": 43,
        "columnStart": 7,
        "columnEnd": 19
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 47,
        "lineEnd": 49,
        "columnStart": 7,
        "columnEnd": 21
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 53,
        "lineEnd": 54,
        "columnStart": 7,
        "columnEnd": 20
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 67,
        "lineEnd": 70,
        "columnStart": 7,
        "columnEnd": 13
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 88,
        "lineEnd": 88,
        "columnStart": 7,
        "columnEnd": 33
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 9,
        "lineEnd": 9,
        "columnStart": 7,
        "columnEnd": 46
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 18,
        "lineEnd": 25,
        "columnStart": 7,
        "columnEnd": 12
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 29,
        "lineEnd": 29,
        "columnStart": 7,
        "columnEnd": 38
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 33,
        "lineEnd": 43,
        "columnStart": 7,
        "columnEnd": 19
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 47,
        "lineEnd": 49,
        "columnStart": 7,
        "columnEnd": 21
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 53,
        "lineEnd": 54,
        "columnStart": 7,
        "columnEnd": 20
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 67,
        "lineEnd": 70,
        "columnStart": 7,
        "columnEnd": 13
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 88,
        "lineEnd": 88,
        "columnStart": 7,
        "columnEnd": 33
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "FROM ubuntu:16.04\nMAINTAINER dev@cedvan.com\n\n# Version Pydio\nENV PYDIO_VERSION 8.0.1\nENV DEBIAN_FRONTEND=noninteractive\n\n# Install locales\nRUN apt-get update -qq \\\n    && apt-get install --no-install-recommends -qy locales locales-all \\\n    && echo 'LANG=en_US.UTF-8' > /etc/default/locale \\\n    && dpkg-reconfigure locales && rm -rf /var/lib/apt/lists/*;\nENV LC_ALL en_US.UTF-8\nENV LANG en_US.UTF-8\nENV LANGUAGE en_US.UTF-8\n\n# Install requirements\nRUN apt-get update -qq \\\n    && apt-get install --no-install-recommends -qqy \\\n        apt-utils \\\n        ca-certificates \\\n        ssl-cert \\\n        libaprutil1 \\\n        apt-transport-https \\\n        libapr1 \\\n        wget && rm -rf /var/lib/apt/lists/*;\n\n# Install supervisor\nRUN apt-get update -qq \\\n    && apt-get install --no-install-recommends -qqy supervisor && rm -rf /var/lib/apt/lists/*;\n\n# Install PHP\nRUN apt-get update -qq \\\n    && apt-get install --no-install-recommends -qqy \\\n        php-fpm \\\n        php-cli \\\n        php-gd \\\n        php-mcrypt \\\n        php-mysql \\\n        php-pgsql \\\n        php-dom \\\n        php-intl \\\n        php-mbstring \\\n        php-sqlite3 && rm -rf /var/lib/apt/lists/*;\n\n# Install Nginx\nRUN apt-get update -qq \\\n    && apt-get install --no-install-recommends -qqy \\\n        nginx \\\n        apache2-utils && rm -rf /var/lib/apt/lists/*;\n\n# Install MySQL\nRUN apt-get update -qq \\\n    && apt-get install --no-install-recommends -qqy \\\n        mysql-server && rm -rf /var/lib/apt/lists/*;\n\n# Configure PHP and Nginx\nRUN mkdir /run/php \\\n    && echo \"daemon off;\" >> /etc/nginx/nginx.conf\n\n# Configure MySQL\nRUN mkdir /backup \\\n    && cp -rf /var/lib/mysql /backup/mysql \\\n    && rm -rf /var/lib/mysql\n\n# Install build requirements\nRUN apt-get update -qq \\\n    && apt-get install --no-install-recommends -qqy \\\n        curl \\\n        git \\\n        unzip && rm -rf /var/lib/apt/lists/*;\n\n# Download Pydio\nRUN curl -f -sL https://github.com/pydio/pydio-core/archive/pydio-core-${PYDIO_VERSION}.tar.gz | tar xzC /tmp \\\n    && rm -rf /var/www \\\n    && mv /tmp/pydio-core-pydio-core-${PYDIO_VERSION} /var/www\n\n# Install composer\nRUN php -r \"copy('https://getcomposer.org/installer', 'composer-setup.php');\" \\\n    && php -r \"if (hash_file('SHA384', 'composer-setup.php') === '544e09ee996cdf60ece3804abc52599c22b1f40f4323403c44d44fdfdd586475ca9813a858088ffbc1f233e9b180f061') { echo 'Installer verified'; } else { echo 'Installer corrupt'; unlink('composer-setup.php'); } echo PHP_EOL;\" \\\n    && php composer-setup.php \\\n    && php -r \"unlink('composer-setup.php');\" \\\n    && mv composer.phar /bin/composer \\\n    && chmod +x /bin/composer\n\n# Install NPM\nRUN curl -f -sL https://deb.nodesource.com/setup_8.x | bash - \\\n    && apt-get update -qq \\\n    && apt-get install --no-install-recommends -qy nodejs && rm -rf /var/lib/apt/lists/*;\n\n# Install Grunt\nRUN npm install -g grunt-cli && npm cache clean --force;\n\n# Install dependancies\nRUN cd /var/www/core/src/core \\\n    && composer install \\\n    && cd /var/www/core/src \\\n    && find . -maxdepth 3 -name composer.json -execdir composer install \\; \\\n    && find . -maxdepth 3 -name Gruntfile.js -execdir bash -c \"npm install && grunt && rm -rf node_modules\" \\;\n\n# Remove build requirements\nRUN apt-get remove -qy \\\n        curl \\ \n        git \\\n        wget \\ \n        unzip \\\n        nodejs \\\n    && apt-get autoremove -qy \\\n    && apt-get autoclean -qy \\\n    && rm -rf /bin/composer \\\n    && rm -rf /root/.composer \\\n    && rm -rf /too/.npm\n\n# Load permissions\nRUN chown -R www-data:www-data /var/www\n\n# Load Scripts bash for installing Pydio\nCOPY scripts /scripts/pydio/\nRUN chmod -R u+x /scripts/pydio\n\n# Load assets\nCOPY assets/supervisor/conf.d /etc/supervisor/conf.d\nCOPY assets/supervisor/supervisord.conf /etc/supervisor/supervisord.conf\nCOPY assets/vhosts /etc/nginx/sites-available\nCOPY assets/config /assets/config\n\n# Clean\nRUN apt-get -qqy --purge autoremove \\\n    && apt-get clean \\\n    && rm -rf /var/lib/apt/lists/*\n\nVOLUME /data/pydio\nVOLUME /var/lib/mysql\n\nEXPOSE 3306\nEXPOSE 80\nEXPOSE 443\n\nCMD /scripts/pydio/launch.sh\n"
}