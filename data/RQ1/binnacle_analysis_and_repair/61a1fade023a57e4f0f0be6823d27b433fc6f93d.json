{
  "startTime": 1674238843937,
  "endTime": 1674238844227,
  "originalSmells": [
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 15,
        "lineEnd": 16,
        "columnStart": 2,
        "columnEnd": 25
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "FROM openjdk:8u212-jdk-alpine3.9\n\nRUN apk add --no-cache \\\n  # Required:\n  # (git needed so can include Git revision in the build, and show at http://server/-/build-info.)\n  curl unzip git \\\n  # Nice to have:\n  tree less wget net-tools bash \\\n  # Telnet, nice for troubleshooting SMTP problems for example.\n  busybox-extras\n\nENV ACVERSION 1.3.12\nENV ACTIVATOR activator-$ACVERSION\n\nRUN \\\n  curl -f https://downloads.typesafe.com/typesafe-activator/$ACVERSION/typesafe-$ACTIVATOR-minimal.zip \\\n    > /tmp/$ACTIVATOR.zip\n\n# Concerning +rw for /opt/typesafe-activator/: Play writes some files to directories\n# within the archive. Otherwise:\n#   Error during sbt execution: java.io.IOException: No such file or directory\n#   see: http://stackoverflow.com/questions/10559313/play-framework-installation\nRUN unzip /tmp/$ACTIVATOR.zip -d /tmp/ && \\\n    rm -f /tmp/$ACTIVATOR.zip && \\\n    mkdir -p /opt/ && \\\n    mv /tmp/activator-$ACVERSION-minimal /opt/typesafe-activator && \\\n    chmod -R ugo+rw /opt/typesafe-activator/ && \\\n    chmod -R ugo+x /opt/typesafe-activator/bin/activator\n\n# Install 'gosu' so we can use it instead of 'su'.\n# For unknown reasons, '  exec su ...' no longer works, but 'exec gosu ...' works fine.\nRUN apk add --no-cache \\\n  --repository http://dl-cdn.alpinelinux.org/alpine/edge/testing/ \\\n  gosu\n\n# Play's HTTP and HTTPS listen ports, Java debugger port, JMX port 3333.\nEXPOSE 9000 9443 9999 3333\n\nRUN mkdir -p /opt/talkyard/uploads/ && \\\n    chmod -R ugo+rw /opt/talkyard/uploads/\n\n# Add a self signed dummy cert for the dummy SMTP server (the 'fakemail' Docker container),\n# so one can test connecting to it with TLS and see if the TLS conf vals work. [26UKWD2]\n# (\"changeit\" = default keystore password)\nCOPY fakemail-publ-test-self-signed.crt /smtp-server.crt\nRUN cd $JAVA_HOME/jre/lib/security && \\\n    keytool -keystore cacerts -storepass changeit -noprompt -trustcacerts \\\n        -importcert -alias ldapcert -file /smtp-server.crt\n\nWORKDIR /opt/talkyard/app/\n\nCOPY entrypoint.dev.sh /docker-entrypoint.sh\nRUN  chmod ugo+x   /docker-entrypoint.sh\nENTRYPOINT [\"/docker-entrypoint.sh\"]\n\n# Overriden in docker-compose.yml\nENV PLAY_HEAP_MEMORY_MB 1048\n\n# Set Java's user.home to /home/owner so sbt and Ivy will cache downloads there. [SBTHOME]\n# Although user.home is set in entrypoint.sh, apparently that setting gets lost here â€”\n# sbt and Ivy download things to /root/.sbt and /root/.ivy2 if running as root inside a vm.\n# Maybe because of 'exec'?\nCMD cd /opt/talkyard/app/ && exec /opt/typesafe-activator/bin/activator \\\n  -mem $PLAY_HEAP_MEMORY_MB \\\n  -jvm-debug 9999 \\\n  # Avoid SBT compilation java.lang.StackOverflowError in\n  # scala.tools.nsc.transform.Erasure.\n  -J-Xss30m \\\n  -Duser.home=/home/owner \\\n   # see [30PUK42] in app-prod/Dockerfile\n  -Djava.security.egd=file:/dev/./urandom \\\n  -Dcom.sun.management.jmxremote.port=3333 \\\n  -Dcom.sun.management.jmxremote.ssl=false \\\n  -Dcom.sun.management.jmxremote.authenticate=false \\\n  -Dhttp.port=9000 \\\n  -Dhttps.port=9443 \\\n  # SSL has security flaws. Use TLS instead. [NOSSL] [PROTOCONF]\n  -Ddeployment.security.SSLv2Hello=false \\\n  -Ddeployment.security.SSLv3=false \\\n  -Dhttps.protocols=TLSv1.1,TLSv1.2 \\\n  -Djdk.tls.client.protocols=TLSv1.1,TLSv1.2 \\\n  -Dconfig.file=/opt/talkyard/app/conf/app-dev.conf \\\n  run\n\n"
}