{
  "startTime": 1674252630590,
  "endTime": 1674252630943,
  "originalSmells": [
    {
      "rule": "aptGetInstallUseY",
      "position": {
        "lineStart": 40,
        "lineEnd": 40,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 2,
        "lineEnd": 5,
        "columnStart": 22,
        "columnEnd": 18
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 19,
        "lineEnd": 19,
        "columnStart": 4,
        "columnEnd": 28
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 32,
        "lineEnd": 32,
        "columnStart": 4,
        "columnEnd": 28
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 37,
        "lineEnd": 37,
        "columnStart": 4,
        "columnEnd": 57
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 40,
        "lineEnd": 40,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 51,
        "lineEnd": 51,
        "columnStart": 4,
        "columnEnd": 26
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 62,
        "lineEnd": 62,
        "columnStart": 4,
        "columnEnd": 31
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 69,
        "lineEnd": 69,
        "columnStart": 4,
        "columnEnd": 33
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 77,
        "lineEnd": 77,
        "columnStart": 4,
        "columnEnd": 74
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 80,
        "lineEnd": 80,
        "columnStart": 4,
        "columnEnd": 64
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 19,
        "lineEnd": 19,
        "columnStart": 4,
        "columnEnd": 28
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 32,
        "lineEnd": 32,
        "columnStart": 4,
        "columnEnd": 28
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 37,
        "lineEnd": 37,
        "columnStart": 4,
        "columnEnd": 57
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 40,
        "lineEnd": 40,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 51,
        "lineEnd": 51,
        "columnStart": 4,
        "columnEnd": 26
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 62,
        "lineEnd": 62,
        "columnStart": 4,
        "columnEnd": 31
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 69,
        "lineEnd": 69,
        "columnStart": 4,
        "columnEnd": 33
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 77,
        "lineEnd": 77,
        "columnStart": 4,
        "columnEnd": 74
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 80,
        "lineEnd": 80,
        "columnStart": 4,
        "columnEnd": 64
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 2,
        "lineEnd": 5,
        "columnStart": 22,
        "columnEnd": 18
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 19,
        "lineEnd": 19,
        "columnStart": 4,
        "columnEnd": 28
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 32,
        "lineEnd": 32,
        "columnStart": 4,
        "columnEnd": 28
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 37,
        "lineEnd": 37,
        "columnStart": 4,
        "columnEnd": 57
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 40,
        "lineEnd": 40,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 51,
        "lineEnd": 51,
        "columnStart": 4,
        "columnEnd": 26
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 62,
        "lineEnd": 62,
        "columnStart": 4,
        "columnEnd": 31
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 69,
        "lineEnd": 69,
        "columnStart": 4,
        "columnEnd": 33
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 77,
        "lineEnd": 77,
        "columnStart": 4,
        "columnEnd": 74
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 80,
        "lineEnd": 80,
        "columnStart": 4,
        "columnEnd": 64
      }
    }
  ],
  "repairedSmells": [
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 19,
        "lineEnd": 19,
        "columnStart": 4,
        "columnEnd": 52
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 32,
        "lineEnd": 32,
        "columnStart": 4,
        "columnEnd": 52
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 37,
        "lineEnd": 37,
        "columnStart": 4,
        "columnEnd": 81
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 40,
        "lineEnd": 40,
        "columnStart": 4,
        "columnEnd": 54
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 51,
        "lineEnd": 51,
        "columnStart": 4,
        "columnEnd": 50
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 62,
        "lineEnd": 62,
        "columnStart": 4,
        "columnEnd": 55
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 69,
        "lineEnd": 69,
        "columnStart": 4,
        "columnEnd": 57
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 77,
        "lineEnd": 77,
        "columnStart": 4,
        "columnEnd": 98
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 80,
        "lineEnd": 80,
        "columnStart": 4,
        "columnEnd": 88
      }
    }
  ],
  "repairedDockerfile": "FROM debian\n\nRUN apt-get update && apt-get install --no-install-recommends -y openssh-server \\\n          sudo \\\n          procps net-tools \\\n          nano vim && rm -rf /var/lib/apt/lists/*;\n\nRUN mkdir /run/sshd\n\nRUN useradd -m admin\n\nRUN usermod -a -G sudo admin\n\nRUN echo \"admin:test\" | chpasswd\n\nCOPY ./sshkey.pub /home/admin/.ssh/authorized_keys\n\nEXPOSE 22\n\nRUN apt-get install --no-install-recommends -y rsync && rm -rf /var/lib/apt/lists/*;\n\nEXPOSE 873\n\nRUN echo \" \\\nlock file = /var/run/rsync.lock \\\nlog file = /var/log/rsyncd.log \\\npid file = /var/run/rsyncd.pid \\\n\" > /etc/rsyncd.conf\n\n#RUN echo \". /root/entrypoint.sh\" >> /root/.profile\n#RUN echo \". /root/entrypoint.sh\" >> /root/.bashrc\n\nRUN apt-get install --no-install-recommends -y nginx && rm -rf /var/lib/apt/lists/*;\n\nEXPOSE 80\nEXPOSE 443\n\nRUN apt-get install --no-install-recommends -y php-fpm php-pgsql php-zip php-intl && rm -rf /var/lib/apt/lists/*;\nRUN mkdir /run/php\n\nRUN apt-get install -y --no-install-recommends openssl && rm -rf /var/lib/apt/lists/*;\nRUN openssl req -x509 -nodes -days 365 -newkey rsa:2048 \\\n             -keyout /etc/ssl/private/selfsigned.key \\\n             -out /etc/ssl/certs/selfsigned.crt \\\n             -subj '/CN=monsitessl.fr/O=My Company Name LTD./C=US'\nRUN openssl dhparam -out /etc/nginx/dhparam.pem 1024\nRUN echo \" \\\nssl_certificate /etc/ssl/certs/selfsigned.crt; \\\nssl_certificate_key /etc/ssl/private/selfsigned.key;\" > /etc/nginx/snippets/selfsigned.conf\nCOPY ./nginx/ssl/ssl-params.conf /etc/nginx/snippets/ssl-params.conf\n\nRUN apt-get install --no-install-recommends -y ufw && rm -rf /var/lib/apt/lists/*;\n#RUN sudo iptables -t filter -F\n#RUN sudo iptables -t filter -X\n#RUN ufw enable\n#RUN ufw default deny ingoing\n#RUN ufw allow 80\n#RUN ufw allow 443\n#RUN ufw allow 22\n#RUN ufw allow 25\n#RUN ufw reload\n\nRUN apt-get install --no-install-recommends -y fail2ban && rm -rf /var/lib/apt/lists/*;\nRUN mkdir /run/fail2ban\nRUN rm /etc/fail2ban/jail.d/defaults-debian.conf\n\nCOPY ./fail2ban/jail.local /etc/fail2ban/jail.d/my-jail.conf\nCOPY ./fail2ban/monfiltre.conf /etc/fail2ban/filter.d/monfiltre.conf\n\nRUN apt-get install --no-install-recommends -y postgresql && rm -rf /var/lib/apt/lists/*;\nRUN useradd -m dev1\n\n# Install Postfix.\nRUN echo \"postfix postfix/main_mailer_type string Internet site\" > preseed.txt\nRUN echo \"postfix postfix/mailname string mail.example.com\" >> preseed.txt\n# Use Mailbox format.\nRUN debconf-set-selections preseed.txt\nRUN DEBIAN_FRONTEND=noninteractive apt-get --no-install-recommends install -q -y postfix mailutils && rm -rf /var/lib/apt/lists/*;\nRUN mkdir -p /var/spool/postfix\n\nRUN DEBIAN_FRONTEND=noninteractive apt-get --no-install-recommends install -q -y proftpd && rm -rf /var/lib/apt/lists/*;\nRUN mkdir /run/proftpd\n\nCOPY ./postgres/init.sh /opt/.init_db.sh\n\nCOPY ./ufw/init.sh /opt/.init_ufw.sh\n\nCOPY ./nginx/www /var/www\nCOPY ./nginx/vhost /etc/nginx/sites-available\n\nRUN ln -s /etc/nginx/sites-available/monsite.fr /etc/nginx/sites-enabled/monsite.fr\nRUN ln -s /etc/nginx/sites-available/monsitephp.fr /etc/nginx/sites-enabled/monsitephp.fr\nRUN ln -s /etc/nginx/sites-available/monsitessl.fr /etc/nginx/sites-enabled/monsitessl.fr\n\nCOPY ./entrypoint.sh /opt/.entrypoint.sh\n\nWORKDIR /root\n\nRUN chmod +x /opt/.entrypoint.sh\nENTRYPOINT [\"/opt/.entrypoint.sh\"]\n"
}