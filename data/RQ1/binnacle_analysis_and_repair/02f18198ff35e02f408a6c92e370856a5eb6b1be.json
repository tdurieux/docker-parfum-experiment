{
  "startTime": 1674244650616,
  "endTime": 1674244651022,
  "originalSmells": [
    {
      "rule": "configureShouldUseBuildFlag",
      "position": {
        "lineStart": 51,
        "lineEnd": 51,
        "columnStart": 12,
        "columnEnd": 24
      }
    },
    {
      "rule": "configureShouldUseBuildFlag",
      "position": {
        "lineStart": 68,
        "lineEnd": 68,
        "columnStart": 32,
        "columnEnd": 92
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 12,
        "lineEnd": 12,
        "columnStart": 9,
        "columnEnd": 42
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 14,
        "lineEnd": 14,
        "columnStart": 9,
        "columnEnd": 39
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 15,
        "lineEnd": 15,
        "columnStart": 9,
        "columnEnd": 42
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 16,
        "lineEnd": 16,
        "columnStart": 9,
        "columnEnd": 48
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 17,
        "lineEnd": 17,
        "columnStart": 9,
        "columnEnd": 40
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 20,
        "lineEnd": 20,
        "columnStart": 9,
        "columnEnd": 76
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 23,
        "lineEnd": 23,
        "columnStart": 9,
        "columnEnd": 91
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 29,
        "lineEnd": 29,
        "columnStart": 9,
        "columnEnd": 32
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 12,
        "lineEnd": 12,
        "columnStart": 9,
        "columnEnd": 42
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 13,
        "lineEnd": 13,
        "columnStart": 9,
        "columnEnd": 62
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 14,
        "lineEnd": 14,
        "columnStart": 9,
        "columnEnd": 39
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 15,
        "lineEnd": 15,
        "columnStart": 9,
        "columnEnd": 42
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 16,
        "lineEnd": 16,
        "columnStart": 9,
        "columnEnd": 48
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 17,
        "lineEnd": 17,
        "columnStart": 9,
        "columnEnd": 40
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 20,
        "lineEnd": 20,
        "columnStart": 9,
        "columnEnd": 76
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 23,
        "lineEnd": 23,
        "columnStart": 9,
        "columnEnd": 91
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 26,
        "lineEnd": 26,
        "columnStart": 9,
        "columnEnd": 58
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 29,
        "lineEnd": 29,
        "columnStart": 9,
        "columnEnd": 32
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 12,
        "lineEnd": 12,
        "columnStart": 9,
        "columnEnd": 42
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 13,
        "lineEnd": 13,
        "columnStart": 9,
        "columnEnd": 62
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 14,
        "lineEnd": 14,
        "columnStart": 9,
        "columnEnd": 39
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 15,
        "lineEnd": 15,
        "columnStart": 9,
        "columnEnd": 42
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 16,
        "lineEnd": 16,
        "columnStart": 9,
        "columnEnd": 48
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 17,
        "lineEnd": 17,
        "columnStart": 9,
        "columnEnd": 40
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 20,
        "lineEnd": 20,
        "columnStart": 9,
        "columnEnd": 76
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 23,
        "lineEnd": 23,
        "columnStart": 9,
        "columnEnd": 91
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 26,
        "lineEnd": 26,
        "columnStart": 9,
        "columnEnd": 58
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 29,
        "lineEnd": 29,
        "columnStart": 9,
        "columnEnd": 32
      }
    }
  ],
  "repairedSmells": [
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 12,
        "lineEnd": 12,
        "columnStart": 9,
        "columnEnd": 66
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 13,
        "lineEnd": 13,
        "columnStart": 9,
        "columnEnd": 62
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 14,
        "lineEnd": 14,
        "columnStart": 9,
        "columnEnd": 63
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 15,
        "lineEnd": 15,
        "columnStart": 9,
        "columnEnd": 66
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 16,
        "lineEnd": 16,
        "columnStart": 9,
        "columnEnd": 72
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 17,
        "lineEnd": 17,
        "columnStart": 9,
        "columnEnd": 64
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 20,
        "lineEnd": 20,
        "columnStart": 9,
        "columnEnd": 100
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 23,
        "lineEnd": 23,
        "columnStart": 9,
        "columnEnd": 115
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 26,
        "lineEnd": 26,
        "columnStart": 9,
        "columnEnd": 58
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 29,
        "lineEnd": 29,
        "columnStart": 9,
        "columnEnd": 56
      }
    }
  ],
  "repairedDockerfile": "# start with a reasonable image. Debian 9 stretch is what's on the POSIX testing VM\nFROM ocaml/opam2:debian-9\n\n# silence apt\n# TODO this still isn't silencing it :(\nENV DEBIAN_FRONTEND=noninteractive\n\n# we frontload installation so that things that inherit from us don't need network access\n# we also (inadvisedly) do an update, but we'll ask for particular shell versions\nRUN sudo apt-get update\n\n# other shells we'll want\nRUN sudo apt-get install --no-install-recommends -y dash=0.5.8-2.4 && rm -rf /var/lib/apt/lists/*;\nRUN sudo apt-get install -y --no-install-recommends bash=4.4-5 && rm -rf /var/lib/apt/lists/*;\nRUN sudo apt-get install --no-install-recommends -y yash=2.43-1 && rm -rf /var/lib/apt/lists/*;\nRUN sudo apt-get install --no-install-recommends -y zsh=5.3.1-4+b2 && echo 'emulate sh' >~/.zshrc && rm -rf /var/lib/apt/lists/*;\nRUN sudo apt-get install --no-install-recommends -y ksh=93u+20120801-3.1 && rm -rf /var/lib/apt/lists/*;\nRUN sudo apt-get install --no-install-recommends -y mksh=54-2+b4 && rm -rf /var/lib/apt/lists/*;\n\n# for OSH\nRUN sudo apt-get install --no-install-recommends -y python2.7 python python-dev time libreadline-dev && rm -rf /var/lib/apt/lists/*;\n\n# system support for libdash; libgmp for zarith for lem\nRUN sudo apt-get install --no-install-recommends -y autoconf autotools-dev libtool pkg-config libffi-dev libgmp-dev && rm -rf /var/lib/apt/lists/*;\n\n# need expect for the POSIX test suite\nRUN sudo apt-get install -y --no-install-recommends expect && rm -rf /var/lib/apt/lists/*;\n\n# need gawk for POSIX test sutie tests tp448 and tp450; will be used POSIXLY_CORRECT\nRUN sudo apt-get install --no-install-recommends -y gawk && rm -rf /var/lib/apt/lists/*;\n\n# camlp4 won't work in 4.08 right now 2019-06-18\nRUN opam switch 4.07\n\n# make sure we have ocamlfind and ocamlbuild\nRUN opam install ocamlfind ocamlbuild\n\n# set up FFI for libdash; num library for lem; extunix for shell syscalls\nRUN opam pin add ctypes 0.11.5\nRUN opam install ctypes-foreign\nRUN opam install num\nRUN opam install extunix\n\n################################################################################\n# okay, we've downloaded and installed everything.\n################################################################################\n\n# build Oil...\nWORKDIR /home/opam\n\nADD --chown=opam:opam oil oil\nRUN cd oil; ./configure --build=\"$(dpkg-architecture --query DEB_BUILD_GNU_TYPE)\"; build/dev.sh minimal\nRUN sed -i 's#REPO_ROOT=.*#REPO_ROOT=/home/opam/oil#' /home/opam/oil/bin/osh\nRUN sudo ln -sf /home/opam/oil/bin/osh /usr/local/bin/osh\n\n# set up lem\nADD --chown=opam:opam lem lem\nRUN cd lem/ocaml-lib; opam config exec -- make install_dependencies\nRUN cd lem; opam config exec -- make\nRUN cd lem; opam config exec -- make install\nENV PATH=\"/home/opam/lem/bin:${PATH}\"\nENV LEMLIB=\"/home/opam/lem/library\"\n\n# copy in repo files for libdash to the WORKDIR (should be /home/opam)\n# we do this as late as possible so we don't have to redo the slow stuff above\nADD --chown=opam:opam libdash libdash\n\n# build libdash, expose shared object\nRUN cd libdash; ./autogen.sh && ./configure --build=\"$(dpkg-architecture --query DEB_BUILD_GNU_TYPE)\" --prefix=/usr --libdir=/usr/lib/x86_64-linux-gnu\nRUN cd libdash; make\nRUN cd libdash; sudo make install\n# build ocaml bindings\nRUN cd libdash/ocaml; opam config exec -- make && opam config exec -- make install\n\n# copy in repo files for smoosh to the WORKDIR\n\nADD --chown=opam:opam src src\nADD --chown=opam:opam README.md .\n\n# build smoosh\nRUN cd src; opam config exec -- make all all.byte\n\n# install smoosh\nRUN sudo cp /home/opam/src/smoosh /bin/smoosh\n\nENTRYPOINT [ \"opam\", \"config\", \"exec\", \"--\" ]\nCMD [ \"bash\" ]\n"
}