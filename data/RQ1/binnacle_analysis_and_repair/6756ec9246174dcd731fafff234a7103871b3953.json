{
  "startTime": 1674246754030,
  "endTime": 1674246754650,
  "originalSmells": [
    {
      "rule": "configureShouldUseBuildFlag",
      "position": {
        "lineStart": 66,
        "lineEnd": 131,
        "columnStart": 5,
        "columnEnd": 19
      }
    },
    {
      "rule": "apkAddUseNoCache",
      "position": {
        "lineStart": 10,
        "lineEnd": 12,
        "columnStart": 5,
        "columnEnd": 8
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "FROM alpine:3.9\n\nLABEL repository.hub=\"alexmasterov/alpine-php:7.3\" \\\n      repository.url=\"https://github.com/AlexMasterov/dockerfiles\" \\\n      maintainer=\"Alex Masterov <alex.masterow@gmail.com>\"\n\nARG PHP_VERSION=7.3.6\nARG PHP_CONFIG=/etc/php\n\nRUN set -x \\\n  && apk add --no-cache --update \\\n    ssmtp \\\n    tini \\\n  && addgroup -g 82 -S www-data \\\n  && adduser -u 82 -S -D -h /var/cache/www-data -s /sbin/nologin -G www-data www-data\n\nRUN set -x \\\n  && apk add --virtual .php-build-dependencies \\\n    argon2-dev \\\n    autoconf \\\n    binutils \\\n    bison \\\n    bzip2-dev \\\n    curl \\\n    curl-dev \\\n    file \\\n    freetype-dev \\\n    g++ \\\n    gcc \\\n    git \\\n    icu-dev \\\n    jpeg-dev \\\n    libmcrypt-dev \\\n    libpng-dev \\\n    libsodium-dev \\\n    libtool \\\n    libwebp-dev \\\n    libxml2-dev \\\n    libxslt-dev \\\n    libzip-dev \\\n    make \\\n    pcre2-dev \\\n    postgresql-dev \\\n    re2c \\\n    readline-dev \\\n    sqlite-dev \\\n  && : \"---------- Proper iconv ----------\" \\\n  && apk add --no-cache --virtual .ext-runtime-dependencies \\\n    --repository https://nl.alpinelinux.org/alpine/edge/community/ \\\n    gnu-libiconv-dev \\\n  && : \"---------- Replace binary and headers ----------\" \\\n  && (mv /usr/bin/gnu-iconv /usr/bin/iconv; \\\n      mv /usr/include/gnu-libiconv/*.h /usr/include; rm -rf /usr/include/gnu-libiconv) \\\n  && : \"---------- Proper libpcre2 ----------\" \\\n  && (cd /usr/lib; \\\n      ln -sf libpcre2-posix.a libpcre2.a; ln -sf libpcre2-posix.so libpcre2.so) \\\n  && : \"---------- Build flags ----------\" \\\n  && export LDFLAGS=\"-Wl,-O2 -Wl,--hash-style=both -pie\" \\\n  && export CFLAGS=\"-O2 -march=native -fstack-protector-strong -fpic -fpie\" \\\n  && export CPPFLAGS=${CFLAGS} \\\n  && export MAKEFLAGS=\"-j $(expr $(getconf _NPROCESSORS_ONLN) \\+ 1)\" \\\n  && : \"---------- PHP ----------\" \\\n  && PHP_SOURCE=\"https://secure.php.net/get/php-${PHP_VERSION}.tar.xz/from/this/mirror\" \\\n  && curl -fSL --connect-timeout 30 ${PHP_SOURCE} | tar xJ -C /tmp \\\n  && cd /tmp/php-${PHP_VERSION} \\\n  && : \"---------- Build ----------\" \\\n  && ./configure --build=\"$(dpkg-architecture --query DEB_BUILD_GNU_TYPE)\" \\\n    --prefix=/usr \\\n    --sysconfdir=${PHP_CONFIG} \\\n    --with-config-file-path=${PHP_CONFIG} \\\n    --with-config-file-scan-dir=${PHP_CONFIG}/conf.d \\\n    --without-pear \\\n    --disable-cgi \\\n    --disable-debug \\\n    --disable-ipv6 \\\n    --disable-phpdbg \\\n    --disable-rpath \\\n    --disable-static \\\n    --enable-bcmath \\\n    --enable-calendar \\\n    --enable-dom \\\n    --enable-exif \\\n    --enable-fd-setsize=$(ulimit -n) \\\n    --enable-fpm \\\n      --with-fpm-group=www-data \\\n      --with-fpm-user=www-data \\\n    --enable-ftp \\\n    --enable-inline-optimization \\\n    --enable-intl \\\n    --enable-json \\\n    --enable-libxml \\\n      --with-libxml-dir=/usr \\\n    --enable-mbregex \\\n    --enable-mbstring \\\n    --enable-opcache \\\n      --enable-huge-code-pages \\\n      --enable-opcache-file \\\n    --enable-option-checking=fatal \\\n    --enable-pcntl \\\n    --enable-phar \\\n    --enable-session \\\n    --enable-shmop \\\n    --enable-soap \\\n    --enable-sockets \\\n    --enable-xml \\\n    --enable-xmlreader \\\n    --enable-xmlwriter \\\n    --with-bz2=/usr \\\n    --with-curl=/usr \\\n    --with-sodium=/usr \\\n    --with-gd \\\n      --with-freetype-dir=/usr \\\n      --with-jpeg-dir=/usr \\\n      --with-png-dir=/usr \\\n      --with-webp-dir=/usr \\\n      --with-xpm-dir=no \\\n      --with-zlib-dir=/usr \\\n    --with-iconv=/usr \\\n    --with-libzip=/usr \\\n    --with-mhash \\\n    --with-openssl=/usr \\\n      --with-system-ciphers \\\n    --with-password-argon2 \\\n    --with-pcre-regex \\\n      --with-pcre-jit \\\n    --with-pdo-mysql=mysqlnd \\\n    --with-pdo-pgsql \\\n    --with-pdo-sqlite \\\n    --with-pgsql \\\n    --with-readline=/usr \\\n    --with-xmlrpc \\\n    --with-xsl=/usr \\\n  && make \\\n  && make install \\\n  && runtimeDeps=\"$( \\\n    scanelf --needed --nobanner --recursive /usr/sbin/php-fpm \\\n      | awk '{ gsub(/,/, \"\\nso:\", $2); print \"so:\" $2 }' \\\n      | sort -u \\\n      | xargs -r apk info --installed \\\n      | sort -u \\\n\t)\" \\\n  && apk add --virtual .php-runtime-dependencies \\\n    ${runtimeDeps} \\\n  && : \"---------- Removing build dependencies, clean temporary files ----------\" \\\n  && apk del .php-build-dependencies \\\n  && rm -rf /var/cache/apk/* /var/tmp/* /tmp/*\n\nENTRYPOINT [\"tini\", \"--\"]\nCMD [\"php-fpm\"]\n"
}