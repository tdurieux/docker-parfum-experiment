{
  "startTime": 1674245824938,
  "endTime": 1674245825261,
  "originalSmells": [
    {
      "rule": "mkdirUsrSrcThenRemove",
      "position": {
        "lineStart": 69,
        "lineEnd": 69,
        "columnStart": 1,
        "columnEnd": 23
      }
    },
    {
      "rule": "gpgUseBatchFlag",
      "position": {
        "lineStart": 29,
        "lineEnd": 29,
        "columnStart": 2,
        "columnEnd": 64
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "#upstream https://github.com/docker-library/gcc/raw/0a7f7464baaa3a24cdd35e1173d84ab94e32a14d/7/Dockerfile\nFROM buildpack-deps:stretch\n\nRUN set -ex; \\\n\tif ! command -v gpg > /dev/null; then \\\n\t\tapt-get update; \\\n\t\tapt-get install -y --no-install-recommends \\\n\t\t\tgnupg \\\n\t\t\tdirmngr \\\n\t\t; \\\n\t\trm -rf /var/lib/apt/lists/*; \\\n\tfi\n\n# https://gcc.gnu.org/mirrors.html\nENV GPG_KEYS \\\n# 1024D/745C015A 1999-11-09 Gerald Pfeifer <gerald@pfeifer.com>\n\tB215C1633BCA0477615F1B35A5B3A004745C015A \\\n# 1024D/B75C61B8 2003-04-10 Mark Mitchell <mark@codesourcery.com>\n\tB3C42148A44E6983B3E4CC0793FA9B1AB75C61B8 \\\n# 1024D/902C9419 2004-12-06 Gabriel Dos Reis <gdr@acm.org>\n\t90AA470469D3965A87A5DCB494D03953902C9419 \\\n# 1024D/F71EDF1C 2000-02-13 Joseph Samuel Myers <jsm@polyomino.org.uk>\n\t80F98B2E0DAB6C8281BDF541A7C8C3B2F71EDF1C \\\n# 2048R/FC26A641 2005-09-13 Richard Guenther <richard.guenther@gmail.com>\n\t7F74F97C103468EE5D750B583AB00996FC26A641 \\\n# 1024D/C3C45C06 2004-04-21 Jakub Jelinek <jakub@redhat.com>\n\t33C235A34C46AA3FFB293709A328C3A2C3C45C06\nRUN set -ex; \\\n\tfor key in $GPG_KEYS; do \\\n\t\tgpg --batch --keyserver ha.pool.sks-keyservers.net --recv-keys \"$key\"; \\\n\tdone\n\n# https://gcc.gnu.org/mirrors.html\nENV GCC_MIRRORS \\\n\t\thttps://ftpmirror.gnu.org/gcc \\\n\t\thttps://bigsearcher.com/mirrors/gcc/releases \\\n\t\thttps://mirrors-usa.go-parts.com/gcc/releases \\\n\t\thttps://mirrors.concertpass.com/gcc/releases \\\n\t\thttp://www.netgull.com/gcc/releases\n\n# Last Modified: 2018-01-25\nENV GCC_VERSION 7.3.0\n# Docker EOL: 2019-01-25\n\nRUN set -ex; \\\n\n\tsavedAptMark=\"$(apt-mark showmanual)\"; \\\n\tapt-get update; \\\n\tapt-get install -y --no-install-recommends \\\n\t\tdpkg-dev \\\n\t\tflex \\\n\t; \\\n\trm -r /var/lib/apt/lists/*; \\\n\n\t_fetch() { \\\n\t\tlocal fetch=\"$1\"; shift; \\\n\t\tlocal file=\"$1\"; shift; \\\n\t\tfor mirror in $GCC_MIRRORS; do \\\n\t\t\tif curl -fL \"$mirror/$fetch\" -o \"$file\"; then \\\n\t\t\t\treturn 0; \\\n\t\t\tfi; \\\n\t\tdone; \\\n\t\techo >&2 \"error: failed to download '$fetch' from several mirrors\"; \\\n\t\treturn 1; \\\n\t}; \\\n\n\t_fetch \"gcc-$GCC_VERSION/gcc-$GCC_VERSION.tar.xz.sig\" 'gcc.tar.xz.sig'; \\\n\t_fetch \"gcc-$GCC_VERSION/gcc-$GCC_VERSION.tar.xz\" 'gcc.tar.xz'; \\\n\tgpg --batch --verify gcc.tar.xz.sig gcc.tar.xz; \\\n\tmkdir -p /usr/src/gcc; rm -rf /usr/src/gcc \\\n\ttar -xf gcc.tar.xz -C /usr/src/gcc --strip-components=1; \\\n\trm gcc.tar.xz*; \\\n\n\tcd /usr/src/gcc; \\\n\n# \"download_prerequisites\" pulls down a bunch of tarballs and extracts them,\n# but then leaves the tarballs themselves lying around\n\t./contrib/download_prerequisites; \\\n\t{ rm *.tar.* || true; }; \\\n\n# explicitly update autoconf config.guess and config.sub so they support more arches/libcs\n\tfor f in config.guess config.sub; do \\\n\t\twget -O \"$f\" \"https://git.savannah.gnu.org/cgit/config.git/plain/$f?id=7d3d27baf8107b630586c962c057e22149653deb\"; \\\n# find any more (shallow) copies of the file we grabbed and update them too\n\t\tfind -mindepth 2 -name \"$f\" -exec cp -v \"$f\" '{}' ';'; \\\n\tdone; \\\n\n\tdir=\"$(mktemp -d)\"; \\\n\tcd \"$dir\"; \\\n\n\textraConfigureArgs=''; \\\n\tdpkgArch=\"$(dpkg --print-architecture)\"; \\\n\tcase \"$dpkgArch\" in \\\n# with-arch: https://anonscm.debian.org/viewvc/gcccvs/branches/sid/gcc-6/debian/rules2?revision=9450&view=markup#l491\n# with-float: https://anonscm.debian.org/viewvc/gcccvs/branches/sid/gcc-6/debian/rules.defs?revision=9487&view=markup#l416\n# with-mode: https://anonscm.debian.org/viewvc/gcccvs/branches/sid/gcc-6/debian/rules.defs?revision=9487&view=markup#l376\n\t\tarmel) \\\n\t\t\textraConfigureArgs=\"$extraConfigureArgs --with-arch=armv4t --with-float=soft\" \\\n\t\t\t;; \\\n\t\tarmhf) \\\n\t\t\textraConfigureArgs=\"$extraConfigureArgs --with-arch=armv7-a --with-float=hard --with-fpu=vfpv3-d16 --with-mode=thumb\" \\\n\t\t\t;; \\\n\t\t\\\n# with-arch-32: https://anonscm.debian.org/viewvc/gcccvs/branches/sid/gcc-6/debian/rules2?revision=9450&view=markup#l590\n\t\ti386) \\\n\t\t\tosVersionID=\"$(set -e; . /etc/os-release; echo \"$VERSION_ID\")\"; \\\n\t\t\tcase \"$osVersionID\" in \\\n\t\t\t\t8) extraConfigureArgs=\"$extraConfigureArgs --with-arch-32=i586\" ;; \\\n\t\t\t\t*) extraConfigureArgs=\"$extraConfigureArgs --with-arch-32=i686\" ;; \\\n\t\t\tesac; \\\n# TODO for some reason, libgo + i386 fails on https://github.com/gcc-mirror/gcc/blob/gcc-7_1_0-release/libgo/runtime/proc.c#L154\n# \"error unknown case for SETCONTEXT_CLOBBERS_TLS\"\n\t\t\t;; \\\n\tesac; \\\n\n\tgnuArch=\"$(dpkg-architecture --query DEB_BUILD_GNU_TYPE)\"; \\\n\t/usr/src/gcc/configure \\\n\t\t--build=\"$gnuArch\" \\\n\t\t--disable-multilib \\\n\t\t--enable-languages=c,c++,fortran,go \\\n\t\t$extraConfigureArgs \\\n\t; \\\n\tmake -j \"$(nproc)\"; \\\n\tmake install-strip; \\\n\n\tcd ..; \\\n\n\trm -rf \"$dir\"; \\\n\n\tapt-mark auto '.*' > /dev/null; \\\n\t[ -z \"$savedAptMark\" ] || apt-mark manual $savedAptMark; \\\n\tapt-get purge -y --auto-remove -o APT::AutoRemove::RecommendsImportant=false\n\n# gcc installs .so files in /usr/local/lib64...\nRUN set -ex; \\\n\techo '/usr/local/lib64' > /etc/ld.so.conf.d/local-lib64.conf; \\\n\tldconfig -v\n\n# ensure that alternatives are pointing to the new compiler and that old one is no longer used\nRUN set -ex; \\\n\tdpkg-divert --divert /usr/bin/gcc.orig --rename /usr/bin/gcc; \\\n\tdpkg-divert --divert /usr/bin/g++.orig --rename /usr/bin/g++; \\\n\tdpkg-divert --divert /usr/bin/gfortran.orig --rename /usr/bin/gfortran; \\\n\tupdate-alternatives --install /usr/bin/cc cc /usr/local/bin/gcc 999\n"
}