{
  "startTime": 1674248601878,
  "endTime": 1674248602762,
  "originalSmells": [
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 66,
        "lineEnd": 66,
        "columnStart": 4,
        "columnEnd": 28
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 67,
        "lineEnd": 67,
        "columnStart": 4,
        "columnEnd": 22
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 71,
        "lineEnd": 71,
        "columnStart": 4,
        "columnEnd": 31
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 72,
        "lineEnd": 72,
        "columnStart": 4,
        "columnEnd": 28
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 73,
        "lineEnd": 73,
        "columnStart": 4,
        "columnEnd": 33
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 78,
        "lineEnd": 78,
        "columnStart": 4,
        "columnEnd": 30
      }
    },
    {
      "rule": "aptGetInstallUseY",
      "position": {
        "lineStart": 15,
        "lineEnd": 15,
        "columnStart": 8,
        "columnEnd": 77
      }
    },
    {
      "rule": "aptGetInstallUseY",
      "position": {
        "lineStart": 17,
        "lineEnd": 17,
        "columnStart": 8,
        "columnEnd": 52
      }
    },
    {
      "rule": "aptGetInstallUseY",
      "position": {
        "lineStart": 44,
        "lineEnd": 44,
        "columnStart": 4,
        "columnEnd": 42
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 15,
        "lineEnd": 15,
        "columnStart": 8,
        "columnEnd": 77
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 17,
        "lineEnd": 17,
        "columnStart": 8,
        "columnEnd": 52
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 22,
        "lineEnd": 39,
        "columnStart": 4,
        "columnEnd": 7
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 44,
        "lineEnd": 44,
        "columnStart": 4,
        "columnEnd": 42
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 55,
        "lineEnd": 57,
        "columnStart": 22,
        "columnEnd": 17
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 70,
        "lineEnd": 70,
        "columnStart": 4,
        "columnEnd": 46
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 87,
        "lineEnd": 126,
        "columnStart": 4,
        "columnEnd": 19
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 22,
        "lineEnd": 39,
        "columnStart": 4,
        "columnEnd": 7
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 44,
        "lineEnd": 44,
        "columnStart": 4,
        "columnEnd": 42
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 70,
        "lineEnd": 70,
        "columnStart": 4,
        "columnEnd": 46
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 87,
        "lineEnd": 126,
        "columnStart": 4,
        "columnEnd": 19
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 193,
        "lineEnd": 193,
        "columnStart": 4,
        "columnEnd": 51
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 15,
        "lineEnd": 15,
        "columnStart": 8,
        "columnEnd": 77
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 17,
        "lineEnd": 17,
        "columnStart": 8,
        "columnEnd": 52
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 22,
        "lineEnd": 39,
        "columnStart": 4,
        "columnEnd": 7
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 44,
        "lineEnd": 44,
        "columnStart": 4,
        "columnEnd": 42
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 55,
        "lineEnd": 57,
        "columnStart": 22,
        "columnEnd": 17
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 70,
        "lineEnd": 70,
        "columnStart": 4,
        "columnEnd": 46
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 87,
        "lineEnd": 126,
        "columnStart": 4,
        "columnEnd": 19
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 193,
        "lineEnd": 193,
        "columnStart": 4,
        "columnEnd": 51
      }
    }
  ],
  "repairedSmells": [
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 21,
        "lineEnd": 38,
        "columnStart": 4,
        "columnEnd": 7
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 43,
        "lineEnd": 43,
        "columnStart": 4,
        "columnEnd": 69
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 69,
        "lineEnd": 69,
        "columnStart": 4,
        "columnEnd": 70
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 86,
        "lineEnd": 125,
        "columnStart": 4,
        "columnEnd": 19
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 192,
        "lineEnd": 192,
        "columnStart": 4,
        "columnEnd": 51
      }
    }
  ],
  "repairedDockerfile": "FROM nvidia/cuda:10.0-cudnn7-devel-ubuntu18.04\n\nRUN apt-get update && apt-get install -y --no-install-recommends \\\n        build-essential \\\n        curl \\\n        pkg-config \\\n        rsync \\\n        software-properties-common \\\n        unzip \\\n        && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n\nRUN apt-get update && \\\n        apt-get install -y --no-install-recommends nvinfer-runtime-trt-repo-ubuntu1804-5.0.2-ga-cuda10.0 && \\\n        apt-get update && \\\n        apt-get install -y --no-install-recommends libnvinfer5=5.0.2-1+cuda10.0 && rm -rf /var/lib/apt/lists/*;\n\nRUN file=\"$(ls -1 /usr/local/)\" && echo $file\n\nRUN apt-get -y update\nRUN apt-get install --no-install-recommends -y --fix-missing \\\n    cmake \\\n    gfortran \\\n    git \\\n    wget \\\n    curl \\\n    graphicsmagick \\\n    libgraphicsmagick1-dev \\\n    libavcodec-dev \\\n    libavformat-dev \\\n    libboost-all-dev \\\n    libgtk2.0-dev \\\n    libjpeg-dev \\\n    liblapack-dev \\\n    libswscale-dev \\\n    pkg-config \\\n    python3-numpy \\\n    zip \\\n    && apt-get clean && rm -rf /tmp/* /var/tmp/* && rm -rf /var/lib/apt/lists/*;\n\nRUN add-apt-repository ppa:jonathonf/python-3.6\nRUN apt-get update\nRUN apt-get install -y --no-install-recommends python3.6 libpython3.6 && rm -rf /var/lib/apt/lists/*;\n\n# For CUDA profiling, TensorFlow requires CUPTI.\nENV LD_LIBRARY_PATH /usr/local/cuda/extras/CUPTI/lib64:$LD_LIBRARY_PATH\n\nARG PYTHON=python3\nARG PIP=pip3\n\n# See http://bugs.python.org/issue19846\nENV LANG C.UTF-8\n\nRUN apt-get update && apt-get install --no-install-recommends -y \\\n    ${PYTHON} \\\n    ${PYTHON}-pip && rm -rf /var/lib/apt/lists/*;\n\nRUN ${PIP} --no-cache-dir install --upgrade \\\n    pip \\\n    setuptools\n\nRUN ${PIP} install https://download.pytorch.org/whl/cu100/torch-1.0.1.post2-cp36-cp36m-linux_x86_64.whl\nRUN ${PIP} install torchvision\n\nRUN pip install --no-cache-dir cupy-cuda100\nRUN pip install --no-cache-dir pycuda\n\n# Install NVIDIA Rapids and it's deps\nRUN apt install --no-install-recommends libopenblas-base libomp-dev -y && rm -rf /var/lib/apt/lists/*;\nRUN pip install --no-cache-dir cugraph-cuda100\nRUN pip install --no-cache-dir cuml-cuda100\nRUN pip install --no-cache-dir cudf-cuda100==0.6\n\n# Some TF tools expect a \"python\" binary\nRUN ln -s $(which ${PYTHON}) /usr/local/bin/python\n\nRUN pip install --no-cache-dir tensorflow-gpu\n\n#COPY bashrc /etc/bash.bashrc\n#RUN chmod a+rwx /etc/bash.bashrc\n\nRUN ${PIP} --no-cache-dir install jupyter matplotlib pyinstrument\n# RUN ${PIP} install jupyter matplotlib o pencv-python opencv-contrib-python pyinstrument\n\n# Core linux dependencies.\nRUN apt-get install --no-install-recommends -y --fix-missing \\\n        build-essential \\\n        cmake \\\n     curl \\\n\tgfortran \\\n     graphicsmagick \\\n        git \\\n        wget \\\n        unzip \\\n        yasm \\\n        pkg-config \\\n        libswscale-dev \\\n        libtbb2 \\\n        libtbb-dev \\\n        libjpeg-dev \\\n        libpng-dev \\\n        libtiff-dev \\\n\tlibgraphicsmagick1-dev \\\n        libavformat-dev \\\n        libhdf5-dev \\\n        libpq-dev \\\n\tlibgraphicsmagick1-dev \\\n\tlibavcodec-dev \\\n\tlibboost-all-dev \\\n\tlibgtk2.0-dev \\\n\tliblapack-dev \\\n        liblapacke-dev \\\n\tlibswscale-dev \\\n\tlibcanberra-gtk-module \\\n        libboost-dev \\\n        libboost-all-dev \\\n        libeigen3-dev \\\n        # python3.6 \\\n\tpython3-dev \\\n\tpython3-numpy \\\n\tpython3-scipy \\\n\tsoftware-properties-common \\\n\tzip \\\n        vim \\\n        qt5-default \\\n\t&& apt-get clean && rm -rf /tmp/* /var/tmp/* && rm -rf /var/lib/apt/lists/*;\n\nRUN ${PIP} --no-cache-dir install \\\n    hdf5storage \\\n    h5py \\\n    py3nvml \\\n    scikit-image \\\n    scikit-learn\n\nWORKDIR /\nRUN wget -O opencv.zip https://github.com/opencv/opencv/archive/4.0.1.zip\nRUN wget -O opencv_contrib.zip https://github.com/opencv/opencv_contrib/archive/4.0.1.zip\nRUN unzip opencv.zip\nRUN unzip opencv_contrib.zip\nRUN mv opencv-4.0.1 opencv\nRUN mv opencv_contrib-4.0.1 opencv_contrib\nRUN mkdir /opencv/build\nWORKDIR /opencv/build\n\n\nRUN cmake -DBUILD_TIFF=ON \\\n\t\t  -DBUILD_opencv_java=OFF \\\n\t\t  -DWITH_CUDA=ON \\\n\t\t  -DENABLE_FAST_MATH=1 \\\n\t\t  -DCUDA_FAST_MATH=1 \\\n\t\t  -DWITH_CUBLAS=1 \\\n\t\t  -DENABLE_AVX=ON \\\n\t\t  -DWITH_OPENGL=ON \\\n\t\t#   -DWITH_OPENCL=OFF \\\n\t\t  -DWITH_IPP=ON \\\n\t\t  -DWITH_TBB=ON \\\n\t\t  -DWITH_EIGEN=ON \\\n\t\t  -DWITH_V4L=ON \\\n\t\t#   -DBUILD_TESTS=OFF \\\n\t\t#   -DBUILD_PERF_TESTS=OFF \\\n\t\t  -DCMAKE_BUILD_TYPE=RELEASE \\\n\t\t  -DCMAKE_INSTALL_PREFIX=$(python -c \"import sys; print(sys.prefix)\") \\\n\t\t  -DPYTHON_EXECUTABLE=$(which python) \\\n\t\t  -DPYTHON_INCLUDE_DIR=$(python -c \"from distutils.sysconfig import get_python_inc; print(get_python_inc())\") \\\n\t\t  -DPYTHON_PACKAGES_PATH=$(python -c \"from distutils.sysconfig import get_python_lib; print(get_python_lib())\") .. \\\n                  -DINSTALL_PYTHON_EXAMPLES=ON \\\n                  -DINSTALL_C_EXAMPLES=OFF \\\n                  -DOPENCV_ENABLE_NONFREE=ON \\\n                  -DOPENCV_EXTRA_MODULES_PATH=/opencv_contrib/modules \\\n                  -DBUILD_EXAMPLES=ON \\\n                  -D CUDA_TOOLKIT_ROOT_DIR=/opt/cuda/9.0 \\\n                  -DWITH_QT=ON ..\nRUN make -j4 \\\n        && make install \\\n\t&& rm /opencv.zip \\\n        && rm /opencv_contrib.zip \\\n\t&& rm -rf /opencv \\\n        && rm -rf /opencv_contrib\n\nWORKDIR /\n\n# dlib\nRUN cd ~ && \\\n    mkdir -p dlib && \\\n    git clone -b 'v19.16' --single-branch https://github.com/davisking/dlib.git dlib/ && \\\n    cd  dlib/ && \\\n    python3 setup.py install --yes USE_AVX_INSTRUCTIONS --yes DLIB_USE_CUDA --clean\n\n\nRUN mkdir -p /tf/tensorflow-tutorials && chmod -R a+rwx /tf/\nRUN mkdir /.local && chmod a+rwx /.local\nRUN apt-get install -y --no-install-recommends wget && rm -rf /var/lib/apt/lists/*;\nWORKDIR /tf/tensorflow-tutorials\nRUN wget https://raw.githubusercontent.com/tensorflow/docs/master/site/en/tutorials/keras/basic_classification.ipynb\nRUN wget https://raw.githubusercontent.com/tensorflow/docs/master/site/en/tutorials/keras/basic_text_classification.ipynb\nRUN wget https://raw.githubusercontent.com/tensorflow/docs/master/site/en/tutorials/keras/overfit_and_underfit.ipynb\nRUN wget https://raw.githubusercontent.com/tensorflow/docs/master/site/en/tutorials/keras/save_and_restore_models.ipynb\n\nRUN apt-get autoremove -y && apt-get remove -y wget\nWORKDIR /tf\nEXPOSE 8888 6006\n\nRUN useradd -ms /bin/bash container_user\n\nRUN ${PYTHON} -m ipykernel.kernelspec\n\nCMD [\"bash\", \"-c\", \"source /etc/bash.bashrc && jupyter notebook --notebook-dir=/tf --ip 0.0.0.0 --no-browser --allow-root --NotebookApp.custom_display_url='http://localhost:8888'\"]\n"
}