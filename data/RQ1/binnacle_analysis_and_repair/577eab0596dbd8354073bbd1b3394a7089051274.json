{
  "startTime": 1674249289786,
  "endTime": 1674249289961,
  "originalSmells": [
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 36,
        "lineEnd": 36,
        "columnStart": 4,
        "columnEnd": 46
      }
    },
    {
      "rule": "curlUseHttpsUrl",
      "position": {
        "lineStart": 40,
        "lineEnd": 40,
        "columnStart": 4,
        "columnEnd": 71
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 13,
        "lineEnd": 13,
        "columnStart": 5,
        "columnEnd": 33
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 14,
        "lineEnd": 22,
        "columnStart": 5,
        "columnEnd": 9
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 13,
        "lineEnd": 13,
        "columnStart": 5,
        "columnEnd": 33
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 14,
        "lineEnd": 22,
        "columnStart": 5,
        "columnEnd": 9
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "# Docker - Drupal+CiviCRM\n#\n# Use official Drupal7+FPM as base image for build\nFROM drupal:7-fpm\n\n# VERSION 0.0.1\nMAINTAINER William Hale <salt@snowdrift.coop>\n\n# Disable PHP daemon mode\nRUN sed -i -e \"s/;daemonize\\s*=\\s*yes/daemonize = no/g\" /usr/local/etc/php-fpm.conf\n\n# Install Packages\nRUN DEBIAN_FRONTEND=\"noninteractive\" apt-get update \\\n  && apt-get install --no-install-recommends -y apt-utils \\\n  && apt-get install --no-install-recommends -y \\\n    cron \\\n    libc-client-dev \\\n    libkrb5-dev \\\n    libicu-dev \\\n    libmcrypt-dev \\\n    libxml2-dev \\\n    mariadb-client \\\n    ssmtp && rm -rf /var/lib/apt/lists/*;\n\n# Install additional PHP extentions\nRUN docker-php-ext-configure imap --with-kerberos --with-imap-ssl \\\n  && docker-php-ext-install imap intl mcrypt mysqli soap\n\n# Install ssmtp\nCOPY ssmtp.conf /etc/ssmtp/ssmtp.conf\nRUN chown root:mail /etc/ssmtp/ssmtp.conf \\\n  && chmod 640 /etc/ssmtp/ssmtp.conf \\\n  && usermod -a -G mail www-data \\\n  && echo 'sendmail_path = \"/usr/sbin/ssmtp -t\"' > /usr/local/etc/php/conf.d/mail.ini\n\n# Install Composer\nRUN curl -f -sS https://getcomposer.org/installer | php \\\n  && mv composer.phar /usr/local/bin/composer\n\n# Install Drush\nRUN curl -fSL https://files.drush.org/drush.phar -o /usr/local/bin/drush \\\n  && chmod +x /usr/local/bin/drush \\\n  && curl -fSL https://raw.githubusercontent.com/civicrm/civicrm-drupal/7.x-master/drush/civicrm.drush.inc -o /usr/share/drush/commands/civicrm.drush.inc --create-dirs\n# COPY civicrm.drush.inc /usr/share/drush/commands/civicrm.drush.inc\n\n# Download CiviCRM\nENV CIVICRM_VERSION 4.7.17\nRUN curl -fSL \"https://download.civicrm.org/civicrm-${CIVICRM_VERSION}-drupal.tar.gz\" -o /var/www/civicrm.tar.gz\n\n# Install default error pages\nCOPY 404.html /var/www/html/404.html\nCOPY 50x.html /var/www/html/50x.html\n\n# Install maintenance scripts\nCOPY civi_install.sh /usr/local/bin/civi_install.sh\nCOPY civi_run.sh /usr/local/bin/civi_run.sh\nCOPY civi_upgrade.sh /usr/local/bin/civi_upgrade.sh\nRUN chmod +x /usr/local/bin/civi_install.sh \\\n  && chmod +x /usr/local/bin/civi_run.sh \\\n  && chmod +x /usr/local/bin/civi_upgrade.sh\n\n# Enable Cron\nCOPY civi_cron.sh /usr/local/bin/civi_cron.sh\nCOPY crontab /etc/cron.d/crontab\nRUN chmod +x /usr/local/bin/civi_cron.sh \\\n  && chmod +x /etc/cron.d/crontab \\\n  && crontab /etc/cron.d/crontab\n\n# Cleanup\nRUN apt-get clean \\\n  && rm -rf \\\n    /var/lib/apt/lists/* \\\n    /tmp/* \\\n    /var/tmp/*\n\nLABEL Description=\"Docker for Snowdrift.coop CRM. Debian Jessie+nginx+MariaDB+PHP5.6+Drupal7/Drush+CiviCRM\" \\\n  Version=\"0.0.1\"\n\nCMD [\"/usr/local/bin/civi_run.sh\"]\n"
}