{
  "startTime": 1674234672130,
  "endTime": 1674234675092,
  "originalSmells": [
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 286,
        "lineEnd": 286,
        "columnStart": 4,
        "columnEnd": 60
      }
    },
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 399,
        "lineEnd": 399,
        "columnStart": 4,
        "columnEnd": 56
      }
    },
    {
      "rule": "npmCacheCleanAfterInstall",
      "position": {
        "lineStart": 460,
        "lineEnd": 460,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "npmCacheCleanAfterInstall",
      "position": {
        "lineStart": 480,
        "lineEnd": 480,
        "columnStart": 4,
        "columnEnd": 29
      }
    },
    {
      "rule": "sha256sumEchoOneSpaces",
      "position": {
        "lineStart": 400,
        "lineEnd": 400,
        "columnStart": 5,
        "columnEnd": 63
      }
    },
    {
      "rule": "sha256sumEchoOneSpaces",
      "position": {
        "lineStart": 412,
        "lineEnd": 412,
        "columnStart": 5,
        "columnEnd": 68
      }
    },
    {
      "rule": "tarSomethingRmTheSomething",
      "position": {
        "lineStart": 73,
        "lineEnd": 73,
        "columnStart": 5,
        "columnEnd": 30
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 35,
        "lineEnd": 35,
        "columnStart": 5,
        "columnEnd": 37
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 263,
        "lineEnd": 263,
        "columnStart": 4,
        "columnEnd": 59
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 337,
        "lineEnd": 337,
        "columnStart": 4,
        "columnEnd": 30
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 403,
        "lineEnd": 403,
        "columnStart": 5,
        "columnEnd": 34
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 208,
        "lineEnd": 211,
        "columnStart": 4,
        "columnEnd": 56
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 263,
        "lineEnd": 263,
        "columnStart": 4,
        "columnEnd": 59
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 337,
        "lineEnd": 337,
        "columnStart": 4,
        "columnEnd": 30
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 403,
        "lineEnd": 403,
        "columnStart": 5,
        "columnEnd": 34
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 26,
        "lineEnd": 26,
        "columnStart": 5,
        "columnEnd": 57
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 27,
        "lineEnd": 27,
        "columnStart": 5,
        "columnEnd": 53
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 28,
        "lineEnd": 28,
        "columnStart": 5,
        "columnEnd": 56
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 29,
        "lineEnd": 29,
        "columnStart": 5,
        "columnEnd": 61
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 30,
        "lineEnd": 30,
        "columnStart": 5,
        "columnEnd": 67
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 31,
        "lineEnd": 31,
        "columnStart": 5,
        "columnEnd": 67
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 32,
        "lineEnd": 32,
        "columnStart": 5,
        "columnEnd": 51
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 33,
        "lineEnd": 33,
        "columnStart": 5,
        "columnEnd": 62
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 34,
        "lineEnd": 34,
        "columnStart": 5,
        "columnEnd": 56
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 35,
        "lineEnd": 35,
        "columnStart": 5,
        "columnEnd": 37
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 203,
        "lineEnd": 203,
        "columnStart": 5,
        "columnEnd": 89
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 208,
        "lineEnd": 211,
        "columnStart": 4,
        "columnEnd": 56
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 263,
        "lineEnd": 263,
        "columnStart": 4,
        "columnEnd": 59
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 337,
        "lineEnd": 337,
        "columnStart": 4,
        "columnEnd": 30
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 342,
        "lineEnd": 367,
        "columnStart": 5,
        "columnEnd": 16
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 403,
        "lineEnd": 403,
        "columnStart": 5,
        "columnEnd": 34
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 420,
        "lineEnd": 444,
        "columnStart": 29,
        "columnEnd": 69
      }
    }
  ],
  "repairedSmells": [
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 208,
        "lineEnd": 211,
        "columnStart": 4,
        "columnEnd": 56
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 263,
        "lineEnd": 263,
        "columnStart": 4,
        "columnEnd": 83
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 337,
        "lineEnd": 337,
        "columnStart": 4,
        "columnEnd": 54
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 403,
        "lineEnd": 403,
        "columnStart": 5,
        "columnEnd": 58
      }
    }
  ],
  "repairedDockerfile": "FROM appsvctest/php-build-5.6:latest as php5.6-build\nFROM appsvctest/php-build-7.0:latest as php7.0-build\nFROM appsvctest/php-build-7.2:latest as php7.2-build\nFROM appsvctest/python-3.6-build:latest as python-3.6-build\nFROM appsvctest/python-3.7-build:latest as python-3.7-build\n\nFROM buildpack-deps:jessie-curl as main\nMAINTAINER Nazim Lala <naziml@microsoft.com>\n\nENV DEBIAN_FRONTEND noninteractive\n\nCOPY mod_mono.tar /tmp\n\n# Install dependencies\nRUN apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 \\\n  --recv-keys 3FA7E0328081BFF6A14DA29AA6A19B38D3D831EF \\\n  && echo \"deb http://download.mono-project.com/repo/debian jessie/snapshots/5.0.0.100/. main\" > \\\n  /etc/apt/sources.list.d/mono-xamarin.list \\\n  && echo \"deb http://deb.debian.org/debian/ jessie main\" >> /etc/apt/sources.list \\\n  && echo \"deb-src http://deb.debian.org/debian/ jessie main\" >> /etc/apt/sources.list \\\n  && echo \"deb http://security.debian.org/ jessie/updates main\" >> /etc/apt/sources.list \\\n  && echo \"deb-src http://security.debian.org/ jessie/updates main\" >> /etc/apt/sources.list \\\n  && echo \"deb http://archive.debian.org/debian jessie-backports main\" >> /etc/apt/sources.list \\\n  && echo \"deb-src http://archive.debian.org/debian jessie-backports main\" >> /etc/apt/sources.list \\\n  && echo \"Acquire::Check-Valid-Until \\\"false\\\";\" > /etc/apt/apt.conf \\\n  && apt-get update \\\n  && apt-get install -y apt-utils --no-install-recommends \\\n  && apt-get install -y unzip --no-install-recommends \\\n  && apt-get install -y xz-utils --no-install-recommends \\\n  && apt-get install -y mono-complete --no-install-recommends \\\n  && apt-get install -y mono-apache-server4 --no-install-recommends \\\n  && apt-get install -y libapache2-mod-mono --no-install-recommends \\\n  && apt-get install -y git --no-install-recommends \\\n  && apt-get install -y openssh-client --no-install-recommends \\\n  && apt-get install -y vim tree --no-install-recommends \\\n  && apt-get install --no-install-recommends -y tcptraceroute \\\n  #  && wget -O /usr/bin/tcpping http://www.vdberg.org/~richard/tcpping \\\n  #  && chmod 755 /usr/bin/tcpping \\\n  && wget -O /tmp/node-v4.4.7-linux-x64.tar.xz https://nodejs.org/dist/v4.4.7/node-v4.4.7-linux-x64.tar.xz \\\n  && wget -O /tmp/node-v4.5.0-linux-x64.tar.xz https://nodejs.org/dist/v4.5.0/node-v4.5.0-linux-x64.tar.xz \\\n  && wget -O /tmp/node-v6.2.2-linux-x64.tar.xz https://nodejs.org/dist/v6.2.2/node-v6.2.2-linux-x64.tar.xz \\\n  && wget -O /tmp/node-v6.6.0-linux-x64.tar.xz https://nodejs.org/dist/v6.6.0/node-v6.6.0-linux-x64.tar.xz \\\n  && wget -O /tmp/node-v6.9.3-linux-x64.tar.xz https://nodejs.org/dist/v6.9.3/node-v6.9.3-linux-x64.tar.xz \\\n  && wget -O /tmp/node-v6.10.3-linux-x64.tar.xz https://nodejs.org/dist/v6.10.3/node-v6.10.3-linux-x64.tar.xz \\\n  && wget -O /tmp/node-v6.11.0-linux-x64.tar.xz https://nodejs.org/dist/v6.11.0/node-v6.11.0-linux-x64.tar.xz \\\n  && wget -O /tmp/node-v8.0.0-linux-x64.tar.xz https://nodejs.org/dist/v8.0.0/node-v8.0.0-linux-x64.tar.xz \\\n  && wget -O /tmp/node-v8.1.0-linux-x64.tar.xz https://nodejs.org/dist/v8.1.0/node-v8.1.0-linux-x64.tar.xz \\\n  && wget -O /tmp/node-v8.2.1-linux-x64.tar.xz https://nodejs.org/dist/v8.2.1/node-v8.2.1-linux-x64.tar.xz \\\n  && wget -O /tmp/node-v8.8.1-linux-x64.tar.xz https://nodejs.org/dist/v8.8.1/node-v8.8.1-linux-x64.tar.xz \\\n  && wget -O /tmp/node-v8.9.4-linux-x64.tar.xz https://nodejs.org/dist/v8.9.4/node-v8.9.4-linux-x64.tar.xz \\\n  && wget -O /tmp/node-v8.11.2-linux-x64.tar.xz https://nodejs.org/dist/v8.11.2/node-v8.11.2-linux-x64.tar.xz \\\n  && wget -O /tmp/node-v9.4.0-linux-x64.tar.xz https://nodejs.org/dist/v9.4.0/node-v9.4.0-linux-x64.tar.xz \\\n  && wget -O /tmp/node-v10.1.0-linux-x64.tar.xz https://nodejs.org/dist/v10.1.0/node-v10.1.0-linux-x64.tar.xz \\\n  && wget -O /tmp/npm-2.15.8.zip https://github.com/npm/npm/archive/v2.15.8.zip \\\n  && wget -O /tmp/npm-2.15.9.zip https://github.com/npm/npm/archive/v2.15.9.zip \\\n  && wget -O /tmp/npm-3.9.5.zip https://github.com/npm/npm/archive/v3.9.5.zip \\\n  && wget -O /tmp/npm-3.10.3.zip https://github.com/npm/npm/archive/v3.10.3.zip \\\n  && wget -O /tmp/npm-3.10.10.zip https://github.com/npm/npm/archive/v3.10.10.zip \\\n  && wget -O /tmp/npm-5.0.3.zip https://github.com/npm/npm/archive/v5.0.3.zip \\\n  && wget -O /tmp/npm-5.4.2.zip https://github.com/npm/npm/archive/v5.4.2.zip \\\n  && wget -O /tmp/npm-5.6.0.zip https://github.com/npm/npm/archive/v5.6.0.zip \\\n  && wget -O /tmp/npm-6.0.1.zip https://github.com/npm/npm/archive/v6.0.1.zip \\\n  && ln -s ../mods-available/xml2enc.load /etc/apache2/mods-enabled \\\n  && a2enmod proxy \\\n  && a2enmod proxy_http \\\n  && a2enmod proxy_wstunnel \\\n  && a2enmod rewrite \\\n  && a2enmod proxy_ajp \\\n  && a2enmod deflate \\\n  && a2enmod headers \\\n  && a2enmod proxy_balancer \\\n  && a2enmod proxy_connect \\\n  && a2enmod proxy_html \\\n  && tar -xf /tmp/mod_mono.tar \\\n  && cp mod_mono.so.0.0.0 /usr/lib/apache2/modules/mod_mono.so.0.0.0 && rm /tmp/mod_mono.tar && rm -rf /var/lib/apt/lists/*;\n\n# Install npm and node\nRUN mkdir -p /opt/npm/2.15.8/node_modules \\\n  && unzip -q /tmp/npm-2.15.8.zip -d /opt/npm/2.15.8/node_modules \\\n  && mv /opt/npm/2.15.8/node_modules/npm-2.15.8 /opt/npm/2.15.8/node_modules/npm \\\n  && ln -s /opt/npm/2.15.8/node_modules/npm/bin/npm /opt/npm/2.15.8/npm \\\n  && chmod -R 755 /opt/npm/2.15.8/node_modules/npm/bin \\\n  && mkdir -p /opt/npm/2.15.9/node_modules \\\n  && unzip -q /tmp/npm-2.15.9.zip -d /opt/npm/2.15.9/node_modules \\\n  && mv /opt/npm/2.15.9/node_modules/npm-2.15.9 /opt/npm/2.15.9/node_modules/npm \\\n  && ln -s /opt/npm/2.15.9/node_modules/npm/bin/npm /opt/npm/2.15.9/npm \\\n  && chmod -R 755 /opt/npm/2.15.9/node_modules/npm/bin \\\n  && mkdir -p /opt/npm/3.9.5/node_modules \\\n  && unzip -q /tmp/npm-3.9.5.zip -d /opt/npm/3.9.5/node_modules \\\n  && mv /opt/npm/3.9.5/node_modules/npm-3.9.5 /opt/npm/3.9.5/node_modules/npm \\\n  && ln -s /opt/npm/3.9.5/node_modules/npm/bin/npm /opt/npm/3.9.5/npm \\\n  && chmod -R 755 /opt/npm/3.9.5/node_modules/npm/bin \\\n  && mkdir -p /opt/npm/3.10.3/node_modules \\\n  && unzip -q /tmp/npm-3.10.3.zip -d /opt/npm/3.10.3/node_modules \\\n  && mv /opt/npm/3.10.3/node_modules/npm-3.10.3 /opt/npm/3.10.3/node_modules/npm \\\n  && ln -s /opt/npm/3.10.3/node_modules/npm/bin/npm /opt/npm/3.10.3/npm \\\n  && chmod -R 755 /opt/npm/3.10.3/node_modules/npm/bin \\\n  && mkdir -p /opt/npm/3.10.10/node_modules \\\n  && unzip -q /tmp/npm-3.10.10.zip -d /opt/npm/3.10.10/node_modules \\\n  && mv /opt/npm/3.10.10/node_modules/npm-3.10.10 /opt/npm/3.10.10/node_modules/npm \\\n  && ln -s /opt/npm/3.10.10/node_modules/npm/bin/npm /opt/npm/3.10.10/npm \\\n  && chmod -R 755 /opt/npm/3.10.10/node_modules/npm/bin \\\n  && mkdir -p /opt/npm/5.0.3/node_modules \\\n  && unzip -q /tmp/npm-5.0.3.zip -d /opt/npm/5.0.3/node_modules \\\n  && mv /opt/npm/5.0.3/node_modules/npm-5.0.3 /opt/npm/5.0.3/node_modules/npm \\\n  && ln -s /opt/npm/5.0.3/node_modules/npm/bin/npm /opt/npm/5.0.3/npm \\\n  && chmod -R 755 /opt/npm/5.0.3/node_modules/npm/bin \\\n  && mkdir -p /opt/npm/5.4.2/node_modules \\\n  && unzip -q /tmp/npm-5.4.2.zip -d /opt/npm/5.4.2/node_modules \\\n  && mv /opt/npm/5.4.2/node_modules/npm-5.4.2 /opt/npm/5.4.2/node_modules/npm \\\n  && ln -s /opt/npm/5.4.2/node_modules/npm/bin/npm /opt/npm/5.4.2/npm \\\n  && chmod -R 755 /opt/npm/5.4.2/node_modules/npm/bin \\\n  && mkdir -p /opt/npm/5.6.0/node_modules \\\n  && unzip -q /tmp/npm-5.6.0.zip -d /opt/npm/5.6.0/node_modules \\\n  && mv /opt/npm/5.6.0/node_modules/npm-5.6.0 /opt/npm/5.6.0/node_modules/npm \\\n  && ln -s /opt/npm/5.6.0/node_modules/npm/bin/npm /opt/npm/5.6.0/npm \\\n  && chmod -R 755 /opt/npm/5.6.0/node_modules/npm/bin \\\n  && mkdir -p /opt/npm/6.0.1/node_modules \\\n  && unzip -q /tmp/npm-6.0.1.zip -d /opt/npm/6.0.1/node_modules \\\n  && mv /opt/npm/6.0.1/node_modules/npm-6.0.1 /opt/npm/6.0.1/node_modules/npm \\\n  && ln -s /opt/npm/6.0.1/node_modules/npm/bin/npm /opt/npm/6.0.1/npm \\\n  && chmod -R 755 /opt/npm/6.0.1/node_modules/npm/bin \\\n  && chown -R root:root /opt/npm \\\n  && mkdir -p /opt/nodejs \\\n  && tar xfJ /tmp/node-v4.4.7-linux-x64.tar.xz -C /opt/nodejs \\\n  && rm -f node-v4.4.7-linux-x64.tar.xz \\\n  && mv /opt/nodejs/node-v4.4.7-linux-x64 /opt/nodejs/4.4.7 \\\n  && echo \"2.15.8\" > /opt/nodejs/4.4.7/npm.txt \\\n  && mkdir -p /opt/nodejs \\\n  && tar xfJ /tmp/node-v4.5.0-linux-x64.tar.xz -C /opt/nodejs \\\n  && rm -f node-v4.5.0-linux-x64.tar.xz \\\n  && mv /opt/nodejs/node-v4.5.0-linux-x64 /opt/nodejs/4.5.0 \\\n  && echo \"2.15.9\" > /opt/nodejs/4.5.0/npm.txt \\\n  && tar xfJ /tmp/node-v6.2.2-linux-x64.tar.xz -C /opt/nodejs \\\n  && rm -f node-v6.2.2-linux-x64.tar.xz \\\n  && mv /opt/nodejs/node-v6.2.2-linux-x64 /opt/nodejs/6.2.2 \\\n  && echo \"3.9.5\" > /opt/nodejs/6.2.2/npm.txt \\\n  && tar xfJ /tmp/node-v6.6.0-linux-x64.tar.xz -C /opt/nodejs \\\n  && rm -f node-v6.6.0-linux-x64.tar.xz \\\n  && mv /opt/nodejs/node-v6.6.0-linux-x64 /opt/nodejs/6.6.0 \\\n  && echo \"3.10.3\" > /opt/nodejs/6.6.0/npm.txt \\\n  && tar xfJ /tmp/node-v6.9.3-linux-x64.tar.xz -C /opt/nodejs \\\n  && rm -f node-v6.9.3-linux-x64.tar.xz \\\n  && mv /opt/nodejs/node-v6.9.3-linux-x64 /opt/nodejs/6.9.3 \\\n  && echo \"3.10.10\" > /opt/nodejs/6.9.3/npm.txt \\\n  && tar xfJ /tmp/node-v6.10.3-linux-x64.tar.xz -C /opt/nodejs \\\n  && rm -f node-v6.10.3-linux-x64.tar.xz \\\n  && mv /opt/nodejs/node-v6.10.3-linux-x64 /opt/nodejs/6.10.3 \\\n  && echo \"3.10.10\" > /opt/nodejs/6.10.3/npm.txt \\\n  && tar xfJ /tmp/node-v6.11.0-linux-x64.tar.xz -C /opt/nodejs \\\n  && rm -f node-v6.11.0-linux-x64.tar.xz \\\n  && mv /opt/nodejs/node-v6.11.0-linux-x64 /opt/nodejs/6.11.0 \\\n  && echo \"3.10.10\" > /opt/nodejs/6.11.0/npm.txt \\\n  && tar xfJ /tmp/node-v8.0.0-linux-x64.tar.xz -C /opt/nodejs \\\n  && rm -f node-v8.0.0-linux-x64.tar.xz \\\n  && mv /opt/nodejs/node-v8.0.0-linux-x64 /opt/nodejs/8.0.0 \\\n  && echo \"5.0.3\" > /opt/nodejs/8.0.0/npm.txt \\\n  && tar xfJ /tmp/node-v8.1.0-linux-x64.tar.xz -C /opt/nodejs \\\n  && rm -f node-v8.1.0-linux-x64.tar.xz \\\n  && mv /opt/nodejs/node-v8.1.0-linux-x64 /opt/nodejs/8.1.0 \\\n  && echo \"5.0.3\" > /opt/nodejs/8.1.0/npm.txt \\\n  && tar xfJ /tmp/node-v8.2.1-linux-x64.tar.xz -C /opt/nodejs \\\n  && rm -f node-v8.2.1-linux-x64.tar.xz \\\n  && mv /opt/nodejs/node-v8.2.1-linux-x64 /opt/nodejs/8.2.1 \\\n  && echo \"5.4.2\" > /opt/nodejs/8.2.1/npm.txt \\\n  && tar xfJ /tmp/node-v8.8.1-linux-x64.tar.xz -C /opt/nodejs \\\n  && rm -f node-v8.8.1-linux-x64.tar.xz \\\n  && mv /opt/nodejs/node-v8.8.1-linux-x64 /opt/nodejs/8.8.1 \\\n  && echo \"5.4.2\" > /opt/nodejs/8.8.1/npm.txt \\\n  && tar xfJ /tmp/node-v8.9.4-linux-x64.tar.xz -C /opt/nodejs \\\n  && rm -f node-v8.9.4-linux-x64.tar.xz \\\n  && mv /opt/nodejs/node-v8.9.4-linux-x64 /opt/nodejs/8.9.4 \\\n  && echo \"5.6.0\" > /opt/nodejs/8.9.4/npm.txt \\\n  && tar xfJ /tmp/node-v8.11.2-linux-x64.tar.xz -C /opt/nodejs \\\n  && rm -f node-v8.11.2-linux-x64.tar.xz \\\n  && mv /opt/nodejs/node-v8.11.2-linux-x64 /opt/nodejs/8.11.2 \\\n  && echo \"5.6.0\" > /opt/nodejs/8.11.2/npm.txt \\\n  && tar xfJ /tmp/node-v9.4.0-linux-x64.tar.xz -C /opt/nodejs \\\n  && rm -f node-v9.4.0-linux-x64.tar.xz \\\n  && mv /opt/nodejs/node-v9.4.0-linux-x64 /opt/nodejs/9.4.0 \\\n  && echo \"5.6.0\" > /opt/nodejs/9.4.0/npm.txt \\\n  && tar xfJ /tmp/node-v10.1.0-linux-x64.tar.xz -C /opt/nodejs \\\n  && rm -f node-v10.1.0-linux-x64.tar.xz \\\n  && mv /opt/nodejs/node-v10.1.0-linux-x64 /opt/nodejs/10.1.0 \\\n  && echo \"6.0.1\" > /opt/nodejs/10.1.0/npm.txt \\\n  && chown -R root:root /opt/nodejs \\\n  && ln -s /opt/nodejs/6.11.0/bin/node /opt/nodejs/node \\\n  && ln -s /opt/nodejs/6.11.0/npm.txt /opt/nodejs/npm.txt \\\n  && rm -f /usr/bin/node \\\n  && ln -s /opt/nodejs/6.11.0/bin/node /usr/bin/node \\\n  && rm -f /opt/nodejs/6.11.0/bin/npm \\\n  && ln -s /opt/npm/3.10.10/node_modules/npm/bin/npm /opt/nodejs/npm \\\n  && ln -s /opt/npm/3.10.10/node_modules /opt/nodejs/node_modules \\\n  && rm -rf /usr/bin/npm \\\n  && ln -s /opt/npm/3.10.10/node_modules/npm/bin/npm /usr/bin/npm \\\n  && ln -s /opt/npm/3.10.10/node_modules/npm/bin/npm-cli.js /usr/bin/npm-cli.js \\\n  && ln -s /opt/npm/3.10.10/node_modules /usr/bin/node_modules\n\nENV PATH $PATH:/opt/nodejs/6.11.0/bin\n\n# Upgrade mono\nRUN echo \"deb http://download.mono-project.com/repo/debian beta/. main\" | tee /etc/apt/sources.list.d/mono-xamarin-c7-ms.list \\\n  && apt-get update \\\n  && apt-get install -y libmono-system-net-http-webrequest4.0-cil --no-install-recommends && rm -rf /var/lib/apt/lists/*;\n\n# Ruby installations\n\n# Dependencies for various ruby and rubygem installations\nRUN apt-get install -y libreadline-dev bzip2 build-essential libssl-dev zlib1g-dev libpq-dev libsqlite3-dev \\\n  curl patch gawk g++ gcc make libc6-dev patch libreadline6-dev libyaml-dev sqlite3 autoconf \\\n  libgdbm-dev libncurses5-dev automake libtool bison pkg-config libffi-dev bison libxslt-dev \\\n  libxml2-dev libmysqlclient-dev --no-install-recommends && rm -rf /var/lib/apt/lists/*;\n\n# rbenv\nRUN git clone https://github.com/rbenv/rbenv.git /usr/local/.rbenv\nRUN chmod -R 777 /usr/local/.rbenv\n\nENV RBENV_ROOT=\"/usr/local/.rbenv\"\n\nENV PATH=\"$RBENV_ROOT/bin:/usr/local:$PATH\"\n\nRUN git clone https://github.com/rbenv/ruby-build.git /usr/local/.rbenv/plugins/ruby-build\nRUN chmod -R 777 /usr/local/.rbenv/plugins/ruby-build\n\nRUN /usr/local/.rbenv/plugins/ruby-build/install.sh\n\n# Install ruby 2.3.3 (default), 2.3.8, 2.4.5\nENV RUBY_CONFIGURE_OPTS=--disable-install-doc\n\nENV RUBY_CFLAGS=-O3\n\nRUN eval \"$(rbenv init -)\" \\\n  && export WEBSITES_DEFAULT_RUBY_VERSION=\"2.3.3\" \\\n  && rbenv install $WEBSITES_DEFAULT_RUBY_VERSION \\\n  && rbenv install \"2.3.8\" \\\n  && rbenv install \"2.4.5\" \\\n  && rbenv install \"2.5.5\" \\\n  && rbenv install \"2.6.2\" \\\n  && rbenv rehash \\\n  && rbenv global $WEBSITES_DEFAULT_RUBY_VERSION \\\n  && ls /usr/local -a \\\n  && rbenv local $WEBSITES_DEFAULT_RUBY_VERSION \\\n  && gem install bundler --version \"=1.13.6\"\\\n  && rbenv local 2.3.8 \\\n  && gem install bundler --version \"=1.13.6\"\\\n  && rbenv local 2.4.5 \\\n  && gem install bundler --version \"=1.13.6\"\\\n  && rbenv local 2.5.5 \\\n  && gem install bundler --version \"=1.13.6\"\\\n  && rbenv local 2.6.2 \\\n  && gem install bundler --version \"=1.13.6\"\\\n  && rbenv local $WEBSITES_DEFAULT_RUBY_VERSION \\\n  && chmod -R 777 /usr/local/.rbenv/versions \\\n  && chmod -R 777 /usr/local/.rbenv/version\n\nRUN eval \"$(rbenv init -)\" \\\n  && rbenv global $WEBSITES_DEFAULT_RUBY_VERSION \\\n  && bundle config --global build.nokogiri -- --use-system-libraries\n\n# Because Nokogiri tries to build libraries on its own otherwise\nENV NOKOGIRI_USE_SYSTEM_LIBRARIES=true\n\n# SQL Server gem support\nRUN apt-get install --no-install-recommends -y unixodbc-dev freetds-dev freetds-bin && rm -rf /var/lib/apt/lists/*;\n\n# Install .NET Core\nRUN apt-get update \\\n  && apt-get install -y --no-install-recommends \\\n  libc6 \\\n  libcurl3 \\\n  libgcc1 \\\n  libgssapi-krb5-2 \\\n  libicu52 \\\n  liblttng-ust0 \\\n  libssl1.0.0 \\\n  libstdc++6 \\\n  libunwind8 \\\n  libuuid1 \\\n  zlib1g \\\n  && rm -rf /var/lib/apt/lists/*\n\n# Install .NET Core SDK\nENV DOTNET_SDK_VERSION 2.1.300\nENV DOTNET_SDK_DOWNLOAD_URL https://dotnetcli.blob.core.windows.net/dotnet/Sdk/$DOTNET_SDK_VERSION/dotnet-sdk-$DOTNET_SDK_VERSION-linux-x64.tar.gz\nENV DOTNET_SDK_DOWNLOAD_SHA 80a6bfb1db5862804e90f819c1adeebe3d624eae0d6147e5d6694333f0458afd7d34ce73623964752971495a310ff7fcc266030ce5aef82d5de7293d94d13770\n\nRUN curl -f -SL $DOTNET_SDK_DOWNLOAD_URL --output dotnet.tar.gz \\\n  && echo \"$DOTNET_SDK_DOWNLOAD_SHA dotnet.tar.gz\" | sha512sum -c - \\\n  && mkdir -p /usr/share/dotnet \\\n  && tar -zxf dotnet.tar.gz -C /usr/share/dotnet \\\n  && rm dotnet.tar.gz \\\n  && ln -s /usr/share/dotnet/dotnet /usr/bin/dotnet\n\n# Moving the package cache to the container image will require user packages to be repopulated\n# for each new build done in a new container instance, but it's *much* faster than\n# using a location on the user's site volume and does not require them to use their storage, and\n# lets us warm the caches with standard packages\nENV NUGET_PACKAGES /var/nuget\n\n# Trigger the population of the local package cache and NuGetFallbackFolder\n# We install the 1.x web templates just so we can create and restore 1.0 and 1.1 MVC apps here\n# See https://github.com/aspnet/Tooling/blob/master/missing-template.md\n# Note that after populating the cache we need to chmod 777 every directory underneath\n# so the Kudu user can access them; this can be removed if we run Kudu as root later.\nENV NUGET_XMLDOC_MODE skip\nENV DOTNET_SKIP_FIRST_TIME_EXPERIENCE 1\n\nRUN mkdir /var/nuget \\\n  && chmod a+rw /var/nuget \\\n  && dotnet new -i \"Microsoft.DotNet.Web.ProjectTemplates.1.x::1.0.0-*\" \\\n  && mkdir warmup \\\n  && cd warmup \\\n  && dotnet new \\\n  && cd .. \\\n  && rm -rf warmup \\\n  && mkdir warmup \\\n  && cd warmup \\\n  && dotnet new mvc -f netcoreapp1.1 \\\n  && dotnet restore \\\n  && cd .. \\\n  && rm -rf warmup \\\n  && mkdir warmup \\\n  && cd warmup \\\n  && dotnet new mvc -f netcoreapp1.0 \\\n  && dotnet restore \\\n  && cd .. \\\n  && rm -rf warmup \\\n  && mkdir warmup \\\n  && cd warmup \\\n  && dotnet new mvc \\\n  && dotnet restore \\\n  && cd .. \\\n  && rm -rf warmup \\\n  && rm -rf /tmp/NuGetScratch \\\n  && find /var/nuget -type d -exec chmod 777 {} \\;\n\n# install apache2\nRUN apt-get install --no-install-recommends -y apache2 && rm -rf /var/lib/apt/lists/*;\nRUN service apache2 restart\n\n# Section PHP\nRUN apt-get update; \\\n     apt-get install -y --no-install-recommends \\\n     libcurl4-openssl-dev \\\n     libssl-dev \\\n     zlib1g-dev \\\n     libpng-dev \\\n     libpq-dev \\\n     libc-client-dev \\\n     libsqlite3-dev \\\n     libgmp-dev \\\n     libmcrypt-dev \\\n     libldap2-dev \\\n     libtidy-dev \\\n     libkrb5-dev \\\n     libicu-dev \\\n     libedit-dev \\\n     libxml2-dev \\\n     libxslt-dev \\\n     unixodbc-dev \\\n     libmagickwand-dev \\\n     dpkg-dev \\\n     file \\\n     g++ \\\n     gcc \\\n     libc-dev \\\n     libsodium-dev \\\n     libsodium18 \\\n     && ln -s /usr/lib/x86_64-linux-gnu/libldap.so /usr/lib/libldap.so && rm -rf /var/lib/apt/lists/*;\n\n\nRUN mkdir -p /usr/local/php/5.6\nCOPY --from=php5.6-build /usr/local/php/5.6 /usr/local/php/5.6\n\nRUN mkdir -p /usr/local/php/7.0\nCOPY --from=php7.0-build /usr/local/php/7.0 /usr/local/php/7.0\n\nRUN mkdir -p /usr/local/php/7.2\nCOPY --from=php7.2-build /usr/local/php/7.2 /usr/local/php/7.2\n\nENV PATH /usr/local/php/7.2/bin:$PATH\n\nENV PHP_5_6_PATH /usr/local/php/5.6/bin\nENV PHP_7_0_PATH /usr/local/php/7.0/bin\nENV PHP_7_2_PATH /usr/local/php/7.2/bin\n\n# PHP Composer\nRUN php -r \"copy('https://getcomposer.org/installer', '/tmp/composer-setup.php');\" \\\n  && php /tmp/composer-setup.php --install-dir=/usr/local/bin --filename=composer --quiet \\\n  && rm -f /tmp/composer-setup.php\n\nENV PHP_VERSION=7.2\nENV COMPOSER_VENDOR_DIR=/home/site/wwwroot/vendor\n\n# Golang and musl for cross compiling for alpine.\nENV GOLANG_VERSION=1.10\nENV GOLANG_DOWNLOAD_URL=https://golang.org/dl/go$GOLANG_VERSION.linux-amd64.tar.gz\nENV GOLANG_DOWNLOAD_SHA=b5a64335f1490277b585832d1f6c7f8c6c11206cba5cd3f771dcb87b98ad1a33\n\nRUN curl -f -SL $GOLANG_DOWNLOAD_URL --output golang.tar.gz \\\n  && echo \"$GOLANG_DOWNLOAD_SHA  golang.tar.gz\" | sha256sum -c - \\\n  && tar -zxf golang.tar.gz -C /usr/local \\\n  && rm golang.tar.gz \\\n  && apt-get install --no-install-recommends -y musl-tools && rm -rf /var/lib/apt/lists/*;\n\nENV PATH /usr/local/go/bin:$PATH\n\n# Download Dep executable\nENV DEP_VERSION=0.4.1\nENV DEP_DOWNLOAD_URL=https://github.com/golang/dep/releases/download/v$DEP_VERSION/dep-linux-amd64\nENV DEP_DOWNLOAD_SHA=31144e465e52ffbc0035248a10ddea61a09bf28b00784fd3fdd9882c8cbb2315\nRUN curl -fL -o /usr/local/go/bin/dep $DEP_DOWNLOAD_URL \\\n  && echo \"$DEP_DOWNLOAD_SHA  /usr/local/go/bin/dep\" | sha256sum -c - \\\n  && chmod +x /usr/local/go/bin/dep\n\n# Section PYTHON\n\nRUN set -ex \\\n        \\\n        && savedAptMark=\"$(apt-mark showmanual)\" \\\n        && apt-get update && apt-get install -y --no-install-recommends \\\n                dpkg-dev \\\n                gcc \\\n                libbz2-dev \\\n                libc6-dev \\\n                libexpat1-dev \\\n                libffi-dev \\\n                libgdbm-dev \\\n                liblzma-dev \\\n                libncursesw5-dev \\\n                libreadline-dev \\\n                libsqlite3-dev \\\n                libssl-dev \\\n                apt-transport-https \\\n                lsb-release  \\\n                ca-certificates \\\n                make \\\n                tk-dev \\\n                tcl-dev \\\n                uuid-dev \\\n                wget \\\n                xz-utils \\\n                zlib1g-dev \\\n# as of Stretch, \"gpg\" is no longer included by default\n                $(command -v gpg > /dev/null || echo 'gnupg dirmngr') && rm -rf /var/lib/apt/lists/*;\n\n\nCOPY --from=python-3.6-build /usr/local/python/3.6.6 /usr/local/python/3.6.6\nCOPY --from=python-3.7-build /usr/local/openssl /usr/local/openssl\nCOPY --from=python-3.7-build /usr/local/python/3.7.0 /usr/local/python/3.7.0\nENV PATH /usr/local/python/3.7.0/bin:$PATH\nENV PYTHON_3_7_PATH /usr/local/python/3.7.0/bin\nENV PYTHON_3_6_PATH /usr/local/python/3.6.6/bin\n\n\n# Install Kudu\nCOPY kudu.conf /tmp\nCOPY apache2.conf /tmp\nCOPY Kudu.82.10506.3895.zip /tmp/Kudu.zip\nENV KUDU_VERSION 82.10506.3895\nRUN npm install -g kudusync \\\n  && cp /tmp/kudu.conf /etc/apache2/sites-available/kudu.conf \\\n  && cp /tmp/apache2.conf /etc/apache2/apache2.conf  \\\n  && unzip -q -o /tmp/Kudu.zip \\\n  && mkdir /opt/Kudu \\\n  && cp -rf ./$KUDU_VERSION/* /opt/Kudu \\\n  && rm -f /tmp/Kudu.zip \\\n  && rm -f /tmp/apache2.conf \\\n  && rm -f /tmp/kudu.conf \\\n  && rm -rf ./$KUDU_VERSION \\\n  && cat /opt/Kudu/Web.config | \\\n  sed 's|  <location path=\".\" inheritInChildApplications=\"false\">|  <location path=\"~/../../../opt/Kudu\" inheritInChildApplications=\"false\">|' > /opt/Kudu/Web.config2 \\\n  && mv /opt/Kudu/Web.config2 /opt/Kudu/Web.config \\\n  && chmod 755 /opt/Kudu/bin/kudu.exe \\\n  && chmod 755 /opt/Kudu/bin/node_modules/.bin/kuduscript \\\n  && chmod 755 /opt/Kudu/bin/Scripts/starter.sh \\\n  && mkdir -p /opt/Kudu/local \\\n  && chmod 755 /opt/Kudu/local && npm cache clean --force;\n\n# Install pm2 and pm2-logrotate\nRUN npm install pm2@latest -g \\\n  && pm2 install pm2-logrotate \\\n  && pm2 set pm2-logrotate:retain 7 && npm cache clean --force;\n\n# Install LogAnalyzer\nCOPY LogAnalyzer.zip /tmp\nRUN mkdir /opt/LogAnalyzer \\\n  && unzip /tmp/LogAnalyzer.zip -d /opt/LogAnalyzer \\\n  && rm -f /tmp/LogAnalyzer.zip\n\nCOPY startup.sh /\nRUN chmod 755 /startup.sh \\\n  && mkdir -p /home/LogFiles\n\n# Remove extraneous config mono config load that starts up\n# an unnecessary mono process\nRUN sed -i '$d' /etc/apache2/mods-enabled/mod_mono.conf\n\n# Install TunnelExtension\nCOPY TunnelExtension.zip /tmp\nRUN mkdir /opt/tunnelext \\\n  && unzip /tmp/TunnelExtension.zip -d /opt/tunnelext \\\n  && chmod 777 /opt/tunnelext/tunnelwatcher.sh\n\n# Install webssh\nCOPY webssh.zip /tmp\nRUN mkdir /opt/webssh \\\n  && unzip /tmp/webssh.zip -d /opt/webssh\n\n# Replace ssh with wrapper script for CIFS mount permissions workaround\nCOPY ssh /tmp\nRUN mv /usr/bin/ssh /usr/bin/ssh.original \\\n  && mv /tmp/ssh /usr/bin/ssh \\\n  && chown root:root /usr/bin/ssh \\\n  && chmod 755 /usr/bin/ssh\n\nCOPY hostingstart.html /home/site/wwwroot/hostingstart.html\nCOPY KuduStaticFiles/503.html /opt/Kudu/503.html\nCOPY KuduStaticFiles/_Layout.cshtml /opt/Kudu/_Layout.cshtml\nCOPY KuduStaticFiles/AppService.png /opt/Kudu/Content/Images/AppService.png\nCOPY KuduStaticFiles/linux_favicon.ico /opt/Kudu/linux_favicon.ico\nCOPY deploy.bash.python.template /opt/Kudu/bin/node_modules/kuduscript/lib/templates/deploy.bash.python.template\nCOPY deploy.bash.ruby.template /opt/Kudu/bin/node_modules/kuduscript/lib/templates/deploy.bash.ruby.template\n\nRUN chmod -R 777 /home \\\n  && rm -rf /tmp/*\n\nEXPOSE 8181\nENV PORT 8181\n\nENTRYPOINT [ \"/startup.sh\" ]\nCMD [ \"1002\", \"kudu_group\", \"1001\", \"kudu_user\", \"localsite\" ]\n\n\n"
}