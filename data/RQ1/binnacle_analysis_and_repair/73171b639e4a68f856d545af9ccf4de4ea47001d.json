{
  "startTime": 1674239738892,
  "endTime": 1674239739448,
  "originalSmells": [
    {
      "rule": "tarSomethingRmTheSomething",
      "position": {
        "lineStart": 14,
        "lineEnd": 14,
        "columnStart": 4,
        "columnEnd": 26
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 133,
        "lineEnd": 141,
        "columnStart": 25,
        "columnEnd": 15
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 133,
        "lineEnd": 141,
        "columnStart": 25,
        "columnEnd": 15
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "#------------------------------------------------------------------------------#\n# This file contains the setup for building a base image for the MiniZinc\n# challenges. It uses multi-stage builds in order to keep the images small.\n# Note that the statements ADD, RUN, and COPY can add image layers.\n#------------------------------------------------------------------------------#\n# The build image\n\n# Setup Alpine Linux as build image\nFROM alpine:latest AS builder\n\n# Retrieve MiniZinc IDE distribution\nADD https://github.com/MiniZinc/MiniZincIDE/releases/download/2.1.7/MiniZincIDE-2.1.7-bundle-linux-x86_64.tgz /minizinc.tgz\n\n# Unpack compressed MiniZinc archive and renamed folder\nRUN tar -zxf /minizinc.tgz && \\\n    mv /MiniZincIDE-2.1.7-bundle-linux-x86_64 /minizinc && rm /minizinc.tgz\n\n#------------------------------------------------------------------------------#\n# Script for executing a FlatZinc or MiniZinc solver in the FD class\n\nRUN \\\n    echo \"#!/bin/bash                                                 \" >  /minizinc/mzn-exec-fd && \\\n    echo \"#----------------------------------------------------------#\" >> /minizinc/mzn-exec-fd && \\\n    echo \"# Script for running solver in the class 'FD search'        \" >> /minizinc/mzn-exec-fd && \\\n    echo \"#----------------------------------------------------------#\" >> /minizinc/mzn-exec-fd && \\\n    echo \"# FlatZinc Solver                                           \" >> /minizinc/mzn-exec-fd && \\\n    echo \"# (comment following line for MiniZinc solver)              \" >> /minizinc/mzn-exec-fd && \\\n    echo \"minizinc -k -f \\\"\\$FZNEXEC\\\" -G exec \\\"\\$@\\\"                \" >> /minizinc/mzn-exec-fd && \\\n    echo \"#----------------------------------------------------------#\" >> /minizinc/mzn-exec-fd && \\\n    echo \"# MiniZinc Solver                                           \" >> /minizinc/mzn-exec-fd && \\\n    echo \"# (add call to your solver here, e.g.)                      \" >> /minizinc/mzn-exec-fd && \\\n    echo \"# mzn-gecode -G gecode \\\"\\$@\\\"                              \" >> /minizinc/mzn-exec-fd && \\\n    chmod a+x /minizinc/mzn-exec-fd\n\n#------------------------------------------------------------------------------#\n# Script for executing a FlatZinc or MiniZinc solver in the FREE class\n\nRUN \\\n    echo \"#!/bin/bash                                                 \" >  /minizinc/mzn-exec-free && \\\n    echo \"#----------------------------------------------------------#\" >> /minizinc/mzn-exec-free && \\\n    echo \"# Script for running solver in the class 'FREE search'      \" >> /minizinc/mzn-exec-free && \\\n    echo \"#----------------------------------------------------------#\" >> /minizinc/mzn-exec-free && \\\n    echo \"# FlatZinc Solver                                           \" >> /minizinc/mzn-exec-free && \\\n    echo \"# (comment following line for MiniZinc solver)              \" >> /minizinc/mzn-exec-free && \\\n    echo \"minizinc -k -f \\\"\\$FZNEXEC -f\\\" -G exec \\\"\\$@\\\"             \" >> /minizinc/mzn-exec-free && \\\n    echo \"#----------------------------------------------------------#\" >> /minizinc/mzn-exec-free && \\\n    echo \"# MiniZinc Solver                                           \" >> /minizinc/mzn-exec-free && \\\n    echo \"# (add call to your solver here, e.g.)                      \" >> /minizinc/mzn-exec-free && \\\n    echo \"# mzn-gecode -f -G gecode \\\"\\$@\\\"                           \" >> /minizinc/mzn-exec-free && \\\n    chmod a+x /minizinc/mzn-exec-free\n\n#------------------------------------------------------------------------------#\n# Script for executing a FlatZinc or MiniZinc solver in the PAR class\n# (NOTE that this script will be invoke including the parameter \"-p <n>\".)\n\nRUN \\\n    echo \"#!/bin/bash                                                 \"  >  /minizinc/mzn-exec-par && \\\n    echo \"#----------------------------------------------------------#\"  >> /minizinc/mzn-exec-par && \\\n    echo \"# Script for running solver in the class 'PAR search'       \"  >> /minizinc/mzn-exec-par && \\\n    echo \"# NOTE that the argument \\\"-p <n>\\\" will pass to this script!\" >> /minizinc/mzn-exec-par && \\\n    echo \"# Your solver needs to handle this parameter.               \"  >> /minizinc/mzn-exec-par && \\\n    echo \"#----------------------------------------------------------#\"  >> /minizinc/mzn-exec-par && \\\n    echo \"# FlatZinc Solver                                           \"  >> /minizinc/mzn-exec-par && \\\n    echo \"# (comment following line for MiniZinc solver)              \"  >> /minizinc/mzn-exec-par && \\\n    echo \"minizinc -k -f \\\"\\$FZNEXEC\\\" -G exec \\\"\\$@\\\"                \"  >> /minizinc/mzn-exec-par && \\\n    echo \"#----------------------------------------------------------#\"  >> /minizinc/mzn-exec-par && \\\n    echo \"# MiniZinc Solver                                           \"  >> /minizinc/mzn-exec-par && \\\n    echo \"# (add call to your solver here, e.g.)                      \"  >> /minizinc/mzn-exec-par && \\\n    echo \"# mzn-gecode -G gecode \\\"\\$@\\\"                              \"  >> /minizinc/mzn-exec-par && \\\n    chmod a+x /minizinc/mzn-exec-par\n\n#------------------------------------------------------------------------------#\n# Script for executing a FlatZinc or MiniZinc solver from outside the container\n\nRUN \\\n    echo \"#!/bin/bash                                 \" >  /minizinc/solver && \\\n    echo \"#------------------------------------------#\" >> /minizinc/solver && \\\n    echo \"EXEC=mzn-exec-fd                            \" >> /minizinc/solver && \\\n    echo \"while (( \\\"\\$#\\\" ))                         \" >> /minizinc/solver && \\\n    echo \"do                                          \" >> /minizinc/solver && \\\n    echo \"    case \\$1 in                             \" >> /minizinc/solver && \\\n    echo \"    -p)                                     \" >> /minizinc/solver && \\\n    echo \"        EXEC=mzn-exec-par                   \" >> /minizinc/solver && \\\n    echo \"        ARGS=\\\"\\$ARGS \\$1\\\"                 \" >> /minizinc/solver && \\\n    echo \"        ;;                                  \" >> /minizinc/solver && \\\n    echo \"    --free-search)                          \" >> /minizinc/solver && \\\n    echo \"        EXEC=mzn-exec-free                  \" >> /minizinc/solver && \\\n    echo \"        ;;                                  \" >> /minizinc/solver && \\\n    echo \"    --fzn-flag|--fzn-flags)                 \" >> /minizinc/solver && \\\n    echo \"        shift                               \" >> /minizinc/solver && \\\n    echo \"        FLAGS=\\\"\\$FLAGS \\$1\\\"               \" >> /minizinc/solver && \\\n    echo \"        ;;                                  \" >> /minizinc/solver && \\\n    echo \"    -D|--cmdline-data)                      \" >> /minizinc/solver && \\\n    echo \"        shift                               \" >> /minizinc/solver && \\\n    echo \"        DATA=\\\"\\$DATA \\$1\\\"                 \" >> /minizinc/solver && \\\n    echo \"        ;;                                  \" >> /minizinc/solver && \\\n    echo \"    *)                                      \" >> /minizinc/solver && \\\n    echo \"        ARGS=\\\"\\$ARGS \\$1\\\"                 \" >> /minizinc/solver && \\\n    echo \"        ;;                                  \" >> /minizinc/solver && \\\n    echo \"    esac                                    \" >> /minizinc/solver && \\\n    echo \"    shift                                   \" >> /minizinc/solver && \\\n    echo \"done                                        \" >> /minizinc/solver && \\\n    echo \"if [ -z \\\"\\$FLAGS\\\" ] && [ -z \\\"\\$DATA\\\" ]  \" >> /minizinc/solver && \\\n    echo \"then                                        \" >> /minizinc/solver && \\\n    echo \"    \\$EXEC \\$ARGS                           \" >> /minizinc/solver && \\\n    echo \"elif [ -n \\\"\\$FLAGS\\\" ] && [ -z \\\"\\$DATA\\\" ]\" >> /minizinc/solver && \\\n    echo \"then                                        \" >> /minizinc/solver && \\\n    echo \"    \\$EXEC --fzn-flags \\\"\\$FLAGS\\\" \\$ARGS   \" >> /minizinc/solver && \\\n    echo \"elif [ -z \\\"\\$FLAGS\\\" ] && [ -n \\\"\\$DATA\\\" ]\" >> /minizinc/solver && \\\n    echo \"then                                        \" >> /minizinc/solver && \\\n    echo \"    \\$EXEC -D \\\"\\$DATA\\\" \\$ARGS             \" >> /minizinc/solver && \\\n    echo \"else                                        \" >> /minizinc/solver && \\\n    echo \"    \\$EXEC --fzn-flags \\\"\\$FLAGS\\\" -D \\\"\\$DATA\\\" \\$ARGS \" >> /minizinc/solver && \\\n    echo \"fi                                          \" >> /minizinc/solver && \\\n    chmod a+x /minizinc/solver\n\n#------------------------------------------------------------------------------#\n# Adding MiniZinc test files\n\nRUN \\\n    echo \"int: a;                                                                \" >  /minizinc/test.mzn && \\\n    echo \"var 1..100: x;                                                         \" >> /minizinc/test.mzn && \\\n    echo \"constraint a <= x /\\ x < 2*a;                                          \" >> /minizinc/test.mzn && \\\n    echo \"solve :: int_search([x], input_order, indomain_min, complete) satisfy; \" >> /minizinc/test.mzn && \\\n    echo \"a = 2;\" > /minizinc/2.dzn\n\n#------------------------------------------------------------------------------#\n# Setup of the base image\n\n# Get base image from the latest Ubuntu LTS\nFROM ubuntu:16.04\n\n# Update Ubuntu and install necessary packages\nRUN apt-get update -y && apt-get install --no-install-recommends -y \\\n    vim \\\n    libmpfr4 \\\n    libglib2.0-0 \\\n    libx11-6 \\\n    libpng12-0 \\\n    libharfbuzz0b \\\n    libgl1-mesa-glx \\\n    libpcre16-3 && rm -rf /var/lib/apt/lists/*;\n\n# Copy unpacked MiniZinc installation from the build image\nCOPY --from=builder /minizinc /minizinc\n\n# Create folder for the solver submission and link solver MiniZinc library\nRUN mkdir /entry_data \\\n    && mkdir /entry_data/mzn-lib \\\n    && ln -s /entry_data/mzn-lib /minizinc/share/minizinc/exec\n\n#------------------------------------------------------------------------------#\n# Environment Variables\n\n# Add FlatZinc solver absolute path\nENV FZNEXEC=\"/entry_data/fzn-exec\"\n\n# Add MiniZinc's binary path to PATH\nENV PATH=\"/minizinc:${PATH}\"\n\n# Add MiniZinc's library path to LD_LIBRARY_PATH\nENV LD_LIBRARY_PATH=\"/minizinc/lib:${LD_LIBRARY_PATH}\"\n\n#------------------------------------------------------------------------------#\n# Setup Working Directory\n\nWORKDIR /minizinc\n"
}