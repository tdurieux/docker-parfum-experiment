{
  "startTime": 1674242669331,
  "endTime": 1674242669493,
  "originalSmells": [
    {
      "rule": "npmCacheCleanAfterInstall",
      "position": {
        "lineStart": 50,
        "lineEnd": 50,
        "columnStart": 4,
        "columnEnd": 15
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 45,
        "lineEnd": 45,
        "columnStart": 4,
        "columnEnd": 21
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 4,
        "lineEnd": 4,
        "columnStart": 22,
        "columnEnd": 45
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 10,
        "lineEnd": 22,
        "columnStart": 9,
        "columnEnd": 13
      }
    }
  ],
  "repairedSmells": [
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 10,
        "lineEnd": 22,
        "columnStart": 9,
        "columnEnd": 13
      }
    }
  ],
  "repairedDockerfile": "FROM mtgupf/essentia:ubuntu18.04-python3\nENV PYTHONUNBUFFERED 1\nENV LANG C.UTF-8\n\nRUN apt-get update && apt-get install --no-install-recommends -y wget && rm -rf /var/lib/apt/lists/*\n\nRUN wget -O /usr/local/bin/dumb-init https://github.com/Yelp/dumb-init/releases/download/v1.2.2/dumb-init_1.2.2_amd64 \\\n    && chmod +x /usr/local/bin/dumb-init\n\nRUN wget -q -O - https://deb.nodesource.com/setup_12.x | bash - \\\n      && apt-get install -y --no-install-recommends \\\n         cmake \\\n         libmad0-dev \\\n         libsndfile1-dev \\\n         libgd-dev \\\n         libboost-filesystem-dev \\\n         libboost-program-options-dev \\\n         libboost-regex-dev \\\n         nodejs \\\n         libsndfile1-dev \\\n         build-essential \\\n         libpython3.7-dev \\\n         lame \\\n      && apt-get remove -y python3-yaml python3-six python3-numpy \\\n      && rm -rf /var/lib/apt/lists/*\n\nRUN wget -O get-pip.py 'https://bootstrap.pypa.io/get-pip.py' \\\n    && python3 get-pip.py --disable-pip-version-check --no-cache-dir \\\n    && rm -r get-pip.py\n\n\nRUN mkdir /code\nWORKDIR /code\n\nADD requirements.txt /code/\nRUN pip3 install --no-cache-dir -i https://mtg-devpi.sb.upf.edu/asplab/dev/ numpy==1.16.4 six\nRUN pip3 install --no-cache-dir -i https://mtg-devpi.sb.upf.edu/asplab/dev/ -r requirements.txt\n\nADD requirements_dev.txt /code/\nRUN pip3 install --no-cache-dir -i https://mtg-devpi.sb.upf.edu/asplab/dev/ -r requirements_dev.txt\n\nRUN mkdir /sources\nWORKDIR /sources\nRUN git clone https://github.com/MTG/pycompmusic.git\nWORKDIR /sources/pycompmusic\nRUN pip3 install --no-cache-dir -e .\n\n\nADD package.json /code/\nWORKDIR /code\nRUN npm install && rm -r ~/.npm && npm cache clean --force;\n\nADD . /code/\n\nRUN npm run build\nWORKDIR /code\n# TODO: Could be made part of the frontend build script\nRUN bash build-less.sh\n\n"
}