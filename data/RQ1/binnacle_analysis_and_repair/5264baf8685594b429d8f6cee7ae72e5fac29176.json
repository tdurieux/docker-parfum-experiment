{
  "startTime": 1674246581617,
  "endTime": 1674246581995,
  "originalSmells": [
    {
      "rule": "configureShouldUseBuildFlag",
      "position": {
        "lineStart": 58,
        "lineEnd": 58,
        "columnStart": 4,
        "columnEnd": 29
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 23,
        "lineEnd": 35,
        "columnStart": 25,
        "columnEnd": 8
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "############################ Dockerfile for RethinkDB pre 2.4 ############################################\n#\n# This Dockerfile builds a basic installation of RethinkDB\n#\n# RethinkDB is an open-source, distributed database built to store JSON documents and effortlessly scale to\n# multiple machines. It's easy to set up and learn and features a simple but powerful query language that supports\n# table joins, groupings, aggregations, and functions.\n#\n# To build this image, from the directory containing this Dockerfile\n# (assuming that the file is named Dockerfile):\n# docker build -t <image_name> .\n#\n# To start Rethink use:\n# docker run --name <container name> -p <port1>:8080 -p <port2>:28015 -p <port3>:29015 -d <image name>\n#\n################################################################################################################\n\n# Base Image\nFROM s390x/ubuntu:16.04\n\n# The author\nMAINTAINER  LoZ Open Source Ecosystem (https://www.ibm.com/developerworks/community/groups/community/lozopensource)\n\nRUN apt-get update -y && apt-get install --no-install-recommends -y \\\n    build-essential \\\n    git \\\n    libboost-all-dev \\\n    libcurl4-openssl-dev \\\n    libjemalloc-dev \\\n    libncurses5-dev \\\n    libprotobuf-dev \\\n    libssl-dev \\\n    m4 \\\n    protobuf-compiler \\\n    python \\\n    wget \\\n\n#Clone and build RethinkDB\n\n && git clone https://github.com/linux-on-ibm-z/rethinkdb.git --branch next-s390x \\\n && cd rethinkdb/ \\\n && cp mk/support/pkg/jemalloc.sh mk/support/pkg/jemalloc.sh.orig \\\n && sed -i '4d' mk/support/pkg/jemalloc.sh \\\n && sed -i '4 i src_url=https://github.com/jemalloc/jemalloc/releases/download/4.1.0/jemalloc-4.1.0.tar.bz2' mk/support/pkg/jemalloc.sh \\\n\n#Changed for V8\n && cp mk/support/pkg/v8.sh mk/support/pkg/v8.sh.orig \\\n && sed -i '65 i export CXXFLAGS=\"-fno-delete-null-pointer-checks\"' mk/support/pkg/v8.sh \\\n && sed -i '65 s/^/       /' mk/support/pkg/v8.sh \\\n && sed -i '67d ' mk/support/pkg/v8.sh \\\n && sed -i '67 i make dependencies || true'  mk/support/pkg/v8.sh \\\n && sed -i '67 s/^/       /' mk/support/pkg/v8.sh \\\n && sed -i '68d ' mk/support/pkg/v8.sh \\\n && sed -i '68 i make s390x -j4 werror=no snapshot=off library=static'  mk/support/pkg/v8.sh \\\n && sed -i '68 s/^/       /' mk/support/pkg/v8.sh \\\n && sed -i '158d ' mk/support/pkg/v8.sh \\\n && sed -i '158 i  for lib in libv8_{base,libbase,nosnapshot,libplatform}; do'  mk/support/pkg/v8.sh \\\n && sed -i '158 s/^/    /' mk/support/pkg/v8.sh \\\n && ./configure --build=\"$(dpkg-architecture --query DEB_BUILD_GNU_TYPE)\" --allow-fetch \\\n && make -j 4 \\\n\n#Install RethinkDB\n && make install \\\n\n# Clean up cache data and remove dependencies that are not required\n && apt-get remove -y \\\n    build-essential \\\n    git \\\n    make \\\n    m4 \\\n    protobuf-compiler \\\n    python \\\n    wget \\\n && apt autoremove -y \\\n && apt-get clean && rm -rf /var/lib/apt/lists/*  /rethinkdb\n\nVOLUME [\"/data\"]\n\nWORKDIR /data\n\n#   process cluster webui\nEXPOSE 28015 29015 8080\n\n#Start RethinkDB server\nCMD rethinkdb --bind all\n"
}