{
  "startTime": 1674247908492,
  "endTime": 1674247908754,
  "originalSmells": [
    {
      "rule": "yumInstallRmVarCacheYum",
      "position": {
        "lineStart": 24,
        "lineEnd": 24,
        "columnStart": 4,
        "columnEnd": 46
      }
    },
    {
      "rule": "yumInstallRmVarCacheYum",
      "position": {
        "lineStart": 25,
        "lineEnd": 25,
        "columnStart": 4,
        "columnEnd": 34
      }
    },
    {
      "rule": "yumInstallRmVarCacheYum",
      "position": {
        "lineStart": 26,
        "lineEnd": 26,
        "columnStart": 4,
        "columnEnd": 23
      }
    },
    {
      "rule": "yumInstallRmVarCacheYum",
      "position": {
        "lineStart": 27,
        "lineEnd": 27,
        "columnStart": 4,
        "columnEnd": 21
      }
    },
    {
      "rule": "yumInstallRmVarCacheYum",
      "position": {
        "lineStart": 28,
        "lineEnd": 28,
        "columnStart": 4,
        "columnEnd": 23
      }
    },
    {
      "rule": "yumInstallRmVarCacheYum",
      "position": {
        "lineStart": 29,
        "lineEnd": 29,
        "columnStart": 4,
        "columnEnd": 24
      }
    },
    {
      "rule": "yumInstallRmVarCacheYum",
      "position": {
        "lineStart": 30,
        "lineEnd": 30,
        "columnStart": 4,
        "columnEnd": 25
      }
    },
    {
      "rule": "yumInstallRmVarCacheYum",
      "position": {
        "lineStart": 31,
        "lineEnd": 31,
        "columnStart": 4,
        "columnEnd": 24
      }
    },
    {
      "rule": "yumInstallRmVarCacheYum",
      "position": {
        "lineStart": 32,
        "lineEnd": 32,
        "columnStart": 4,
        "columnEnd": 29
      }
    },
    {
      "rule": "yumInstallRmVarCacheYum",
      "position": {
        "lineStart": 33,
        "lineEnd": 33,
        "columnStart": 4,
        "columnEnd": 31
      }
    },
    {
      "rule": "yumInstallRmVarCacheYum",
      "position": {
        "lineStart": 34,
        "lineEnd": 34,
        "columnStart": 4,
        "columnEnd": 22
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "FROM tutum/centos:centos6\nMAINTAINER Eric Stiles <ets04uga@yahoo.com>\n\n#WORKDIR /tmp/\n\n#######################################\n#\n# folders located outside the container to get necessary dependencies\n#\nENV REMOTE_PACKAGES_PATH installables\nENV REMOTE_SCRIPTS_PATH scripts\nENV REMOTE_SUPPORTS_PATH support\n\n# folders for copying dependencies into initially\nENV BASE_CONTAINER_TMP_PATH /tmp/endeca\nENV BASE_CONTAINER_PACKAGES_PATH $BASE_CONTAINER_TMP_PATH/packages\n\n# folders for final installation of endeca programs\nENV BASE_INSTALL_PATH /opt\nENV BASE_ENDECA_PATH $BASE_INSTALL_PATH/endeca\nENV BASE_INSTALL_CUSTOM_SCRIPT_PATH $BASE_ENDECA_PATH/bin\n\n#######################################\n# install necessary OS packages\nRUN yum -y install openssh-server epel-release && \\\n    yum -y install openssh-clients && \\\n    yum -y install wget && \\\n    yum -y install nc && \\\n    yum -y install sudo && \\\n    yum -y install which && \\\n    yum -y install libaio && \\\n    yum -y install pwgen && \\\n    yum -y install glibc.i686 && \\\n    yum -y install unzip.x86_64 && \\\n    yum -y install tar && \\\n    rm -f /etc/ssh/ssh_host_ecdsa_key /etc/ssh/ssh_host_rsa_key && \\\n    ssh-keygen -q -N \"\" -t dsa -f /etc/ssh/ssh_host_ecdsa_key && \\\n    ssh-keygen -q -N \"\" -t rsa -f /etc/ssh/ssh_host_rsa_key && \\\n    sed -i \"s/#UsePrivilegeSeparation.*/UsePrivilegeSeparation no/g\" /etc/ssh/sshd_config && \\\n    sed -i \"s/UsePAM.*/UsePAM yes/g\" /etc/ssh/sshd_config && rm -rf /var/cache/yum\n\n#######################################\n# create directories for copying initial endeca packages\nRUN mkdir -p $BASE_CONTAINER_PACKAGES_PATH\nRUN chmod -R 755 $BASE_CONTAINER_TMP_PATH\n\n# directory for final install of endeca\nRUN mkdir -p $BASE_INSTALL_CUSTOM_SCRIPT_PATH\n#RUN chmod 755 /opt/endeca/bin/*.sh\n\n#######################################\n# start copying across all endeca packages\n#\n#OCplatformservices11.1.0-Linux64.bin\nADD $REMOTE_PACKAGES_PATH/V45999-01.zip $BASE_CONTAINER_PACKAGES_PATH/V45999-01.zip\n\n#OCmdex6.5.1-Linux64_829811.sh\nADD $REMOTE_PACKAGES_PATH/V46002-01.zip $BASE_CONTAINER_PACKAGES_PATH/V46002-01.zip\n\n# Tools And Frameworks\nADD $REMOTE_PACKAGES_PATH/V46389-01.zip $BASE_CONTAINER_PACKAGES_PATH/V46389-01.zip\n\n#######################################\n# Copy script that creates unique password for root and other scripts\nADD $REMOTE_SCRIPTS_PATH/setupEndecaUser.sh $BASE_CONTAINER_TMP_PATH/setupEndecaUser.sh\nRUN chmod +x $BASE_CONTAINER_TMP_PATH/setupEndecaUser.sh\n\n#######################################\n# Copy silent install scripts\nADD $REMOTE_SUPPORTS_PATH/platformservices-silent.txt $BASE_CONTAINER_TMP_PATH/platformservices-silent.txt\n\n#######################################\n#Run commands to create endeca user and modify sudoers\nRUN $BASE_CONTAINER_TMP_PATH/setupEndecaUser.sh\n\n#######################################\n# Unzip all packages to get install scripts and files\nRUN unzip $BASE_CONTAINER_PACKAGES_PATH/V45999-01.zip -d $BASE_CONTAINER_TMP_PATH\nRUN unzip $BASE_CONTAINER_PACKAGES_PATH/V46002-01.zip -d $BASE_CONTAINER_TMP_PATH\nRUN unzip $BASE_CONTAINER_PACKAGES_PATH/V46389-01.zip -d $BASE_CONTAINER_TMP_PATH\n\n#######################################\n# Set scripts to be executable\nRUN chmod +x $BASE_CONTAINER_TMP_PATH/*\n\n#######################################\n# Install mdex 6.5.1\nRUN $BASE_CONTAINER_TMP_PATH/OCmdex6.5.1-Linux64_829811.sh --silent --target $BASE_INSTALL_PATH\n\nRUN touch /home/endeca/.bashrc\nRUN cat $BASE_INSTALL_PATH/endeca/MDEX/6.5.1/mdex_setup_sh.ini >> /home/endeca/.bashrc\nRUN source /home/endeca/.bashrc\n\n# Variables needed to install other applications.  List comes from previous mdex_setup_sh.ini script\nENV ENDECA_MDEX_ROOT=/opt/endeca/endeca/MDEX/6.5.1\n\n#######################################\n# Install platform services\n#\n#OCplatformservices11.1.0-Linux64.bin\nRUN $BASE_CONTAINER_TMP_PATH/OCplatformservices11.1.0-Linux64.bin --silent --target $BASE_INSTALL_PATH < $BASE_CONTAINER_TMP_PATH/platformservices-silent.txt\n\nRUN cat $BASE_INSTALL_PATH/endeca/PlatformServices/workspace/setup/installer_sh.ini >> /home/endeca/.bashrc\n#RUN source /home/endeca/.bashrc\n\n#RUN cat $BASE_INSTALL_PATH/endeca/PlatformServices/workspace/setup/installer_sh.ini\n\n# Variables needed to install other applications.  List comes from previous mdex_setup_sh.ini script\nENV VERSION=11.1.0\nENV BUILD_VERSION=11.1.0.842407\nENV ARCH_OS=x86_64pc-linux\nENV PRODUCT=IAP\nENV ENDECA_INSTALL_BASE=/opt\n\n#  Environment variables required to run the Endeca Platform Services software.\nENV ENDECA_ROOT=/opt/endeca/PlatformServices/11.1.0\nENV PERLLIB=$ENDECA_ROOT/lib/perl:$ENDECA_ROOT/lib/perl/Control:$ENDECA_ROOT/perl/lib:$ENDECA_ROOT/perl/lib/site_perl:$PERLLIB\nENV PERL5LIB=$ENDECA_ROOT/lib/perl:$ENDECA_ROOT/lib/perl/Control:$ENDECA_ROOT/perl/lib:$ENDECA_ROOT/perl/lib/site_perl:$PERL5LIB\nENV ENDECA_CONF=/opt/endeca/PlatformServices/workspace\n\n#  ENDECA_REFERENCE_DIR points to the directory the reference implementations\n#  are installed in.  It is not required to run any Oracle Commerce software.\nENV ENDECA_REFERENCE_DIR=/opt/endeca/PlatformServices/reference\n\n#######################################\n# install Tools and Frameworks\n#\n# set prerequisite environment variables.\n#ENV ENDECA_TOOLS_ROOT /usr/local/endeca/ToolsAndFrameworks/<version>\n#ENV ENDECA_TOOLS_CONF /usr/local/endeca/ToolsAndFrameworks/<version>/server/workspace\n\n#RUN dd if=/dev/zero of=/swapfile bs=1M count=1024\n#RUN mkswap /swapfile\n#RUN chown root:root /swapfile\n#RUN chmod 0600 /swapfile\n#RUN swapon /swapfile\n#RUN /swapfile    swap    swap   defaults 0 0\n\n#RUN free -m\n\n#RUN chown -R endeca.endeca $ENDECA_INSTALL_BASE\n\n\n#Tools And Frameworks install\nRUN chmod -R 777 $BASE_INSTALL_PATH\nUSER endeca\nRUN $BASE_CONTAINER_TMP_PATH/cd/Disk1/install/silent_install.sh $BASE_CONTAINER_TMP_PATH/cd/Disk1/install/silent_response.rsp ToolsAndFrameworks-ets $BASE_INSTALL_PATH/ToolsAndFrameworks-ets2 admin\n\n\n\n#############################################################################\n\n\n#ADD scripts/setup*.sh /\n#ADD scripts/start.sh /appl/endeca/bin/\n#ADD scripts/shutdown.sh /appl/endeca/bin/\n#ADD scripts/captureEndecaLogs.sh /appl/endeca/bin/\n#ADD scripts/installDiscoverApp.sh /appl/endeca/bin/\n\n#######################################\n# Set properties for scripts to be executable\n#RUN chmod +x /*.sh\n#RUN chmos +x /appl/endeca/bin/\n\n\n\n\n\n#text file used for silent install of platform services\n#ADD tools/platformservices-silent.txt /tmp/endeca/platformservices-silent.txt\n\n#cas-3.1.1-x86_64pc-linux.sh\n#ADD tools/V35739-01.zip /tmp/endeca/packages/V35739-01.zip\n\n#text file used or silent install of platform services\n#ADD tools/cas-silent.txt /tmp/endeca/cas-silent.txt\n\n#gs_3.1.1.6904_linux.zip\n#ADD tools/V35740-01.zip /tmp/endeca/packages/V35740-01.zip\n\n#mdex_6.4.0.692722_x86_64pc-linux.sh\n#presAPI_6.4.0.692722_x86_64pc-linux.tgz\n#ADD tools/V35742-01.zip /tmp/endeca/packages/V35742-01.zip\n\n#xmgr_3.1.1.6904_linux.zip\n#ADD tools/V35744-01.zip /tmp/endeca/packages/V35744-01.zip\n\n#relevancy ranking tool\n#ADD tools/V31171-01.zip /tmp/endeca/packages/V31171-01.zip\n\n#######################################\n# Unzip all packages to get install scripts and files\n#RUN unzip /tmp/endeca/packages/V45999-01.zip -d /tmp/endeca\n#RUN unzip /tmp/endeca/packages/V35739-01.zip -d /tmp/endeca\n#RUN unzip /tmp/endeca/packages/V35740-01.zip -d /tmp/endeca\n#RUN unzip /tmp/endeca/packages/V35742-01.zip -d /tmp/endeca\n#RUN unzip /tmp/endeca/packages/V35744-01.zip -d /tmp/endeca\n#RUN unzip /tmp/endeca/packages/V31171-01.zip -d /tmp/endeca\n\n# set permissions of scripts to run\n#RUN chmod +x /tmp/**/*.sh\n\n#######################################\n# install mdex\n#RUN /tmp/endeca/mdex_6.4.0.692722_x86_64pc-linux.sh --target /appl\n\n# copy mdex environment variables to .bashrc\n#RUN /setup2.sh\n\n# set mdex environment variables for rest of install\n#ENV ENDECA_MDEX_ROOT=/appl/endeca/MDEX/6.4.0\n#ENV PATH=$ENDECA_MDEX_ROOT/bin:$PATH\n\n#######################################\n# install platform services\n#RUN /tmp/endeca/platformservices_613654721_x86_64pc-linux.sh --silent --target /appl < /tmp/endeca/platformservices-silent.txt\n\n# copy platform services environment variables to .bashrc\n#RUN /setup3.sh\n\n# set platform services variables for rest of install\n#ENV VERSION=6.1.3\n#ENV BUILD_VERSION=6.1.3.654721\n#ENV ARCH_OS=x86_64pc-linux\n#ENV PRODUCT=IAP\n#ENV ENDECA_INSTALL_BASE=/appl\n#ENV ENDECA_ROOT=/appl/endeca/PlatformServices/6.1.3\n#ENV PERLLIB=$ENDECA_ROOT/lib/perl:$ENDECA_ROOT/lib/perl/Control:$ENDECA_ROOT/perl/lib:$ENDECA_ROOT/perl/lib/site_perl:$PERLLIB\n#ENV PERL5LIB=$ENDECA_ROOT/lib/perl:$ENDECA_ROOT/lib/perl/Control:$ENDECA_ROOT/perl/lib:$ENDECA_ROOT/perl/lib/site_perl:$PERL5LIB\n#ENV PATH=$ENDECA_ROOT/bin:$ENDECA_ROOT/perl/bin:$ENDECA_ROOT/utilities:$PATH\n#ENV ENDECA_CONF=/appl/endeca/PlatformServices/workspace\n\n#  ENDECA_REFERENCE_DIR points to the directory the reference implementations\n#  are installed in.  It is not required to run any Endeca software.\n#ENV ENDECA_REFERENCE_DIR=/appl/endeca/PlatformServices/reference\n\n#######################################\n# install Tools and Frameworks\n#\n# unip ToolsAndFrameworks\n#RUN unzip /tmp/endeca/xmgr_3.1.1.6904_linux.zip -d /appl/endeca/\n\n# copy tools and frameworks environment variables to .bashrc\n#RUN /setup4.sh\n\n# set tools and frameworks variables for rest of install\n#ENV ENDECA_TOOLS_ROOT=/appl/endeca/ToolsAndFrameworks/3.1.1/\n#ENV ENDECA_TOOLS_CONF=/appl/endeca/ToolsAndFrameworks/3.1.1/server/workspace\n#echo 'ENDECA_TOOLS_ROOT=/appl/endeca/ToolsAndFrameworks/3.1.1/' >> /home/endeca/.bashrc\n#echo 'ENDECA_TOOLS_CONF=/appl/endeca/ToolsAndFrameworks/3.1.1/server/workspace' >> /home/endeca/.bashrc\n\n#######################################\n# install CAS\n#RUN /tmp/endeca/cas-3.1.1-x86_64pc-linux.sh --silent --target /appl < /tmp/endeca/cas-silent.txt\n\n#######################################\n# install relevancy evaluator\n#RUN mv /tmp/endeca/Endeca/Solutions /appl/endeca\n\n#RUN cp /appl/endeca/ToolsAndFrameworks/3.1.1/assembler/lib/endeca_navigation-6.4.0.jar /appl/endeca/Solutions/relrankEvaluator-2.1.2/relrankEvaluator/WEB-INF/lib/endeca_navigation.jar\n\n# write context into relrankEvaluator.xml file\n#RUN /setup5.sh\n\n# place correct extensions file\n#ADD tools/ws-extensions.xml /appl/endeca/ToolsAndFrameworks/3.1.1/server/workspace/conf/ws-extensions.xml\n\n# place correct menu items\n#ADD tools/ws-mainMenu.xml /appl/endeca/ToolsAndFrameworks/3.1.1/server/workspace/conf/ws-mainMenu.xml\n\n#######################################\n# create apps directory\n#RUN mkdir /appl/endeca/apps\n\n#######################################\n# set user and permissions to endeca\n#RUN chown -R endeca.endeca /appl/endeca/\n\n#######################################\n# install is done start cleanup to remove initial packages\n#RUN rm -rf /tmp/endeca\n##RUN rm setup*.sh\n\n#RUN printenv\n\n#ENV AUTHORIZED_KEYS **None**\n\n#EXPOSE 22\nUSER root\nCMD [\"/run.sh\"]\n"
}