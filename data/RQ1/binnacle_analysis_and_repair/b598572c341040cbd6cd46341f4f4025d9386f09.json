{
  "startTime": 1674237160518,
  "endTime": 1674237160993,
  "originalSmells": [
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 78,
        "lineEnd": 78,
        "columnStart": 4,
        "columnEnd": 70
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "FROM metacell/java-virgo-maven:development\nLABEL maintainer=\"Facundo Rodriguez <facundo@metacell.us>\"\n\nARG aKey\nENV aKey=${aKey}\nARG sKey\nENV sKey=${sKey}\n\nARG targetBranch=master\nARG originBranch=master\nARG defaultBranch=master\nRUN /bin/echo -e \"\\e[1;35mORIGIN BRANCH ------------ $originBranch\\e[0m\" &&\\\n  /bin/echo -e \"\\e[1;35mTARGET BRANCH ------------ $targetBranch\\e[0m\" &&\\\n  /bin/echo -e \"\\e[1;35mDEFAULT BRANCH ------------ $defaultBranch\\e[0m\"\n\n# get geppetto\nRUN mkdir -p workspace &&\\\n  cd workspace &&\\\n  ../copy.sh http://github.com/openworm/org.geppetto.git \"${targetBranch}\" \"${originBranch}\" \"${defaultBranch}\"\n\nCOPY config.json workspace/org.geppetto/utilities/source_setup/\nRUN sudo mv /home/developer/workspace/org.geppetto/utilities/docker/geppetto-persistence/geppetto.plan /home/developer\nCOPY geppetto.plan workspace/org.geppetto/\n\nWORKDIR $HOME/workspace\nRUN ../copy.sh https://github.com/openworm/org.geppetto.model.git \"${targetBranch}\" \"${originBranch}\" \"${defaultBranch}\" &&\\\n  cd org.geppetto.model &&\\\n  /bin/echo -e \"\\e[96mMaven install org.geppetto.model\\e[0m\" &&\\\n  mvn --quiet install &&\\\n  rm -rf src\n\nRUN ../copy.sh https://github.com/openworm/org.geppetto.core.git \"${targetBranch}\" \"${originBranch}\" \"${defaultBranch}\" &&\\\n  cd org.geppetto.core &&\\\n  /bin/echo -e \"\\e[96mMaven install org.geppetto.core\\e[0m\" &&\\\n  mvn --quiet install &&\\\n  rm -rf src\n\nRUN ../copy.sh https://github.com/openworm/org.geppetto.model.neuroml.git \"${targetBranch}\" \"${originBranch}\" \"${defaultBranch}\" &&\\\n  cd org.geppetto.model.neuroml &&\\\n  /bin/echo -e \"\\e[96mMaven install org.geppetto.model.neuroml\\e[0m\" &&\\\n  mvn --quiet install &&\\\n  rm -rf src\n\nRUN ../copy.sh https://github.com/openworm/org.geppetto.simulation.git \"${targetBranch}\" \"${originBranch}\" \"${defaultBranch}\" &&\\\n  cd org.geppetto.simulation &&\\\n  /bin/echo -e \"\\e[96mMaven install org.geppetto.simulation\\e[0m\" &&\\\n  mvn --quiet install &&\\\n  rm -rf src\n\nRUN ../copy.sh https://github.com/openworm/org.geppetto.frontend.git \"${targetBranch}\" \"${originBranch}\" \"${defaultBranch}\"\n\nRUN cd $HOME/workspace/org.geppetto.frontend/src/main &&\\\n  $HOME/copy.sh https://github.com/openworm/geppetto-application.git \"${targetBranch}\" \"${originBranch}\" \"${defaultBranch}\" &&\\\n  mv geppetto-application webapp\n\nRUN cd $HOME/workspace/org.geppetto.frontend/src/main/webapp &&\\\n  $HOME/rename.sh https://github.com/openworm/geppetto-client.git \"${targetBranch}\" \"${originBranch}\" \"${defaultBranch}\"\n\nRUN cd $HOME/workspace/org.geppetto.frontend &&\\\n  mvn --quiet install &&\\\n  rm -rf src\n\nRUN ../copy.sh https://github.com/openworm/org.geppetto.persistence.git \"${targetBranch}\" \"${originBranch}\" \"${defaultBranch}\" &&\\\n  cd org.geppetto.persistence &&\\\n  /bin/echo -e \"\\e[96mMaven install org.geppetto.persistence\\e[0m\" &&\\\n  mvn --quiet install\n\nWORKDIR $HOME\n#END GET GEPPETTO SOURCES\n\n#INSTALL MYSQL\nUSER root\nENV MYSQL_USER=mysql \\\n    MYSQL_DATA_DIR=/var/lib/mysql \\\n    MYSQL_RUN_DIR=/run/mysqld \\\n    MYSQL_LOG_DIR=/var/log/mysql\n\nRUN apt-get -o Acquire::Check-Valid-Until=false update \\\n && DEBIAN_FRONTEND=noninteractive apt-get --no-install-recommends install -qq -y mysql-server \\\n && rm -rf ${MYSQL_DATA_DIR} \\\n && rm -rf /var/lib/apt/lists/*\n\nRUN mkdir -p ${MYSQL_DATA_DIR} && mkdir -p ${MYSQL_RUN_DIR} && \\\n  mkdir -p ${MYSQL_LOG_DIR}\n\nUSER developer\n\n#SETUP MYSQL CONFIG\nRUN mkdir -p geppetto/\nRUN mkdir rm /home/developer/virgo/./repository/usr\nCOPY db.properties geppetto/\nCOPY init.sql geppetto/\n#COPY entrypoint.sh geppetto/\n#RUN sudo chmod +x geppetto/entrypoint.sh\n#END SETUP MYSQL CONFIG\n\n#SETUP MYSQL INITIAL DATA\nUSER root\nRUN mysql_install_db --user=mysql >/dev/null 2>&1\nRUN sed 's/password = .*/password = /g' -i /etc/mysql/debian.cnf\nRUN service mysql start && mysql -uroot < /home/developer/geppetto/init.sql\n#END SETUP MYSQL INITIAL DATA\n\nUSER developer\n# RUN cd /home/developer/workspace/org.geppetto.persistence && mvn install --quiet && mvn install\n\nRUN sudo service mysql start && cd /home/developer/workspace/org.geppetto.persistence && mvn exec:java -Dexec.mainClass=\"org.geppetto.persistence.util.DBTestData\" -Dexec.classpathScope=runtime\n\n#END INSTALL MYSQL\n\nRUN cd /home/developer/workspace/org.geppetto/utilities/source_setup && python update_server.py\n\nRUN sudo echo \"accessKey=$aKey\" > /home/developer/geppetto/aws.credentials\nRUN sudo echo \"secretKey=$sKey\" >> /home/developer/geppetto/aws.credentials\n\nEXPOSE 8080\nCMD sudo service mysql start && /home/developer/virgo/bin/startup.sh\n"
}