{
  "startTime": 1674248206459,
  "endTime": 1674248206552,
  "originalSmells": [
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 18,
        "lineEnd": 18,
        "columnStart": 4,
        "columnEnd": 64
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 44,
        "lineEnd": 44,
        "columnStart": 4,
        "columnEnd": 32
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "FROM phusion/passenger-customizable:0.9.18\nRUN rm -rf /etc/service/sshd /etc/my_init.d/00_regen_ssh_host_keys.sh\nENV DEBIAN_FRONTEND noninteractive\nENV TERM screen\n\n# Use baseimage-docker's init process.\nCMD [\"/sbin/my_init\"]\n\n# Build system and git.\nRUN /pd_build/utilities.sh\n\n# Add node 4.x.\nRUN echo \"\\\ndeb https://deb.nodesource.com/node_4.x trusty main\\n\\\ndeb-src https://deb.nodesource.com/node_4.x trusty main\\n\\\n\" > /etc/apt/sources.list.d/nodesource.list\n\n# And its key.\nRUN curl -f -s https://deb.nodesource.com/gpgkey/nodesource.gpg.key | apt-key add -\n\n# Add acmetool https://github.com/hlandau/acme to supprt let's encrypt.\nRUN echo \"\\\ndeb http://ppa.launchpad.net/hlandau/rhea/ubuntu trusty main\\n\\\ndeb-src http://ppa.launchpad.net/hlandau/rhea/ubuntu trusty main\\n\\\n\" > /etc/apt/sources.list.d/acmetool.list\n\n# And its key.\nRUN apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 9862409EF124EC763B84972FF5AC9651EDB58DFA\n\n# Install certificate for OCSP stapling.\nADD certs/lets-encrypt-x1-cross-signed.pem /etc/ssl/certs/lets-encrypt-x1-cross-signed.pem\n\n# Install the default cronjob (to auto-renew certificates).\nRUN echo \"\\\nSHELL=/bin/sh\\n\\\nPATH=/bin:/sbin:/usr/bin:/usr/sbin:/usr/local/bin:/usr/local/sbin\\n\\\nMAILTO=root\\n\\\n15 4 * * * root /usr/bin/acmetool --batch reconcile\\n\\\n\" > /etc/cron.d/acmetool\n\n# Install the latest available package and clean up APT when done.\nENV APTLIST=\"nodejs acmetool\"\n\nRUN apt-get update -q && \\\n    apt-get install --no-install-recommends -qy $APTLIST && \\\n    apt-get clean && rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/*\n\n# Enable nginx as a reverse-proxy.\nRUN rm -f /etc/service/nginx/down\n\n# Disable default config.\nRUN rm /etc/nginx/sites-enabled/default\n\n# Add app config.\nADD sites-enabled/webapp.conf /etc/nginx/sites-enabled/webapp.conf\n\n# App root.\nRUN mkdir /home/app/webapp\n\n# Add service files.\nADD init/ /etc/my_init.d/\nRUN chmod -v +x /etc/my_init.d/*.sh\n\nEXPOSE 80 443\n"
}