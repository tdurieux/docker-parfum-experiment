{
  "startTime": 1674245751117,
  "endTime": 1674245751547,
  "originalSmells": [
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 56,
        "lineEnd": 56,
        "columnStart": 4,
        "columnEnd": 29
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 59,
        "lineEnd": 59,
        "columnStart": 4,
        "columnEnd": 33
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 39,
        "lineEnd": 39,
        "columnStart": 4,
        "columnEnd": 38
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 40,
        "lineEnd": 40,
        "columnStart": 4,
        "columnEnd": 88
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 41,
        "lineEnd": 41,
        "columnStart": 4,
        "columnEnd": 26
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 42,
        "lineEnd": 42,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 43,
        "lineEnd": 43,
        "columnStart": 4,
        "columnEnd": 36
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 44,
        "lineEnd": 44,
        "columnStart": 4,
        "columnEnd": 33
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 45,
        "lineEnd": 45,
        "columnStart": 4,
        "columnEnd": 30
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 46,
        "lineEnd": 46,
        "columnStart": 4,
        "columnEnd": 33
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 47,
        "lineEnd": 47,
        "columnStart": 4,
        "columnEnd": 33
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 48,
        "lineEnd": 48,
        "columnStart": 4,
        "columnEnd": 34
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 49,
        "lineEnd": 49,
        "columnStart": 4,
        "columnEnd": 35
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 50,
        "lineEnd": 50,
        "columnStart": 4,
        "columnEnd": 35
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 51,
        "lineEnd": 51,
        "columnStart": 4,
        "columnEnd": 39
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 52,
        "lineEnd": 52,
        "columnStart": 4,
        "columnEnd": 32
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 53,
        "lineEnd": 53,
        "columnStart": 4,
        "columnEnd": 35
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 54,
        "lineEnd": 54,
        "columnStart": 4,
        "columnEnd": 33
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 55,
        "lineEnd": 55,
        "columnStart": 4,
        "columnEnd": 31
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 66,
        "lineEnd": 66,
        "columnStart": 4,
        "columnEnd": 45
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 39,
        "lineEnd": 39,
        "columnStart": 4,
        "columnEnd": 38
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 40,
        "lineEnd": 40,
        "columnStart": 4,
        "columnEnd": 88
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 41,
        "lineEnd": 41,
        "columnStart": 4,
        "columnEnd": 26
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 42,
        "lineEnd": 42,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 43,
        "lineEnd": 43,
        "columnStart": 4,
        "columnEnd": 36
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 44,
        "lineEnd": 44,
        "columnStart": 4,
        "columnEnd": 33
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 45,
        "lineEnd": 45,
        "columnStart": 4,
        "columnEnd": 30
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 46,
        "lineEnd": 46,
        "columnStart": 4,
        "columnEnd": 33
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 47,
        "lineEnd": 47,
        "columnStart": 4,
        "columnEnd": 33
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 48,
        "lineEnd": 48,
        "columnStart": 4,
        "columnEnd": 34
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 49,
        "lineEnd": 49,
        "columnStart": 4,
        "columnEnd": 35
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 50,
        "lineEnd": 50,
        "columnStart": 4,
        "columnEnd": 35
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 51,
        "lineEnd": 51,
        "columnStart": 4,
        "columnEnd": 39
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 52,
        "lineEnd": 52,
        "columnStart": 4,
        "columnEnd": 32
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 53,
        "lineEnd": 53,
        "columnStart": 4,
        "columnEnd": 35
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 54,
        "lineEnd": 54,
        "columnStart": 4,
        "columnEnd": 33
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 55,
        "lineEnd": 55,
        "columnStart": 4,
        "columnEnd": 31
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 66,
        "lineEnd": 66,
        "columnStart": 4,
        "columnEnd": 45
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "FROM ubuntu:16.04\n\nMAINTAINER jeremy.elster@b2wdigital.com\n\nENV SLEEP_MILLIS 0\n\nUSER root\n\n##############################################################\n# Define all environment variables to be used\n##############################################################\n\nENV MARVIN_HOME=/opt/marvin\nENV MARVIN_DATA_PATH=/marvin-data\nENV MARVIN_ENGINE_HOME=$MARVIN_HOME/engine\nENV MARVIN_ENGINE_ENV=marvin-engine-env\nENV WORKON_HOME=$MARVIN_HOME/.virtualenvs\nENV SPARK_HOME=/opt/spark\nENV SPARK_CONF_DIR=$SPARK_HOME/conf\nENV HADOOP_CONF_DIR=$SPARK_CONF_DIR\nENV YARN_CONF_DIR=$SPARK_CONF_DIR\n\n\n##############################################################\n# Create all folders needed\n##############################################################\n\nRUN mkdir -p $MARVIN_HOME && \\\n    mkdir -p $MARVIN_DATA_PATH && \\\n    mkdir -p $MARVIN_ENGINE_HOME && \\\n    mkdir -p /var/log/marvin/engines && \\\n    mkdir -p /var/run/marvin/engines\n\n\n##############################################################\n# Install the system dependencies for default installation\n##############################################################\n\nRUN apt-get update -y && \\\n    apt-get install --no-install-recommends -y build-essential && \\\n    apt-get install --no-install-recommends -y maven git python cmake software-properties-common curl libstdc++6 && \\\n    apt-get install --no-install-recommends -y git && \\\n    apt-get install --no-install-recommends -y wget && \\\n    apt-get install --no-install-recommends -y python2.7-dev && \\\n    apt-get install --no-install-recommends -y python-pip && \\\n    apt-get install --no-install-recommends -y ipython && \\\n    apt-get install --no-install-recommends -y libffi-dev && \\\n    apt-get install --no-install-recommends -y libssl-dev && \\\n    apt-get install --no-install-recommends -y libxml2-dev && \\\n    apt-get install --no-install-recommends -y libxslt1-dev && \\\n    apt-get install --no-install-recommends -y libpng12-dev && \\\n    apt-get install --no-install-recommends -y libfreetype6-dev && \\\n    apt-get install --no-install-recommends -y python-tk && \\\n    apt-get install --no-install-recommends -y libsasl2-dev && \\\n    apt-get install --no-install-recommends -y python-pip && \\\n    apt-get install --no-install-recommends -y graphviz && \\\n    pip install --no-cache-dir --upgrade pip && \\\n    apt-get clean && rm -rf /var/lib/apt/lists/*;\n\nRUN pip install --no-cache-dir virtualenvwrapper\n\n# Install Oracle JDK\nRUN add-apt-repository ppa:webupd8team/java -y && \\\n    apt-get -qq update && \\\n    echo debconf shared/accepted-oracle-license-v1-1 select true | debconf-set-selections && \\\n    echo debconf shared/accepted-oracle-license-v1-1 seen true | debconf-set-selections && \\\n    apt-get install --no-install-recommends -y oracle-java8-installer && rm -rf /var/lib/apt/lists/*;\n\n\n##############################################################\n# Install Apache Spark\n#\n# Uncomment if you are using spark, note that is needed the\n# spark configuration files to the think works correctly.\n##############################################################\n\n# RUN curl https://d3kbcqa49mib13.cloudfront.net/spark-2.1.1-bin-hadoop2.6.tgz -o /tmp/spark-2.1.1-bin-hadoop2.6.tgz && \\\n#    tar -xf /tmp/spark-2.1.1-bin-hadoop2.6.tgz -C /opt/ && \\\n#    ln -s /opt/spark-2.1.1-bin-hadoop2.6 /opt/spark\n\n# Add the b2w datalake config for Spark\n# ADD spark-conf.tar $SPARK_CONF_DIR\nRUN mkdir -p $SPARK_CONF_DIR\n\n##############################################################\n# Create the virtualenv configuration\n##############################################################\n\nRUN /bin/bash -c \"cd $MARVIN_ENGINE_HOME && \\\n    source /usr/local/bin/virtualenvwrapper.sh && \\\n    mkvirtualenv $MARVIN_ENGINE_ENV\"\n\n\n##############################################################\n#        <CUSTOM ENGINE INSTALLATION PROCEDURE HERE>         #\n##############################################################\n\n\n##############################################################\n# Copy and Install the marvin engine inside virtualenv\n##############################################################\n\nADD build/engine.tar $MARVIN_ENGINE_HOME\n\nADD build/marvin-engine-executor-assembly.jar $MARVIN_DATA_PATH\n\nRUN /bin/bash -c \"source /usr/local/bin/virtualenvwrapper.sh && \\\n    workon $MARVIN_ENGINE_ENV && \\\n    cd $MARVIN_ENGINE_HOME && \\\n    pip install . --process-dependency-links\"\n\n\n##############################################################\n# Starts the engine http server\n##############################################################\n\nEXPOSE 8000\n\nCMD /bin/bash -c \"source /usr/local/bin/virtualenvwrapper.sh && \\\n    workon $MARVIN_ENGINE_ENV && \\\n    cd $MARVIN_ENGINE_HOME && \\\n    marvin engine-httpserver -h 0.0.0.0 -p 8000\""
}