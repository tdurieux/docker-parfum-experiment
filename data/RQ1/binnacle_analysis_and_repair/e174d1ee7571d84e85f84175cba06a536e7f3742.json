{
  "startTime": 1674243176904,
  "endTime": 1674243177470,
  "originalSmells": [
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 8,
        "lineEnd": 8,
        "columnStart": 5,
        "columnEnd": 51
      }
    },
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 76,
        "lineEnd": 76,
        "columnStart": 4,
        "columnEnd": 100
      }
    },
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 88,
        "lineEnd": 88,
        "columnStart": 4,
        "columnEnd": 71
      }
    },
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 112,
        "lineEnd": 112,
        "columnStart": 4,
        "columnEnd": 105
      }
    },
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 126,
        "lineEnd": 126,
        "columnStart": 4,
        "columnEnd": 78
      }
    },
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 131,
        "lineEnd": 131,
        "columnStart": 4,
        "columnEnd": 80
      }
    },
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 164,
        "lineEnd": 164,
        "columnStart": 4,
        "columnEnd": 85
      }
    },
    {
      "rule": "npmCacheCleanAfterInstall",
      "position": {
        "lineStart": 10,
        "lineEnd": 10,
        "columnStart": 4,
        "columnEnd": 33
      }
    },
    {
      "rule": "curlUseHttpsUrl",
      "position": {
        "lineStart": 76,
        "lineEnd": 76,
        "columnStart": 4,
        "columnEnd": 100
      }
    },
    {
      "rule": "curlUseHttpsUrl",
      "position": {
        "lineStart": 112,
        "lineEnd": 112,
        "columnStart": 4,
        "columnEnd": 105
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 157,
        "lineEnd": 157,
        "columnStart": 4,
        "columnEnd": 36
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 158,
        "lineEnd": 158,
        "columnStart": 4,
        "columnEnd": 40
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 159,
        "lineEnd": 159,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "pipUseNoCacheDir",
      "position": {
        "lineStart": 182,
        "lineEnd": 182,
        "columnStart": 4,
        "columnEnd": 24
      }
    },
    {
      "rule": "configureShouldUseBuildFlag",
      "position": {
        "lineStart": 68,
        "lineEnd": 68,
        "columnStart": 4,
        "columnEnd": 15
      }
    },
    {
      "rule": "tarSomethingRmTheSomething",
      "position": {
        "lineStart": 113,
        "lineEnd": 113,
        "columnStart": 4,
        "columnEnd": 46
      }
    },
    {
      "rule": "aptGetInstallUseY",
      "position": {
        "lineStart": 165,
        "lineEnd": 165,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 7,
        "lineEnd": 7,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 9,
        "lineEnd": 9,
        "columnStart": 5,
        "columnEnd": 30
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 13,
        "lineEnd": 49,
        "columnStart": 4,
        "columnEnd": 16
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 52,
        "lineEnd": 61,
        "columnStart": 4,
        "columnEnd": 16
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 122,
        "lineEnd": 122,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 165,
        "lineEnd": 165,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 7,
        "lineEnd": 7,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 9,
        "lineEnd": 9,
        "columnStart": 5,
        "columnEnd": 30
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 13,
        "lineEnd": 49,
        "columnStart": 4,
        "columnEnd": 16
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 52,
        "lineEnd": 61,
        "columnStart": 4,
        "columnEnd": 16
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 96,
        "lineEnd": 99,
        "columnStart": 4,
        "columnEnd": 26
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 122,
        "lineEnd": 122,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 165,
        "lineEnd": 165,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 7,
        "lineEnd": 7,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 9,
        "lineEnd": 9,
        "columnStart": 5,
        "columnEnd": 30
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 13,
        "lineEnd": 49,
        "columnStart": 4,
        "columnEnd": 16
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 52,
        "lineEnd": 61,
        "columnStart": 4,
        "columnEnd": 16
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 96,
        "lineEnd": 99,
        "columnStart": 4,
        "columnEnd": 26
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 122,
        "lineEnd": 122,
        "columnStart": 4,
        "columnEnd": 27
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 165,
        "lineEnd": 165,
        "columnStart": 4,
        "columnEnd": 27
      }
    }
  ],
  "repairedSmells": [
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 7,
        "lineEnd": 7,
        "columnStart": 4,
        "columnEnd": 51
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 9,
        "lineEnd": 9,
        "columnStart": 5,
        "columnEnd": 54
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 13,
        "lineEnd": 49,
        "columnStart": 4,
        "columnEnd": 16
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 52,
        "lineEnd": 61,
        "columnStart": 4,
        "columnEnd": 16
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 96,
        "lineEnd": 99,
        "columnStart": 4,
        "columnEnd": 26
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 122,
        "lineEnd": 122,
        "columnStart": 4,
        "columnEnd": 51
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 165,
        "lineEnd": 165,
        "columnStart": 4,
        "columnEnd": 54
      }
    }
  ],
  "repairedDockerfile": "#using neurodebian runtime as parent image\nFROM neurodebian:xenial-non-free\nMAINTAINER The C-PAC Team <cnl@childmind.org>\n\nRUN apt-get update\n\n# Install the validator\nRUN apt-get install --no-install-recommends -y curl && \\\n     curl -f -sL https://deb.nodesource.com/setup_11.x | bash - && \\\n     apt-get install --no-install-recommends -y nodejs && rm -rf /var/lib/apt/lists/*;\nRUN npm install -g bids-validator && npm cache clean --force;\n\n# Install Ubuntu dependencies\nRUN apt-get install --no-install-recommends -y \\\n      build-essential \\\n      cmake \\\n      git \\\n      graphviz \\\n      graphviz-dev \\\n      gsl-bin \\\n      libcanberra-gtk-module \\\n      libexpat1-dev \\\n      libgiftiio-dev \\\n      libglib2.0-dev \\\n      libglu1-mesa \\\n      libglu1-mesa-dev \\\n      libjpeg-progs \\\n      libgl1-mesa-dri \\\n      libglw1-mesa \\\n      libxml2 \\\n      libxml2-dev \\\n      libxext-dev \\\n      libxft2 \\\n      libxft-dev \\\n      libxi-dev \\\n      libxmu-headers \\\n      libxmu-dev \\\n      libxpm-dev \\\n      libxslt1-dev \\\n      m4 \\\n      make \\\n      mesa-common-dev \\\n      mesa-utils \\\n      netpbm \\\n      pkg-config \\\n      tcsh \\\n      unzip \\\n      xvfb \\\n      xauth \\\n      zlib1g-dev && rm -rf /var/lib/apt/lists/*;\n\n# Install 16.04 dependencies\nRUN apt-get install --no-install-recommends -y \\\n      dh-autoreconf \\\n      libgsl-dev \\\n      libmotif-dev \\\n      libtool \\\n      libx11-dev \\\n      libxext-dev \\\n      x11proto-xext-dev \\\n      x11proto-print-dev \\\n      xutils-dev && rm -rf /var/lib/apt/lists/*;\n\n# Compiles libxp- this is necessary for some newer versions of Ubuntu\n# where the is no Debian package available.\nRUN git clone git://anongit.freedesktop.org/xorg/lib/libXp /tmp/libXp && \\\n    cd /tmp/libXp && \\\n    ./autogen.sh && \\\n    ./configure --build=\"$(dpkg-architecture --query DEB_BUILD_GNU_TYPE)\" && \\\n    make && \\\n    make install && \\\n    cd - && \\\n    rm -rf /tmp/libXp\n\n# Installing and setting up c3d\nRUN mkdir -p /opt/c3d && \\\n    curl -f -sSL \"https://downloads.sourceforge.net/project/c3d/c3d/1.0.0/c3d-1.0.0-Linux-x86_64.tar.gz\" \\\n    | tar -xzC /opt/c3d --strip-components 1\nENV C3DPATH /opt/c3d/\nENV PATH $C3DPATH/bin:$PATH\n\n# install AFNI\nCOPY dev/docker_data/required_afni_pkgs.txt /opt/required_afni_pkgs.txt\nRUN libs_path=/usr/lib/x86_64-linux-gnu && \\\n    if [ -f $libs_path/libgsl.so.19 ]; then \\\n        ln $libs_path/libgsl.so.19 $libs_path/libgsl.so.0; \\\n    fi && \\\n    mkdir -p /opt/afni && \\\n    curl -f -sO https://afni.nimh.nih.gov/pub/dist/tgz/linux_openmp_64.tgz && \\\n    tar zxv -C /opt/afni --strip-components=1 -f linux_openmp_64.tgz $(cat /opt/required_afni_pkgs.txt) && \\\n    rm -rf linux_openmp_64.tgz\n\n# set up AFNI\nENV PATH=/opt/afni:$PATH\n\n# install FSL\nRUN apt-get install -y --no-install-recommends \\\n      fsl-core \\\n      fsl-atlases \\\n      fsl-mni152-templates && rm -rf /var/lib/apt/lists/*;\n\n# setup FSL environment\nENV FSLDIR=/usr/share/fsl/5.0 \\\n    FSLOUTPUTTYPE=NIFTI_GZ \\\n    FSLMULTIFILEQUIT=TRUE \\\n    POSSUMDIR=/usr/share/fsl/5.0 \\\n    LD_LIBRARY_PATH=/usr/lib/fsl/5.0:$LD_LIBRARY_PATH \\\n    FSLTCLSH=/usr/bin/tclsh \\\n    FSLWISH=/usr/bin/wish \\\n    PATH=/usr/lib/fsl/5.0:$PATH\n\n# install CPAC resources into FSL\nRUN curl -f -sL https://fcon_1000.projects.nitrc.org/indi/cpac_resources.tar.gz -o /tmp/cpac_resources.tar.gz && \\\n    tar xfz /tmp/cpac_resources.tar.gz -C /tmp && \\\n    cp -n /tmp/cpac_image_resources/MNI_3mm/* $FSLDIR/data/standard && \\\n    cp -n /tmp/cpac_image_resources/MNI_4mm/* $FSLDIR/data/standard && \\\n    cp -n /tmp/cpac_image_resources/symmetric/* $FSLDIR/data/standard && \\\n    cp -n /tmp/cpac_image_resources/HarvardOxford-lateral-ventricles-thr25-2mm.nii.gz $FSLDIR/data/atlases/HarvardOxford && \\\n    cp -nr /tmp/cpac_image_resources/tissuepriors/2mm $FSLDIR/data/standard/tissuepriors && \\\n    cp -nr /tmp/cpac_image_resources/tissuepriors/3mm $FSLDIR/data/standard/tissuepriors && rm /tmp/cpac_resources.tar.gz\n\n# install ANTs\nRUN apt-get install --no-install-recommends -y ants && rm -rf /var/lib/apt/lists/*;\n\n# install ICA-AROMA\nRUN mkdir -p /opt/ICA-AROMA\nRUN curl -f -sL https://github.com/rhr-pruim/ICA-AROMA/archive/v0.4.3-beta.tar.gz | tar -xzC /opt/ICA-AROMA --strip-components 1\nRUN chmod +x /opt/ICA-AROMA/ICA_AROMA.py\nENV PATH=/opt/ICA-AROMA:$PATH\n\n# install miniconda\nRUN curl -f -sO https://repo.continuum.io/miniconda/Miniconda-3.8.3-Linux-x86_64.sh && \\\n    bash Miniconda-3.8.3-Linux-x86_64.sh -b -p /usr/local/miniconda && \\\n    rm Miniconda-3.8.3-Linux-x86_64.sh\n\n# update path to include conda\nENV PATH=/usr/local/miniconda/bin:$PATH\n\n# install blas dependency first\nRUN conda install -y \\\n        blas\n\n# install conda dependencies\nRUN conda install -y  \\\n        cython==0.26 \\\n        matplotlib=2.0.2 \\\n        networkx==1.11 \\\n        nose==1.3.7 \\\n        numpy==1.13.0 \\\n        pandas==0.23.4 \\\n        scipy==1.2.1 \\\n        traits==4.6.0 \\\n        wxpython==3.0.0.0 \\\n        pip\n\n# install python dependencies\nCOPY requirements.txt /opt/requirements.txt\nRUN pip install --no-cache-dir --upgrade pip==9.0.1\nRUN pip install --no-cache-dir -r /opt/requirements.txt\nRUN pip install --no-cache-dir xvfbwrapper\n\n# install cpac templates\nADD dev/docker_data/cpac_templates.tar.gz /\n\nRUN curl -f -s https://packagecloud.io/install/repositories/github/git-lfs/script.deb.sh | bash\nRUN apt-get install -y --no-install-recommends git-lfs && rm -rf /var/lib/apt/lists/*;\nRUN git lfs install\n\n# Get atlases\nRUN mkdir /ndmg_atlases && \\\n    GIT_LFS_SKIP_SMUDGE=1 git clone https://github.com/neurodata/neuroparc.git /tmp/neuroparc && \\\n    cd /tmp/neuroparc && \\\n    git lfs pull -I \"atlases/label/*\" && \\\n    cp -r /tmp/neuroparc/atlases/label /ndmg_atlases/label && \\\n    cd -\n\n\nCOPY dev/docker_data/default_pipeline.yml /cpac_resources/default_pipeline.yml\nCOPY dev/circleci_data/pipe-test_ci.yml /cpac_resources/pipe-test_ci.yml\n\n\nCOPY . /code\nRUN pip install --no-cache-dir -e /code\n\nCOPY dev/docker_data /code/docker_data\nRUN mv /code/docker_data/* /code && rm -Rf /code/docker_data && chmod +x /code/run.py\n\nENTRYPOINT [\"/code/run.py\"]\n\n\nRUN apt-get clean && \\\n    apt-get autoremove -y && \\\n    rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/*"
}