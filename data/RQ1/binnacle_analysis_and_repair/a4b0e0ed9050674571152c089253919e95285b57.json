{
  "startTime": 1674242548591,
  "endTime": 1674242548905,
  "originalSmells": [
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 53,
        "lineEnd": 53,
        "columnStart": 4,
        "columnEnd": 76
      }
    },
    {
      "rule": "tarSomethingRmTheSomething",
      "position": {
        "lineStart": 119,
        "lineEnd": 119,
        "columnStart": 4,
        "columnEnd": 49
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 11,
        "lineEnd": 11,
        "columnStart": 4,
        "columnEnd": 37
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 19,
        "lineEnd": 19,
        "columnStart": 4,
        "columnEnd": 33
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 35,
        "lineEnd": 35,
        "columnStart": 4,
        "columnEnd": 37
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 79,
        "lineEnd": 79,
        "columnStart": 4,
        "columnEnd": 66
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 95,
        "lineEnd": 95,
        "columnStart": 4,
        "columnEnd": 36
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 98,
        "lineEnd": 98,
        "columnStart": 4,
        "columnEnd": 37
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 101,
        "lineEnd": 101,
        "columnStart": 4,
        "columnEnd": 28
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 104,
        "lineEnd": 104,
        "columnStart": 4,
        "columnEnd": 37
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 11,
        "lineEnd": 11,
        "columnStart": 4,
        "columnEnd": 37
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 19,
        "lineEnd": 19,
        "columnStart": 4,
        "columnEnd": 33
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 35,
        "lineEnd": 35,
        "columnStart": 4,
        "columnEnd": 37
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 79,
        "lineEnd": 79,
        "columnStart": 4,
        "columnEnd": 66
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 95,
        "lineEnd": 95,
        "columnStart": 4,
        "columnEnd": 36
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 98,
        "lineEnd": 98,
        "columnStart": 4,
        "columnEnd": 37
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 101,
        "lineEnd": 101,
        "columnStart": 4,
        "columnEnd": 28
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 104,
        "lineEnd": 104,
        "columnStart": 4,
        "columnEnd": 37
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 11,
        "lineEnd": 11,
        "columnStart": 4,
        "columnEnd": 37
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 19,
        "lineEnd": 19,
        "columnStart": 4,
        "columnEnd": 33
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 35,
        "lineEnd": 35,
        "columnStart": 4,
        "columnEnd": 37
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 95,
        "lineEnd": 95,
        "columnStart": 4,
        "columnEnd": 36
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 98,
        "lineEnd": 98,
        "columnStart": 4,
        "columnEnd": 37
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 101,
        "lineEnd": 101,
        "columnStart": 4,
        "columnEnd": 28
      }
    },
    {
      "rule": "aptGetInstallThenRemoveAptLists",
      "position": {
        "lineStart": 104,
        "lineEnd": 104,
        "columnStart": 4,
        "columnEnd": 37
      }
    }
  ],
  "repairedSmells": [
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 11,
        "lineEnd": 11,
        "columnStart": 4,
        "columnEnd": 61
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 19,
        "lineEnd": 19,
        "columnStart": 4,
        "columnEnd": 57
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 35,
        "lineEnd": 35,
        "columnStart": 4,
        "columnEnd": 61
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 79,
        "lineEnd": 79,
        "columnStart": 4,
        "columnEnd": 90
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 95,
        "lineEnd": 95,
        "columnStart": 4,
        "columnEnd": 60
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 98,
        "lineEnd": 98,
        "columnStart": 4,
        "columnEnd": 61
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 101,
        "lineEnd": 101,
        "columnStart": 4,
        "columnEnd": 52
      }
    },
    {
      "rule": "aptGetUpdatePrecedesInstall",
      "position": {
        "lineStart": 104,
        "lineEnd": 104,
        "columnStart": 4,
        "columnEnd": 61
      }
    }
  ],
  "repairedDockerfile": "# Dockerizing MongoDB: Dockerfile for building MongoDB images\n# Based on ubuntu:latest, installs MongoDB following the instructions from:\n# http://docs.mongodb.org/manual/tutorial/install-mongodb-on-ubuntu/\n\n# Format: FROM    repository[:version]\nFROM       ubuntu:latest\n\n# Format: MAINTAINER Name <email@addr.ess>\nMAINTAINER Jonas Colmsj√∂ <jonas@gizur.com>\n\nRUN apt-get update\nRUN apt-get install --no-install-recommends -y curl wget nano && rm -rf /var/lib/apt/lists/*;\n\nRUN echo \"export HOME=/root\" > /.profile\n\n#\n# Install supervisord (used to handle processes)\n#\n\nRUN apt-get install --no-install-recommends -y supervisor && rm -rf /var/lib/apt/lists/*;\nADD ./supervisord.conf /etc/supervisor/conf.d/supervisord.conf\n\n\n#\n# Install MongoDB\n# ---------------\n\n\n# Installation:\n# Import MongoDB public GPG key AND create a MongoDB list file\nRUN apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --recv 7F0CEB10\nRUN echo 'deb http://downloads-distro.mongodb.org/repo/ubuntu-upstart dist 10gen' | tee /etc/apt/sources.list.d/10gen.list\n\n# Update apt-get sources AND install MongoDB\nRUN apt-get update\nRUN apt-get install --no-install-recommends -y -q mongodb-org && rm -rf /var/lib/apt/lists/*;\n\n# It is possible to install a specific version also\n# RUN apt-get install -y -q mongodb-org=2.6.1 mongodb-org-server=2.6.1 mongodb-org-shell=2.6.1 mongodb-org-mongos=2.6.1 mongodb-org-tools=2.6.1\n\n# Create the MongoDB data directory\nRUN mkdir -p /data/db\n\nADD ./etc-mongod.conf /etc/mongod.conf\n\n\n#\n# Install NodeJS\n# --------------\n\nADD ./init-node.sh /src/\n\n# Download and install using npm\nRUN curl -f https://raw.githubusercontent.com/creationix/nvm/v0.11.1/install.sh | bash\nRUN echo \"[ -s /.nvm/nvm.sh ] && . /.nvm/nvm.sh\" >> /.profile\nRUN /bin/bash -c \"source /.profile && nvm install v0.11.2\"\n\n# Install node for root user together node jaydata etc.\nRUN /src/init-node.sh\n\n# Fix a broken package.json (connect need to be exactly 2.0.0)\nADD ./odata-server-package.json /.nvm/v0.11.2/lib/node_modules/odata-server/package.json\nRUN /bin/bash -c \"source $HOME/.nvm/nvm.sh; nvm use v0.11.2; cd /.nvm/v0.11.2/lib/node_modules/odata-server; npm install .\"\n\n\n#\n# Install MySQL\n# -------------\n\n# Keep upstart from complaining\nRUN dpkg-divert --local --rename --add /sbin/initctl\n#RUN ln -s /bin/true /sbin/initctl\n\nRUN apt-get update\n\n# Bundle everything\nADD ./mysql-setup.sh /src/\n\n# Install MySQL server\nRUN DEBIAN_FRONTEND=noninteractive apt-get --no-install-recommends install -y mysql-server && apt-get clean && rm -rf /var/lib/apt/lists/*\n\n# Fix configuration\nRUN sed -i -e\"s/^bind-address\\s*=\\s*127.0.0.1/bind-address = 0.0.0.0/\" /etc/mysql/my.cnf\n\n# Setup admin user\nRUN /src/mysql-setup.sh\n\n\n#\n# Tungsten replicator\n# --------------------\n\nRUN apt-get update\n\n# Install Java\nRUN apt-get install --no-install-recommends -y openjdk-7-jre && rm -rf /var/lib/apt/lists/*;\n\n# Install Ruby\nRUN apt-get install --no-install-recommends -y ruby1.9.1-full && rm -rf /var/lib/apt/lists/*;\n\n# Install rsync\nRUN apt-get install --no-install-recommends -y rsync && rm -rf /var/lib/apt/lists/*;\n\n# Install sshd\nRUN apt-get install --no-install-recommends -y openssh-server && rm -rf /var/lib/apt/lists/*;\nRUN mkdir /var/run/sshd\n#RUN echo 'root:password' |chpasswd\n\n#\n# NOTE: Insecure, should not be used in production!!\n#\nADD ./root-ssh-authorized_keys /root/.ssh/authorized_keys\nADD ./root-ssh-id_rsa /root/.ssh/id_rsa\nADD ./root-ssh-id_rsa.pub /root/.ssh/id_rsa.pub\nADD ./etc-ssh-sshd_config /etc/ssh/sshd_config\nRUN chmod 700 /root/.ssh; chmod 600 /root/.ssh/**\n\n# Install tungsten\nRUN  wget https://s3.amazonaws.com/files.continuent.com/builds/nightly/tungsten-2.0-snapshots/tungsten-replicator-2.1.0-346.tar.gz\nRUN tar -xzf tungsten-replicator-2.1.0-346.tar.gz && rm tungsten-replicator-2.1.0-346.tar.gz\nRUN mkdir opt/continuent\n\nADD ./etc-mysql-my.cnf /etc/mysql/my.cnf\nRUN ln -s /etc/mysql/my.cnf /etc/my.cnf\n\nADD ./init-mongodb.js /src/\nADD ./init-mongodb.sh /src/\nRUN  /src/init-mongodb.sh\n\n#\n# Start things up\n# ---------------\n\n\n# 2112, 10000 and 10001 are used by tungsten\n# 27017 is used by mongodb\n# 3306 is used by MySQL\n# 9001 is used by supervisord\nEXPOSE 22 80 443 8080 27017 3306 2112 10000 10001 9001\n\nCMD [\"supervisord\",\"-n\"]\n"
}