{
  "startTime": 1674243611577,
  "endTime": 1674243611737,
  "originalSmells": [
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 51,
        "lineEnd": 52,
        "columnStart": 4,
        "columnEnd": 106
      }
    },
    {
      "rule": "curlUseFlagF",
      "position": {
        "lineStart": 57,
        "lineEnd": 58,
        "columnStart": 4,
        "columnEnd": 100
      }
    },
    {
      "rule": "curlUseHttpsUrl",
      "position": {
        "lineStart": 51,
        "lineEnd": 52,
        "columnStart": 4,
        "columnEnd": 106
      }
    },
    {
      "rule": "curlUseHttpsUrl",
      "position": {
        "lineStart": 57,
        "lineEnd": 58,
        "columnStart": 4,
        "columnEnd": 100
      }
    },
    {
      "rule": "tarSomethingRmTheSomething",
      "position": {
        "lineStart": 59,
        "lineEnd": 59,
        "columnStart": 4,
        "columnEnd": 46
      }
    },
    {
      "rule": "aptGetInstallUseNoRec",
      "position": {
        "lineStart": 30,
        "lineEnd": 30,
        "columnStart": 4,
        "columnEnd": 40
      }
    }
  ],
  "repairedSmells": [],
  "repairedDockerfile": "#\n# Licensed to the Apache Software Foundation (ASF) under one or more\n# contributor license agreements.  See the NOTICE file distributed with\n# this work for additional information regarding copyright ownership.\n# The ASF licenses this file to You under the Apache License, Version 2.0\n# (the \"License\"); you may not use this file except in compliance with\n# the License.  You may obtain a copy of the License at\n#\n#    http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\n\nFROM openjdk:8\n\nARG PIO_GIT_URL=https://github.com/apache/predictionio.git\nARG PIO_TAG=v0.13.0\nENV SCALA_VERSION=2.11.12\nENV SPARK_VERSION=2.2.3\nENV HADOOP_VERSION=2.7.7\nENV ELASTICSEARCH_VERSION=5.5.3\nENV PGSQL_VERSION=42.2.4\nENV MYSQL_VERSION=8.0.12\nENV PIO_HOME=/usr/share/predictionio\n\nRUN apt-get update && \\\n    apt-get install --no-install-recommends -y dpkg-dev fakeroot && \\\n    apt-get clean && \\\n    rm -rf /var/lib/apt/lists/*\n\nWORKDIR /opt/src\nRUN git clone -b $PIO_TAG $PIO_GIT_URL\nWORKDIR /opt/src/predictionio\nRUN bash ./make-distribution.sh \\\n      -Dscala.version=$SCALA_VERSION \\\n      -Dspark.version=$SPARK_VERSION \\\n      -Dhadoop.version=$HADOOP_VERSION \\\n      -Delasticsearch.version=$ELASTICSEARCH_VERSION \\\n      --with-deb && \\\n    dpkg -i ./assembly/target/predictionio_*.deb && \\\n    cp -r ./python /usr/share/predictionio && \\\n    mkdir /var/log/predictionio && \\\n    rm -rf /opt/src/predictionio/*\n\n\nRUN cp /etc/predictionio/pio-env.sh /etc/predictionio/pio-env.sh.orig && \\\n    echo \"#!/usr/bin/env bash\" > /etc/predictionio/pio-env.sh\nRUN curl -f -o $PIO_HOME/lib/postgresql-$PGSQL_VERSION.jar \\\n    https://central.maven.org/maven2/org/postgresql/postgresql/$PGSQL_VERSION/postgresql-$PGSQL_VERSION.jar && \\\n    echo \"POSTGRES_JDBC_DRIVER=$PIO_HOME/lib/postgresql-$PGSQL_VERSION.jar\" >> /etc/predictionio/pio-env.sh && \\\n    echo \"MYSQL_JDBC_DRIVER=$PIO_HOME/lib/mysql-connector-java-$MYSQL_VERSION.jar\" >> /etc/predictionio/pio-env.sh\n\nWORKDIR /usr/share\nRUN curl -f -o /opt/src/spark-$SPARK_VERSION.tgz \\\n    https://archive.apache.org/dist/spark/spark-$SPARK_VERSION/spark-$SPARK_VERSION-bin-hadoop2.7.tgz && \\\n    tar zxvf /opt/src/spark-$SPARK_VERSION.tgz && \\\n    echo \"SPARK_HOME=\"`pwd`/`ls -d spark*` >> /etc/predictionio/pio-env.sh && \\\n    rm -rf /opt/src && rm /opt/src/spark-$SPARK_VERSION.tgz\n\nWORKDIR /templates\nADD pio_run /usr/bin/pio_run\n\nEXPOSE 7070\nEXPOSE 8000\n\nCMD [\"sh\", \"/usr/bin/pio_run\"]\n\n"
}