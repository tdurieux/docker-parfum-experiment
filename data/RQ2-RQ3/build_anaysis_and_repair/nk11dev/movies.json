{"repository":"https://github.com/nk11dev/movies","dockerfilePath":"Dockerfile","startTime":1672015264052,"clone":{"stdout":"","stderr":"Cloning into '/tmp/dinghy-analysis/nk11dev/movies'...\n","error":null,"commit":"209bb2d3c2c55fc086b511f9a2c4615254fd9776"},"originalBuild":{"startTimestamp":1672015265986,"endTimestamp":1672015321767,"error":null,"stdout":"Sending build context to Docker daemon  15.46MB\r\r\nStep 1/27 : FROM node:16.8.0-alpine3.14 AS dependencies\n16.8.0-alpine3.14: Pulling from library/node\na0d0a0d46f8b: Pulling fs layer\n2f1f56e7e1a2: Pulling fs layer\nd6137725b3a8: Pulling fs layer\n33fd7791f70a: Pulling fs layer\n33fd7791f70a: Waiting\na0d0a0d46f8b: Verifying Checksum\na0d0a0d46f8b: Download complete\nd6137725b3a8: Download complete\na0d0a0d46f8b: Pull complete\n33fd7791f70a: Verifying Checksum\n33fd7791f70a: Download complete\n2f1f56e7e1a2: Verifying Checksum\n2f1f56e7e1a2: Download complete\n2f1f56e7e1a2: Pull complete\nd6137725b3a8: Pull complete\n33fd7791f70a: Pull complete\nDigest: sha256:4ca6db20301c460ffa44b1d398788c903306f55de6ded981ab377d036c172836\nStatus: Downloaded newer image for node:16.8.0-alpine3.14\n ---> 8e54fa4ec7da\nStep 2/27 : RUN apk add dumb-init\n ---> Running in 7ee92200db8a\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.14/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.14/community/x86_64/APKINDEX.tar.gz\n(1/1) Installing dumb-init (1.2.5-r1)\nExecuting busybox-1.33.1-r3.trigger\nOK: 7 MiB in 17 packages\nRemoving intermediate container 7ee92200db8a\n ---> d79fa5265a62\nStep 3/27 : WORKDIR /usr/app\n ---> Running in 3d922d83a08e\nRemoving intermediate container 3d922d83a08e\n ---> 0a555d873fa0\nStep 4/27 : COPY [\"package.json\", \"package-lock.json\", \".npmrc\", \"./\"]\n ---> 4138375ac7f4\nStep 5/27 : RUN npm ci --production && npm cache clean --force\n ---> Running in 280a75cf905a\n\u001b[91mnpm WARN deprecated popper.js@1.16.1: You can find the new Popper v2 at @popperjs/core, this package is dedicated to the legacy v1\n\u001b[0m\nadded 685 packages, and audited 686 packages in 13s\n\n61 packages are looking for funding\n  run `npm fund` for details\n\n16 vulnerabilities (1 low, 7 moderate, 6 high, 2 critical)\n\nTo address issues that do not require attention, run:\n  npm audit fix\n\nTo address all issues, run:\n  npm audit fix --force\n\nRun `npm audit` for details.\n\u001b[91mnpm notice\u001b[0m\u001b[91m \nnpm notice\u001b[0m\u001b[91m New major version of npm available! 7.21.0 -> 9.2.0\nnpm \u001b[0m\u001b[91mnotice\u001b[0m\u001b[91m Changelog: <https://github.com/npm/cli/releases/tag/v9.2.0>\nnpm notice Run `npm install -g npm@9.2.0` to update!\nnpm notice\u001b[0m\u001b[91m \n\u001b[0m\u001b[91mnpm\u001b[0m\u001b[91m WARN using --force Recommended protections disabled.\n\u001b[0mRemoving intermediate container 280a75cf905a\n ---> 3dddf59d81ca\nStep 6/27 : FROM dependencies\n ---> 3dddf59d81ca\nStep 7/27 : WORKDIR /usr/app\n ---> Running in d3cf94179c1b\nRemoving intermediate container d3cf94179c1b\n ---> 20805f0ead9f\nStep 8/27 : COPY [\".babelrc.js\", \"./\"]\n ---> c5d541dd307f\nStep 9/27 : COPY configs ./configs/\n ---> 2d52f78614e4\nStep 10/27 : COPY src ./src/\n ---> cfdbb51a9ab3\nStep 11/27 : ARG SOURCE_HASH\n ---> Running in d20b6ad27709\nRemoving intermediate container d20b6ad27709\n ---> 9573e5aa2c43\nStep 12/27 : ENV SOURCE_HASH=$SOURCE_HASH\n ---> Running in f888770f6f04\nRemoving intermediate container f888770f6f04\n ---> 47292c582660\nStep 13/27 : ARG SOURCE_NAME\n ---> Running in eda0c01807b1\nRemoving intermediate container eda0c01807b1\n ---> 9b77086bce08\nStep 14/27 : ENV SOURCE_NAME=$SOURCE_NAME\n ---> Running in e50805787692\nRemoving intermediate container e50805787692\n ---> c25d85e4bed1\nStep 15/27 : ARG DEBUG_MODE\n ---> Running in bfc48b771b82\nRemoving intermediate container bfc48b771b82\n ---> 705c00601642\nStep 16/27 : ENV DEBUG_MODE=$DEBUG_MODE\n ---> Running in b2c221f6a3c6\nRemoving intermediate container b2c221f6a3c6\n ---> f80c59a7dbf3\nStep 17/27 : ARG TMDB_API_ACCESS_TOKEN\n ---> Running in d20c959f72a5\nRemoving intermediate container d20c959f72a5\n ---> ad2a1324b484\nStep 18/27 : ENV TMDB_API_ACCESS_TOKEN=$TMDB_API_ACCESS_TOKEN\n ---> Running in df23eefb0643\nRemoving intermediate container df23eefb0643\n ---> 88cbf19665be\nStep 19/27 : ARG TMDB_API_REGION\n ---> Running in a187a33f41c7\nRemoving intermediate container a187a33f41c7\n ---> 822dea99dd59\nStep 20/27 : ENV TMDB_API_REGION=$TMDB_API_REGION\n ---> Running in ebc6976c432d\nRemoving intermediate container ebc6976c432d\n ---> 956bb2b816c4\nStep 21/27 : ENV RENDERING=server\n ---> Running in eff74fa6ced9\nRemoving intermediate container eff74fa6ced9\n ---> 2451fca59ba8\nStep 22/27 : RUN echo \"SOURCE_HASH: ${SOURCE_HASH}\"\n ---> Running in 1827ebe27a1a\nSOURCE_HASH: \nRemoving intermediate container 1827ebe27a1a\n ---> 5525f33c1cd5\nStep 23/27 : RUN echo \"SOURCE_NAME: ${SOURCE_NAME}\"\n ---> Running in 058f3e1bcca9\nSOURCE_NAME: \nRemoving intermediate container 058f3e1bcca9\n ---> bbf1ff29b86a\nStep 24/27 : RUN npm run build\n ---> Running in c33452838c47\n\n> movies@0.0.1 build\n> npm run build:client && npm run build:server\n\n\n> movies@0.0.1 build:client\n> cross-env NODE_ENV=production npx webpack --config=configs/webpack.config.client.js\n\n\u001b[33mplatform: \"linux\"\u001b[0m\n\u001b[33mnode version: \"16.8.0\"\u001b[0m\n\u001b[36mscript: \"webpack \"--config=configs/webpack.config.client.js\"\"\u001b[0m\n\u001b[91m/bin/sh: git: not found\n\u001b[0m\n--- Git hash: can't parse. Message: Command failed: git rev-parse HEAD\n/bin/sh: git: not found\n\n--- Source hash: no value\n\n--- envConfig: {\n  APP_REVISION: '0.0.1',\n  TMDB_API_ACCESS_TOKEN: 'your_api_access_token',\n  TMDB_API_KEY: 'your_api_key',\n  TMDB_API_V4_AUTHENTICATION: '1',\n  TMDB_API_HOST: 'https://api.tmdb.org/3',\n  TMDB_API_REGION: 'US',\n  PORT_CLIENT: '8080',\n  PORT_SERVER: '8081',\n  PORT_ANALYZER: '8888',\n  RENDERING: 'server',\n  DEBUG_MODE: '1'\n} \n\n\u001b[91mBrowserslist: caniuse-lite is outdated. Please run:\n  npx browserslist@latest --update-db\n  Why you should do it regularly: https://github.com/browserslist/browserslist#browsers-data-updating\n\u001b[0m\u001b[91m(node:47) [DEP_WEBPACK_COMPILATION_ASSETS] DeprecationWarning: Compilation.assets will be frozen in future, all modifications are deprecated.\nBREAKING CHANGE: No more changes should happen to Compilation.assets after sealing the Compilation.\n\tDo changes to assets earlier, e. g. in Compilation.hooks.processAssets.\n\tMake sure to select an appropriate stage from Compilation.PROCESS_ASSETS_STAGE_*.\n(Use `node --trace-deprecation ...` to show where the warning was created)\n\u001b[0m18 assets\n351 modules\nwebpack 5.52.0 compiled successfully in 13461 ms\n\n> movies@0.0.1 build:server\n> cross-env NODE_ENV=production npx webpack --config=configs/webpack.config.server.js\n\n\u001b[33mplatform: \"linux\"\u001b[0m\n\u001b[33mnode version: \"16.8.0\"\u001b[0m\n\u001b[36mscript: \"webpack \"--config=configs/webpack.config.server.js\"\"\u001b[0m\n\u001b[91m/bin/sh: git: not found\n\u001b[0m\n--- Git hash: can't parse. Message: Command failed: git rev-parse HEAD\n/bin/sh: git: not found\n\n--- Source hash: no value\n\n--- envConfig: {\n  APP_REVISION: '0.0.1',\n  TMDB_API_ACCESS_TOKEN: 'your_api_access_token',\n  TMDB_API_KEY: 'your_api_key',\n  TMDB_API_V4_AUTHENTICATION: '1',\n  TMDB_API_HOST: 'https://api.tmdb.org/3',\n  TMDB_API_REGION: 'US',\n  PORT_CLIENT: '8080',\n  PORT_SERVER: '8081',\n  PORT_ANALYZER: '8888',\n  RENDERING: 'server',\n  DEBUG_MODE: '1'\n} \n\n\u001b[91mBrowserslist: caniuse-lite is outdated. Please run:\n  npx browserslist@latest --update-db\n  Why you should do it regularly: https://github.com/browserslist/browserslist#browsers-data-updating\n\u001b[0m1 asset\n202 modules\nwebpack 5.52.0 compiled successfully in 3472 ms\nRemoving intermediate container c33452838c47\n ---> 1bc5b58c5210\nStep 25/27 : EXPOSE 8081\n ---> Running in 54252adbcfb3\nRemoving intermediate container 54252adbcfb3\n ---> 69db699a9cc9\nStep 26/27 : USER node\n ---> Running in def616fa2b34\nRemoving intermediate container def616fa2b34\n ---> 0f235597ad4d\nStep 27/27 : CMD [\"dumb-init\", \"node\", \"./dist/server.js\"]\n ---> Running in f30d10020650\nRemoving intermediate container f30d10020650\n ---> 4d4f3b585f92\nSuccessfully built 4d4f3b585f92\nSuccessfully tagged movies:latest\n","stderr":"","imageSize":212619133},"repair":{"violations":[],"repairedDockerfile":"#----------------------\n# Stage 1: dependencies\n#----------------------\nFROM node:16.8.0-alpine3.14 AS dependencies\n\nRUN apk add dumb-init\nWORKDIR /usr/app\nCOPY [\"package.json\", \"package-lock.json\", \".npmrc\", \"./\"]\nRUN npm ci --production && npm cache clean --force\n\n#-------------\n# Stage 2: app\n#-------------\nFROM dependencies\n\nWORKDIR /usr/app\nCOPY [\".babelrc.js\", \"./\"]\nCOPY configs ./configs/\nCOPY src ./src/\n\nARG SOURCE_HASH\nENV SOURCE_HASH=$SOURCE_HASH\nARG SOURCE_NAME\nENV SOURCE_NAME=$SOURCE_NAME\nARG DEBUG_MODE\nENV DEBUG_MODE=$DEBUG_MODE\nARG TMDB_API_ACCESS_TOKEN\nENV TMDB_API_ACCESS_TOKEN=$TMDB_API_ACCESS_TOKEN\nARG TMDB_API_REGION\nENV TMDB_API_REGION=$TMDB_API_REGION\nENV RENDERING=server \n\nRUN echo \"SOURCE_HASH: ${SOURCE_HASH}\"\nRUN echo \"SOURCE_NAME: ${SOURCE_NAME}\"\nRUN npm run build\nEXPOSE 8081\nUSER node\n\nCMD [\"dumb-init\", \"node\", \"./dist/server.js\"]"},"endTime":1672015322392}