{"repository":"https://github.com/toniblyx/prowler","dockerfilePath":"Dockerfile","startTime":1672361830021,"clone":{"stdout":"","stderr":"Cloning into '/tmp/dinghy-analysis/toniblyx/prowler'...\n","error":null,"commit":"94bda8c17de4c7a48b150a163eaa02f4844698f2"},"originalBuild":{"startTimestamp":1672361831518,"endTimestamp":1672362049820,"error":null,"stdout":"Sending build context to Docker daemon  12.75MB\r\r\nStep 1/12 : FROM python:3.9-alpine\n3.9-alpine: Pulling from library/python\nc158987b0551: Already exists\n7ec3a91b66d9: Pulling fs layer\na3a2c937b8a7: Pulling fs layer\n25083a7b8521: Pulling fs layer\ne2f7f5886088: Pulling fs layer\ne2f7f5886088: Waiting\n25083a7b8521: Verifying Checksum\n25083a7b8521: Download complete\n7ec3a91b66d9: Verifying Checksum\n7ec3a91b66d9: Download complete\ne2f7f5886088: Verifying Checksum\ne2f7f5886088: Download complete\na3a2c937b8a7: Verifying Checksum\na3a2c937b8a7: Download complete\n7ec3a91b66d9: Pull complete\na3a2c937b8a7: Pull complete\n25083a7b8521: Pull complete\ne2f7f5886088: Pull complete\nDigest: sha256:8ea03bf88df73d21c72b3a941d1337c54357ee6386c2824f90b39a007792d1bb\nStatus: Downloaded newer image for python:3.9-alpine\n ---> d6d1ed462b20\nStep 2/12 : LABEL maintainer=\"https://github.com/prowler-cloud/prowler\"\n ---> Running in 36e145919102\nRemoving intermediate container 36e145919102\n ---> 75760a26dcdf\nStep 3/12 : RUN apk --no-cache update && apk --no-cache upgrade\n ---> Running in 3f41184e305e\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/community/x86_64/APKINDEX.tar.gz\nv3.17.0-306-g917d743036 [https://dl-cdn.alpinelinux.org/alpine/v3.17/main]\nv3.17.0-307-g96eb718a77 [https://dl-cdn.alpinelinux.org/alpine/v3.17/community]\nOK: 17816 distinct packages available\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/community/x86_64/APKINDEX.tar.gz\n(1/3) Upgrading sqlite-libs (3.40.0-r0 -> 3.40.1-r0)\n(2/3) Upgrading ca-certificates-bundle (20220614-r2 -> 20220614-r3)\n(3/3) Upgrading ca-certificates (20220614-r2 -> 20220614-r3)\nExecuting busybox-1.35.0-r29.trigger\nExecuting ca-certificates-20220614-r3.trigger\nOK: 16 MiB in 37 packages\nRemoving intermediate container 3f41184e305e\n ---> 74693643ed35\nStep 4/12 : RUN mkdir -p /home/prowler &&     echo 'prowler:x:1000:1000:prowler:/home/prowler:' > /etc/passwd &&     echo 'prowler:x:1000:' > /etc/group &&     chown -R prowler:prowler /home/prowler\n ---> Running in 2491fc1674fc\nRemoving intermediate container 2491fc1674fc\n ---> dce1d903f255\nStep 5/12 : USER prowler\n ---> Running in 311f0aa603ee\nRemoving intermediate container 311f0aa603ee\n ---> b6a8e4b5202c\nStep 6/12 : WORKDIR /home/prowler\n ---> Running in 307d280b55cf\nRemoving intermediate container 307d280b55cf\n ---> 40c32f4fb418\nStep 7/12 : COPY prowler/ /home/prowler/prowler/\n ---> 2634674f4207\nStep 8/12 : COPY pyproject.toml /home/prowler\n ---> 344a4e89670f\nStep 9/12 : ENV HOME='/home/prowler'\n ---> Running in 938618dc5aef\nRemoving intermediate container 938618dc5aef\n ---> 0af81636f31f\nStep 10/12 : ENV PATH=\"$HOME/.local/bin:$PATH\"\n ---> Running in 4621da7c048a\nRemoving intermediate container 4621da7c048a\n ---> 74aac5aea0e5\nStep 11/12 : RUN pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir .\n ---> Running in b94c5d0d846f\nDefaulting to user installation because normal site-packages is not writeable\nRequirement already satisfied: pip in /usr/local/lib/python3.9/site-packages (22.0.4)\nCollecting pip\n  Downloading pip-22.3.1-py3-none-any.whl (2.1 MB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 2.1/2.1 MB 71.3 MB/s eta 0:00:00\nInstalling collected packages: pip\nSuccessfully installed pip-22.3.1\n\u001b[91mWARNING: You are using pip version 22.0.4; however, version 22.3.1 is available.\nYou should consider upgrading via the '/usr/local/bin/python -m pip install --upgrade pip' command.\n\u001b[0mDefaulting to user installation because normal site-packages is not writeable\nProcessing /home/prowler\n  Installing build dependencies: started\n  Installing build dependencies: finished with status 'done'\n  Getting requirements to build wheel: started\n  Getting requirements to build wheel: finished with status 'done'\n  Installing backend dependencies: started\n  Installing backend dependencies: finished with status 'done'\n  Preparing metadata (pyproject.toml): started\n  Preparing metadata (pyproject.toml): finished with status 'done'\nCollecting detect-secrets~=1.4.0\n  Downloading detect_secrets-1.4.0-py3-none-any.whl (116 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 116.3/116.3 kB 52.0 MB/s eta 0:00:00\nCollecting botocore~=1.29.18\n  Downloading botocore-1.29.40-py3-none-any.whl (10.3 MB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 10.3/10.3 MB 42.0 MB/s eta 0:00:00\nCollecting arnparse~=0.0.2\n  Downloading arnparse-0.0.2-py2.py3-none-any.whl (2.9 kB)\nCollecting pydantic~=1.9.1\n  Downloading pydantic-1.9.2-cp39-cp39-musllinux_1_1_x86_64.whl (12.5 MB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 12.5/12.5 MB 5.7 MB/s eta 0:00:00\nCollecting alive-progress~=2.4.1\n  Downloading alive_progress-2.4.1-py3-none-any.whl (80 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 80.9/80.9 kB 195.3 MB/s eta 0:00:00\nCollecting azure-mgmt-storage~=21.0.0\n  Downloading azure_mgmt_storage-21.0.0-py3-none-any.whl (2.8 MB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 2.8/2.8 MB 103.8 MB/s eta 0:00:00\nCollecting msgraph-core~=0.2.2\n  Downloading msgraph_core-0.2.2-py3-none-any.whl (15 kB)\nCollecting tabulate~=0.9.0\n  Downloading tabulate-0.9.0-py3-none-any.whl (35 kB)\nCollecting azure-identity~=1.12.0\n  Downloading azure_identity-1.12.0-py3-none-any.whl (135 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 135.5/135.5 kB 140.7 MB/s eta 0:00:00\nCollecting shodan~=1.28.0\n  Downloading shodan-1.28.0.tar.gz (53 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 53.5/53.5 kB 117.6 MB/s eta 0:00:00\n  Preparing metadata (setup.py): started\n  Preparing metadata (setup.py): finished with status 'done'\nCollecting azure-storage-blob~=12.14.1\n  Downloading azure_storage_blob-12.14.1-py3-none-any.whl (383 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 383.2/383.2 kB 132.0 MB/s eta 0:00:00\nCollecting colorama~=0.4.4\n  Downloading colorama-0.4.6-py2.py3-none-any.whl (25 kB)\nCollecting azure-mgmt-subscription~=3.1.1\n  Downloading azure_mgmt_subscription-3.1.1-py3-none-any.whl (79 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 79.4/79.4 kB 128.5 MB/s eta 0:00:00\nCollecting azure-mgmt-security~=3.0.0\n  Downloading azure_mgmt_security-3.0.0-py3-none-any.whl (941 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 941.6/941.6 kB 78.7 MB/s eta 0:00:00\nCollecting boto3~=1.26.17\n  Downloading boto3-1.26.40-py3-none-any.whl (132 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 132.7/132.7 kB 219.5 MB/s eta 0:00:00\nCollecting azure-mgmt-authorization~=3.0.0\n  Downloading azure_mgmt_authorization-3.0.0-py3-none-any.whl (965 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 965.9/965.9 kB 128.8 MB/s eta 0:00:00\nCollecting grapheme==0.6.0\n  Downloading grapheme-0.6.0.tar.gz (207 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 207.3/207.3 kB 144.1 MB/s eta 0:00:00\n  Preparing metadata (setup.py): started\n  Preparing metadata (setup.py): finished with status 'done'\nCollecting about-time==3.1.1\n  Downloading about_time-3.1.1-py3-none-any.whl (9.1 kB)\nCollecting cryptography>=2.5\n  Downloading cryptography-38.0.4-cp36-abi3-musllinux_1_1_x86_64.whl (4.2 MB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 4.2/4.2 MB 94.3 MB/s eta 0:00:00\nCollecting six>=1.12.0\n  Downloading six-1.16.0-py2.py3-none-any.whl (11 kB)\nCollecting msal<2.0.0,>=1.12.0\n  Downloading msal-1.20.0-py2.py3-none-any.whl (90 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 90.0/90.0 kB 217.5 MB/s eta 0:00:00\nCollecting azure-core<2.0.0,>=1.11.0\n  Downloading azure_core-1.26.1-py3-none-any.whl (172 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 172.6/172.6 kB 230.6 MB/s eta 0:00:00\nCollecting msal-extensions<2.0.0,>=0.3.0\n  Downloading msal_extensions-1.0.0-py2.py3-none-any.whl (19 kB)\nCollecting azure-mgmt-core<2.0.0,>=1.3.2\n  Downloading azure_mgmt_core-1.3.2-py3-none-any.whl (26 kB)\nCollecting msrest>=0.7.1\n  Downloading msrest-0.7.1-py3-none-any.whl (85 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 85.4/85.4 kB 227.3 MB/s eta 0:00:00\nCollecting azure-common~=1.1\n  Downloading azure_common-1.1.28-py2.py3-none-any.whl (14 kB)\nCollecting jmespath<2.0.0,>=0.7.1\n  Downloading jmespath-1.0.1-py3-none-any.whl (20 kB)\nCollecting s3transfer<0.7.0,>=0.6.0\n  Downloading s3transfer-0.6.0-py3-none-any.whl (79 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 79.6/79.6 kB 72.0 MB/s eta 0:00:00\nCollecting urllib3<1.27,>=1.25.4\n  Downloading urllib3-1.26.13-py2.py3-none-any.whl (140 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 140.6/140.6 kB 149.0 MB/s eta 0:00:00\nCollecting python-dateutil<3.0.0,>=2.1\n  Downloading python_dateutil-2.8.2-py2.py3-none-any.whl (247 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 247.7/247.7 kB 250.1 MB/s eta 0:00:00\nCollecting pyyaml\n  Downloading PyYAML-6.0.tar.gz (124 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 125.0/125.0 kB 242.7 MB/s eta 0:00:00\n  Installing build dependencies: started\n  Installing build dependencies: finished with status 'done'\n  Getting requirements to build wheel: started\n  Getting requirements to build wheel: finished with status 'done'\n  Preparing metadata (pyproject.toml): started\n  Preparing metadata (pyproject.toml): finished with status 'done'\nCollecting requests\n  Downloading requests-2.28.1-py3-none-any.whl (62 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 62.8/62.8 kB 202.1 MB/s eta 0:00:00\nCollecting typing-extensions>=3.7.4.3\n  Downloading typing_extensions-4.4.0-py3-none-any.whl (26 kB)\nCollecting click\n  Downloading click-8.1.3-py3-none-any.whl (96 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 96.6/96.6 kB 222.6 MB/s eta 0:00:00\nCollecting click-plugins\n  Downloading click_plugins-1.1.1-py2.py3-none-any.whl (7.5 kB)\nCollecting XlsxWriter\n  Downloading XlsxWriter-3.0.4-py3-none-any.whl (149 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 149.9/149.9 kB 246.3 MB/s eta 0:00:00\nCollecting cffi>=1.12\n  Downloading cffi-1.15.1-cp39-cp39-musllinux_1_1_x86_64.whl (463 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 463.1/463.1 kB 165.8 MB/s eta 0:00:00\nCollecting PyJWT[crypto]<3,>=1.0.0\n  Downloading PyJWT-2.6.0-py3-none-any.whl (20 kB)\nCollecting portalocker<3,>=1.0\n  Downloading portalocker-2.6.0-py2.py3-none-any.whl (15 kB)\nCollecting certifi>=2017.4.17\n  Downloading certifi-2022.12.7-py3-none-any.whl (155 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 155.3/155.3 kB 56.7 MB/s eta 0:00:00\nCollecting requests-oauthlib>=0.5.0\n  Downloading requests_oauthlib-1.3.1-py2.py3-none-any.whl (23 kB)\nCollecting isodate>=0.6.0\n  Downloading isodate-0.6.1-py2.py3-none-any.whl (41 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 41.7/41.7 kB 54.8 MB/s eta 0:00:00\nCollecting charset-normalizer<3,>=2\n  Downloading charset_normalizer-2.1.1-py3-none-any.whl (39 kB)\nCollecting idna<4,>=2.5\n  Downloading idna-3.4-py3-none-any.whl (61 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 61.5/61.5 kB 211.2 MB/s eta 0:00:00\nCollecting pycparser\n  Downloading pycparser-2.21-py2.py3-none-any.whl (118 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 118.7/118.7 kB 122.4 MB/s eta 0:00:00\nCollecting oauthlib>=3.0.0\n  Downloading oauthlib-3.2.2-py3-none-any.whl (151 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 151.7/151.7 kB 107.3 MB/s eta 0:00:00\nBuilding wheels for collected packages: prowler-cloud, grapheme, shodan, pyyaml\n  Building wheel for prowler-cloud (pyproject.toml): started\n  Building wheel for prowler-cloud (pyproject.toml): finished with status 'done'\n  Created wheel for prowler-cloud: filename=prowler_cloud-3.0.1-py3-none-any.whl size=823503 sha256=84feec8934c12c23ae81f8fad27bf85e230622bd53210b8902f7430772116573\n  Stored in directory: /tmp/pip-ephem-wheel-cache-s31udkgr/wheels/df/49/e6/4116a456add0fdc30dbd88c969e7f0197004ebeccbbbe3af1b\n  Building wheel for grapheme (setup.py): started\n  Building wheel for grapheme (setup.py): finished with status 'done'\n  Created wheel for grapheme: filename=grapheme-0.6.0-py3-none-any.whl size=210096 sha256=0e5bde879963958b85e3972bbb43585ac502a4620981f31fefac7000988fa42f\n  Stored in directory: /tmp/pip-ephem-wheel-cache-s31udkgr/wheels/ea/77/3b/5c11de6388df505ba18f5a7e7173ed997007fdf14b24caba9b\n  Building wheel for shodan (setup.py): started\n  Building wheel for shodan (setup.py): finished with status 'done'\n  Created wheel for shodan: filename=shodan-1.28.0-py3-none-any.whl size=47645 sha256=8bad77d87b46f035a4b88748170913e99f2b02ebb5a4250ac1f81fbc1f7d5aa1\n  Stored in directory: /tmp/pip-ephem-wheel-cache-s31udkgr/wheels/08/a5/86/f06f5afdc502bfa381e4e002be714dc32e943fdfc57c53ab5a\n  Building wheel for pyyaml (pyproject.toml): started\n  Building wheel for pyyaml (pyproject.toml): finished with status 'done'\n  Created wheel for pyyaml: filename=PyYAML-6.0-cp39-cp39-linux_x86_64.whl size=45332 sha256=0176c233ef769456bbc09ff39ca4d538a36d6fc736337e8217d5fcb853fd21a7\n  Stored in directory: /tmp/pip-ephem-wheel-cache-s31udkgr/wheels/5c/9d/5f/838ca730866969b9340acf232c4621bd398bc8be7cd6a5f838\nSuccessfully built prowler-cloud grapheme shodan pyyaml\nInstalling collected packages: grapheme, azure-common, arnparse, about-time, XlsxWriter, urllib3, typing-extensions, tabulate, six, pyyaml, PyJWT, pycparser, portalocker, oauthlib, msgraph-core, jmespath, idna, colorama, click, charset-normalizer, certifi, alive-progress, requests, python-dateutil, pydantic, isodate, click-plugins, cffi, shodan, requests-oauthlib, detect-secrets, cryptography, botocore, azure-core, s3transfer, msrest, azure-mgmt-core, msal, boto3, azure-storage-blob, azure-mgmt-subscription, azure-mgmt-storage, azure-mgmt-security, azure-mgmt-authorization, msal-extensions, azure-identity, prowler-cloud\nSuccessfully installed PyJWT-2.6.0 XlsxWriter-3.0.4 about-time-3.1.1 alive-progress-2.4.1 arnparse-0.0.2 azure-common-1.1.28 azure-core-1.26.1 azure-identity-1.12.0 azure-mgmt-authorization-3.0.0 azure-mgmt-core-1.3.2 azure-mgmt-security-3.0.0 azure-mgmt-storage-21.0.0 azure-mgmt-subscription-3.1.1 azure-storage-blob-12.14.1 boto3-1.26.40 botocore-1.29.40 certifi-2022.12.7 cffi-1.15.1 charset-normalizer-2.1.1 click-8.1.3 click-plugins-1.1.1 colorama-0.4.6 cryptography-38.0.4 detect-secrets-1.4.0 grapheme-0.6.0 idna-3.4 isodate-0.6.1 jmespath-1.0.1 msal-1.20.0 msal-extensions-1.0.0 msgraph-core-0.2.2 msrest-0.7.1 oauthlib-3.2.2 portalocker-2.6.0 prowler-cloud-3.0.1 pycparser-2.21 pydantic-1.9.2 python-dateutil-2.8.2 pyyaml-6.0 requests-2.28.1 requests-oauthlib-1.3.1 s3transfer-0.6.0 shodan-1.28.0 six-1.16.0 tabulate-0.9.0 typing-extensions-4.4.0 urllib3-1.26.13\nRemoving intermediate container b94c5d0d846f\n ---> 944334a54505\nStep 12/12 : ENTRYPOINT [\"prowler\"]\n ---> Running in 540ebd770680\nRemoving intermediate container 540ebd770680\n ---> 135c458bdf02\nSuccessfully built 135c458bdf02\nSuccessfully tagged prowler:latest\n","stderr":"","imageSize":286269446},"repair":{"violations":[],"repairedDockerfile":"FROM python:3.9-alpine\n\nLABEL maintainer=\"https://github.com/prowler-cloud/prowler\"\n\n# Update system dependencies\nRUN apk --no-cache update && apk --no-cache upgrade\n\n# Create nonroot user\nRUN mkdir -p /home/prowler && \\\n    echo 'prowler:x:1000:1000:prowler:/home/prowler:' > /etc/passwd && \\\n    echo 'prowler:x:1000:' > /etc/group && \\\n    chown -R prowler:prowler /home/prowler\nUSER prowler\n\n# Copy necessary files\nWORKDIR /home/prowler\nCOPY prowler/ /home/prowler/prowler/\nCOPY pyproject.toml /home/prowler\n\n# Install dependencies\nENV HOME='/home/prowler'\nENV PATH=\"$HOME/.local/bin:$PATH\"\n#hadolint ignore=DL3013\nRUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir .\n\nENTRYPOINT [\"prowler\"]\n"},"endTime":1672362050448}