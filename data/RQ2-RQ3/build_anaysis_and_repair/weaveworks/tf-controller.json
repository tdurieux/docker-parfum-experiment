{"repository":"https://github.com/weaveworks/tf-controller","dockerfilePath":"Dockerfile","startTime":1673197553290,"endTime":1673198348035,"clone":{"startTime":1673197553291,"stdout":"","stderr":"Cloning into '/tmp/dinghy-analysis/weaveworks/tf-controller'...\n","error":null,"endTime":1673197554293,"commit":"7e97242464144beeef4a566021c2fa03d22b9597"},"originalBuild":{"startTime":1673197554380,"endTime":1673198000395,"error":null,"stdout":"Sending build context to Docker daemon   4.38MB\r\r\nStep 1/23 : FROM golang:1.19 as builder\n1.19: Pulling from library/golang\n32de3c850997: Already exists\nfa1d4c8d85a4: Already exists\nc796299bbbdd: Already exists\n81283a9569ad: Already exists\nc768848b86a2: Already exists\n3a3324c1d283: Pulling fs layer\nea43a17566db: Pulling fs layer\nea43a17566db: Verifying Checksum\nea43a17566db: Download complete\n3a3324c1d283: Verifying Checksum\n3a3324c1d283: Download complete\n3a3324c1d283: Pull complete\nea43a17566db: Pull complete\nDigest: sha256:660f138b4477001d65324a51fa158c1b868651b44e43f0953bf062e9f38b72f3\nStatus: Downloaded newer image for golang:1.19\n ---> 6650307efe4a\nStep 2/23 : RUN apt-get update && apt-get install -y unzip\n ---> Running in 75251ebba2f5\nGet:1 http://deb.debian.org/debian bullseye InRelease [116 kB]\nGet:2 http://deb.debian.org/debian-security bullseye-security InRelease [48.4 kB]\nGet:3 http://deb.debian.org/debian bullseye-updates InRelease [44.1 kB]\nGet:4 http://deb.debian.org/debian bullseye/main amd64 Packages [8183 kB]\nGet:5 http://deb.debian.org/debian-security bullseye-security/main amd64 Packages [210 kB]\nGet:6 http://deb.debian.org/debian bullseye-updates/main amd64 Packages [14.6 kB]\nFetched 8616 kB in 3s (3400 kB/s)\nReading package lists...\nReading package lists...\nBuilding dependency tree...\nReading state information...\nSuggested packages:\n  zip\nThe following NEW packages will be installed:\n  unzip\n0 upgraded, 1 newly installed, 0 to remove and 1 not upgraded.\nNeed to get 172 kB of archives.\nAfter this operation, 393 kB of additional disk space will be used.\nGet:1 http://deb.debian.org/debian bullseye/main amd64 unzip amd64 6.0-26+deb11u1 [172 kB]\n\u001b[91mdebconf: delaying package configuration, since apt-utils is not installed\n\u001b[0mFetched 172 kB in 0s (7814 kB/s)\nSelecting previously unselected package unzip.\r\n(Reading database ... \r(Reading database ... 5%\r(Reading database ... 10%\r(Reading database ... 15%\r(Reading database ... 20%\r(Reading database ... 25%\r(Reading database ... 30%\r(Reading database ... 35%\r(Reading database ... 40%\r(Reading database ... 45%\r(Reading database ... 50%\r(Reading database ... 55%\r(Reading database ... 60%\r(Reading database ... 65%\r(Reading database ... 70%\r(Reading database ... 75%\r(Reading database ... 80%\r(Reading database ... 85%\r(Reading database ... 90%\r(Reading database ... 95%\r(Reading database ... 100%\r(Reading database ... 15718 files and directories currently installed.)\r\nPreparing to unpack .../unzip_6.0-26+deb11u1_amd64.deb ...\r\nUnpacking unzip (6.0-26+deb11u1) ...\r\nSetting up unzip (6.0-26+deb11u1) ...\r\nRemoving intermediate container 75251ebba2f5\n ---> 8bfc23101f37\nStep 3/23 : WORKDIR /workspace\n ---> Running in 342d5cbc0a05\nRemoving intermediate container 342d5cbc0a05\n ---> 5ed81f9bb998\nStep 4/23 : COPY api/ api/\n ---> 0494d7e8a360\nStep 5/23 : COPY tfctl/ tfctl/\n ---> e155643106f1\nStep 6/23 : COPY go.mod go.mod\n ---> 091bdc0d2f69\nStep 7/23 : COPY go.sum go.sum\n ---> 77c089f70fed\nStep 8/23 : RUN go mod download\n ---> Running in 33e87e309266\nRemoving intermediate container 33e87e309266\n ---> 488e7c8375b0\nStep 9/23 : COPY cmd/manager/main.go cmd/manager/main.go\n ---> 40da6c93efd3\nStep 10/23 : COPY controllers/ controllers/\n ---> 77d69905d8fa\nStep 11/23 : COPY mtls/ mtls/\n ---> abb31a777c14\nStep 12/23 : COPY runner/ runner/\n ---> de296f1ee2b5\nStep 13/23 : COPY utils/ utils/\n ---> 1c547c55679c\nStep 14/23 : RUN CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -gcflags=all=\"-N -l\" -a -o tf-controller cmd/manager/main.go\n ---> Running in 276fd846106d\nRemoving intermediate container 276fd846106d\n ---> 24493dd1cbbe\nStep 15/23 : FROM alpine:3.16.2\n3.16.2: Pulling from library/alpine\n213ec9aee27d: Already exists\nDigest: sha256:65a2763f593ae85fab3b5406dc9e80f744ec5b449f269b699b5efd37a07ad32e\nStatus: Downloaded newer image for alpine:3.16.2\n ---> 9c6f07244728\nStep 16/23 : LABEL org.opencontainers.image.source=\"https://github.com/weaveworks/tf-controller\"\n ---> Running in 6bbe53f7e049\nRemoving intermediate container 6bbe53f7e049\n ---> 9e0511974b2f\nStep 17/23 : RUN apk add --no-cache ca-certificates tini git openssh-client gnupg &&     apk add --no-cache libretls &&     apk add --no-cache busybox\n ---> Running in ef5102b28ae6\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.16/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.16/community/x86_64/APKINDEX.tar.gz\n(1/43) Installing ca-certificates (20220614-r0)\n(2/43) Installing brotli-libs (1.0.9-r6)\n(3/43) Installing nghttp2-libs (1.47.0-r0)\n(4/43) Installing libcurl (7.83.1-r5)\n(5/43) Installing expat (2.5.0-r0)\n(6/43) Installing pcre2 (10.40-r0)\n(7/43) Installing git (2.36.3-r0)\n(8/43) Installing libgpg-error (1.45-r0)\n(9/43) Installing libassuan (2.5.5-r0)\n(10/43) Installing libcap (2.64-r0)\n(11/43) Installing ncurses-terminfo-base (6.3_p20220521-r0)\n(12/43) Installing ncurses-libs (6.3_p20220521-r0)\n(13/43) Installing pinentry (1.2.0-r0)\nExecuting pinentry-1.2.0-r0.post-install\n(14/43) Installing libgcrypt (1.10.1-r0)\n(15/43) Installing gnupg-gpgconf (2.2.35-r4)\n(16/43) Installing libbz2 (1.0.8-r1)\n(17/43) Installing sqlite-libs (3.38.5-r0)\n(18/43) Installing gpg (2.2.35-r4)\n(19/43) Installing npth (1.6-r1)\n(20/43) Installing gpg-agent (2.2.35-r4)\n(21/43) Installing gpg-wks-server (2.2.35-r4)\n(22/43) Installing libksba (1.6.3-r0)\n(23/43) Installing gpgsm (2.2.35-r4)\n(24/43) Installing gpgv (2.2.35-r4)\n(25/43) Installing gmp (6.2.1-r2)\n(26/43) Installing nettle (3.7.3-r0)\n(27/43) Installing libffi (3.4.2-r1)\n(28/43) Installing p11-kit (0.24.1-r0)\n(29/43) Installing libtasn1 (4.18.0-r1)\n(30/43) Installing libunistring (1.0-r0)\n(31/43) Installing gnutls (3.7.7-r0)\n(32/43) Installing gdbm (1.23-r0)\n(33/43) Installing libsasl (2.1.28-r1)\n(34/43) Installing libldap (2.6.3-r3)\n(35/43) Installing gnupg-dirmngr (2.2.35-r4)\n(36/43) Installing gnupg-utils (2.2.35-r4)\n(37/43) Installing gnupg-wks-client (2.2.35-r4)\n(38/43) Installing gnupg (2.2.35-r4)\n(39/43) Installing openssh-keygen (9.0_p1-r2)\n(40/43) Installing libedit (20210910.3.1-r0)\n(41/43) Installing openssh-client-common (9.0_p1-r2)\n(42/43) Installing openssh-client-default (9.0_p1-r2)\n(43/43) Installing tini (0.19.0-r0)\nExecuting busybox-1.35.0-r17.trigger\nExecuting ca-certificates-20220614-r0.trigger\nOK: 38 MiB in 57 packages\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.16/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.16/community/x86_64/APKINDEX.tar.gz\n(1/1) Installing libretls (3.5.2-r0)\nOK: 38 MiB in 58 packages\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.16/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.16/community/x86_64/APKINDEX.tar.gz\nOK: 38 MiB in 58 packages\nRemoving intermediate container ef5102b28ae6\n ---> a31eed3d208d\nStep 18/23 : COPY --from=builder /workspace/tf-controller /usr/local/bin/\n ---> 3d7b622ca8f6\nStep 19/23 : RUN [ ! -e /etc/nsswitch.conf ] && echo 'hosts: files dns' > /etc/nsswitch.conf\n ---> Running in 032edafc6538\nRemoving intermediate container 032edafc6538\n ---> 9f69fa3b1123\nStep 20/23 : RUN addgroup --gid 65532 -S controller && adduser --uid 65532 -S controller -G controller\n ---> Running in 6e7c2b7206cc\nRemoving intermediate container 6e7c2b7206cc\n ---> 56666c0c8dc7\nStep 21/23 : USER 65532:65532\n ---> Running in 78d32d03115e\nRemoving intermediate container 78d32d03115e\n ---> 2f20409dbc71\nStep 22/23 : ENV GNUPGHOME=/tmp\n ---> Running in 75461f12cd3e\nRemoving intermediate container 75461f12cd3e\n ---> 9c2b110e25e5\nStep 23/23 : ENTRYPOINT [ \"/sbin/tini\", \"--\", \"tf-controller\" ]\n ---> Running in 785e3e4e60d3\nRemoving intermediate container 785e3e4e60d3\n ---> bafcf42c3097\nSuccessfully built bafcf42c3097\nSuccessfully tagged tf-controller:latest\n","stderr":"","imageSize":100365499},"repair":{"startTime":1673198000461,"endTime":1673198000594,"violations":[{"name":"aptGetInstallUseNoRec","position":{"start":3,"end":3,"columnStart":22,"columnEnd":46}},{"name":"ruleAptGetInstallThenRemoveAptLists","position":{"start":3,"end":3,"columnStart":22,"columnEnd":46}}],"repairedDockerfile":"# Build the manager binary\nFROM golang:1.19 as builder\n\nRUN apt-get update && apt-get install --no-install-recommends -y unzip && rm -rf /var/lib/apt/lists/*;\n\nWORKDIR /workspace\n# Copy API and its Go module\nCOPY api/ api/\n# Copy tfctl and its Go module\nCOPY tfctl/ tfctl/\n\n# Copy the Go Modules manifests\nCOPY go.mod go.mod\nCOPY go.sum go.sum\n# cache deps before building and copying source so that we don't need to re-download as much\n# and so that source changes don't invalidate our downloaded layer\nRUN go mod download\n\n# Copy the go source\nCOPY cmd/manager/main.go cmd/manager/main.go\nCOPY controllers/ controllers/\nCOPY mtls/ mtls/\nCOPY runner/ runner/\nCOPY utils/ utils/\n\n# Build\nRUN CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -gcflags=all=\"-N -l\" -a -o tf-controller cmd/manager/main.go\n\nFROM alpine:3.16.2\n\nLABEL org.opencontainers.image.source=\"https://github.com/weaveworks/tf-controller\"\n\nRUN apk add --no-cache ca-certificates tini git openssh-client gnupg && \\\n    apk add --no-cache libretls && \\\n    apk add --no-cache busybox\n\nCOPY --from=builder /workspace/tf-controller /usr/local/bin/\n\n# Create minimal nsswitch.conf file to prioritize the usage of /etc/hosts over DNS queries.\n# https://github.com/gliderlabs/docker-alpine/issues/367#issuecomment-354316460\nRUN [ ! -e /etc/nsswitch.conf ] && echo 'hosts: files dns' > /etc/nsswitch.conf\n\nRUN addgroup --gid 65532 -S controller && adduser --uid 65532 -S controller -G controller\n\nUSER 65532:65532\n\nENV GNUPGHOME=/tmp\n\nENTRYPOINT [ \"/sbin/tini\", \"--\", \"tf-controller\" ]\n"},"repairedBuild":{"startTime":1673198001015,"endTime":1673198346442,"error":null,"stdout":"Sending build context to Docker daemon   4.38MB\r\r\nStep 1/23 : FROM golang:1.19 as builder\n ---> 6650307efe4a\nStep 2/23 : RUN apt-get update && apt-get install --no-install-recommends -y unzip && rm -rf /var/lib/apt/lists/*;\n ---> Running in 9a24e825cb04\nGet:1 http://deb.debian.org/debian bullseye InRelease [116 kB]\nGet:2 http://deb.debian.org/debian-security bullseye-security InRelease [48.4 kB]\nGet:3 http://deb.debian.org/debian bullseye-updates InRelease [44.1 kB]\nGet:4 http://deb.debian.org/debian bullseye/main amd64 Packages [8183 kB]\nGet:5 http://deb.debian.org/debian-security bullseye-security/main amd64 Packages [210 kB]\nGet:6 http://deb.debian.org/debian bullseye-updates/main amd64 Packages [14.6 kB]\nFetched 8616 kB in 2s (4393 kB/s)\nReading package lists...\nReading package lists...\nBuilding dependency tree...\nReading state information...\nSuggested packages:\n  zip\nThe following NEW packages will be installed:\n  unzip\n0 upgraded, 1 newly installed, 0 to remove and 1 not upgraded.\nNeed to get 172 kB of archives.\nAfter this operation, 393 kB of additional disk space will be used.\nGet:1 http://deb.debian.org/debian bullseye/main amd64 unzip amd64 6.0-26+deb11u1 [172 kB]\n\u001b[91mdebconf: delaying package configuration, since apt-utils is not installed\n\u001b[0mFetched 172 kB in 0s (1080 kB/s)\nSelecting previously unselected package unzip.\r\n(Reading database ... \r(Reading database ... 5%\r(Reading database ... 10%\r(Reading database ... 15%\r(Reading database ... 20%\r(Reading database ... 25%\r(Reading database ... 30%\r(Reading database ... 35%\r(Reading database ... 40%\r(Reading database ... 45%\r(Reading database ... 50%\r(Reading database ... 55%\r(Reading database ... 60%\r(Reading database ... 65%\r(Reading database ... 70%\r(Reading database ... 75%\r(Reading database ... 80%\r(Reading database ... 85%\r(Reading database ... 90%\r(Reading database ... 95%\r(Reading database ... 100%\r(Reading database ... 15718 files and directories currently installed.)\r\nPreparing to unpack .../unzip_6.0-26+deb11u1_amd64.deb ...\r\nUnpacking unzip (6.0-26+deb11u1) ...\r\nSetting up unzip (6.0-26+deb11u1) ...\r\nRemoving intermediate container 9a24e825cb04\n ---> 4333c4164ea0\nStep 3/23 : WORKDIR /workspace\n ---> Running in d67191e895d8\nRemoving intermediate container d67191e895d8\n ---> efd1e35f0119\nStep 4/23 : COPY api/ api/\n ---> d24cb0167560\nStep 5/23 : COPY tfctl/ tfctl/\n ---> 780e5fb4a4c0\nStep 6/23 : COPY go.mod go.mod\n ---> bb6fa077fd29\nStep 7/23 : COPY go.sum go.sum\n ---> 190e3dc0fa1c\nStep 8/23 : RUN go mod download\n ---> Running in d34a2607b803\nRemoving intermediate container d34a2607b803\n ---> 191e23142b3b\nStep 9/23 : COPY cmd/manager/main.go cmd/manager/main.go\n ---> 828f80347d24\nStep 10/23 : COPY controllers/ controllers/\n ---> 30ba01945a29\nStep 11/23 : COPY mtls/ mtls/\n ---> 0ac1ab093bd5\nStep 12/23 : COPY runner/ runner/\n ---> c4d4e7b5e376\nStep 13/23 : COPY utils/ utils/\n ---> 1d68e9aa2e8d\nStep 14/23 : RUN CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build -gcflags=all=\"-N -l\" -a -o tf-controller cmd/manager/main.go\n ---> Running in b819bbac56ad\nRemoving intermediate container b819bbac56ad\n ---> c66eaaf68a99\nStep 15/23 : FROM alpine:3.16.2\n ---> 9c6f07244728\nStep 16/23 : LABEL org.opencontainers.image.source=\"https://github.com/weaveworks/tf-controller\"\n ---> Running in ac2d33e79cb9\nRemoving intermediate container ac2d33e79cb9\n ---> e53e3a77a829\nStep 17/23 : RUN apk add --no-cache ca-certificates tini git openssh-client gnupg &&     apk add --no-cache libretls &&     apk add --no-cache busybox\n ---> Running in cb36eaf9756e\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.16/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.16/community/x86_64/APKINDEX.tar.gz\n(1/43) Installing ca-certificates (20220614-r0)\n(2/43) Installing brotli-libs (1.0.9-r6)\n(3/43) Installing nghttp2-libs (1.47.0-r0)\n(4/43) Installing libcurl (7.83.1-r5)\n(5/43) Installing expat (2.5.0-r0)\n(6/43) Installing pcre2 (10.40-r0)\n(7/43) Installing git (2.36.3-r0)\n(8/43) Installing libgpg-error (1.45-r0)\n(9/43) Installing libassuan (2.5.5-r0)\n(10/43) Installing libcap (2.64-r0)\n(11/43) Installing ncurses-terminfo-base (6.3_p20220521-r0)\n(12/43) Installing ncurses-libs (6.3_p20220521-r0)\n(13/43) Installing pinentry (1.2.0-r0)\nExecuting pinentry-1.2.0-r0.post-install\n(14/43) Installing libgcrypt (1.10.1-r0)\n(15/43) Installing gnupg-gpgconf (2.2.35-r4)\n(16/43) Installing libbz2 (1.0.8-r1)\n(17/43) Installing sqlite-libs (3.38.5-r0)\n(18/43) Installing gpg (2.2.35-r4)\n(19/43) Installing npth (1.6-r1)\n(20/43) Installing gpg-agent (2.2.35-r4)\n(21/43) Installing gpg-wks-server (2.2.35-r4)\n(22/43) Installing libksba (1.6.3-r0)\n(23/43) Installing gpgsm (2.2.35-r4)\n(24/43) Installing gpgv (2.2.35-r4)\n(25/43) Installing gmp (6.2.1-r2)\n(26/43) Installing nettle (3.7.3-r0)\n(27/43) Installing libffi (3.4.2-r1)\n(28/43) Installing p11-kit (0.24.1-r0)\n(29/43) Installing libtasn1 (4.18.0-r1)\n(30/43) Installing libunistring (1.0-r0)\n(31/43) Installing gnutls (3.7.7-r0)\n(32/43) Installing gdbm (1.23-r0)\n(33/43) Installing libsasl (2.1.28-r1)\n(34/43) Installing libldap (2.6.3-r3)\n(35/43) Installing gnupg-dirmngr (2.2.35-r4)\n(36/43) Installing gnupg-utils (2.2.35-r4)\n(37/43) Installing gnupg-wks-client (2.2.35-r4)\n(38/43) Installing gnupg (2.2.35-r4)\n(39/43) Installing openssh-keygen (9.0_p1-r2)\n(40/43) Installing libedit (20210910.3.1-r0)\n(41/43) Installing openssh-client-common (9.0_p1-r2)\n(42/43) Installing openssh-client-default (9.0_p1-r2)\n(43/43) Installing tini (0.19.0-r0)\nExecuting busybox-1.35.0-r17.trigger\nExecuting ca-certificates-20220614-r0.trigger\nOK: 38 MiB in 57 packages\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.16/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.16/community/x86_64/APKINDEX.tar.gz\n(1/1) Installing libretls (3.5.2-r0)\nOK: 38 MiB in 58 packages\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.16/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.16/community/x86_64/APKINDEX.tar.gz\nOK: 38 MiB in 58 packages\nRemoving intermediate container cb36eaf9756e\n ---> 8e67dbbbca01\nStep 18/23 : COPY --from=builder /workspace/tf-controller /usr/local/bin/\n ---> d6c372f98a13\nStep 19/23 : RUN [ ! -e /etc/nsswitch.conf ] && echo 'hosts: files dns' > /etc/nsswitch.conf\n ---> Running in d2417f9c1bac\nRemoving intermediate container d2417f9c1bac\n ---> f1c09fac2194\nStep 20/23 : RUN addgroup --gid 65532 -S controller && adduser --uid 65532 -S controller -G controller\n ---> Running in 6e81c1cffdf4\nRemoving intermediate container 6e81c1cffdf4\n ---> eb899cc79204\nStep 21/23 : USER 65532:65532\n ---> Running in 51768c9f053d\nRemoving intermediate container 51768c9f053d\n ---> 04ba7525cf76\nStep 22/23 : ENV GNUPGHOME=/tmp\n ---> Running in 707045273a74\nRemoving intermediate container 707045273a74\n ---> fc2dbffe38bb\nStep 23/23 : ENTRYPOINT [ \"/sbin/tini\", \"--\", \"tf-controller\" ]\n ---> Running in bb4c6f6a2487\nRemoving intermediate container bb4c6f6a2487\n ---> 30120e2cadd4\nSuccessfully built 30120e2cadd4\nSuccessfully tagged tf-controller:latest\n","stderr":"","imageSize":100365499}}