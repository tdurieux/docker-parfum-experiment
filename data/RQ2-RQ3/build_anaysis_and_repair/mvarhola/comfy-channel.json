{"repository":"https://github.com/mvarhola/comfy-channel","dockerfilePath":"Dockerfile","startTime":1672151436257,"clone":{"stdout":"","stderr":"Cloning into '/tmp/dinghy-analysis/mvarhola/comfy-channel'...\n","error":null,"commit":"34dfb098e7cd071df0aff7d6416a68114a310d98"},"originalBuild":{"startTimestamp":1672151455851,"endTimestamp":1672151510641,"error":null,"stdout":"Sending build context to Docker daemon  398.1MB\r\r\nStep 1/14 : FROM jrottenberg/ffmpeg:3.3-alpine\n3.3-alpine: Pulling from jrottenberg/ffmpeg\n72cfd02ff4d0: Pulling fs layer\na1dd7e5f1d7a: Pulling fs layer\n108d9c6a8af8: Pulling fs layer\n72cfd02ff4d0: Download complete\na1dd7e5f1d7a: Verifying Checksum\na1dd7e5f1d7a: Download complete\n72cfd02ff4d0: Pull complete\na1dd7e5f1d7a: Pull complete\n108d9c6a8af8: Verifying Checksum\n108d9c6a8af8: Download complete\n108d9c6a8af8: Pull complete\nDigest: sha256:cee8558c998c1f2d00444cc75d2a16b4d710d603d4f38f77fd22bd0b98440342\nStatus: Downloaded newer image for jrottenberg/ffmpeg:3.3-alpine\n ---> 01afb7efb1a1\nStep 2/14 : ENV SERVER_IP=\"host.docker.internal\"\n ---> Running in 62372a37a8ae\nRemoving intermediate container 62372a37a8ae\n ---> 76e1a3c585da\nStep 3/14 : RUN apk add --no-cache git python3 py-psutil libmediainfo tzdata &&     python3 -m ensurepip &&     rm -r /usr/lib/python*/ensurepip &&     pip3 install --upgrade pip setuptools &&     if [ ! -e /usr/bin/pip ]; then ln -s pip3 /usr/bin/pip ; fi &&     if [[ ! -e /usr/bin/python ]]; then ln -sf /usr/bin/python3 /usr/bin/python; fi &&     rm -r /root/.cache\n ---> Running in 85dfad20fca2\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.13/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.13/community/x86_64/APKINDEX.tar.gz\n(1/14) Installing tinyxml2 (8.0.0-r0)\n(2/14) Installing libzen (0.4.38-r0)\n(3/14) Installing libmediainfo (20.09-r0)\n(4/14) Installing py3-psutil (5.8.0-r0)\n(5/14) Installing libbz2 (1.0.8-r1)\n(6/14) Installing libffi (3.3-r2)\n(7/14) Installing gdbm (1.19-r0)\n(8/14) Installing xz-libs (5.2.5-r1)\n(9/14) Installing ncurses-terminfo-base (6.2_p20210109-r1)\n(10/14) Installing ncurses-libs (6.2_p20210109-r1)\n(11/14) Installing readline (8.1.0-r0)\n(12/14) Installing sqlite-libs (3.34.1-r0)\n(13/14) Installing python3 (3.8.15-r0)\n(14/14) Installing tzdata (2022f-r1)\nExecuting busybox-1.32.1-r9.trigger\nOK: 79 MiB in 38 packages\nLooking in links: /tmp/tmpmzahq__i\nProcessing /tmp/tmpmzahq__i/setuptools-56.0.0-py3-none-any.whl\nProcessing /tmp/tmpmzahq__i/pip-22.0.4-py3-none-any.whl\nInstalling collected packages: setuptools, pip\nSuccessfully installed pip-22.0.4 setuptools-56.0.0\n\u001b[91mWARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv\n\u001b[0mRequirement already satisfied: pip in /usr/lib/python3.8/site-packages (22.0.4)\nCollecting pip\n  Downloading pip-22.3.1-py3-none-any.whl (2.1 MB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 2.1/2.1 MB 6.8 MB/s eta 0:00:00\nRequirement already satisfied: setuptools in /usr/lib/python3.8/site-packages (56.0.0)\nCollecting setuptools\n  Downloading setuptools-65.6.3-py3-none-any.whl (1.2 MB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 1.2/1.2 MB 28.2 MB/s eta 0:00:00\nInstalling collected packages: setuptools, pip\n  Attempting uninstall: setuptools\n    Found existing installation: setuptools 56.0.0\n    Uninstalling setuptools-56.0.0:\n      Successfully uninstalled setuptools-56.0.0\n  Attempting uninstall: pip\n    Found existing installation: pip 22.0.4\n    Uninstalling pip-22.0.4:\n      Successfully uninstalled pip-22.0.4\nSuccessfully installed pip-22.3.1 setuptools-65.6.3\n\u001b[91mWARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv\n\u001b[0mRemoving intermediate container 85dfad20fca2\n ---> 8da0959e820b\nStep 4/14 : RUN cp /usr/share/zoneinfo/America/Chicago /etc/localtime\n ---> Running in 7b870db8b355\nRemoving intermediate container 7b870db8b355\n ---> b7240e582d8a\nStep 5/14 : WORKDIR /comfy-channel\n ---> Running in 58a6d7c93237\nRemoving intermediate container 58a6d7c93237\n ---> 921b66a7aed1\nStep 6/14 : ADD src /comfy-channel/src/\n ---> a19fb7366f0b\nStep 7/14 : ADD upnext /comfy-channel/upnext/\n ---> 5e7d40fc7732\nStep 8/14 : ADD fonts /comfy-channel/fonts/\n ---> d9e20ca8e2c0\nStep 9/14 : ADD playout.ini /comfy-channel/\n ---> 5c2e780e10d1\nStep 10/14 : RUN ls\n ---> Running in 1082e9fe9760\nfonts\nplayout.ini\nsrc\nupnext\nRemoving intermediate container 1082e9fe9760\n ---> 605f7d505fd8\nStep 11/14 : RUN pip install --trusted-host pypi.python.org -r /comfy-channel/src/requirements.txt\n ---> Running in 8ff4051c3207\nCollecting colorama\n  Downloading colorama-0.4.6-py2.py3-none-any.whl (25 kB)\nCollecting ffmpeg-python\n  Downloading ffmpeg_python-0.2.0-py3-none-any.whl (25 kB)\nRequirement already satisfied: psutil in /usr/lib/python3.8/site-packages (from -r /comfy-channel/src/requirements.txt (line 3)) (5.8.0)\nCollecting pymediainfo\n  Downloading pymediainfo-6.0.1.tar.gz (446 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 446.5/446.5 kB 23.2 MB/s eta 0:00:00\n  Preparing metadata (setup.py): started\n  Preparing metadata (setup.py): finished with status 'done'\nCollecting future\n  Downloading future-0.18.2.tar.gz (829 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 829.2/829.2 kB 37.7 MB/s eta 0:00:00\n  Preparing metadata (setup.py): started\n  Preparing metadata (setup.py): finished with status 'done'\nInstalling collected packages: pymediainfo, future, colorama, ffmpeg-python\n\u001b[91m  DEPRECATION: pymediainfo is being installed using the legacy 'setup.py install' method, because it does not have a 'pyproject.toml' and the 'wheel' package is not installed. pip 23.1 will enforce this behaviour change. A possible replacement is to enable the '--use-pep517' option. Discussion can be found at https://github.com/pypa/pip/issues/8559\n\u001b[0m  Running setup.py install for pymediainfo: started\n  Running setup.py install for pymediainfo: finished with status 'done'\n\u001b[91m  DEPRECATION: future is being installed using the legacy 'setup.py install' method, because it does not have a 'pyproject.toml' and the 'wheel' package is not installed. pip 23.1 will enforce this behaviour change. A possible replacement is to enable the '--use-pep517' option. Discussion can be found at https://github.com/pypa/pip/issues/8559\n\u001b[0m  Running setup.py install for future: started\n  Running setup.py install for future: finished with status 'done'\nSuccessfully installed colorama-0.4.6 ffmpeg-python-0.2.0 future-0.18.2 pymediainfo-6.0.1\n\u001b[91mWARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv\n\u001b[0mRemoving intermediate container 8ff4051c3207\n ---> 485b84baf750\nStep 12/14 : ENTRYPOINT []\n ---> Running in 1b2a8cf723b8\nRemoving intermediate container 1b2a8cf723b8\n ---> 0a10761c192a\nStep 13/14 : EXPOSE 1935\n ---> Running in 10207374e54c\nRemoving intermediate container 10207374e54c\n ---> 46dea90cdda4\nStep 14/14 : CMD python -u src/ComfyChannel.py -o \"rtmp://\"${SERVER_IP}\n ---> Running in 398c4b68c3e0\nRemoving intermediate container 398c4b68c3e0\n ---> c41f3c0b4ba3\nSuccessfully built c41f3c0b4ba3\nSuccessfully tagged comfy-channel:latest\n","stderr":"","imageSize":406025731},"repair":{"violations":[{"name":"pipUseNoCacheDir","position":{"start":10,"end":10,"columnStart":4,"columnEnd":41}},{"name":"pipUseNoCacheDir","position":{"start":30,"end":30,"columnStart":4,"columnEnd":85}}],"repairedDockerfile":"FROM jrottenberg/ffmpeg:3.3-alpine\n\n# Get host instance IP\nENV SERVER_IP=\"host.docker.internal\"\n\n# Install Python3 and Pip\n# from frolvlad/alpine-python3\nRUN apk add --no-cache git python3 py-psutil libmediainfo tzdata && \\\n    python3 -m ensurepip && \\\n    rm -r /usr/lib/python*/ensurepip && \\\n    pip3 install --no-cache-dir --upgrade pip setuptools && \\\n    if [ ! -e /usr/bin/pip ]; then ln -s pip3 /usr/bin/pip ; fi && \\\n    if [[ ! -e /usr/bin/python ]]; then ln -sf /usr/bin/python3 /usr/bin/python; fi && \\\n    rm -r /root/.cache\n\n# Set system time to Chicago Time (can be changed)\nRUN cp /usr/share/zoneinfo/America/Chicago /etc/localtime\n\n# Set the working directory\nWORKDIR /comfy-channel\n\n# Clone the comfy-channel git repo\nADD src /comfy-channel/src/\nADD upnext /comfy-channel/upnext/\nADD fonts /comfy-channel/fonts/\nADD playout.ini /comfy-channel/\n\nRUN ls\n\n# Install any needed packages specified in requirements.txt\nRUN pip install --no-cache-dir --trusted-host pypi.python.org -r /comfy-channel/src/requirements.txt\n\n# Reset the entry point from jrottenberg/ffmpeg\nENTRYPOINT []\n\n# Expose RTMP port\nEXPOSE 1935\n\n# Run ComfyChannel.py when the container launches\n#CMD [\"python\",\"-u\",\"src/ComfyChannel.py\", \"-o\", \"echo ${output_location}\"]\nCMD python -u src/ComfyChannel.py -o \"rtmp://\"${SERVER_IP}"},"repairedBuild":{"startTimestamp":1672151511249,"endTimestamp":1672151531140,"error":{"code":1,"killed":false,"signal":null,"cmd":"docker build --no-cache --force-rm -t comfy-channel:latest -f /tmp/dinghy-analysis/mvarhola/comfy-channel/Dockerfile ."},"stdout":"Sending build context to Docker daemon  398.1MB\r\r\nStep 1/14 : FROM jrottenberg/ffmpeg:3.3-alpine\n ---> 01afb7efb1a1\nStep 2/14 : ENV SERVER_IP=\"host.docker.internal\"\n ---> Running in 1cb4aae30416\nRemoving intermediate container 1cb4aae30416\n ---> cd9c2635871e\nStep 3/14 : RUN apk add --no-cache git python3 py-psutil libmediainfo tzdata &&     python3 -m ensurepip &&     rm -r /usr/lib/python*/ensurepip &&     pip3 install --no-cache-dir --upgrade pip setuptools &&     if [ ! -e /usr/bin/pip ]; then ln -s pip3 /usr/bin/pip ; fi &&     if [[ ! -e /usr/bin/python ]]; then ln -sf /usr/bin/python3 /usr/bin/python; fi &&     rm -r /root/.cache\n ---> Running in 5e04e00b7388\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.13/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.13/community/x86_64/APKINDEX.tar.gz\n(1/14) Installing tinyxml2 (8.0.0-r0)\n(2/14) Installing libzen (0.4.38-r0)\n(3/14) Installing libmediainfo (20.09-r0)\n(4/14) Installing py3-psutil (5.8.0-r0)\n(5/14) Installing libbz2 (1.0.8-r1)\n(6/14) Installing libffi (3.3-r2)\n(7/14) Installing gdbm (1.19-r0)\n(8/14) Installing xz-libs (5.2.5-r1)\n(9/14) Installing ncurses-terminfo-base (6.2_p20210109-r1)\n(10/14) Installing ncurses-libs (6.2_p20210109-r1)\n(11/14) Installing readline (8.1.0-r0)\n(12/14) Installing sqlite-libs (3.34.1-r0)\n(13/14) Installing python3 (3.8.15-r0)\n(14/14) Installing tzdata (2022f-r1)\nExecuting busybox-1.32.1-r9.trigger\nOK: 79 MiB in 38 packages\nLooking in links: /tmp/tmprkxp1uba\nProcessing /tmp/tmprkxp1uba/setuptools-56.0.0-py3-none-any.whl\nProcessing /tmp/tmprkxp1uba/pip-22.0.4-py3-none-any.whl\nInstalling collected packages: setuptools, pip\nSuccessfully installed pip-22.0.4 setuptools-56.0.0\n\u001b[91mWARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv\n\u001b[0mRequirement already satisfied: pip in /usr/lib/python3.8/site-packages (22.0.4)\nCollecting pip\n  Downloading pip-22.3.1-py3-none-any.whl (2.1 MB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 2.1/2.1 MB 96.9 MB/s eta 0:00:00\nRequirement already satisfied: setuptools in /usr/lib/python3.8/site-packages (56.0.0)\nCollecting setuptools\n  Downloading setuptools-65.6.3-py3-none-any.whl (1.2 MB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 1.2/1.2 MB 75.7 MB/s eta 0:00:00\nInstalling collected packages: setuptools, pip\n  Attempting uninstall: setuptools\n    Found existing installation: setuptools 56.0.0\n    Uninstalling setuptools-56.0.0:\n      Successfully uninstalled setuptools-56.0.0\n  Attempting uninstall: pip\n    Found existing installation: pip 22.0.4\n    Uninstalling pip-22.0.4:\n      Successfully uninstalled pip-22.0.4\nSuccessfully installed pip-22.3.1 setuptools-65.6.3\n\u001b[91mWARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv\n\u001b[0m\u001b[91mrm: can't remove '/root/.cache': No such file or directory\n\u001b[0mRemoving intermediate container 5e04e00b7388\n","stderr":"The command '/bin/sh -c apk add --no-cache git python3 py-psutil libmediainfo tzdata &&     python3 -m ensurepip &&     rm -r /usr/lib/python*/ensurepip &&     pip3 install --no-cache-dir --upgrade pip setuptools &&     if [ ! -e /usr/bin/pip ]; then ln -s pip3 /usr/bin/pip ; fi &&     if [[ ! -e /usr/bin/python ]]; then ln -sf /usr/bin/python3 /usr/bin/python; fi &&     rm -r /root/.cache' returned a non-zero code: 1\n"},"endTime":1672151531241}