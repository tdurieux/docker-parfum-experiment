{"repository":"https://github.com/remix-run/blues-stack","dockerfilePath":"Dockerfile","startTime":1672390194192,"clone":{"stdout":"","stderr":"Cloning into '/tmp/dinghy-analysis/remix-run/blues-stack'...\n","error":null,"commit":"d5740d9932b215ca9693c4f17054a954c5563ba5"},"originalBuild":{"startTimestamp":1672390195003,"endTimestamp":1672390477694,"error":null,"stdout":"Sending build context to Docker daemon  369.2kB\r\r\nStep 1/27 : FROM node:16-bullseye-slim as base\n16-bullseye-slim: Pulling from library/node\n3f4ca61aafcd: Already exists\n00fde01815c9: Pulling fs layer\n031949ce49ec: Pulling fs layer\n16cee6032317: Pulling fs layer\nfd35893cdbff: Pulling fs layer\nfd35893cdbff: Waiting\n00fde01815c9: Download complete\n16cee6032317: Verifying Checksum\n16cee6032317: Download complete\n00fde01815c9: Pull complete\nfd35893cdbff: Verifying Checksum\nfd35893cdbff: Download complete\n031949ce49ec: Verifying Checksum\n031949ce49ec: Download complete\n031949ce49ec: Pull complete\n16cee6032317: Pull complete\nfd35893cdbff: Pull complete\nDigest: sha256:30ec224b4c35a768e038674444d0718494a7d8847c96ee73a8d3db795135b4c9\nStatus: Downloaded newer image for node:16-bullseye-slim\n ---> b3b9a79a4762\nStep 2/27 : ENV NODE_ENV production\n ---> Running in 7e724c3e77c6\nRemoving intermediate container 7e724c3e77c6\n ---> f055c21a4679\nStep 3/27 : RUN apt-get update && apt-get install -y openssl\n ---> Running in 503ce956b26d\nGet:1 http://deb.debian.org/debian bullseye InRelease [116 kB]\nGet:2 http://deb.debian.org/debian-security bullseye-security InRelease [48.4 kB]\nGet:3 http://deb.debian.org/debian bullseye-updates InRelease [44.1 kB]\nGet:4 http://deb.debian.org/debian bullseye/main amd64 Packages [8183 kB]\nGet:5 http://deb.debian.org/debian-security bullseye-security/main amd64 Packages [210 kB]\nGet:6 http://deb.debian.org/debian bullseye-updates/main amd64 Packages [14.6 kB]\nFetched 8616 kB in 1s (6767 kB/s)\nReading package lists...\nReading package lists...\nBuilding dependency tree...\nReading state information...\nSuggested packages:\n  ca-certificates\nThe following NEW packages will be installed:\n  openssl\n0 upgraded, 1 newly installed, 0 to remove and 0 not upgraded.\nNeed to get 853 kB of archives.\nAfter this operation, 1501 kB of additional disk space will be used.\nGet:1 http://deb.debian.org/debian bullseye/main amd64 openssl amd64 1.1.1n-0+deb11u3 [853 kB]\n\u001b[91mdebconf: delaying package configuration, since apt-utils is not installed\n\u001b[0mFetched 853 kB in 0s (30.2 MB/s)\nSelecting previously unselected package openssl.\r\n(Reading database ... \r(Reading database ... 5%\r(Reading database ... 10%\r(Reading database ... 15%\r(Reading database ... 20%\r(Reading database ... 25%\r(Reading database ... 30%\r(Reading database ... 35%\r(Reading database ... 40%\r(Reading database ... 45%\r(Reading database ... 50%\r(Reading database ... 55%\r(Reading database ... 60%\r(Reading database ... 65%\r(Reading database ... 70%\r(Reading database ... 75%\r(Reading database ... 80%\r(Reading database ... 85%\r(Reading database ... 90%\r(Reading database ... 95%\r(Reading database ... 100%\r(Reading database ... 6661 files and directories currently installed.)\r\nPreparing to unpack .../openssl_1.1.1n-0+deb11u3_amd64.deb ...\r\nUnpacking openssl (1.1.1n-0+deb11u3) ...\r\nSetting up openssl (1.1.1n-0+deb11u3) ...\r\nRemoving intermediate container 503ce956b26d\n ---> accce57eb101\nStep 4/27 : FROM base as deps\n ---> accce57eb101\nStep 5/27 : WORKDIR /myapp\n ---> Running in 72e5b059b5a9\nRemoving intermediate container 72e5b059b5a9\n ---> 783a152434e9\nStep 6/27 : ADD package.json .npmrc ./\n ---> 79234bae3445\nStep 7/27 : RUN npm install --production=false\n ---> Running in e35ee3e21630\n\u001b[91mnpm\u001b[0m\u001b[91m WARN config production Use `--omit=dev` instead.\n\u001b[0m\u001b[91mnpm WARN deprecated urix@0.1.0: Please see https://github.com/lydell/urix#deprecated\n\u001b[0m\u001b[91mnpm WARN deprecated source-map-url@0.4.1: See https://github.com/lydell/source-map-url#deprecated\n\u001b[0m\u001b[91mnpm WARN deprecated resolve-url@0.2.1: https://github.com/lydell/resolve-url#deprecated\n\u001b[0m\u001b[91mnpm WARN deprecated source-map-resolve@0.5.3: See https://github.com/lydell/source-map-resolve#deprecated\n\u001b[0m\u001b[91mnpm WARN deprecated\u001b[0m\u001b[91m rollup-plugin-inject@3.0.2: This package has been deprecated and is no longer maintained. Please use @rollup/plugin-inject.\n\u001b[0m\u001b[91mnpm WARN deprecated sourcemap-codec@1.4.8: Please use @jridgewell/sourcemap-codec instead\n\u001b[0m\u001b[91mnpm WARN deprecated @npmcli/move-file@1.1.2: This functionality has been moved to @npmcli/fs\n\u001b[0m\nadded 1430 packages, and audited 1431 packages in 2m\n\n258 packages are looking for funding\n  run `npm fund` for details\n\n9 vulnerabilities (1 moderate, 7 high, 1 critical)\n\nTo address issues that do not require attention, run:\n  npm audit fix\n\nSome issues need review, and may require choosing\na different dependency.\n\nRun `npm audit` for details.\n\u001b[91mnpm notice \nnpm \u001b[0m\u001b[91mnotice New major version of npm available! 8.19.3 -> 9.2.0\nnpm notice Changelog: <https://github.com/npm/cli/releases/tag/v9.2.0>\nnpm notice Run `npm install -g npm@9.2.0` to update!\nnpm notice \n\u001b[0mRemoving intermediate container e35ee3e21630\n ---> c1cb48b09c96\nStep 8/27 : FROM base as production-deps\n ---> accce57eb101\nStep 9/27 : WORKDIR /myapp\n ---> Running in b4fbe73189d9\nRemoving intermediate container b4fbe73189d9\n ---> 0ed42baf51f6\nStep 10/27 : COPY --from=deps /myapp/node_modules /myapp/node_modules\n ---> 02bc1c903c6c\nStep 11/27 : ADD package.json .npmrc ./\n ---> 78c0a61aeabb\nStep 12/27 : RUN npm prune --production\n ---> Running in 3f0b9881fd0d\n\u001b[91mnpm\u001b[0m\u001b[91m WARN config production Use `--omit=dev` instead.\n\u001b[0m\nup to date, audited 144 packages in 4s\n\n15 packages are looking for funding\n  run `npm fund` for details\n\nfound 0 vulnerabilities\n\u001b[91mnpm notice \nnpm notice\u001b[0m\u001b[91m New major version of npm available! 8.19.3 -> 9.2.0\nnpm notice Changelog: <https://github.com/npm/cli/releases/tag/v9.2.0>\nnpm notice Run `npm install -g npm@9.2.0` to update!\n\u001b[0m\u001b[91mnpm notice \n\u001b[0mRemoving intermediate container 3f0b9881fd0d\n ---> 6bfe749c47c1\nStep 13/27 : FROM base as build\n ---> accce57eb101\nStep 14/27 : WORKDIR /myapp\n ---> Running in 9ec2f501fa8a\nRemoving intermediate container 9ec2f501fa8a\n ---> ab9b43941e87\nStep 15/27 : COPY --from=deps /myapp/node_modules /myapp/node_modules\n ---> ec39e8374f2d\nStep 16/27 : ADD prisma .\n ---> 8937f54e8cfd\nStep 17/27 : RUN npx prisma generate\n ---> Running in 98b3b6952909\nPrisma schema loaded from schema.prisma\n\n✔ Generated Prisma Client (4.8.0 | library) to ./node_modules/@prisma/client in 161ms\nYou can now start using Prisma Client in your code. Reference: https://pris.ly/d/client\n```\nimport { PrismaClient } from '@prisma/client'\nconst prisma = new PrismaClient()\n```\n\u001b[91mnpm\u001b[0m\u001b[91m notice\u001b[0m\u001b[91m \nnpm\u001b[0m\u001b[91m \u001b[0m\u001b[91mnotice\u001b[0m\u001b[91m New major version of npm available! 8.19.3 -> 9.2.0\n\u001b[0m\u001b[91mnpm\u001b[0m\u001b[91m \u001b[0m\u001b[91mnotice\u001b[0m\u001b[91m Changelog: <https://github.com/npm/cli/releases/tag/v9.2.0>\n\u001b[0m\u001b[91mnpm\u001b[0m\u001b[91m notice\u001b[0m\u001b[91m Run `npm install -g npm@9.2.0` to update!\nnpm \u001b[0m\u001b[91mnotice\u001b[0m\u001b[91m \n\u001b[0mRemoving intermediate container 98b3b6952909\n ---> 3f3bb6380bbe\nStep 18/27 : ADD . .\n ---> ed31c1c19712\nStep 19/27 : RUN npm run build\n ---> Running in 30ce587d630e\n\n> build\n> run-s build:*\n\n\n> build:css\n> npm run generate:css -- --minify\n\n\n> generate:css\n> tailwindcss -o ./app/styles/tailwind.css --minify\n\n\u001b[91m\n\u001b[0m\u001b[91mRebuilding...\n\u001b[0m\u001b[91m\n\u001b[0m\u001b[91mDone in 319ms.\n\u001b[0m\n> build:remix\n> remix build\n\nBuilding Remix app in production mode...\nBuilt in 546ms\n\n> build:server\n> esbuild --platform=node --format=cjs ./server.ts --outdir=build --bundle\n\n\u001b[91m\n  build/server.js  1.8mb ⚠️\n\n⚡ Done in 76ms\n\u001b[0mRemoving intermediate container 30ce587d630e\n ---> 9e9e4fa976ca\nStep 20/27 : FROM base\n ---> accce57eb101\nStep 21/27 : WORKDIR /myapp\n ---> Running in f07247d3b452\nRemoving intermediate container f07247d3b452\n ---> 9fdc68c639d4\nStep 22/27 : COPY --from=production-deps /myapp/node_modules /myapp/node_modules\n ---> 0f80c6680373\nStep 23/27 : COPY --from=build /myapp/node_modules/.prisma /myapp/node_modules/.prisma\n ---> 25971a5c5125\nStep 24/27 : COPY --from=build /myapp/build /myapp/build\n ---> 9422ea9f9e0c\nStep 25/27 : COPY --from=build /myapp/public /myapp/public\n ---> d62409cbae16\nStep 26/27 : ADD . .\n ---> 588ec1d6c0f7\nStep 27/27 : CMD [\"npm\", \"start\"]\n ---> Running in 5a70ce7227b8\nRemoving intermediate container 5a70ce7227b8\n ---> a55f9efd994f\nSuccessfully built a55f9efd994f\nSuccessfully tagged blues-stack:latest\n","stderr":"","imageSize":263992412},"repair":{"violations":[{"name":"npmCacheCleanAfterInstall","position":{"start":15,"end":15,"columnStart":4,"columnEnd":34}},{"name":"ruleAptGetInstallUseNoRec","position":{"start":7,"end":7,"columnStart":22,"columnEnd":48}},{"name":"ruleAptGetInstallThenRemoveAptLists","position":{"start":7,"end":7,"columnStart":22,"columnEnd":48}}],"repairedDockerfile":"# base node image\nFROM node:16-bullseye-slim as base\n\n# set for base and all layer that inherit from it\nENV NODE_ENV production\n\n# Install openssl for Prisma\nRUN apt-get update && apt-get install --no-install-recommends -y openssl\n\n# Install all node_modules, including dev dependencies\nFROM base as deps\n\nWORKDIR /myapp\n\nADD package.json .npmrc ./\nRUN npm install --production=false\n\n# Setup production node_modules\nFROM base as production-deps\n\nWORKDIR /myapp\n\nCOPY --from=deps /myapp/node_modules /myapp/node_modules\nADD package.json .npmrc ./\nRUN npm prune --production\n\n# Build the app\nFROM base as build\n\nWORKDIR /myapp\n\nCOPY --from=deps /myapp/node_modules /myapp/node_modules\n\nADD prisma .\nRUN npx prisma generate\n\nADD . .\nRUN npm run build\n\n# Finally, build the production image with minimal footprint\nFROM base\n\nWORKDIR /myapp\n\nCOPY --from=production-deps /myapp/node_modules /myapp/node_modules\nCOPY --from=build /myapp/node_modules/.prisma /myapp/node_modules/.prisma\n\nCOPY --from=build /myapp/build /myapp/build\nCOPY --from=build /myapp/public /myapp/public\nADD . .\n\nCMD [\"npm\", \"start\"]\n"},"repairedBuild":{"startTimestamp":1672390478083,"endTimestamp":1672390784474,"error":null,"stdout":"Sending build context to Docker daemon  369.2kB\r\r\nStep 1/27 : FROM node:16-bullseye-slim as base\n ---> b3b9a79a4762\nStep 2/27 : ENV NODE_ENV production\n ---> Running in 95b2a9e07eb4\nRemoving intermediate container 95b2a9e07eb4\n ---> a2f2752ad307\nStep 3/27 : RUN apt-get update && apt-get install --no-install-recommends -y openssl\n ---> Running in 19f7f75c14ec\nGet:1 http://deb.debian.org/debian bullseye InRelease [116 kB]\nGet:2 http://deb.debian.org/debian-security bullseye-security InRelease [48.4 kB]\nGet:3 http://deb.debian.org/debian bullseye-updates InRelease [44.1 kB]\nGet:4 http://deb.debian.org/debian bullseye/main amd64 Packages [8183 kB]\nGet:5 http://deb.debian.org/debian-security bullseye-security/main amd64 Packages [210 kB]\nGet:6 http://deb.debian.org/debian bullseye-updates/main amd64 Packages [14.6 kB]\nFetched 8616 kB in 1s (6347 kB/s)\nReading package lists...\nReading package lists...\nBuilding dependency tree...\nReading state information...\nSuggested packages:\n  ca-certificates\nThe following NEW packages will be installed:\n  openssl\n0 upgraded, 1 newly installed, 0 to remove and 0 not upgraded.\nNeed to get 853 kB of archives.\nAfter this operation, 1501 kB of additional disk space will be used.\nGet:1 http://deb.debian.org/debian bullseye/main amd64 openssl amd64 1.1.1n-0+deb11u3 [853 kB]\n\u001b[91mdebconf: delaying package configuration, since apt-utils is not installed\n\u001b[0mFetched 853 kB in 0s (23.8 MB/s)\nSelecting previously unselected package openssl.\r\n(Reading database ... \r(Reading database ... 5%\r(Reading database ... 10%\r(Reading database ... 15%\r(Reading database ... 20%\r(Reading database ... 25%\r(Reading database ... 30%\r(Reading database ... 35%\r(Reading database ... 40%\r(Reading database ... 45%\r(Reading database ... 50%\r(Reading database ... 55%\r(Reading database ... 60%\r(Reading database ... 65%\r(Reading database ... 70%\r(Reading database ... 75%\r(Reading database ... 80%\r(Reading database ... 85%\r(Reading database ... 90%\r(Reading database ... 95%\r(Reading database ... 100%\r(Reading database ... 6661 files and directories currently installed.)\r\nPreparing to unpack .../openssl_1.1.1n-0+deb11u3_amd64.deb ...\r\nUnpacking openssl (1.1.1n-0+deb11u3) ...\r\nSetting up openssl (1.1.1n-0+deb11u3) ...\r\nRemoving intermediate container 19f7f75c14ec\n ---> 7f0fdfedfa43\nStep 4/27 : FROM base as deps\n ---> 7f0fdfedfa43\nStep 5/27 : WORKDIR /myapp\n ---> Running in 4049aa0474c2\nRemoving intermediate container 4049aa0474c2\n ---> a71d16ec0b7d\nStep 6/27 : ADD package.json .npmrc ./\n ---> 534527ffb476\nStep 7/27 : RUN npm install --production=false\n ---> Running in 73c47bfa033e\n\u001b[91mnpm\u001b[0m\u001b[91m WARN config production Use `--omit=dev` instead.\n\u001b[0m\u001b[91mnpm WARN deprecated resolve-url@0.2.1: https://github.com/lydell/resolve-url#deprecated\n\u001b[0m\u001b[91mnpm WARN deprecated urix@0.1.0: Please see https://github.com/lydell/urix#deprecated\n\u001b[0m\u001b[91mnpm WARN deprecated source-map-url@0.4.1: See https://github.com/lydell/source-map-url#deprecated\n\u001b[0m\u001b[91mnpm WARN deprecated source-map-resolve@0.5.3: See https://github.com/lydell/source-map-resolve#deprecated\n\u001b[0m\u001b[91mnpm WARN deprecated rollup-plugin-inject@3.0.2: This package has been deprecated and is no longer maintained. Please use @rollup/plugin-inject.\n\u001b[0m\u001b[91mnpm WARN deprecated sourcemap-codec@1.4.8: Please use @jridgewell/sourcemap-codec instead\n\u001b[0m\u001b[91mnpm WARN deprecated @npmcli/move-file@1.1.2: This functionality has been moved to @npmcli/fs\n\u001b[0m\nadded 1430 packages, and audited 1431 packages in 2m\n\n258 packages are looking for funding\n  run `npm fund` for details\n\n9 vulnerabilities (1 moderate, 7 high, 1 critical)\n\nTo address issues that do not require attention, run:\n  npm audit fix\n\nSome issues need review, and may require choosing\na different dependency.\n\nRun `npm audit` for details.\n\u001b[91mnpm notice \nnpm notice New major version of npm available! 8.19.3 -> 9.2.0\n\u001b[0m\u001b[91mnpm notice Changelog: <https://github.com/npm/cli/releases/tag/v9.2.0>\nnpm notice Run `npm install -g npm@9.2.0` to update!\nnpm notice\u001b[0m\u001b[91m \n\u001b[0mRemoving intermediate container 73c47bfa033e\n ---> 0f4d2a9d556d\nStep 8/27 : FROM base as production-deps\n ---> 7f0fdfedfa43\nStep 9/27 : WORKDIR /myapp\n ---> Running in 59dcd849b681\nRemoving intermediate container 59dcd849b681\n ---> d8e057c63af5\nStep 10/27 : COPY --from=deps /myapp/node_modules /myapp/node_modules\n ---> 8102099db7d3\nStep 11/27 : ADD package.json .npmrc ./\n ---> 9ed718d10c8b\nStep 12/27 : RUN npm prune --production\n ---> Running in 37a30effebe3\n\u001b[91mnpm\u001b[0m\u001b[91m WARN config\u001b[0m\u001b[91m production Use `--omit=dev` instead.\n\u001b[0m\nup to date, audited 144 packages in 6s\n\n15 packages are looking for funding\n  run `npm fund` for details\n\nfound 0 vulnerabilities\n\u001b[91mnpm notice\u001b[0m\u001b[91m \nnpm notice\u001b[0m\u001b[91m New major version of npm available! 8.19.3 -> 9.2.0\nnpm notice\u001b[0m\u001b[91m Changelog: <https://github.com/npm/cli/releases/tag/v9.2.0>\nnpm\u001b[0m\u001b[91m notice\u001b[0m\u001b[91m Run `npm install -g npm@9.2.0` to update!\nnpm notice \n\u001b[0mRemoving intermediate container 37a30effebe3\n ---> 5f316386ae03\nStep 13/27 : FROM base as build\n ---> 7f0fdfedfa43\nStep 14/27 : WORKDIR /myapp\n ---> Running in 4964683ab24f\nRemoving intermediate container 4964683ab24f\n ---> 4d2b838b06d4\nStep 15/27 : COPY --from=deps /myapp/node_modules /myapp/node_modules\n ---> f83a104f8d77\nStep 16/27 : ADD prisma .\n ---> 0342be0fb9c5\nStep 17/27 : RUN npx prisma generate\n ---> Running in c23b1b9b23ed\nPrisma schema loaded from schema.prisma\n\n✔ Generated Prisma Client (4.8.0 | library) to ./node_modules/@prisma/client in 201ms\nYou can now start using Prisma Client in your code. Reference: https://pris.ly/d/client\n```\nimport { PrismaClient } from '@prisma/client'\nconst prisma = new PrismaClient()\n```\n\u001b[91mnpm\u001b[0m\u001b[91m notice\u001b[0m\u001b[91m \n\u001b[0m\u001b[91mnpm \u001b[0m\u001b[91mnotice\u001b[0m\u001b[91m New major version of npm available! 8.19.3 -> 9.2.0\nnpm\u001b[0m\u001b[91m \u001b[0m\u001b[91mnotice\u001b[0m\u001b[91m Changelog: <https://github.com/npm/cli/releases/tag/v9.2.0>\n\u001b[0m\u001b[91mnpm \u001b[0m\u001b[91mnotice\u001b[0m\u001b[91m Run `npm install -g npm@9.2.0` to update!\nnpm\u001b[0m\u001b[91m \u001b[0m\u001b[91mnotice\u001b[0m\u001b[91m \n\u001b[0mRemoving intermediate container c23b1b9b23ed\n ---> 7c89f486dcec\nStep 18/27 : ADD . .\n ---> 8129e5f301e7\nStep 19/27 : RUN npm run build\n ---> Running in 06e222c53d0a\n\n> build\n> run-s build:*\n\n\n> build:css\n> npm run generate:css -- --minify\n\n\n> generate:css\n> tailwindcss -o ./app/styles/tailwind.css --minify\n\n\u001b[91m\n\u001b[0m\u001b[91mRebuilding...\n\u001b[0m\u001b[91m\n\u001b[0m\u001b[91mDone in 351ms.\n\u001b[0m\n> build:remix\n> remix build\n\nBuilding Remix app in production mode...\nBuilt in 547ms\n\n> build:server\n> esbuild --platform=node --format=cjs ./server.ts --outdir=build --bundle\n\n\u001b[91m\n  build/server.js  1.8mb ⚠️\n\n⚡ Done in 87ms\n\u001b[0mRemoving intermediate container 06e222c53d0a\n ---> f313cc56bb6a\nStep 20/27 : FROM base\n ---> 7f0fdfedfa43\nStep 21/27 : WORKDIR /myapp\n ---> Running in 886530316ff8\nRemoving intermediate container 886530316ff8\n ---> 50255052ed31\nStep 22/27 : COPY --from=production-deps /myapp/node_modules /myapp/node_modules\n ---> da4d3b8b920d\nStep 23/27 : COPY --from=build /myapp/node_modules/.prisma /myapp/node_modules/.prisma\n ---> a24cd7e538b5\nStep 24/27 : COPY --from=build /myapp/build /myapp/build\n ---> cba6e30525cd\nStep 25/27 : COPY --from=build /myapp/public /myapp/public\n ---> 393aed091f5a\nStep 26/27 : ADD . .\n ---> 39e1d93f5611\nStep 27/27 : CMD [\"npm\", \"start\"]\n ---> Running in a00ab63a297a\nRemoving intermediate container a00ab63a297a\n ---> 7628b56744b9\nSuccessfully built 7628b56744b9\nSuccessfully tagged blues-stack:latest\n","stderr":"","imageSize":263992460},"endTime":1672390784795}