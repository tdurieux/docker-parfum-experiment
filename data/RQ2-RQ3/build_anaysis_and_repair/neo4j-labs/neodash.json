{"repository":"https://github.com/neo4j-labs/neodash","dockerfilePath":"Dockerfile","startTime":1673010096494,"endTime":1673011386028,"clone":{"startTime":1673010096494,"stdout":"","stderr":"Cloning into '/tmp/dinghy-analysis/neo4j-labs/neodash'...\n","error":null,"endTime":1673010105535,"commit":"4a99551034a3f3cced67352b2e9e076ce05154c6"},"originalBuild":{"startTime":1673010105615,"endTime":1673011362055,"error":null,"stdout":"Sending build context to Docker daemon  63.98MB\r\r\nStep 1/20 : FROM node:lts-alpine AS build-stage\n ---> 6d7b7852bcd3\nStep 2/20 : RUN yarn global add typescript jest\n ---> Running in 9c8e3e5a9408\nyarn global v1.22.19\n[1/4] Resolving packages...\n[2/4] Fetching packages...\n[3/4] Linking dependencies...\n[4/4] Building fresh packages...\nsuccess Installed \"typescript@4.9.4\" with binaries:\n      - tsc\n      - tsserver\nsuccess Installed \"jest@29.3.1\" with binaries:\n      - jest\nDone in 10.37s.\nRemoving intermediate container 9c8e3e5a9408\n ---> 6a640bfdc23f\nStep 3/20 : WORKDIR /usr/local/src/neodash\n ---> Running in bd6a6d52bd66\nRemoving intermediate container bd6a6d52bd66\n ---> 7438c5f763b3\nStep 4/20 : COPY ./package.json /usr/local/src/neodash/package.json\n ---> 6f0373f5ed96\nStep 5/20 : RUN yarn install\n ---> Running in 6e4352146a2f\nyarn install v1.22.19\ninfo No lockfile found.\n[1/4] Resolving packages...\n\u001b[91mwarning @material-ui/core@4.12.4: Material UI v4 doesn't receive active development since September 2021. See the guide https://mui.com/material-ui/migration/migration-v4/ to upgrade to v5.\n\u001b[0m\u001b[91mwarning @material-ui/core > @material-ui/styles@4.11.5: Material UI v4 doesn't receive active development since September 2021. See the guide https://mui.com/material-ui/migration/migration-v4/ to upgrade to v5.\n\u001b[0m\u001b[91mwarning @material-ui/lab@4.0.0-alpha.61: Material UI v4 doesn't receive active development since September 2021. See the guide https://mui.com/material-ui/migration/migration-v4/ to upgrade to v5.\n\u001b[0m\u001b[91mwarning @material-ui/styles@4.11.5: Material UI v4 doesn't receive active development since September 2021. See the guide https://mui.com/material-ui/migration/migration-v4/ to upgrade to v5.\n\u001b[0m\u001b[91mwarning babel-runtime > core-js@2.6.12: core-js@<3.23.3 is no longer maintained and not recommended for usage due to the number of issues. Because of the V8 engine whims, feature detection in old core-js versions could cause a slowdown up to 100x even if nothing is polyfilled. Some versions have web compatibility issues. Please, upgrade your dependencies to the actual version of core-js.\n\u001b[0m\u001b[91mwarning material-ui-color-picker > @material-ui/styles@4.11.5: Material UI v4 doesn't receive active development since September 2021. See the guide https://mui.com/material-ui/migration/migration-v4/ to upgrade to v5.\n\u001b[0m\u001b[91mwarning material-ui-color-picker > recompose > fbjs > core-js@1.2.7: core-js@<3.23.3 is no longer maintained and not recommended for usage due to the number of issues. Because of the V8 engine whims, feature detection in old core-js versions could cause a slowdown up to 100x even if nothing is polyfilled. Some versions have web compatibility issues. Please, upgrade your dependencies to the actual version of core-js.\n\u001b[0m\u001b[91mwarning use-neo4j > react-testing-library@8.0.1: ðŸš¨  react-testing-library has moved to @testing-library/react. Please uninstall react-testing-library and install @testing-library/react instead, or use an older version of react-testing-library. Learn more about this change here: https://github.com/testing-library/dom-testing-library/issues/260 Thanks! :)\n\u001b[0m[2/4] Fetching packages...\n[3/4] Linking dependencies...\n\u001b[91mwarning \" > @mui/x-data-grid@5.10.0\" has unmet peer dependency \"@mui/system@^5.2.8\".\n\u001b[0m\u001b[91mwarning \"@nivo/bar > @nivo/legends@0.80.0\" has unmet peer dependency \"prop-types@>= 15.5.10 < 16.0.0\".\n\u001b[0m\u001b[91mwarning \"@nivo/bar > @nivo/colors@0.80.0\" has unmet peer dependency \"prop-types@>= 15.5.10 < 16.0.0\".\n\u001b[0m\u001b[91mwarning \"@nivo/bar > @nivo/axes@0.80.0\" has unmet peer dependency \"prop-types@>= 15.5.10 < 16.0.0\".\n\u001b[0m\u001b[91mwarning \" > @nivo/core@0.80.0\" has unmet peer dependency \"@nivo/tooltip@0.80.0\".\nwarning \" > @nivo/core@0.80.0\" has unmet peer dependency \"prop-types@>= 15.5.10 < 16.0.0\".\n\u001b[0m\u001b[91mwarning \" > @nivo/geo@0.80.0\" has unmet peer dependency \"prop-types@>= 15.5.10 < 16.0.0\".\n\u001b[0m\u001b[91mwarning \" > @nivo/line@0.80.0\" has unmet peer dependency \"prop-types@>= 15.5.10 < 16.0.0\".\n\u001b[0m\u001b[91mwarning \" > cypher-codemirror@1.1.9\" has unmet peer dependency \"prop-types@^15.5.10\".\n\u001b[0m\u001b[91mwarning \" > cypher-codemirror@1.1.9\" has incorrect peer dependency \"react@^15.6.1\".\n\u001b[0m\u001b[91mwarning \" > cypher-codemirror@1.1.9\" has incorrect peer dependency \"react-dom@^15.6.1\".\n\u001b[0m\u001b[91mwarning \" > material-ui-color-picker@3.5.1\" has incorrect peer dependency \"react@^16.12.0\".\n\u001b[0m\u001b[91mwarning \"material-ui-color-picker > recompose@0.30.0\" has incorrect peer dependency \"react@^0.14.0 || ^15.0.0 || ^16.0.0\".\n\u001b[0m\u001b[91mwarning \" > react-leaflet-enhanced-marker@1.0.21\" has unmet peer dependency \"fbjs@^3.0.0\".\n\u001b[0m\u001b[91mwarning \" > react-leaflet-enhanced-marker@1.0.21\" has incorrect peer dependency \"react@^16.8.6\".\n\u001b[0m\u001b[91mwarning \" > react-leaflet-enhanced-marker@1.0.21\" has incorrect peer dependency \"react-dom@^16.8.6\".\n\u001b[0m\u001b[91mwarning \" > react-leaflet-enhanced-marker@1.0.21\" has incorrect peer dependency \"react-leaflet@^2.4.0\".\n\u001b[0m\u001b[91mwarning \" > react-markdown@8.0.4\" has unmet peer dependency \"@types/react@>=16\".\n\u001b[0m\u001b[91mwarning \" > redux-persist@6.0.0\" has unmet peer dependency \"redux@>4.0.0\".\nwarning \" > redux-thunk@2.4.2\" has unmet peer dependency \"redux@^4\".\n\u001b[0m\u001b[91mwarning \" > @redux-devtools/extension@3.2.3\" has unmet peer dependency \"redux@^3.1.0 || ^4.0.0\".\n\u001b[0m\u001b[91mwarning \" > styled-components@5.3.6\" has unmet peer dependency \"react-is@>= 16.8.0\".\n\u001b[0m[4/4] Building fresh packages...\nsuccess Saved lockfile.\n$ husky install\nhusky - git command not found, skipping install\nDone in 122.26s.\nRemoving intermediate container 6e4352146a2f\n ---> 47736b6cf43c\nStep 6/20 : COPY ./ /usr/local/src/neodash\n ---> a0234c65b749\nStep 7/20 : RUN yarn run build-minimal\n ---> Running in ecaad200ea6b\nyarn run v1.22.19\n$ yarn webpack --mode production --env production && cp -r public/* dist/\n$ /usr/local/src/neodash/node_modules/.bin/webpack --mode production --env production\nasset bundle.js 4.31 MiB [emitted] [minimized] [big] (name: main) 1 related asset\nasset 680f69f3c2e6b90c1812a813edf67fd7.png 2.41 KiB [emitted] [immutable] [from: node_modules/leaflet/dist/images/marker-icon-2x.png] (auxiliary name: main)\nasset 2b3e1faf89f94a4835397e7a43b4f77d.png 1.43 KiB [emitted] [immutable] [from: node_modules/leaflet/dist/images/marker-icon.png] (auxiliary name: main)\nasset 8f2c4d11474275fbc1614b9098334eae.png 1.23 KiB [emitted] [immutable] [from: node_modules/leaflet/dist/images/layers-2x.png] (auxiliary name: main)\nasset 416d91365b44e4b4f4777663e6f009f3.png 696 bytes [emitted] [immutable] [from: node_modules/leaflet/dist/images/layers.png] (auxiliary name: main)\nasset a0c6cc1401c107b501efee6477816891.png 618 bytes [emitted] [immutable] [from: node_modules/leaflet/dist/images/marker-shadow.png] (auxiliary name: main)\norphan modules 10.5 MiB [orphan] 9240 modules\nruntime modules 28.9 KiB 16 modules\ncacheable modules 11.2 MiB\n  modules by path ./node_modules/ 7.09 MiB 835 modules\n  modules by path ./src/ 4.06 MiB\n    modules by path ./src/application/ 3.98 MiB 2 modules\n    modules by path ./src/dashboard/*.ts 12.9 KiB 2 modules\n    modules by path ./src/card/*.ts 8.92 KiB\n      ./src/card/CardReducer.ts 4.51 KiB [built] [code generated]\n      ./src/card/CardActions.ts 4.41 KiB [built] [code generated]\n    ./src/index.tsx + 14 modules 62.3 KiB [built] [code generated]\n    ./src/page/PageActions.ts 1.23 KiB [built] [code generated]\n    ./src/settings/SettingsActions.ts 279 bytes [built] [code generated]\n\nWARNING in asset size limit: The following asset(s) exceed the recommended size limit (244 KiB).\nThis can impact web performance.\nAssets: \n  bundle.js (4.31 MiB)\n\nWARNING in entrypoint size limit: The following entrypoint(s) combined asset size exceeds the recommended limit (244 KiB). This can impact web performance.\nEntrypoints:\n  main (4.31 MiB)\n      bundle.js\n\nWARNING in webpack performance recommendations: \nYou can limit the size of your bundles by using import() or require.ensure to lazy load some parts of your application.\nFor more info visit https://webpack.js.org/guides/code-splitting/\n\nwebpack 5.75.0 compiled with 3 warnings in 61434 ms\nDone in 63.69s.\nRemoving intermediate container ecaad200ea6b\n ---> 904a885c7e0e\nStep 8/20 : FROM nginx:alpine AS neodash\n ---> 1e415454686a\nStep 9/20 : RUN apk upgrade\n ---> Running in 5824a163d4aa\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/community/x86_64/APKINDEX.tar.gz\n(1/8) Upgrading ca-certificates-bundle (20220614-r2 -> 20220614-r3)\n(2/8) Upgrading libcrypto3 (3.0.7-r0 -> 3.0.7-r2)\n(3/8) Upgrading libssl3 (3.0.7-r0 -> 3.0.7-r2)\n(4/8) Upgrading ca-certificates (20220614-r2 -> 20220614-r3)\n(5/8) Upgrading libcurl (7.86.0-r1 -> 7.87.0-r0)\n(6/8) Upgrading curl (7.86.0-r1 -> 7.87.0-r0)\n(7/8) Upgrading libx11 (1.8.2-r0 -> 1.8.3-r0)\n(8/8) Upgrading libuuid (2.38.1-r0 -> 2.38.1-r1)\nExecuting busybox-1.35.0-r29.trigger\nExecuting ca-certificates-20220614-r3.trigger\nOK: 43 MiB in 62 packages\nRemoving intermediate container 5824a163d4aa\n ---> 69bf33719d66\nStep 10/20 : COPY --from=build-stage /usr/local/src/neodash/dist /usr/share/nginx/html\n ---> de4c99a71e18\nStep 11/20 : COPY ./conf/default.conf /etc/nginx/conf.d/\n ---> 6d08eddf0679\nStep 12/20 : COPY ./scripts/config-entrypoint.sh /docker-entrypoint.d/config-entrypoint.sh\n ---> 7bd9db2724d5\nStep 13/20 : COPY ./scripts/message-entrypoint.sh /docker-entrypoint.d/message-entrypoint.sh\n ---> 4fde69fc1ae3\nStep 14/20 : RUN chown -R nginx:nginx /var/cache/nginx &&     chown -R nginx:nginx /var/log/nginx &&     chown -R nginx:nginx /etc/nginx/conf.d &&     chown -R nginx:nginx /docker-entrypoint.d/config-entrypoint.sh &&     chmod +x /docker-entrypoint.d/config-entrypoint.sh  &&     chmod +x /docker-entrypoint.d/message-entrypoint.sh\n ---> Running in 0fc8e6408f0b\nRemoving intermediate container 0fc8e6408f0b\n ---> b49bfdc0e78d\nStep 15/20 : RUN touch /var/run/nginx.pid &&     chown -R nginx:nginx /var/run/nginx.pid\n ---> Running in 3595788a9459\nRemoving intermediate container 3595788a9459\n ---> cc9b30939488\nStep 16/20 : RUN chown -R nginx:nginx /usr/share/nginx/html/\n ---> Running in ab247e1c0a0c\nRemoving intermediate container ab247e1c0a0c\n ---> d8ce27ba3e74\nStep 17/20 : USER nginx\n ---> Running in bde31490b385\nRemoving intermediate container bde31490b385\n ---> 04b3d1825371\nStep 18/20 : EXPOSE 5005\n ---> Running in 1f53d3fc72f7\nRemoving intermediate container 1f53d3fc72f7\n ---> d597f852554b\nStep 19/20 : HEALTHCHECK cmd curl --fail http://localhost:5005 || exit 1\n ---> Running in 0b8a81f0a7b2\nRemoving intermediate container 0b8a81f0a7b2\n ---> e68e03f31965\nStep 20/20 : LABEL version=\"2.2.1\"\n ---> Running in eec1a9d0a4d1\nRemoving intermediate container eec1a9d0a4d1\n ---> b7dc99ecc8fe\nSuccessfully built b7dc99ecc8fe\nSuccessfully tagged neodash:latest\n","stderr":"","imageSize":73586920},"repair":{"startTime":1673011362122,"endTime":1673011362228,"violations":[],"repairedDockerfile":"# build stage\nFROM node:lts-alpine AS build-stage\n\nRUN yarn global add typescript jest\nWORKDIR /usr/local/src/neodash\n\n# Pull source code if you have not cloned the repository\n#RUN apk add --no-cache git\n#RUN git clone https://github.com/neo4j-labs/neodash.git /usr/local/src/neodash\n\n# Copy sources and install/build\nCOPY ./package.json /usr/local/src/neodash/package.json\n\nRUN yarn install\nCOPY ./ /usr/local/src/neodash\nRUN yarn run build-minimal\n\n# production stage\nFROM nginx:alpine AS neodash\nRUN apk upgrade\nCOPY --from=build-stage /usr/local/src/neodash/dist /usr/share/nginx/html\n\nCOPY ./conf/default.conf /etc/nginx/conf.d/\nCOPY ./scripts/config-entrypoint.sh /docker-entrypoint.d/config-entrypoint.sh\nCOPY ./scripts/message-entrypoint.sh /docker-entrypoint.d/message-entrypoint.sh\n\nRUN chown -R nginx:nginx /var/cache/nginx && \\\n    chown -R nginx:nginx /var/log/nginx && \\\n    chown -R nginx:nginx /etc/nginx/conf.d && \\\n    chown -R nginx:nginx /docker-entrypoint.d/config-entrypoint.sh && \\\n    chmod +x /docker-entrypoint.d/config-entrypoint.sh  && \\\n    chmod +x /docker-entrypoint.d/message-entrypoint.sh\nRUN touch /var/run/nginx.pid && \\\n    chown -R nginx:nginx /var/run/nginx.pid\nRUN chown -R nginx:nginx /usr/share/nginx/html/\n\n## Launch webserver as non-root user.\nUSER nginx\nEXPOSE 5005\nHEALTHCHECK cmd curl --fail http://localhost:5005 || exit 1\nLABEL version=\"2.2.1\"\n"}}