{"repository":"https://github.com/gitploy-io/gitploy","dockerfilePath":"Dockerfile","startTime":1672240118355,"clone":{"stdout":"","stderr":"Cloning into '/tmp/dinghy-analysis/gitploy-io/gitploy'...\n","error":null,"commit":"825798dcd2013827914ba1245e19d766ff91dc23"},"originalBuild":{"startTimestamp":1672240119495,"endTimestamp":1672240623137,"error":null,"stdout":"Sending build context to Docker daemon  5.305MB\r\r\nStep 1/23 : FROM golang:1.17 AS server\n ---> 742df529b073\nStep 2/23 : ARG OSS=false\n ---> Running in c9092501db8b\nRemoving intermediate container c9092501db8b\n ---> b93d8b02a001\nStep 3/23 : WORKDIR /server\n ---> Running in 5f9d4a57fe88\nRemoving intermediate container 5f9d4a57fe88\n ---> 4aa4e6fa79d1\nStep 4/23 : COPY go.mod go.sum ./\n ---> c3b4099c3430\nStep 5/23 : RUN go mod download\n ---> Running in 2789445a391e\nRemoving intermediate container 2789445a391e\n ---> 0d4307ff731c\nStep 6/23 : COPY . .\n ---> 32a326f58488\nStep 7/23 : RUN if [ \"${OSS}\" = \"false\" ]; then         echo \"Build the enterprise edition\";         go build -o gitploy-server ./cmd/server;     else         echo \"Build the community edition\";         go build -o gitploy-server -tags \"oss\" ./cmd/server;     fi\n ---> Running in a8ac0de1b2bc\nBuild the enterprise edition\nRemoving intermediate container a8ac0de1b2bc\n ---> 8d339bf7e561\nStep 8/23 : FROM node:14.17.0 AS ui\n14.17.0: Pulling from library/node\nbfde2ec33fbc: Pulling fs layer\n787f5e2f1047: Pulling fs layer\n7b6173a10eb8: Pulling fs layer\ndc05be471d51: Pulling fs layer\n55fab5cadd3c: Pulling fs layer\nbd821d20ef8c: Pulling fs layer\n9b7ece606ebf: Pulling fs layer\n85c5bb1fa3e3: Pulling fs layer\n94ab3cac57c4: Pulling fs layer\ndc05be471d51: Waiting\n55fab5cadd3c: Waiting\nbd821d20ef8c: Waiting\n9b7ece606ebf: Waiting\n85c5bb1fa3e3: Waiting\n94ab3cac57c4: Waiting\n7b6173a10eb8: Verifying Checksum\n7b6173a10eb8: Download complete\n787f5e2f1047: Verifying Checksum\n787f5e2f1047: Download complete\nbfde2ec33fbc: Verifying Checksum\nbfde2ec33fbc: Download complete\nbd821d20ef8c: Download complete\n9b7ece606ebf: Verifying Checksum\n9b7ece606ebf: Download complete\n85c5bb1fa3e3: Verifying Checksum\n85c5bb1fa3e3: Download complete\n94ab3cac57c4: Verifying Checksum\n94ab3cac57c4: Download complete\ndc05be471d51: Verifying Checksum\ndc05be471d51: Download complete\n55fab5cadd3c: Verifying Checksum\n55fab5cadd3c: Download complete\nbfde2ec33fbc: Pull complete\n787f5e2f1047: Pull complete\n7b6173a10eb8: Pull complete\ndc05be471d51: Pull complete\n55fab5cadd3c: Pull complete\nbd821d20ef8c: Pull complete\n9b7ece606ebf: Pull complete\n85c5bb1fa3e3: Pull complete\n94ab3cac57c4: Pull complete\nDigest: sha256:af9879e7473d347048c5d5919aa9775f27c33d92e4d58058ffdc08247f4bd902\nStatus: Downloaded newer image for node:14.17.0\n ---> 9153ee3e2ced\nStep 9/23 : ARG OSS=false\n ---> Running in bf24eae11446\nRemoving intermediate container bf24eae11446\n ---> d769339412c3\nStep 10/23 : WORKDIR /ui\n ---> Running in 00f188ae43db\nRemoving intermediate container 00f188ae43db\n ---> 1b28058509a9\nStep 11/23 : ENV PATH /ui/node_modules/.bin:$PATH\n ---> Running in cfca7f735f3a\nRemoving intermediate container cfca7f735f3a\n ---> 43aeb3c72fb4\nStep 12/23 : COPY ./ui/package.json ./ui/package-lock.json ./\n ---> a46b1df1481b\nStep 13/23 : RUN npm install --silent\n ---> Running in 963cba3a0b8f\nadded 1787 packages from 800 contributors and audited 1792 packages in 26.322s\n\n215 packages are looking for funding\n  run `npm fund` for details\n\nfound 33 vulnerabilities (1 low, 2 moderate, 28 high, 2 critical)\n  run `npm audit fix` to fix them, or `npm audit` for details\nRemoving intermediate container 963cba3a0b8f\n ---> d1a8b5e16b0a\nStep 14/23 : COPY ./ui ./\n ---> 104b1a6f8d18\nStep 15/23 : ENV REACT_APP_GITPLOY_OSS=\"${OSS}\"\n ---> Running in 12a88a159f7c\nRemoving intermediate container 12a88a159f7c\n ---> 695dba7a5c03\nStep 16/23 : RUN npm run build\n ---> Running in 79236505660e\n\n> ui@0.1.0 build /ui\n> craco build\n\nCreating an optimized production build...\n\u001b[91mBrowserslist: caniuse-lite is outdated. Please run:\n  npx update-browserslist-db@latest\n  Why you should do it regularly: https://github.com/browserslist/update-db#readme\n\u001b[0m\u001b[91mBrowserslist: caniuse-lite is outdated. Please run:\n  npx update-browserslist-db@latest\n  Why you should do it regularly: https://github.com/browserslist/update-db#readme\n\u001b[0mCompiled successfully.\n\nFile sizes after gzip:\n\n  308.75 kB  build/static/js/main.d5ccd7e4.js\n  65.43 kB   build/static/css/main.d1c1309d.css\n  1.67 kB    build/static/js/787.90924a69.chunk.js\n\nThe project was built assuming it is hosted at /.\nYou can control this with the homepage field in your package.json.\n\nThe build folder is ready to be deployed.\nYou may serve it with a static server:\n\n  npm install -g serve\n  serve -s build\n\nFind out more about deployment here:\n\n  https://cra.link/deployment\n\nRemoving intermediate container 79236505660e\n ---> 8d71f21c5b61\nStep 17/23 : FROM golang:1.17-buster AS gitploy\n1.17-buster: Pulling from library/golang\n80b89a2b88b2: Pulling fs layer\n5b0405f798f5: Pulling fs layer\nab80b2b0494a: Pulling fs layer\nbb827974c1cb: Pulling fs layer\n107910070fdd: Pulling fs layer\n4a2b7c896891: Pulling fs layer\nbaca0e06c4e4: Pulling fs layer\nbaca0e06c4e4: Waiting\n4a2b7c896891: Waiting\nbb827974c1cb: Waiting\n107910070fdd: Waiting\nab80b2b0494a: Verifying Checksum\nab80b2b0494a: Download complete\n5b0405f798f5: Verifying Checksum\n5b0405f798f5: Download complete\n80b89a2b88b2: Verifying Checksum\n80b89a2b88b2: Download complete\nbb827974c1cb: Verifying Checksum\nbb827974c1cb: Download complete\nbaca0e06c4e4: Download complete\n107910070fdd: Verifying Checksum\n107910070fdd: Download complete\n4a2b7c896891: Verifying Checksum\n4a2b7c896891: Download complete\n80b89a2b88b2: Pull complete\n5b0405f798f5: Pull complete\nab80b2b0494a: Pull complete\nbb827974c1cb: Pull complete\n107910070fdd: Pull complete\n4a2b7c896891: Pull complete\nbaca0e06c4e4: Pull complete\nDigest: sha256:cf57fd6a33fee81c4a7450b2017bf862990e796316b30c22f03fd1f6b53ddcec\nStatus: Downloaded newer image for golang:1.17-buster\n ---> 36c834315aca\nStep 18/23 : WORKDIR /app\n ---> Running in 406b353e4b3e\nRemoving intermediate container 406b353e4b3e\n ---> 0fa7b277615b\nStep 19/23 : RUN mkdir /data\n ---> Running in 5672d5a0418a\nRemoving intermediate container 5672d5a0418a\n ---> fd5ff4fbc941\nStep 20/23 : COPY --from=server --chown=root:root /server/LICENSE /server/NOTICE ./\n ---> d1b23e46f6e4\nStep 21/23 : COPY --from=server --chown=root:root /server/gitploy-server /go/bin/gitploy-server\n ---> c9d69e595ecd\nStep 22/23 : COPY --from=ui --chown=root:root /ui/build/ /app/\n ---> 4671b5da15f1\nStep 23/23 : ENTRYPOINT [ \"/go/bin/gitploy-server\" ]\n ---> Running in ea54c33c1529\nRemoving intermediate container ea54c33c1529\n ---> f05568ce565c\nSuccessfully built f05568ce565c\nSuccessfully tagged gitploy:latest\n","stderr":"","imageSize":930796907},"repair":{"violations":[{"name":"npmCacheCleanAfterInstall","position":{"start":27,"end":27,"columnStart":4,"columnEnd":24}}],"repairedDockerfile":"# Build the server binary file.\nFROM golang:1.17 AS server\nARG OSS=false\n\nWORKDIR /server\n\nCOPY go.mod go.sum ./\nRUN go mod download\n\nCOPY . .\nRUN if [ \"${OSS}\" = \"false\" ]; then \\\n        echo \"Build the enterprise edition\"; \\\n        go build -o gitploy-server ./cmd/server; \\\n    else \\\n        echo \"Build the community edition\"; \\\n        go build -o gitploy-server -tags \"oss\" ./cmd/server; \\\n    fi\n\n# Build UI.\nFROM node:14.17.0 AS ui\nARG OSS=false\n\nWORKDIR /ui\n\nENV PATH /ui/node_modules/.bin:$PATH\n\nCOPY ./ui/package.json ./ui/package-lock.json ./\nRUN npm install --silent\n\nCOPY ./ui ./\nENV REACT_APP_GITPLOY_OSS=\"${OSS}\"\nRUN npm run build\n\n# Copy to the final image.\nFROM golang:1.17-buster AS gitploy\n\nWORKDIR /app\n\n# Create DB\nRUN mkdir /data\n\nCOPY --from=server --chown=root:root /server/LICENSE /server/NOTICE ./\nCOPY --from=server --chown=root:root /server/gitploy-server /go/bin/gitploy-server\n\n# Copy UI output into the assets directory.\nCOPY --from=ui --chown=root:root /ui/build/ /app/\n\nENTRYPOINT [ \"/go/bin/gitploy-server\" ]"},"repairedBuild":{"startTimestamp":1672240623822,"endTimestamp":1672241003924,"error":null,"stdout":"Sending build context to Docker daemon  5.305MB\r\r\nStep 1/23 : FROM golang:1.17 AS server\n ---> 742df529b073\nStep 2/23 : ARG OSS=false\n ---> Running in 689b4cbf70db\nRemoving intermediate container 689b4cbf70db\n ---> eeb854337ef5\nStep 3/23 : WORKDIR /server\n ---> Running in e9b0f104e4ce\nRemoving intermediate container e9b0f104e4ce\n ---> a727ae45a39a\nStep 4/23 : COPY go.mod go.sum ./\n ---> 26ea2cafe7a1\nStep 5/23 : RUN go mod download\n ---> Running in fe0bcf59aa65\nRemoving intermediate container fe0bcf59aa65\n ---> 9daa2da1cec9\nStep 6/23 : COPY . .\n ---> d2de9d746e8b\nStep 7/23 : RUN if [ \"${OSS}\" = \"false\" ]; then         echo \"Build the enterprise edition\";         go build -o gitploy-server ./cmd/server;     else         echo \"Build the community edition\";         go build -o gitploy-server -tags \"oss\" ./cmd/server;     fi\n ---> Running in 55b7be44de62\nBuild the enterprise edition\nRemoving intermediate container 55b7be44de62\n ---> a65686f4e8a1\nStep 8/23 : FROM node:14.17.0 AS ui\n ---> 9153ee3e2ced\nStep 9/23 : ARG OSS=false\n ---> Running in 39570e05286e\nRemoving intermediate container 39570e05286e\n ---> 772a6304c164\nStep 10/23 : WORKDIR /ui\n ---> Running in 78e0360ac997\nRemoving intermediate container 78e0360ac997\n ---> e6f8667fe95a\nStep 11/23 : ENV PATH /ui/node_modules/.bin:$PATH\n ---> Running in 048facc5ae6f\nRemoving intermediate container 048facc5ae6f\n ---> aa805de6e793\nStep 12/23 : COPY ./ui/package.json ./ui/package-lock.json ./\n ---> dd895f6a2c75\nStep 13/23 : RUN npm install --silent\n ---> Running in 0b62b49379c1\nadded 1787 packages from 800 contributors and audited 1792 packages in 34.426s\n\n215 packages are looking for funding\n  run `npm fund` for details\n\nfound 33 vulnerabilities (1 low, 2 moderate, 28 high, 2 critical)\n  run `npm audit fix` to fix them, or `npm audit` for details\nRemoving intermediate container 0b62b49379c1\n ---> 3a5c31c2ddd8\nStep 14/23 : COPY ./ui ./\n ---> 6e953f26fab8\nStep 15/23 : ENV REACT_APP_GITPLOY_OSS=\"${OSS}\"\n ---> Running in 76fdc34e86cb\nRemoving intermediate container 76fdc34e86cb\n ---> 0d7b73954618\nStep 16/23 : RUN npm run build\n ---> Running in cdb5b9a73141\n\n> ui@0.1.0 build /ui\n> craco build\n\nCreating an optimized production build...\n\u001b[91mBrowserslist: caniuse-lite is outdated. Please run:\n  npx update-browserslist-db@latest\n  Why you should do it regularly: https://github.com/browserslist/update-db#readme\n\u001b[0m\u001b[91mBrowserslist: caniuse-lite is outdated. Please run:\n  npx update-browserslist-db@latest\n  Why you should do it regularly: https://github.com/browserslist/update-db#readme\n\u001b[0mCompiled successfully.\n\nFile sizes after gzip:\n\n  308.75 kB  build/static/js/main.d5ccd7e4.js\n  65.43 kB   build/static/css/main.d1c1309d.css\n  1.67 kB    build/static/js/787.90924a69.chunk.js\n\nThe project was built assuming it is hosted at /.\nYou can control this with the homepage field in your package.json.\n\nThe build folder is ready to be deployed.\nYou may serve it with a static server:\n\n  npm install -g serve\n  serve -s build\n\nFind out more about deployment here:\n\n  https://cra.link/deployment\n\nRemoving intermediate container cdb5b9a73141\n ---> 10e9aaebf253\nStep 17/23 : FROM golang:1.17-buster AS gitploy\n ---> 36c834315aca\nStep 18/23 : WORKDIR /app\n ---> Running in 617dd02e4844\nRemoving intermediate container 617dd02e4844\n ---> e3c0cbec7ae3\nStep 19/23 : RUN mkdir /data\n ---> Running in c2ce6ad69d11\nRemoving intermediate container c2ce6ad69d11\n ---> cca2dbe29373\nStep 20/23 : COPY --from=server --chown=root:root /server/LICENSE /server/NOTICE ./\n ---> 94906c537642\nStep 21/23 : COPY --from=server --chown=root:root /server/gitploy-server /go/bin/gitploy-server\n ---> e210cc548239\nStep 22/23 : COPY --from=ui --chown=root:root /ui/build/ /app/\n ---> 99ecf9565c98\nStep 23/23 : ENTRYPOINT [ \"/go/bin/gitploy-server\" ]\n ---> Running in 820f216ef0d8\nRemoving intermediate container 820f216ef0d8\n ---> 294928bf0dfc\nSuccessfully built 294928bf0dfc\nSuccessfully tagged gitploy:latest\n","stderr":"","imageSize":930796907},"endTime":1672241010259}