{"repository":"https://github.com/plotly/falcon","dockerfilePath":"Dockerfile","startTime":1672008237880,"clone":{"stdout":"","stderr":"Cloning into '/tmp/dinghy-analysis/plotly/falcon'...\n","error":null,"commit":"843628318423364073d8488b0fbc9cec0b1ecc92"},"originalBuild":{"startTimestamp":1672008239448,"endTimestamp":1672008425243,"error":null,"stdout":"Sending build context to Docker daemon  12.34MB\r\r\nStep 1/14 : FROM node:8\n ---> 8eeadf3757f4\nStep 2/14 : ENV HOME=/home/\n ---> Running in 900dcb80f2a0\nRemoving intermediate container 900dcb80f2a0\n ---> b1a3bd1cc0cd\nStep 3/14 : RUN mkdir -p /usr/src/app\n ---> Running in c7c271673be3\nRemoving intermediate container c7c271673be3\n ---> 584d7472ac73\nStep 4/14 : WORKDIR /usr/src/app\n ---> Running in 2a28ebd6fc6d\nRemoving intermediate container 2a28ebd6fc6d\n ---> db11a5b06613\nStep 5/14 : ENV PLOTLY_CONNECTOR_DATA_FOLDER=\"/plotly-connector\"\n ---> Running in 39e1de26202b\nRemoving intermediate container 39e1de26202b\n ---> 12a6c6d54b15\nStep 6/14 : ENV PLOTLY_CONNECTOR_LOG_TO_STDOUT=\"true\"\n ---> Running in 34566d947849\nRemoving intermediate container 34566d947849\n ---> 8b6fa09ae999\nStep 7/14 : COPY package.json /usr/src/app\n ---> f4558f0e9fc0\nStep 8/14 : COPY yarn.lock /usr/src/app\n ---> ab758a56d65c\nStep 9/14 : RUN yarn install\n ---> Running in b70320fa5867\nyarn install v1.21.1\n[1/5] Validating package.json...\n[2/5] Resolving packages...\n[3/5] Fetching packages...\n\u001b[91mwarning sha.js@2.4.11: Invalid bin entry for \"sha.js\" (in \"sha.js\").\n\u001b[0minfo fsevents@1.2.4: The platform \"linux\" is incompatible with this module.\ninfo \"fsevents@1.2.4\" is an optional dependency and failed compatibility check. Excluding it from installation.\ninfo fsevents@2.0.1: The platform \"linux\" is incompatible with this module.\ninfo \"fsevents@2.0.1\" is an optional dependency and failed compatibility check. Excluding it from installation.\n[4/5] Linking dependencies...\n\u001b[91mwarning \"react-chart-editor > react-rangeslider@2.2.0\" has incorrect peer dependency \"react@^0.14.0 || ^15.0.0\".\n\u001b[0m[5/5] Building fresh packages...\nsuccess Saved lockfile.\nDone in 61.50s.\nRemoving intermediate container b70320fa5867\n ---> fcf0bd8ca9c3\nStep 10/14 : COPY . /usr/src/app\n ---> 351696a0c947\nStep 11/14 : RUN yarn run heroku-postbuild\n ---> Running in 6cd5c258b92c\nyarn run v1.21.1\n$ yarn run build-headless && yarn run build-web\n$ cross-env NODE_ENV=production node -r babel-register ./node_modules/webpack/bin/webpack --config webpack.config.headless.js --profile --colors\nHash: \u001b[1m4e3672ad48190281aa8a\u001b[39m\u001b[22m\nVersion: webpack \u001b[1m3.12.0\u001b[39m\u001b[22m\nTime: \u001b[1m36907\u001b[39m\u001b[22mms\n                        \u001b[1mAsset\u001b[39m\u001b[22m       \u001b[1mSize\u001b[39m\u001b[22m  \u001b[1mChunks\u001b[39m\u001b[22m  \u001b[1m\u001b[39m\u001b[22m           \u001b[1m\u001b[39m\u001b[22m       \u001b[1mChunk Names\u001b[39m\u001b[22m\n    \u001b[1m\u001b[33m./dist/headless-bundle.js\u001b[39m\u001b[22m    \u001b[1m\u001b[33m6.89 MB\u001b[39m\u001b[22m       \u001b[1m0\u001b[39m\u001b[22m  \u001b[1m\u001b[32m[emitted]\u001b[39m\u001b[22m  \u001b[1m\u001b[33m[big]\u001b[39m\u001b[22m  main\n\u001b[1m\u001b[32m./dist/headless-bundle.js.map\u001b[39m\u001b[22m  102 bytes       \u001b[1m0\u001b[39m\u001b[22m  \u001b[1m\u001b[32m[emitted]\u001b[39m\u001b[22m         main\n  [21] \u001b[1m./backend/settings.js\u001b[39m\u001b[22m 7.43 kB {\u001b[1m\u001b[33m0\u001b[39m\u001b[22m}\u001b[1m\u001b[32m [built]\u001b[39m\u001b[22m\n       [] -> factory:2ms building:64ms = 66ms\n  [25] \u001b[1m./backend/logger.js\u001b[39m\u001b[22m 1.95 kB {\u001b[1m\u001b[33m0\u001b[39m\u001b[22m}\u001b[1m\u001b[32m [built]\u001b[39m\u001b[22m\n       [] -> factory:2ms building:407ms dependencies:5ms = 414ms\n  [60] \u001b[1m./backend/utils/homeFiles.js\u001b[39m\u001b[22m 453 bytes {\u001b[1m\u001b[33m0\u001b[39m\u001b[22m}\u001b[1m\u001b[32m [built]\u001b[39m\u001b[22m\n       [] -> factory:348ms building:372ms dependencies:1ms = 721ms\n [117] \u001b[1m./backend/persistent/plotly-api.js\u001b[39m\u001b[22m 12.6 kB {\u001b[1m\u001b[33m0\u001b[39m\u001b[22m}\u001b[1m\u001b[32m [built]\u001b[39m\u001b[22m\n       [] -> factory:51ms building:149ms dependencies:341ms = 541ms\n [118] \u001b[1m./backend/persistent/datastores/Datastores.js\u001b[39m\u001b[22m 7.02 kB {\u001b[1m\u001b[33m0\u001b[39m\u001b[22m}\u001b[1m\u001b[32m [built]\u001b[39m\u001b[22m\n       [] -> factory:52ms building:362ms dependencies:14ms = 428ms\n [153] \u001b[1m./backend/persistent/Connections.js\u001b[39m\u001b[22m 5.92 kB {\u001b[1m\u001b[33m0\u001b[39m\u001b[22m}\u001b[1m\u001b[32m [built]\u001b[39m\u001b[22m\n       [] -> factory:51ms building:308ms dependencies:183ms = 542ms\n [154] \u001b[1m./backend/utils/persistenceUtils.js\u001b[39m\u001b[22m 373 bytes {\u001b[1m\u001b[33m0\u001b[39m\u001b[22m}\u001b[1m\u001b[32m [built]\u001b[39m\u001b[22m\n       [] -> factory:51ms building:63ms dependencies:428ms = 542ms\n [162] \u001b[1m./backend/routes.js\u001b[39m\u001b[22m 42.3 kB {\u001b[1m\u001b[33m0\u001b[39m\u001b[22m}\u001b[1m\u001b[32m [built]\u001b[39m\u001b[22m\n       [] -> factory:2ms building:359ms dependencies:542ms = 903ms\n [167] \u001b[1m./backend/utils/authUtils.js\u001b[39m\u001b[22m 920 bytes {\u001b[1m\u001b[33m0\u001b[39m\u001b[22m}\u001b[1m\u001b[32m [built]\u001b[39m\u001b[22m\n       [] -> factory:50ms building:69ms dependencies:1ms = 120ms\n [170] \u001b[1m./backend/constants.js\u001b[39m\u001b[22m 837 bytes {\u001b[1m\u001b[33m0\u001b[39m\u001b[22m}\u001b[1m\u001b[32m [built]\u001b[39m\u001b[22m\n       [] -> factory:50ms building:8ms dependencies:1ms = 59ms\n [302] \u001b[1m./backend/persistent/Queries.js\u001b[39m\u001b[22m 2.39 kB {\u001b[1m\u001b[33m0\u001b[39m\u001b[22m}\u001b[1m\u001b[32m [built]\u001b[39m\u001b[22m\n       [] -> factory:51ms building:340ms dependencies:151ms = 542ms\n [432] \u001b[1m./backend/headless.development.js\u001b[39m\u001b[22m 1.4 kB {\u001b[1m\u001b[33m0\u001b[39m\u001b[22m}\u001b[1m\u001b[32m [built]\u001b[39m\u001b[22m\n        factory:18ms building:30ms = 48ms\n [476] \u001b[1m./backend/certificates.js\u001b[39m\u001b[22m 8.23 kB {\u001b[1m\u001b[33m0\u001b[39m\u001b[22m}\u001b[1m\u001b[32m [built]\u001b[39m\u001b[22m\n       [] -> factory:50ms building:48ms dependencies:443ms = 541ms\n[1410] \u001b[1m./backend/init.js\u001b[39m\u001b[22m 986 bytes {\u001b[1m\u001b[33m0\u001b[39m\u001b[22m}\u001b[1m\u001b[32m [built]\u001b[39m\u001b[22m\n       [] -> factory:50ms building:59ms dependencies:1ms = 110ms\n[1422] \u001b[1m./backend/persistent/QueryScheduler.js\u001b[39m\u001b[22m 24.8 kB {\u001b[1m\u001b[33m0\u001b[39m\u001b[22m}\u001b[1m\u001b[32m [built]\u001b[39m\u001b[22m\n       [] -> factory:52ms building:260ms dependencies:230ms = 542ms\n    + 1424 hidden modules\n\n\u001b[1m\u001b[33mWARNING in ./node_modules/encoding/lib/iconv-loader.js\n9:12-34 Critical dependency: the request of a dependency is an expression\n @ ./node_modules/encoding/lib/iconv-loader.js\n @ ./node_modules/encoding/lib/encoding.js\n @ ./node_modules/node-fetch/lib/body.js\n @ ./node_modules/node-fetch/index.js\n @ ./backend/routes.js\n @ ./backend/headless.development.js\u001b[39m\u001b[22m\n\n\u001b[1m\u001b[33mWARNING in ./node_modules/ws/lib/BufferUtil.js\nModule not found: Error: Can't resolve '../build/Release/bufferutil' in '/usr/src/app/node_modules/ws/lib'\n @ ./node_modules/ws/lib/BufferUtil.js 8:19-57\n @ ./node_modules/ws/lib/Sender.js\n @ ./node_modules/ws/index.js\n @ ./node_modules/thrift/lib/nodejs/lib/thrift/ws_connection.js\n @ ./node_modules/thrift/lib/nodejs/lib/thrift/index.js\n @ ./node_modules/node-impala/lib/node-impala.js\n @ ./node_modules/node-impala/index.js\n @ ./backend/persistent/datastores/impala.js\n @ ./backend/persistent/datastores/Datastores.js\n @ ./backend/routes.js\n @ ./backend/headless.development.js\u001b[39m\u001b[22m\n\n\u001b[1m\u001b[33mWARNING in ./node_modules/ws/lib/Validation.js\nModule not found: Error: Can't resolve '../build/Release/validation' in '/usr/src/app/node_modules/ws/lib'\n @ ./node_modules/ws/lib/Validation.js 8:19-57\n @ ./node_modules/ws/lib/Receiver.js\n @ ./node_modules/ws/index.js\n @ ./node_modules/thrift/lib/nodejs/lib/thrift/ws_connection.js\n @ ./node_modules/thrift/lib/nodejs/lib/thrift/index.js\n @ ./node_modules/node-impala/lib/node-impala.js\n @ ./node_modules/node-impala/index.js\n @ ./backend/persistent/datastores/impala.js\n @ ./backend/persistent/datastores/Datastores.js\n @ ./backend/routes.js\n @ ./backend/headless.development.js\u001b[39m\u001b[22m\n\n\u001b[1m\u001b[33mWARNING in ./node_modules/ws/lib/BufferUtil.js\nModule not found: Error: Can't resolve '../build/default/bufferutil' in '/usr/src/app/node_modules/ws/lib'\n @ ./node_modules/ws/lib/BufferUtil.js 10:19-57\n @ ./node_modules/ws/lib/Sender.js\n @ ./node_modules/ws/index.js\n @ ./node_modules/thrift/lib/nodejs/lib/thrift/ws_connection.js\n @ ./node_modules/thrift/lib/nodejs/lib/thrift/index.js\n @ ./node_modules/node-impala/lib/node-impala.js\n @ ./node_modules/node-impala/index.js\n @ ./backend/persistent/datastores/impala.js\n @ ./backend/persistent/datastores/Datastores.js\n @ ./backend/routes.js\n @ ./backend/headless.development.js\u001b[39m\u001b[22m\n\n\u001b[1m\u001b[33mWARNING in ./node_modules/ws/lib/Validation.js\nModule not found: Error: Can't resolve '../build/default/validation' in '/usr/src/app/node_modules/ws/lib'\n @ ./node_modules/ws/lib/Validation.js 10:19-57\n @ ./node_modules/ws/lib/Receiver.js\n @ ./node_modules/ws/index.js\n @ ./node_modules/thrift/lib/nodejs/lib/thrift/ws_connection.js\n @ ./node_modules/thrift/lib/nodejs/lib/thrift/index.js\n @ ./node_modules/node-impala/lib/node-impala.js\n @ ./node_modules/node-impala/index.js\n @ ./backend/persistent/datastores/impala.js\n @ ./backend/persistent/datastores/Datastores.js\n @ ./backend/routes.js\n @ ./backend/headless.development.js\u001b[39m\u001b[22m\n$ cross-env NODE_ENV=production node -r babel-register ./node_modules/webpack/bin/webpack --config webpack.config.web.js --profile --colors\nHash: \u001b[1m6dbaed001cf71028638e\u001b[39m\u001b[22m\nVersion: webpack \u001b[1m3.12.0\u001b[39m\u001b[22m\nTime: \u001b[1m14816\u001b[39m\u001b[22mms\n                \u001b[1mAsset\u001b[39m\u001b[22m     \u001b[1mSize\u001b[39m\u001b[22m  \u001b[1mChunks\u001b[39m\u001b[22m  \u001b[1m\u001b[39m\u001b[22m           \u001b[1m\u001b[39m\u001b[22m       \u001b[1mChunk Names\u001b[39m\u001b[22m\n    \u001b[1m\u001b[33mweb-bundle.min.js\u001b[39m\u001b[22m  \u001b[1m\u001b[33m15.2 MB\u001b[39m\u001b[22m       \u001b[1m0\u001b[39m\u001b[22m  \u001b[1m\u001b[32m[emitted]\u001b[39m\u001b[22m  \u001b[1m\u001b[33m[big]\u001b[39m\u001b[22m  web\n\u001b[1m\u001b[32mweb-bundle.min.js.map\u001b[39m\u001b[22m  18.5 MB       \u001b[1m0\u001b[39m\u001b[22m  \u001b[1m\u001b[32m[emitted]\u001b[39m\u001b[22m         web\n  [17] \u001b[1m(webpack)/buildin/global.js\u001b[39m\u001b[22m 509 bytes {\u001b[1m\u001b[33m0\u001b[39m\u001b[22m}\u001b[1m\u001b[32m [built]\u001b[39m\u001b[22m\n       [] -> factory:439ms building:\u001b[1m\u001b[32m2815ms\u001b[39m\u001b[22m = \u001b[1m\u001b[32m3254ms\u001b[39m\u001b[22m\n  [21] \u001b[1m./app/constants/constants.js\u001b[39m\u001b[22m 20.9 kB {\u001b[1m\u001b[33m0\u001b[39m\u001b[22m}\u001b[1m\u001b[32m [built]\u001b[39m\u001b[22m\n       [] -> factory:25ms building:73ms dependencies:259ms = 357ms\n  [22] \u001b[1m./app/utils/utils.js\u001b[39m\u001b[22m 3.44 kB {\u001b[1m\u001b[33m0\u001b[39m\u001b[22m}\u001b[1m\u001b[32m [built]\u001b[39m\u001b[22m\n       [] -> factory:15ms building:213ms = 228ms\n  [88] \u001b[1m./app/actions/sessions.js\u001b[39m\u001b[22m 15.8 kB {\u001b[1m\u001b[33m0\u001b[39m\u001b[22m}\u001b[1m\u001b[32m [built]\u001b[39m\u001b[22m\n       [] -> factory:96ms building:97ms dependencies:209ms = 402ms\n  [92] \u001b[1m(webpack)/buildin/module.js\u001b[39m\u001b[22m 517 bytes {\u001b[1m\u001b[33m0\u001b[39m\u001b[22m}\u001b[1m\u001b[32m [built]\u001b[39m\u001b[22m\n       [] -> factory:38ms building:65ms = 103ms\n [181] \u001b[1m./app/utils/queryUtils.js\u001b[39m\u001b[22m 969 bytes {\u001b[1m\u001b[33m0\u001b[39m\u001b[22m}\u001b[1m\u001b[32m [built]\u001b[39m\u001b[22m\n       [] -> factory:743ms building:\u001b[1m1498ms\u001b[39m\u001b[22m = \u001b[1m\u001b[32m2241ms\u001b[39m\u001b[22m\n [182] \u001b[1m./shared/constants.js\u001b[39m\u001b[22m 175 bytes {\u001b[1m\u001b[33m0\u001b[39m\u001b[22m}\u001b[1m\u001b[32m [built]\u001b[39m\u001b[22m\n       [] -> factory:653ms building:\u001b[1m1207ms\u001b[39m\u001b[22m = \u001b[1m\u001b[32m1860ms\u001b[39m\u001b[22m\n [189] \u001b[1m(webpack)/buildin/harmony-module.js\u001b[39m\u001b[22m 596 bytes {\u001b[1m\u001b[33m0\u001b[39m\u001b[22m}\u001b[1m\u001b[32m [built]\u001b[39m\u001b[22m\n       [] -> factory:45ms building:53ms = 98ms\n [206] \u001b[1m./package.json\u001b[39m\u001b[22m 12.3 kB {\u001b[1m\u001b[33m0\u001b[39m\u001b[22m}\u001b[1m\u001b[32m [built]\u001b[39m\u001b[22m\n       [] -> factory:5ms building:6ms = 11ms\n [458] \u001b[1m./app/index.js\u001b[39m\u001b[22m 1.85 kB {\u001b[1m\u001b[33m0\u001b[39m\u001b[22m}\u001b[1m\u001b[32m [built]\u001b[39m\u001b[22m\n        factory:28ms building:58ms = 86ms\n [517] \u001b[1m./app/store/configureStore.js\u001b[39m\u001b[22m 193 bytes {\u001b[1m\u001b[33m0\u001b[39m\u001b[22m}\u001b[1m\u001b[32m [built]\u001b[39m\u001b[22m\n       [] -> factory:14ms building:6ms = 20ms\n [518] \u001b[1m./app/store/configureStore.production.js\u001b[39m\u001b[22m 716 bytes {\u001b[1m\u001b[33m0\u001b[39m\u001b[22m}\u001b[1m\u001b[32m [built]\u001b[39m\u001b[22m\n       [] -> factory:275ms building:279ms dependencies:27ms = 581ms\n [520] \u001b[1m./app/reducers/index.js\u001b[39m\u001b[22m 12.2 kB {\u001b[1m\u001b[33m0\u001b[39m\u001b[22m}\u001b[1m\u001b[32m [built]\u001b[39m\u001b[22m\n       [] -> factory:\u001b[1m1139ms\u001b[39m\u001b[22m building:\u001b[1m1526ms\u001b[39m\u001b[22m dependencies:64ms = \u001b[1m\u001b[32m2729ms\u001b[39m\u001b[22m\n [623] \u001b[1m./app/utils/codemirror/clickhouse.js\u001b[39m\u001b[22m 9.63 kB {\u001b[1m\u001b[33m0\u001b[39m\u001b[22m}\u001b[1m\u001b[32m [built]\u001b[39m\u001b[22m\n       [] -> factory:356ms building:139ms = 495ms\n[1471] \u001b[1m./node_modules/moment/locale ^\\.\\/.*$\u001b[39m\u001b[22m 2.98 kB {\u001b[1m\u001b[33m0\u001b[39m\u001b[22m}\u001b[1m\u001b[33m [optional]\u001b[39m\u001b[22m\u001b[1m\u001b[32m [built]\u001b[39m\u001b[22m\n       [] -> factory:29ms building:50ms dependencies:\u001b[1m\u001b[32m2311ms\u001b[39m\u001b[22m = \u001b[1m\u001b[32m2390ms\u001b[39m\u001b[22m\n    + 1470 hidden modules\nDone in 53.99s.\nRemoving intermediate container 6cd5c258b92c\n ---> 91a5395ca522\nStep 12/14 : ENV PLOTLY_CONNECTOR_PORT 9494\n ---> Running in f9320aea309c\nRemoving intermediate container f9320aea309c\n ---> d8c2c3862504\nStep 13/14 : EXPOSE 9494\n ---> Running in 60130397eb5a\nRemoving intermediate container 60130397eb5a\n ---> d55de5421b47\nStep 14/14 : ENTRYPOINT yarn run start-headless\n ---> Running in b4cb2cb0ef7e\nRemoving intermediate container b4cb2cb0ef7e\n ---> 3f0a4e1fe7ee\nSuccessfully built 3f0a4e1fe7ee\nSuccessfully tagged falcon:latest\n","stderr":"","imageSize":2366230174},"repair":{"violations":[],"repairedDockerfile":"# Usage:\n# $ docker build -t chriddyp/database-connector .\n# $ PLOTLY_DOMAIN_API=\"api-local.plot.ly\" PLOTLY_STREAMBED_SSL_ENABLED=\"true\" docker run -p 9494:9494 -v ~/.plotly/connector:/home -e PLOTLY_CONNECTOR_PLOTLY_API_DOMAIN=$PLOTLY_DOMAIN_API -e PLOTLY_CONNECTOR_PLOTLY_API_SSL_ENABLED=$PLOTLY_STREAMBED_SSL_ENABLED -e PLOTLY_CONNECTOR_IS_RUNNING_INSIDE_ON_PREM=\"true\" PLOTLY_CONNECTOR_STORAGE_PATH=\"/home\" -d chriddyp/database-connector\n#\n# Depends on the following ENV variables:\n# - PLOTLY_DOMAIN_API (e.g. api-local.plot.ly)\n# - PLOTLY_STREAMBED_SSL_ENABLED (e.g. true)\n#\n# Note that the command line argument PLOTLY_CONNECTOR_IS_RUNNING_INSIDE_ON_PREM=\"true\"\n# should only be set if the connector is running on an on prem server.\n# If it is running on a local machine but it is targeting a remote on prem server,\n# then it should not be set.\n#\n# Adapted from https://nodejs.org/en/docs/guides/nodejs-docker-webapp/\n\nFROM node:8\n\n# I'd like to install the latest version of npm with something like this:\n# RUN npm install --global npm@4.0.3\n# But unforunately that fails with\n# It doesn't seem like there is a good solution in the community yet\n# See: https://github.com/npm/npm/issues/9863\n\n# The App saves folders to the `os.homedir()` directory.\nENV HOME=/home/\n\n# Create app directory\nRUN mkdir -p /usr/src/app\nWORKDIR /usr/src/app\n\n# Create a directory that the app can save files to and that the host can access\n# To map to the files that are saved on your host, run with:\n# $ docker run -v ~/.plotly/connector:/plotly-connector\n# TODO - With that command ^^, it's redudant to call `VOLUME /plotly-connector` right?\n# Save that directory as an ENV variable for the app to use when saving files\n# By default, the app will save these files in the home directory\nENV PLOTLY_CONNECTOR_DATA_FOLDER=\"/plotly-connector\"\n\n# Log to stdout in addition to the file\nENV PLOTLY_CONNECTOR_LOG_TO_STDOUT=\"true\"\n\n# Install app dependencies\nCOPY package.json /usr/src/app\nCOPY yarn.lock /usr/src/app\nRUN yarn install\n\nCOPY . /usr/src/app\nRUN yarn run heroku-postbuild\n\nENV PLOTLY_CONNECTOR_PORT 9494\nEXPOSE 9494\nENTRYPOINT yarn run start-headless\n"},"endTime":1672008429159}