{"repository":"https://github.com/star7th/showdoc","dockerfilePath":"Dockerfile","startTime":1672122932797,"clone":{"stdout":"","stderr":"Cloning into '/tmp/dinghy-analysis/star7th/showdoc'...\n","error":null,"commit":"14fed0d63e48492a4ae8791ed55ba7e68450a4cc"},"originalBuild":{"startTimestamp":1672122936296,"endTimestamp":1672123165026,"error":null,"stdout":"Sending build context to Docker daemon  36.32MB\r\r\nStep 1/15 : FROM  webdevops/php-nginx:7.4-alpine\n7.4-alpine: Pulling from webdevops/php-nginx\nca7dd9ec2225: Pulling fs layer\n1b78b4fe0ca1: Pulling fs layer\n9d6040f2a28f: Pulling fs layer\n0e2e66b89284: Pulling fs layer\n3b1be5f02bec: Pulling fs layer\n96243f515dda: Pulling fs layer\ne427679e7c26: Pulling fs layer\n759eb390abda: Pulling fs layer\n9820b782a628: Pulling fs layer\na9e6097c1efa: Pulling fs layer\n1b78b4fe0ca1: Waiting\n0e2e66b89284: Waiting\nbe00c2f91a2b: Pulling fs layer\n9d6040f2a28f: Waiting\n9c4141744f7e: Pulling fs layer\n63d65951d08d: Pulling fs layer\nca7dd9ec2225: Waiting\n96243f515dda: Waiting\n3b1be5f02bec: Waiting\nf360689876f8: Pulling fs layer\ne427679e7c26: Waiting\n759eb390abda: Waiting\na69a5e02d1d8: Pulling fs layer\n9c4141744f7e: Waiting\n685d6c205b67: Pulling fs layer\n9820b782a628: Waiting\ncd3745e161fe: Pulling fs layer\n63d65951d08d: Waiting\nd9556cf1bde5: Pulling fs layer\nf360689876f8: Waiting\nbe00c2f91a2b: Waiting\n147bbcfa97c4: Pulling fs layer\n685d6c205b67: Waiting\n147bbcfa97c4: Waiting\nd9556cf1bde5: Waiting\ncd3745e161fe: Waiting\nca7dd9ec2225: Verifying Checksum\nca7dd9ec2225: Download complete\n1b78b4fe0ca1: Verifying Checksum\n1b78b4fe0ca1: Download complete\nca7dd9ec2225: Pull complete\n9d6040f2a28f: Verifying Checksum\n9d6040f2a28f: Download complete\n0e2e66b89284: Verifying Checksum\n0e2e66b89284: Download complete\n1b78b4fe0ca1: Pull complete\n96243f515dda: Verifying Checksum\n96243f515dda: Download complete\n3b1be5f02bec: Verifying Checksum\n3b1be5f02bec: Download complete\n9d6040f2a28f: Pull complete\ne427679e7c26: Verifying Checksum\ne427679e7c26: Download complete\n759eb390abda: Verifying Checksum\n759eb390abda: Download complete\n0e2e66b89284: Pull complete\n9820b782a628: Verifying Checksum\n9820b782a628: Download complete\na9e6097c1efa: Verifying Checksum\na9e6097c1efa: Download complete\n63d65951d08d: Download complete\n3b1be5f02bec: Pull complete\n9c4141744f7e: Verifying Checksum\n9c4141744f7e: Download complete\nbe00c2f91a2b: Verifying Checksum\nbe00c2f91a2b: Download complete\n96243f515dda: Pull complete\nf360689876f8: Verifying Checksum\nf360689876f8: Download complete\ne427679e7c26: Pull complete\na69a5e02d1d8: Verifying Checksum\na69a5e02d1d8: Download complete\n759eb390abda: Pull complete\n9820b782a628: Pull complete\na9e6097c1efa: Pull complete\nbe00c2f91a2b: Pull complete\nd9556cf1bde5: Verifying Checksum\nd9556cf1bde5: Download complete\n9c4141744f7e: Pull complete\n63d65951d08d: Pull complete\nf360689876f8: Pull complete\n147bbcfa97c4: Verifying Checksum\n147bbcfa97c4: Download complete\n685d6c205b67: Verifying Checksum\n685d6c205b67: Download complete\ncd3745e161fe: Verifying Checksum\ncd3745e161fe: Download complete\na69a5e02d1d8: Pull complete\n685d6c205b67: Pull complete\ncd3745e161fe: Pull complete\nd9556cf1bde5: Pull complete\n147bbcfa97c4: Pull complete\nDigest: sha256:524e12836dd03d4659224bb3d538967d81e6e2df5a007893e6a566bde6c26126\nStatus: Downloaded newer image for webdevops/php-nginx:7.4-alpine\n ---> 864638ecfb05\nStep 2/15 : COPY ./ /var/www/html/\n ---> eec5ec4a78fd\nStep 3/15 : RUN mkdir -p /showdoc_data/html\n ---> Running in f60e16e16a4d\nRemoving intermediate container f60e16e16a4d\n ---> ed4b4d12139d\nStep 4/15 : RUN cp -R /var/www/html/ /showdoc_data/\n ---> Running in d7ca2a40650c\nRemoving intermediate container d7ca2a40650c\n ---> 1b40c5089f13\nStep 5/15 : RUN rm -rf /app && ln -s /var/www/html /app\n ---> Running in cb97b662b69f\nRemoving intermediate container cb97b662b69f\n ---> 1d6510d8325d\nStep 6/15 : RUN echo \"<?php echo file_get_contents('index.html'); ?>\" > /var/www/html/web/index.php\n ---> Running in 106f70188e36\nRemoving intermediate container 106f70188e36\n ---> 69d91a2f0386\nStep 7/15 : RUN echo \"upload_max_filesize=5000M;\" >> /opt/docker/etc/php/php.ini\n ---> Running in ea2659d68ad9\nRemoving intermediate container ea2659d68ad9\n ---> a3d26d3078b9\nStep 8/15 : RUN echo \"post_max_size=5000M;\" >> /opt/docker/etc/php/php.ini\n ---> Running in 0ab727c11b8e\nRemoving intermediate container 0ab727c11b8e\n ---> a0f76e4c0e78\nStep 9/15 : RUN echo \"client_max_body_size 5000m;\" > /opt/docker/etc/nginx/vhost.common.d/10-general.conf\n ---> Running in 8f0bee231f6f\nRemoving intermediate container 8f0bee231f6f\n ---> c7d878202c98\nStep 10/15 : RUN apk update\n ---> Running in d358d1fde320\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.16/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.16/community/x86_64/APKINDEX.tar.gz\nfetch https://dl-4.alpinelinux.org/alpine/v3.11/community/x86_64/APKINDEX.tar.gz\nv3.16.3-89-gf3ca4ba86a [https://dl-cdn.alpinelinux.org/alpine/v3.16/main]\nv3.16.3-88-gef347edb61 [https://dl-cdn.alpinelinux.org/alpine/v3.16/community]\nv3.11.11-124-gf2729ece5a [https://dl-4.alpinelinux.org/alpine/v3.11/community/]\nOK: 22959 distinct packages available\nRemoving intermediate container d358d1fde320\n ---> 3c8f819fdf6f\nStep 11/15 : RUN apk add --update nodejs npm\n ---> Running in 3300698734b3\n(1/3) Installing c-ares (1.18.1-r0)\n(2/3) Installing nodejs (16.17.1-r0)\n(3/3) Installing npm (8.10.0-r0)\nExecuting busybox-1.35.0-r17.trigger\nOK: 360 MiB in 165 packages\nRemoving intermediate container 3300698734b3\n ---> fcc56d4b1480\nStep 12/15 : RUN mv /showdoc_data/html/mock/ /showdoc_data/mock\n ---> Running in d0d4fc7272d2\nRemoving intermediate container d0d4fc7272d2\n ---> f5f974da6e0a\nStep 13/15 : RUN (cd /showdoc_data/mock/ && npm install )\n ---> Running in 0dbefb52d8df\n\u001b[91mnpm\u001b[0m\u001b[91m WARN old lockfile \nnpm WARN\u001b[0m\u001b[91m old lockfile\u001b[0m\u001b[91m The package-lock.json file was created with an old version of npm,\nnpm \u001b[0m\u001b[91mWARN old lockfile\u001b[0m\u001b[91m so supplemental metadata must be fetched from the registry.\nnpm WARN old lockfile \n\u001b[0m\u001b[91mnpm WARN old lockfile This is a one-time fix-up, please be patient...\nnpm WARN old lockfile \n\u001b[0m\u001b[91mnpm WARN deprecated uuid@3.4.0: Please upgrade  to version 7 or higher.  Older versions may use Math.random() in certain circumstances, which is known to be problematic.  See https://v8.dev/blog/math-random for details.\n\u001b[0m\u001b[91mnpm WARN deprecated debug@4.1.1: Debug versions >=3.2.0 <3.2.7 || >=4 <4.3.1 have a low-severity ReDos regression when used in a Node.js environment. It is recommended you upgrade to 3.2.7 or 4.3.1. (https://github.com/visionmedia/debug/issues/797)\n\u001b[0m\u001b[91mnpm WARN deprecated debug@4.1.1: Debug versions >=3.2.0 <3.2.7 || >=4 <4.3.1 have a low-severity ReDos regression when used in a Node.js environment. It is recommended you upgrade to 3.2.7 or 4.3.1. (https://github.com/visionmedia/debug/issues/797)\n\u001b[0m\nadded 203 packages, and audited 204 packages in 13s\n\n9 packages are looking for funding\n  run `npm fund` for details\n\n17 vulnerabilities (3 moderate, 13 high, 1 critical)\n\nTo address issues that do not require attention, run:\n  npm audit fix\n\nTo address all issues (including breaking changes), run:\n  npm audit fix --force\n\nRun `npm audit` for details.\nRemoving intermediate container 0dbefb52d8df\n ---> 352347250da5\nStep 14/15 : ENV SHOWDOC_DOCKER_VERSION 2.2\n ---> Running in eb1ffec8f41f\nRemoving intermediate container eb1ffec8f41f\n ---> 75dac52ed32b\nStep 15/15 : CMD if [ ! -f \"/var/www/html/index.php\" ]; then \\cp -fr /showdoc_data/html/ /var/www/ ;fi     ;chmod 777 -R /var/www/     ;(sleep 3 && cd /showdoc_data/html/server && php index.php /api/update/dockerUpdateCode && chmod 777 -R /var/www/ )     ;(sleep 30 && cd /showdoc_data/mock/ && npm run start)     & supervisord\n ---> Running in 9ff19fe16ed1\nRemoving intermediate container 9ff19fe16ed1\n ---> 59f4a8373515\nSuccessfully built 59f4a8373515\nSuccessfully tagged showdoc:latest\n","stderr":"","imageSize":598766977},"repair":{"violations":[{"name":"npmCacheCleanAfterInstall","position":{"start":15,"end":15,"columnStart":31,"columnEnd":42}},{"name":"apkAddUseNoCache","position":{"start":13,"end":13,"columnStart":4,"columnEnd":31}}],"repairedDockerfile":"FROM  webdevops/php-nginx:7.4-alpine\n\nCOPY ./ /var/www/html/\nRUN mkdir -p /showdoc_data/html\nRUN cp -R /var/www/html/ /showdoc_data/\nRUN rm -rf /app && ln -s /var/www/html /app\nRUN echo \"<?php echo file_get_contents('index.html'); ?>\" > /var/www/html/web/index.php\n\nRUN echo \"upload_max_filesize=5000M;\" >> /opt/docker/etc/php/php.ini\nRUN echo \"post_max_size=5000M;\" >> /opt/docker/etc/php/php.ini\nRUN echo \"client_max_body_size 5000m;\" > /opt/docker/etc/nginx/vhost.common.d/10-general.conf\n\nRUN apk update\nRUN apk add --no-cache --update nodejs npm\nRUN mv /showdoc_data/html/mock/ /showdoc_data/mock\nRUN (cd /showdoc_data/mock/ && npm install )\n\n# 写环境变量\nENV SHOWDOC_DOCKER_VERSION 2.2\n\nCMD if [ ! -f \"/var/www/html/index.php\" ]; then \\cp -fr /showdoc_data/html/ /var/www/ ;fi \\ \n    ;chmod 777 -R /var/www/ \\ \n    ;(sleep 3 && cd /showdoc_data/html/server && php index.php /api/update/dockerUpdateCode && chmod 777 -R /var/www/ ) \\\n    ;(sleep 30 && cd /showdoc_data/mock/ && npm run start) \\\n    & supervisord\n"},"repairedBuild":{"startTimestamp":1672123166233,"endTimestamp":1672123246846,"error":null,"stdout":"Sending build context to Docker daemon  36.32MB\r\r\nStep 1/15 : FROM  webdevops/php-nginx:7.4-alpine\n ---> 864638ecfb05\nStep 2/15 : COPY ./ /var/www/html/\n ---> a29ea60c5155\nStep 3/15 : RUN mkdir -p /showdoc_data/html\n ---> Running in 7e88e84ae391\nRemoving intermediate container 7e88e84ae391\n ---> a322f3ef1846\nStep 4/15 : RUN cp -R /var/www/html/ /showdoc_data/\n ---> Running in 33a470582ddb\nRemoving intermediate container 33a470582ddb\n ---> af535a121942\nStep 5/15 : RUN rm -rf /app && ln -s /var/www/html /app\n ---> Running in bc727b051c6b\nRemoving intermediate container bc727b051c6b\n ---> 068ede1f8934\nStep 6/15 : RUN echo \"<?php echo file_get_contents('index.html'); ?>\" > /var/www/html/web/index.php\n ---> Running in 2534b69932c0\nRemoving intermediate container 2534b69932c0\n ---> ac1d93efbaf9\nStep 7/15 : RUN echo \"upload_max_filesize=5000M;\" >> /opt/docker/etc/php/php.ini\n ---> Running in a3e66c9c3934\nRemoving intermediate container a3e66c9c3934\n ---> cb052acc87b5\nStep 8/15 : RUN echo \"post_max_size=5000M;\" >> /opt/docker/etc/php/php.ini\n ---> Running in 83ff2d697d4e\nRemoving intermediate container 83ff2d697d4e\n ---> 6e4da9d63b01\nStep 9/15 : RUN echo \"client_max_body_size 5000m;\" > /opt/docker/etc/nginx/vhost.common.d/10-general.conf\n ---> Running in f16520106150\nRemoving intermediate container f16520106150\n ---> 751a5fd5b8f9\nStep 10/15 : RUN apk update\n ---> Running in 4e3e8b22e2a9\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.16/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.16/community/x86_64/APKINDEX.tar.gz\nfetch https://dl-4.alpinelinux.org/alpine/v3.11/community/x86_64/APKINDEX.tar.gz\nv3.16.3-89-gf3ca4ba86a [https://dl-cdn.alpinelinux.org/alpine/v3.16/main]\nv3.16.3-88-gef347edb61 [https://dl-cdn.alpinelinux.org/alpine/v3.16/community]\nv3.11.11-124-gf2729ece5a [https://dl-4.alpinelinux.org/alpine/v3.11/community/]\nOK: 22959 distinct packages available\nRemoving intermediate container 4e3e8b22e2a9\n ---> bc810d039ab1\nStep 11/15 : RUN apk add --no-cache --update nodejs npm\n ---> Running in 202c51cfd1e9\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.16/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.16/community/x86_64/APKINDEX.tar.gz\nfetch https://dl-4.alpinelinux.org/alpine/v3.11/community/x86_64/APKINDEX.tar.gz\n(1/3) Installing c-ares (1.18.1-r0)\n(2/3) Installing nodejs (16.17.1-r0)\n(3/3) Installing npm (8.10.0-r0)\nExecuting busybox-1.35.0-r17.trigger\nOK: 360 MiB in 165 packages\nRemoving intermediate container 202c51cfd1e9\n ---> c437aa8b4af5\nStep 12/15 : RUN mv /showdoc_data/html/mock/ /showdoc_data/mock\n ---> Running in ae8473a4af94\nRemoving intermediate container ae8473a4af94\n ---> 6e6913bfc21f\nStep 13/15 : RUN (cd /showdoc_data/mock/ && npm install )\n ---> Running in 927dd07a3478\n\u001b[91mnpm\u001b[0m\u001b[91m WARN old lockfile \nnpm WARN old lockfile\u001b[0m\u001b[91m The package-lock.json file was created with an old version of npm,\nnpm WARN old lockfile\u001b[0m\u001b[91m so supplemental metadata must be fetched from the registry.\nnpm WARN old lockfile\u001b[0m\u001b[91m \n\u001b[0m\u001b[91mnpm WARN old lockfile This is a one-time fix-up, please be patient...\nnpm WARN old lockfile \n\u001b[0m\u001b[91mnpm WARN deprecated uuid@3.4.0: Please upgrade  to version 7 or higher.  Older versions may use Math.random() in certain circumstances, which is known to be problematic.  See https://v8.dev/blog/math-random for details.\n\u001b[0m\u001b[91mnpm WARN deprecated debug@4.1.1: Debug versions >=3.2.0 <3.2.7 || >=4 <4.3.1 have a low-severity ReDos regression when used in a Node.js environment. It is recommended you upgrade to 3.2.7 or 4.3.1. (https://github.com/visionmedia/debug/issues/797)\n\u001b[0m\u001b[91mnpm WARN deprecated debug@4.1.1: Debug versions >=3.2.0 <3.2.7 || >=4 <4.3.1 have a low-severity ReDos regression when used in a Node.js environment. It is recommended you upgrade to 3.2.7 or 4.3.1. (https://github.com/visionmedia/debug/issues/797)\n\u001b[0m\nadded 203 packages, and audited 204 packages in 9s\n\n9 packages are looking for funding\n  run `npm fund` for details\n\n17 vulnerabilities (3 moderate, 13 high, 1 critical)\n\nTo address issues that do not require attention, run:\n  npm audit fix\n\nTo address all issues (including breaking changes), run:\n  npm audit fix --force\n\nRun `npm audit` for details.\nRemoving intermediate container 927dd07a3478\n ---> f0b3562bb6e9\nStep 14/15 : ENV SHOWDOC_DOCKER_VERSION 2.2\n ---> Running in ce70ceb3d599\nRemoving intermediate container ce70ceb3d599\n ---> 5b0c39febd07\nStep 15/15 : CMD if [ ! -f \"/var/www/html/index.php\" ]; then \\cp -fr /showdoc_data/html/ /var/www/ ;fi     ;chmod 777 -R /var/www/     ;(sleep 3 && cd /showdoc_data/html/server && php index.php /api/update/dockerUpdateCode && chmod 777 -R /var/www/ )     ;(sleep 30 && cd /showdoc_data/mock/ && npm run start)     & supervisord\n ---> Running in e750b82284c7\nRemoving intermediate container e750b82284c7\n ---> 26588f7efc95\nSuccessfully built 26588f7efc95\nSuccessfully tagged showdoc:latest\n","stderr":"","imageSize":598766369},"endTime":1672123247979}