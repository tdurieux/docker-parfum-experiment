{"repository":"https://github.com/ohdsi/atlas","dockerfilePath":"Dockerfile","startTime":1672109963553,"clone":{"stdout":"","stderr":"Cloning into '/tmp/dinghy-analysis/ohdsi/atlas'...\n","error":null,"commit":"996b2c6910d03040e97e10f264eda21bdd702b06"},"originalBuild":{"startTimestamp":1672109964751,"endTimestamp":1672110286846,"error":null,"stdout":"Sending build context to Docker daemon   7.99MB\r\r\nStep 1/26 : FROM node:14-alpine as builder\n ---> fb7170aa2b9b\nStep 2/26 : WORKDIR /code\n ---> Running in 3d4a823403b6\nRemoving intermediate container 3d4a823403b6\n ---> 5503cb4c7e4a\nStep 3/26 : COPY package*.json /code/\n ---> 6c6c4af41674\nStep 4/26 : RUN npm install\n ---> Running in 76bbe0e8136c\n\u001b[91mnpm WARN deprecated @babel/polyfill@7.12.1: ðŸš¨ This package has been deprecated in favor of separate inclusion of a polyfill and regenerator-runtime (when needed). See the @babel/polyfill docs (https://babeljs.io/docs/en/babel-polyfill) for more information.\n\u001b[0m\u001b[91mnpm WARN \u001b[0m\u001b[91mdeprecated querystring@0.2.1: The querystring API is considered Legacy. new code should use the URLSearchParams API instead.\n\u001b[0m\u001b[91mnpm WARN deprecated core-js@2.6.12: core-js@<3.23.3 is no longer maintained and not recommended for usage due to the number of issues. Because of the V8 engine whims, feature detection in old core-js versions could cause a slowdown up to 100x even if nothing is polyfilled. Some versions have web compatibility issues. Please, upgrade your dependencies to the actual version of core-js.\n\u001b[0m\n> core-js@2.6.12 postinstall /code/node_modules/core-js\n> node -e \"try{require('./postinstall')}catch(e){}\"\n\n\u001b[96mThank you for using core-js (\u001b[94m https://github.com/zloirock/core-js \u001b[96m) for polyfilling JavaScript standard library!\u001b[0m\n\n\u001b[96mThe project needs your help! Please consider supporting of core-js on Open Collective or Patreon: \u001b[0m\n\u001b[96m>\u001b[94m https://opencollective.com/core-js \u001b[0m\n\u001b[96m>\u001b[94m https://www.patreon.com/zloirock \u001b[0m\n\n\u001b[96mAlso, the author of core-js (\u001b[94m https://github.com/zloirock \u001b[96m) is looking for a good job -)\u001b[0m\n\n\u001b[91mnpm notice created a lockfile as package-lock.json. You should commit this file.\n\u001b[0madded 448 packages from 226 contributors and audited 453 packages in 16.995s\n\n55 packages are looking for funding\n  run `npm fund` for details\n\nfound 22 vulnerabilities (1 low, 14 moderate, 7 high)\n  run `npm audit fix` to fix them, or `npm audit` for details\nRemoving intermediate container 76bbe0e8136c\n ---> 7208b4b7e375\nStep 5/26 : COPY ./build /code/build\n ---> dd248d4fa2a4\nStep 6/26 : COPY ./js /code/js\n ---> b2b7eab9ae7f\nStep 7/26 : RUN npm run build:docker\n ---> Running in 59464f4ed063\n\n> atlas@2.13.0-DEV build:docker /code\n> npm run clean && npm run genversion && npm run build:dev && npm prune --production\n\n\n> atlas@2.13.0-DEV clean /code\n> rimraf ./js/assets/bundle && rimraf ./js/assets/fonts && rimraf ./js/assets/images\n\n\n> atlas@2.13.0-DEV genversion /code\n> genversion -s js/version/version.js && r_js -convert js/version js/ && rimraf js/version\n\n\n> atlas@2.13.0-DEV build:dev /code\n> node build/optimize.js && npm run compress\n\n\u001b[91m[BABEL] Note: The code generator has deoptimised the styling of undefined as it exceeds the max of 500KB.\n\u001b[0m\u001b[91m[BABEL] Note: The code generator has deoptimised the styling of undefined as it exceeds the max of 500KB.\n\u001b[0m\n> atlas@2.13.0-DEV compress /code\n> terser ./js/assets/bundle/bundle.js -o ./js/assets/bundle/bundle.js -c --source-map\n\nremoved 181 packages and audited 272 packages in 3.23s\n\n48 packages are looking for funding\n  run `npm fund` for details\n\nfound 21 vulnerabilities (1 low, 14 moderate, 6 high)\n  run `npm audit fix` to fix them, or `npm audit` for details\nRemoving intermediate container 59464f4ed063\n ---> 9beaae094dd2\nStep 8/26 : COPY ./index.html /code/index.html\n ---> 31e8e6978cd1\nStep 9/26 : RUN find . -type f \"(\"         -name \"*.css\"         -o -name \"*.html\"         -o -name \"*.js\" ! -name \"config-local.js\"         -o -name \"*.json\"         -o -name \"*.svg\"         -o -name \"*.xml\"       \")\" -print0       | xargs -0 -n 1 gzip -kf\n ---> Running in 19ac1ed528ca\nRemoving intermediate container 19ac1ed528ca\n ---> ac0315b9452f\nStep 10/26 : FROM nginxinc/nginx-unprivileged:1.23.0-alpine\n1.23.0-alpine: Pulling from nginxinc/nginx-unprivileged\n530afca65e2e: Already exists\n82c8427412df: Pulling fs layer\n2f039ebcbc45: Pulling fs layer\n3500d1855df8: Pulling fs layer\n2fff860c8571: Pulling fs layer\n8ed9f0619cb7: Pulling fs layer\n4b814ef41f7a: Pulling fs layer\n2fff860c8571: Waiting\n4b814ef41f7a: Waiting\n3500d1855df8: Verifying Checksum\n3500d1855df8: Download complete\n2f039ebcbc45: Verifying Checksum\n2f039ebcbc45: Download complete\n2fff860c8571: Verifying Checksum\n2fff860c8571: Download complete\n8ed9f0619cb7: Verifying Checksum\n8ed9f0619cb7: Download complete\n82c8427412df: Verifying Checksum\n82c8427412df: Download complete\n82c8427412df: Pull complete\n2f039ebcbc45: Pull complete\n4b814ef41f7a: Verifying Checksum\n4b814ef41f7a: Download complete\n3500d1855df8: Pull complete\n2fff860c8571: Pull complete\n8ed9f0619cb7: Pull complete\n4b814ef41f7a: Pull complete\nDigest: sha256:980999c346b0199f45a636f4eda38fc76beb9b7e3a9fb16b60e0c629ee165a66\nStatus: Downloaded newer image for nginxinc/nginx-unprivileged:1.23.0-alpine\n ---> 95cd9b3b0f5c\nStep 11/26 : LABEL org.opencontainers.image.title=\"OHDSI-Atlas\"\n ---> Running in 6ed35308eff8\nRemoving intermediate container 6ed35308eff8\n ---> 25ad8f5f14c0\nStep 12/26 : LABEL org.opencontainers.image.authors=\"Joris Borgdorff <joris@thehyve.nl>, Lee Evans - www.ltscomputingllc.com\"\n ---> Running in d144ebe7bdac\nRemoving intermediate container d144ebe7bdac\n ---> 815da93c0793\nStep 13/26 : LABEL org.opencontainers.image.description=\"ATLAS is an open source software tool for researchers to conduct scientific analyses on standardized observational data\"\n ---> Running in 55b4331211b0\nRemoving intermediate container 55b4331211b0\n ---> d04f777d00d1\nStep 14/26 : LABEL org.opencontainers.image.licenses=\"Apache-2.0\"\n ---> Running in 43bee4bb02e5\nRemoving intermediate container 43bee4bb02e5\n ---> 1298bf6ae1d2\nStep 15/26 : LABEL org.opencontainers.image.vendor=\"OHDSI\"\n ---> Running in c35d936b10d1\nRemoving intermediate container c35d936b10d1\n ---> 9bfdf5d7120a\nStep 16/26 : LABEL org.opencontainers.image.source=\"https://github.com/OHDSI/Atlas\"\n ---> Running in 6ea52d77e07a\nRemoving intermediate container 6ea52d77e07a\n ---> 01f5670aadf4\nStep 17/26 : ENV WEBAPI_URL=http://localhost:8080/WebAPI/   CONFIG_PATH=/etc/atlas/config-local.js\n ---> Running in e922710ba3bf\nRemoving intermediate container e922710ba3bf\n ---> da826bb31889\nStep 18/26 : COPY ./docker/nginx-default.conf /etc/nginx/conf.d/default.conf\n ---> cf879a98a9d9\nStep 19/26 : COPY ./docker/optimization.conf /etc/nginx/conf.d/optimization.conf\n ---> 4ef239798838\nStep 20/26 : COPY ./docker/30-atlas-env-subst.sh /docker-entrypoint.d/30-atlas-env-subst.sh\n ---> 42b0738d28a5\nStep 21/26 : COPY ./images /usr/share/nginx/html/atlas/images\n ---> dd1177863231\nStep 22/26 : COPY ./README.md ./LICENSE /usr/share/nginx/html/atlas/\n ---> f3afab0a0aba\nStep 23/26 : COPY --from=builder /code/index.html* /usr/share/nginx/html/atlas/\n ---> 2423326752a8\nStep 24/26 : COPY --from=builder /code/node_modules /usr/share/nginx/html/atlas/node_modules\n ---> 360e38c6b19b\nStep 25/26 : COPY --from=builder /code/js /usr/share/nginx/html/atlas/js\n ---> b5e8ac16a973\nStep 26/26 : COPY --chown=101 docker/config-local.js /usr/share/nginx/html/atlas/js/config-local.js\n ---> 04888d3a3c07\nSuccessfully built 04888d3a3c07\nSuccessfully tagged atlas:latest\n","stderr":"","imageSize":142349882},"repair":{"violations":[{"name":"npmCacheCleanAfterInstall","position":{"start":8,"end":8,"columnStart":4,"columnEnd":15}}],"repairedDockerfile":"# Build the source\nFROM node:14-alpine as builder\n\nWORKDIR /code\n\n# First install dependencies. This part will be cached as long as\n# the package(-lock).json files remain identical.\nCOPY package*.json /code/\nRUN npm install\n\n# Build code\nCOPY ./build /code/build\nCOPY ./js /code/js\nRUN npm run build:docker\n\n# Statically pre-compress all output files to be served\nCOPY ./index.html /code/index.html\nRUN find . -type f \"(\" \\\n        -name \"*.css\" \\\n        -o -name \"*.html\" \\\n        -o -name \"*.js\" ! -name \"config-local.js\" \\\n        -o -name \"*.json\" \\\n        -o -name \"*.svg\" \\\n        -o -name \"*.xml\" \\\n      \")\" -print0 \\\n      | xargs -0 -n 1 gzip -kf\n\n# Production Nginx image\nFROM nginxinc/nginx-unprivileged:1.23.0-alpine\n\nLABEL org.opencontainers.image.title=\"OHDSI-Atlas\"\nLABEL org.opencontainers.image.authors=\"Joris Borgdorff <joris@thehyve.nl>, Lee Evans - www.ltscomputingllc.com\"\nLABEL org.opencontainers.image.description=\"ATLAS is an open source software tool for researchers to \\\nconduct scientific analyses on standardized observational data\"\nLABEL org.opencontainers.image.licenses=\"Apache-2.0\"\nLABEL org.opencontainers.image.vendor=\"OHDSI\"\nLABEL org.opencontainers.image.source=\"https://github.com/OHDSI/Atlas\"\n\n# URL where WebAPI can be queried by the client\nENV WEBAPI_URL=http://localhost:8080/WebAPI/ \\\n  CONFIG_PATH=/etc/atlas/config-local.js\n\n# Configure webserver\nCOPY ./docker/nginx-default.conf /etc/nginx/conf.d/default.conf\nCOPY ./docker/optimization.conf /etc/nginx/conf.d/optimization.conf\nCOPY ./docker/30-atlas-env-subst.sh /docker-entrypoint.d/30-atlas-env-subst.sh\n\n# Load code\nCOPY ./images /usr/share/nginx/html/atlas/images\nCOPY ./README.md ./LICENSE /usr/share/nginx/html/atlas/\nCOPY --from=builder /code/index.html* /usr/share/nginx/html/atlas/\nCOPY --from=builder /code/node_modules /usr/share/nginx/html/atlas/node_modules\nCOPY --from=builder /code/js /usr/share/nginx/html/atlas/js\n\n# Load Atlas local config with current user, so it can be modified\n# with env substitution\nCOPY --chown=101 docker/config-local.js /usr/share/nginx/html/atlas/js/config-local.js\n"},"repairedBuild":{"startTimestamp":1672110346784,"endTimestamp":1672110592775,"error":null,"stdout":"Sending build context to Docker daemon   7.99MB\r\r\nStep 1/26 : FROM node:14-alpine as builder\n ---> fb7170aa2b9b\nStep 2/26 : WORKDIR /code\n ---> Running in 55045915a6ec\nRemoving intermediate container 55045915a6ec\n ---> c669265cc7eb\nStep 3/26 : COPY package*.json /code/\n ---> f9e1e06946f2\nStep 4/26 : RUN npm install\n ---> Running in 409b08ff0cce\n\u001b[91mnpm WARN deprecated @babel/polyfill@7.12.1: ðŸš¨ This package has been deprecated in favor of separate inclusion of a polyfill and regenerator-runtime (when needed). See the @babel/polyfill docs (https://babeljs.io/docs/en/babel-polyfill) for more information.\n\u001b[0m\u001b[91mnpm WARN deprecated querystring@0.2.1: The querystring API is considered Legacy. new code should use the URLSearchParams API instead.\n\u001b[0m\u001b[91mnpm WARN deprecated core-js@2.6.12: core-js@<3.23.3 is no longer maintained and not recommended for usage due to the number of issues. Because of the V8 engine whims, feature detection in old core-js versions could cause a slowdown up to 100x even if nothing is polyfilled. Some versions have web compatibility issues. Please, upgrade your dependencies to the actual version of core-js.\n\u001b[0m\n> core-js@2.6.12 postinstall /code/node_modules/core-js\n> node -e \"try{require('./postinstall')}catch(e){}\"\n\n\u001b[96mThank you for using core-js (\u001b[94m https://github.com/zloirock/core-js \u001b[96m) for polyfilling JavaScript standard library!\u001b[0m\n\n\u001b[96mThe project needs your help! Please consider supporting of core-js on Open Collective or Patreon: \u001b[0m\n\u001b[96m>\u001b[94m https://opencollective.com/core-js \u001b[0m\n\u001b[96m>\u001b[94m https://www.patreon.com/zloirock \u001b[0m\n\n\u001b[96mAlso, the author of core-js (\u001b[94m https://github.com/zloirock \u001b[96m) is looking for a good job -)\u001b[0m\n\n\u001b[91mnpm notice created a lockfile as package-lock.json. You should commit this file.\n\u001b[0madded 448 packages from 226 contributors and audited 453 packages in 16.089s\n\n55 packages are looking for funding\n  run `npm fund` for details\n\nfound 22 vulnerabilities (1 low, 14 moderate, 7 high)\n  run `npm audit fix` to fix them, or `npm audit` for details\nRemoving intermediate container 409b08ff0cce\n ---> f5afb0e8961f\nStep 5/26 : COPY ./build /code/build\n ---> f88b61d7191a\nStep 6/26 : COPY ./js /code/js\n ---> 6943f66cf029\nStep 7/26 : RUN npm run build:docker\n ---> Running in 2e24dadd0a72\n\n> atlas@2.13.0-DEV build:docker /code\n> npm run clean && npm run genversion && npm run build:dev && npm prune --production\n\n\n> atlas@2.13.0-DEV clean /code\n> rimraf ./js/assets/bundle && rimraf ./js/assets/fonts && rimraf ./js/assets/images\n\n\n> atlas@2.13.0-DEV genversion /code\n> genversion -s js/version/version.js && r_js -convert js/version js/ && rimraf js/version\n\n\n> atlas@2.13.0-DEV build:dev /code\n> node build/optimize.js && npm run compress\n\n\u001b[91m[BABEL] Note: The code generator has deoptimised the styling of undefined as it exceeds the max of 500KB.\n\u001b[0m\u001b[91m[BABEL] Note: The code generator has deoptimised the styling of undefined as it exceeds the max of 500KB.\n\u001b[0m\n> atlas@2.13.0-DEV compress /code\n> terser ./js/assets/bundle/bundle.js -o ./js/assets/bundle/bundle.js -c --source-map\n\nremoved 181 packages and audited 272 packages in 2.797s\n\n48 packages are looking for funding\n  run `npm fund` for details\n\nfound 21 vulnerabilities (1 low, 14 moderate, 6 high)\n  run `npm audit fix` to fix them, or `npm audit` for details\nRemoving intermediate container 2e24dadd0a72\n ---> c1d02c0f1cbb\nStep 8/26 : COPY ./index.html /code/index.html\n ---> 59fcdfd624dd\nStep 9/26 : RUN find . -type f \"(\"         -name \"*.css\"         -o -name \"*.html\"         -o -name \"*.js\" ! -name \"config-local.js\"         -o -name \"*.json\"         -o -name \"*.svg\"         -o -name \"*.xml\"       \")\" -print0       | xargs -0 -n 1 gzip -kf\n ---> Running in ffd3e43bbb46\nRemoving intermediate container ffd3e43bbb46\n ---> 1bf3a9ba18bd\nStep 10/26 : FROM nginxinc/nginx-unprivileged:1.23.0-alpine\n ---> 95cd9b3b0f5c\nStep 11/26 : LABEL org.opencontainers.image.title=\"OHDSI-Atlas\"\n ---> Running in 7637d4e7cb26\nRemoving intermediate container 7637d4e7cb26\n ---> ca4cddb48218\nStep 12/26 : LABEL org.opencontainers.image.authors=\"Joris Borgdorff <joris@thehyve.nl>, Lee Evans - www.ltscomputingllc.com\"\n ---> Running in 708705251e88\nRemoving intermediate container 708705251e88\n ---> bd9d70d17575\nStep 13/26 : LABEL org.opencontainers.image.description=\"ATLAS is an open source software tool for researchers to conduct scientific analyses on standardized observational data\"\n ---> Running in 40362f178410\nRemoving intermediate container 40362f178410\n ---> 389d44660106\nStep 14/26 : LABEL org.opencontainers.image.licenses=\"Apache-2.0\"\n ---> Running in 0afc6c200897\nRemoving intermediate container 0afc6c200897\n ---> 9e974f7772f7\nStep 15/26 : LABEL org.opencontainers.image.vendor=\"OHDSI\"\n ---> Running in cbbd18a83cf9\nRemoving intermediate container cbbd18a83cf9\n ---> 2cc8a2f97b05\nStep 16/26 : LABEL org.opencontainers.image.source=\"https://github.com/OHDSI/Atlas\"\n ---> Running in b7677c4b95a6\nRemoving intermediate container b7677c4b95a6\n ---> 16e457f1a25e\nStep 17/26 : ENV WEBAPI_URL=http://localhost:8080/WebAPI/   CONFIG_PATH=/etc/atlas/config-local.js\n ---> Running in 0a04ff1dcacf\nRemoving intermediate container 0a04ff1dcacf\n ---> 847efea3880e\nStep 18/26 : COPY ./docker/nginx-default.conf /etc/nginx/conf.d/default.conf\n ---> 9cfae5c8b248\nStep 19/26 : COPY ./docker/optimization.conf /etc/nginx/conf.d/optimization.conf\n ---> a96092b83b25\nStep 20/26 : COPY ./docker/30-atlas-env-subst.sh /docker-entrypoint.d/30-atlas-env-subst.sh\n ---> 739320814390\nStep 21/26 : COPY ./images /usr/share/nginx/html/atlas/images\n ---> 1e07581fbc96\nStep 22/26 : COPY ./README.md ./LICENSE /usr/share/nginx/html/atlas/\n ---> ba965e3ea7ce\nStep 23/26 : COPY --from=builder /code/index.html* /usr/share/nginx/html/atlas/\n ---> f0a467a0ca7d\nStep 24/26 : COPY --from=builder /code/node_modules /usr/share/nginx/html/atlas/node_modules\n ---> 90f94bcb4921\nStep 25/26 : COPY --from=builder /code/js /usr/share/nginx/html/atlas/js\n ---> 91b0ee874f5b\nStep 26/26 : COPY --chown=101 docker/config-local.js /usr/share/nginx/html/atlas/js/config-local.js\n ---> 3d6d3c4c6d07\nSuccessfully built 3d6d3c4c6d07\nSuccessfully tagged atlas:latest\n","stderr":"","imageSize":142349882},"endTime":1672110593632}