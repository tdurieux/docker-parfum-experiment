{"repository":"https://github.com/codehearts/shpy","dockerfilePath":"Dockerfile","startTime":1672108629776,"clone":{"stdout":"","stderr":"Cloning into '/tmp/dinghy-analysis/codehearts/shpy'...\n","error":null,"commit":"6c8f8fe5cb51f83ff2b193ce00a143d5e5e910af"},"originalBuild":{"startTimestamp":1672108630562,"endTimestamp":1672108666639,"error":null,"stdout":"Sending build context to Docker daemon  127.5kB\r\r\nStep 1/27 : FROM koalaman/shellcheck:v0.8.0 AS shellcheck\nv0.8.0: Pulling from koalaman/shellcheck\n462eca717af4: Pulling fs layer\nab658b01598a: Pulling fs layer\n462eca717af4: Download complete\nab658b01598a: Verifying Checksum\nab658b01598a: Download complete\n462eca717af4: Pull complete\nab658b01598a: Pull complete\nDigest: sha256:4c4427336d2b4bdb054a1e97396fa2e9ca0c329a1f43f831b99bcaae4ac24fcd\nStatus: Downloaded newer image for koalaman/shellcheck:v0.8.0\n ---> 72bc383380ff\nStep 2/27 : FROM alpine:3.16.2 AS shunit\n3.16.2: Pulling from library/alpine\n213ec9aee27d: Already exists\nDigest: sha256:65a2763f593ae85fab3b5406dc9e80f744ec5b449f269b699b5efd37a07ad32e\nStatus: Downloaded newer image for alpine:3.16.2\n ---> 9c6f07244728\nStep 3/27 : ARG SHUNIT2_SHA=ba130d69bbff304c0c6a9c5e8ab549ae140d6225\n ---> Running in 6f3ade114b50\nRemoving intermediate container 6f3ade114b50\n ---> ff41fe4c9bbd\nStep 4/27 : ARG SHUNIT2_URL=https://github.com/kward/shunit2/archive/${SHUNIT2_SHA}.tar.gz\n ---> Running in 2c205d6209b6\nRemoving intermediate container 2c205d6209b6\n ---> d69ed77961cd\nStep 5/27 : RUN wget ${SHUNIT2_URL} -qO shunit2.tar.gz\n ---> Running in 87fc19871c75\nRemoving intermediate container 87fc19871c75\n ---> 056cbf9e4c66\nStep 6/27 : RUN tar xzf shunit2.tar.gz && mv shunit2-* shunit2\n ---> Running in caa3697224f3\nRemoving intermediate container caa3697224f3\n ---> da6d9b36fb69\nStep 7/27 : FROM kcov/kcov:v40 AS kcov\nv40: Pulling from kcov/kcov\ne5ae68f74026: Pulling fs layer\n70eb07f3987f: Pulling fs layer\n992cedaee3d2: Pulling fs layer\n2343a47a1c65: Pulling fs layer\n2343a47a1c65: Waiting\ne5ae68f74026: Verifying Checksum\ne5ae68f74026: Download complete\n992cedaee3d2: Verifying Checksum\n992cedaee3d2: Download complete\n2343a47a1c65: Download complete\ne5ae68f74026: Pull complete\n70eb07f3987f: Verifying Checksum\n70eb07f3987f: Download complete\n70eb07f3987f: Pull complete\n992cedaee3d2: Pull complete\n2343a47a1c65: Pull complete\nDigest: sha256:cc08a1f792f8880e383442e8fd9ff67a8ea9948561177370e453500eb2a5f6dc\nStatus: Downloaded newer image for kcov/kcov:v40\n ---> 6d40146c9b53\nStep 8/27 : RUN useradd -ms /bin/sh shpy\n ---> Running in decb0971f7f3\nRemoving intermediate container decb0971f7f3\n ---> c6d004f6f7ab\nStep 9/27 : ENV SHPY_PATH /shpy/shpy\n ---> Running in 1fe7448091b8\nRemoving intermediate container 1fe7448091b8\n ---> 68d084625a4c\nStep 10/27 : COPY --from=shunit --chown=shpy /shunit2/shunit2 /usr/local/bin/shunit2\n ---> 08c77d38b74d\nStep 11/27 : RUN mkdir /shpy /app /coverage && chown shpy:shpy /shpy /app /coverage\n ---> Running in 527fb8c567f1\nRemoving intermediate container 527fb8c567f1\n ---> 9308c188bb64\nStep 12/27 : USER shpy\n ---> Running in 30f95a430dd8\nRemoving intermediate container 30f95a430dd8\n ---> 5e6bab2852ac\nStep 13/27 : COPY --chown=shpy ./ /shpy/\n ---> c97167f39609\nStep 14/27 : WORKDIR /app/\n ---> Running in 9c2a50c0f16a\nRemoving intermediate container 9c2a50c0f16a\n ---> 49b69eb1e317\nStep 15/27 : CMD [\"/bin/sh\"]\n ---> Running in 1c4d8332bf30\nRemoving intermediate container 1c4d8332bf30\n ---> 5094c2289fa9\nStep 16/27 : FROM alpine:3.16.2 AS shpy\n ---> 9c6f07244728\nStep 17/27 : RUN echo 'http://dl-cdn.alpinelinux.org/alpine/edge/community' >> /etc/apk/repositories\n ---> Running in 4458fec034c8\nRemoving intermediate container 4458fec034c8\n ---> 3f8ad4f0c207\nStep 18/27 : RUN apk --no-cache add --update-cache       ncurses curl checkbashisms bash dash mksh zsh\n ---> Running in 11f58173f33e\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.16/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.16/community/x86_64/APKINDEX.tar.gz\nfetch http://dl-cdn.alpinelinux.org/alpine/edge/community/x86_64/APKINDEX.tar.gz\n(1/19) Installing ncurses-terminfo-base (6.3_p20220521-r0)\n(2/19) Installing ncurses-libs (6.3_p20220521-r0)\n(3/19) Installing readline (8.1.2-r0)\n(4/19) Installing bash (5.1.16-r2)\nExecuting bash-5.1.16-r2.post-install\n(5/19) Installing libbz2 (1.0.8-r1)\n(6/19) Installing perl (5.34.1-r0)\n(7/19) Installing checkbashisms (2.22.1-r0)\n(8/19) Installing ca-certificates (20220614-r0)\n(9/19) Installing brotli-libs (1.0.9-r6)\n(10/19) Installing nghttp2-libs (1.47.0-r0)\n(11/19) Installing libcurl (7.83.1-r5)\n(12/19) Installing curl (7.83.1-r5)\n(13/19) Installing dash (0.5.11.5-r1)\nExecuting dash-0.5.11.5-r1.post-install\n(14/19) Installing mksh (59c-r3)\nExecuting mksh-59c-r3.post-install\n(15/19) Installing ncurses (6.3_p20220521-r0)\n(16/19) Installing libcap (2.64-r0)\n(17/19) Installing zsh (5.8.1-r4)\nExecuting zsh-5.8.1-r4.post-install\n(18/19) Installing apk-tools-zsh-completion (2.12.9-r3)\n(19/19) Installing curl-zsh-completion (7.83.1-r5)\nExecuting busybox-1.35.0-r17.trigger\nExecuting ca-certificates-20220614-r0.trigger\nOK: 55 MiB in 33 packages\nRemoving intermediate container 11f58173f33e\n ---> 5430a4a9dc39\nStep 19/27 : RUN addgroup -S shpy && adduser -S shpy -G shpy\n ---> Running in 70a5be1eac60\nRemoving intermediate container 70a5be1eac60\n ---> fd42be836bab\nStep 20/27 : ENV SHPY_PATH /shpy/shpy\n ---> Running in 8c2b6c9258f0\nRemoving intermediate container 8c2b6c9258f0\n ---> 3f12e7e8d994\nStep 21/27 : COPY --from=shellcheck --chown=shpy /bin/shellcheck /usr/local/bin/shellcheck\n ---> b3962b56e63e\nStep 22/27 : COPY --from=shunit --chown=shpy /shunit2/shunit2 /usr/local/bin/shunit2\n ---> 646d5ad3aaa8\nStep 23/27 : RUN mkdir /shpy/ /app/ && chown shpy:shpy /shpy/ /app/\n ---> Running in 8a80bfc8f5d9\nRemoving intermediate container 8a80bfc8f5d9\n ---> 4a1cac014ad6\nStep 24/27 : USER shpy\n ---> Running in f1b1c56ab508\nRemoving intermediate container f1b1c56ab508\n ---> cadeac916b83\nStep 25/27 : COPY --chown=shpy ./ /shpy/\n ---> 1cb217982b10\nStep 26/27 : WORKDIR /app/\n ---> Running in 28c86fd5697a\nRemoving intermediate container 28c86fd5697a\n ---> c59c607844e1\nStep 27/27 : CMD [\"/bin/sh\"]\n ---> Running in 7b866032344f\nRemoving intermediate container 7b866032344f\n ---> 74b35bd71ab9\nSuccessfully built 74b35bd71ab9\nSuccessfully tagged shpy:latest\n","stderr":"","imageSize":56762040},"repair":{"violations":[{"name":"tarSomethingRmTheSomething","position":{"start":13,"end":13,"columnStart":4,"columnEnd":26}}],"repairedDockerfile":"#\n# Fetch the official shellcheck image\n#\nFROM koalaman/shellcheck:v0.8.0 AS shellcheck\n\n#\n# Create a shunit stage to pull a fixed commit into /shunit2\n#\nFROM alpine:3.16.2 AS shunit\n\nARG SHUNIT2_SHA=ba130d69bbff304c0c6a9c5e8ab549ae140d6225\nARG SHUNIT2_URL=https://github.com/kward/shunit2/archive/${SHUNIT2_SHA}.tar.gz\nRUN wget ${SHUNIT2_URL} -qO shunit2.tar.gz\nRUN tar xzf shunit2.tar.gz && mv shunit2-* shunit2\n\n#\n# Create a kcov target to run kcov on debian\n#\nFROM kcov/kcov:v40 AS kcov\n\n# Create a non-root `shpy` user\nRUN useradd -ms /bin/sh shpy\n\n# Define the shpy path globally\nENV SHPY_PATH /shpy/shpy\n\n# Copy in shunit2\nCOPY --from=shunit --chown=shpy /shunit2/shunit2 /usr/local/bin/shunit2\n\n# Create /shpy, /app, /coverage for the non-root user and run as them\nRUN mkdir /shpy /app /coverage && chown shpy:shpy /shpy /app /coverage\nUSER shpy\n\n# Copy the current shpy sources\nCOPY --chown=shpy ./ /shpy/\nWORKDIR /app/\n\n# By default, run `/bin/sh` (which is `dash` under Debian)\nCMD [\"/bin/sh\"]\n\n#\n# Base the shpy image on Alpine Linux\n#\nFROM alpine:3.16.2 AS shpy\n\n# Enable the community repo to install dash\nRUN echo 'http://dl-cdn.alpinelinux.org/alpine/edge/community' >> /etc/apk/repositories\n\n# Install shells and tools available as Alpine packages\n# Ncurses is installed for `tput`, which is used by shunit to colorize output\n# Curl is installed for the `coverfetch` example\nRUN apk --no-cache add --update-cache \\\n      ncurses curl checkbashisms bash dash mksh zsh\n\n# Create a non-root `shpy` user\nRUN addgroup -S shpy && adduser -S shpy -G shpy\n\n# Define the shpy path globally\nENV SHPY_PATH /shpy/shpy\n\n# Copy in shellcheck and shunit2\nCOPY --from=shellcheck --chown=shpy /bin/shellcheck /usr/local/bin/shellcheck\nCOPY --from=shunit --chown=shpy /shunit2/shunit2 /usr/local/bin/shunit2\n\n# Create /shpy/ and /app/ for the non-root user and run as them\nRUN mkdir /shpy/ /app/ && chown shpy:shpy /shpy/ /app/\nUSER shpy\n\n# Copy the current shpy sources\nCOPY --chown=shpy ./ /shpy/\nWORKDIR /app/\n\n# By default, run `/bin/sh` (which is `ash` under BusyBox in Alpine Linux)\nCMD [\"/bin/sh\"]\n"},"repairedBuild":{"startTimestamp":1672108667047,"endTimestamp":1672108689391,"error":null,"stdout":"Sending build context to Docker daemon  127.5kB\r\r\nStep 1/27 : FROM koalaman/shellcheck:v0.8.0 AS shellcheck\n ---> 72bc383380ff\nStep 2/27 : FROM alpine:3.16.2 AS shunit\n ---> 9c6f07244728\nStep 3/27 : ARG SHUNIT2_SHA=ba130d69bbff304c0c6a9c5e8ab549ae140d6225\n ---> Running in 9095807f51de\nRemoving intermediate container 9095807f51de\n ---> 5ffc1d17d4ce\nStep 4/27 : ARG SHUNIT2_URL=https://github.com/kward/shunit2/archive/${SHUNIT2_SHA}.tar.gz\n ---> Running in 6225954667c4\nRemoving intermediate container 6225954667c4\n ---> e5bff52bc1bf\nStep 5/27 : RUN wget ${SHUNIT2_URL} -qO shunit2.tar.gz\n ---> Running in 47bf96ad6fb0\nRemoving intermediate container 47bf96ad6fb0\n ---> a3dc7559d9db\nStep 6/27 : RUN tar xzf shunit2.tar.gz && mv shunit2-* shunit2\n ---> Running in 7acfbf61bcff\nRemoving intermediate container 7acfbf61bcff\n ---> f6e82a57d7f6\nStep 7/27 : FROM kcov/kcov:v40 AS kcov\n ---> 6d40146c9b53\nStep 8/27 : RUN useradd -ms /bin/sh shpy\n ---> Running in 8e56cba76847\nRemoving intermediate container 8e56cba76847\n ---> dceaaef51bc4\nStep 9/27 : ENV SHPY_PATH /shpy/shpy\n ---> Running in eb4a98dcdc9b\nRemoving intermediate container eb4a98dcdc9b\n ---> 962675f63383\nStep 10/27 : COPY --from=shunit --chown=shpy /shunit2/shunit2 /usr/local/bin/shunit2\n ---> 6cd329e21114\nStep 11/27 : RUN mkdir /shpy /app /coverage && chown shpy:shpy /shpy /app /coverage\n ---> Running in 6c9c91ff46e4\nRemoving intermediate container 6c9c91ff46e4\n ---> 7c62348328e9\nStep 12/27 : USER shpy\n ---> Running in b2fbe112a212\nRemoving intermediate container b2fbe112a212\n ---> 9fad35e81a54\nStep 13/27 : COPY --chown=shpy ./ /shpy/\n ---> f63d6104451b\nStep 14/27 : WORKDIR /app/\n ---> Running in f7f3f3f0d09f\nRemoving intermediate container f7f3f3f0d09f\n ---> 51cb2c9c62ff\nStep 15/27 : CMD [\"/bin/sh\"]\n ---> Running in 049e1a5f3023\nRemoving intermediate container 049e1a5f3023\n ---> 453bbc3f06b4\nStep 16/27 : FROM alpine:3.16.2 AS shpy\n ---> 9c6f07244728\nStep 17/27 : RUN echo 'http://dl-cdn.alpinelinux.org/alpine/edge/community' >> /etc/apk/repositories\n ---> Running in b8b040fdacc6\nRemoving intermediate container b8b040fdacc6\n ---> b3c36013471c\nStep 18/27 : RUN apk --no-cache add --update-cache       ncurses curl checkbashisms bash dash mksh zsh\n ---> Running in a793aa87ed3d\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.16/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.16/community/x86_64/APKINDEX.tar.gz\nfetch http://dl-cdn.alpinelinux.org/alpine/edge/community/x86_64/APKINDEX.tar.gz\n(1/19) Installing ncurses-terminfo-base (6.3_p20220521-r0)\n(2/19) Installing ncurses-libs (6.3_p20220521-r0)\n(3/19) Installing readline (8.1.2-r0)\n(4/19) Installing bash (5.1.16-r2)\nExecuting bash-5.1.16-r2.post-install\n(5/19) Installing libbz2 (1.0.8-r1)\n(6/19) Installing perl (5.34.1-r0)\n(7/19) Installing checkbashisms (2.22.1-r0)\n(8/19) Installing ca-certificates (20220614-r0)\n(9/19) Installing brotli-libs (1.0.9-r6)\n(10/19) Installing nghttp2-libs (1.47.0-r0)\n(11/19) Installing libcurl (7.83.1-r5)\n(12/19) Installing curl (7.83.1-r5)\n(13/19) Installing dash (0.5.11.5-r1)\nExecuting dash-0.5.11.5-r1.post-install\n(14/19) Installing mksh (59c-r3)\nExecuting mksh-59c-r3.post-install\n(15/19) Installing ncurses (6.3_p20220521-r0)\n(16/19) Installing libcap (2.64-r0)\n(17/19) Installing zsh (5.8.1-r4)\nExecuting zsh-5.8.1-r4.post-install\n(18/19) Installing apk-tools-zsh-completion (2.12.9-r3)\n(19/19) Installing curl-zsh-completion (7.83.1-r5)\nExecuting busybox-1.35.0-r17.trigger\nExecuting ca-certificates-20220614-r0.trigger\nOK: 55 MiB in 33 packages\nRemoving intermediate container a793aa87ed3d\n ---> cd08f6cb5767\nStep 19/27 : RUN addgroup -S shpy && adduser -S shpy -G shpy\n ---> Running in 57ee1d4e9a7d\nRemoving intermediate container 57ee1d4e9a7d\n ---> 2442ddd49324\nStep 20/27 : ENV SHPY_PATH /shpy/shpy\n ---> Running in 9dd6df81fd12\nRemoving intermediate container 9dd6df81fd12\n ---> 1432fcbc3695\nStep 21/27 : COPY --from=shellcheck --chown=shpy /bin/shellcheck /usr/local/bin/shellcheck\n ---> c615ac49e159\nStep 22/27 : COPY --from=shunit --chown=shpy /shunit2/shunit2 /usr/local/bin/shunit2\n ---> a2ef79c297f2\nStep 23/27 : RUN mkdir /shpy/ /app/ && chown shpy:shpy /shpy/ /app/\n ---> Running in 0c1d5d792e65\nRemoving intermediate container 0c1d5d792e65\n ---> 548f1edc81f7\nStep 24/27 : USER shpy\n ---> Running in fbe15e0d2185\nRemoving intermediate container fbe15e0d2185\n ---> 7c587492aa1e\nStep 25/27 : COPY --chown=shpy ./ /shpy/\n ---> d9a217adede5\nStep 26/27 : WORKDIR /app/\n ---> Running in f0214324839d\nRemoving intermediate container f0214324839d\n ---> 0fcc1a183f54\nStep 27/27 : CMD [\"/bin/sh\"]\n ---> Running in 4dcbcad7a014\nRemoving intermediate container 4dcbcad7a014\n ---> ac7c8f6a5400\nSuccessfully built ac7c8f6a5400\nSuccessfully tagged shpy:latest\n","stderr":"","imageSize":56762040},"endTime":1672108689656}