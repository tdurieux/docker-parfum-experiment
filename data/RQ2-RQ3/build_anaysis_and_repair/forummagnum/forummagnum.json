{"repository":"https://github.com/forummagnum/forummagnum","dockerfilePath":"Dockerfile","startTime":1672400602083,"clone":{"stdout":"","stderr":"Cloning into '/tmp/dinghy-analysis/forummagnum/forummagnum'...\n","error":null,"commit":"8648a495708ad6f3e5d0ccf715d982c0db6e7ad5"},"originalBuild":{"startTimestamp":1672400604570,"endTimestamp":1672400819071,"error":null,"stdout":"Sending build context to Docker daemon  21.79MB\r\r\nStep 1/13 : FROM node:18.12.0\n18.12.0: Pulling from library/node\n17c9e6141fdb: Pulling fs layer\nde4a4c6caea8: Pulling fs layer\n4edced8587e6: Pulling fs layer\na7969cffbf46: Pulling fs layer\n74fbfde6af91: Pulling fs layer\nbabbacf2d498: Pulling fs layer\neaf610e4dd04: Pulling fs layer\nd62e34f55428: Pulling fs layer\n40358abcfcbb: Pulling fs layer\neaf610e4dd04: Waiting\nd62e34f55428: Waiting\na7969cffbf46: Waiting\nbabbacf2d498: Waiting\n40358abcfcbb: Waiting\n74fbfde6af91: Waiting\nde4a4c6caea8: Verifying Checksum\nde4a4c6caea8: Download complete\n4edced8587e6: Verifying Checksum\n4edced8587e6: Download complete\n17c9e6141fdb: Verifying Checksum\n17c9e6141fdb: Download complete\nbabbacf2d498: Verifying Checksum\nbabbacf2d498: Download complete\na7969cffbf46: Verifying Checksum\na7969cffbf46: Download complete\neaf610e4dd04: Verifying Checksum\neaf610e4dd04: Download complete\n40358abcfcbb: Verifying Checksum\n40358abcfcbb: Download complete\nd62e34f55428: Verifying Checksum\nd62e34f55428: Download complete\n74fbfde6af91: Verifying Checksum\n74fbfde6af91: Download complete\n17c9e6141fdb: Pull complete\nde4a4c6caea8: Pull complete\n4edced8587e6: Pull complete\na7969cffbf46: Pull complete\n74fbfde6af91: Pull complete\nbabbacf2d498: Pull complete\neaf610e4dd04: Pull complete\nd62e34f55428: Pull complete\n40358abcfcbb: Pull complete\nDigest: sha256:cef9966b19672effeafcf1a67b8add742c3e46ca7dd5532efff60820526c2e95\nStatus: Downloaded newer image for node:18.12.0\n ---> b952e6a232d0\nStep 2/13 : ENV IS_DOCKER=true\n ---> Running in d59207b00269\nRemoving intermediate container d59207b00269\n ---> 4752686df691\nStep 3/13 : RUN apt-get update && apt-get install -y bsdmainutils\n ---> Running in 3c7daacbeb7a\nGet:1 http://deb.debian.org/debian bullseye InRelease [116 kB]\nGet:2 http://deb.debian.org/debian-security bullseye-security InRelease [48.4 kB]\nGet:3 http://deb.debian.org/debian bullseye-updates InRelease [44.1 kB]\nGet:4 http://deb.debian.org/debian bullseye/main amd64 Packages [8183 kB]\nGet:5 http://deb.debian.org/debian-security bullseye-security/main amd64 Packages [210 kB]\nGet:6 http://deb.debian.org/debian bullseye-updates/main amd64 Packages [14.6 kB]\nFetched 8616 kB in 1s (6663 kB/s)\nReading package lists...\nReading package lists...\nBuilding dependency tree...\nReading state information...\nThe following additional packages will be installed:\n  bsdextrautils ncal\nSuggested packages:\n  calendar whois vacation mailutils\nThe following NEW packages will be installed:\n  bsdextrautils bsdmainutils ncal\n0 upgraded, 3 newly installed, 0 to remove and 29 not upgraded.\nNeed to get 192 kB of archives.\nAfter this operation, 490 kB of additional disk space will be used.\nGet:1 http://deb.debian.org/debian bullseye/main amd64 bsdextrautils amd64 2.36.1-8+deb11u1 [145 kB]\nGet:2 http://deb.debian.org/debian bullseye/main amd64 ncal amd64 12.1.7+nmu3 [30.1 kB]\nGet:3 http://deb.debian.org/debian bullseye/main amd64 bsdmainutils all 12.1.7+nmu3 [16.4 kB]\n\u001b[91mdebconf: delaying package configuration, since apt-utils is not installed\n\u001b[0mFetched 192 kB in 0s (1540 kB/s)\nSelecting previously unselected package bsdextrautils.\r\n(Reading database ... \r(Reading database ... 5%\r(Reading database ... 10%\r(Reading database ... 15%\r(Reading database ... 20%\r(Reading database ... 25%\r(Reading database ... 30%\r(Reading database ... 35%\r(Reading database ... 40%\r(Reading database ... 45%\r(Reading database ... 50%\r(Reading database ... 55%\r(Reading database ... 60%\r(Reading database ... 65%\r(Reading database ... 70%\r(Reading database ... 75%\r(Reading database ... 80%\r(Reading database ... 85%\r(Reading database ... 90%\r(Reading database ... 95%\r(Reading database ... 100%\r(Reading database ... 22790 files and directories currently installed.)\r\nPreparing to unpack .../bsdextrautils_2.36.1-8+deb11u1_amd64.deb ...\r\nUnpacking bsdextrautils (2.36.1-8+deb11u1) ...\r\nSelecting previously unselected package ncal.\r\nPreparing to unpack .../ncal_12.1.7+nmu3_amd64.deb ...\r\nUnpacking ncal (12.1.7+nmu3) ...\r\nSelecting previously unselected package bsdmainutils.\r\nPreparing to unpack .../bsdmainutils_12.1.7+nmu3_all.deb ...\r\nUnpacking bsdmainutils (12.1.7+nmu3) ...\r\nSetting up bsdextrautils (2.36.1-8+deb11u1) ...\r\nupdate-alternatives: using /usr/bin/write.ul to provide /usr/bin/write (write) in auto mode\r\nSetting up ncal (12.1.7+nmu3) ...\r\nSetting up bsdmainutils (12.1.7+nmu3) ...\r\nRemoving intermediate container 3c7daacbeb7a\n ---> 0d1970c02abe\nStep 4/13 : RUN curl -sSLo /usr/local/bin/transcrypt https://raw.githubusercontent.com/elasticdog/transcrypt/2f905dce485114fec10fb747443027c0f9119caa/transcrypt && chmod +x /usr/local/bin/transcrypt\n ---> Running in 111da2cbe12c\nRemoving intermediate container 111da2cbe12c\n ---> 60e67bd69490\nStep 5/13 : WORKDIR /usr/src/app\n ---> Running in 1a9cfd678d0d\nRemoving intermediate container 1a9cfd678d0d\n ---> 537c98e25add\nStep 6/13 : COPY package.json package.json\n ---> 17f13e7830a8\nStep 7/13 : COPY yarn.lock yarn.lock\n ---> c51d71414c2e\nStep 8/13 : COPY public/lesswrong-editor public/lesswrong-editor\n ---> ebd231aa1746\nStep 9/13 : COPY scripts/postinstall.sh scripts/postinstall.sh\n ---> feac1b2693bd\nStep 10/13 : RUN yarn install && yarn cache clean\n ---> Running in 0bf68e532366\nyarn install v1.22.19\n\u001b[91mwarning package.json: No license field\n\u001b[0m\u001b[91mwarning lesswrong@2.1.0: No license field\n\u001b[0m[1/5] Validating package.json...\n\u001b[91mwarning lesswrong@2.1.0: No license field\n\u001b[0m[2/5] Resolving packages...\n[3/5] Fetching packages...\n[4/5] Linking dependencies...\n\u001b[91mwarning \" > draft-js-markdown-shortcuts-plugin@0.3.0\" has incorrect peer dependency \"draft-js-plugins-editor@~2.0.0-rc.1 || 2.0.0-rc2 || 2.0.0-rc1 || 2.0.0-beta12\".\nwarning \" > draft-js-markdown-shortcuts-plugin@0.3.0\" has incorrect peer dependency \"react@^15.0.0\".\nwarning \" > draft-js-markdown-shortcuts-plugin@0.3.0\" has incorrect peer dependency \"react-dom@^15.0.0\".\n\u001b[0m\u001b[91mwarning \" > draft-js-mathjax-plugin@1.3.4\" has unmet peer dependency \"immutable@^3.8.1\".\n\u001b[0m\u001b[91mwarning \" > graphql-server-express@0.6.0\" has incorrect peer dependency \"graphql@^0.8.0 || ^0.9.0\".\nwarning \"graphql-server-express > graphql-server-core@0.6.0\" has incorrect peer dependency \"graphql@^0.8.0 || ^0.9.0\".\n\u001b[0m\u001b[91mwarning \"react-instantsearch > react-instantsearch-native@6.8.2\" has unmet peer dependency \"react-native@>= 0.54.0\".\n\u001b[0m\u001b[91mwarning \" > react-no-ssr@1.1.0\" has incorrect peer dependency \"react@^0.14.0 || ^15.0.0\".\n\u001b[0m\u001b[91mwarning \" > esbuild-loader@2.6.1\" has unmet peer dependency \"webpack@^4.40.0 || ^5.0.0\".\n\u001b[0m\u001b[91mwarning \" > ts-loader@8.0.11\" has unmet peer dependency \"webpack@*\".\n\u001b[0m[5/5] Building fresh packages...\n$ scripts/postinstall.sh\nChecking for node... v18.12.0\nChecking for yarn... 1.22.19\nChecking for mongodb... not found\n`mongod` is not installed. You can run LessWrong by connecting to a remote\ndatabase, but you probably want a local server for testing.\nSee https://docs.mongodb.com/manual/installation/\n\nChecking for curl... yes\nChecking for perl... yes\nCreating settings.json\n\u001b[91mcp: cannot stat 'sample_settings.json': No such file or directory\n\u001b[0mCreating settings-dev.json\n\u001b[91mcp: cannot stat 'sample_settings.json': No such file or directory\n\u001b[0mChecking system file-watchers limit... 8192\nFor automatic rebuilds to work, you may need to increase the system maximum number\nof files watched for changes. You can do this temporarily (until next reboot) with:\n    sudo sysctl -w fs.inotify.max_user_watches=100000\nand make this permanent with:\n    sudo bash -c 'echo fs.inotify.max_user_watches=100000 >>/etc/sysctl.d/10-user-watches.conf'\nDone in 94.94s.\nyarn cache v1.22.19\n\u001b[91mwarning package.json: No license field\n\u001b[0msuccess Cleared cache.\nDone in 4.13s.\nRemoving intermediate container 0bf68e532366\n ---> 12ce78fb20b0\nStep 11/13 : COPY . .\n ---> 7ddde1ffb0b0\nStep 12/13 : EXPOSE 8080\n ---> Running in a68df93d729a\nRemoving intermediate container a68df93d729a\n ---> ff2418de1848\nStep 13/13 : CMD [ \"yarn\", \"run\", \"production\" ]\n ---> Running in cd3c1dda171a\nRemoving intermediate container cd3c1dda171a\n ---> 1fa1dba1fecc\nSuccessfully built 1fa1dba1fecc\nSuccessfully tagged forummagnum:latest\n","stderr":"","imageSize":2413972637},"repair":{"violations":[{"name":"curlUseFlagF","position":{"start":6,"end":6,"columnStart":4,"columnEnd":148}},{"name":"ruleAptGetInstallUseNoRec","position":{"start":4,"end":4,"columnStart":22,"columnEnd":53}},{"name":"ruleAptGetInstallThenRemoveAptLists","position":{"start":4,"end":4,"columnStart":22,"columnEnd":53}}],"repairedDockerfile":"# Node 18.12 is LTS\nFROM node:18.12.0\nENV IS_DOCKER=true\n# Transcrypt dependency\nRUN apt-get update && apt-get install --no-install-recommends -y bsdmainutils\n# Install transcrypt for EA Forum\nRUN curl -f -sSLo /usr/local/bin/transcrypt https://raw.githubusercontent.com/elasticdog/transcrypt/2f905dce485114fec10fb747443027c0f9119caa/transcrypt && chmod +x /usr/local/bin/transcrypt\nWORKDIR /usr/src/app\n# Copy only files necessary for yarn install, to avoid spurious changes\n# triggering re-install\nCOPY package.json package.json\nCOPY yarn.lock yarn.lock\nCOPY public/lesswrong-editor public/lesswrong-editor\nCOPY scripts/postinstall.sh scripts/postinstall.sh\n# clear the cache -- it's not useful and it adds to the time docker takes to\n# save the layer diff\nRUN yarn install && yarn cache clean\nCOPY . .\nEXPOSE 8080\nCMD [ \"yarn\", \"run\", \"production\" ]\n"},"repairedBuild":{"startTimestamp":1672400821260,"endTimestamp":1672401000910,"error":null,"stdout":"Sending build context to Docker daemon  21.79MB\r\r\nStep 1/13 : FROM node:18.12.0\n ---> b952e6a232d0\nStep 2/13 : ENV IS_DOCKER=true\n ---> Running in b46f37518ef5\nRemoving intermediate container b46f37518ef5\n ---> 4b27256cb6f0\nStep 3/13 : RUN apt-get update && apt-get install --no-install-recommends -y bsdmainutils\n ---> Running in 0f409e5fbc45\nGet:1 http://deb.debian.org/debian bullseye InRelease [116 kB]\nGet:2 http://deb.debian.org/debian-security bullseye-security InRelease [48.4 kB]\nGet:3 http://deb.debian.org/debian bullseye-updates InRelease [44.1 kB]\nGet:4 http://deb.debian.org/debian bullseye/main amd64 Packages [8183 kB]\nGet:5 http://deb.debian.org/debian-security bullseye-security/main amd64 Packages [210 kB]\nGet:6 http://deb.debian.org/debian bullseye-updates/main amd64 Packages [14.6 kB]\nFetched 8616 kB in 1s (6912 kB/s)\nReading package lists...\nReading package lists...\nBuilding dependency tree...\nReading state information...\nThe following additional packages will be installed:\n  bsdextrautils ncal\nSuggested packages:\n  calendar whois vacation mailutils\nThe following NEW packages will be installed:\n  bsdextrautils bsdmainutils ncal\n0 upgraded, 3 newly installed, 0 to remove and 29 not upgraded.\nNeed to get 192 kB of archives.\nAfter this operation, 490 kB of additional disk space will be used.\nGet:1 http://deb.debian.org/debian bullseye/main amd64 bsdextrautils amd64 2.36.1-8+deb11u1 [145 kB]\nGet:2 http://deb.debian.org/debian bullseye/main amd64 ncal amd64 12.1.7+nmu3 [30.1 kB]\nGet:3 http://deb.debian.org/debian bullseye/main amd64 bsdmainutils all 12.1.7+nmu3 [16.4 kB]\n\u001b[91mdebconf: delaying package configuration, since apt-utils is not installed\n\u001b[0mFetched 192 kB in 0s (2669 kB/s)\nSelecting previously unselected package bsdextrautils.\r\n(Reading database ... \r(Reading database ... 5%\r(Reading database ... 10%\r(Reading database ... 15%\r(Reading database ... 20%\r(Reading database ... 25%\r(Reading database ... 30%\r(Reading database ... 35%\r(Reading database ... 40%\r(Reading database ... 45%\r(Reading database ... 50%\r(Reading database ... 55%\r(Reading database ... 60%\r(Reading database ... 65%\r(Reading database ... 70%\r(Reading database ... 75%\r(Reading database ... 80%\r(Reading database ... 85%\r(Reading database ... 90%\r(Reading database ... 95%\r(Reading database ... 100%\r(Reading database ... 22790 files and directories currently installed.)\r\nPreparing to unpack .../bsdextrautils_2.36.1-8+deb11u1_amd64.deb ...\r\nUnpacking bsdextrautils (2.36.1-8+deb11u1) ...\r\nSelecting previously unselected package ncal.\r\nPreparing to unpack .../ncal_12.1.7+nmu3_amd64.deb ...\r\nUnpacking ncal (12.1.7+nmu3) ...\r\nSelecting previously unselected package bsdmainutils.\r\nPreparing to unpack .../bsdmainutils_12.1.7+nmu3_all.deb ...\r\nUnpacking bsdmainutils (12.1.7+nmu3) ...\r\nSetting up bsdextrautils (2.36.1-8+deb11u1) ...\r\nupdate-alternatives: using /usr/bin/write.ul to provide /usr/bin/write (write) in auto mode\r\nSetting up ncal (12.1.7+nmu3) ...\r\nSetting up bsdmainutils (12.1.7+nmu3) ...\r\nRemoving intermediate container 0f409e5fbc45\n ---> 43b8c18070dc\nStep 4/13 : RUN curl -f -sSLo /usr/local/bin/transcrypt https://raw.githubusercontent.com/elasticdog/transcrypt/2f905dce485114fec10fb747443027c0f9119caa/transcrypt && chmod +x /usr/local/bin/transcrypt\n ---> Running in 7fcaa5316f56\nRemoving intermediate container 7fcaa5316f56\n ---> 6e6c512fdbba\nStep 5/13 : WORKDIR /usr/src/app\n ---> Running in 8a961eda8ad2\nRemoving intermediate container 8a961eda8ad2\n ---> 96bdc75d2de4\nStep 6/13 : COPY package.json package.json\n ---> d3c159656ad1\nStep 7/13 : COPY yarn.lock yarn.lock\n ---> f0718d51ff53\nStep 8/13 : COPY public/lesswrong-editor public/lesswrong-editor\n ---> 64c4ee409409\nStep 9/13 : COPY scripts/postinstall.sh scripts/postinstall.sh\n ---> 63c761f20638\nStep 10/13 : RUN yarn install && yarn cache clean\n ---> Running in ae28c51294f0\nyarn install v1.22.19\n\u001b[91mwarning package.json: No license field\n\u001b[0m\u001b[91mwarning lesswrong@2.1.0: No license field\n\u001b[0m[1/5] Validating package.json...\n\u001b[91mwarning lesswrong@2.1.0: No license field\n\u001b[0m[2/5] Resolving packages...\n[3/5] Fetching packages...\n[4/5] Linking dependencies...\n\u001b[91mwarning \" > draft-js-markdown-shortcuts-plugin@0.3.0\" has incorrect peer dependency \"draft-js-plugins-editor@~2.0.0-rc.1 || 2.0.0-rc2 || 2.0.0-rc1 || 2.0.0-beta12\".\nwarning \" > draft-js-markdown-shortcuts-plugin@0.3.0\" has incorrect peer dependency \"react@^15.0.0\".\nwarning \" > draft-js-markdown-shortcuts-plugin@0.3.0\" has incorrect peer dependency \"react-dom@^15.0.0\".\n\u001b[0m\u001b[91mwarning \" > draft-js-mathjax-plugin@1.3.4\" has unmet peer dependency \"immutable@^3.8.1\".\n\u001b[0m\u001b[91mwarning \" > graphql-server-express@0.6.0\" has incorrect peer dependency \"graphql@^0.8.0 || ^0.9.0\".\n\u001b[0m\u001b[91mwarning \"graphql-server-express > graphql-server-core@0.6.0\" has incorrect peer dependency \"graphql@^0.8.0 || ^0.9.0\".\n\u001b[0m\u001b[91mwarning \"react-instantsearch > react-instantsearch-native@6.8.2\" has unmet peer dependency \"react-native@>= 0.54.0\".\nwarning \" > react-no-ssr@1.1.0\" has incorrect peer dependency \"react@^0.14.0 || ^15.0.0\".\n\u001b[0m\u001b[91mwarning \" > esbuild-loader@2.6.1\" has unmet peer dependency \"webpack@^4.40.0 || ^5.0.0\".\n\u001b[0m\u001b[91mwarning \" > ts-loader@8.0.11\" has unmet peer dependency \"webpack@*\".\n\u001b[0m[5/5] Building fresh packages...\n$ scripts/postinstall.sh\nChecking for node... v18.12.0\nChecking for yarn... 1.22.19\nChecking for mongodb... not found\n`mongod` is not installed. You can run LessWrong by connecting to a remote\ndatabase, but you probably want a local server for testing.\nSee https://docs.mongodb.com/manual/installation/\n\nChecking for curl... yes\nChecking for perl... yes\nCreating settings.json\n\u001b[91mcp: cannot stat 'sample_settings.json': No such file or directory\n\u001b[0mCreating settings-dev.json\n\u001b[91mcp: cannot stat 'sample_settings.json': No such file or directory\n\u001b[0mChecking system file-watchers limit... 8192\nFor automatic rebuilds to work, you may need to increase the system maximum number\nof files watched for changes. You can do this temporarily (until next reboot) with:\n    sudo sysctl -w fs.inotify.max_user_watches=100000\nand make this permanent with:\n    sudo bash -c 'echo fs.inotify.max_user_watches=100000 >>/etc/sysctl.d/10-user-watches.conf'\nDone in 97.32s.\nyarn cache v1.22.19\n\u001b[91mwarning package.json: No license field\n\u001b[0msuccess Cleared cache.\nDone in 4.26s.\nRemoving intermediate container ae28c51294f0\n ---> 57bb7a9970f0\nStep 11/13 : COPY . .\n ---> 4dcddf190b14\nStep 12/13 : EXPOSE 8080\n ---> Running in 0f5f7a56cc25\nRemoving intermediate container 0f5f7a56cc25\n ---> 8d21c9433def\nStep 13/13 : CMD [ \"yarn\", \"run\", \"production\" ]\n ---> Running in b99b9eacefce\nRemoving intermediate container b99b9eacefce\n ---> 25c62c52e516\nSuccessfully built 25c62c52e516\nSuccessfully tagged forummagnum:latest\n","stderr":"","imageSize":2413972685},"endTime":1672401002951}