{"repository":"https://github.com/bengarrett/dosee","dockerfilePath":"Dockerfile","startTime":1672674296607,"clone":{"stdout":"","stderr":"Cloning into '/tmp/dinghy-analysis/bengarrett/dosee'...\n","error":null,"commit":"348c107d61873952fa903712d8d6c4ce771a0d6a"},"originalBuild":{"startTimestamp":1672674299371,"endTimestamp":1672674374337,"error":null,"stdout":"Sending build context to Docker daemon  43.98MB\r\r\nStep 1/9 : FROM node:current-alpine AS build\ncurrent-alpine: Pulling from library/node\nc158987b0551: Already exists\n27ae9ce8b069: Pulling fs layer\nab5501735aae: Pulling fs layer\n9ce0a5833ea2: Pulling fs layer\n9ce0a5833ea2: Download complete\nab5501735aae: Verifying Checksum\nab5501735aae: Download complete\n27ae9ce8b069: Verifying Checksum\n27ae9ce8b069: Download complete\n27ae9ce8b069: Pull complete\nab5501735aae: Pull complete\n9ce0a5833ea2: Pull complete\nDigest: sha256:3ed634e0f15d3e05a1918c3949963508f7ed56350cf94156e6d804ae577849fa\nStatus: Downloaded newer image for node:current-alpine\n ---> f01bef8b5e92\nStep 2/9 : RUN apk update &&      apk add --update yarn &&     npm update --global npm\n ---> Running in 907d040c0762\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/community/x86_64/APKINDEX.tar.gz\nv3.17.0-320-g38723e0931 [https://dl-cdn.alpinelinux.org/alpine/v3.17/main]\nv3.17.0-320-g38723e0931 [https://dl-cdn.alpinelinux.org/alpine/v3.17/community]\nOK: 17813 distinct packages available\n(1/8) Installing ca-certificates (20220614-r3)\n(2/8) Installing brotli-libs (1.0.9-r9)\n(3/8) Installing c-ares (1.18.1-r1)\n(4/8) Installing icu-data-en (72.1-r1)\nExecuting icu-data-en-72.1-r1.post-install\n\u001b[91m*\n* If you need ICU with non-English locales and legacy charset support, install\n* package icu-data-full.\n*\n\u001b[0m(5/8) Installing icu-libs (72.1-r1)\n(6/8) Installing nghttp2-libs (1.51.0-r0)\n(7/8) Installing nodejs (18.12.1-r0)\n(8/8) Installing yarn (1.22.19-r0)\nExecuting busybox-1.35.0-r29.trigger\nExecuting ca-certificates-20220614-r3.trigger\nOK: 59 MiB in 25 packages\n\nchanged 15 packages in 17s\n\n14 packages are looking for funding\n  run `npm fund` for details\nRemoving intermediate container 907d040c0762\n ---> 30e88271bd46\nStep 3/9 : COPY . /dosee\n ---> bef5523be632\nStep 4/9 : WORKDIR /dosee\n ---> Running in a08e1dbe0d9d\nRemoving intermediate container a08e1dbe0d9d\n ---> 4abb3be51fd5\nStep 5/9 : RUN yarn install --audit --production\n ---> Running in ee6152b979dc\nyarn install v1.22.19\ninfo No lockfile found.\n[1/5] Resolving packages...\n\u001b[91mwarning workbox-cli > workbox-build > rollup-plugin-terser@7.0.2: This package has been deprecated and is no longer maintained. Please use @rollup/plugin-terser\n\u001b[0m\u001b[91mwarning workbox-cli > workbox-build > @rollup/plugin-replace > magic-string > sourcemap-codec@1.4.8: Please use @jridgewell/sourcemap-codec instead\n\u001b[0m[2/5] Auditing packages...\n[3/5] Fetching packages...\n[4/5] Linking dependencies...\n[5/5] Building fresh packages...\n1 vulnerabilities found - Packages audited: 593\nSeverity: 1 Moderate\n\u001b[91mwarning Security audit found potential problems. Run \"yarn audit\" for additional details.\n\u001b[0msuccess Saved lockfile.\n$ npm run copy && npx workbox injectManifest workbox-config.js\n\n> dosee@1.8.0 copy\n> npx copyfiles -u 1 src/**/**/* src/**/* src/* build && npx copyup -f node_modules/workbox-sw/build/workbox-sw.js build/js && npx copyup -f node_modules/mini.css/dist/mini-default.min.css build/css && npx copyup -f node_modules/browserfs/dist/browserfs.min.js node_modules/browserfs-zipfs-extras/dist/browserfs-zipfs-extras.js node_modules/file-saver-fixed/dist/FileSaver.min.js node_modules/canvas-toBlob/canvas-toBlob.js build/js\n\nUsing configuration from /dosee/workbox-config.js.\nThe service worker file was written to build/sw.js\nThe service worker will precache 43 URLs, totaling 28.2 MB.\nDone in 20.03s.\nRemoving intermediate container ee6152b979dc\n ---> 11c49e47c9e4\nStep 6/9 : FROM nginx:stable-alpine\nstable-alpine: Pulling from library/nginx\nca7dd9ec2225: Already exists\n33c6b9f4e775: Pulling fs layer\n41718ec56cb6: Pulling fs layer\n9a2b3c874906: Pulling fs layer\n71a3f979d23b: Pulling fs layer\na2f02aac7fab: Pulling fs layer\n71a3f979d23b: Waiting\na2f02aac7fab: Waiting\n41718ec56cb6: Verifying Checksum\n41718ec56cb6: Download complete\n9a2b3c874906: Verifying Checksum\n9a2b3c874906: Download complete\n33c6b9f4e775: Verifying Checksum\n33c6b9f4e775: Download complete\na2f02aac7fab: Verifying Checksum\na2f02aac7fab: Download complete\n71a3f979d23b: Verifying Checksum\n71a3f979d23b: Download complete\n33c6b9f4e775: Pull complete\n41718ec56cb6: Pull complete\n9a2b3c874906: Pull complete\n71a3f979d23b: Pull complete\na2f02aac7fab: Pull complete\nDigest: sha256:2366ede62d2e26a20f7ce7d0294694fe52b166107fd346894e4658dfb5273f9c\nStatus: Downloaded newer image for nginx:stable-alpine\n ---> c31fe73098ae\nStep 7/9 : LABEL net.dosee.description=\"DOSee an MS-DOS emulator for the web\"\n ---> Running in 952b6454d1ed\nRemoving intermediate container 952b6454d1ed\n ---> 16c4701a4ad0\nStep 8/9 : RUN rm /usr/share/nginx/html/*\n ---> Running in 07148d06ff3b\nRemoving intermediate container 07148d06ff3b\n ---> c729bb27ff72\nStep 9/9 : COPY --from=build /dosee/build/ /usr/share/nginx/html\n ---> 1b458a707bd2\nSuccessfully built 1b458a707bd2\nSuccessfully tagged dosee:latest\n","stderr":"","imageSize":51693593},"repair":{"violations":[{"name":"apkAddUseNoCache","position":{"start":23,"end":23,"columnStart":4,"columnEnd":25}}],"repairedDockerfile":"# DOSee Dockerfile\n#\n# Instructions for use:\n#\n# docker build -t dosee .\n# docker run --name dosee_app -i -p 8086:80 dosee\n#\n# docker build --tag dosee:latest .\n# docker run --name dosee_app --interactive --publish 8086:80 dosee:latest\n#\n#\n# To remove and cleanup:\n#\n# docker stop dosee_app\n# docker container rm dosee_app\n# docker image rm dosee\n\n# Multi-stage Docker build to reduce the overall image size\n# DOSee will be built in this temporary Node.JS image\nFROM node:current-alpine AS build\n\n# Install and update the build dependencies\nRUN apk update && \\\n    apk add --no-cache --update yarn && \\\n    npm update --global npm\n\n# Copy source files\nCOPY . /dosee\n\n# Compile and build DOSee\nWORKDIR /dosee\nRUN yarn install --audit --production\n\n# DOSee will be served on this permanent nginx image\n# It should only ammount to around 50 MB in size\n# The nginx stable image is used due to its less frequent updates\nFROM nginx:stable-alpine\nLABEL net.dosee.description=\"DOSee an MS-DOS emulator for the web\"\n\n# Copy DOSee from the build image to the nginx webroot\nRUN rm /usr/share/nginx/html/*\nCOPY --from=build /dosee/build/ /usr/share/nginx/html\n"},"repairedBuild":{"startTimestamp":1672674374621,"endTimestamp":1672674438676,"error":null,"stdout":"Sending build context to Docker daemon  43.98MB\r\r\nStep 1/9 : FROM node:current-alpine AS build\n ---> f01bef8b5e92\nStep 2/9 : RUN apk update &&     apk add --no-cache --update yarn &&     npm update --global npm\n ---> Running in a834fa8565b4\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/community/x86_64/APKINDEX.tar.gz\nv3.17.0-320-g38723e0931 [https://dl-cdn.alpinelinux.org/alpine/v3.17/main]\nv3.17.0-320-g38723e0931 [https://dl-cdn.alpinelinux.org/alpine/v3.17/community]\nOK: 17813 distinct packages available\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/community/x86_64/APKINDEX.tar.gz\n(1/8) Installing ca-certificates (20220614-r3)\n(2/8) Installing brotli-libs (1.0.9-r9)\n(3/8) Installing c-ares (1.18.1-r1)\n(4/8) Installing icu-data-en (72.1-r1)\nExecuting icu-data-en-72.1-r1.post-install\n\u001b[91m*\n* If you need ICU with non-English locales and legacy charset support, install\n* package icu-data-full.\n*\n\u001b[0m(5/8) Installing icu-libs (72.1-r1)\n(6/8) Installing nghttp2-libs (1.51.0-r0)\n(7/8) Installing nodejs (18.12.1-r0)\n(8/8) Installing yarn (1.22.19-r0)\nExecuting busybox-1.35.0-r29.trigger\nExecuting ca-certificates-20220614-r3.trigger\nOK: 59 MiB in 25 packages\n\nchanged 15 packages in 16s\n\n14 packages are looking for funding\n  run `npm fund` for details\nRemoving intermediate container a834fa8565b4\n ---> 2ddf7ca02a2f\nStep 3/9 : COPY . /dosee\n ---> e48627ed3852\nStep 4/9 : WORKDIR /dosee\n ---> Running in 751fec6ef0d0\nRemoving intermediate container 751fec6ef0d0\n ---> 9f900533b374\nStep 5/9 : RUN yarn install --audit --production\n ---> Running in c8a9eb5c217c\nyarn install v1.22.19\ninfo No lockfile found.\n[1/5] Resolving packages...\n\u001b[91mwarning workbox-cli > workbox-build > rollup-plugin-terser@7.0.2: This package has been deprecated and is no longer maintained. Please use @rollup/plugin-terser\n\u001b[0m\u001b[91mwarning workbox-cli > workbox-build > @surma/rollup-plugin-off-main-thread > magic-string > sourcemap-codec@1.4.8: Please use @jridgewell/sourcemap-codec instead\n\u001b[0m[2/5] Auditing packages...\n[3/5] Fetching packages...\n[4/5] Linking dependencies...\n[5/5] Building fresh packages...\n1 vulnerabilities found - Packages audited: 593\nSeverity: 1 Moderate\n\u001b[91mwarning Security audit found potential problems. Run \"yarn audit\" for additional details.\n\u001b[0msuccess Saved lockfile.\n$ npm run copy && npx workbox injectManifest workbox-config.js\n\n> dosee@1.8.0 copy\n> npx copyfiles -u 1 src/**/**/* src/**/* src/* build && npx copyup -f node_modules/workbox-sw/build/workbox-sw.js build/js && npx copyup -f node_modules/mini.css/dist/mini-default.min.css build/css && npx copyup -f node_modules/browserfs/dist/browserfs.min.js node_modules/browserfs-zipfs-extras/dist/browserfs-zipfs-extras.js node_modules/file-saver-fixed/dist/FileSaver.min.js node_modules/canvas-toBlob/canvas-toBlob.js build/js\n\nUsing configuration from /dosee/workbox-config.js.\nThe service worker file was written to build/sw.js\nThe service worker will precache 43 URLs, totaling 28.2 MB.\nDone in 23.33s.\nRemoving intermediate container c8a9eb5c217c\n ---> ba90177fab5d\nStep 6/9 : FROM nginx:stable-alpine\n ---> c31fe73098ae\nStep 7/9 : LABEL net.dosee.description=\"DOSee an MS-DOS emulator for the web\"\n ---> Running in a4657e72798f\nRemoving intermediate container a4657e72798f\n ---> 3e6314b452e4\nStep 8/9 : RUN rm /usr/share/nginx/html/*\n ---> Running in 41b5531e3865\nRemoving intermediate container 41b5531e3865\n ---> 22da838ddd59\nStep 9/9 : COPY --from=build /dosee/build/ /usr/share/nginx/html\n ---> 73d321495fed\nSuccessfully built 73d321495fed\nSuccessfully tagged dosee:latest\n","stderr":"","imageSize":51693593},"endTime":1672674438911}