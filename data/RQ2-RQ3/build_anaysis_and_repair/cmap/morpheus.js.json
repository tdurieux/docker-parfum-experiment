{"repository":"https://github.com/cmap/morpheus.js","dockerfilePath":"Dockerfile","startTime":1672619357808,"clone":{"stdout":"","stderr":"Cloning into '/tmp/dinghy-analysis/cmap/morpheus.js'...\n","error":null,"commit":"8331b8db8696d1bf3255da2261ac729bfc7ea66a"},"originalBuild":{"startTimestamp":1672619360126,"endTimestamp":1672619564449,"error":null,"stdout":"Sending build context to Docker daemon  91.05MB\r\r\nStep 1/18 : FROM node:14-alpine as builder\n14-alpine: Pulling from library/node\nc158987b0551: Already exists\n859c8d0e9faf: Pulling fs layer\n69c317f5cbe1: Pulling fs layer\nd0c4a6a4173f: Pulling fs layer\nd0c4a6a4173f: Verifying Checksum\nd0c4a6a4173f: Download complete\n69c317f5cbe1: Verifying Checksum\n69c317f5cbe1: Download complete\n859c8d0e9faf: Verifying Checksum\n859c8d0e9faf: Download complete\n859c8d0e9faf: Pull complete\n69c317f5cbe1: Pull complete\nd0c4a6a4173f: Pull complete\nDigest: sha256:80e825b1f5ab859498a2f0f98f8197131a562906e5f8c95977057502e68ca05a\nStatus: Downloaded newer image for node:14-alpine\n ---> fb7170aa2b9b\nStep 2/18 : LABEL stage=builder\n ---> Running in b42ed400cb49\nRemoving intermediate container b42ed400cb49\n ---> 6cc7577d6435\nStep 3/18 : ARG BUILD_DATE\n ---> Running in a58c14c81077\nRemoving intermediate container a58c14c81077\n ---> 4e6a997c9981\nStep 4/18 : ARG BUILD_VERSION=\"latest\"\n ---> Running in eb60036f75a7\nRemoving intermediate container eb60036f75a7\n ---> 5c98fb515679\nStep 5/18 : LABEL org.label-schema.name=\"morpheus.js\" \t  org.label-schema.description=\"morpheus.js is a container image that morpheus.js a javascript matrix visualization tool\" \t  org.label-schema.version=\"$BUILD_VERSION\" \t  org.label-schema.build-date=\"$BUILD_DATE\" \t  org.label-schema.license=\"BSD 3-Clause License\"       org.label-schema.schema-version=\"1.0\"\n ---> Running in c68a3d0c7f26\nRemoving intermediate container c68a3d0c7f26\n ---> 8ffc07b4b665\nStep 6/18 : COPY . /app\n ---> 5ae36527aedb\nStep 7/18 : WORKDIR /app\n ---> Running in e3b80753b7e9\nRemoving intermediate container e3b80753b7e9\n ---> 041fef983fd5\nStep 8/18 : RUN npm install\n ---> Running in 490715a3a33a\n\u001b[91mnpm WARN deprecated grunt-contrib-uglify-es@3.3.0: deprecated\n\u001b[0m\u001b[91mnpm WARN deprecated log4js@4.5.1: 4.x is no longer supported. Please upgrade to 6.x or higher.\n\u001b[0m\u001b[91mnpm WARN deprecated uglify-es@3.3.9: support for ECMAScript is superseded by `uglify-js` as of v3.13.0\n\u001b[0m\u001b[91mnpm WARN deprecated puppeteer@1.20.0: < 18.1.0 is no longer supported\n\u001b[0m\u001b[91mnpm WARN deprecated date-format@2.1.0: 2.x is no longer supported. Please upgrade to 4.x or higher.\n\u001b[0m\u001b[91mnpm WARN deprecated streamroller@1.0.6: 1.x is no longer supported. Please upgrade to 3.x or higher.\n\u001b[0m\u001b[91mnpm WARN deprecated node-fetch-npm@2.0.4: This module is not used anymore, npm uses minipass-fetch for its fetch implementation now\n\u001b[0m\n> puppeteer@1.20.0 install /app/node_modules/puppeteer\n> node install.js\n\n\u001b[91m\n\u001b[0mChromium downloaded to /app/node_modules/puppeteer/.local-chromium/linux-686378\n\u001b[91mnpm notice created a lockfile as package-lock.json. You should commit this file.\n\u001b[0m\u001b[91mnpm WARN optional\u001b[0m\u001b[91m SKIPPING OPTIONAL DEPENDENCY: fsevents@~2.3.2 (node_modules/chokidar/node_modules/fsevents):\n\u001b[0m\u001b[91mnpm WARN \u001b[0m\u001b[91mnotsup\u001b[0m\u001b[91m SKIPPING OPTIONAL DEPENDENCY: Unsupported platform for fsevents@2.3.2: wanted {\"os\":\"darwin\",\"arch\":\"any\"} (current: {\"os\":\"linux\",\"arch\":\"x64\"})\n\u001b[0m\u001b[91m\n\u001b[0madded 578 packages from 725 contributors and audited 579 packages in 21.613s\n\n28 packages are looking for funding\n  run `npm fund` for details\n\nfound 15 vulnerabilities (6 moderate, 5 high, 4 critical)\n  run `npm audit fix` to fix them, or `npm audit` for details\nRemoving intermediate container 490715a3a33a\n ---> 21d73f811a49\nStep 9/18 : FROM node:14-alpine as release\n ---> fb7170aa2b9b\nStep 10/18 : RUN apk add --no-cache tini\n ---> Running in e9939354a8e0\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/community/x86_64/APKINDEX.tar.gz\n(1/1) Installing tini (0.19.0-r1)\nExecuting busybox-1.35.0-r29.trigger\nOK: 10 MiB in 18 packages\nRemoving intermediate container e9939354a8e0\n ---> 6406b2703cbb\nStep 11/18 : ENV NODE_ENV=\"production\"\n ---> Running in e52fce0cda90\nRemoving intermediate container e52fce0cda90\n ---> 0316e0b53b30\nStep 12/18 : COPY --from=builder /app /app\n ---> 401c4b2732b7\nStep 13/18 : RUN addgroup -g 1001 -S appgroup && adduser -u 1001 -S appuser -G appgroup && chown -R appuser /app\n ---> Running in 8441f7a7c03e\nRemoving intermediate container 8441f7a7c03e\n ---> e711384538c4\nStep 14/18 : USER appuser\n ---> Running in 9170ebdc2ae9\nRemoving intermediate container 9170ebdc2ae9\n ---> 58d40bcd60c5\nStep 15/18 : WORKDIR /app\n ---> Running in 9c49923d25a6\nRemoving intermediate container 9c49923d25a6\n ---> 4afab4d62b7c\nStep 16/18 : EXPOSE 3000\n ---> Running in 877cfd430e0d\nRemoving intermediate container 877cfd430e0d\n ---> b8415b1c01e9\nStep 17/18 : ENTRYPOINT [\"/sbin/tini\", \"--\"]\n ---> Running in 1ae448c8990e\nRemoving intermediate container 1ae448c8990e\n ---> 62006f392dad\nStep 18/18 : CMD [\"node\", \"server.js\"]\n ---> Running in 43738dd6b3bb\nRemoving intermediate container 43738dd6b3bb\n ---> cb13aace3918\nSuccessfully built cb13aace3918\nSuccessfully tagged morpheus.js:latest\n","stderr":"","imageSize":1073922061},"repair":{"violations":[{"name":"npmCacheCleanAfterInstall","position":{"start":32,"end":32,"columnStart":4,"columnEnd":15}}],"repairedDockerfile":"# morpheus.js\n# This Dockerfile serves morpheus.js a Javascript based matrix visualization tool\n#\n# Build using:\n# build_version=0.1.0\n# docker_user=$USER\n# docker build --no-cache=true --build-arg BUILD_DATE=$(date -u +'%Y-%m-%dT%H:%M:%SZ') --build-arg BUILD_VERSION=\"${build_version}\" -t ${docker_user}/morpheus.js:${build_version} .\n\n#------------------\n# First build stage\n#------------------\nFROM node:14-alpine as builder\n#FROM mhart/alpine-node:14 as builder\nLABEL stage=builder\n\nARG BUILD_DATE\nARG BUILD_VERSION=\"latest\"\n\nLABEL org.label-schema.name=\"morpheus.js\" \\\n\t  org.label-schema.description=\"morpheus.js is a container image that morpheus.js a javascript matrix visualization tool\" \\\n\t  org.label-schema.version=\"$BUILD_VERSION\" \\\n\t  org.label-schema.build-date=\"$BUILD_DATE\" \\\n\t  org.label-schema.license=\"BSD 3-Clause License\" \\\n      org.label-schema.schema-version=\"1.0\"\n\n# Copy app's source code to the /app directory\nCOPY . /app\n\n# The application's directory will be the working directory\nWORKDIR /app\n\n# Install Node.js dependencies defined in '/app/packages.json'\nRUN npm install\n\n#-------------------\n# Second build stage\n#-------------------\nFROM node:14-alpine as release\n#FROM mhart/alpine-node:slim-14\n\n# Add tini init\nRUN apk add --no-cache tini\n\n# To run node in production mode\nENV NODE_ENV=\"production\"\n\n# Copy the application code\nCOPY --from=builder /app /app\n\n# Create a non-root user\n#RUN useradd -r -u 1001 -g root nonroot\n#RUN chown -R nonroot /app\n\n# Create a group and user\nRUN addgroup -g 1001 -S appgroup && \\\n adduser -u 1001 -S appuser -G appgroup && \\\nchown -R appuser /app\n\n#USER nonroot\nUSER appuser\n\nWORKDIR /app\nEXPOSE 3000\n\n# Start the application\nENTRYPOINT [\"/sbin/tini\", \"--\"]\nCMD [\"node\", \"server.js\"]\n"},"repairedBuild":{"startTimestamp":1672619565185,"endTimestamp":1672619782315,"error":null,"stdout":"Sending build context to Docker daemon  91.05MB\r\r\nStep 1/18 : FROM node:14-alpine as builder\n ---> fb7170aa2b9b\nStep 2/18 : LABEL stage=builder\n ---> Running in 353c1fa0e59c\nRemoving intermediate container 353c1fa0e59c\n ---> 7ac3e4e8866e\nStep 3/18 : ARG BUILD_DATE\n ---> Running in f10f9451cc0f\nRemoving intermediate container f10f9451cc0f\n ---> 9bd0f19f2cce\nStep 4/18 : ARG BUILD_VERSION=\"latest\"\n ---> Running in b46c97661e71\nRemoving intermediate container b46c97661e71\n ---> 8f2daeb20956\nStep 5/18 : LABEL org.label-schema.name=\"morpheus.js\" \t  org.label-schema.description=\"morpheus.js is a container image that morpheus.js a javascript matrix visualization tool\" \t  org.label-schema.version=\"$BUILD_VERSION\" \t  org.label-schema.build-date=\"$BUILD_DATE\" \t  org.label-schema.license=\"BSD 3-Clause License\"       org.label-schema.schema-version=\"1.0\"\n ---> Running in 403a99ff2417\nRemoving intermediate container 403a99ff2417\n ---> f5de26312319\nStep 6/18 : COPY . /app\n ---> bb24d3f23ef7\nStep 7/18 : WORKDIR /app\n ---> Running in b69906caa3ff\nRemoving intermediate container b69906caa3ff\n ---> ada75633d35d\nStep 8/18 : RUN npm install\n ---> Running in 4e4c84011ba6\n\u001b[91mnpm WARN deprecated grunt-contrib-uglify-es@3.3.0: deprecated\n\u001b[0m\u001b[91mnpm WARN deprecated uglify-es@3.3.9: support for ECMAScript is superseded by `uglify-js` as of v3.13.0\n\u001b[0m\u001b[91mnpm WARN deprecated log4js@4.5.1: 4.x is no longer supported. Please upgrade to 6.x or higher.\n\u001b[0m\u001b[91mnpm WARN deprecated puppeteer@1.20.0: < 18.1.0 is no longer supported\n\u001b[0m\u001b[91mnpm WARN deprecated date-format@2.1.0: 2.x is no longer supported. Please upgrade to 4.x or higher.\n\u001b[0m\u001b[91mnpm WARN deprecated streamroller@1.0.6: 1.x is no longer supported. Please upgrade to 3.x or higher.\n\u001b[0m\u001b[91mnpm WARN deprecated node-fetch-npm@2.0.4: This module is not used anymore, npm uses minipass-fetch for its fetch implementation now\n\u001b[0m\n> puppeteer@1.20.0 install /app/node_modules/puppeteer\n> node install.js\n\n\u001b[91m\n\u001b[0mChromium downloaded to /app/node_modules/puppeteer/.local-chromium/linux-686378\n\u001b[91mnpm notice created a lockfile as package-lock.json. You should commit this file.\n\u001b[0m\u001b[91mnpm WARN optional SKIPPING OPTIONAL DEPENDENCY: fsevents@~2.3.2 (node_modules/chokidar/node_modules/fsevents):\nnpm WARN notsup\u001b[0m\u001b[91m SKIPPING OPTIONAL DEPENDENCY: Unsupported platform for fsevents@2.3.2: wanted {\"os\":\"darwin\",\"arch\":\"any\"} (current: {\"os\":\"linux\",\"arch\":\"x64\"})\n\u001b[0m\u001b[91m\n\u001b[0madded 578 packages from 725 contributors and audited 579 packages in 19.893s\n\n28 packages are looking for funding\n  run `npm fund` for details\n\nfound 15 vulnerabilities (6 moderate, 5 high, 4 critical)\n  run `npm audit fix` to fix them, or `npm audit` for details\nRemoving intermediate container 4e4c84011ba6\n ---> 0729a754f313\nStep 9/18 : FROM node:14-alpine as release\n ---> fb7170aa2b9b\nStep 10/18 : RUN apk add --no-cache tini\n ---> Running in ae03c544712e\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/community/x86_64/APKINDEX.tar.gz\n(1/1) Installing tini (0.19.0-r1)\nExecuting busybox-1.35.0-r29.trigger\nOK: 10 MiB in 18 packages\nRemoving intermediate container ae03c544712e\n ---> 1add704f48ac\nStep 11/18 : ENV NODE_ENV=\"production\"\n ---> Running in 4dc9c0f2a739\nRemoving intermediate container 4dc9c0f2a739\n ---> aba23a115818\nStep 12/18 : COPY --from=builder /app /app\n ---> e8f913b06dbd\nStep 13/18 : RUN addgroup -g 1001 -S appgroup &&  adduser -u 1001 -S appuser -G appgroup && chown -R appuser /app\n ---> Running in 81836796fbd7\nRemoving intermediate container 81836796fbd7\n ---> 7eecc4e76ae3\nStep 14/18 : USER appuser\n ---> Running in a58adc395434\nRemoving intermediate container a58adc395434\n ---> 8c75bca0b40e\nStep 15/18 : WORKDIR /app\n ---> Running in da1bc778e65f\nRemoving intermediate container da1bc778e65f\n ---> ef3351c47b00\nStep 16/18 : EXPOSE 3000\n ---> Running in de404b6cd336\nRemoving intermediate container de404b6cd336\n ---> e512e59fd4a4\nStep 17/18 : ENTRYPOINT [\"/sbin/tini\", \"--\"]\n ---> Running in 61323d363f32\nRemoving intermediate container 61323d363f32\n ---> efc80f03edbf\nStep 18/18 : CMD [\"node\", \"server.js\"]\n ---> Running in 5aea9eb4cc25\nRemoving intermediate container 5aea9eb4cc25\n ---> cb23a9dde74d\nSuccessfully built cb23a9dde74d\nSuccessfully tagged morpheus.js:latest\n","stderr":"","imageSize":1073922059},"endTime":1672619783016}