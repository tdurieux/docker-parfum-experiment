{"repository":"https://github.com/supabase/storage-api","dockerfilePath":"Dockerfile","startTime":1672354692749,"clone":{"stdout":"","stderr":"Cloning into '/tmp/dinghy-analysis/supabase/storage-api'...\n","error":null,"commit":"f96c56e01f7cca24e87aac265f5885744d9476cb"},"originalBuild":{"startTimestamp":1672354693715,"endTimestamp":1672354878284,"error":null,"stdout":"Sending build context to Docker daemon  1.639MB\r\r\nStep 1/21 : FROM node:18-alpine\n18-alpine: Pulling from library/node\nDigest: sha256:a136ed7b0df71082cdb171f36d640ea3b392a5c70401c642326acee767b8c540\nStatus: Downloaded newer image for node:18-alpine\n ---> 6d7b7852bcd3\nStep 2/21 : RUN apk add --no-cache g++ make python3\n ---> Running in 44195d3bf466\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/community/x86_64/APKINDEX.tar.gz\n(1/24) Installing libstdc++-dev (12.2.1_git20220924-r4)\n(2/24) Installing binutils (2.39-r2)\n(3/24) Installing libgomp (12.2.1_git20220924-r4)\n(4/24) Installing libatomic (12.2.1_git20220924-r4)\n(5/24) Installing gmp (6.2.1-r2)\n(6/24) Installing isl25 (0.25-r0)\n(7/24) Installing mpfr4 (4.1.0-r0)\n(8/24) Installing mpc1 (1.2.1-r1)\n(9/24) Installing gcc (12.2.1_git20220924-r4)\n(10/24) Installing musl-dev (1.2.3-r4)\n(11/24) Installing libc-dev (0.7.2-r3)\n(12/24) Installing g++ (12.2.1_git20220924-r4)\n(13/24) Installing make (4.3-r1)\n(14/24) Installing libbz2 (1.0.8-r4)\n(15/24) Installing libexpat (2.5.0-r0)\n(16/24) Installing libffi (3.4.4-r0)\n(17/24) Installing gdbm (1.23-r0)\n(18/24) Installing xz-libs (5.2.9-r0)\n(19/24) Installing mpdecimal (2.5.1-r1)\n(20/24) Installing ncurses-terminfo-base (6.3_p20221119-r0)\n(21/24) Installing ncurses-libs (6.3_p20221119-r0)\n(22/24) Installing readline (8.2.0-r0)\n(23/24) Installing sqlite-libs (3.40.1-r0)\n(24/24) Installing python3 (3.10.9-r1)\nExecuting busybox-1.35.0-r29.trigger\nOK: 287 MiB in 41 packages\nRemoving intermediate container 44195d3bf466\n ---> 28d80e1e506c\nStep 3/21 : WORKDIR /app\n ---> Running in 14547cab0086\nRemoving intermediate container 14547cab0086\n ---> 9cd9a927832f\nStep 4/21 : COPY package.json package-lock.json ./\n ---> 391915a4f0a0\nStep 5/21 : RUN npm ci --production\n ---> Running in 68c820879729\n\u001b[91mnpm\u001b[0m\u001b[91m WARN\u001b[0m\u001b[91m config\u001b[0m\u001b[91m production Use `--omit=dev` instead.\n\u001b[0m\nadded 476 packages, and audited 477 packages in 14s\n\n24 packages are looking for funding\n  run `npm fund` for details\n\n3 vulnerabilities (1 moderate, 2 high)\n\nTo address issues that do not require attention, run:\n  npm audit fix\n\nTo address all issues possible (including breaking changes), run:\n  npm audit fix --force\n\nSome issues need review, and may require choosing\na different dependency.\n\nRun `npm audit` for details.\n\u001b[91mnpm notice \nnpm \u001b[0m\u001b[91mnotice New major version of npm available! 8.19.2 -> 9.2.0\nnpm notice Changelog: <https://github.com/npm/cli/releases/tag/v9.2.0>\n\u001b[0m\u001b[91mnpm notice Run `npm install -g npm@9.2.0` to update!\n\u001b[0m\u001b[91mnpm \u001b[0m\u001b[91mnotice \n\u001b[0mRemoving intermediate container 68c820879729\n ---> ce4ec611cc26\nStep 6/21 : FROM node:18-alpine\n ---> 6d7b7852bcd3\nStep 7/21 : RUN apk add --no-cache g++ make python3\n ---> Running in 42306dd08eac\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/community/x86_64/APKINDEX.tar.gz\n(1/24) Installing libstdc++-dev (12.2.1_git20220924-r4)\n(2/24) Installing binutils (2.39-r2)\n(3/24) Installing libgomp (12.2.1_git20220924-r4)\n(4/24) Installing libatomic (12.2.1_git20220924-r4)\n(5/24) Installing gmp (6.2.1-r2)\n(6/24) Installing isl25 (0.25-r0)\n(7/24) Installing mpfr4 (4.1.0-r0)\n(8/24) Installing mpc1 (1.2.1-r1)\n(9/24) Installing gcc (12.2.1_git20220924-r4)\n(10/24) Installing musl-dev (1.2.3-r4)\n(11/24) Installing libc-dev (0.7.2-r3)\n(12/24) Installing g++ (12.2.1_git20220924-r4)\n(13/24) Installing make (4.3-r1)\n(14/24) Installing libbz2 (1.0.8-r4)\n(15/24) Installing libexpat (2.5.0-r0)\n(16/24) Installing libffi (3.4.4-r0)\n(17/24) Installing gdbm (1.23-r0)\n(18/24) Installing xz-libs (5.2.9-r0)\n(19/24) Installing mpdecimal (2.5.1-r1)\n(20/24) Installing ncurses-terminfo-base (6.3_p20221119-r0)\n(21/24) Installing ncurses-libs (6.3_p20221119-r0)\n(22/24) Installing readline (8.2.0-r0)\n(23/24) Installing sqlite-libs (3.40.1-r0)\n(24/24) Installing python3 (3.10.9-r1)\nExecuting busybox-1.35.0-r29.trigger\nOK: 287 MiB in 41 packages\nRemoving intermediate container 42306dd08eac\n ---> 490b6704289e\nStep 8/21 : WORKDIR /app\n ---> Running in b0488ee65095\nRemoving intermediate container b0488ee65095\n ---> ada7b309aee9\nStep 9/21 : COPY . .\n ---> 29a9d90c8135\nStep 10/21 : RUN npm ci\n ---> Running in a2ee611d9af0\n\nadded 858 packages, and audited 859 packages in 13s\n\n68 packages are looking for funding\n  run `npm fund` for details\n\n4 vulnerabilities (1 moderate, 3 high)\n\nTo address issues that do not require attention, run:\n  npm audit fix\n\nTo address all issues possible (including breaking changes), run:\n  npm audit fix --force\n\nSome issues need review, and may require choosing\na different dependency.\n\nRun `npm audit` for details.\n\u001b[91mnpm notice \nnpm notice New major version of npm available! 8.19.2 -> 9.2.0\nnpm notice Changelog: <https://github.com/npm/cli/releases/tag/v9.2.0>\nnpm notice Run `npm install -g npm@9.2.0` to update!\n\u001b[0m\u001b[91mnpm notice \n\u001b[0mRemoving intermediate container a2ee611d9af0\n ---> 9433572e014c\nStep 11/21 : RUN npm run build\n ---> Running in 7bc9ded65255\n\n> supa-storage@0.9.3 build\n> tsc -p tsconfig.json\n\nRemoving intermediate container 7bc9ded65255\n ---> c4b8d41e01c0\nStep 12/21 : FROM node:18-alpine\n ---> 6d7b7852bcd3\nStep 13/21 : RUN npm install -g pm2\n ---> Running in 8d910f779495\n\u001b[91mnpm WARN deprecated uuid@3.4.0: Please upgrade  to version 7 or higher.  Older versions may use Math.random() in certain circumstances, which is known to be problematic.  See https://v8.dev/blog/math-random for details.\n\u001b[0m\nadded 184 packages, and audited 185 packages in 10s\n\n12 packages are looking for funding\n  run `npm fund` for details\n\nfound 0 vulnerabilities\n\u001b[91mnpm notice \nnpm notice\u001b[0m\u001b[91m New major version of npm available! 8.19.2 -> 9.2.0\nnpm notice\u001b[0m\u001b[91m Changelog: <https://github.com/npm/cli/releases/tag/v9.2.0>\nnpm\u001b[0m\u001b[91m notice\u001b[0m\u001b[91m Run `npm install -g npm@9.2.0` to update!\nnpm notice \n\u001b[0mRemoving intermediate container 8d910f779495\n ---> 9298d3f93b49\nStep 14/21 : WORKDIR /app\n ---> Running in 3b51329604cf\nRemoving intermediate container 3b51329604cf\n ---> 65fdde7641c0\nStep 15/21 : COPY migrations migrations\n ---> 3fb83433278d\nStep 16/21 : COPY ecosystem.config.js package.json ./\n ---> 5aedede2c761\nStep 17/21 : COPY --from=0 /app/node_modules node_modules\n ---> 541d11942e87\nStep 18/21 : COPY --from=1 /app/dist dist\n ---> a955be0b4b3e\nStep 19/21 : EXPOSE 5000\n ---> Running in 1c0a33ad9e22\nRemoving intermediate container 1c0a33ad9e22\n ---> 80c1bfe1fd52\nStep 20/21 : ENTRYPOINT [\"docker-entrypoint.sh\"]\n ---> Running in feaf242a3bb7\nRemoving intermediate container feaf242a3bb7\n ---> a6138ddf819c\nStep 21/21 : CMD [\"pm2-runtime\", \"ecosystem.config.js\"]\n ---> Running in fb7e3df30842\nRemoving intermediate container fb7e3df30842\n ---> 1a6212730044\nSuccessfully built 1a6212730044\nSuccessfully tagged storage-api:latest\n","stderr":"","imageSize":270455216},"repair":{"violations":[{"name":"npmCacheCleanAfterInstall","position":{"start":14,"end":14,"columnStart":4,"columnEnd":22}}],"repairedDockerfile":"FROM node:18-alpine\nRUN apk add --no-cache g++ make python3\nWORKDIR /app\nCOPY package.json package-lock.json ./\nRUN npm ci --production\n\nFROM node:18-alpine\nRUN apk add --no-cache g++ make python3\nWORKDIR /app\nCOPY . .\nRUN npm ci\nRUN npm run build\n\nFROM node:18-alpine\nRUN npm install -g pm2\nWORKDIR /app\nCOPY migrations migrations\nCOPY ecosystem.config.js package.json ./\nCOPY --from=0 /app/node_modules node_modules\nCOPY --from=1 /app/dist dist\nEXPOSE 5000\nENTRYPOINT [\"docker-entrypoint.sh\"]\nCMD [\"pm2-runtime\", \"ecosystem.config.js\"]\n"},"repairedBuild":{"startTimestamp":1672354878952,"endTimestamp":1672355463169,"error":null,"stdout":"Sending build context to Docker daemon  1.639MB\r\r\nStep 1/21 : FROM node:18-alpine\n ---> 6d7b7852bcd3\nStep 2/21 : RUN apk add --no-cache g++ make python3\n ---> Running in 4496d1ed912f\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/community/x86_64/APKINDEX.tar.gz\n(1/24) Installing libstdc++-dev (12.2.1_git20220924-r4)\n(2/24) Installing binutils (2.39-r2)\n(3/24) Installing libgomp (12.2.1_git20220924-r4)\n(4/24) Installing libatomic (12.2.1_git20220924-r4)\n(5/24) Installing gmp (6.2.1-r2)\n(6/24) Installing isl25 (0.25-r0)\n(7/24) Installing mpfr4 (4.1.0-r0)\n(8/24) Installing mpc1 (1.2.1-r1)\n(9/24) Installing gcc (12.2.1_git20220924-r4)\n(10/24) Installing musl-dev (1.2.3-r4)\n(11/24) Installing libc-dev (0.7.2-r3)\n(12/24) Installing g++ (12.2.1_git20220924-r4)\n(13/24) Installing make (4.3-r1)\n(14/24) Installing libbz2 (1.0.8-r4)\n(15/24) Installing libexpat (2.5.0-r0)\n(16/24) Installing libffi (3.4.4-r0)\n(17/24) Installing gdbm (1.23-r0)\n(18/24) Installing xz-libs (5.2.9-r0)\n(19/24) Installing mpdecimal (2.5.1-r1)\n(20/24) Installing ncurses-terminfo-base (6.3_p20221119-r0)\n(21/24) Installing ncurses-libs (6.3_p20221119-r0)\n(22/24) Installing readline (8.2.0-r0)\n(23/24) Installing sqlite-libs (3.40.1-r0)\n(24/24) Installing python3 (3.10.9-r1)\nExecuting busybox-1.35.0-r29.trigger\nOK: 287 MiB in 41 packages\nRemoving intermediate container 4496d1ed912f\n ---> a106b8cb38d5\nStep 3/21 : WORKDIR /app\n ---> Running in 240e9075983c\nRemoving intermediate container 240e9075983c\n ---> 5011af914041\nStep 4/21 : COPY package.json package-lock.json ./\n ---> 1105245281a9\nStep 5/21 : RUN npm ci --production\n ---> Running in 66721592b2f0\n\u001b[91mnpm\u001b[0m\u001b[91m WARN config\u001b[0m\u001b[91m production Use `--omit=dev` instead.\n\u001b[0m\nadded 476 packages, and audited 477 packages in 10s\n\n24 packages are looking for funding\n  run `npm fund` for details\n\n3 vulnerabilities (1 moderate, 2 high)\n\nTo address issues that do not require attention, run:\n  npm audit fix\n\nTo address all issues possible (including breaking changes), run:\n  npm audit fix --force\n\nSome issues need review, and may require choosing\na different dependency.\n\nRun `npm audit` for details.\n\u001b[91mnpm notice \nnpm notice New major version of npm available! 8.19.2 -> 9.2.0\nnpm notice Changelog: <https://github.com/npm/cli/releases/tag/v9.2.0>\n\u001b[0m\u001b[91mnpm notice Run `npm install -g npm@9.2.0` to update!\nnpm notice \n\u001b[0mRemoving intermediate container 66721592b2f0\n ---> c24b67726bf7\nStep 6/21 : FROM node:18-alpine\n ---> 6d7b7852bcd3\nStep 7/21 : RUN apk add --no-cache g++ make python3\n ---> Running in 1e21cc0faf99\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/community/x86_64/APKINDEX.tar.gz\n(1/24) Installing libstdc++-dev (12.2.1_git20220924-r4)\n(2/24) Installing binutils (2.39-r2)\n(3/24) Installing libgomp (12.2.1_git20220924-r4)\n(4/24) Installing libatomic (12.2.1_git20220924-r4)\n(5/24) Installing gmp (6.2.1-r2)\n(6/24) Installing isl25 (0.25-r0)\n(7/24) Installing mpfr4 (4.1.0-r0)\n(8/24) Installing mpc1 (1.2.1-r1)\n(9/24) Installing gcc (12.2.1_git20220924-r4)\n(10/24) Installing musl-dev (1.2.3-r4)\n(11/24) Installing libc-dev (0.7.2-r3)\n(12/24) Installing g++ (12.2.1_git20220924-r4)\n(13/24) Installing make (4.3-r1)\n(14/24) Installing libbz2 (1.0.8-r4)\n(15/24) Installing libexpat (2.5.0-r0)\n(16/24) Installing libffi (3.4.4-r0)\n(17/24) Installing gdbm (1.23-r0)\n(18/24) Installing xz-libs (5.2.9-r0)\n(19/24) Installing mpdecimal (2.5.1-r1)\n(20/24) Installing ncurses-terminfo-base (6.3_p20221119-r0)\n(21/24) Installing ncurses-libs (6.3_p20221119-r0)\n(22/24) Installing readline (8.2.0-r0)\n(23/24) Installing sqlite-libs (3.40.1-r0)\n(24/24) Installing python3 (3.10.9-r1)\nExecuting busybox-1.35.0-r29.trigger\nOK: 287 MiB in 41 packages\nRemoving intermediate container 1e21cc0faf99\n ---> 2448195c946a\nStep 8/21 : WORKDIR /app\n ---> Running in e15808e32a9c\nRemoving intermediate container e15808e32a9c\n ---> 93ee8ead2064\nStep 9/21 : COPY . .\n ---> 3bd651e92eab\nStep 10/21 : RUN npm ci\n ---> Running in 5d6eb9a5bb9e\n\nadded 858 packages, and audited 859 packages in 18s\n\n68 packages are looking for funding\n  run `npm fund` for details\n\n4 vulnerabilities (1 moderate, 3 high)\n\nTo address issues that do not require attention, run:\n  npm audit fix\n\nTo address all issues possible (including breaking changes), run:\n  npm audit fix --force\n\nSome issues need review, and may require choosing\na different dependency.\n\nRun `npm audit` for details.\n\u001b[91mnpm notice \nnpm notice\u001b[0m\u001b[91m New major version of npm available! 8.19.2 -> 9.2.0\nnpm notice Changelog: <https://github.com/npm/cli/releases/tag/v9.2.0>\nnpm notice Run `npm install -g npm@9.2.0` to update!\nnpm notice \n\u001b[0mRemoving intermediate container 5d6eb9a5bb9e\n ---> 79c0ce4e8131\nStep 11/21 : RUN npm run build\n ---> Running in 15d5a8463254\n\n> supa-storage@0.9.3 build\n> tsc -p tsconfig.json\n\nRemoving intermediate container 15d5a8463254\n ---> f13cbf61a71e\nStep 12/21 : FROM node:18-alpine\n ---> 6d7b7852bcd3\nStep 13/21 : RUN npm install -g pm2\n ---> Running in 052bd7920509\n\u001b[91mnpm WARN deprecated uuid@3.4.0: Please upgrade  to version 7 or higher.  Older versions may use Math.random() in certain circumstances, which is known to be problematic.  See https://v8.dev/blog/math-random for details.\n\u001b[0m\nadded 184 packages, and audited 185 packages in 10s\n\n12 packages are looking for funding\n  run `npm fund` for details\n\nfound 0 vulnerabilities\n\u001b[91mnpm notice \nnpm notice\u001b[0m\u001b[91m New major version of npm available! 8.19.2 -> 9.2.0\nnpm notice Changelog: <https://github.com/npm/cli/releases/tag/v9.2.0>\n\u001b[0m\u001b[91mnpm notice\u001b[0m\u001b[91m Run `npm install -g npm@9.2.0` to update!\nnpm\u001b[0m\u001b[91m notice\u001b[0m\u001b[91m \n\u001b[0mRemoving intermediate container 052bd7920509\n ---> 26a4f7f1fa70\nStep 14/21 : WORKDIR /app\n ---> Running in 74c0d878bad3\nRemoving intermediate container 74c0d878bad3\n ---> 4e33c964b968\nStep 15/21 : COPY migrations migrations\n ---> eb0ccb1d5a2b\nStep 16/21 : COPY ecosystem.config.js package.json ./\n ---> 691eb664bdac\nStep 17/21 : COPY --from=0 /app/node_modules node_modules\n ---> 93f53e6ee65f\nStep 18/21 : COPY --from=1 /app/dist dist\n ---> a92b7987d0b0\nStep 19/21 : EXPOSE 5000\n ---> Running in e384c594b0ee\nRemoving intermediate container e384c594b0ee\n ---> b140ac1db6ae\nStep 20/21 : ENTRYPOINT [\"docker-entrypoint.sh\"]\n ---> Running in 51ab9d7c69f2\nRemoving intermediate container 51ab9d7c69f2\n ---> c7c08a418255\nStep 21/21 : CMD [\"pm2-runtime\", \"ecosystem.config.js\"]\n ---> Running in 7589defb89f6\nRemoving intermediate container 7589defb89f6\n ---> 4354e48074f8\nSuccessfully built 4354e48074f8\nSuccessfully tagged storage-api:latest\n","stderr":"","imageSize":270455177},"endTime":1672355464052}