{"repository":"https://github.com/jakewharton/posterbox","dockerfilePath":"Dockerfile","startTime":1672126874502,"clone":{"stdout":"","stderr":"Cloning into '/tmp/dinghy-analysis/jakewharton/posterbox'...\n","error":null,"commit":"2776b3d7758eda1f7d940978da9d599631e5c560"},"originalBuild":{"startTimestamp":1672126875605,"endTimestamp":1672127072119,"error":null,"stdout":"Sending build context to Docker daemon  4.769MB\r\r\nStep 1/19 : FROM openjdk:18-alpine AS build\n18-alpine: Pulling from library/openjdk\n59bf1c3509f3: Already exists\n20ae5de21b22: Pulling fs layer\n3048de22201a: Pulling fs layer\n20ae5de21b22: Verifying Checksum\n20ae5de21b22: Download complete\n20ae5de21b22: Pull complete\n3048de22201a: Verifying Checksum\n3048de22201a: Download complete\n3048de22201a: Pull complete\nDigest: sha256:e5c5b35b831a4f655074a25604130ce53e33567b82c8a7204f0e5641b66d477e\nStatus: Downloaded newer image for openjdk:18-alpine\n ---> c89120dcca4c\nStep 2/19 : RUN apk add       nodejs       binutils       git     ;\n ---> Running in 0a15b0f02c8a\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.15/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.15/community/x86_64/APKINDEX.tar.gz\n(1/11) Installing libgcc (10.3.1_git20211027-r0)\n(2/11) Installing libstdc++ (10.3.1_git20211027-r0)\n(3/11) Installing binutils (2.37-r3)\n(4/11) Installing brotli-libs (1.0.9-r5)\n(5/11) Installing nghttp2-libs (1.46.0-r0)\n(6/11) Installing libcurl (7.80.0-r5)\n(7/11) Installing expat (2.5.0-r0)\n(8/11) Installing pcre2 (10.40-r0)\n(9/11) Installing git (2.34.5-r0)\n(10/11) Installing c-ares (1.18.1-r0)\n(11/11) Installing nodejs (16.17.1-r0)\nExecuting busybox-1.34.1-r3.trigger\nOK: 72 MiB in 31 packages\nRemoving intermediate container 0a15b0f02c8a\n ---> 34338e4f87c2\nStep 3/19 : WORKDIR /app\n ---> Running in ee8616d5f07c\nRemoving intermediate container ee8616d5f07c\n ---> ce0d8add64f3\nStep 4/19 : COPY gradlew ./\n ---> 2eb7e488f17d\nStep 5/19 : COPY gradle/wrapper ./gradle/wrapper\n ---> 0b2127f349a5\nStep 6/19 : RUN ./gradlew --version\n ---> Running in 80f4007cf927\nDownloading https://services.gradle.org/distributions/gradle-7.4-bin.zip\n...........10%...........20%...........30%...........40%...........50%...........60%...........70%...........80%...........90%...........100%\n\nWelcome to Gradle 7.4!\n\nHere are the highlights of this release:\n - Aggregated test and JaCoCo reports\n - Marking additional test source directories as tests in IntelliJ\n - Support for Adoptium JDKs in Java toolchains\n\nFor more details see https://docs.gradle.org/7.4/release-notes.html\n\n\n------------------------------------------------------------\nGradle 7.4\n------------------------------------------------------------\n\nBuild time:   2022-02-08 09:58:38 UTC\nRevision:     f0d9291c04b90b59445041eaa75b2ee744162586\n\nKotlin:       1.5.31\nGroovy:       3.0.9\nAnt:          Apache Ant(TM) version 1.10.11 compiled on July 10 2021\nJVM:          18-ea (Oracle Corporation 18-ea+11)\nOS:           Linux 5.4.0-113-generic amd64\n\nRemoving intermediate container 80f4007cf927\n ---> 9b05713ab7d8\nStep 7/19 : COPY gradle ./gradle\n ---> 5c64cd4183ef\nStep 8/19 : COPY build.gradle gradle.properties settings.gradle ./\n ---> 1bb97f88577d\nStep 9/19 : COPY src ./src\n ---> 13b856f7ccbc\nStep 10/19 : RUN ./gradlew assemble -PskipNodeDownload\n ---> Running in 43bf5ded5e3b\nStarting a Gradle Daemon (subsequent builds will be faster)\nType-safe dependency accessors is an incubating feature.\n> Task :backendProcessResources NO-SOURCE\n> Task :gitShaWriterTask\n> Task :compileKotlinBackend\n> Task :backendMainClasses\n> Task :compileJava NO-SOURCE\n> Task :frontendProcessResources\n> Task :frontendBrowserProductionExecutableDistributeResources\n> Task :kotlinNpmCachesSetup\n> Task :frontendPackageJson\n> Task :kotlinNodeJsSetup SKIPPED\n> Task :kotlinRestoreYarnLock SKIPPED\n> Task :kotlinYarnSetup\n> Task :frontendTestPackageJson\n> Task :packageJsonUmbrella\n> Task :rootPackageJson\n\n> Task :kotlinNpmInstall\n\u001b[91mwarning workspace-aggregator-1159d31a-c51a-48a9-9696-604195b665dc > posterbox-frontend > webpack-dev-server > url > querystring@0.2.0: The querystring API is considered Legacy. new code should use the URLSearchParams API instead.\n\u001b[0m\u001b[91mwarning Ignored scripts due to flag.\n\u001b[0m\n> Task :frontendGenerateExternalsIntegrated SKIPPED\n> Task :kotlinStoreYarnLock\n> Task :compileKotlinFrontend\n> Task :frontendMainClasses\n> Task :compileProductionExecutableKotlinFrontend\n> Task :frontendProductionExecutableCompileSync\n\n> Task :frontendBrowserProductionWebpack\nasset size limit: The following asset(s) exceed the recommended size limit (244 KiB).\nThis can impact web performance.\nAssets: \n  posterbox.js (1.41 MiB)\n\u001b[91m\n\u001b[0mentrypoint size limit: The following entrypoint(s) combined asset size exceeds the recommended limit (244 KiB). This can impact web performance.\nEntrypoints:\n  main (1.41 MiB)\n      posterbox.js\n\u001b[91m\n\u001b[0mwebpack performance recommendations: \nYou can limit the size of your bundles by using import() or require.ensure to lazy load some parts of your application.\nFor more info visit https://webpack.js.org/guides/code-splitting/\n\u001b[91m\n\u001b[0m\n> Task :frontendBrowserDistribution\n> Task :backendJar\n> Task :processResources SKIPPED\n> Task :classes UP-TO-DATE\n> Task :jar SKIPPED\n> Task :startScripts\n> Task :distTar SKIPPED\n> Task :distZip\n> Task :frontendPublicPackageJson\n> Task :frontendJar\n> Task :installDist\n> Task :compileKotlinMetadata\n> Task :metadataMainClasses\n> Task :metadataJar\n> Task :assemble\n\nDeprecated Gradle features were used in this build, making it incompatible with Gradle 8.0.\n\nYou can use '--warning-mode all' to show the individual deprecation warnings and determine if they come from your own scripts or plugins.\n\nSee https://docs.gradle.org/7.4/userguide/command_line_interface.html#sec:command_line_warnings\n\nBUILD SUCCESSFUL in 1m 26s\n23 actionable tasks: 23 executed\nRemoving intermediate container 43bf5ded5e3b\n ---> 83f51475037d\nStep 11/19 : RUN jdeps       --ignore-missing-deps       --multi-release 18       --print-module-deps       --class-path build/install/posterbox/lib/*     | tr ',' '\\n'     | grep -v java.desktop     | grep -v java.instrument     | grep -v jdk.unsupported     | tr '\\n' ','     | sed 's/,$/\\n/'     | tee jdeps.txt   ;\n ---> Running in 8f8d89477fa3\njava.base,java.management,java.net.http\nRemoving intermediate container 8f8d89477fa3\n ---> 37c001dd34cc\nStep 12/19 : RUN jlink       --verbose       --compress 2       --strip-debug       --no-header-files       --no-man-pages       --output jre       --add-modules $(cat jdeps.txt)    ;\n ---> Running in 953ec80b78a3\njava.base file:///opt/openjdk-18/jmods/java.base.jmod\njava.management file:///opt/openjdk-18/jmods/java.management.jmod\njava.net.http file:///opt/openjdk-18/jmods/java.net.http.jmod\n\nProviders:\n  java.base provides java.nio.file.spi.FileSystemProvider used by java.base\n  java.base provides java.util.random.RandomGenerator used by java.base\n  java.management provides javax.security.auth.spi.LoginModule used by java.base\nRemoving intermediate container 953ec80b78a3\n ---> 3caa12ae7337\nStep 13/19 : FROM alpine:3.17.0\n3.17.0: Pulling from library/alpine\nDigest: sha256:8914eb54f968791faf6a8638949e480fef81e697984fba772b3976835194c6d4\nStatus: Downloaded newer image for alpine:3.17.0\n ---> 49176f190c7e\nStep 14/19 : EXPOSE 9931\n ---> Running in 922409a72d8f\nRemoving intermediate container 922409a72d8f\n ---> 0686b56348a6\nStep 15/19 : HEALTHCHECK --interval=1m --timeout=3s   CMD wget --no-verbose --tries=1 --spider http://localhost:9931/ || exit 1\n ---> Running in 6774cbeddd3c\nRemoving intermediate container 6774cbeddd3c\n ---> 84e57d50885a\nStep 16/19 : COPY --from=build /app/jre /jre\n ---> 4c0cce3b4045\nStep 17/19 : ENV JAVA_HOME=\"/jre\"\n ---> Running in a17dbabc8b6b\nRemoving intermediate container a17dbabc8b6b\n ---> c7da13ded57a\nStep 18/19 : COPY --from=build /app/build/install/posterbox/ /app\n ---> 218bfd83e988\nStep 19/19 : ENTRYPOINT [\"/app/bin/posterbox\", \"/config/config.toml\"]\n ---> Running in 69a5a44d9559\nRemoving intermediate container 69a5a44d9559\n ---> 8257a83f83cc\nSuccessfully built 8257a83f83cc\nSuccessfully tagged posterbox:latest\n","stderr":"","imageSize":54699069},"repair":{"violations":[{"name":"apkAddUseNoCache","position":{"start":3,"end":10,"columnStart":4,"columnEnd":5}}],"repairedDockerfile":"# If you change this major version, change the --multi-release jdeps flag below\nFROM openjdk:18-alpine AS build\n\nRUN apk add --no-cache \\\n\n      nodejs \\\n\n      binutils \\\n\n      git \\\n    ;\nWORKDIR /app\n\n# Cache the Gradle binary separately from the build.\nCOPY gradlew ./\nCOPY gradle/wrapper ./gradle/wrapper\nRUN ./gradlew --version\n\nCOPY gradle ./gradle\nCOPY build.gradle gradle.properties settings.gradle ./\nCOPY src ./src\nRUN ./gradlew assemble -PskipNodeDownload\n\n# Find modules which are required.\nRUN jdeps \\\n      --ignore-missing-deps \\\n      # Keep in sync with major version of container above.\n      --multi-release 18 \\\n      --print-module-deps \\\n      --class-path build/install/posterbox/lib/* \\\n    # Split comma-separated items into lines.\n    | tr ',' '\\n' \\\n    # Used only by Ktor's HOCON parser which we do not use.\n    | grep -v java.desktop \\\n    # Used only by kotlinx.coroutines debug agent which we do not use.\n    | grep -v java.instrument \\\n    # Used only by kotlinx.coroutines debug agent which we do not use.\n    | grep -v jdk.unsupported \\\n    # Used only by Ktor for detecting IntelliJ IDEA debugger which we do not use.\n    # BUT our HTTP server cannot respond to requests without this module for some reason...\n    #| grep -v java.management \\\n    # Join lines with comma.\n    | tr '\\n' ',' \\\n    # Replace trailing comma with a newline.\n    | sed 's/,$/\\n/' \\\n    # Print to stdout AND write to this file.\n    | tee jdeps.txt \\\n  ;\n\n# Build custom minimal JRE with only the modules we need.\nRUN jlink \\\n      --verbose \\\n      --compress 2 \\\n      --strip-debug \\\n      --no-header-files \\\n      --no-man-pages \\\n      --output jre \\\n      --add-modules $(cat jdeps.txt) \\\n   ;\n\nFROM alpine:3.17.0\nEXPOSE 9931\nHEALTHCHECK --interval=1m --timeout=3s \\\n  CMD wget --no-verbose --tries=1 --spider http://localhost:9931/ || exit 1\n\nCOPY --from=build /app/jre /jre\nENV JAVA_HOME=\"/jre\"\n\nCOPY --from=build /app/build/install/posterbox/ /app\n\nENTRYPOINT [\"/app/bin/posterbox\", \"/config/config.toml\"]\n"},"repairedBuild":{"startTimestamp":1672127072513,"endTimestamp":1672127255250,"error":null,"stdout":"Sending build context to Docker daemon  4.768MB\r\r\n\u001b[91m[WARNING]: Empty continuation line found in:\n    RUN apk add --no-cache       nodejs       binutils       git     ;\n[WARNING]: Empty continuation lines will become errors in a future release.\n\u001b[0mStep 1/19 : FROM openjdk:18-alpine AS build\n ---> c89120dcca4c\nStep 2/19 : RUN apk add --no-cache       nodejs       binutils       git     ;\n ---> Running in 4abb1a4a38b3\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.15/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.15/community/x86_64/APKINDEX.tar.gz\n(1/11) Installing libgcc (10.3.1_git20211027-r0)\n(2/11) Installing libstdc++ (10.3.1_git20211027-r0)\n(3/11) Installing binutils (2.37-r3)\n(4/11) Installing brotli-libs (1.0.9-r5)\n(5/11) Installing nghttp2-libs (1.46.0-r0)\n(6/11) Installing libcurl (7.80.0-r5)\n(7/11) Installing expat (2.5.0-r0)\n(8/11) Installing pcre2 (10.40-r0)\n(9/11) Installing git (2.34.5-r0)\n(10/11) Installing c-ares (1.18.1-r0)\n(11/11) Installing nodejs (16.17.1-r0)\nExecuting busybox-1.34.1-r3.trigger\nOK: 72 MiB in 31 packages\nRemoving intermediate container 4abb1a4a38b3\n ---> 773b06fa1dc9\nStep 3/19 : WORKDIR /app\n ---> Running in 32a236548778\nRemoving intermediate container 32a236548778\n ---> 6c155a8500fa\nStep 4/19 : COPY gradlew ./\n ---> 57782650cefe\nStep 5/19 : COPY gradle/wrapper ./gradle/wrapper\n ---> 2ce794be7f26\nStep 6/19 : RUN ./gradlew --version\n ---> Running in 6942506143e1\nDownloading https://services.gradle.org/distributions/gradle-7.4-bin.zip\n...........10%...........20%...........30%...........40%...........50%...........60%...........70%...........80%...........90%...........100%\n\nWelcome to Gradle 7.4!\n\nHere are the highlights of this release:\n - Aggregated test and JaCoCo reports\n - Marking additional test source directories as tests in IntelliJ\n - Support for Adoptium JDKs in Java toolchains\n\nFor more details see https://docs.gradle.org/7.4/release-notes.html\n\n\n------------------------------------------------------------\nGradle 7.4\n------------------------------------------------------------\n\nBuild time:   2022-02-08 09:58:38 UTC\nRevision:     f0d9291c04b90b59445041eaa75b2ee744162586\n\nKotlin:       1.5.31\nGroovy:       3.0.9\nAnt:          Apache Ant(TM) version 1.10.11 compiled on July 10 2021\nJVM:          18-ea (Oracle Corporation 18-ea+11)\nOS:           Linux 5.4.0-113-generic amd64\n\nRemoving intermediate container 6942506143e1\n ---> 0333ce72d1b2\nStep 7/19 : COPY gradle ./gradle\n ---> bf88d8d56f02\nStep 8/19 : COPY build.gradle gradle.properties settings.gradle ./\n ---> 477187b9f250\nStep 9/19 : COPY src ./src\n ---> efc7c00d6308\nStep 10/19 : RUN ./gradlew assemble -PskipNodeDownload\n ---> Running in af96559c80d7\nStarting a Gradle Daemon (subsequent builds will be faster)\nType-safe dependency accessors is an incubating feature.\n> Task :backendProcessResources NO-SOURCE\n> Task :gitShaWriterTask\n> Task :compileKotlinBackend\n> Task :backendMainClasses\n> Task :compileJava NO-SOURCE\n> Task :frontendProcessResources\n> Task :frontendBrowserProductionExecutableDistributeResources\n> Task :kotlinNpmCachesSetup\n> Task :frontendPackageJson\n> Task :kotlinNodeJsSetup SKIPPED\n> Task :kotlinRestoreYarnLock SKIPPED\n> Task :kotlinYarnSetup\n> Task :frontendTestPackageJson\n> Task :packageJsonUmbrella\n> Task :rootPackageJson\n\n> Task :kotlinNpmInstall\n\u001b[91mwarning workspace-aggregator-d0bd6dd1-2875-4c32-a1c1-df62ef12096f > posterbox-frontend > webpack-dev-server > url > querystring@0.2.0: The querystring API is considered Legacy. new code should use the URLSearchParams API instead.\n\u001b[0m\u001b[91mwarning Ignored scripts due to flag.\n\u001b[0m\n> Task :frontendGenerateExternalsIntegrated SKIPPED\n> Task :kotlinStoreYarnLock\n> Task :compileKotlinFrontend\n> Task :frontendMainClasses\n> Task :compileProductionExecutableKotlinFrontend\n> Task :frontendProductionExecutableCompileSync\n\n> Task :frontendBrowserProductionWebpack\nasset size limit: The following asset(s) exceed the recommended size limit (244 KiB).\nThis can impact web performance.\nAssets: \n  posterbox.js (1.41 MiB)\n\u001b[91m\n\u001b[0mentrypoint size limit: The following entrypoint(s) combined asset size exceeds the recommended limit (244 KiB). This can impact web performance.\nEntrypoints:\n  main (1.41 MiB)\n      posterbox.js\n\u001b[91m\n\u001b[0mwebpack performance recommendations: \nYou can limit the size of your bundles by using import() or require.ensure to lazy load some parts of your application.\nFor more info visit https://webpack.js.org/guides/code-splitting/\n\u001b[91m\n\u001b[0m\n> Task :frontendBrowserDistribution\n> Task :backendJar\n> Task :processResources SKIPPED\n> Task :classes UP-TO-DATE\n> Task :jar SKIPPED\n> Task :startScripts\n> Task :distTar SKIPPED\n> Task :distZip\n> Task :frontendPublicPackageJson\n> Task :frontendJar\n> Task :installDist\n> Task :compileKotlinMetadata\n> Task :metadataMainClasses\n> Task :metadataJar\n> Task :assemble\n\nDeprecated Gradle features were used in this build, making it incompatible with Gradle 8.0.\n\nYou can use '--warning-mode all' to show the individual deprecation warnings and determine if they come from your own scripts or plugins.\n\nSee https://docs.gradle.org/7.4/userguide/command_line_interface.html#sec:command_line_warnings\n\nBUILD SUCCESSFUL in 1m 18s\n23 actionable tasks: 23 executed\nRemoving intermediate container af96559c80d7\n ---> b98cd4bd212d\nStep 11/19 : RUN jdeps       --ignore-missing-deps       --multi-release 18       --print-module-deps       --class-path build/install/posterbox/lib/*     | tr ',' '\\n'     | grep -v java.desktop     | grep -v java.instrument     | grep -v jdk.unsupported     | tr '\\n' ','     | sed 's/,$/\\n/'     | tee jdeps.txt   ;\n ---> Running in a3be903619a9\njava.base,java.management,java.net.http\nRemoving intermediate container a3be903619a9\n ---> c736eeb5e994\nStep 12/19 : RUN jlink       --verbose       --compress 2       --strip-debug       --no-header-files       --no-man-pages       --output jre       --add-modules $(cat jdeps.txt)    ;\n ---> Running in cee3a3ddaf0c\njava.base file:///opt/openjdk-18/jmods/java.base.jmod\njava.management file:///opt/openjdk-18/jmods/java.management.jmod\njava.net.http file:///opt/openjdk-18/jmods/java.net.http.jmod\n\nProviders:\n  java.base provides java.nio.file.spi.FileSystemProvider used by java.base\n  java.base provides java.util.random.RandomGenerator used by java.base\n  java.management provides javax.security.auth.spi.LoginModule used by java.base\nRemoving intermediate container cee3a3ddaf0c\n ---> e9f2ea7ec8a2\nStep 13/19 : FROM alpine:3.17.0\n ---> 49176f190c7e\nStep 14/19 : EXPOSE 9931\n ---> Running in 9f496c68533b\nRemoving intermediate container 9f496c68533b\n ---> 50000beae91c\nStep 15/19 : HEALTHCHECK --interval=1m --timeout=3s   CMD wget --no-verbose --tries=1 --spider http://localhost:9931/ || exit 1\n ---> Running in 40d0659e13ed\nRemoving intermediate container 40d0659e13ed\n ---> f8cb0d453af8\nStep 16/19 : COPY --from=build /app/jre /jre\n ---> 80bd7f78527b\nStep 17/19 : ENV JAVA_HOME=\"/jre\"\n ---> Running in 6d93b38a4288\nRemoving intermediate container 6d93b38a4288\n ---> f2c51f008151\nStep 18/19 : COPY --from=build /app/build/install/posterbox/ /app\n ---> 4d5e772661ad\nStep 19/19 : ENTRYPOINT [\"/app/bin/posterbox\", \"/config/config.toml\"]\n ---> Running in fa5d70d920e7\nRemoving intermediate container fa5d70d920e7\n ---> 801ef73c415d\nSuccessfully built 801ef73c415d\nSuccessfully tagged posterbox:latest\n","stderr":"","imageSize":54699069},"endTime":1672127255472}