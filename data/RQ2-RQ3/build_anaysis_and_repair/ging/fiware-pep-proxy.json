{"repository":"https://github.com/ging/fiware-pep-proxy","dockerfilePath":"Dockerfile","startTime":1672462054181,"clone":{"stdout":"","stderr":"Cloning into '/tmp/dinghy-analysis/ging/fiware-pep-proxy'...\n","error":null,"commit":"863f114a4571ee35c637016d2bfe4a810b5de673"},"originalBuild":{"startTimestamp":1672462055124,"endTimestamp":1672462198236,"error":null,"stdout":"Sending build context to Docker daemon  1.833MB\r\r\nStep 1/30 : ARG NODE_VERSION=10\nStep 2/30 : ARG GITHUB_ACCOUNT=ging\nStep 3/30 : ARG GITHUB_REPOSITORY=fiware-pep-proxy\nStep 4/30 : FROM node:${NODE_VERSION} as builder\n10: Pulling from library/node\n76b8ef87096f: Pulling fs layer\n2e2bafe8a0f4: Pulling fs layer\nb53ce1fd2746: Pulling fs layer\n84a8c1bd5887: Pulling fs layer\n7a803dc0b40f: Pulling fs layer\nb800e94e7303: Pulling fs layer\n0da9fbf60d48: Pulling fs layer\n04dccde934cf: Pulling fs layer\n73269890f6fd: Pulling fs layer\n84a8c1bd5887: Waiting\n7a803dc0b40f: Waiting\nb800e94e7303: Waiting\n73269890f6fd: Waiting\n0da9fbf60d48: Waiting\n04dccde934cf: Waiting\nb53ce1fd2746: Verifying Checksum\nb53ce1fd2746: Download complete\n76b8ef87096f: Verifying Checksum\n76b8ef87096f: Download complete\n2e2bafe8a0f4: Verifying Checksum\n2e2bafe8a0f4: Download complete\nb800e94e7303: Verifying Checksum\nb800e94e7303: Download complete\n84a8c1bd5887: Verifying Checksum\n84a8c1bd5887: Download complete\n04dccde934cf: Verifying Checksum\n04dccde934cf: Download complete\n0da9fbf60d48: Verifying Checksum\n0da9fbf60d48: Download complete\n73269890f6fd: Verifying Checksum\n73269890f6fd: Download complete\n7a803dc0b40f: Verifying Checksum\n7a803dc0b40f: Download complete\n76b8ef87096f: Pull complete\n2e2bafe8a0f4: Pull complete\nb53ce1fd2746: Pull complete\n84a8c1bd5887: Pull complete\n7a803dc0b40f: Pull complete\nb800e94e7303: Pull complete\n0da9fbf60d48: Pull complete\n04dccde934cf: Pull complete\n73269890f6fd: Pull complete\nDigest: sha256:59531d2835edd5161c8f9512f9e095b1836f7a1fcb0ab73e005ec46047384911\nStatus: Downloaded newer image for node:10\n ---> 28dca6642db8\nStep 5/30 : COPY . /opt/fiware-pep-proxy\n ---> 1dc47add73b5\nStep 6/30 : WORKDIR /opt/fiware-pep-proxy\n ---> Running in 376a3de70039\nRemoving intermediate container 376a3de70039\n ---> b1f13468fbb7\nStep 7/30 : RUN npm install --only=prod --no-package-lock --no-optional\n ---> Running in 754bd94f87d5\n\u001b[91mnpm\u001b[0m\u001b[91m WARN\u001b[0m\u001b[91m read-shrinkwrap This version of npm is compatible with lockfileVersion@1, but package-lock.json was generated for lockfileVersion@2. I'll try to do my best with it!\n\u001b[0m\u001b[91mnpm WARN deprecated request@2.88.2: request has been deprecated, see https://github.com/request/request/issues/3142\n\u001b[0m\u001b[91mnpm WARN deprecated is-hex@1.1.3: Development of this module has been stopped.\n\u001b[0m\u001b[91mnpm WARN deprecated har-validator@5.1.5: this library is no longer supported\n\u001b[0m\u001b[91mnpm WARN deprecated uuid@3.4.0: Please upgrade  to version 7 or higher.  Older versions may use Math.random() in certain circumstances, which is known to be problematic.  See https://v8.dev/blog/math-random for details.\n\u001b[0m\u001b[91mnpm WARN deprecated joi@13.7.0: This version has been deprecated in accordance with the hapi support policy (hapi.im/support). Please upgrade to the latest version to get the best features, bug fixes, and security patches. If you are unable to upgrade at this time, paid support is available for older versions (hapi.im/commercial).\n\u001b[0m\u001b[91mnpm WARN deprecated hoek@4.2.1: This version has been deprecated in accordance with the hapi support policy (hapi.im/support). Please upgrade to the latest version to get the best features, bug fixes, and security patches. If you are unable to upgrade at this time, paid support is available for older versions (hapi.im/commercial).\n\u001b[0m\u001b[91mnpm WARN deprecated hoek@5.0.4: This version has been deprecated in accordance with the hapi support policy (hapi.im/support). Please upgrade to the latest version to get the best features, bug fixes, and security patches. If you are unable to upgrade at this time, paid support is available for older versions (hapi.im/commercial).\n\u001b[0m\u001b[91mnpm WARN deprecated topo@3.0.3: This module has moved and is now available at @hapi/topo. Please update your dependencies as this version is no longer maintained an may contain bugs and security issues.\n\u001b[0m\u001b[91mnpm WARN deprecated hoek@6.1.3: This module has moved and is now available at @hapi/hoek. Please update your dependencies as this version is no longer maintained an may contain bugs and security issues.\n\u001b[0m\u001b[91mnpm WARN \u001b[0m\u001b[91mdeprecated libnpmconfig@1.2.1: This module is not used anymore. npm config is parsed by npm itself and by @npmcli/config\n\u001b[0m\n> node-expat@2.4.0 install /opt/fiware-pep-proxy/node_modules/node-expat\n> node-gyp rebuild\n\nmake: Entering directory '/opt/fiware-pep-proxy/node_modules/node-expat/build'\n  CC(target) Release/obj.target/expat/deps/libexpat/lib/xmlparse.o\n\u001b[91m../deps/libexpat/lib/xmlparse.c:6:32: warning: unknown option after '#pragma GCC diagnostic' kind [-Wpragmas]\n #pragma GCC diagnostic ignored \"-Wimplicit-fallthrough\"\n                                ^~~~~~~~~~~~~~~~~~~~~~~~\n\u001b[0m  CC(target) Release/obj.target/expat/deps/libexpat/lib/xmltok.o\n  CC(target) Release/obj.target/expat/deps/libexpat/lib/xmlrole.o\n  AR(target) Release/obj.target/deps/libexpat/libexpat.a\n  COPY Release/libexpat.a\n  CXX(target) Release/obj.target/node_expat/node-expat.o\n  SOLINK_MODULE(target) Release/obj.target/node_expat.node\n  COPY Release/node_expat.node\nmake: Leaving directory '/opt/fiware-pep-proxy/node_modules/node-expat/build'\n\u001b[91mnpm WARN notsup Unsupported engine for eslint@8.30.0: wanted: {\"node\":\"^12.22.0 || ^14.17.0 || >=16.0.0\"} (current: {\"node\":\"10.24.1\",\"npm\":\"6.14.12\"})\nnpm WARN notsup Not compatible with your version of node/npm: eslint@8.30.0\n\u001b[0m\u001b[91mnpm WARN notsup Unsupported engine for husky@7.0.4: wanted: {\"node\":\">=12\"} (current: {\"node\":\"10.24.1\",\"npm\":\"6.14.12\"})\nnpm WARN notsup Not compatible with your version of node/npm: husky@7.0.4\n\u001b[0m\u001b[91mnpm WARN notsup Unsupported engine for eslint-plugin-prettier@4.2.1: wanted: {\"node\":\">=12.0.0\"} (current: {\"node\":\"10.24.1\",\"npm\":\"6.14.12\"})\nnpm WARN notsup Not compatible with your version of node/npm: eslint-plugin-prettier@4.2.1\n\u001b[0m\u001b[91mnpm WARN notsup Unsupported engine for lint-staged@12.5.0: wanted: {\"node\":\"^12.20.0 || ^14.13.1 || >=16.0.0\"} (current: {\"node\":\"10.24.1\",\"npm\":\"6.14.12\"})\nnpm WARN\u001b[0m\u001b[91m notsup Not compatible with your version of node/npm: lint-staged@12.5.0\n\u001b[0m\u001b[91mnpm WARN notsup Unsupported engine for mocha@9.2.2: wanted: {\"node\":\">= 12.0.0\"} (current: {\"node\":\"10.24.1\",\"npm\":\"6.14.12\"})\nnpm WARN \u001b[0m\u001b[91mnotsup Not compatible with your version of node/npm: mocha@9.2.2\n\u001b[0m\u001b[91mnpm WARN notsup Unsupported engine for textlint@12.3.1: wanted: {\"node\":\"^12.20.0 || ^14.13.1 || >=16.0.0\"} (current: {\"node\":\"10.24.1\",\"npm\":\"6.14.12\"})\n\u001b[0m\u001b[91mnpm WARN \u001b[0m\u001b[91mnotsup Not compatible with your version of node/npm: textlint@12.3.1\n\u001b[0m\u001b[91mnpm WARN notsup Unsupported engine for @eslint/eslintrc@1.4.1: wanted: {\"node\":\"^12.22.0 || ^14.17.0 || >=16.0.0\"} (current: {\"node\":\"10.24.1\",\"npm\":\"6.14.12\"})\nnpm WARN notsup\u001b[0m\u001b[91m Not compatible with your version of node/npm: @eslint/eslintrc@1.4.1\n\u001b[0m\u001b[91mnpm WARN notsup Unsupported engine for @humanwhocodes/module-importer@1.0.1: wanted: {\"node\":\">=12.22\"} (current: {\"node\":\"10.24.1\",\"npm\":\"6.14.12\"})\nnpm WARN\u001b[0m\u001b[91m notsup Not compatible with your version of node/npm: @humanwhocodes/module-importer@1.0.1\n\u001b[0m\u001b[91mnpm WARN notsup Unsupported engine for eslint-scope@7.1.1: wanted: {\"node\":\"^12.22.0 || ^14.17.0 || >=16.0.0\"} (current: {\"node\":\"10.24.1\",\"npm\":\"6.14.12\"})\nnpm WARN\u001b[0m\u001b[91m notsup Not compatible with your version of node/npm: eslint-scope@7.1.1\n\u001b[0m\u001b[91mnpm WARN notsup Unsupported engine for eslint-visitor-keys@3.3.0: wanted: {\"node\":\"^12.22.0 || ^14.17.0 || >=16.0.0\"} (current: {\"node\":\"10.24.1\",\"npm\":\"6.14.12\"})\nnpm WARN notsup Not compatible with your version of node/npm: eslint-visitor-keys@3.3.0\n\u001b[0m\u001b[91mnpm WARN notsup Unsupported engine for espree@9.4.1: wanted: {\"node\":\"^12.22.0 || ^14.17.0 || >=16.0.0\"} (current: {\"node\":\"10.24.1\",\"npm\":\"6.14.12\"})\nnpm WARN notsup Not compatible with your version of node/npm: espree@9.4.1\n\u001b[0m\u001b[91mnpm WARN notsup Unsupported engine for commander@9.4.1: wanted: {\"node\":\"^12.20.0 || >=14\"} (current: {\"node\":\"10.24.1\",\"npm\":\"6.14.12\"})\nnpm WARN notsup Not compatible with your version of node/npm: commander@9.4.1\n\u001b[0m\u001b[91mnpm WARN notsup Unsupported engine for cli-truncate@3.1.0: wanted: {\"node\":\"^12.20.0 || ^14.13.1 || >=16.0.0\"} (current: {\"node\":\"10.24.1\",\"npm\":\"6.14.12\"})\nnpm\u001b[0m\u001b[91m WARN notsup Not compatible with your version of node/npm: cli-truncate@3.1.0\n\u001b[0m\u001b[91mnpm WARN notsup Unsupported engine for listr2@4.0.5: wanted: {\"node\":\">=12\"} (current: {\"node\":\"10.24.1\",\"npm\":\"6.14.12\"})\n\u001b[0m\u001b[91mnpm WARN \u001b[0m\u001b[91mnotsup Not compatible with your version of node/npm: listr2@4.0.5\n\u001b[0m\u001b[91mnpm WARN notsup Unsupported engine for supports-color@9.3.1: wanted: {\"node\":\">=12\"} (current: {\"node\":\"10.24.1\",\"npm\":\"6.14.12\"})\nnpm WARN\u001b[0m\u001b[91m notsup Not compatible with your version of node/npm: supports-color@9.3.1\n\u001b[0m\u001b[91mnpm WARN notsup Unsupported engine for slice-ansi@5.0.0: wanted: {\"node\":\">=12\"} (current: {\"node\":\"10.24.1\",\"npm\":\"6.14.12\"})\nnpm WARN notsup Not compatible with your version of node/npm: slice-ansi@5.0.0\n\u001b[0m\u001b[91mnpm WARN notsup Unsupported engine for string-width@5.1.2: wanted: {\"node\":\">=12\"} (current: {\"node\":\"10.24.1\",\"npm\":\"6.14.12\"})\n\u001b[0m\u001b[91mnpm WARN \u001b[0m\u001b[91mnotsup Not compatible with your version of node/npm: string-width@5.1.2\n\u001b[0m\u001b[91mnpm WARN notsup Unsupported engine for ansi-styles@6.2.1: wanted: {\"node\":\">=12\"} (current: {\"node\":\"10.24.1\",\"npm\":\"6.14.12\"})\nnpm\u001b[0m\u001b[91m WARN notsup Not compatible with your version of node/npm: ansi-styles@6.2.1\n\u001b[0m\u001b[91mnpm WARN notsup Unsupported engine for is-fullwidth-code-point@4.0.0: wanted: {\"node\":\">=12\"} (current: {\"node\":\"10.24.1\",\"npm\":\"6.14.12\"})\nnpm WARN\u001b[0m\u001b[91m notsup Not compatible with your version of node/npm: is-fullwidth-code-point@4.0.0\n\u001b[0m\u001b[91mnpm WARN notsup Unsupported engine for strip-ansi@7.0.1: wanted: {\"node\":\">=12\"} (current: {\"node\":\"10.24.1\",\"npm\":\"6.14.12\"})\nnpm WARN notsup\u001b[0m\u001b[91m Not compatible with your version of node/npm: strip-ansi@7.0.1\n\u001b[0m\u001b[91mnpm WARN notsup Unsupported engine for ansi-regex@6.0.1: wanted: {\"node\":\">=12\"} (current: {\"node\":\"10.24.1\",\"npm\":\"6.14.12\"})\nnpm WARN notsup Not compatible with your version of node/npm: ansi-regex@6.0.1\n\u001b[0m\u001b[91mnpm WARN optional SKIPPING OPTIONAL DEPENDENCY: fsevents@~2.3.2 (node_modules/chokidar/node_modules/fsevents):\nnpm WARN notsup SKIPPING OPTIONAL DEPENDENCY: Unsupported platform for fsevents@2.3.2: wanted {\"os\":\"darwin\",\"arch\":\"any\"} (current: {\"os\":\"linux\",\"arch\":\"x64\"})\n\u001b[0m\u001b[91mnpm WARN notsup Unsupported engine for is-plain-obj@4.1.0: wanted: {\"node\":\">=12\"} (current: {\"node\":\"10.24.1\",\"npm\":\"6.14.12\"})\nnpm WARN notsup Not compatible with your version of node/npm: is-plain-obj@4.1.0\n\u001b[0m\u001b[91mnpm WARN notsup Unsupported engine for is-plain-obj@4.1.0: wanted: {\"node\":\">=12\"} (current: {\"node\":\"10.24.1\",\"npm\":\"6.14.12\"})\nnpm\u001b[0m\u001b[91m WARN notsup Not compatible with your version of node/npm: is-plain-obj@4.1.0\n\u001b[0m\u001b[91mnpm WARN notsup Unsupported engine for parse-json@6.0.2: wanted: {\"node\":\"^12.20.0 || ^14.13.1 || >=16.0.0\"} (current: {\"node\":\"10.24.1\",\"npm\":\"6.14.12\"})\nnpm WARN\u001b[0m\u001b[91m notsup Not compatible with your version of node/npm: parse-json@6.0.2\n\u001b[0m\u001b[91mnpm WARN notsup Unsupported engine for lines-and-columns@2.0.3: wanted: {\"node\":\"^12.20.0 || ^14.13.1 || >=16.0.0\"} (current: {\"node\":\"10.24.1\",\"npm\":\"6.14.12\"})\nnpm WARN notsup\u001b[0m\u001b[91m Not compatible with your version of node/npm: lines-and-columns@2.0.3\n\u001b[0m\u001b[91mnpm WARN notsup Unsupported engine for supports-color@9.3.1: wanted: {\"node\":\">=12\"} (current: {\"node\":\"10.24.1\",\"npm\":\"6.14.12\"})\nnpm WARN notsup\u001b[0m\u001b[91m Not compatible with your version of node/npm: supports-color@9.3.1\n\u001b[0m\u001b[91m\n\u001b[0madded 143 packages from 269 contributors and audited 971 packages in 31.483s\n\n17 packages are looking for funding\n  run `npm fund` for details\n\nfound 5 vulnerabilities (3 moderate, 2 high)\n  run `npm audit fix` to fix them, or `npm audit` for details\nRemoving intermediate container 754bd94f87d5\n ---> 2a1c0bca604f\nStep 8/30 : FROM node:${NODE_VERSION} AS anon-user\n ---> 28dca6642db8\nStep 9/30 : RUN sed -i -r \"/^(root|nobody)/!d\" /etc/passwd /etc/shadow /etc/group     && sed -i -r 's#^(.*):[^:]*$#\\1:/sbin/nologin#' /etc/passwd\n ---> Running in af4d1ecb249d\nRemoving intermediate container af4d1ecb249d\n ---> 9276543c70a0\nStep 10/30 : FROM gcr.io/distroless/nodejs:${NODE_VERSION}\n10: Pulling from distroless/nodejs\nb49b96595fd4: Pulling fs layer\n9411f38bb959: Pulling fs layer\n39621572cdf6: Pulling fs layer\n4f6f25bbbbe6: Pulling fs layer\n4f6f25bbbbe6: Waiting\n39621572cdf6: Verifying Checksum\n39621572cdf6: Download complete\n9411f38bb959: Verifying Checksum\n9411f38bb959: Download complete\nb49b96595fd4: Download complete\nb49b96595fd4: Pull complete\n9411f38bb959: Pull complete\n39621572cdf6: Pull complete\n4f6f25bbbbe6: Verifying Checksum\n4f6f25bbbbe6: Download complete\n4f6f25bbbbe6: Pull complete\nDigest: sha256:f106757268ab4e650b032e78df0372a35914ed346c219359b58b3d863ad9fb58\nStatus: Downloaded newer image for gcr.io/distroless/nodejs:10\n ---> 184ac9a930ae\nStep 11/30 : ARG GITHUB_ACCOUNT\n ---> Running in 8becb1ea0581\nRemoving intermediate container 8becb1ea0581\n ---> 4c9f34ba332f\nStep 12/30 : ARG GITHUB_REPOSITORY\n ---> Running in ce8395b0be2e\nRemoving intermediate container ce8395b0be2e\n ---> c6afbae896c6\nStep 13/30 : ARG NODE_VERSION\n ---> Running in 6d597eb2bb59\nRemoving intermediate container 6d597eb2bb59\n ---> bb680de78ac6\nStep 14/30 : LABEL \"maintainer\"=\"FIWARE Identity Manager Team. DIT-UPM\"\n ---> Running in aadb196894bd\nRemoving intermediate container aadb196894bd\n ---> c96533a1f5f7\nStep 15/30 : LABEL \"org.opencontainers.image.authors\"=\"\"\n ---> Running in 888a27a8ef0b\nRemoving intermediate container 888a27a8ef0b\n ---> 63ccf8608545\nStep 16/30 : LABEL \"org.opencontainers.image.documentation\"=\"https://fiware-idm.readthedocs.io/\"\n ---> Running in dde3c2ca057c\nRemoving intermediate container dde3c2ca057c\n ---> c9835faf9269\nStep 17/30 : LABEL \"org.opencontainers.image.vendor\"=\"Universidad Politécnica de Madrid.\"\n ---> Running in 388d5a8ff6ae\nRemoving intermediate container 388d5a8ff6ae\n ---> 93c44497c064\nStep 18/30 : LABEL \"org.opencontainers.image.licenses\"=\"MIT\"\n ---> Running in 65ed4e583bf7\nRemoving intermediate container 65ed4e583bf7\n ---> e2bfc5b45086\nStep 19/30 : LABEL \"org.opencontainers.image.title\"=\"PEP Proxy - Wilma\"\n ---> Running in 87900e291298\nRemoving intermediate container 87900e291298\n ---> c6668ac3f150\nStep 20/30 : LABEL \"org.opencontainers.image.description\"=\"Support for proxy functions within OAuth2-based authentication schemas. Also implements PEP functions within an XACML-based access control schema.\"\n ---> Running in c96cdda52a29\nRemoving intermediate container c96cdda52a29\n ---> 9937c0be18ca\nStep 21/30 : LABEL \"org.opencontainers.image.source\"=https://github.com/${GITHUB_ACCOUNT}/${GITHUB_REPOSITORY}\n ---> Running in 152cececf35f\nRemoving intermediate container 152cececf35f\n ---> 9354e4e130ee\nStep 22/30 : LABEL \"org.nodejs.version\"=${NODE_VERSION}\n ---> Running in 5469028e999e\nRemoving intermediate container 5469028e999e\n ---> cf604390be9f\nStep 23/30 : COPY --from=builder /opt/fiware-pep-proxy /opt/fiware-pep-proxy\n ---> 8147dd88aa9c\nStep 24/30 : COPY --from=anon-user /etc/passwd /etc/shadow /etc/group /etc/\n ---> 2106a08f95d0\nStep 25/30 : WORKDIR /opt/fiware-pep-proxy\n ---> Running in 0f96f8d88734\nRemoving intermediate container 0f96f8d88734\n ---> ac80b2a08356\nStep 26/30 : USER nobody\n ---> Running in 94e8c418745d\nRemoving intermediate container 94e8c418745d\n ---> 2f400703da48\nStep 27/30 : ENV NODE_ENV=production\n ---> Running in 70214e37a909\nRemoving intermediate container 70214e37a909\n ---> 247dab3e7593\nStep 28/30 : EXPOSE ${PEP_PROXY_PORT:-1027}\n ---> Running in ae1a59f72196\nRemoving intermediate container ae1a59f72196\n ---> 979b8c7f6960\nStep 29/30 : CMD [\"./bin/www\"]\n ---> Running in d8268d5a2e3a\nRemoving intermediate container d8268d5a2e3a\n ---> c3d4a7457650\nStep 30/30 : HEALTHCHECK  --interval=30s --timeout=3s --start-period=60s   CMD [\"/nodejs/bin/node\", \"./bin/healthcheck\"]\n ---> Running in a7b047ca4c7d\nRemoving intermediate container a7b047ca4c7d\n ---> a79b9f6f40ea\nSuccessfully built a79b9f6f40ea\nSuccessfully tagged fiware-pep-proxy:latest\n","stderr":"","imageSize":106309013},"repair":{"violations":[{"name":"npmCacheCleanAfterInstall","position":{"start":13,"end":13,"columnStart":4,"columnEnd":59}}],"repairedDockerfile":"ARG NODE_VERSION=10\nARG GITHUB_ACCOUNT=ging\nARG GITHUB_REPOSITORY=fiware-pep-proxy\n\n########################################################################################\n#\n# This build stage retrieves the source code and sets up node-SAAS\n#\n######################################################################################## \n\nFROM node:${NODE_VERSION} as builder\nCOPY . /opt/fiware-pep-proxy\nWORKDIR /opt/fiware-pep-proxy\nRUN npm install --only=prod --no-package-lock --no-optional\n\n########################################################################################\n#\n# This build stage creates an anonymous user to be used with the distroless build\n# as defined below.\n#\n########################################################################################\nFROM node:${NODE_VERSION} AS anon-user\nRUN sed -i -r \"/^(root|nobody)/!d\" /etc/passwd /etc/shadow /etc/group \\\n    && sed -i -r 's#^(.*):[^:]*$#\\1:/sbin/nologin#' /etc/passwd\n\n########################################################################################\n#\n# This build stage creates a distroless image for production.\n#\n# IMPORTANT: For production environments use Docker Secrets to protect values of the \n# sensitive ENV variables defined below, by adding _FILE to the name of the relevant \n# variable.\n#\n# -  PEP_PROXY_USERNAME\n# -  PEP_PROXY_PASSWORD\n# -  PEP_PROXY_TOKEN_SECRET\n#\n########################################################################################\n\nFROM gcr.io/distroless/nodejs:${NODE_VERSION}\nARG GITHUB_ACCOUNT\nARG GITHUB_REPOSITORY\nARG NODE_VERSION\n\nLABEL \"maintainer\"=\"FIWARE Identity Manager Team. DIT-UPM\"\nLABEL \"org.opencontainers.image.authors\"=\"\"\nLABEL \"org.opencontainers.image.documentation\"=\"https://fiware-idm.readthedocs.io/\"\nLABEL \"org.opencontainers.image.vendor\"=\"Universidad Politécnica de Madrid.\"\nLABEL \"org.opencontainers.image.licenses\"=\"MIT\"\nLABEL \"org.opencontainers.image.title\"=\"PEP Proxy - Wilma\"\nLABEL \"org.opencontainers.image.description\"=\"Support for proxy functions within OAuth2-based authentication schemas. Also implements PEP functions within an XACML-based access control schema.\"\nLABEL \"org.opencontainers.image.source\"=https://github.com/${GITHUB_ACCOUNT}/${GITHUB_REPOSITORY}\nLABEL \"org.nodejs.version\"=${NODE_VERSION}\n\nCOPY --from=builder /opt/fiware-pep-proxy /opt/fiware-pep-proxy\nCOPY --from=anon-user /etc/passwd /etc/shadow /etc/group /etc/\nWORKDIR /opt/fiware-pep-proxy\n\nUSER nobody\nENV NODE_ENV=production\n# Ports used by application\nEXPOSE ${PEP_PROXY_PORT:-1027}\nCMD [\"./bin/www\"]\nHEALTHCHECK  --interval=30s --timeout=3s --start-period=60s \\\n  CMD [\"/nodejs/bin/node\", \"./bin/healthcheck\"]\n\n# \n# ALL ENVIRONMENT VARIABLES\n#\n#    PEP_PROXY_PORT\n#    PEP_PROXY_HTTPS_ENABLED\n#    PEP_PROXY_HTTPS_PORT\n#    PEP_PROXY_IDM_HOST\n#    PEP_PROXY_IDM_PORT\n#    PEP_PROXY_IDM_SSL_ENABLED\n#    PEP_PROXY_APP_HOST\n#    PEP_PROXY_APP_PORT\n#    PEP_PROXY_APP_SSL_ENABLED\n#    PEP_PROXY_ORG_ENABLED\n#    PEP_PROXY_ORG_HEADER\n#    PEP_PROXY_APP_ID\n#    PEP_PROXY_USERNAME\n#    PEP_PROXY_PASSWORD\n#    PEP_PROXY_TOKEN_SECRET\n#    PEP_PROXY_AUTH_ENABLED\n#    PEP_PROXY_PDP\n#    PEP_PROXY_PDP_PROTOCOL\n#    PEP_PROXY_PDP_HOST\n#    PEP_PROXY_PDP_PORT\n#    PEP_PROXY_PDP_PATH\n#    PEP_PROXY_TENANT_HEADER\n#    PEP_PROXY_AZF_CUSTOM_POLICY\n#    PEP_PROXY_PUBLIC_PATHS\n#    PEP_PROXY_CORS_ORIGIN\n#    PEP_PROXY_CORS_METHODS\n#    PEP_PROXY_CORS_OPTIONS_SUCCESS_STATUS\n#    PEP_PROXY_CORS_ALLOWED_HEADERS\n#    PEP_PROXY_CORS_CREDENTIALS\n#    PEP_PROXY_CORS_MAX_AGE\n#    PEP_PROXY_AUTH_FOR_NGINX\n#    PEP_PROXY_MAGIC_KEY\n#    PEP_PROXY_ERROR_TEMPLATE\n#    PEP_PROXY_ERROR_CONTENT_TYPE\n"},"repairedBuild":{"startTimestamp":1672462198692,"endTimestamp":1672462232951,"error":null,"stdout":"Sending build context to Docker daemon  1.833MB\r\r\nStep 1/30 : ARG NODE_VERSION=10\nStep 2/30 : ARG GITHUB_ACCOUNT=ging\nStep 3/30 : ARG GITHUB_REPOSITORY=fiware-pep-proxy\nStep 4/30 : FROM node:${NODE_VERSION} as builder\n ---> 28dca6642db8\nStep 5/30 : COPY . /opt/fiware-pep-proxy\n ---> 67480bcc7cf9\nStep 6/30 : WORKDIR /opt/fiware-pep-proxy\n ---> Running in db1f012e7122\nRemoving intermediate container db1f012e7122\n ---> 606844952e1a\nStep 7/30 : RUN npm install --only=prod --no-package-lock --no-optional\n ---> Running in 92fc116a563c\n\u001b[91mnpm WARN read-shrinkwrap This version of npm is compatible with lockfileVersion@1, but package-lock.json was generated for lockfileVersion@2. I'll try to do my best with it!\n\u001b[0m\u001b[91mnpm WARN \u001b[0m\u001b[91mdeprecated is-hex@1.1.3: Development of this module has been stopped.\n\u001b[0m\u001b[91mnpm WARN deprecated request@2.88.2: request has been deprecated, see https://github.com/request/request/issues/3142\n\u001b[0m\u001b[91mnpm WARN deprecated hoek@4.2.1: This version has been deprecated in accordance with the hapi support policy (hapi.im/support). Please upgrade to the latest version to get the best features, bug fixes, and security patches. If you are unable to upgrade at this time, paid support is available for older versions (hapi.im/commercial).\n\u001b[0m\u001b[91mnpm WARN deprecated joi@13.7.0: This version has been deprecated in accordance with the hapi support policy (hapi.im/support). Please upgrade to the latest version to get the best features, bug fixes, and security patches. If you are unable to upgrade at this time, paid support is available for older versions (hapi.im/commercial).\n\u001b[0m\u001b[91mnpm WARN deprecated har-validator@5.1.5: this library is no longer supported\n\u001b[0m\u001b[91mnpm WARN deprecated uuid@3.4.0: Please upgrade  to version 7 or higher.  Older versions may use Math.random() in certain circumstances, which is known to be problematic.  See https://v8.dev/blog/math-random for details.\n\u001b[0m\u001b[91mnpm WARN deprecated hoek@5.0.4: This version has been deprecated in accordance with the hapi support policy (hapi.im/support). Please upgrade to the latest version to get the best features, bug fixes, and security patches. If you are unable to upgrade at this time, paid support is available for older versions (hapi.im/commercial).\n\u001b[0m\u001b[91mnpm WARN deprecated topo@3.0.3: This module has moved and is now available at @hapi/topo. Please update your dependencies as this version is no longer maintained an may contain bugs and security issues.\n\u001b[0m\u001b[91mnpm WARN deprecated hoek@6.1.3: This module has moved and is now available at @hapi/hoek. Please update your dependencies as this version is no longer maintained an may contain bugs and security issues.\n\u001b[0m\u001b[91mnpm WARN deprecated libnpmconfig@1.2.1: This module is not used anymore. npm config is parsed by npm itself and by @npmcli/config\n\u001b[0m\n> node-expat@2.4.0 install /opt/fiware-pep-proxy/node_modules/node-expat\n> node-gyp rebuild\n\nmake: Entering directory '/opt/fiware-pep-proxy/node_modules/node-expat/build'\n  CC(target) Release/obj.target/expat/deps/libexpat/lib/xmlparse.o\n\u001b[91m../deps/libexpat/lib/xmlparse.c:6:32: warning: unknown option after '#pragma GCC diagnostic' kind [-Wpragmas]\n #pragma GCC diagnostic ignored \"-Wimplicit-fallthrough\"\n                                ^~~~~~~~~~~~~~~~~~~~~~~~\n\u001b[0m  CC(target) Release/obj.target/expat/deps/libexpat/lib/xmltok.o\n  CC(target) Release/obj.target/expat/deps/libexpat/lib/xmlrole.o\n  AR(target) Release/obj.target/deps/libexpat/libexpat.a\n  COPY Release/libexpat.a\n  CXX(target) Release/obj.target/node_expat/node-expat.o\n  SOLINK_MODULE(target) Release/obj.target/node_expat.node\n  COPY Release/node_expat.node\nmake: Leaving directory '/opt/fiware-pep-proxy/node_modules/node-expat/build'\n\u001b[91mnpm WARN notsup Unsupported engine for eslint@8.30.0: wanted: {\"node\":\"^12.22.0 || ^14.17.0 || >=16.0.0\"} (current: {\"node\":\"10.24.1\",\"npm\":\"6.14.12\"})\nnpm WARN notsup Not compatible with your version of node/npm: eslint@8.30.0\n\u001b[0m\u001b[91mnpm WARN notsup Unsupported engine for eslint-plugin-prettier@4.2.1: wanted: {\"node\":\">=12.0.0\"} (current: {\"node\":\"10.24.1\",\"npm\":\"6.14.12\"})\nnpm WARN notsup Not compatible with your version of node/npm: eslint-plugin-prettier@4.2.1\n\u001b[0m\u001b[91mnpm WARN notsup Unsupported engine for husky@7.0.4: wanted: {\"node\":\">=12\"} (current: {\"node\":\"10.24.1\",\"npm\":\"6.14.12\"})\nnpm WARN notsup Not compatible with your version of node/npm: husky@7.0.4\n\u001b[0m\u001b[91mnpm WARN notsup Unsupported engine for lint-staged@12.5.0: wanted: {\"node\":\"^12.20.0 || ^14.13.1 || >=16.0.0\"} (current: {\"node\":\"10.24.1\",\"npm\":\"6.14.12\"})\nnpm WARN \u001b[0m\u001b[91mnotsup Not compatible with your version of node/npm: lint-staged@12.5.0\n\u001b[0m\u001b[91mnpm WARN notsup Unsupported engine for mocha@9.2.2: wanted: {\"node\":\">= 12.0.0\"} (current: {\"node\":\"10.24.1\",\"npm\":\"6.14.12\"})\nnpm WARN \u001b[0m\u001b[91mnotsup Not compatible with your version of node/npm: mocha@9.2.2\n\u001b[0m\u001b[91mnpm WARN notsup Unsupported engine for textlint@12.3.1: wanted: {\"node\":\"^12.20.0 || ^14.13.1 || >=16.0.0\"} (current: {\"node\":\"10.24.1\",\"npm\":\"6.14.12\"})\nnpm WARN \u001b[0m\u001b[91mnotsup Not compatible with your version of node/npm: textlint@12.3.1\n\u001b[0m\u001b[91mnpm WARN notsup Unsupported engine for @humanwhocodes/module-importer@1.0.1: wanted: {\"node\":\">=12.22\"} (current: {\"node\":\"10.24.1\",\"npm\":\"6.14.12\"})\nnpm \u001b[0m\u001b[91mWARN notsup Not compatible with your version of node/npm: @humanwhocodes/module-importer@1.0.1\n\u001b[0m\u001b[91mnpm WARN notsup Unsupported engine for @eslint/eslintrc@1.4.1: wanted: {\"node\":\"^12.22.0 || ^14.17.0 || >=16.0.0\"} (current: {\"node\":\"10.24.1\",\"npm\":\"6.14.12\"})\nnpm WARN\u001b[0m\u001b[91m notsup Not compatible with your version of node/npm: @eslint/eslintrc@1.4.1\n\u001b[0m\u001b[91mnpm WARN notsup Unsupported engine for eslint-scope@7.1.1: wanted: {\"node\":\"^12.22.0 || ^14.17.0 || >=16.0.0\"} (current: {\"node\":\"10.24.1\",\"npm\":\"6.14.12\"})\nnpm WARN \u001b[0m\u001b[91mnotsup Not compatible with your version of node/npm: eslint-scope@7.1.1\n\u001b[0m\u001b[91mnpm WARN notsup Unsupported engine for espree@9.4.1: wanted: {\"node\":\"^12.22.0 || ^14.17.0 || >=16.0.0\"} (current: {\"node\":\"10.24.1\",\"npm\":\"6.14.12\"})\nnpm \u001b[0m\u001b[91mWARN notsup Not compatible with your version of node/npm: espree@9.4.1\n\u001b[0m\u001b[91mnpm WARN notsup Unsupported engine for eslint-visitor-keys@3.3.0: wanted: {\"node\":\"^12.22.0 || ^14.17.0 || >=16.0.0\"} (current: {\"node\":\"10.24.1\",\"npm\":\"6.14.12\"})\nnpm WARN \u001b[0m\u001b[91mnotsup Not compatible with your version of node/npm: eslint-visitor-keys@3.3.0\n\u001b[0m\u001b[91mnpm WARN notsup Unsupported engine for cli-truncate@3.1.0: wanted: {\"node\":\"^12.20.0 || ^14.13.1 || >=16.0.0\"} (current: {\"node\":\"10.24.1\",\"npm\":\"6.14.12\"})\nnpm WARN\u001b[0m\u001b[91m notsup Not compatible with your version of node/npm: cli-truncate@3.1.0\n\u001b[0m\u001b[91mnpm WARN notsup Unsupported engine for commander@9.4.1: wanted: {\"node\":\"^12.20.0 || >=14\"} (current: {\"node\":\"10.24.1\",\"npm\":\"6.14.12\"})\nnpm WARN notsup\u001b[0m\u001b[91m Not compatible with your version of node/npm: commander@9.4.1\n\u001b[0m\u001b[91mnpm WARN notsup Unsupported engine for listr2@4.0.5: wanted: {\"node\":\">=12\"} (current: {\"node\":\"10.24.1\",\"npm\":\"6.14.12\"})\nnpm WARN\u001b[0m\u001b[91m notsup Not compatible with your version of node/npm: listr2@4.0.5\n\u001b[0m\u001b[91mnpm WARN notsup Unsupported engine for supports-color@9.3.1: wanted: {\"node\":\">=12\"} (current: {\"node\":\"10.24.1\",\"npm\":\"6.14.12\"})\nnpm WARN notsup Not compatible with your version of node/npm: supports-color@9.3.1\n\u001b[0m\u001b[91mnpm WARN notsup Unsupported engine for slice-ansi@5.0.0: wanted: {\"node\":\">=12\"} (current: {\"node\":\"10.24.1\",\"npm\":\"6.14.12\"})\nnpm WARN notsup\u001b[0m\u001b[91m Not compatible with your version of node/npm: slice-ansi@5.0.0\n\u001b[0m\u001b[91mnpm WARN notsup Unsupported engine for string-width@5.1.2: wanted: {\"node\":\">=12\"} (current: {\"node\":\"10.24.1\",\"npm\":\"6.14.12\"})\nnpm WARN \u001b[0m\u001b[91mnotsup Not compatible with your version of node/npm: string-width@5.1.2\n\u001b[0m\u001b[91mnpm WARN notsup Unsupported engine for ansi-styles@6.2.1: wanted: {\"node\":\">=12\"} (current: {\"node\":\"10.24.1\",\"npm\":\"6.14.12\"})\nnpm WARN notsup\u001b[0m\u001b[91m Not compatible with your version of node/npm: ansi-styles@6.2.1\n\u001b[0m\u001b[91mnpm WARN notsup Unsupported engine for is-fullwidth-code-point@4.0.0: wanted: {\"node\":\">=12\"} (current: {\"node\":\"10.24.1\",\"npm\":\"6.14.12\"})\nnpm WARN notsup\u001b[0m\u001b[91m Not compatible with your version of node/npm: is-fullwidth-code-point@4.0.0\n\u001b[0m\u001b[91mnpm WARN notsup Unsupported engine for strip-ansi@7.0.1: wanted: {\"node\":\">=12\"} (current: {\"node\":\"10.24.1\",\"npm\":\"6.14.12\"})\nnpm WARN notsup Not compatible with your version of node/npm: strip-ansi@7.0.1\n\u001b[0m\u001b[91mnpm WARN notsup Unsupported engine for ansi-regex@6.0.1: wanted: {\"node\":\">=12\"} (current: {\"node\":\"10.24.1\",\"npm\":\"6.14.12\"})\nnpm WARN notsup\u001b[0m\u001b[91m Not compatible with your version of node/npm: ansi-regex@6.0.1\n\u001b[0m\u001b[91mnpm WARN optional SKIPPING OPTIONAL DEPENDENCY: fsevents@~2.3.2 (node_modules/chokidar/node_modules/fsevents):\nnpm WARN \u001b[0m\u001b[91mnotsup SKIPPING OPTIONAL DEPENDENCY: Unsupported platform for fsevents@2.3.2: wanted {\"os\":\"darwin\",\"arch\":\"any\"} (current: {\"os\":\"linux\",\"arch\":\"x64\"})\n\u001b[0m\u001b[91mnpm WARN notsup Unsupported engine for is-plain-obj@4.1.0: wanted: {\"node\":\">=12\"} (current: {\"node\":\"10.24.1\",\"npm\":\"6.14.12\"})\nnpm WARN\u001b[0m\u001b[91m notsup Not compatible with your version of node/npm: is-plain-obj@4.1.0\n\u001b[0m\u001b[91mnpm WARN notsup Unsupported engine for parse-json@6.0.2: wanted: {\"node\":\"^12.20.0 || ^14.13.1 || >=16.0.0\"} (current: {\"node\":\"10.24.1\",\"npm\":\"6.14.12\"})\nnpm WARN \u001b[0m\u001b[91mnotsup Not compatible with your version of node/npm: parse-json@6.0.2\n\u001b[0m\u001b[91mnpm WARN notsup Unsupported engine for is-plain-obj@4.1.0: wanted: {\"node\":\">=12\"} (current: {\"node\":\"10.24.1\",\"npm\":\"6.14.12\"})\nnpm\u001b[0m\u001b[91m WARN notsup Not compatible with your version of node/npm: is-plain-obj@4.1.0\n\u001b[0m\u001b[91mnpm WARN notsup Unsupported engine for lines-and-columns@2.0.3: wanted: {\"node\":\"^12.20.0 || ^14.13.1 || >=16.0.0\"} (current: {\"node\":\"10.24.1\",\"npm\":\"6.14.12\"})\nnpm WARN\u001b[0m\u001b[91m notsup Not compatible with your version of node/npm: lines-and-columns@2.0.3\n\u001b[0m\u001b[91mnpm WARN notsup Unsupported engine for supports-color@9.3.1: wanted: {\"node\":\">=12\"} (current: {\"node\":\"10.24.1\",\"npm\":\"6.14.12\"})\nnpm WARN \u001b[0m\u001b[91mnotsup Not compatible with your version of node/npm: supports-color@9.3.1\n\u001b[0m\u001b[91m\n\u001b[0madded 143 packages from 269 contributors and audited 971 packages in 17.126s\n\n17 packages are looking for funding\n  run `npm fund` for details\n\nfound 5 vulnerabilities (3 moderate, 2 high)\n  run `npm audit fix` to fix them, or `npm audit` for details\nRemoving intermediate container 92fc116a563c\n ---> 02e6882b64e1\nStep 8/30 : FROM node:${NODE_VERSION} AS anon-user\n ---> 28dca6642db8\nStep 9/30 : RUN sed -i -r \"/^(root|nobody)/!d\" /etc/passwd /etc/shadow /etc/group     && sed -i -r 's#^(.*):[^:]*$#\\1:/sbin/nologin#' /etc/passwd\n ---> Running in 25f69286868a\nRemoving intermediate container 25f69286868a\n ---> 03c585081a1c\nStep 10/30 : FROM gcr.io/distroless/nodejs:${NODE_VERSION}\n ---> 184ac9a930ae\nStep 11/30 : ARG GITHUB_ACCOUNT\n ---> Running in edd75102a330\nRemoving intermediate container edd75102a330\n ---> 6b098e0bc0c6\nStep 12/30 : ARG GITHUB_REPOSITORY\n ---> Running in fa53256d079e\nRemoving intermediate container fa53256d079e\n ---> 461cb5094b2a\nStep 13/30 : ARG NODE_VERSION\n ---> Running in 4d51663e3a19\nRemoving intermediate container 4d51663e3a19\n ---> 57519343a04c\nStep 14/30 : LABEL \"maintainer\"=\"FIWARE Identity Manager Team. DIT-UPM\"\n ---> Running in dbe17f061296\nRemoving intermediate container dbe17f061296\n ---> 4ef30b4ed0c3\nStep 15/30 : LABEL \"org.opencontainers.image.authors\"=\"\"\n ---> Running in de5ffbfaa523\nRemoving intermediate container de5ffbfaa523\n ---> bfabb1f16da7\nStep 16/30 : LABEL \"org.opencontainers.image.documentation\"=\"https://fiware-idm.readthedocs.io/\"\n ---> Running in e7965977a109\nRemoving intermediate container e7965977a109\n ---> 0a4f6ece3172\nStep 17/30 : LABEL \"org.opencontainers.image.vendor\"=\"Universidad Politécnica de Madrid.\"\n ---> Running in 72928739db2b\nRemoving intermediate container 72928739db2b\n ---> 0a4cb48cccc8\nStep 18/30 : LABEL \"org.opencontainers.image.licenses\"=\"MIT\"\n ---> Running in a46f7a083cec\nRemoving intermediate container a46f7a083cec\n ---> 9672765b6cfe\nStep 19/30 : LABEL \"org.opencontainers.image.title\"=\"PEP Proxy - Wilma\"\n ---> Running in 1321b4c386ac\nRemoving intermediate container 1321b4c386ac\n ---> 4ab833bf8f11\nStep 20/30 : LABEL \"org.opencontainers.image.description\"=\"Support for proxy functions within OAuth2-based authentication schemas. Also implements PEP functions within an XACML-based access control schema.\"\n ---> Running in a46acafe87be\nRemoving intermediate container a46acafe87be\n ---> f14cd2fae844\nStep 21/30 : LABEL \"org.opencontainers.image.source\"=https://github.com/${GITHUB_ACCOUNT}/${GITHUB_REPOSITORY}\n ---> Running in 2d5b8c7020ce\nRemoving intermediate container 2d5b8c7020ce\n ---> 20ab2e212fce\nStep 22/30 : LABEL \"org.nodejs.version\"=${NODE_VERSION}\n ---> Running in 4c8a950b05cd\nRemoving intermediate container 4c8a950b05cd\n ---> bcade4c9a608\nStep 23/30 : COPY --from=builder /opt/fiware-pep-proxy /opt/fiware-pep-proxy\n ---> 4d5b4b852fbf\nStep 24/30 : COPY --from=anon-user /etc/passwd /etc/shadow /etc/group /etc/\n ---> b23a2b8bbb89\nStep 25/30 : WORKDIR /opt/fiware-pep-proxy\n ---> Running in 67e75ee0bef4\nRemoving intermediate container 67e75ee0bef4\n ---> 5237f3008031\nStep 26/30 : USER nobody\n ---> Running in 5d2f43532263\nRemoving intermediate container 5d2f43532263\n ---> 16271d8f3eca\nStep 27/30 : ENV NODE_ENV=production\n ---> Running in 64290fa1845d\nRemoving intermediate container 64290fa1845d\n ---> 998cfeb28d5e\nStep 28/30 : EXPOSE ${PEP_PROXY_PORT:-1027}\n ---> Running in 1328038b8d21\nRemoving intermediate container 1328038b8d21\n ---> faca1a366fc0\nStep 29/30 : CMD [\"./bin/www\"]\n ---> Running in 0a5971ec9715\nRemoving intermediate container 0a5971ec9715\n ---> e0e9f5916673\nStep 30/30 : HEALTHCHECK  --interval=30s --timeout=3s --start-period=60s   CMD [\"/nodejs/bin/node\", \"./bin/healthcheck\"]\n ---> Running in 926e386d1ca4\nRemoving intermediate container 926e386d1ca4\n ---> 7a3b5e8eab47\nSuccessfully built 7a3b5e8eab47\nSuccessfully tagged fiware-pep-proxy:latest\n","stderr":"","imageSize":106309013},"endTime":1672462233274}