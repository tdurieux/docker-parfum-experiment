{"repository":"https://github.com/2anki/server","dockerfilePath":"Dockerfile","startTime":1672816790593,"clone":{"stdout":"","stderr":"Cloning into '/tmp/dinghy-analysis/2anki/server'...\n","error":null,"commit":"60ab36e650934fccd16d0d5d52bf26eb53265e23"},"originalBuild":{"startTimestamp":1672816792369,"endTimestamp":1672817280059,"error":null,"stdout":"Sending build context to Docker daemon  2.114MB\r\r\nStep 1/18 : FROM alemayhu/base-image-n2a\nlatest: Pulling from alemayhu/base-image-n2a\n6552179c3509: Pulling fs layer\nd4debff14640: Pulling fs layer\n1bdb8b461a93: Pulling fs layer\nff8b420e4fe8: Pulling fs layer\n76789d39bc4a: Pulling fs layer\neeb319d6e332: Pulling fs layer\n012681d33bad: Pulling fs layer\nf4e0aef23557: Pulling fs layer\nfc7a8e426e4c: Pulling fs layer\na4f7821398ff: Pulling fs layer\ndb0633a9b2c0: Pulling fs layer\n2f85e1129a87: Pulling fs layer\nff8b420e4fe8: Waiting\neeb319d6e332: Waiting\nf4e0aef23557: Waiting\n76789d39bc4a: Waiting\ndb0633a9b2c0: Waiting\nfc7a8e426e4c: Waiting\n2f85e1129a87: Waiting\na4f7821398ff: Waiting\n012681d33bad: Waiting\nd4debff14640: Download complete\n6552179c3509: Verifying Checksum\n6552179c3509: Download complete\nff8b420e4fe8: Verifying Checksum\nff8b420e4fe8: Download complete\n1bdb8b461a93: Verifying Checksum\n1bdb8b461a93: Download complete\n76789d39bc4a: Download complete\nf4e0aef23557: Verifying Checksum\nf4e0aef23557: Download complete\n012681d33bad: Verifying Checksum\n012681d33bad: Download complete\nfc7a8e426e4c: Download complete\n6552179c3509: Pull complete\nd4debff14640: Pull complete\ndb0633a9b2c0: Verifying Checksum\ndb0633a9b2c0: Download complete\na4f7821398ff: Verifying Checksum\na4f7821398ff: Download complete\n2f85e1129a87: Verifying Checksum\n2f85e1129a87: Download complete\n1bdb8b461a93: Pull complete\nff8b420e4fe8: Pull complete\n76789d39bc4a: Pull complete\neeb319d6e332: Verifying Checksum\neeb319d6e332: Download complete\neeb319d6e332: Pull complete\n012681d33bad: Pull complete\nf4e0aef23557: Pull complete\nfc7a8e426e4c: Pull complete\na4f7821398ff: Pull complete\ndb0633a9b2c0: Pull complete\n2f85e1129a87: Pull complete\nDigest: sha256:90f467e91be2151d88c83f87e48979e7cb1c6f5db23697038f9d604c9424315a\nStatus: Downloaded newer image for alemayhu/base-image-n2a:latest\n ---> d577e5294ee1\nStep 2/18 : RUN mkdir -pv /tmp/workspaces\n ---> Running in 9f07cb8ef686\nmkdir: created directory '/tmp/workspaces'\nRemoving intermediate container 9f07cb8ef686\n ---> a8d7d1a0cc7d\nStep 3/18 : WORKDIR /app\n ---> Running in e8c146d38a50\nRemoving intermediate container e8c146d38a50\n ---> e7fdf1a963da\nStep 4/18 : COPY . /app/server\n ---> c117e0b90e71\nStep 5/18 : RUN node --version\n ---> Running in 61c55a0334ae\nv16.13.2\nRemoving intermediate container 61c55a0334ae\n ---> f9f7eed10475\nStep 6/18 : RUN rm -rvf /app/node_modules\n ---> Running in a16b864192ca\nRemoving intermediate container a16b864192ca\n ---> 04ef25a6e022\nStep 7/18 : RUN git clone https://github.com/2anki/web /app/web\n ---> Running in 26d10089cdb8\n\u001b[91mCloning into '/app/web'...\n\u001b[0mRemoving intermediate container 26d10089cdb8\n ---> 5169d13ffb5b\nStep 8/18 : RUN git clone https://github.com/2anki/create_deck /app/create_deck\n ---> Running in 3bc493644563\n\u001b[91mCloning into '/app/create_deck'...\n\u001b[0mRemoving intermediate container 3bc493644563\n ---> f5b4f7424798\nStep 9/18 : RUN npm --prefix /app/web install\n ---> Running in 1dc2281fb5cf\n\u001b[91mnpm WARN deprecated mini-create-react-context@0.4.1: Package no longer supported. Contact Support at https://www.npmjs.com/support for more info.\n\u001b[0m\u001b[91mnpm WARN deprecated source-map-resolve@0.6.0: See https://github.com/lydell/source-map-resolve#deprecated\n\u001b[0m\nadded 1383 packages, and audited 1384 packages in 26s\n\n202 packages are looking for funding\n  run `npm fund` for details\n\n9 high severity vulnerabilities\n\nTo address issues that do not require attention, run:\n  npm audit fix\n\nTo address all issues (including breaking changes), run:\n  npm audit fix --force\n\nRun `npm audit` for details.\n\u001b[91mnpm notice\u001b[0m\u001b[91m \nnpm notice New major version of npm available! 8.1.2 -> 9.2.0\nnpm notice\u001b[0m\u001b[91m Changelog: <https://github.com/npm/cli/releases/tag/v9.2.0>\nnpm notice Run `npm install -g npm@9.2.0` to update!\nnpm notice \n\u001b[0mRemoving intermediate container 1dc2281fb5cf\n ---> 1c01cb483fdb\nStep 10/18 : RUN npm install typescript -g\n ---> Running in ecc2cb1f8fba\n\nadded 1 package, and audited 2 packages in 2s\n\nfound 0 vulnerabilities\nRemoving intermediate container ecc2cb1f8fba\n ---> 19f781df5b24\nStep 11/18 : RUN npm --prefix /app/server install\n ---> Running in c913024845a2\n\u001b[91mnpm WARN deprecated @types/dotenv@8.2.0: This is a stub types definition. dotenv provides its own type definitions, so you do not need this installed.\n\u001b[0m\n> notion2anki-server@1.0.0-alpha.41 prepare\n> cd .. && husky install .husky\n\n\u001b[91mfatal: not a git repository (or any of the parent directories): .git\n\u001b[0m\nadded 942 packages, and audited 943 packages in 14s\n\n120 packages are looking for funding\n  run `npm fund` for details\n\n2 high severity vulnerabilities\n\nTo address issues that do not require attention, run:\n  npm audit fix\n\nSome issues need review, and may require choosing\na different dependency.\n\nRun `npm audit` for details.\nRemoving intermediate container c913024845a2\n ---> dc3f4c5d6384\nStep 12/18 : RUN npm --prefix /app/server run build\n ---> Running in 42802947b2b9\n\n> notion2anki-server@1.0.0-alpha.41 build\n> tsc -p .\n\nRemoving intermediate container 42802947b2b9\n ---> dced26696744\nStep 13/18 : RUN npm --prefix /app/web run build\n ---> Running in 1cdc35cb807e\n\n> web@0.1.1 build\n> react-scripts build\n\nCreating an optimized production build...\n\u001b[91mBrowserslist: caniuse-lite is outdated. Please run:\n  npx browserslist@latest --update-db\n  Why you should do it regularly: https://github.com/browserslist/browserslist#browsers-data-updating\n\u001b[0m\u001b[91mBrowserslist: caniuse-lite is outdated. Please run:\n  npx browserslist@latest --update-db\n  Why you should do it regularly: https://github.com/browserslist/browserslist#browsers-data-updating\n\u001b[0mCompiled successfully.\n\nFile sizes after gzip:\n\n  128.33 kB  build/static/js/main.bdcdeffb.js\n  29.01 kB   build/static/css/main.0aebd5ef.css\n  24.72 kB   build/static/js/763.2dde2366.chunk.js\n  6.8 kB     build/static/js/811.c4be6022.chunk.js\n  4.64 kB    build/static/js/318.e2abce0d.chunk.js\n  2.84 kB    build/static/js/571.2830416a.chunk.js\n  2.73 kB    build/static/js/564.9c8a93d5.chunk.js\n  1.45 kB    build/static/js/247.baeff78e.chunk.js\n  1.04 kB    build/static/js/7.59bdfef4.chunk.js\n\nThe project was built assuming it is hosted at /.\nYou can control this with the homepage field in your package.json.\n\nThe build folder is ready to be deployed.\nYou may serve it with a static server:\n\n  npm install -g serve\n  serve -s build\n\nFind out more about deployment here:\n\n  https://cra.link/deployment\n\nRemoving intermediate container 1cdc35cb807e\n ---> 4c3c64a917f6\nStep 14/18 : RUN rm -rf /app/web/node_modules\n ---> Running in ecad34cd2829\nRemoving intermediate container ecad34cd2829\n ---> 7346ca0965bc\nStep 15/18 : ENV WEB_BUILD_DIR /app/web/build\n ---> Running in 0cef20d22d89\nRemoving intermediate container 0cef20d22d89\n ---> 0fc9a06ea888\nStep 16/18 : ENV PORT 8080\n ---> Running in 5347c61949d8\nRemoving intermediate container 5347c61949d8\n ---> 475a00ddbc84\nStep 17/18 : EXPOSE 8080\n ---> Running in c6c6f48c37fa\nRemoving intermediate container c6c6f48c37fa\n ---> 402247db6cf5\nStep 18/18 : CMD [\"node\", \"/app/server/src/server.js\"]\n ---> Running in 2adcc0ab0dfd\nRemoving intermediate container 2adcc0ab0dfd\n ---> e820506afce6\nSuccessfully built e820506afce6\nSuccessfully tagged server:latest\n","stderr":"","imageSize":1400783522},"repair":{"violations":[{"name":"npmCacheCleanAfterInstall","position":{"start":13,"end":13,"columnStart":4,"columnEnd":33}},{"name":"npmCacheCleanAfterInstall","position":{"start":15,"end":15,"columnStart":4,"columnEnd":29}},{"name":"npmCacheCleanAfterInstall","position":{"start":16,"end":16,"columnStart":4,"columnEnd":36}}],"repairedDockerfile":"FROM alemayhu/base-image-n2a\n\nRUN mkdir -pv /tmp/workspaces\n\nWORKDIR /app\n\nCOPY . /app/server\n\nRUN node --version\n\nRUN rm -rvf /app/node_modules\nRUN git clone https://github.com/2anki/web /app/web\nRUN git clone https://github.com/2anki/create_deck /app/create_deck\nRUN npm --prefix /app/web install\n\nRUN npm install typescript -g\nRUN npm --prefix /app/server install\n\nRUN npm --prefix /app/server run build\nRUN npm --prefix /app/web run build\n\n# Clean up\nRUN rm -rf /app/web/node_modules\n\nENV WEB_BUILD_DIR /app/web/build\nENV PORT 8080\nEXPOSE 8080\n\nCMD [\"node\", \"/app/server/src/server.js\"]\n"},"repairedBuild":{"startTimestamp":1672817285819,"endTimestamp":1672817824191,"error":null,"stdout":"Sending build context to Docker daemon  2.114MB\r\r\nStep 1/18 : FROM alemayhu/base-image-n2a\n ---> d577e5294ee1\nStep 2/18 : RUN mkdir -pv /tmp/workspaces\n ---> Running in 6c74c2facfdb\nmkdir: created directory '/tmp/workspaces'\nRemoving intermediate container 6c74c2facfdb\n ---> 2508c48585fa\nStep 3/18 : WORKDIR /app\n ---> Running in e5ac49f21b64\nRemoving intermediate container e5ac49f21b64\n ---> 84acaf323723\nStep 4/18 : COPY . /app/server\n ---> c3b819168ac1\nStep 5/18 : RUN node --version\n ---> Running in 47476d10faa9\nv16.13.2\nRemoving intermediate container 47476d10faa9\n ---> 018c6f1989cd\nStep 6/18 : RUN rm -rvf /app/node_modules\n ---> Running in 1613606b9940\nRemoving intermediate container 1613606b9940\n ---> 73a879ba65c1\nStep 7/18 : RUN git clone https://github.com/2anki/web /app/web\n ---> Running in aed6c2c033eb\n\u001b[91mCloning into '/app/web'...\n\u001b[0mRemoving intermediate container aed6c2c033eb\n ---> b305dd26dd53\nStep 8/18 : RUN git clone https://github.com/2anki/create_deck /app/create_deck\n ---> Running in 23d0b426c995\n\u001b[91mCloning into '/app/create_deck'...\n\u001b[0mRemoving intermediate container 23d0b426c995\n ---> dc2614175a93\nStep 9/18 : RUN npm --prefix /app/web install\n ---> Running in 6a19ca8558bb\n\u001b[91mnpm WARN deprecated mini-create-react-context@0.4.1: Package no longer supported. Contact Support at https://www.npmjs.com/support for more info.\n\u001b[0m\u001b[91mnpm WARN deprecated source-map-resolve@0.6.0: See https://github.com/lydell/source-map-resolve#deprecated\n\u001b[0m\nadded 1383 packages, and audited 1384 packages in 26s\n\n202 packages are looking for funding\n  run `npm fund` for details\n\n9 high severity vulnerabilities\n\nTo address issues that do not require attention, run:\n  npm audit fix\n\nTo address all issues (including breaking changes), run:\n  npm audit fix --force\n\nRun `npm audit` for details.\n\u001b[91mnpm notice\u001b[0m\u001b[91m \nnpm notice New major version of npm available! 8.1.2 -> 9.2.0\nnpm notice Changelog: <https://github.com/npm/cli/releases/tag/v9.2.0>\nnpm\u001b[0m\u001b[91m notice\u001b[0m\u001b[91m Run `npm install -g npm@9.2.0` to update!\nnpm notice\u001b[0m\u001b[91m \n\u001b[0mRemoving intermediate container 6a19ca8558bb\n ---> 3c958fa6c0f7\nStep 10/18 : RUN npm install typescript -g\n ---> Running in 8ab1a85ded20\n\nadded 1 package, and audited 2 packages in 1s\n\nfound 0 vulnerabilities\nRemoving intermediate container 8ab1a85ded20\n ---> 0de14b0fcfae\nStep 11/18 : RUN npm --prefix /app/server install\n ---> Running in fb780869c921\n\u001b[91mnpm WARN deprecated @types/dotenv@8.2.0: This is a stub types definition. dotenv provides its own type definitions, so you do not need this installed.\n\u001b[0m\n> notion2anki-server@1.0.0-alpha.41 prepare\n> cd .. && husky install .husky\n\n\u001b[91mfatal: not a git repository (or any of the parent directories): .git\n\u001b[0m\nadded 942 packages, and audited 943 packages in 16s\n\n120 packages are looking for funding\n  run `npm fund` for details\n\n2 high severity vulnerabilities\n\nTo address issues that do not require attention, run:\n  npm audit fix\n\nSome issues need review, and may require choosing\na different dependency.\n\nRun `npm audit` for details.\nRemoving intermediate container fb780869c921\n ---> 42f007b77545\nStep 12/18 : RUN npm --prefix /app/server run build\n ---> Running in 5c3dbd1ee0a8\n\n> notion2anki-server@1.0.0-alpha.41 build\n> tsc -p .\n\nRemoving intermediate container 5c3dbd1ee0a8\n ---> a3479865aa19\nStep 13/18 : RUN npm --prefix /app/web run build\n ---> Running in 87a02955a623\n\n> web@0.1.1 build\n> react-scripts build\n\nCreating an optimized production build...\n\u001b[91mBrowserslist: caniuse-lite is outdated. Please run:\n  npx browserslist@latest --update-db\n  Why you should do it regularly: https://github.com/browserslist/browserslist#browsers-data-updating\n\u001b[0m\u001b[91mBrowserslist: caniuse-lite is outdated. Please run:\n  npx browserslist@latest --update-db\n  Why you should do it regularly: https://github.com/browserslist/browserslist#browsers-data-updating\n\u001b[0mCompiled successfully.\n\nFile sizes after gzip:\n\n  128.33 kB  build/static/js/main.bdcdeffb.js\n  29.01 kB   build/static/css/main.0aebd5ef.css\n  24.72 kB   build/static/js/763.2dde2366.chunk.js\n  6.8 kB     build/static/js/811.c4be6022.chunk.js\n  4.64 kB    build/static/js/318.e2abce0d.chunk.js\n  2.84 kB    build/static/js/571.2830416a.chunk.js\n  2.73 kB    build/static/js/564.9c8a93d5.chunk.js\n  1.45 kB    build/static/js/247.baeff78e.chunk.js\n  1.04 kB    build/static/js/7.59bdfef4.chunk.js\n\nThe project was built assuming it is hosted at /.\nYou can control this with the homepage field in your package.json.\n\nThe build folder is ready to be deployed.\nYou may serve it with a static server:\n\n  npm install -g serve\n  serve -s build\n\nFind out more about deployment here:\n\n  https://cra.link/deployment\n\nRemoving intermediate container 87a02955a623\n ---> bf35ba00b950\nStep 14/18 : RUN rm -rf /app/web/node_modules\n ---> Running in b677c10a4075\nRemoving intermediate container b677c10a4075\n ---> 91c5ef0fe360\nStep 15/18 : ENV WEB_BUILD_DIR /app/web/build\n ---> Running in b4a14c562a4f\nRemoving intermediate container b4a14c562a4f\n ---> 39593fc35775\nStep 16/18 : ENV PORT 8080\n ---> Running in a662309cd5ba\nRemoving intermediate container a662309cd5ba\n ---> db0268ba97c2\nStep 17/18 : EXPOSE 8080\n ---> Running in 59e14ed69633\nRemoving intermediate container 59e14ed69633\n ---> af100073c5af\nStep 18/18 : CMD [\"node\", \"/app/server/src/server.js\"]\n ---> Running in 1509cced885c\nRemoving intermediate container 1509cced885c\n ---> 0ee2c59ecf73\nSuccessfully built 0ee2c59ecf73\nSuccessfully tagged server:latest\n","stderr":"","imageSize":1400779729},"endTime":1672817831387}