{"repository":"https://github.com/twitter/sqrl","dockerfilePath":"Dockerfile","startTime":1672428949863,"clone":{"stdout":"","stderr":"Cloning into '/tmp/dinghy-analysis/twitter/sqrl'...\n","error":null,"commit":"c5344dd006ccda82a1ae408d05172269feacd0d2"},"originalBuild":{"startTimestamp":1672428951611,"endTimestamp":1672429049568,"error":{"code":1,"killed":false,"signal":null,"cmd":"docker build --no-cache --force-rm -t sqrl:latest -f /tmp/dinghy-analysis/twitter/sqrl/Dockerfile ."},"stdout":"Sending build context to Docker daemon  6.054MB\r\r\nStep 1/16 : FROM node:8 as production\n8: Pulling from library/node\nDigest: sha256:a681bf74805b80d03eb21a6c0ef168a976108a287a74167ab593fc953aac34df\nStatus: Downloaded newer image for node:8\n ---> 8eeadf3757f4\nStep 2/16 : WORKDIR /app\n ---> Running in 04bd48366684\nRemoving intermediate container 04bd48366684\n ---> 101d22b5ea07\nStep 3/16 : COPY package*.json ./\n ---> 72fd4854eb7f\nStep 4/16 : RUN npm install --only=production\n ---> Running in 815b7c25401f\n\u001b[91mnpm\u001b[0m\u001b[91m WARN read-shrinkwrap This version of npm is compatible with lockfileVersion@1, but package-lock.json was generated for lockfileVersion@2. I'll try to do my best with it!\n\u001b[0madded 767 packages from 387 contributors and audited 1636 packages in 12.678s\n\n26 packages are looking for funding\n  run `npm fund` for details\n\nfound 345 vulnerabilities (13 low, 73 moderate, 227 high, 32 critical)\n  run `npm audit fix` to fix them, or `npm audit` for details\nRemoving intermediate container 815b7c25401f\n ---> 22526e7a209c\nStep 5/16 : FROM production as build\n ---> 22526e7a209c\nStep 6/16 : RUN npm install\n ---> Running in 0e1fd4b93521\n\n> bigint-buffer@1.1.5 install /app/node_modules/bigint-buffer\n> npm run rebuild || echo \"Couldn't build bindings. Non-native version used.\"\n\n\n> bigint-buffer@1.1.5 rebuild /app/node_modules/bigint-buffer\n> node-gyp rebuild\n\nmake: Entering directory '/app/node_modules/bigint-buffer/build'\n  CC(target) Release/obj.target/bigint_buffer/src/bigint-buffer.o\n\u001b[91m../src/bigint-buffer.c: In function 'toBigInt':\n../src/bigint-buffer.c:94:12: warning: implicit declaration of function 'napi_create_bigint_words' [-Wimplicit-function-declaration]\n   status = napi_create_bigint_words(env, 0, len_in_words, as_64_aligned , &out);\n            ^~~~~~~~~~~~~~~~~~~~~~~~\n\u001b[0m\u001b[91m../src/bigint-buffer.c: In function 'fromBigInt':\n../src/bigint-buffer.c:131:12: warning: implicit declaration of function 'napi_get_value_bigint_words' [-Wimplicit-function-declaration]\n   status = napi_get_value_bigint_words(env, argv[0], NULL, &word_count, NULL);\n            ^~~~~~~~~~~~~~~~~~~~~~~~~~~\n\u001b[0m  SOLINK_MODULE(target) Release/obj.target/bigint_buffer.node\n  COPY Release/bigint_buffer.node\nmake: Leaving directory '/app/node_modules/bigint-buffer/build'\n\n> re2@1.15.8 install /app/node_modules/re2\n> install-from-cache --artifact build/Release/re2.node --host-var RE2_DOWNLOAD_MIRROR || npm run rebuild\n\nTrying https://github.com/uhop/node-re2/releases/download/1.15.8/linux-x64-57.gz ...\nBuilding locally ...\n\n> re2@1.15.8 rebuild /app/node_modules/re2\n> node-gyp rebuild\n\nmake: Entering directory '/app/node_modules/re2/build'\n  CXX(target) Release/obj.target/re2/lib/addon.o\n\u001b[91m../lib/addon.cc:87:18: error: ISO C++ forbids declaration of 'NODE_MODULE_INIT' with no type [-fpermissive]\n NODE_MODULE_INIT()\n                  ^\n../lib/addon.cc: In function 'int NODE_MODULE_INIT()':\n../lib/addon.cc:90:11: error: 'module' was not declared in this scope\n  Nan::Set(module->ToObject(context).ToLocalChecked(), Nan::New(\"exports\").ToLocalChecked(), WrappedRE2::Init());\n           ^~~~~~\n../lib/addon.cc:90:28: error: 'context' was not declared in this scope\n  Nan::Set(module->ToObject(context).ToLocalChecked(), Nan::New(\"exports\").ToLocalChecked(), WrappedRE2::Init());\n                            ^~~~~~~\n../lib/addon.cc:90:28: note: suggested alternative:\nIn file included from ../lib/./wrapped_re2.h:6:0,\n                 from ../lib/addon.cc:1:\n../vendor/re2/re2.h:1004:32: note:   're2::hooks::context'\n extern thread_local const RE2* context;\n                                ^~~~~~~\n../lib/addon.cc:91:1: warning: no return statement in function returning non-void [-Wreturn-type]\n }\n ^\n\u001b[0m\u001b[91mAt global scope:\ncc1plus: warning: unrecognized command line option '-Wno-cast-function-type'\n\u001b[0mre2.target.mk:160: recipe for target 'Release/obj.target/re2/lib/addon.o' failed\n\u001b[91mmake: *** [Release/obj.target/re2/lib/addon.o] Error 1\n\u001b[0mmake: Leaving directory '/app/node_modules/re2/build'\n\u001b[91mgyp\u001b[0m\u001b[91m \u001b[0m\u001b[91mERR! build error \n\u001b[0m\u001b[91mgyp\u001b[0m\u001b[91m ERR! stack Error: `make` failed with exit code: 2\ngyp \u001b[0m\u001b[91mERR! stack     at ChildProcess.onExit (/usr/local/lib/node_modules/npm/node_modules/node-gyp/lib/build.js:194:23)\ngyp\u001b[0m\u001b[91m ERR! stack     at emitTwo (events.js:126:13)\ngyp\u001b[0m\u001b[91m ERR! stack     at ChildProcess.emit (events.js:214:7)\n\u001b[0m\u001b[91mgyp ERR! stack     at Process.ChildProcess._handle.onexit (internal/child_process.js:198:12)\n\u001b[0m\u001b[91mgyp\u001b[0m\u001b[91m ERR! System Linux 5.4.0-113-generic\n\u001b[0m\u001b[91mgyp\u001b[0m\u001b[91m ERR! command\u001b[0m\u001b[91m \"/usr/local/bin/node\" \"/usr/local/lib/node_modules/npm/node_modules/node-gyp/bin/node-gyp.js\" \"rebuild\"\ngyp\u001b[0m\u001b[91m ERR! cwd\u001b[0m\u001b[91m /app/node_modules/re2\ngyp ERR!\u001b[0m\u001b[91m node -v v8.17.0\ngyp\u001b[0m\u001b[91m ERR! node-gyp -v v5.0.5\n\u001b[0m\u001b[91mgyp ERR! not ok\u001b[0m\u001b[91m \n\u001b[0m\u001b[91mnpm ERR! code ELIFECYCLE\nnpm ERR! errno 1\n\u001b[0m\u001b[91mnpm\u001b[0m\u001b[91m ERR! re2@1.15.8 rebuild: `node-gyp rebuild`\nnpm ERR! Exit status 1\n\u001b[0m\u001b[91mnpm ERR! \nnpm ERR!\u001b[0m\u001b[91m Failed at the re2@1.15.8 rebuild script.\nnpm ERR! This is probably not a problem with npm. There is likely additional logging output above.\n\u001b[0m\u001b[91m\nnpm ERR! A complete log of this run can be found in:\nnpm ERR!     /root/.npm/_logs/2022-12-30T19_36_38_386Z-debug.log\n\u001b[0m\u001b[91m(node:81) UnhandledPromiseRejectionWarning: 1\n(node:81) UnhandledPromiseRejectionWarning: Unhandled promise rejection. This error originated either by throwing inside of an async function without a catch block, or by rejecting a promise which was not handled with .catch(). (rejection id: 1)\n(node:81) [DEP0018] DeprecationWarning: Unhandled promise rejections are deprecated. In the future, promise rejections that are not handled will terminate the Node.js process with a non-zero exit code.\n\u001b[0m\n> jsonpath@1.0.2 postinstall /app/node_modules/jsonpath\n> node lib/aesprim.js > generated/aesprim-browser.js\n\n\u001b[91mnpm WARN @octokit/plugin-request-log@1.0.2 requires a peer of @octokit/core@>=3 but none is installed. You must install peer dependencies yourself.\n\u001b[0m\u001b[91mnpm WARN optional SKIPPING OPTIONAL DEPENDENCY: fsevents@2.1.3 (node_modules/fsevents):\nnpm WARN \u001b[0m\u001b[91mnotsup SKIPPING OPTIONAL DEPENDENCY: Unsupported platform for fsevents@2.1.3: wanted {\"os\":\"darwin\",\"arch\":\"any\"} (current: {\"os\":\"linux\",\"arch\":\"x64\"})\n\u001b[0m\u001b[91m\n\u001b[0madded 865 packages from 394 contributors and audited 1636 packages in 17.182s\n\n44 packages are looking for funding\n  run `npm fund` for details\n\nfound 345 vulnerabilities (13 low, 73 moderate, 227 high, 32 critical)\n  run `npm audit fix` to fix them, or `npm audit` for details\nRemoving intermediate container 0e1fd4b93521\n ---> efd7c3e7b8df\nStep 7/16 : COPY . .\n ---> 7617549db0b4\nStep 8/16 : RUN npm run build\n ---> Running in 0bacbd6496e7\n\n> sqrl-monorepo@ build /app\n> lerna run build\n\n\u001b[91mlerna\u001b[0m\u001b[91m notice cli\u001b[0m\u001b[91m v3.22.1\n\u001b[0m\u001b[91mlerna info Executing command in 9 packages: \"npm run build\"\n\u001b[0m\u001b[91mlerna \u001b[0m\u001b[91minfo\u001b[0m\u001b[91m \u001b[0m\u001b[91mrun\u001b[0m\u001b[91m Ran npm script 'build' in 'sqrl-common' in 2.8s:\n\u001b[0m\n> sqrl-common@0.6.8 build /app/packages/sqrl-common\n> tsc --pretty\n\n\u001b[91mlerna info run Ran npm script 'build' in 'sqrl-test-utils' in 2.6s:\n\u001b[0m\n> sqrl-test-utils@0.6.8 build /app/packages/sqrl-test-utils\n> tsc --pretty\n\n\u001b[91mlerna info run Ran npm script 'build' in 'sqrl' in 4.5s:\n\u001b[0m\n> sqrl@0.6.8 build /app/packages/sqrl\n> tsc --pretty\n\n\u001b[91mlerna info run Ran npm script 'build' in 'sqrl-jsonpath' in 2.7s:\n\u001b[0m\n> sqrl-jsonpath@0.6.8 build /app/packages/sqrl-jsonpath\n> tsc --pretty\n\n\u001b[91mlerna info\u001b[0m\u001b[91m run Ran npm script 'build' in 'sqrl-load-functions' in 2.8s:\n\u001b[0m\n> sqrl-load-functions@0.6.8 build /app/packages/sqrl-load-functions\n> tsc --pretty\n\n\u001b[91mlerna info run Ran npm script 'build' in 'sqrl-cli-functions' in 2.9s:\n\u001b[0m\n> sqrl-cli-functions@0.6.8 build /app/packages/sqrl-cli-functions\n> tsc --pretty\n\n\u001b[91mlerna info\u001b[0m\u001b[91m run\u001b[0m\u001b[91m Ran npm script 'build' in 'sqrl-redis-functions' in 3.7s:\n\u001b[0m\n> sqrl-redis-functions@0.6.8 build /app/packages/sqrl-redis-functions\n> tsc --pretty\n\n\u001b[91mlerna info\u001b[0m\u001b[91m run\u001b[0m\u001b[91m Ran npm script 'build' in 'sqrl-text-functions' in 2.8s:\n\u001b[0m\n> sqrl-text-functions@0.6.8 build /app/packages/sqrl-text-functions\n> tsc --pretty\n\n\u001b[91mlerna info \u001b[0m\u001b[91mrun\u001b[0m\u001b[91m Ran npm script 'build' in 'sqrl-cli' in 3.3s:\n\u001b[0m\n> sqrl-cli@0.6.8 build /app/packages/sqrl-cli\n> tsc --pretty\n\n\u001b[91mlerna\u001b[0m\u001b[91m success\u001b[0m\u001b[91m \u001b[0m\u001b[91mrun Ran npm script 'build' in 9 packages in 18.8s:\n\u001b[0m\u001b[91mlerna \u001b[0m\u001b[91msuccess\u001b[0m\u001b[91m - sqrl-cli-functions\nlerna\u001b[0m\u001b[91m \u001b[0m\u001b[91msuccess\u001b[0m\u001b[91m - sqrl-cli\nlerna\u001b[0m\u001b[91m success\u001b[0m\u001b[91m - sqrl-common\nlerna \u001b[0m\u001b[91msuccess\u001b[0m\u001b[91m - sqrl-jsonpath\nlerna\u001b[0m\u001b[91m \u001b[0m\u001b[91msuccess - sqrl-load-functions\nlerna\u001b[0m\u001b[91m \u001b[0m\u001b[91msuccess\u001b[0m\u001b[91m - sqrl-redis-functions\nlerna\u001b[0m\u001b[91m success\u001b[0m\u001b[91m - sqrl-test-utils\nlerna\u001b[0m\u001b[91m success\u001b[0m\u001b[91m - sqrl-text-functions\nlerna\u001b[0m\u001b[91m \u001b[0m\u001b[91msuccess\u001b[0m\u001b[91m - sqrl\n\u001b[0mRemoving intermediate container 0bacbd6496e7\n ---> 91300560f488\nStep 9/16 : FROM node:8\n ---> 8eeadf3757f4\nStep 10/16 : WORKDIR /app\n ---> Running in e21768e0b3c3\nRemoving intermediate container e21768e0b3c3\n ---> 7f4d03e96074\nStep 11/16 : VOLUME /sqrl\n ---> Running in 474bc2ebe313\nRemoving intermediate container 474bc2ebe313\n ---> d1e2d945221b\nStep 12/16 : COPY --from=production /app /app\n ---> aeb1e1ec8674\nStep 13/16 : COPY --from=build /app/lib /app/lib\n","stderr":"COPY failed: stat app/lib: file does not exist\n"},"endTime":1672429049655}