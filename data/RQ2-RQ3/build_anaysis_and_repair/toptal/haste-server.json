{"repository":"https://github.com/toptal/haste-server","dockerfilePath":"Dockerfile","startTime":1673175872336,"endTime":1673175980672,"clone":{"startTime":1673175872351,"stdout":"","stderr":"Cloning into '/tmp/dinghy-analysis/toptal/haste-server'...\n","error":null,"endTime":1673175873208,"commit":"4550e4593cc0e85c5fafafebfb7de548d47f7036"},"originalBuild":{"startTime":1673175873476,"endTime":1673175969816,"error":null,"stdout":"Sending build context to Docker daemon  304.6kB\r\r\nStep 1/17 : FROM node:16-stretch\n16-stretch: Pulling from library/node\n8372a04f222b: Pulling fs layer\na1728fee80d3: Pulling fs layer\ne6cf50aa0a4b: Pulling fs layer\nf576518faec8: Pulling fs layer\nc64b5c196fad: Pulling fs layer\n440e02ff4d62: Pulling fs layer\n5b23516c4f30: Pulling fs layer\n175a5ab578cc: Pulling fs layer\n2cf70e0f2984: Pulling fs layer\n440e02ff4d62: Waiting\n5b23516c4f30: Waiting\n175a5ab578cc: Waiting\n2cf70e0f2984: Waiting\nf576518faec8: Waiting\nc64b5c196fad: Waiting\ne6cf50aa0a4b: Verifying Checksum\ne6cf50aa0a4b: Download complete\na1728fee80d3: Verifying Checksum\na1728fee80d3: Download complete\n8372a04f222b: Verifying Checksum\n8372a04f222b: Download complete\n440e02ff4d62: Verifying Checksum\n440e02ff4d62: Download complete\n5b23516c4f30: Verifying Checksum\n5b23516c4f30: Download complete\n175a5ab578cc: Verifying Checksum\n175a5ab578cc: Download complete\n2cf70e0f2984: Verifying Checksum\n2cf70e0f2984: Download complete\nc64b5c196fad: Verifying Checksum\nc64b5c196fad: Download complete\n8372a04f222b: Pull complete\na1728fee80d3: Pull complete\ne6cf50aa0a4b: Pull complete\nf576518faec8: Verifying Checksum\nf576518faec8: Download complete\nf576518faec8: Pull complete\nc64b5c196fad: Pull complete\n440e02ff4d62: Pull complete\n5b23516c4f30: Pull complete\n175a5ab578cc: Pull complete\n2cf70e0f2984: Pull complete\nDigest: sha256:5810de52349af302a2c5dddf0a3f31174ef65d0eed8985959a5e83bb1084b79b\nStatus: Downloaded newer image for node:16-stretch\n ---> 298c452ff7a9\nStep 2/17 : RUN mkdir -p /usr/src/app &&     chown node:node /usr/src/app\n ---> Running in 50eb341c7418\nRemoving intermediate container 50eb341c7418\n ---> aea193a2264d\nStep 3/17 : USER node:node\n ---> Running in b2e0f11d6861\nRemoving intermediate container b2e0f11d6861\n ---> 23c8796bd120\nStep 4/17 : WORKDIR /usr/src/app\n ---> Running in 1138751ed210\nRemoving intermediate container 1138751ed210\n ---> 9ace8d04e0f0\nStep 5/17 : COPY --chown=node:node . .\n ---> 0a2c308e6236\nStep 6/17 : RUN npm install &&     npm install redis@0.8.1 &&     npm install pg@4.5.7 &&     npm install memcached@2.2.2 &&     npm install aws-sdk@2.814.0 &&     npm install rethinkdbdash@2.3.31\n ---> Running in 607b85d9e712\n\u001b[91mnpm\u001b[0m\u001b[91m WARN old lockfile \nnpm \u001b[0m\u001b[91mWARN \u001b[0m\u001b[91mold lockfile\u001b[0m\u001b[91m The package-lock.json file was created with an old version of npm,\nnpm WARN \u001b[0m\u001b[91mold lockfile so supplemental metadata must be fetched from the registry.\nnpm WARN\u001b[0m\u001b[91m old lockfile \nnpm WARN old lockfile This is a one-time fix-up, please be patient...\n\u001b[0m\u001b[91mnpm WARN old lockfile \n\u001b[0m\u001b[91mnpm WARN deprecated flat@4.1.0: Fixed a prototype pollution security issue in 4.1.0, please upgrade to ^4.1.1 or ^5.0.1.\n\u001b[0m\u001b[91mnpm WARN deprecated async-cache@1.1.0: No longer maintained. Use [lru-cache](http://npm.im/lru-cache) version 7.6 or higher, and provide an asynchronous `fetchMethod` option.\n\u001b[0m\u001b[91mnpm WARN deprecated debug@4.1.1: Debug versions >=3.2.0 <3.2.7 || >=4 <4.3.1 have a low-severity ReDos regression when used in a Node.js environment. It is recommended you upgrade to 3.2.7 or 4.3.1. (https://github.com/visionmedia/debug/issues/797)\n\u001b[0m\nadded 203 packages, and audited 204 packages in 6s\n\n31 packages are looking for funding\n  run `npm fund` for details\n\n7 vulnerabilities (4 high, 3 critical)\n\nTo address issues that do not require attention, run:\n  npm audit fix\n\nTo address all issues (including breaking changes), run:\n  npm audit fix --force\n\nRun `npm audit` for details.\n\u001b[91mnpm\u001b[0m\u001b[91m notice \nnpm notice New major version of npm available! 8.11.0 -> 9.2.0\nnpm notice Changelog: <https://github.com/npm/cli/releases/tag/v9.2.0>\n\u001b[0m\u001b[91mnpm notice Run `npm install -g npm@9.2.0` to update!\n\u001b[0m\u001b[91mnpm notice \n\u001b[0m\nchanged 1 package, and audited 204 packages in 580ms\n\n31 packages are looking for funding\n  run `npm fund` for details\n\n7 vulnerabilities (4 high, 3 critical)\n\nTo address issues that do not require attention, run:\n  npm audit fix\n\nTo address all issues (including breaking changes), run:\n  npm audit fix --force\n\nRun `npm audit` for details.\n\nadded 3 packages, removed 2 packages, changed 10 packages, and audited 205 packages in 797ms\n\n31 packages are looking for funding\n  run `npm fund` for details\n\n7 vulnerabilities (4 high, 3 critical)\n\nTo address issues that do not require attention, run:\n  npm audit fix\n\nTo address all issues (including breaking changes), run:\n  npm audit fix --force\n\nRun `npm audit` for details.\n\nadded 6 packages, and audited 211 packages in 4s\n\n31 packages are looking for funding\n  run `npm fund` for details\n\n7 vulnerabilities (4 high, 3 critical)\n\nTo address issues that do not require attention, run:\n  npm audit fix\n\nTo address all issues (including breaking changes), run:\n  npm audit fix --force\n\nRun `npm audit` for details.\n\u001b[91mnpm WARN\u001b[0m\u001b[91m deprecated querystring@0.2.0: The querystring API is considered Legacy. new code should use the URLSearchParams API instead.\n\u001b[0m\u001b[91mnpm WARN deprecated uuid@3.3.2: Please upgrade  to version 7 or higher.  Older versions may use Math.random() in certain circumstances, which is known to be problematic.  See https://v8.dev/blog/math-random for details.\n\u001b[0m\nadded 12 packages, and audited 223 packages in 3s\n\n31 packages are looking for funding\n  run `npm fund` for details\n\n7 vulnerabilities (4 high, 3 critical)\n\nTo address issues that do not require attention, run:\n  npm audit fix\n\nTo address all issues (including breaking changes), run:\n  npm audit fix --force\n\nRun `npm audit` for details.\n\nadded 2 packages, and audited 225 packages in 3s\n\n31 packages are looking for funding\n  run `npm fund` for details\n\n7 vulnerabilities (4 high, 3 critical)\n\nTo address issues that do not require attention, run:\n  npm audit fix\n\nTo address all issues (including breaking changes), run:\n  npm audit fix --force\n\nRun `npm audit` for details.\nRemoving intermediate container 607b85d9e712\n ---> 4101acb8afca\nStep 7/17 : ENV STORAGE_TYPE=memcached     STORAGE_HOST=127.0.0.1     STORAGE_PORT=11211    STORAGE_EXPIRE_SECONDS=2592000    STORAGE_DB=2     STORAGE_AWS_BUCKET=     STORAGE_AWS_REGION=     STORAGE_USENAME=     STORAGE_PASSWORD=     STORAGE_FILEPATH=\n ---> Running in 8453c66563fd\nRemoving intermediate container 8453c66563fd\n ---> d445ef2b14d0\nStep 8/17 : ENV LOGGING_LEVEL=verbose     LOGGING_TYPE=Console     LOGGING_COLORIZE=true\n ---> Running in a7fc4fe86ef9\nRemoving intermediate container a7fc4fe86ef9\n ---> 7f6cbec752e0\nStep 9/17 : ENV HOST=0.0.0.0    PORT=7777    KEY_LENGTH=10    MAX_LENGTH=400000    STATIC_MAX_AGE=86400    RECOMPRESS_STATIC_ASSETS=true\n ---> Running in 47d392de7f60\nRemoving intermediate container 47d392de7f60\n ---> 3e5b72be196b\nStep 10/17 : ENV KEYGENERATOR_TYPE=phonetic     KEYGENERATOR_KEYSPACE=\n ---> Running in e34066ce6cf9\nRemoving intermediate container e34066ce6cf9\n ---> 87b76296a9b4\nStep 11/17 : ENV RATELIMITS_NORMAL_TOTAL_REQUESTS=500    RATELIMITS_NORMAL_EVERY_MILLISECONDS=60000     RATELIMITS_WHITELIST_TOTAL_REQUESTS=     RATELIMITS_WHITELIST_EVERY_MILLISECONDS=      RATELIMITS_WHITELIST=example1.whitelist,example2.whitelist         RATELIMITS_BLACKLIST_TOTAL_REQUESTS=     RATELIMITS_BLACKLIST_EVERY_MILLISECONDS=     RATELIMITS_BLACKLIST=example1.blacklist,example2.blacklist\n ---> Running in 58aabc465f34\nRemoving intermediate container 58aabc465f34\n ---> 828fa1b7b93a\nStep 12/17 : ENV DOCUMENTS=about=./about.md\n ---> Running in 8a16db095755\nRemoving intermediate container 8a16db095755\n ---> 12348602dd7d\nStep 13/17 : EXPOSE ${PORT}\n ---> Running in 5176d2fb1b19\nRemoving intermediate container 5176d2fb1b19\n ---> 3e4698cd0c07\nStep 14/17 : STOPSIGNAL SIGINT\n ---> Running in 14801c209f52\nRemoving intermediate container 14801c209f52\n ---> 6e3101dda937\nStep 15/17 : ENTRYPOINT [ \"bash\", \"docker-entrypoint.sh\" ]\n ---> Running in f3e3f27a9c72\nRemoving intermediate container f3e3f27a9c72\n ---> c3721c77ec0b\nStep 16/17 : HEALTHCHECK --interval=30s --timeout=30s --start-period=5s     --retries=3 CMD [ \"sh\", \"-c\", \"echo -n 'curl localhost:7777... ';     (        curl -sf localhost:7777 > /dev/null    ) && echo OK || (        echo Fail && exit 2    )\"]\n ---> Running in 7a2ed541377d\nRemoving intermediate container 7a2ed541377d\n ---> d66e371a34d3\nStep 17/17 : CMD [\"npm\", \"start\"]\n ---> Running in 5e3a7e614c55\nRemoving intermediate container 5e3a7e614c55\n ---> 929128f60cef\nSuccessfully built 929128f60cef\nSuccessfully tagged haste-server:latest\n","stderr":"","imageSize":1040457446},"repair":{"startTime":1673175969870,"endTime":1673175970015,"violations":[{"name":"npmCacheCleanAfterInstall","position":{"start":11,"end":11,"columnStart":4,"columnEnd":15}},{"name":"npmCacheCleanAfterInstall","position":{"start":12,"end":12,"columnStart":4,"columnEnd":27}},{"name":"npmCacheCleanAfterInstall","position":{"start":13,"end":13,"columnStart":4,"columnEnd":24}},{"name":"npmCacheCleanAfterInstall","position":{"start":14,"end":14,"columnStart":4,"columnEnd":31}},{"name":"npmCacheCleanAfterInstall","position":{"start":15,"end":15,"columnStart":4,"columnEnd":31}},{"name":"npmCacheCleanAfterInstall","position":{"start":16,"end":16,"columnStart":4,"columnEnd":36}},{"name":"mkdirUsrSrcThenRemove","position":{"start":2,"end":2,"columnStart":4,"columnEnd":25}}],"repairedDockerfile":"FROM node:16-stretch\n\nRUN mkdir -p /usr/src/app && \\\n    chown node:node /usr/src/app && rm -rf /usr/src/app\n\nUSER node:node\n\nWORKDIR /usr/src/app\n\nCOPY --chown=node:node . .\n\nRUN npm install && \\\n    npm install redis@0.8.1 && \\\n    npm install pg@4.5.7 && \\\n    npm install memcached@2.2.2 && \\\n    npm install aws-sdk@2.814.0 && \\\n    npm install rethinkdbdash@2.3.31 && npm cache clean --force;\n\nENV STORAGE_TYPE=memcached \\\n    STORAGE_HOST=127.0.0.1 \\\n    STORAGE_PORT=11211\\\n    STORAGE_EXPIRE_SECONDS=2592000\\\n    STORAGE_DB=2 \\\n    STORAGE_AWS_BUCKET= \\\n    STORAGE_AWS_REGION= \\\n    STORAGE_USENAME= \\\n    STORAGE_PASSWORD= \\\n    STORAGE_FILEPATH=\n\nENV LOGGING_LEVEL=verbose \\\n    LOGGING_TYPE=Console \\\n    LOGGING_COLORIZE=true\n\nENV HOST=0.0.0.0\\\n    PORT=7777\\\n    KEY_LENGTH=10\\\n    MAX_LENGTH=400000\\\n    STATIC_MAX_AGE=86400\\\n    RECOMPRESS_STATIC_ASSETS=true\n\nENV KEYGENERATOR_TYPE=phonetic \\\n    KEYGENERATOR_KEYSPACE=\n\nENV RATELIMITS_NORMAL_TOTAL_REQUESTS=500\\\n    RATELIMITS_NORMAL_EVERY_MILLISECONDS=60000 \\\n    RATELIMITS_WHITELIST_TOTAL_REQUESTS= \\\n    RATELIMITS_WHITELIST_EVERY_MILLISECONDS=  \\\n    # comma separated list for the whitelisted \\\n    RATELIMITS_WHITELIST=example1.whitelist,example2.whitelist \\\n    \\\n    RATELIMITS_BLACKLIST_TOTAL_REQUESTS= \\\n    RATELIMITS_BLACKLIST_EVERY_MILLISECONDS= \\\n    # comma separated list for the blacklisted \\\n    RATELIMITS_BLACKLIST=example1.blacklist,example2.blacklist\nENV DOCUMENTS=about=./about.md\n\nEXPOSE ${PORT}\nSTOPSIGNAL SIGINT\nENTRYPOINT [ \"bash\", \"docker-entrypoint.sh\" ]\n\nHEALTHCHECK --interval=30s --timeout=30s --start-period=5s \\\n    --retries=3 CMD [ \"sh\", \"-c\", \"echo -n 'curl localhost:7777... '; \\\n    (\\\n        curl -sf localhost:7777 > /dev/null\\\n    ) && echo OK || (\\\n        echo Fail && exit 2\\\n    )\"]\nCMD [\"npm\", \"start\"]\n"},"repairedBuild":{"startTime":1673175970431,"endTime":1673175980609,"error":{"code":243,"killed":false,"signal":null,"cmd":"docker build --no-cache --force-rm -t haste-server:latest -f /tmp/dinghy-analysis/toptal/haste-server/Dockerfile ."},"stdout":"Sending build context to Docker daemon  304.6kB\r\r\nStep 1/17 : FROM node:16-stretch\n ---> 298c452ff7a9\nStep 2/17 : RUN mkdir -p /usr/src/app &&     chown node:node /usr/src/app && rm -rf /usr/src/app\n ---> Running in bd95855cd292\nRemoving intermediate container bd95855cd292\n ---> 91538abd5111\nStep 3/17 : USER node:node\n ---> Running in 40c41af86708\nRemoving intermediate container 40c41af86708\n ---> 2902a98856c6\nStep 4/17 : WORKDIR /usr/src/app\n ---> Running in 14f2fcde5471\nRemoving intermediate container 14f2fcde5471\n ---> 5d0ace748a5e\nStep 5/17 : COPY --chown=node:node . .\n ---> 5e7826129d98\nStep 6/17 : RUN npm install &&     npm install redis@0.8.1 &&     npm install pg@4.5.7 &&     npm install memcached@2.2.2 &&     npm install aws-sdk@2.814.0 &&     npm install rethinkdbdash@2.3.31 && npm cache clean --force;\n ---> Running in 9e86e7ad2b4a\n\u001b[91mnpm \u001b[0m\u001b[91mWARN old lockfile \nnpm \u001b[0m\u001b[91mWARN old lockfile\u001b[0m\u001b[91m The package-lock.json file was created with an old version of npm,\nnpm WARN \u001b[0m\u001b[91mold lockfile so supplemental metadata must be fetched from the registry.\nnpm WARN\u001b[0m\u001b[91m old lockfile \nnpm WARN old lockfile This is a one-time fix-up, please be patient...\n\u001b[0m\u001b[91mnpm WARN old lockfile \n\u001b[0m\u001b[91mnpm notice \nnpm notice New major version of npm available! 8.11.0 -> 9.2.0\nnpm notice Changelog: <https://github.com/npm/cli/releases/tag/v9.2.0>\nnpm\u001b[0m\u001b[91m notice Run `npm install -g npm@9.2.0` to update!\nnpm notice \n\u001b[0m\u001b[91mnpm ERR! code EACCES\nnpm ERR! syscall mkdir\n\u001b[0m\u001b[91mnpm ERR! path /usr/src/app/node_modules\n\u001b[0m\u001b[91mnpm ERR! errno -13\n\u001b[0m\u001b[91mnpm ERR! Error: EACCES: permission denied, mkdir '/usr/src/app/node_modules'\nnpm ERR!  [Error: EACCES: permission denied, mkdir '/usr/src/app/node_modules'] {\nnpm ERR!   errno: -13,\nnpm ERR!   code: 'EACCES',\nnpm ERR!   syscall: 'mkdir',\nnpm ERR!   path: '/usr/src/app/node_modules'\nnpm \u001b[0m\u001b[91mERR! }\nnpm ERR! \nnpm ERR! The operation was rejected by your operating system.\nnpm ERR!\u001b[0m\u001b[91m It is likely you do not have the permissions to access this file as the current user\nnpm ERR! \nnpm ERR!\u001b[0m\u001b[91m If you believe this might be a permissions issue, please double-check the\nnpm ERR! permissions of the file and its containing directories, or try running\nnpm ERR! the command again as root/Administrator.\n\u001b[0m\u001b[91m\n\u001b[0m\u001b[91mnpm ERR! A complete log of this run can be found in:\nnpm ERR!\u001b[0m\u001b[91m     /home/node/.npm/_logs/2023-01-08T11_06_17_231Z-debug-0.log\n\u001b[0mRemoving intermediate container 9e86e7ad2b4a\n","stderr":"The command '/bin/sh -c npm install &&     npm install redis@0.8.1 &&     npm install pg@4.5.7 &&     npm install memcached@2.2.2 &&     npm install aws-sdk@2.814.0 &&     npm install rethinkdbdash@2.3.31 && npm cache clean --force;' returned a non-zero code: 243\n"}}