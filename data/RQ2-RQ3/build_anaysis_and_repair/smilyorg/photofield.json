{"repository":"https://github.com/smilyorg/photofield","dockerfilePath":"Dockerfile","startTime":1672909327833,"endTime":1672909773877,"clone":{"startTime":1672909327834,"stdout":"","stderr":"Cloning into '/tmp/dinghy-analysis/smilyorg/photofield'...\n","error":null,"endTime":1672909328969,"commit":"e3c6f02271a7fba17839ea1dd25e5faca753ec37"},"originalBuild":{"startTime":1672909329053,"endTime":1672909597808,"error":null,"stdout":"Sending build context to Docker daemon  7.927MB\r\r\nStep 1/25 : FROM node:16-alpine3.14 as node-builder\n16-alpine3.14: Pulling from library/node\n8663204ce13b: Pulling fs layer\nd19b13245430: Pulling fs layer\ne4a0f03ce8f3: Pulling fs layer\ne319ab3d00f8: Pulling fs layer\ne319ab3d00f8: Waiting\ne4a0f03ce8f3: Download complete\n8663204ce13b: Download complete\n8663204ce13b: Pull complete\nd19b13245430: Verifying Checksum\nd19b13245430: Download complete\ne319ab3d00f8: Verifying Checksum\ne319ab3d00f8: Download complete\nd19b13245430: Pull complete\ne4a0f03ce8f3: Pull complete\ne319ab3d00f8: Pull complete\nDigest: sha256:889139aa824c8b9dd29938eecfd300d51fc2e984f9cd03df391bcfbe9cf10b53\nStatus: Downloaded newer image for node:16-alpine3.14\n ---> 2680430c119d\nStep 2/25 : WORKDIR /ui\n ---> Running in 24fc95b4e0fd\nRemoving intermediate container 24fc95b4e0fd\n ---> 844ffc13ed92\nStep 3/25 : COPY ui/package-lock.json ui/package.json ./\n ---> 4379e05a6f03\nStep 4/25 : RUN npm install\n ---> Running in 0a2c0233092d\n\u001b[91mnpm WARN deprecated core-js@2.6.12: core-js@<3.23.3 is no longer maintained and not recommended for usage due to the number of issues. Because of the V8 engine whims, feature detection in old core-js versions could cause a slowdown up to 100x even if nothing is polyfilled. Some versions have web compatibility issues. Please, upgrade your dependencies to the actual version of core-js.\n\u001b[0m\nadded 295 packages, and audited 296 packages in 11s\n\n43 packages are looking for funding\n  run `npm fund` for details\n\n2 moderate severity vulnerabilities\n\nTo address all issues (including breaking changes), run:\n  npm audit fix --force\n\nRun `npm audit` for details.\n\u001b[91mnpm notice \nnpm notice New major version of npm available! 8.11.0 -> 9.2.0\nnpm notice Changelog: <https://github.com/npm/cli/releases/tag/v9.2.0>\nnpm notice\u001b[0m\u001b[91m Run `npm install -g npm@9.2.0` to update!\nnpm notice \n\u001b[0mRemoving intermediate container 0a2c0233092d\n ---> 81dc5d060998\nStep 5/25 : COPY ui .\n ---> d11a3103b3e1\nStep 6/25 : RUN npm run build\n ---> Running in 6c8fd8c1ddf4\n\n> photofield@0.0.0 build\n> vite build\n\nvite v2.9.14 building for production...\ntransforming...\n✓ 401 modules transformed.\nrendering chunks...\ndist/assets/roboto-cyrillic-ext-400-normal.b7ef2cd1.woff2   14.98 KiB\ndist/assets/roboto-vietnamese-400-normal.77b24796.woff2     5.43 KiB\ndist/assets/roboto-cyrillic-400-normal.495d38d4.woff2       9.40 KiB\ndist/assets/roboto-greek-400-normal.daf51ab5.woff2          6.95 KiB\ndist/assets/roboto-latin-ext-400-normal.3c23eb02.woff2      11.59 KiB\ndist/assets/roboto-latin-400-normal.f6734f81.woff2          15.38 KiB\ndist/assets/roboto-cyrillic-ext-300-normal.435e4b7f.woff2   14.65 KiB\ndist/assets/roboto-cyrillic-300-normal.47aa3bfa.woff2       9.35 KiB\ndist/assets/roboto-vietnamese-300-normal.51f3f418.woff2     5.34 KiB\ndist/assets/roboto-greek-300-normal.455c2c1a.woff2          6.95 KiB\ndist/assets/roboto-latin-ext-300-normal.b076e863.woff2      11.52 KiB\ndist/assets/roboto-latin-300-normal.f7591131.woff2          15.37 KiB\ndist/assets/roboto-cyrillic-ext-500-normal.aeed0e51.woff2   14.62 KiB\ndist/assets/roboto-cyrillic-500-normal.3728fbdd.woff2       9.61 KiB\ndist/assets/roboto-vietnamese-500-normal.0948409a.woff2     5.47 KiB\ndist/assets/roboto-greek-500-normal.713780d8.woff2          6.85 KiB\ndist/assets/roboto-latin-ext-500-normal.7f1c829b.woff2      11.52 KiB\ndist/assets/roboto-latin-500-normal.b0195382.woff2          15.55 KiB\ndist/assets/material-icons.69cec6db.woff2                   120.79 KiB\ndist/assets/material-icons-two-tone.9b25d522.woff2          202.34 KiB\ndist/assets/material-icons-outlined.7a778367.woff2          147.25 KiB\ndist/assets/material-icons-sharp.8339eb43.woff2             128.83 KiB\ndist/assets/material-icons-round.f41b199b.woff2             165.31 KiB\ndist/assets/roboto-all-400-normal.e41533d5.woff             63.92 KiB\ndist/assets/roboto-all-300-normal.6d79427c.woff             63.64 KiB\ndist/assets/roboto-all-500-normal.8f838c80.woff             64.21 KiB\ndist/assets/material-icons.84a767f9.woff                    155.04 KiB\ndist/index.html                                             0.71 KiB\ndist/assets/index.377438f0.css                              590.86 KiB / gzip: 68.80 KiB\ndist/assets/index.383a9586.js                               1423.34 KiB / gzip: 387.02 KiB\n\u001b[91m\n(!) Some chunks are larger than 500 KiB after minification. Consider:\n- Using dynamic import() to code-split the application\n- Use build.rollupOptions.output.manualChunks to improve chunking: https://rollupjs.org/guide/en/#outputmanualchunks\n- Adjust chunk size limit for this warning via build.chunkSizeWarningLimit.\n\u001b[0m\n✨ [vite-plugin-compression]:algorithm=gzip - compressed file successfully: \ndist//ui/assets/index.377438f0.css.gz   590.86kb / gzip: 68.06kb\ndist//ui/assets/index.383a9586.js.gz    1423.34kb / gzip: 385.86kb\n\n\nRemoving intermediate container 6c8fd8c1ddf4\n ---> 8ea517024d44\nStep 7/25 : FROM golang:1.17-alpine AS go-builder\n ---> 270c4f58750f\nStep 8/25 : WORKDIR /go/src/app\n ---> Running in 7a0c93a8088c\nRemoving intermediate container 7a0c93a8088c\n ---> d515b75846cd\nStep 9/25 : COPY go.mod go.sum ./\n ---> c46edc897001\nStep 10/25 : RUN go mod download\n ---> Running in 6cab5157a8a5\nRemoving intermediate container 6cab5157a8a5\n ---> f0991ee1ee72\nStep 11/25 : COPY *.go ./\n ---> ae355b97a2cd\nStep 12/25 : COPY defaults.yaml ./\n ---> c322e46111c8\nStep 13/25 : COPY internal ./internal\n ---> 04aacbaee73d\nStep 14/25 : COPY db ./db\n ---> 08392251f115\nStep 15/25 : COPY fonts ./fonts\n ---> debcd2a59c14\nStep 16/25 : COPY --from=node-builder /ui/dist/ ./ui/dist\n ---> 69367342ed2a\nStep 17/25 : RUN go install -tags embedstatic .\n ---> Running in 29a66f35c277\nRemoving intermediate container 29a66f35c277\n ---> d55bd0223ecf\nStep 18/25 : FROM alpine:3.14\n3.14: Pulling from library/alpine\nc7ed990a2339: Pulling fs layer\nc7ed990a2339: Verifying Checksum\nc7ed990a2339: Download complete\nc7ed990a2339: Pull complete\nDigest: sha256:4c869a63e1b7c0722fed1e402a6466610327c3b83bdddb94bd94fb71da7f638a\nStatus: Downloaded newer image for alpine:3.14\n ---> dd53f409bf0b\nStep 19/25 : RUN apk add --no-cache exiftool>12.06-r0\n ---> Running in 17bc8a19f57b\nRemoving intermediate container 17bc8a19f57b\n ---> 88ddb410870d\nStep 20/25 : COPY --from=go-builder /go/bin/ /app\n ---> b0115341c2bd\nStep 21/25 : WORKDIR /app\n ---> Running in 7cf1999c78fd\nRemoving intermediate container 7cf1999c78fd\n ---> 3853b76726df\nStep 22/25 : RUN mkdir ./data && touch ./data/configuration.yaml\n ---> Running in 3141fae8bab6\nRemoving intermediate container 3141fae8bab6\n ---> b4cff7c1bb44\nStep 23/25 : EXPOSE 8080\n ---> Running in 4c2cb6225918\nRemoving intermediate container 4c2cb6225918\n ---> e8d7c7fbdfd8\nStep 24/25 : ENV PHOTOFIELD_DATA_DIR=./data\n ---> Running in 3dfb915cd33a\nRemoving intermediate container 3dfb915cd33a\n ---> 8b129d8d2d1a\nStep 25/25 : CMD [\"./photofield\"]\n ---> Running in bf5521df8e65\nRemoving intermediate container bf5521df8e65\n ---> b2e683521d6a\nSuccessfully built b2e683521d6a\nSuccessfully tagged photofield:latest\n","stderr":"","imageSize":86660384},"repair":{"startTime":1672909597873,"endTime":1672909597953,"violations":[{"name":"npmCacheCleanAfterInstall","position":{"start":8,"end":8,"columnStart":4,"columnEnd":15}}],"repairedDockerfile":"###\n# Client\n###\nFROM node:16-alpine3.14 as node-builder\nWORKDIR /ui\n\n# install deps\nCOPY ui/package-lock.json ui/package.json ./\nRUN npm install && npm cache clean --force;\n\n# build\nCOPY ui .\nRUN npm run build\n\n\n\n###\n# Server\n###\nFROM golang:1.17-alpine AS go-builder\n# RUN apk add --no-cache gcc libffi-dev musl-dev libjpeg-turbo-dev\n\nWORKDIR /go/src/app\n\n# get deps\nCOPY go.mod go.sum ./\nRUN go mod download\n\n# build\nCOPY *.go ./\nCOPY defaults.yaml ./\nCOPY internal ./internal\nCOPY db ./db\nCOPY fonts ./fonts\n# RUN go install -tags libjpeg .\nCOPY --from=node-builder /ui/dist/ ./ui/dist\nRUN go install -tags embedstatic .\n\n\n\n###\n# Runtime\n###\nFROM alpine:3.14\n# RUN apk add --no-cache exiftool>12.06-r0 libjpeg-turbo\nRUN apk add --no-cache exiftool>12.06-r0\n\nCOPY --from=go-builder /go/bin/ /app\n\nWORKDIR /app\nRUN mkdir ./data && touch ./data/configuration.yaml\n\nEXPOSE 8080\nENV PHOTOFIELD_DATA_DIR=./data\nCMD [\"./photofield\"]\n"},"repairedBuild":{"startTime":1672909598165,"endTime":1672909773560,"error":null,"stdout":"Sending build context to Docker daemon  7.927MB\r\r\nStep 1/25 : FROM node:16-alpine3.14 as node-builder\n ---> 2680430c119d\nStep 2/25 : WORKDIR /ui\n ---> Running in b3356ce3dc7e\nRemoving intermediate container b3356ce3dc7e\n ---> 05b778572c37\nStep 3/25 : COPY ui/package-lock.json ui/package.json ./\n ---> ca59210c4bef\nStep 4/25 : RUN npm install && npm cache clean --force;\n ---> Running in 19a6812802af\n\u001b[91mnpm WARN deprecated core-js@2.6.12: core-js@<3.23.3 is no longer maintained and not recommended for usage due to the number of issues. Because of the V8 engine whims, feature detection in old core-js versions could cause a slowdown up to 100x even if nothing is polyfilled. Some versions have web compatibility issues. Please, upgrade your dependencies to the actual version of core-js.\n\u001b[0m\nadded 295 packages, and audited 296 packages in 13s\n\n43 packages are looking for funding\n  run `npm fund` for details\n\n2 moderate severity vulnerabilities\n\nTo address all issues (including breaking changes), run:\n  npm audit fix --force\n\nRun `npm audit` for details.\n\u001b[91mnpm notice \nnpm notice New major version of npm available! 8.11.0 -> 9.2.0\nnpm notice Changelog: <https://github.com/npm/cli/releases/tag/v9.2.0>\nnpm notice\u001b[0m\u001b[91m Run `npm install -g npm@9.2.0` to update!\nnpm notice \n\u001b[0m\u001b[91mnpm\u001b[0m\u001b[91m WARN using --force Recommended protections disabled.\n\u001b[0mRemoving intermediate container 19a6812802af\n ---> 60215d92134e\nStep 5/25 : COPY ui .\n ---> 72d40cab9438\nStep 6/25 : RUN npm run build\n ---> Running in 1a2bd4bb705a\n\n> photofield@0.0.0 build\n> vite build\n\nvite v2.9.14 building for production...\ntransforming...\n✓ 401 modules transformed.\nrendering chunks...\ndist/assets/roboto-cyrillic-ext-400-normal.b7ef2cd1.woff2   14.98 KiB\ndist/assets/roboto-cyrillic-400-normal.495d38d4.woff2       9.40 KiB\ndist/assets/roboto-vietnamese-400-normal.77b24796.woff2     5.43 KiB\ndist/assets/roboto-greek-400-normal.daf51ab5.woff2          6.95 KiB\ndist/assets/roboto-latin-ext-400-normal.3c23eb02.woff2      11.59 KiB\ndist/assets/roboto-latin-400-normal.f6734f81.woff2          15.38 KiB\ndist/assets/roboto-cyrillic-ext-300-normal.435e4b7f.woff2   14.65 KiB\ndist/assets/roboto-vietnamese-300-normal.51f3f418.woff2     5.34 KiB\ndist/assets/roboto-cyrillic-300-normal.47aa3bfa.woff2       9.35 KiB\ndist/assets/roboto-greek-300-normal.455c2c1a.woff2          6.95 KiB\ndist/assets/roboto-latin-ext-300-normal.b076e863.woff2      11.52 KiB\ndist/assets/roboto-latin-300-normal.f7591131.woff2          15.37 KiB\ndist/assets/roboto-cyrillic-ext-500-normal.aeed0e51.woff2   14.62 KiB\ndist/assets/roboto-cyrillic-500-normal.3728fbdd.woff2       9.61 KiB\ndist/assets/roboto-greek-500-normal.713780d8.woff2          6.85 KiB\ndist/assets/roboto-vietnamese-500-normal.0948409a.woff2     5.47 KiB\ndist/assets/roboto-latin-ext-500-normal.7f1c829b.woff2      11.52 KiB\ndist/assets/roboto-latin-500-normal.b0195382.woff2          15.55 KiB\ndist/assets/material-icons-round.f41b199b.woff2             165.31 KiB\ndist/assets/material-icons.69cec6db.woff2                   120.79 KiB\ndist/assets/material-icons-sharp.8339eb43.woff2             128.83 KiB\ndist/assets/material-icons-outlined.7a778367.woff2          147.25 KiB\ndist/assets/material-icons-two-tone.9b25d522.woff2          202.34 KiB\ndist/assets/roboto-all-400-normal.e41533d5.woff             63.92 KiB\ndist/assets/roboto-all-300-normal.6d79427c.woff             63.64 KiB\ndist/assets/roboto-all-500-normal.8f838c80.woff             64.21 KiB\ndist/assets/material-icons.84a767f9.woff                    155.04 KiB\ndist/index.html                                             0.71 KiB\ndist/assets/index.377438f0.css                              590.86 KiB / gzip: 68.80 KiB\ndist/assets/index.383a9586.js                               1423.34 KiB / gzip: 387.02 KiB\n\u001b[91m\n(!) Some chunks are larger than 500 KiB after minification. Consider:\n- Using dynamic import() to code-split the application\n- Use build.rollupOptions.output.manualChunks to improve chunking: https://rollupjs.org/guide/en/#outputmanualchunks\n- Adjust chunk size limit for this warning via build.chunkSizeWarningLimit.\n\u001b[0m\n✨ [vite-plugin-compression]:algorithm=gzip - compressed file successfully: \ndist//ui/assets/index.377438f0.css.gz   590.86kb / gzip: 68.06kb\ndist//ui/assets/index.383a9586.js.gz    1423.34kb / gzip: 385.86kb\n\n\nRemoving intermediate container 1a2bd4bb705a\n ---> 619a61590484\nStep 7/25 : FROM golang:1.17-alpine AS go-builder\n ---> 270c4f58750f\nStep 8/25 : WORKDIR /go/src/app\n ---> Running in d0ab1c7f721b\nRemoving intermediate container d0ab1c7f721b\n ---> 7d574bb7c14f\nStep 9/25 : COPY go.mod go.sum ./\n ---> 79077c3f8759\nStep 10/25 : RUN go mod download\n ---> Running in 30646b247db1\nRemoving intermediate container 30646b247db1\n ---> 040b1a0ff79b\nStep 11/25 : COPY *.go ./\n ---> a4f8cc1b8185\nStep 12/25 : COPY defaults.yaml ./\n ---> 48a2f6e8b3f3\nStep 13/25 : COPY internal ./internal\n ---> a9dc3adcb51f\nStep 14/25 : COPY db ./db\n ---> 67951b67c759\nStep 15/25 : COPY fonts ./fonts\n ---> bc1cb423f106\nStep 16/25 : COPY --from=node-builder /ui/dist/ ./ui/dist\n ---> bd99e1766be4\nStep 17/25 : RUN go install -tags embedstatic .\n ---> Running in 3fb7928a531c\nRemoving intermediate container 3fb7928a531c\n ---> a72d4a3dcccb\nStep 18/25 : FROM alpine:3.14\n ---> dd53f409bf0b\nStep 19/25 : RUN apk add --no-cache exiftool>12.06-r0\n ---> Running in cbd6bee68937\nRemoving intermediate container cbd6bee68937\n ---> 7b37f3f78c24\nStep 20/25 : COPY --from=go-builder /go/bin/ /app\n ---> 6acee93bb6fb\nStep 21/25 : WORKDIR /app\n ---> Running in 6148790156a6\nRemoving intermediate container 6148790156a6\n ---> 8e2ce7cdfd91\nStep 22/25 : RUN mkdir ./data && touch ./data/configuration.yaml\n ---> Running in 0bb3ed3ecde0\nRemoving intermediate container 0bb3ed3ecde0\n ---> 9bce5c3683c0\nStep 23/25 : EXPOSE 8080\n ---> Running in b7b29a75866b\nRemoving intermediate container b7b29a75866b\n ---> b6c0c5fdcb78\nStep 24/25 : ENV PHOTOFIELD_DATA_DIR=./data\n ---> Running in d0f5af15544e\nRemoving intermediate container d0f5af15544e\n ---> 5f0f84fd85bb\nStep 25/25 : CMD [\"./photofield\"]\n ---> Running in b64827f88353\nRemoving intermediate container b64827f88353\n ---> 4778babdf553\nSuccessfully built 4778babdf553\nSuccessfully tagged photofield:latest\n","stderr":"","imageSize":86660384}}