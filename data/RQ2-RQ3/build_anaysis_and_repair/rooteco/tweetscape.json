{"repository":"https://github.com/rooteco/tweetscape","dockerfilePath":"Dockerfile","startTime":1672723787004,"clone":{"stdout":"","stderr":"Cloning into '/tmp/dinghy-analysis/rooteco/tweetscape'...\nChecking out files:  95% (1503/1577)   \rChecking out files:  96% (1514/1577)   \rChecking out files:  97% (1530/1577)   \rChecking out files:  98% (1546/1577)   \rChecking out files:  99% (1562/1577)   \rChecking out files: 100% (1577/1577)   \rChecking out files: 100% (1577/1577), done.\n","error":null,"commit":"91fb23a5ee7f79cf453261b99bf7a69bfa7e76e6"},"originalBuild":{"startTimestamp":1672723801782,"endTimestamp":1672724192422,"error":null,"stdout":"Sending build context to Docker daemon  321.5MB\r\r\nStep 1/28 : FROM node:16-bullseye-slim as base\n16-bullseye-slim: Pulling from library/node\n3f4ca61aafcd: Already exists\n00fde01815c9: Pulling fs layer\n031949ce49ec: Pulling fs layer\n16cee6032317: Pulling fs layer\nfd35893cdbff: Pulling fs layer\nfd35893cdbff: Waiting\n00fde01815c9: Download complete\n16cee6032317: Verifying Checksum\n16cee6032317: Download complete\n00fde01815c9: Pull complete\nfd35893cdbff: Verifying Checksum\nfd35893cdbff: Download complete\n031949ce49ec: Verifying Checksum\n031949ce49ec: Download complete\n031949ce49ec: Pull complete\n16cee6032317: Pull complete\nfd35893cdbff: Pull complete\nDigest: sha256:30ec224b4c35a768e038674444d0718494a7d8847c96ee73a8d3db795135b4c9\nStatus: Downloaded newer image for node:16-bullseye-slim\n ---> b3b9a79a4762\nStep 2/28 : ENV NODE_ENV=production\n ---> Running in e2294938767a\nRemoving intermediate container e2294938767a\n ---> 62d3d42c5e34\nStep 3/28 : ENV PORT=8080\n ---> Running in 6aefa7d1683e\nRemoving intermediate container 6aefa7d1683e\n ---> 03ad741c3c95\nStep 4/28 : RUN apt-get update && apt-get install -y openssl\n ---> Running in 0a664f4c3c1b\nGet:1 http://deb.debian.org/debian bullseye InRelease [116 kB]\nGet:2 http://deb.debian.org/debian-security bullseye-security InRelease [48.4 kB]\nGet:3 http://deb.debian.org/debian bullseye-updates InRelease [44.1 kB]\nGet:4 http://deb.debian.org/debian bullseye/main amd64 Packages [8183 kB]\nGet:5 http://deb.debian.org/debian-security bullseye-security/main amd64 Packages [210 kB]\nGet:6 http://deb.debian.org/debian bullseye-updates/main amd64 Packages [14.6 kB]\nFetched 8616 kB in 3s (3151 kB/s)\nReading package lists...\nReading package lists...\nBuilding dependency tree...\nReading state information...\nSuggested packages:\n  ca-certificates\nThe following NEW packages will be installed:\n  openssl\n0 upgraded, 1 newly installed, 0 to remove and 0 not upgraded.\nNeed to get 853 kB of archives.\nAfter this operation, 1501 kB of additional disk space will be used.\nGet:1 http://deb.debian.org/debian bullseye/main amd64 openssl amd64 1.1.1n-0+deb11u3 [853 kB]\n\u001b[91mdebconf: delaying package configuration, since apt-utils is not installed\n\u001b[0mFetched 853 kB in 0s (4954 kB/s)\nSelecting previously unselected package openssl.\r\n(Reading database ... \r(Reading database ... 5%\r(Reading database ... 10%\r(Reading database ... 15%\r(Reading database ... 20%\r(Reading database ... 25%\r(Reading database ... 30%\r(Reading database ... 35%\r(Reading database ... 40%\r(Reading database ... 45%\r(Reading database ... 50%\r(Reading database ... 55%\r(Reading database ... 60%\r(Reading database ... 65%\r(Reading database ... 70%\r(Reading database ... 75%\r(Reading database ... 80%\r(Reading database ... 85%\r(Reading database ... 90%\r(Reading database ... 95%\r(Reading database ... 100%\r(Reading database ... 6661 files and directories currently installed.)\r\nPreparing to unpack .../openssl_1.1.1n-0+deb11u3_amd64.deb ...\r\nUnpacking openssl (1.1.1n-0+deb11u3) ...\r\nSetting up openssl (1.1.1n-0+deb11u3) ...\r\nRemoving intermediate container 0a664f4c3c1b\n ---> 38cdd69fc78b\nStep 5/28 : FROM base as deps\n ---> 38cdd69fc78b\nStep 6/28 : RUN mkdir /app\n ---> Running in 40abe545a674\nRemoving intermediate container 40abe545a674\n ---> ae059cf708ef\nStep 7/28 : WORKDIR /app\n ---> Running in e2a38f0f44ce\nRemoving intermediate container e2a38f0f44ce\n ---> 45cfeb09f732\nStep 8/28 : ADD package.json yarn.lock .yarnrc.yml ./\n ---> 26ef735ad61e\nStep 9/28 : ADD .yarn .yarn\n ---> 3a8ea63aa6e7\nStep 10/28 : RUN yarn install --immutable --immutable-cache\n ---> Running in 16f336777565\n➤ YN0000: ┌ Resolution step\n➤ YN0002: │ @remix-run/dev@npm:1.4.3 [5dab3] doesn't provide @babel/preset-env (pd28e2), requested by jscodeshift\n➤ YN0000: │ Some peer dependencies are incorrectly met; run yarn explain peer-requirements <hash> for details, where <hash> is the six-letter p-prefixed code\n➤ YN0000: └ Completed in 0s 207ms\n➤ YN0000: ┌ Fetch step\n➤ YN0000: └ Completed in 0s 358ms\n➤ YN0000: ┌ Link step\n➤ YN0007: │ cypress@npm:9.6.1 must be built because it never has been before or the last one failed\n➤ YN0007: │ esbuild@npm:0.14.38 must be built because it never has been before or the last one failed\n➤ YN0007: │ sharp@npm:0.30.4 must be built because it never has been before or the last one failed\n➤ YN0007: │ esbuild@npm:0.14.22 must be built because it never has been before or the last one failed\n➤ YN0007: │ @prisma/engines@npm:3.13.0-17.efdf9b1183dddfd4258cd181a72125755215ab7b must be built because it never has been before or the last one failed\n➤ YN0007: │ core-js@npm:2.6.12 must be built because it never has been before or the last one failed\n➤ YN0007: │ @percy/core@npm:1.1.3 must be built because it never has been before or the last one failed\n➤ YN0007: │ deasync@npm:0.1.24 must be built because it never has been before or the last one failed\n➤ YN0007: │ core-js-pure@npm:3.21.1 must be built because it never has been before or the last one failed\n➤ YN0007: │ prisma@npm:3.13.0 must be built because it never has been before or the last one failed\n➤ YN0007: │ @prisma/client@npm:3.13.0 [5dab3] must be built because it never has been before or the last one failed\n➤ YN0007: │ tweetscape@workspace:. must be built because it never has been before or the last one failed\n➤ YN0000: └ Completed in 1m 2s\n➤ YN0000: Done with warnings in 1m 3s\nRemoving intermediate container 16f336777565\n ---> abd980d553ca\nStep 11/28 : FROM deps as build\n ---> abd980d553ca\nStep 12/28 : WORKDIR /app\n ---> Running in 2fa0cd67d7ed\nRemoving intermediate container 2fa0cd67d7ed\n ---> 9aef8aa447bf\nStep 13/28 : ADD prisma .\n ---> 40e278c64d10\nStep 14/28 : RUN yarn prisma generate\n ---> Running in a295570e79e0\nPrisma schema loaded from schema.prisma\n\n✔ Generated Prisma Client (3.13.0 | library) to ./node_modules/@prisma/client in 1.85s\nYou can now start using Prisma Client in your code. Reference: https://pris.ly/d/client\n```\nimport { PrismaClient } from '@prisma/client'\nconst prisma = new PrismaClient()\n```\nRemoving intermediate container a295570e79e0\n ---> 4ce515d9db9b\nStep 15/28 : ADD . .\n ---> c10938f33e1e\nStep 16/28 : RUN yarn build\n ---> Running in 29a744f2d037\n\u001b[91mBrowserslist: caniuse-lite is outdated. Please run:\n  npx browserslist@latest --update-db\n  Why you should do it regularly: https://github.com/browserslist/browserslist#browsers-data-updating\n\u001b[0m\u001b[91mBrowserslist: caniuse-lite is outdated. Please run:\n  npx browserslist@latest --update-db\n  Why you should do it regularly: https://github.com/browserslist/browserslist#browsers-data-updating\n\u001b[0m\u001b[91m\nDone in 1352ms.\n\u001b[0mBuilding Remix app in production mode...\n\u001b[91mmdx-bundler is possibly an ESM only package and should be bundled with \"serverDependenciesToBundle in remix.config.js.\n\u001b[0mBuilt in 1.3s\nRemoving intermediate container 29a744f2d037\n ---> 0ec8ba3489ae\nStep 17/28 : FROM base\n ---> 38cdd69fc78b\nStep 18/28 : RUN mkdir /app\n ---> Running in d8372f7c4aa6\nRemoving intermediate container d8372f7c4aa6\n ---> 380c1634a6ff\nStep 19/28 : WORKDIR /app\n ---> Running in 78a50cb84f97\nRemoving intermediate container 78a50cb84f97\n ---> c373344ec66f\nStep 20/28 : COPY --from=build /app/node_modules /app/node_modules\n ---> 03c1231f73b2\nStep 21/28 : COPY --from=build /app/tsconfig.json /app/tsconfig.json\n ---> b62baff57bc4\nStep 22/28 : COPY --from=build /app/package.json /app/package.json\n ---> 136515a36d9b\nStep 23/28 : COPY --from=build /app/build /app/build\n ---> 13aca50341ef\nStep 24/28 : COPY --from=build /app/public /app/public\n ---> 00ede1e3a080\nStep 25/28 : COPY --from=build /app/changelog /app/changelog\n ---> 88d8cb959f91\nStep 26/28 : COPY --from=build /app/app /app/app\n ---> aaf0dd2f5f82\nStep 27/28 : EXPOSE 8080\n ---> Running in 6134c31a9197\nRemoving intermediate container 6134c31a9197\n ---> bc60dfe83218\nStep 28/28 : CMD [\"yarn\", \"start\"]\n ---> Running in f854862eafcb\nRemoving intermediate container f854862eafcb\n ---> 4d102896ff57\nSuccessfully built 4d102896ff57\nSuccessfully tagged tweetscape:latest\n","stderr":"","imageSize":787573505},"repair":{"violations":[{"name":"ruleAptGetInstallUseNoRec","position":{"start":7,"end":7,"columnStart":22,"columnEnd":48}},{"name":"ruleAptGetInstallThenRemoveAptLists","position":{"start":7,"end":7,"columnStart":22,"columnEnd":48}}],"repairedDockerfile":"# base node image\nFROM node:16-bullseye-slim as base\n\nENV NODE_ENV=production\nENV PORT=8080\n\n# install openssl for prisma\nRUN apt-get update && apt-get install --no-install-recommends -y openssl\n\n# install all node_modules, including dev dependencies\nFROM base as deps\n\nRUN mkdir /app\nWORKDIR /app\n\nADD package.json yarn.lock .yarnrc.yml ./\nADD .yarn .yarn\nRUN yarn install --immutable --immutable-cache\n\n# build the app\nFROM deps as build\n\nWORKDIR /app\n\nADD prisma .\nRUN yarn prisma generate\n\nADD . .\nRUN yarn build\n\n# finally, build the production image with minimal footprint\nFROM base\n\nRUN mkdir /app\nWORKDIR /app\n\nCOPY --from=build /app/node_modules /app/node_modules\nCOPY --from=build /app/tsconfig.json /app/tsconfig.json\nCOPY --from=build /app/package.json /app/package.json\nCOPY --from=build /app/build /app/build\nCOPY --from=build /app/public /app/public\nCOPY --from=build /app/changelog /app/changelog\nCOPY --from=build /app/app /app/app\n\nEXPOSE 8080\n\nCMD [\"yarn\", \"start\"]\n"},"repairedBuild":{"startTimestamp":1672724194186,"endTimestamp":1672724622670,"error":null,"stdout":"Sending build context to Docker daemon  321.5MB\r\r\nStep 1/28 : FROM node:16-bullseye-slim as base\n ---> b3b9a79a4762\nStep 2/28 : ENV NODE_ENV=production\n ---> Running in d8da7a0922ae\nRemoving intermediate container d8da7a0922ae\n ---> ce66ffeb73c8\nStep 3/28 : ENV PORT=8080\n ---> Running in 7b83f2f6d8e2\nRemoving intermediate container 7b83f2f6d8e2\n ---> a27a9d49a2c8\nStep 4/28 : RUN apt-get update && apt-get install --no-install-recommends -y openssl\n ---> Running in d1d3f1a0fdbf\nGet:1 http://deb.debian.org/debian bullseye InRelease [116 kB]\nGet:2 http://deb.debian.org/debian-security bullseye-security InRelease [48.4 kB]\nGet:3 http://deb.debian.org/debian bullseye-updates InRelease [44.1 kB]\nGet:4 http://deb.debian.org/debian bullseye/main amd64 Packages [8183 kB]\nGet:5 http://deb.debian.org/debian-security bullseye-security/main amd64 Packages [210 kB]\nGet:6 http://deb.debian.org/debian bullseye-updates/main amd64 Packages [14.6 kB]\nFetched 8616 kB in 1s (6716 kB/s)\nReading package lists...\nReading package lists...\nBuilding dependency tree...\nReading state information...\nSuggested packages:\n  ca-certificates\nThe following NEW packages will be installed:\n  openssl\n0 upgraded, 1 newly installed, 0 to remove and 0 not upgraded.\nNeed to get 853 kB of archives.\nAfter this operation, 1501 kB of additional disk space will be used.\nGet:1 http://deb.debian.org/debian bullseye/main amd64 openssl amd64 1.1.1n-0+deb11u3 [853 kB]\n\u001b[91mdebconf: delaying package configuration, since apt-utils is not installed\n\u001b[0mFetched 853 kB in 0s (30.0 MB/s)\nSelecting previously unselected package openssl.\r\n(Reading database ... \r(Reading database ... 5%\r(Reading database ... 10%\r(Reading database ... 15%\r(Reading database ... 20%\r(Reading database ... 25%\r(Reading database ... 30%\r(Reading database ... 35%\r(Reading database ... 40%\r(Reading database ... 45%\r(Reading database ... 50%\r(Reading database ... 55%\r(Reading database ... 60%\r(Reading database ... 65%\r(Reading database ... 70%\r(Reading database ... 75%\r(Reading database ... 80%\r(Reading database ... 85%\r(Reading database ... 90%\r(Reading database ... 95%\r(Reading database ... 100%\r(Reading database ... 6661 files and directories currently installed.)\r\nPreparing to unpack .../openssl_1.1.1n-0+deb11u3_amd64.deb ...\r\nUnpacking openssl (1.1.1n-0+deb11u3) ...\r\nSetting up openssl (1.1.1n-0+deb11u3) ...\r\nRemoving intermediate container d1d3f1a0fdbf\n ---> fc4961a7f6f7\nStep 5/28 : FROM base as deps\n ---> fc4961a7f6f7\nStep 6/28 : RUN mkdir /app\n ---> Running in bdb90cb377ce\nRemoving intermediate container bdb90cb377ce\n ---> 471ce0054d7a\nStep 7/28 : WORKDIR /app\n ---> Running in 129b68b2b294\nRemoving intermediate container 129b68b2b294\n ---> e030e9142c3f\nStep 8/28 : ADD package.json yarn.lock .yarnrc.yml ./\n ---> 18e893d74fa5\nStep 9/28 : ADD .yarn .yarn\n ---> f0ccf55324d1\nStep 10/28 : RUN yarn install --immutable --immutable-cache\n ---> Running in 562fcbdc36e0\n➤ YN0000: ┌ Resolution step\n➤ YN0002: │ @remix-run/dev@npm:1.4.3 [5dab3] doesn't provide @babel/preset-env (pd28e2), requested by jscodeshift\n➤ YN0000: │ Some peer dependencies are incorrectly met; run yarn explain peer-requirements <hash> for details, where <hash> is the six-letter p-prefixed code\n➤ YN0000: └ Completed in 0s 212ms\n➤ YN0000: ┌ Fetch step\n➤ YN0000: └ Completed in 0s 461ms\n➤ YN0000: ┌ Link step\n➤ YN0007: │ cypress@npm:9.6.1 must be built because it never has been before or the last one failed\n➤ YN0007: │ esbuild@npm:0.14.38 must be built because it never has been before or the last one failed\n➤ YN0007: │ sharp@npm:0.30.4 must be built because it never has been before or the last one failed\n➤ YN0007: │ esbuild@npm:0.14.22 must be built because it never has been before or the last one failed\n➤ YN0007: │ @prisma/engines@npm:3.13.0-17.efdf9b1183dddfd4258cd181a72125755215ab7b must be built because it never has been before or the last one failed\n➤ YN0007: │ core-js@npm:2.6.12 must be built because it never has been before or the last one failed\n➤ YN0007: │ @percy/core@npm:1.1.3 must be built because it never has been before or the last one failed\n➤ YN0007: │ deasync@npm:0.1.24 must be built because it never has been before or the last one failed\n➤ YN0007: │ core-js-pure@npm:3.21.1 must be built because it never has been before or the last one failed\n➤ YN0007: │ prisma@npm:3.13.0 must be built because it never has been before or the last one failed\n➤ YN0007: │ @prisma/client@npm:3.13.0 [5dab3] must be built because it never has been before or the last one failed\n➤ YN0007: │ tweetscape@workspace:. must be built because it never has been before or the last one failed\n➤ YN0000: └ Completed in 1m 1s\n➤ YN0000: Done with warnings in 1m 3s\nRemoving intermediate container 562fcbdc36e0\n ---> a02e328c4f3a\nStep 11/28 : FROM deps as build\n ---> a02e328c4f3a\nStep 12/28 : WORKDIR /app\n ---> Running in affbbb849ec0\nRemoving intermediate container affbbb849ec0\n ---> 5baa609c6a75\nStep 13/28 : ADD prisma .\n ---> 7b61c84a13ca\nStep 14/28 : RUN yarn prisma generate\n ---> Running in 12701ce2dc61\nPrisma schema loaded from schema.prisma\n\n✔ Generated Prisma Client (3.13.0 | library) to ./node_modules/@prisma/client in 477ms\nYou can now start using Prisma Client in your code. Reference: https://pris.ly/d/client\n```\nimport { PrismaClient } from '@prisma/client'\nconst prisma = new PrismaClient()\n```\nRemoving intermediate container 12701ce2dc61\n ---> 4d2c81bf6be2\nStep 15/28 : ADD . .\n ---> 107776e2f876\nStep 16/28 : RUN yarn build\n ---> Running in 9828e3477745\n\u001b[91mBrowserslist: caniuse-lite is outdated. Please run:\n  npx browserslist@latest --update-db\n  Why you should do it regularly: https://github.com/browserslist/browserslist#browsers-data-updating\n\u001b[0m\u001b[91mBrowserslist: caniuse-lite is outdated. Please run:\n  npx browserslist@latest --update-db\n  Why you should do it regularly: https://github.com/browserslist/browserslist#browsers-data-updating\n\u001b[0m\u001b[91m\nDone in 682ms.\n\u001b[0mBuilding Remix app in production mode...\n\u001b[91mmdx-bundler is possibly an ESM only package and should be bundled with \"serverDependenciesToBundle in remix.config.js.\n\u001b[0mBuilt in 604ms\nRemoving intermediate container 9828e3477745\n ---> 95380efac2f4\nStep 17/28 : FROM base\n ---> fc4961a7f6f7\nStep 18/28 : RUN mkdir /app\n ---> Running in 1918d6ac87d0\nRemoving intermediate container 1918d6ac87d0\n ---> 480c664b6e58\nStep 19/28 : WORKDIR /app\n ---> Running in 6ec295d603e0\nRemoving intermediate container 6ec295d603e0\n ---> 9eccfa6fceb7\nStep 20/28 : COPY --from=build /app/node_modules /app/node_modules\n ---> e2dc0230b5b9\nStep 21/28 : COPY --from=build /app/tsconfig.json /app/tsconfig.json\n ---> e7111cc10297\nStep 22/28 : COPY --from=build /app/package.json /app/package.json\n ---> 52278e191412\nStep 23/28 : COPY --from=build /app/build /app/build\n ---> 6a45280005c1\nStep 24/28 : COPY --from=build /app/public /app/public\n ---> cd43f09f076a\nStep 25/28 : COPY --from=build /app/changelog /app/changelog\n ---> 4d4c5acef16e\nStep 26/28 : COPY --from=build /app/app /app/app\n ---> bc887244e531\nStep 27/28 : EXPOSE 8080\n ---> Running in ecc2eab7d471\nRemoving intermediate container ecc2eab7d471\n ---> 830bf3f2b8b8\nStep 28/28 : CMD [\"yarn\", \"start\"]\n ---> Running in f56a1563a854\nRemoving intermediate container f56a1563a854\n ---> 35f58236bd4c\nSuccessfully built 35f58236bd4c\nSuccessfully tagged tweetscape:latest\n","stderr":"","imageSize":787573529},"endTime":1672724624672}