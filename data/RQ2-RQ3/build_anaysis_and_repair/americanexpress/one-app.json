{"repository":"https://github.com/americanexpress/one-app","dockerfilePath":"Dockerfile","startTime":1672779696897,"clone":{"stdout":"","stderr":"Cloning into '/tmp/dinghy-analysis/americanexpress/one-app'...\n","error":null,"commit":"186fc90fc9b751575eaca1351441fd3823b3d984"},"originalBuild":{"startTimestamp":1672779697990,"endTimestamp":1672780909766,"error":null,"stdout":"Sending build context to Docker daemon   2.53MB\r\r\nStep 1/30 : FROM node:16.16.0 as builder\n16.16.0: Pulling from library/node\n7e6a53d1988f: Pulling fs layer\n4fe4e1c58b4a: Pulling fs layer\ncc915d298757: Pulling fs layer\nf08b88f29371: Pulling fs layer\n28bcb226aca8: Pulling fs layer\n4ed42ef80d39: Pulling fs layer\nbebe51b791bc: Pulling fs layer\n986a235ce43f: Pulling fs layer\n92cdf774b883: Pulling fs layer\nf08b88f29371: Waiting\n28bcb226aca8: Waiting\nbebe51b791bc: Waiting\n986a235ce43f: Waiting\n4ed42ef80d39: Waiting\n92cdf774b883: Waiting\ncc915d298757: Verifying Checksum\ncc915d298757: Download complete\n4fe4e1c58b4a: Verifying Checksum\n4fe4e1c58b4a: Download complete\n7e6a53d1988f: Verifying Checksum\n7e6a53d1988f: Download complete\n4ed42ef80d39: Download complete\nf08b88f29371: Verifying Checksum\nf08b88f29371: Download complete\n986a235ce43f: Verifying Checksum\n986a235ce43f: Download complete\n92cdf774b883: Download complete\nbebe51b791bc: Verifying Checksum\nbebe51b791bc: Download complete\n7e6a53d1988f: Pull complete\n28bcb226aca8: Verifying Checksum\n28bcb226aca8: Download complete\n4fe4e1c58b4a: Pull complete\ncc915d298757: Pull complete\nf08b88f29371: Pull complete\n28bcb226aca8: Pull complete\n4ed42ef80d39: Pull complete\nbebe51b791bc: Pull complete\n986a235ce43f: Pull complete\n92cdf774b883: Pull complete\nDigest: sha256:1ed1e17ccabb09038cfb8a965337ebcda51ef9e9d32082164c502d44d9731a02\nStatus: Downloaded newer image for node:16.16.0\n ---> 954cea825b78\nStep 2/30 : WORKDIR /opt/build\n ---> Running in 34756ce66c79\nRemoving intermediate container 34756ce66c79\n ---> e5c5ef99410f\nStep 3/30 : RUN npm install -g npm@8.8.0 --registry=https://registry.npmjs.org\n ---> Running in da52487ad187\n\u001b[91mnpm\u001b[0m\u001b[91m WARN config global `--global`, `--local` are deprecated. Use `--location=global` instead.\n\u001b[0m\nchanged 25 packages, and audited 202 packages in 49s\n\n11 packages are looking for funding\n  run `npm fund` for details\n\n1 high severity vulnerability\n\nTo address all issues, run:\n  npm audit fix --force\n\nRun `npm audit` for details.\nRemoving intermediate container da52487ad187\n ---> 2c4a72acf52f\nStep 4/30 : COPY --chown=node:node ./ /opt/build\n ---> c1fb3232342d\nStep 5/30 : RUN NODE_ENV=development npm ci --build-from-source\n ---> Running in 1b2193bcc063\n\u001b[91mnpm WARN \u001b[0m\u001b[91mdeprecated urix@0.1.0: Please see https://github.com/lydell/urix#deprecated\n\u001b[0m\u001b[91mnpm WARN deprecated url-search-params@0.10.2: now available as @ungap/url-search-params\n\u001b[0m\u001b[91mnpm WARN deprecated source-map-resolve@0.5.3: See https://github.com/lydell/source-map-resolve#deprecated\n\u001b[0m\u001b[91mnpm WARN deprecated source-map-url@0.4.1: See https://github.com/lydell/source-map-url#deprecated\n\u001b[0m\u001b[91mnpm WARN deprecated resolve-url@0.2.1: https://github.com/lydell/resolve-url#deprecated\n\u001b[0m\u001b[91mnpm WARN deprecated rollup-plugin-babel@4.4.0: This package has been deprecated and is no longer maintained. Please use @rollup/plugin-babel.\n\u001b[0m\u001b[91mnpm WARN deprecated querystring@0.2.0: The querystring API is considered Legacy. new code should use the URLSearchParams API instead.\n\u001b[0m\u001b[91mnpm WARN deprecated request@2.88.2: request has been deprecated, see https://github.com/request/request/issues/3142\n\u001b[0m\u001b[91mnpm WARN \u001b[0m\u001b[91mdeprecated har-validator@5.1.5: this library is no longer supported\n\u001b[0m\u001b[91mnpm WARN deprecated html-webpack-plugin@3.2.0: 3.x is no longer supported\n\u001b[0m\u001b[91mnpm WARN deprecated eslint-loader@4.0.2: This loader has been deprecated. Please use eslint-webpack-plugin\n\u001b[0m\u001b[91mnpm WARN deprecated babel-eslint@10.1.0: babel-eslint is now @babel/eslint-parser. This package will no longer receive updates.\n\u001b[0m\u001b[91mnpm WARN deprecated chokidar@2.1.8: Chokidar 2 does not receive security updates since 2019. Upgrade to chokidar 3 with 15x fewer dependencies\n\u001b[0m\u001b[91mnpm WARN deprecated uuid@3.4.0: Please upgrade  to version 7 or higher.  Older versions may use Math.random() in certain circumstances, which is known to be problematic.  See https://v8.dev/blog/math-random for details.\n\u001b[0m\u001b[91mnpm WARN deprecated uuid@3.4.0: Please upgrade  to version 7 or higher.  Older versions may use Math.random() in certain circumstances, which is known to be problematic.  See https://v8.dev/blog/math-random for details.\n\u001b[0m\u001b[91mnpm WARN deprecated core-js@2.6.12: core-js@<3.23.3 is no longer maintained and not recommended for usage due to the number of issues. Because of the V8 engine whims, feature detection in old core-js versions could cause a slowdown up to 100x even if nothing is polyfilled. Some versions have web compatibility issues. Please, upgrade your dependencies to the actual version of core-js.\n\u001b[0m\u001b[91mnpm WARN deprecated core-js@2.6.12: core-js@<3.23.3 is no longer maintained and not recommended for usage due to the number of issues. Because of the V8 engine whims, feature detection in old core-js versions could cause a slowdown up to 100x even if nothing is polyfilled. Some versions have web compatibility issues. Please, upgrade your dependencies to the actual version of core-js.\n\u001b[0m\n> @americanexpress/one-app@6.1.1 preinstall\n> npx check-engines@1\n\n\u001b[91mnpm WARN exec\u001b[0m\u001b[91m The following package was not found and will be installed: check-engines@1\n\u001b[0m\n> @americanexpress/one-app@6.1.1 postinstall\n> npm run build\n\n\n> @americanexpress/one-app@6.1.1 prebuild\n> npm run clean:build\n\n\n> @americanexpress/one-app@6.1.1 clean:build\n> rimraf dist lib build lastBuild.json stats.json\n\n\n> @americanexpress/one-app@6.1.1 build\n> concurrently \"npm run build:bundle\" \"npm run build:server\" -n build:bundle,build:server --kill-others-on-fail && npm run build:service-workers\n\n[build:server] \n[build:server] > @americanexpress/one-app@6.1.1 build:server\n[build:server] > cross-env BABEL_ENV=server babel src --out-dir lib --ignore \"**/__mocks__\"\n[build:server] \n[build:bundle] \n[build:bundle] > @americanexpress/one-app@6.1.1 build:bundle\n[build:bundle] > if-node-version \">16\" && npm run build:bundle:gt-16  || npm run build:bundle:16\n[build:bundle] \n[build:bundle] \n[build:bundle] > @americanexpress/one-app@6.1.1 build:bundle:16\n[build:bundle] > cross-env NODE_OPTIONS=--max-old-space-size=4096 bundle-one-app\n[build:bundle] \n[build:server] Successfully compiled 104 files with Babel (1320ms).\n[build:server] npm run build:server exited with code 0\n[build:bundle] [BABEL] Note: The code generator has deoptimised the styling of /opt/build/node_modules/react-dom/cjs/react-dom.development.js as it exceeds the max of 500KB.\n[build:bundle] [BABEL] Note: The code generator has deoptimised the styling of /opt/build/node_modules/react-dom/cjs/react-dom.development.js as it exceeds the max of 500KB.\n[build:bundle] npm run build:bundle exited with code 0\n\n> @americanexpress/one-app@6.1.1 build:service-workers\n> node scripts/build-service-workers.js\n\n\u001b[91m@rollup/plugin-replace: 'preventAssignment' currently defaults to false. It is recommended to set this option to `true`, as the next major version will default this option to `true`.\n\u001b[0m\n> @americanexpress/one-app@6.1.1 prepare\n> husky install\n\n\u001b[91mfatal: not a git repository (or any of the parent directories): .git\n\u001b[0m\nadded 2199 packages, and audited 2200 packages in 1m\n\n184 packages are looking for funding\n  run `npm fund` for details\n\n20 vulnerabilities (4 moderate, 13 high, 3 critical)\n\nTo address issues that do not require attention, run:\n  npm audit fix\n\nTo address all issues possible (including breaking changes), run:\n  npm audit fix --force\n\nSome issues need review, and may require choosing\na different dependency.\n\nRun `npm audit` for details.\n\u001b[91mnpm notice \nnpm notice New major version of npm available! 8.8.0 -> 9.2.0\nnpm \u001b[0m\u001b[91mnotice Changelog: <https://github.com/npm/cli/releases/tag/v9.2.0>\nnpm notice Run `npm install -g npm@9.2.0` to update!\nnpm notice \n\u001b[0mRemoving intermediate container 1b2193bcc063\n ---> 7096f6d0c1f4\nStep 6/30 : RUN NODE_ENV=development npm run build &&     mkdir -p /opt/one-app/development &&     chown node:node /opt/one-app/development &&     cp -r /opt/build/. /opt/one-app/development\n ---> Running in 4af12c0374a9\n\n> @americanexpress/one-app@6.1.1 prebuild\n> npm run clean:build\n\n\n> @americanexpress/one-app@6.1.1 clean:build\n> rimraf dist lib build lastBuild.json stats.json\n\n\n> @americanexpress/one-app@6.1.1 build\n> concurrently \"npm run build:bundle\" \"npm run build:server\" -n build:bundle,build:server --kill-others-on-fail && npm run build:service-workers\n\n[build:bundle] \n[build:bundle] > @americanexpress/one-app@6.1.1 build:bundle\n[build:bundle] > if-node-version \">16\" && npm run build:bundle:gt-16  || npm run build:bundle:16\n[build:bundle] \n[build:server] \n[build:server] > @americanexpress/one-app@6.1.1 build:server\n[build:server] > cross-env BABEL_ENV=server babel src --out-dir lib --ignore \"**/__mocks__\"\n[build:server] \n[build:bundle] \n[build:bundle] > @americanexpress/one-app@6.1.1 build:bundle:16\n[build:bundle] > cross-env NODE_OPTIONS=--max-old-space-size=4096 bundle-one-app\n[build:bundle] \n[build:server] Successfully compiled 104 files with Babel (1553ms).\n[build:server] npm run build:server exited with code 0\n[build:bundle] npm run build:bundle exited with code 0\n\n> @americanexpress/one-app@6.1.1 build:service-workers\n> node scripts/build-service-workers.js\n\n\u001b[91m@rollup/plugin-replace: 'preventAssignment' currently defaults to false. It is recommended to set this option to `true`, as the next major version will default this option to `true`.\n\u001b[0mRemoving intermediate container 4af12c0374a9\n ---> 480d0c4117ee\nStep 7/30 : RUN NODE_ENV=production npm run build &&     NODE_ENV=production npm prune &&     mkdir -p /opt/one-app/production &&     chown node:node /opt/one-app/production &&     mv /opt/build/LICENSE.txt /opt/one-app/production &&     mv /opt/build/node_modules /opt/one-app/production &&     mv /opt/build/package.json /opt/one-app/production &&     mv /opt/build/lib /opt/one-app/production &&     mv /opt/build/build /opt/one-app/production &&     mv /opt/build/bundle.integrity.manifest.json /opt/one-app/production &&     mv /opt/build/.build-meta.json /opt/one-app/production\n ---> Running in 900507f287f3\n\n> @americanexpress/one-app@6.1.1 prebuild\n> npm run clean:build\n\n\n> @americanexpress/one-app@6.1.1 clean:build\n> rimraf dist lib build lastBuild.json stats.json\n\n\n> @americanexpress/one-app@6.1.1 build\n> concurrently \"npm run build:bundle\" \"npm run build:server\" -n build:bundle,build:server --kill-others-on-fail && npm run build:service-workers\n\n[build:server] \n[build:server] > @americanexpress/one-app@6.1.1 build:server\n[build:server] > cross-env BABEL_ENV=server babel src --out-dir lib --ignore \"**/__mocks__\"\n[build:server] \n[build:bundle] \n[build:bundle] > @americanexpress/one-app@6.1.1 build:bundle\n[build:bundle] > if-node-version \">16\" && npm run build:bundle:gt-16  || npm run build:bundle:16\n[build:bundle] \n[build:bundle] \n[build:bundle] > @americanexpress/one-app@6.1.1 build:bundle:16\n[build:bundle] > cross-env NODE_OPTIONS=--max-old-space-size=4096 bundle-one-app\n[build:bundle] \n[build:server] Successfully compiled 104 files with Babel (1324ms).\n[build:server] npm run build:server exited with code 0\n[build:bundle] asset size limit: The following asset(s) exceed the recommended size limit (244 KiB).\n[build:bundle] This can impact web performance.\n[build:bundle] Assets: \n[build:bundle]   app~vendors.js (433 KiB) undefined\n[build:bundle] entrypoint size limit: The following entrypoint(s) combined asset size exceeds the recommended limit (244 KiB). This can impact web performance.\n[build:bundle] Entrypoints:\n[build:bundle]   app (586 KiB)\n[build:bundle]       runtime.js\n[build:bundle]       app~vendors.js\n[build:bundle]       app.js\n[build:bundle]   vendors (603 KiB)\n[build:bundle]       runtime.js\n[build:bundle]       app~vendors.js\n[build:bundle]       vendors.js\n[build:bundle]  undefined\n[build:bundle] asset size limit: The following asset(s) exceed the recommended size limit (244 KiB).\n[build:bundle] This can impact web performance.\n[build:bundle] Assets: \n[build:bundle]   app~vendors.js (433 KiB) undefined\n[build:bundle] entrypoint size limit: The following entrypoint(s) combined asset size exceeds the recommended limit (244 KiB). This can impact web performance.\n[build:bundle] Entrypoints:\n[build:bundle]   app (586 KiB)\n[build:bundle]       runtime.js\n[build:bundle]       app~vendors.js\n[build:bundle]       app.js\n[build:bundle]   vendors (629 KiB)\n[build:bundle]       runtime.js\n[build:bundle]       app~vendors.js\n[build:bundle]       vendors.js\n[build:bundle]  undefined\n[build:bundle] npm run build:bundle exited with code 0\n\n> @americanexpress/one-app@6.1.1 build:service-workers\n> node scripts/build-service-workers.js\n\n\u001b[91m@rollup/plugin-replace: 'preventAssignment' currently defaults to false. It is recommended to set this option to `true`, as the next major version will default this option to `true`.\n\u001b[0m\nup to date, audited 1083 packages in 6s\n\n97 packages are looking for funding\n  run `npm fund` for details\n\n12 vulnerabilities (3 moderate, 6 high, 3 critical)\n\nTo address issues that do not require attention, run:\n  npm audit fix\n\nSome issues need review, and may require choosing\na different dependency.\n\nRun `npm audit` for details.\nRemoving intermediate container 900507f287f3\n ---> 047ab4eeda18\nStep 8/30 : FROM node:16.16.0-alpine as development\n16.16.0-alpine: Pulling from library/node\n213ec9aee27d: Already exists\n015fad1872e1: Pulling fs layer\nc93f3de25c33: Pulling fs layer\nbc5d1f30ff35: Pulling fs layer\nbc5d1f30ff35: Download complete\nc93f3de25c33: Download complete\n015fad1872e1: Verifying Checksum\n015fad1872e1: Download complete\n015fad1872e1: Pull complete\nc93f3de25c33: Pull complete\nbc5d1f30ff35: Pull complete\nDigest: sha256:1c8769a8c9ed57817ef07162744a3722421333a438185c560aa42a9a1fc6ea23\nStatus: Downloaded newer image for node:16.16.0-alpine\n ---> b1ca7421d2e7\nStep 9/30 : ARG USER\n ---> Running in 28520d2cac70\nRemoving intermediate container 28520d2cac70\n ---> d75162eb4e8e\nStep 10/30 : ENV USER ${USER:-node}\n ---> Running in a42b8b43363d\nRemoving intermediate container a42b8b43363d\n ---> 732385116592\nStep 11/30 : ENV NODE_ENV=development\n ---> Running in e3efad881ac9\nRemoving intermediate container e3efad881ac9\n ---> 5622ebd0389b\nStep 12/30 : EXPOSE 3000\n ---> Running in 89361162e1ee\nRemoving intermediate container 89361162e1ee\n ---> 6e7831e475c5\nStep 13/30 : EXPOSE 3001\n ---> Running in 9c765406093d\nRemoving intermediate container 9c765406093d\n ---> e7e0ac9319c6\nStep 14/30 : EXPOSE 3002\n ---> Running in 2e335723e77d\nRemoving intermediate container 2e335723e77d\n ---> e10d2ed905a1\nStep 15/30 : EXPOSE 3005\n ---> Running in 41c726974237\nRemoving intermediate container 41c726974237\n ---> a7c0bb7fcebb\nStep 16/30 : WORKDIR /opt/one-app\n ---> Running in 6617c238d918\nRemoving intermediate container 6617c238d918\n ---> e01ab483d7c8\nStep 17/30 : RUN chown node:node /opt/one-app\n ---> Running in 8a67a98ea7dc\nRemoving intermediate container 8a67a98ea7dc\n ---> c27bd0a68d6a\nStep 18/30 : USER $USER\n ---> Running in c8debdf7eb9e\nRemoving intermediate container c8debdf7eb9e\n ---> 019f017a9491\nStep 19/30 : CMD [\"node\", \"lib/server\"]\n ---> Running in 1c3ca3277d19\nRemoving intermediate container 1c3ca3277d19\n ---> b6f520652ecb\nStep 20/30 : COPY --from=builder --chown=node:node /opt/one-app/development ./\n ---> aabc26c2f944\nStep 21/30 : FROM node:16.16.0-alpine as production\n ---> b1ca7421d2e7\nStep 22/30 : ARG USER\n ---> Running in 20d379617804\nRemoving intermediate container 20d379617804\n ---> b649aa4cbbd8\nStep 23/30 : ENV USER ${USER:-node}\n ---> Running in 715bf8c101dd\nRemoving intermediate container 715bf8c101dd\n ---> ffc9e9e1ffab\nStep 24/30 : ENV NODE_ENV=production\n ---> Running in 60fc87e2a358\nRemoving intermediate container 60fc87e2a358\n ---> 13c5f20d97b5\nStep 25/30 : EXPOSE 3000\n ---> Running in 43a42988b0cb\nRemoving intermediate container 43a42988b0cb\n ---> 263949c09ead\nStep 26/30 : EXPOSE 3005\n ---> Running in 76385b5f95f7\nRemoving intermediate container 76385b5f95f7\n ---> dc436126eb0f\nStep 27/30 : WORKDIR /opt/one-app\n ---> Running in 438b74530521\nRemoving intermediate container 438b74530521\n ---> 1ad6de08d6ce\nStep 28/30 : USER $USER\n ---> Running in f22dc0379971\nRemoving intermediate container f22dc0379971\n ---> 2bbf97570a35\nStep 29/30 : CMD [\"node\", \"lib/server\"]\n ---> Running in 52f654aa7f33\nRemoving intermediate container 52f654aa7f33\n ---> ce43a0d8828c\nStep 30/30 : COPY --from=builder --chown=node:node /opt/one-app/production ./\n ---> ea904fc37aca\nSuccessfully built ea904fc37aca\nSuccessfully tagged one-app:latest\n","stderr":"","imageSize":247453742},"repair":{"violations":[{"name":"npmCacheCleanAfterInstall","position":{"start":6,"end":6,"columnStart":4,"columnEnd":66}}],"repairedDockerfile":"# Use the pre-baked fat node image only in the builder\n# which includes build utils preinstalled (e.g. gcc, make, etc).\n# This will result in faster and reliable One App docker image\n# builds as we do not have to run apk installs for alpine.\nFROM node:16.16.0 as builder\nWORKDIR /opt/build\nRUN npm install -g npm@8.8.0 --registry=https://registry.npmjs.org\nCOPY --chown=node:node ./ /opt/build\n# npm ci does not run postinstall with root account\nRUN NODE_ENV=development npm ci --build-from-source\n# npm ci does not run postinstall with root account\n# which is why there is a dev build\nRUN NODE_ENV=development npm run build && \\\n    mkdir -p /opt/one-app/development && \\\n    chown node:node /opt/one-app/development && \\\n    cp -r /opt/build/. /opt/one-app/development\n# prod build\nRUN NODE_ENV=production npm run build && \\\n    NODE_ENV=production npm prune && \\\n    mkdir -p /opt/one-app/production && \\\n    chown node:node /opt/one-app/production && \\\n    mv /opt/build/LICENSE.txt /opt/one-app/production && \\\n    mv /opt/build/node_modules /opt/one-app/production && \\\n    mv /opt/build/package.json /opt/one-app/production && \\\n    mv /opt/build/lib /opt/one-app/production && \\\n    mv /opt/build/build /opt/one-app/production && \\\n    mv /opt/build/bundle.integrity.manifest.json /opt/one-app/production && \\\n    mv /opt/build/.build-meta.json /opt/one-app/production\n\n# development image\n# docker build . --target=development\nFROM node:16.16.0-alpine as development\nARG USER\nENV USER ${USER:-node}\nENV NODE_ENV=development\n# exposing these ports as they are default for all the local dev servers\n# see src/server/config/env/runtime.js\nEXPOSE 3000\nEXPOSE 3001\nEXPOSE 3002\nEXPOSE 3005\nWORKDIR /opt/one-app\nRUN chown node:node /opt/one-app\nUSER $USER\nCMD [\"node\", \"lib/server\"]\nCOPY --from=builder --chown=node:node /opt/one-app/development ./\n\n# production image\n# last so that it's the default image artifact\nFROM node:16.16.0-alpine as production\nARG USER\nENV USER ${USER:-node}\nENV NODE_ENV=production\n# exposing these ports as they are defaults for one app and the prom metrics server\n# see src/server/config/env/runtime.js\nEXPOSE 3000\nEXPOSE 3005\nWORKDIR /opt/one-app\nUSER $USER\nCMD [\"node\", \"lib/server\"]\nCOPY --from=builder --chown=node:node /opt/one-app/production ./\n"},"repairedBuild":{"startTimestamp":1672780911010,"endTimestamp":1672782082790,"error":null,"stdout":"Sending build context to Docker daemon   2.53MB\r\r\nStep 1/30 : FROM node:16.16.0 as builder\n ---> 954cea825b78\nStep 2/30 : WORKDIR /opt/build\n ---> Running in 063c6b1fbf6e\nRemoving intermediate container 063c6b1fbf6e\n ---> 299bc075e1f6\nStep 3/30 : RUN npm install -g npm@8.8.0 --registry=https://registry.npmjs.org\n ---> Running in ad496242fbb7\n\u001b[91mnpm\u001b[0m\u001b[91m WARN config global `--global`, `--local` are deprecated. Use `--location=global` instead.\n\u001b[0m\nchanged 25 packages, and audited 202 packages in 37s\n\n11 packages are looking for funding\n  run `npm fund` for details\n\n1 high severity vulnerability\n\nTo address all issues, run:\n  npm audit fix --force\n\nRun `npm audit` for details.\nRemoving intermediate container ad496242fbb7\n ---> 20b4eb4eb338\nStep 4/30 : COPY --chown=node:node ./ /opt/build\n ---> 0b9c6453ea99\nStep 5/30 : RUN NODE_ENV=development npm ci --build-from-source\n ---> Running in 736ea7f7fa9a\n\u001b[91mnpm WARN deprecated urix@0.1.0: Please see https://github.com/lydell/urix#deprecated\n\u001b[0m\u001b[91mnpm WARN deprecated source-map-url@0.4.1: See https://github.com/lydell/source-map-url#deprecated\n\u001b[0m\u001b[91mnpm WARN deprecated source-map-resolve@0.5.3: See https://github.com/lydell/source-map-resolve#deprecated\n\u001b[0m\u001b[91mnpm WARN deprecated url-search-params@0.10.2: now available as @ungap/url-search-params\n\u001b[0m\u001b[91mnpm WARN deprecated resolve-url@0.2.1: https://github.com/lydell/resolve-url#deprecated\n\u001b[0m\u001b[91mnpm WARN deprecated rollup-plugin-babel@4.4.0: This package has been deprecated and is no longer maintained. Please use @rollup/plugin-babel.\n\u001b[0m\u001b[91mnpm WARN deprecated querystring@0.2.0: The querystring API is considered Legacy. new code should use the URLSearchParams API instead.\n\u001b[0m\u001b[91mnpm WARN deprecated request@2.88.2: request has been deprecated, see https://github.com/request/request/issues/3142\n\u001b[0m\u001b[91mnpm WARN deprecated har-validator@5.1.5: this library is no longer supported\n\u001b[0m\u001b[91mnpm WARN deprecated html-webpack-plugin@3.2.0: 3.x is no longer supported\n\u001b[0m\u001b[91mnpm WARN deprecated eslint-loader@4.0.2: This loader has been deprecated. Please use eslint-webpack-plugin\n\u001b[0m\u001b[91mnpm WARN deprecated babel-eslint@10.1.0: babel-eslint is now @babel/eslint-parser. This package will no longer receive updates.\n\u001b[0m\u001b[91mnpm WARN deprecated chokidar@2.1.8: Chokidar 2 does not receive security updates since 2019. Upgrade to chokidar 3 with 15x fewer dependencies\n\u001b[0m\u001b[91mnpm WARN deprecated uuid@3.4.0: Please upgrade  to version 7 or higher.  Older versions may use Math.random() in certain circumstances, which is known to be problematic.  See https://v8.dev/blog/math-random for details.\n\u001b[0m\u001b[91mnpm WARN deprecated uuid@3.4.0: Please upgrade  to version 7 or higher.  Older versions may use Math.random() in certain circumstances, which is known to be problematic.  See https://v8.dev/blog/math-random for details.\n\u001b[0m\u001b[91mnpm WARN deprecated core-js@2.6.12: core-js@<3.23.3 is no longer maintained and not recommended for usage due to the number of issues. Because of the V8 engine whims, feature detection in old core-js versions could cause a slowdown up to 100x even if nothing is polyfilled. Some versions have web compatibility issues. Please, upgrade your dependencies to the actual version of core-js.\n\u001b[0m\u001b[91mnpm WARN deprecated core-js@2.6.12: core-js@<3.23.3 is no longer maintained and not recommended for usage due to the number of issues. Because of the V8 engine whims, feature detection in old core-js versions could cause a slowdown up to 100x even if nothing is polyfilled. Some versions have web compatibility issues. Please, upgrade your dependencies to the actual version of core-js.\n\u001b[0m\n> @americanexpress/one-app@6.1.1 preinstall\n> npx check-engines@1\n\n\u001b[91mnpm WARN exec The following package was not found and will be installed: check-engines@1\n\u001b[0m\n> @americanexpress/one-app@6.1.1 postinstall\n> npm run build\n\n\n> @americanexpress/one-app@6.1.1 prebuild\n> npm run clean:build\n\n\n> @americanexpress/one-app@6.1.1 clean:build\n> rimraf dist lib build lastBuild.json stats.json\n\n\n> @americanexpress/one-app@6.1.1 build\n> concurrently \"npm run build:bundle\" \"npm run build:server\" -n build:bundle,build:server --kill-others-on-fail && npm run build:service-workers\n\n[build:server] \n[build:server] > @americanexpress/one-app@6.1.1 build:server\n[build:server] > cross-env BABEL_ENV=server babel src --out-dir lib --ignore \"**/__mocks__\"\n[build:server] \n[build:bundle] \n[build:bundle] > @americanexpress/one-app@6.1.1 build:bundle\n[build:bundle] > if-node-version \">16\" && npm run build:bundle:gt-16  || npm run build:bundle:16\n[build:bundle] \n[build:bundle] \n[build:bundle] > @americanexpress/one-app@6.1.1 build:bundle:16\n[build:bundle] > cross-env NODE_OPTIONS=--max-old-space-size=4096 bundle-one-app\n[build:bundle] \n[build:server] Successfully compiled 104 files with Babel (1502ms).\n[build:server] npm run build:server exited with code 0\n[build:bundle] [BABEL] Note: The code generator has deoptimised the styling of /opt/build/node_modules/react-dom/cjs/react-dom.development.js as it exceeds the max of 500KB.\n[build:bundle] [BABEL] Note: The code generator has deoptimised the styling of /opt/build/node_modules/react-dom/cjs/react-dom.development.js as it exceeds the max of 500KB.\n[build:bundle] npm run build:bundle exited with code 0\n\n> @americanexpress/one-app@6.1.1 build:service-workers\n> node scripts/build-service-workers.js\n\n\u001b[91m@rollup/plugin-replace: 'preventAssignment' currently defaults to false. It is recommended to set this option to `true`, as the next major version will default this option to `true`.\n\u001b[0m\n> @americanexpress/one-app@6.1.1 prepare\n> husky install\n\n\u001b[91mfatal: not a git repository (or any of the parent directories): .git\n\u001b[0m\nadded 2199 packages, and audited 2200 packages in 1m\n\n184 packages are looking for funding\n  run `npm fund` for details\n\n20 vulnerabilities (4 moderate, 13 high, 3 critical)\n\nTo address issues that do not require attention, run:\n  npm audit fix\n\nTo address all issues possible (including breaking changes), run:\n  npm audit fix --force\n\nSome issues need review, and may require choosing\na different dependency.\n\nRun `npm audit` for details.\n\u001b[91mnpm notice \nnpm notice New major version of npm available! 8.8.0 -> 9.2.0\nnpm\u001b[0m\u001b[91m notice Changelog: <https://github.com/npm/cli/releases/tag/v9.2.0>\nnpm notice Run `npm install -g npm@9.2.0` to update!\nnpm notice\u001b[0m\u001b[91m \n\u001b[0mRemoving intermediate container 736ea7f7fa9a\n ---> 269502cec062\nStep 6/30 : RUN NODE_ENV=development npm run build &&     mkdir -p /opt/one-app/development &&     chown node:node /opt/one-app/development &&     cp -r /opt/build/. /opt/one-app/development\n ---> Running in d8d12511e24b\n\n> @americanexpress/one-app@6.1.1 prebuild\n> npm run clean:build\n\n\n> @americanexpress/one-app@6.1.1 clean:build\n> rimraf dist lib build lastBuild.json stats.json\n\n\n> @americanexpress/one-app@6.1.1 build\n> concurrently \"npm run build:bundle\" \"npm run build:server\" -n build:bundle,build:server --kill-others-on-fail && npm run build:service-workers\n\n[build:bundle] \n[build:bundle] > @americanexpress/one-app@6.1.1 build:bundle\n[build:bundle] > if-node-version \">16\" && npm run build:bundle:gt-16  || npm run build:bundle:16\n[build:bundle] \n[build:server] \n[build:server] > @americanexpress/one-app@6.1.1 build:server\n[build:server] > cross-env BABEL_ENV=server babel src --out-dir lib --ignore \"**/__mocks__\"\n[build:server] \n[build:bundle] \n[build:bundle] > @americanexpress/one-app@6.1.1 build:bundle:16\n[build:bundle] > cross-env NODE_OPTIONS=--max-old-space-size=4096 bundle-one-app\n[build:bundle] \n[build:server] Successfully compiled 104 files with Babel (1179ms).\n[build:server] npm run build:server exited with code 0\n[build:bundle] npm run build:bundle exited with code 0\n\n> @americanexpress/one-app@6.1.1 build:service-workers\n> node scripts/build-service-workers.js\n\n\u001b[91m@rollup/plugin-replace: 'preventAssignment' currently defaults to false. It is recommended to set this option to `true`, as the next major version will default this option to `true`.\n\u001b[0mRemoving intermediate container d8d12511e24b\n ---> fc9ffcc72674\nStep 7/30 : RUN NODE_ENV=production npm run build &&     NODE_ENV=production npm prune &&     mkdir -p /opt/one-app/production &&     chown node:node /opt/one-app/production &&     mv /opt/build/LICENSE.txt /opt/one-app/production &&     mv /opt/build/node_modules /opt/one-app/production &&     mv /opt/build/package.json /opt/one-app/production &&     mv /opt/build/lib /opt/one-app/production &&     mv /opt/build/build /opt/one-app/production &&     mv /opt/build/bundle.integrity.manifest.json /opt/one-app/production &&     mv /opt/build/.build-meta.json /opt/one-app/production\n ---> Running in 6cc96a481dce\n\n> @americanexpress/one-app@6.1.1 prebuild\n> npm run clean:build\n\n\n> @americanexpress/one-app@6.1.1 clean:build\n> rimraf dist lib build lastBuild.json stats.json\n\n\n> @americanexpress/one-app@6.1.1 build\n> concurrently \"npm run build:bundle\" \"npm run build:server\" -n build:bundle,build:server --kill-others-on-fail && npm run build:service-workers\n\n[build:bundle] \n[build:bundle] > @americanexpress/one-app@6.1.1 build:bundle\n[build:bundle] > if-node-version \">16\" && npm run build:bundle:gt-16  || npm run build:bundle:16\n[build:bundle] \n[build:server] \n[build:server] > @americanexpress/one-app@6.1.1 build:server\n[build:server] > cross-env BABEL_ENV=server babel src --out-dir lib --ignore \"**/__mocks__\"\n[build:server] \n[build:bundle] \n[build:bundle] > @americanexpress/one-app@6.1.1 build:bundle:16\n[build:bundle] > cross-env NODE_OPTIONS=--max-old-space-size=4096 bundle-one-app\n[build:bundle] \n[build:server] Successfully compiled 104 files with Babel (1346ms).\n[build:server] npm run build:server exited with code 0\n[build:bundle] asset size limit: The following asset(s) exceed the recommended size limit (244 KiB).\n[build:bundle] This can impact web performance.\n[build:bundle] Assets: \n[build:bundle]   app~vendors.js (433 KiB) undefined\n[build:bundle] entrypoint size limit: The following entrypoint(s) combined asset size exceeds the recommended limit (244 KiB). This can impact web performance.\n[build:bundle] Entrypoints:\n[build:bundle]   app (586 KiB)\n[build:bundle]       runtime.js\n[build:bundle]       app~vendors.js\n[build:bundle]       app.js\n[build:bundle]   vendors (603 KiB)\n[build:bundle]       runtime.js\n[build:bundle]       app~vendors.js\n[build:bundle]       vendors.js\n[build:bundle]  undefined\n[build:bundle] asset size limit: The following asset(s) exceed the recommended size limit (244 KiB).\n[build:bundle] This can impact web performance.\n[build:bundle] Assets: \n[build:bundle]   app~vendors.js (433 KiB) undefined\n[build:bundle] entrypoint size limit: The following entrypoint(s) combined asset size exceeds the recommended limit (244 KiB). This can impact web performance.\n[build:bundle] Entrypoints:\n[build:bundle]   app (586 KiB)\n[build:bundle]       runtime.js\n[build:bundle]       app~vendors.js\n[build:bundle]       app.js\n[build:bundle]   vendors (629 KiB)\n[build:bundle]       runtime.js\n[build:bundle]       app~vendors.js\n[build:bundle]       vendors.js\n[build:bundle]  undefined\n[build:bundle] npm run build:bundle exited with code 0\n\n> @americanexpress/one-app@6.1.1 build:service-workers\n> node scripts/build-service-workers.js\n\n\u001b[91m@rollup/plugin-replace: 'preventAssignment' currently defaults to false. It is recommended to set this option to `true`, as the next major version will default this option to `true`.\n\u001b[0m\nup to date, audited 1083 packages in 10s\n\n97 packages are looking for funding\n  run `npm fund` for details\n\n12 vulnerabilities (3 moderate, 6 high, 3 critical)\n\nTo address issues that do not require attention, run:\n  npm audit fix\n\nSome issues need review, and may require choosing\na different dependency.\n\nRun `npm audit` for details.\nRemoving intermediate container 6cc96a481dce\n ---> 7b63e186f90e\nStep 8/30 : FROM node:16.16.0-alpine as development\n ---> b1ca7421d2e7\nStep 9/30 : ARG USER\n ---> Running in 28977129c9c4\nRemoving intermediate container 28977129c9c4\n ---> 38134ef71fbe\nStep 10/30 : ENV USER ${USER:-node}\n ---> Running in 7a89ac5e8f00\nRemoving intermediate container 7a89ac5e8f00\n ---> 6478ad62a3ca\nStep 11/30 : ENV NODE_ENV=development\n ---> Running in 2c2800da5f46\nRemoving intermediate container 2c2800da5f46\n ---> 8ce407755ae6\nStep 12/30 : EXPOSE 3000\n ---> Running in 904469b8a2bb\nRemoving intermediate container 904469b8a2bb\n ---> 68147a8a3e6c\nStep 13/30 : EXPOSE 3001\n ---> Running in 662fb8097dab\nRemoving intermediate container 662fb8097dab\n ---> 95ed74d8213c\nStep 14/30 : EXPOSE 3002\n ---> Running in 5aa53f059c96\nRemoving intermediate container 5aa53f059c96\n ---> 7f6543f06309\nStep 15/30 : EXPOSE 3005\n ---> Running in e0f97da9b76f\nRemoving intermediate container e0f97da9b76f\n ---> ba67dbbeac46\nStep 16/30 : WORKDIR /opt/one-app\n ---> Running in aa57b295b46d\nRemoving intermediate container aa57b295b46d\n ---> c446bdece598\nStep 17/30 : RUN chown node:node /opt/one-app\n ---> Running in 35f3e2a6e1ad\nRemoving intermediate container 35f3e2a6e1ad\n ---> 914d5558b97d\nStep 18/30 : USER $USER\n ---> Running in 4019ec348afe\nRemoving intermediate container 4019ec348afe\n ---> 96c9ad9dc9e4\nStep 19/30 : CMD [\"node\", \"lib/server\"]\n ---> Running in c54c581d9efc\nRemoving intermediate container c54c581d9efc\n ---> c204da188f9a\nStep 20/30 : COPY --from=builder --chown=node:node /opt/one-app/development ./\n ---> 4553c37a24de\nStep 21/30 : FROM node:16.16.0-alpine as production\n ---> b1ca7421d2e7\nStep 22/30 : ARG USER\n ---> Running in 4190d183da48\nRemoving intermediate container 4190d183da48\n ---> 50d244670a7f\nStep 23/30 : ENV USER ${USER:-node}\n ---> Running in de3980fa9df8\nRemoving intermediate container de3980fa9df8\n ---> e8ca36fc6921\nStep 24/30 : ENV NODE_ENV=production\n ---> Running in 73cf07b30e00\nRemoving intermediate container 73cf07b30e00\n ---> 27b90b4e5e0b\nStep 25/30 : EXPOSE 3000\n ---> Running in e87f033c88e4\nRemoving intermediate container e87f033c88e4\n ---> 30fa2c56aafb\nStep 26/30 : EXPOSE 3005\n ---> Running in dc75990f2ca0\nRemoving intermediate container dc75990f2ca0\n ---> 5da6a11aa70b\nStep 27/30 : WORKDIR /opt/one-app\n ---> Running in 02582d974f63\nRemoving intermediate container 02582d974f63\n ---> 2cf19292d9fc\nStep 28/30 : USER $USER\n ---> Running in 06d9842dffdc\nRemoving intermediate container 06d9842dffdc\n ---> dcfdf9908d78\nStep 29/30 : CMD [\"node\", \"lib/server\"]\n ---> Running in f3933b78e981\nRemoving intermediate container f3933b78e981\n ---> d3ca7aeb5113\nStep 30/30 : COPY --from=builder --chown=node:node /opt/one-app/production ./\n ---> 12b05658dfa9\nSuccessfully built 12b05658dfa9\nSuccessfully tagged one-app:latest\n","stderr":"","imageSize":247453742},"endTime":1672782083760}