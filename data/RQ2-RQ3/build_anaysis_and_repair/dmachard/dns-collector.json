{"repository":"https://github.com/dmachard/dns-collector","dockerfilePath":"Dockerfile","startTime":1673185891755,"endTime":1673185984287,"clone":{"startTime":1673185891755,"stdout":"","stderr":"Cloning into '/tmp/dinghy-analysis/dmachard/dns-collector'...\n","error":null,"endTime":1673185892971,"commit":"e8d1607b31a600f3ca2c1d18ca3dae707253c2b8"},"originalBuild":{"startTime":1673185893045,"endTime":1673185940655,"error":null,"stdout":"Sending build context to Docker daemon  25.04MB\r\r\nStep 1/17 : FROM golang:1.19.3-alpine3.15 as builder\n1.19.3-alpine3.15: Pulling from library/golang\nDigest: sha256:eabc3aca6f6c4386369b5b067c9c210aeccd39e76907fa2f8f774fd59d83425a\nStatus: Downloaded newer image for golang:1.19.3-alpine3.15\n ---> 1112d5482da3\nStep 2/17 : ARG VERSION\n ---> Running in 65d8428147f5\nRemoving intermediate container 65d8428147f5\n ---> 01d5b72b17f7\nStep 3/17 : WORKDIR /build\n ---> Running in 0680f60f3d16\nRemoving intermediate container 0680f60f3d16\n ---> 514d28a3a676\nStep 4/17 : COPY . .\n ---> d97967140d7b\nStep 5/17 : RUN apk add git\n ---> Running in bc41e921f5c7\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.15/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.15/community/x86_64/APKINDEX.tar.gz\n(1/6) Installing brotli-libs (1.0.9-r5)\n(2/6) Installing nghttp2-libs (1.46.0-r0)\n(3/6) Installing libcurl (7.80.0-r5)\n(4/6) Installing expat (2.5.0-r0)\n(5/6) Installing pcre2 (10.40-r0)\n(6/6) Installing git (2.34.5-r0)\nExecuting busybox-1.34.1-r7.trigger\nOK: 19 MiB in 21 packages\nRemoving intermediate container bc41e921f5c7\n ---> 0e84dcf61770\nStep 6/17 : RUN GOOS=linux GOARCH=amd64 CGO_ENABLED=0 go build -ldflags=\"-X 'main.Version=$VERSION'\"\n ---> Running in b0765af49410\n\u001b[91mgo: downloading github.com/natefinch/lumberjack v2.0.0+incompatible\ngo: downloading gopkg.in/yaml.v2 v2.4.0\n\u001b[0m\u001b[91mgo: downloading github.com/google/gopacket v1.1.19\n\u001b[0m\u001b[91mgo: downloading gopkg.in/yaml.v3 v3.0.1\n\u001b[0m\u001b[91mgo: downloading github.com/dmachard/go-dnstap-protobuf v0.4.0\n\u001b[0m\u001b[91mgo: downloading github.com/dmachard/go-logger v0.3.0\n\u001b[0m\u001b[91mgo: downloading google.golang.org/protobuf v1.28.1\n\u001b[0m\u001b[91mgo: downloading github.com/RackSec/srslog v0.0.0-20180709174129-a4725f04ec91\ngo: downloading github.com/cilium/ebpf v0.9.3\ngo: downloading github.com/miekg/dns v1.1.50\ngo: downloading golang.org/x/sys v0.0.0-20220928140112-f11e5e49a4ec\n\u001b[0m\u001b[91mgo: downloading github.com/hpcloud/tail v1.0.0\n\u001b[0m\u001b[91mgo: downloading github.com/dmachard/go-powerdns-protobuf v0.0.4\ngo: downloading github.com/dmachard/go-framestream v0.2.0\n\u001b[0m\u001b[91mgo: downloading golang.org/x/net v0.0.0-20220225172249-27dd8689420f\ngo: downloading github.com/fsnotify/fsnotify v1.6.0\n\u001b[0m\u001b[91mgo: downloading github.com/farsightsec/golang-framestream v0.3.0\n\u001b[0m\u001b[91mgo: downloading github.com/dmachard/go-topmap v0.5.0\n\u001b[0m\u001b[91mgo: downloading github.com/gogo/protobuf v1.3.2\n\u001b[0m\u001b[91mgo: downloading github.com/grafana/dskit v0.0.0-20220314144907-ec94f1a0a3a8\n\u001b[0m\u001b[91mgo: downloading github.com/grafana/loki v1.6.2-0.20211108122114-f61a4d2612d8\n\u001b[0m\u001b[91mgo: downloading github.com/influxdata/influxdb-client-go v1.4.0\n\u001b[0m\u001b[91mgo: downloading github.com/klauspost/compress v1.15.13\n\u001b[0m\u001b[91mgo: downloading github.com/prometheus/client_golang v1.14.0\n\u001b[0m\u001b[91mgo: downloading github.com/vmihailenco/msgpack v4.0.4+incompatible\n\u001b[0m\u001b[91mgo: downloading github.com/oschwald/maxminddb-golang v1.10.0\n\u001b[0m\u001b[91mgo: downloading gopkg.in/fsnotify.v1 v1.4.7\n\u001b[0m\u001b[91mgo: downloading inet.af/netaddr v0.0.0-20211027220019-c74959edd3b6\n\u001b[0m\u001b[91mgo: downloading gopkg.in/tomb.v1 v1.0.0-20141024135613-dd632973f1e7\n\u001b[0m\u001b[91mgo: downloading go4.org/intern v0.0.0-20211027215823-ae77deb06f29\n\u001b[0m\u001b[91mgo: downloading github.com/prometheus/common v0.37.0\n\u001b[0m\u001b[91mgo: downloading github.com/prometheus/client_model v0.3.0\ngo: downloading github.com/cespare/xxhash/v2 v2.1.2\n\u001b[0m\u001b[91mgo: downloading github.com/prometheus/procfs v0.8.0\n\u001b[0m\u001b[91mgo: downloading github.com/beorn7/perks v1.0.1\ngo: downloading github.com/golang/protobuf v1.5.2\n\u001b[0m\u001b[91mgo: downloading go4.org/unsafe/assume-no-moving-gc v0.0.0-20220617031537-928513b29760\n\u001b[0m\u001b[91mgo: downloading github.com/pkg/errors v0.9.1\ngo: downloading github.com/influxdata/line-protocol v0.0.0-20200327222509-2487e7298839\n\u001b[0m\u001b[91mgo: downloading github.com/deepmap/oapi-codegen v1.9.1\n\u001b[0m\u001b[91mgo: downloading github.com/matttproud/golang_protobuf_extensions v1.0.2-0.20181231171920-c182affec369\n\u001b[0m\u001b[91mgo: downloading google.golang.org/grpc v1.40.0\n\u001b[0m\u001b[91mgo: downloading github.com/prometheus/prometheus v1.8.2-0.20211011171444-354d8d2ecfac\n\u001b[0m\u001b[91mgo: downloading google.golang.org/genproto v0.0.0-20210921142501-181ce0d877f6\n\u001b[0m\u001b[91mgo: downloading golang.org/x/text v0.3.7\n\u001b[0mRemoving intermediate container b0765af49410\n ---> db5a73a10868\nStep 7/17 : FROM alpine:3.17.0\n3.17.0: Pulling from library/alpine\nDigest: sha256:8914eb54f968791faf6a8638949e480fef81e697984fba772b3976835194c6d4\nStatus: Downloaded newer image for alpine:3.17.0\n ---> 49176f190c7e\nStep 8/17 : RUN apk add --no-cache tzdata\n ---> Running in f296697cc780\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/community/x86_64/APKINDEX.tar.gz\n(1/1) Installing tzdata (2022f-r1)\nOK: 10 MiB in 16 packages\nRemoving intermediate container f296697cc780\n ---> e2c613e7de07\nStep 9/17 : RUN mkdir -p /etc/dnscollector/ /var/dnscollector/\n ---> Running in c660fde85851\nRemoving intermediate container c660fde85851\n ---> 6cb25411c68e\nStep 10/17 : COPY --from=builder /build/go-dnscollector /bin/go-dnscollector\n ---> 2068e1ab2dbf\nStep 11/17 : COPY --from=builder /build/config.yml ./etc/dnscollector/config.yml\n ---> 5a3fe2c28782\nStep 12/17 : RUN addgroup -g 1000 dnscollector && adduser -D -H -G dnscollector -u 1000 -S dnscollector\n ---> Running in ea46b43fe5fe\nRemoving intermediate container ea46b43fe5fe\n ---> e56c71a0a8dc\nStep 13/17 : RUN chown dnscollector:dnscollector /var/dnscollector /etc/dnscollector\n ---> Running in eebaf7f3cc6c\nRemoving intermediate container eebaf7f3cc6c\n ---> 19889036064d\nStep 14/17 : USER dnscollector\n ---> Running in 6e2ad70e88b8\nRemoving intermediate container 6e2ad70e88b8\n ---> d0fb237fad99\nStep 15/17 : EXPOSE 6000/tcp 8080/tcp\n ---> Running in d92976fd0032\nRemoving intermediate container d92976fd0032\n ---> 97b23541ae0c\nStep 16/17 : ENTRYPOINT [\"/bin/go-dnscollector\"]\n ---> Running in 128e4a54129d\nRemoving intermediate container 128e4a54129d\n ---> 2f2f67b745cf\nStep 17/17 : CMD [\"-config\", \"/etc/dnscollector/config.yml\"]\n ---> Running in b73a0c8572e2\nRemoving intermediate container b73a0c8572e2\n ---> 947311ad76ce\nSuccessfully built 947311ad76ce\nSuccessfully tagged dns-collector:latest\n","stderr":"","imageSize":37191859},"repair":{"startTime":1673185940722,"endTime":1673185940806,"violations":[{"name":"apkAddUseNoCache","position":{"start":6,"end":6,"columnStart":4,"columnEnd":15}}],"repairedDockerfile":"FROM golang:1.19.3-alpine3.15 as builder\n\nARG VERSION\n\nWORKDIR /build\nCOPY . .\nRUN apk add --no-cache git\nRUN GOOS=linux GOARCH=amd64 CGO_ENABLED=0 go build -ldflags=\"-X 'main.Version=$VERSION'\"\n\n\nFROM alpine:3.17.0\n\nRUN apk add --no-cache tzdata\nRUN mkdir -p /etc/dnscollector/ /var/dnscollector/\n\nCOPY --from=builder /build/go-dnscollector /bin/go-dnscollector\nCOPY --from=builder /build/config.yml ./etc/dnscollector/config.yml\n\nRUN addgroup -g 1000 dnscollector && adduser -D -H -G dnscollector -u 1000 -S dnscollector\nRUN chown dnscollector:dnscollector /var/dnscollector /etc/dnscollector\nUSER dnscollector\n\nEXPOSE 6000/tcp 8080/tcp\n\nENTRYPOINT [\"/bin/go-dnscollector\"]\n\nCMD [\"-config\", \"/etc/dnscollector/config.yml\"]\n"},"repairedBuild":{"startTime":1673185940969,"endTime":1673185984040,"error":null,"stdout":"Sending build context to Docker daemon  25.04MB\r\r\nStep 1/17 : FROM golang:1.19.3-alpine3.15 as builder\n ---> 1112d5482da3\nStep 2/17 : ARG VERSION\n ---> Running in 20d020fe596e\nRemoving intermediate container 20d020fe596e\n ---> b7333a9298fb\nStep 3/17 : WORKDIR /build\n ---> Running in fa0d5852d124\nRemoving intermediate container fa0d5852d124\n ---> 24a69f3241f3\nStep 4/17 : COPY . .\n ---> 82ffc9b23666\nStep 5/17 : RUN apk add --no-cache git\n ---> Running in 9430f5790d9e\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.15/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.15/community/x86_64/APKINDEX.tar.gz\n(1/6) Installing brotli-libs (1.0.9-r5)\n(2/6) Installing nghttp2-libs (1.46.0-r0)\n(3/6) Installing libcurl (7.80.0-r5)\n(4/6) Installing expat (2.5.0-r0)\n(5/6) Installing pcre2 (10.40-r0)\n(6/6) Installing git (2.34.5-r0)\nExecuting busybox-1.34.1-r7.trigger\nOK: 19 MiB in 21 packages\nRemoving intermediate container 9430f5790d9e\n ---> 92bb8d6bc310\nStep 6/17 : RUN GOOS=linux GOARCH=amd64 CGO_ENABLED=0 go build -ldflags=\"-X 'main.Version=$VERSION'\"\n ---> Running in 0c9b7e61747c\n\u001b[91mgo: downloading gopkg.in/yaml.v2 v2.4.0\n\u001b[0m\u001b[91mgo: downloading github.com/dmachard/go-powerdns-protobuf v0.0.4\ngo: downloading github.com/fsnotify/fsnotify v1.6.0\n\u001b[0m\u001b[91mgo: downloading github.com/dmachard/go-dnstap-protobuf v0.4.0\ngo: downloading github.com/miekg/dns v1.1.50\n\u001b[0m\u001b[91mgo: downloading github.com/google/gopacket v1.1.19\n\u001b[0m\u001b[91mgo: downloading google.golang.org/protobuf v1.28.1\n\u001b[0m\u001b[91mgo: downloading gopkg.in/yaml.v3 v3.0.1\n\u001b[0m\u001b[91mgo: downloading github.com/RackSec/srslog v0.0.0-20180709174129-a4725f04ec91\n\u001b[0m\u001b[91mgo: downloading github.com/natefinch/lumberjack v2.0.0+incompatible\ngo: downloading github.com/dmachard/go-framestream v0.2.0\n\u001b[0m\u001b[91mgo: downloading github.com/dmachard/go-topmap v0.5.0\n\u001b[0m\u001b[91mgo: downloading github.com/hpcloud/tail v1.0.0\n\u001b[0m\u001b[91mgo: downloading golang.org/x/net v0.0.0-20220225172249-27dd8689420f\ngo: downloading github.com/farsightsec/golang-framestream v0.3.0\n\u001b[0m\u001b[91mgo: downloading github.com/dmachard/go-logger v0.3.0\n\u001b[0m\u001b[91mgo: downloading github.com/gogo/protobuf v1.3.2\n\u001b[0m\u001b[91mgo: downloading github.com/grafana/dskit v0.0.0-20220314144907-ec94f1a0a3a8\ngo: downloading golang.org/x/sys v0.0.0-20220928140112-f11e5e49a4ec\ngo: downloading github.com/cilium/ebpf v0.9.3\n\u001b[0m\u001b[91mgo: downloading github.com/grafana/loki v1.6.2-0.20211108122114-f61a4d2612d8\n\u001b[0m\u001b[91mgo: downloading github.com/influxdata/influxdb-client-go v1.4.0\n\u001b[0m\u001b[91mgo: downloading github.com/klauspost/compress v1.15.13\n\u001b[0m\u001b[91mgo: downloading github.com/prometheus/client_golang v1.14.0\n\u001b[0m\u001b[91mgo: downloading github.com/vmihailenco/msgpack v4.0.4+incompatible\n\u001b[0m\u001b[91mgo: downloading github.com/oschwald/maxminddb-golang v1.10.0\n\u001b[0m\u001b[91mgo: downloading gopkg.in/fsnotify.v1 v1.4.7\n\u001b[0m\u001b[91mgo: downloading inet.af/netaddr v0.0.0-20211027220019-c74959edd3b6\n\u001b[0m\u001b[91mgo: downloading gopkg.in/tomb.v1 v1.0.0-20141024135613-dd632973f1e7\n\u001b[0m\u001b[91mgo: downloading go4.org/intern v0.0.0-20211027215823-ae77deb06f29\n\u001b[0m\u001b[91mgo: downloading go4.org/unsafe/assume-no-moving-gc v0.0.0-20220617031537-928513b29760\n\u001b[0m\u001b[91mgo: downloading github.com/pkg/errors v0.9.1\ngo: downloading github.com/influxdata/line-protocol v0.0.0-20200327222509-2487e7298839\ngo: downloading github.com/deepmap/oapi-codegen v1.9.1\n\u001b[0m\u001b[91mgo: downloading github.com/prometheus/client_model v0.3.0\ngo: downloading github.com/prometheus/common v0.37.0\n\u001b[0m\u001b[91mgo: downloading github.com/golang/protobuf v1.5.2\ngo: downloading github.com/prometheus/procfs v0.8.0\ngo: downloading github.com/cespare/xxhash/v2 v2.1.2\n\u001b[0m\u001b[91mgo: downloading github.com/beorn7/perks v1.0.1\n\u001b[0m\u001b[91mgo: downloading github.com/matttproud/golang_protobuf_extensions v1.0.2-0.20181231171920-c182affec369\n\u001b[0m\u001b[91mgo: downloading google.golang.org/grpc v1.40.0\n\u001b[0m\u001b[91mgo: downloading github.com/prometheus/prometheus v1.8.2-0.20211011171444-354d8d2ecfac\n\u001b[0m\u001b[91mgo: downloading google.golang.org/genproto v0.0.0-20210921142501-181ce0d877f6\n\u001b[0m\u001b[91mgo: downloading golang.org/x/text v0.3.7\n\u001b[0mRemoving intermediate container 0c9b7e61747c\n ---> edd59f666148\nStep 7/17 : FROM alpine:3.17.0\n ---> 49176f190c7e\nStep 8/17 : RUN apk add --no-cache tzdata\n ---> Running in 20b71760285b\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/community/x86_64/APKINDEX.tar.gz\n(1/1) Installing tzdata (2022f-r1)\nOK: 10 MiB in 16 packages\nRemoving intermediate container 20b71760285b\n ---> 8873a1a8a134\nStep 9/17 : RUN mkdir -p /etc/dnscollector/ /var/dnscollector/\n ---> Running in ecc1915720a1\nRemoving intermediate container ecc1915720a1\n ---> d086538fd9b9\nStep 10/17 : COPY --from=builder /build/go-dnscollector /bin/go-dnscollector\n ---> 0c2c00c2684d\nStep 11/17 : COPY --from=builder /build/config.yml ./etc/dnscollector/config.yml\n ---> 9b55773d1c2c\nStep 12/17 : RUN addgroup -g 1000 dnscollector && adduser -D -H -G dnscollector -u 1000 -S dnscollector\n ---> Running in 491b04cd544e\nRemoving intermediate container 491b04cd544e\n ---> 8e9e4f44bd23\nStep 13/17 : RUN chown dnscollector:dnscollector /var/dnscollector /etc/dnscollector\n ---> Running in c4c858c3e4d1\nRemoving intermediate container c4c858c3e4d1\n ---> 65f1d09a9734\nStep 14/17 : USER dnscollector\n ---> Running in fcec11e93bee\nRemoving intermediate container fcec11e93bee\n ---> e34cc52443aa\nStep 15/17 : EXPOSE 6000/tcp 8080/tcp\n ---> Running in 7fa392486131\nRemoving intermediate container 7fa392486131\n ---> f05dcac13cd3\nStep 16/17 : ENTRYPOINT [\"/bin/go-dnscollector\"]\n ---> Running in 83598d91ead6\nRemoving intermediate container 83598d91ead6\n ---> df2d70643f8e\nStep 17/17 : CMD [\"-config\", \"/etc/dnscollector/config.yml\"]\n ---> Running in 3eec9369792f\nRemoving intermediate container 3eec9369792f\n ---> 6ead76981dfb\nSuccessfully built 6ead76981dfb\nSuccessfully tagged dns-collector:latest\n","stderr":"","imageSize":37191859}}