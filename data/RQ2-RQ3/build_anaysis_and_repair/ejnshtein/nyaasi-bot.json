{"repository":"https://github.com/ejnshtein/nyaasi-bot","dockerfilePath":"Dockerfile","startTime":1671999398410,"clone":{"stdout":"","stderr":"Cloning into '/tmp/dinghy-analysis/ejnshtein/nyaasi-bot'...\n","error":null,"commit":"98eb3c99f837e8f85382ef0ab0a84e748c51b4a7"},"originalBuild":{"startTimestamp":1671999399109,"endTimestamp":1671999443385,"error":{"code":2,"killed":false,"signal":null,"cmd":"docker build --no-cache -t nyaasi-bot:latest -f /tmp/dinghy-analysis/ejnshtein/nyaasi-bot/Dockerfile ."},"stdout":"Sending build context to Docker daemon  730.6kB\r\r\nStep 1/17 : FROM alfg/ffmpeg:latest as ffmpeg\nlatest: Pulling from alfg/ffmpeg\n2408cc74d12b: Pulling fs layer\n6b3db1586549: Pulling fs layer\n2d64fc5e7aa0: Pulling fs layer\n7a0a6e208545: Pulling fs layer\n021beeb6d24e: Pulling fs layer\n7a0a6e208545: Waiting\n2408cc74d12b: Verifying Checksum\n2408cc74d12b: Download complete\n2408cc74d12b: Pull complete\n6b3db1586549: Verifying Checksum\n6b3db1586549: Download complete\n7a0a6e208545: Verifying Checksum\n7a0a6e208545: Download complete\n2d64fc5e7aa0: Verifying Checksum\n2d64fc5e7aa0: Download complete\n6b3db1586549: Pull complete\n021beeb6d24e: Verifying Checksum\n021beeb6d24e: Download complete\n2d64fc5e7aa0: Pull complete\n7a0a6e208545: Pull complete\n021beeb6d24e: Pull complete\nDigest: sha256:9ae91517ca12958db75c499c2cd0751f29b601d9fb696c21f20cd648bed29876\nStatus: Downloaded newer image for alfg/ffmpeg:latest\n ---> d3d682d023d8\nStep 2/17 : FROM ejnshtein/node-tdlib:latest\nlatest: Pulling from ejnshtein/node-tdlib\n2408cc74d12b: Already exists\nc46621feb66a: Pulling fs layer\n557fb9245328: Pulling fs layer\nd3391c7075df: Pulling fs layer\nad2c31987026: Pulling fs layer\n4f4fb700ef54: Pulling fs layer\n9596d1950f8e: Pulling fs layer\n02f231350a34: Pulling fs layer\n35bdc0ee879a: Pulling fs layer\nb843a1b8b352: Pulling fs layer\n801e3da4fabc: Pulling fs layer\nde7ff8088be3: Pulling fs layer\n4f4fb700ef54: Waiting\n9596d1950f8e: Waiting\n02f231350a34: Waiting\n35bdc0ee879a: Waiting\nb843a1b8b352: Waiting\n801e3da4fabc: Waiting\nde7ff8088be3: Waiting\nad2c31987026: Waiting\n557fb9245328: Verifying Checksum\n557fb9245328: Download complete\nad2c31987026: Verifying Checksum\nad2c31987026: Download complete\n4f4fb700ef54: Verifying Checksum\n4f4fb700ef54: Download complete\n9596d1950f8e: Verifying Checksum\n9596d1950f8e: Download complete\nd3391c7075df: Verifying Checksum\nd3391c7075df: Download complete\nc46621feb66a: Verifying Checksum\nc46621feb66a: Download complete\n02f231350a34: Download complete\n801e3da4fabc: Verifying Checksum\n801e3da4fabc: Download complete\nc46621feb66a: Pull complete\n557fb9245328: Pull complete\nd3391c7075df: Pull complete\nde7ff8088be3: Verifying Checksum\nde7ff8088be3: Download complete\nad2c31987026: Pull complete\n4f4fb700ef54: Pull complete\n35bdc0ee879a: Verifying Checksum\n35bdc0ee879a: Download complete\n9596d1950f8e: Pull complete\n02f231350a34: Pull complete\nb843a1b8b352: Verifying Checksum\nb843a1b8b352: Download complete\n35bdc0ee879a: Pull complete\nb843a1b8b352: Pull complete\n801e3da4fabc: Pull complete\nde7ff8088be3: Pull complete\nDigest: sha256:750b466554ebeb2e7b5dfc2a6b9a85b6fd2c9e6d73c6ee65104a38003abc39d1\nStatus: Downloaded newer image for ejnshtein/node-tdlib:latest\n ---> ba076d864160\nStep 3/17 : WORKDIR /app/\n ---> Running in 90a7cd28f787\nRemoving intermediate container 90a7cd28f787\n ---> 23fc88ac2f7b\nStep 4/17 : RUN cp /usr/local/lib/libtdjson.so ./libtdjson.so\n ---> Running in 27ff6e39a9cb\nRemoving intermediate container 27ff6e39a9cb\n ---> aa75ba7c0364\nStep 5/17 : RUN apk add --update   ca-certificates   openssl   pcre   lame   libogg   libass   libvpx   libvorbis   libwebp   libtheora   opus   rtmpdump   x264-dev   x265-dev\n ---> Running in f92988fb3396\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.16/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.16/community/x86_64/APKINDEX.tar.gz\n(1/31) Installing lame (3.100-r0)\n(2/31) Installing libpng (1.6.37-r1)\n(3/31) Installing freetype (2.12.1-r0)\n(4/31) Installing fontconfig (2.14.0-r0)\n(5/31) Installing fribidi (1.0.12-r0)\n(6/31) Installing libintl (0.21-r2)\n(7/31) Installing libblkid (2.38-r1)\n(8/31) Installing libmount (2.38-r1)\n(9/31) Installing pcre (8.45-r2)\n(10/31) Installing glib (2.72.1-r0)\n(11/31) Installing graphite2 (1.3.14-r1)\n(12/31) Installing harfbuzz (4.3.0-r0)\n(13/31) Installing libass (0.16.0-r0)\n(14/31) Installing libogg (1.3.5-r1)\n(15/31) Installing libtheora (1.1.1-r16)\n(16/31) Installing libvorbis (1.3.7-r0)\n(17/31) Installing libvpx (1.11.0-r1)\n(18/31) Installing libwebp (1.2.3-r0)\n(19/31) Installing opus (1.3.1-r1)\n(20/31) Installing nettle (3.7.3-r0)\n(21/31) Installing p11-kit (0.24.1-r0)\n(22/31) Installing libtasn1 (4.18.0-r1)\n(23/31) Installing libunistring (1.0-r0)\n(24/31) Installing gnutls (3.7.7-r0)\n(25/31) Installing librtmp (2.4_git20190330-r1)\n(26/31) Installing rtmpdump (2.4_git20190330-r1)\n(27/31) Installing x264-libs (0.163_git20210613-r0)\n(28/31) Installing x264-dev (0.163_git20210613-r0)\n(29/31) Installing numactl (2.0.14-r0)\n(30/31) Installing x265-libs (3.5-r3)\n(31/31) Installing x265-dev (3.5-r3)\nExecuting busybox-1.35.0-r13.trigger\nOK: 376 MiB in 109 packages\nRemoving intermediate container f92988fb3396\n ---> 0584e2536602\nStep 6/17 : COPY --from=ffmpeg /opt/ffmpeg /opt/ffmpeg\n ---> b7b0dbc7468b\nStep 7/17 : COPY --from=ffmpeg /usr/lib/libfdk-aac.so.2 /usr/lib/libfdk-aac.so.2\n ---> 8af94b007a2b\nStep 8/17 : COPY --from=ffmpeg /usr/lib/librav1e.so /usr/lib/librav1e.so\n ---> 30659e019ced\nStep 9/17 : COPY --from=ffmpeg /usr/lib/libx265.so /usr/lib/\n ---> 32e34c8b4928\nStep 10/17 : COPY --from=ffmpeg /usr/lib/libx265.so.* /usr/lib/\n ---> 752a7bebb96f\nStep 11/17 : ENV PATH=/opt/ffmpeg/bin:$PATH\n ---> Running in 9ae7746263b8\nRemoving intermediate container 9ae7746263b8\n ---> fe3b1c66af8f\nStep 12/17 : ADD ./package.json ./package-lock.json ./tsconfig.json ./\n ---> be9fb5b136c2\nStep 13/17 : RUN npm ci\n ---> Running in 9c0eb8aebea3\n\u001b[91mnpm WARN deprecated ini@1.3.5: Please update to ini >=1.3.6 to avoid a prototype pollution issue\n\u001b[0m\u001b[91mnpm WARN\u001b[0m\u001b[91m deprecated debug@4.2.0: Debug versions >=3.2.0 <3.2.7 || >=4 <4.3.1 have a low-severity ReDos regression when used in a Node.js environment. It is recommended you upgrade to 3.2.7 or 4.3.1. (https://github.com/visionmedia/debug/issues/797)\n\u001b[0m\u001b[91mnpm WARN deprecated @types/mongoose@5.11.97: Mongoose publishes its own types, so you do not need to install this package.\n\u001b[0m\nadded 445 packages, and audited 446 packages in 12s\n\n110 packages are looking for funding\n  run `npm fund` for details\n\n9 vulnerabilities (5 moderate, 4 high)\n\nTo address all issues, run:\n  npm audit fix\n\nRun `npm audit` for details.\n\u001b[91mnpm notice \n\u001b[0m\u001b[91mnpm notice\u001b[0m\u001b[91m New major version of npm available! 8.11.0 -> 9.2.0\nnpm\u001b[0m\u001b[91m notice Changelog: <https://github.com/npm/cli/releases/tag/v9.2.0>\nnpm \u001b[0m\u001b[91mnotice Run `npm install -g npm@9.2.0` to update!\nnpm notice \n\u001b[0mRemoving intermediate container 9c0eb8aebea3\n ---> 181372d15f30\nStep 14/17 : ADD ./src ./src\n ---> 603d6ada1e2c\nStep 15/17 : ADD ./types ./types\n ---> 7beafa723831\nStep 16/17 : RUN npm run build-ts\n ---> Running in 0dbbf822f4b2\n\n> nyaasi-bot@5.0.0 build-ts\n> tsc\n\nsrc/actions/commands/about.ts(7,38): error TS2304: Cannot find name 'env'.\nsrc/actions/commands/about.ts(7,51): error TS2304: Cannot find name 'env'.\nsrc/actions/commands/about.ts(8,58): error TS2304: Cannot find name 'env'.\nsrc/actions/commands/about.ts(8,71): error TS2304: Cannot find name 'env'.\nsrc/actions/commands/link-detector.ts(8,6): error TS2304: Cannot find name 'env'.\nsrc/actions/commands/link-detector.ts(12,10): error TS2339: Property 'url' does not exist on type 'Composer<Context>'.\nsrc/actions/commands/link-detector.ts(14,12): error TS2339: Property 'privateChat' does not exist on type 'typeof Composer'.\nsrc/actions/commands/link-detector.ts(14,31): error TS7006: Parameter 'ctx' implicitly has an 'any' type.\nsrc/actions/commands/link-detector.ts(16,37): error TS2304: Cannot find name 'torrentView'.\nsrc/actions/commands/link-detector.ts(24,10): error TS2339: Property 'url' does not exist on type 'Composer<Context>'.\nsrc/actions/commands/link-detector.ts(26,12): error TS2339: Property 'groupChat' does not exist on type 'typeof Composer'.\nsrc/actions/commands/link-detector.ts(27,14): error TS2339: Property 'optional' does not exist on type 'typeof Composer'.\nsrc/actions/commands/link-detector.ts(28,8): error TS7006: Parameter 'ctx' implicitly has an 'any' type.\nsrc/actions/commands/link-detector.ts(29,14): error TS7006: Parameter 'ctx' implicitly has an 'any' type.\nsrc/actions/commands/link-detector.ts(31,41): error TS2304: Cannot find name 'torrentView'.\nsrc/actions/commands/search.ts(12,37): error TS2304: Cannot find name 'searchTorrentView'.\nsrc/actions/commands/search.ts(20,37): error TS2304: Cannot find name 'searchTorrentView'.\nsrc/actions/commands/silent-mode.ts(11,8): error TS2339: Property 'db' does not exist on type 'CommandContext<Context>'.\n  Property 'db' does not exist on type 'FilteredContext<Omit<Context, \"match\"> & { match: string; }, Update & Record<\"message\", Record<\"entities\" | AddTwins<\"message\", \"entities\">, NotUndefined> & Partial<...>> & Partial<...>>'.\nsrc/actions/commands/silent-mode.ts(18,8): error TS2339: Property 'db' does not exist on type 'CommandContext<CommandContext<Context>>'.\n  Property 'db' does not exist on type 'FilteredContext<Omit<CommandContext<Context>, \"match\"> & { match: string; }, Update & Record<\"message\", Record<\"entities\" | AddTwins<\"message\", \"entities\">, NotUndefined> & Partial<...>> & Partial<...>>'.\nsrc/actions/commands/start.ts(10,16): error TS7006: Parameter 'h' implicitly has an 'any' type.\nsrc/actions/commands/start.ts(15,10): error TS2339: Property 'start' does not exist on type 'Composer<Context>'.\nsrc/actions/commands/start.ts(16,12): error TS2339: Property 'privateChat' does not exist on type 'typeof Composer'.\nsrc/actions/commands/start.ts(16,31): error TS7006: Parameter 'ctx' implicitly has an 'any' type.\nsrc/actions/commands/start.ts(33,31): error TS2304: Cannot find name 'env'.\nsrc/actions/commands/start.ts(43,43): error TS2304: Cannot find name 'torrentView'.\nsrc/actions/commands/start.ts(64,60): error TS2345: Argument of type 'string | undefined' is not assignable to parameter of type 'number'.\n  Type 'undefined' is not assignable to type 'number'.\nsrc/actions/commands/start.ts(65,35): error TS2304: Cannot find name 'env'.\nsrc/actions/commands/start.ts(68,35): error TS2304: Cannot find name 'env'.\nsrc/actions/commands/start.ts(82,31): error TS2304: Cannot find name 'buttons'.\nsrc/actions/commands/start.ts(101,50): error TS7006: Parameter 'file' implicitly has an 'any' type.\nsrc/actions/commands/start.ts(103,23): error TS2304: Cannot find name 'sendFile'.\nsrc/actions/commands/start.ts(112,64): error TS2304: Cannot find name 'buffer'.\nsrc/actions/commands/start.ts(129,14): error TS2304: Cannot find name 'env'.\nsrc/actions/commands/start.ts(129,91): error TS2304: Cannot find name 'env'.\nsrc/actions/commands/subscription.ts(15,32): error TS2304: Cannot find name 'subscriptionKeyboard'.\nsrc/database.ts(7,44): error TS2769: No overload matches this call.\n  Overload 1 of 4, '(uri: string, callback: Callback<Connection>): void', gave the following error.\n    Argument of type 'string | undefined' is not assignable to parameter of type 'string'.\n      Type 'undefined' is not assignable to type 'string'.\n  Overload 2 of 4, '(uri: string, options?: ConnectOptions | undefined): Connection', gave the following error.\n    Argument of type 'string | undefined' is not assignable to parameter of type 'string'.\n      Type 'undefined' is not assignable to type 'string'.\nsrc/database.ts(14,12): error TS2339: Property 'then' does not exist on type 'void & Connection'.\nsrc/database.ts(18,12): error TS2551: Property 'catch' does not exist on type 'void & Connection'. Did you mean 'watch'?\nsrc/database.ts(18,19): error TS7006: Parameter 'e' implicitly has an 'any' type.\nsrc/lib/get-magnet-hash.ts(3,3): error TS2322: Type 'string | null' is not assignable to type 'string'.\n  Type 'null' is not assignable to type 'string'.\nsrc/lib/get-url-in-message.ts(6,37): error TS2339: Property 'url' does not exist on type 'MessageEntity'.\n  Property 'url' does not exist on type 'CommonMessageEntity'.\nsrc/lib/inline-torrent.ts(1,42): error TS2307: Cannot find module 'telegraf/typings/telegram-types' or its corresponding type declarations.\nsrc/lib/inline-torrent.ts(2,10): error TS2305: Module '\"@ejnshtein/nyaasi\"' has no exported member 'SearchFile'.\nsrc/lib/inline-torrent.ts(5,27): error TS2307: Cannot find module '@lib/templates' or its corresponding type declarations.\nsrc/lib/inline-torrent.ts(6,21): error TS2307: Cannot find module '@lib/buttons' or its corresponding type declarations.\nsrc/lib/inline-torrent.ts(7,20): error TS2307: Cannot find module '@lib/buffer' or its corresponding type declarations.\nsrc/lib/inline-torrent.ts(8,31): error TS2307: Cannot find module '@lib/get-magnet-hash' or its corresponding type declarations.\nsrc/lib/query-option.ts(1,40): error TS2307: Cannot find module 'telegraf/typings/telegram-types' or its corresponding type declarations.\nsrc/lib/query-option.ts(2,8): error TS1192: Module '\"/app/src/lib/buffer\"' has no default export.\nsrc/lib/templates.ts(6,16): error TS7006: Parameter 'url' implicitly has an 'any' type.\nsrc/lib/templates.ts(6,21): error TS7006: Parameter 'query' implicitly has an 'any' type.\nsrc/lib/templates.ts(6,28): error TS7006: Parameter 'page' implicitly has an 'any' type.\nsrc/lib/templates.ts(6,34): error TS7006: Parameter 'offset' implicitly has an 'any' type.\nsrc/lib/templates.ts(25,10): error TS7006: Parameter 'torrentId' implicitly has an 'any' type.\nsrc/lib/templates.ts(25,21): error TS7006: Parameter 'torrent' implicitly has an 'any' type.\nsrc/lib/templates.ts(25,30): error TS7006: Parameter 'url' implicitly has an 'any' type.\nsrc/lib/templates.ts(27,9): error TS2304: Cannot find name 'env'.\nsrc/lib/templates.ts(33,66): error TS2304: Cannot find name 'env'.\nsrc/lib/templates.ts(51,15): error TS7006: Parameter 'torrent' implicitly has an 'any' type.\nsrc/lib/templates.ts(51,24): error TS7006: Parameter 'offset' implicitly has an 'any' type.\nsrc/lib/templates.ts(51,32): error TS7006: Parameter 'url' implicitly has an 'any' type.\nsrc/lib/templates.ts(52,45): error TS2304: Cannot find name 'env'.\nsrc/lib/templates.ts(65,17): error TS7006: Parameter 'torrent' implicitly has an 'any' type.\nsrc/lib/templates.ts(66,45): error TS2304: Cannot find name 'env'.\nsrc/lib/templates.ts(85,18): error TS7006: Parameter 'el' implicitly has an 'any' type.\nsrc/lib/templates.ts(86,39): error TS2304: Cannot find name 'env'.\nsrc/lib/templates.ts(89,33): error TS2304: Cannot find name 'env'.\nsrc/lib/templates.ts(94,11): error TS7006: Parameter 'e' implicitly has an 'any' type.\nsrc/logger.ts(1,33): error TS2307: Cannot find module 'telegraf' or its corresponding type declarations.\nsrc/logger.ts(2,27): error TS2307: Cannot find module '@models/User' or its corresponding type declarations.\nsrc/models/Chapter.ts(10,8): error TS2307: Cannot find module 'mangadex-api/typings/mangadex' or its corresponding type declarations.\nsrc/models/Chapter.ts(21,10): error TS2564: Property 'chapter_id' has no initializer and is not definitely assigned in the constructor.\nsrc/models/ChapterRead.ts(6,10): error TS2564: Property 'user_id' has no initializer and is not definitely assigned in the constructor.\nsrc/models/ChapterRead.ts(8,10): error TS2564: Property 'chapter_id' has no initializer and is not definitely assigned in the constructor.\nsrc/models/ChapterRead.ts(10,10): error TS2564: Property 'manga_id' has no initializer and is not definitely assigned in the constructor.\nsrc/models/ChapterRead.ts(12,10): error TS2564: Property 'status' has no initializer and is not definitely assigned in the constructor.\nsrc/models/Genre.ts(7,10): error TS2564: Property 'genre_id' has no initializer and is not definitely assigned in the constructor.\nsrc/models/Genre.ts(10,10): error TS2564: Property 'name' has no initializer and is not definitely assigned in the constructor.\nsrc/models/Group.ts(2,43): error TS2307: Cannot find module 'mangadex-api/typings/mangadex' or its corresponding type declarations.\nsrc/models/Group.ts(8,10): error TS2564: Property 'group_id' has no initializer and is not definitely assigned in the constructor.\nsrc/models/Group.ts(16,10): error TS2564: Property 'manga' has no initializer and is not definitely assigned in the constructor.\nsrc/models/Manga.ts(2,27): error TS2307: Cannot find module 'mangadex-api/typings/mangadex' or its corresponding type declarations.\nsrc/models/Manga.ts(3,30): error TS2307: Cannot find module '@models/index' or its corresponding type declarations.\nsrc/models/Manga.ts(12,10): error TS2564: Property 'manga_id' has no initializer and is not definitely assigned in the constructor.\nsrc/models/Manga.ts(15,10): error TS2564: Property 'manga' has no initializer and is not definitely assigned in the constructor.\nsrc/models/MangaFollow.ts(6,10): error TS2564: Property 'user_id' has no initializer and is not definitely assigned in the constructor.\nsrc/models/MangaFollow.ts(8,10): error TS2564: Property 'manga_id' has no initializer and is not definitely assigned in the constructor.\nsrc/models/MangaFollow.ts(10,10): error TS2564: Property 'status' has no initializer and is not definitely assigned in the constructor.\nsrc/models/User.ts(7,10): error TS2564: Property 'id' has no initializer and is not definitely assigned in the constructor.\nsrc/models/User.ts(10,10): error TS2564: Property 'username' has no initializer and is not definitely assigned in the constructor.\nsrc/models/User.ts(13,10): error TS2564: Property 'first_name' has no initializer and is not definitely assigned in the constructor.\nsrc/models/User.ts(16,10): error TS2564: Property 'last_name' has no initializer and is not definitely assigned in the constructor.\nsrc/models/User.ts(19,10): error TS2564: Property 'private_mode' has no initializer and is not definitely assigned in the constructor.\nsrc/models/User.ts(22,10): error TS2564: Property 'inline_buttons' has no initializer and is not definitely assigned in the constructor.\nsrc/models/index.ts(1,28): error TS2307: Cannot find module '@src/database' or its corresponding type declarations.\n","stderr":"The command '/bin/sh -c npm run build-ts' returned a non-zero code: 2\n"},"endTime":1671999443428}