{"repository":"https://github.com/prowler-cloud/prowler","dockerfilePath":"Dockerfile","startTime":1673180433556,"endTime":1673180532921,"clone":{"startTime":1673180433557,"stdout":"","stderr":"Cloning into '/tmp/dinghy-analysis/prowler-cloud/prowler'...\n","error":null,"endTime":1673180434869,"commit":"1c50a87ca22ae1175daf3d4857c0eeb442a776cf"},"originalBuild":{"startTime":1673180434955,"endTime":1673180532228,"error":null,"stdout":"Sending build context to Docker daemon  12.57MB\r\r\nStep 1/12 : FROM python:3.9-alpine\n ---> d6d1ed462b20\nStep 2/12 : LABEL maintainer=\"https://github.com/prowler-cloud/prowler\"\n ---> Running in 24170d648340\nRemoving intermediate container 24170d648340\n ---> ef3d79ecee7d\nStep 3/12 : RUN apk --no-cache upgrade\n ---> Running in 7ae7ed5fe316\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/community/x86_64/APKINDEX.tar.gz\n(1/6) Upgrading libcrypto3 (3.0.7-r0 -> 3.0.7-r2)\n(2/6) Upgrading libssl3 (3.0.7-r0 -> 3.0.7-r2)\n(3/6) Upgrading sqlite-libs (3.40.0-r0 -> 3.40.1-r0)\n(4/6) Upgrading libuuid (2.38.1-r0 -> 2.38.1-r1)\n(5/6) Upgrading ca-certificates-bundle (20220614-r2 -> 20220614-r3)\n(6/6) Upgrading ca-certificates (20220614-r2 -> 20220614-r3)\nExecuting busybox-1.35.0-r29.trigger\nExecuting ca-certificates-20220614-r3.trigger\nOK: 16 MiB in 37 packages\nRemoving intermediate container 7ae7ed5fe316\n ---> 5f27fa6b5dc5\nStep 4/12 : RUN mkdir -p /home/prowler &&     echo 'prowler:x:1000:1000:prowler:/home/prowler:' > /etc/passwd &&     echo 'prowler:x:1000:' > /etc/group &&     chown -R prowler:prowler /home/prowler\n ---> Running in 0d9cc5c52e2b\nRemoving intermediate container 0d9cc5c52e2b\n ---> 5e91ed8cadf9\nStep 5/12 : USER prowler\n ---> Running in 785020ffd2ae\nRemoving intermediate container 785020ffd2ae\n ---> 24eaa73b4a47\nStep 6/12 : WORKDIR /home/prowler\n ---> Running in 5e5c81df784d\nRemoving intermediate container 5e5c81df784d\n ---> f46593df2dc1\nStep 7/12 : COPY prowler/ /home/prowler/prowler/\n ---> ba39c22ea443\nStep 8/12 : COPY pyproject.toml /home/prowler\n ---> d2d40fe1f09e\nStep 9/12 : ENV HOME='/home/prowler'\n ---> Running in 1634235672ec\nRemoving intermediate container 1634235672ec\n ---> 7317eea018db\nStep 10/12 : ENV PATH=\"$HOME/.local/bin:$PATH\"\n ---> Running in 5af2e3a654c2\nRemoving intermediate container 5af2e3a654c2\n ---> 24c5871688b1\nStep 11/12 : RUN pip install --no-cache-dir --upgrade pip &&     pip install --no-cache-dir .\n ---> Running in 758d1d2d4ac9\nDefaulting to user installation because normal site-packages is not writeable\nRequirement already satisfied: pip in /usr/local/lib/python3.9/site-packages (22.0.4)\nCollecting pip\n  Downloading pip-22.3.1-py3-none-any.whl (2.1 MB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 2.1/2.1 MB 65.5 MB/s eta 0:00:00\nInstalling collected packages: pip\nSuccessfully installed pip-22.3.1\n\u001b[91mWARNING: You are using pip version 22.0.4; however, version 22.3.1 is available.\nYou should consider upgrading via the '/usr/local/bin/python -m pip install --upgrade pip' command.\n\u001b[0mDefaulting to user installation because normal site-packages is not writeable\nProcessing /home/prowler\n  Installing build dependencies: started\n  Installing build dependencies: finished with status 'done'\n  Getting requirements to build wheel: started\n  Getting requirements to build wheel: finished with status 'done'\n  Installing backend dependencies: started\n  Installing backend dependencies: finished with status 'done'\n  Preparing metadata (pyproject.toml): started\n  Preparing metadata (pyproject.toml): finished with status 'done'\nCollecting shodan~=1.28.0\n  Downloading shodan-1.28.0.tar.gz (53 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 53.5/53.5 kB 5.8 MB/s eta 0:00:00\n  Preparing metadata (setup.py): started\n  Preparing metadata (setup.py): finished with status 'done'\nCollecting azure-storage-blob~=12.14.1\n  Downloading azure_storage_blob-12.14.1-py3-none-any.whl (383 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 383.2/383.2 kB 77.5 MB/s eta 0:00:00\nCollecting tabulate~=0.9.0\n  Downloading tabulate-0.9.0-py3-none-any.whl (35 kB)\nCollecting msgraph-core~=0.2.2\n  Downloading msgraph_core-0.2.2-py3-none-any.whl (15 kB)\nCollecting azure-mgmt-storage~=21.0.0\n  Downloading azure_mgmt_storage-21.0.0-py3-none-any.whl (2.8 MB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 2.8/2.8 MB 119.4 MB/s eta 0:00:00\nCollecting arnparse~=0.0.2\n  Downloading arnparse-0.0.2-py2.py3-none-any.whl (2.9 kB)\nCollecting pydantic~=1.9.1\n  Downloading pydantic-1.9.2-cp39-cp39-musllinux_1_1_x86_64.whl (12.5 MB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 12.5/12.5 MB 6.9 MB/s eta 0:00:00\nCollecting boto3~=1.26.17\n  Downloading boto3-1.26.45-py3-none-any.whl (132 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 132.7/132.7 kB 74.9 MB/s eta 0:00:00\nCollecting azure-mgmt-subscription~=3.1.1\n  Downloading azure_mgmt_subscription-3.1.1-py3-none-any.whl (79 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 79.4/79.4 kB 108.2 MB/s eta 0:00:00\nCollecting botocore~=1.29.18\n  Downloading botocore-1.29.45-py3-none-any.whl (10.3 MB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 10.3/10.3 MB 105.2 MB/s eta 0:00:00\nCollecting colorama~=0.4.4\n  Downloading colorama-0.4.6-py2.py3-none-any.whl (25 kB)\nCollecting azure-mgmt-security~=3.0.0\n  Downloading azure_mgmt_security-3.0.0-py3-none-any.whl (941 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 941.6/941.6 kB 74.4 MB/s eta 0:00:00\nCollecting azure-identity~=1.12.0\n  Downloading azure_identity-1.12.0-py3-none-any.whl (135 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 135.5/135.5 kB 72.4 MB/s eta 0:00:00\nCollecting azure-mgmt-authorization~=3.0.0\n  Downloading azure_mgmt_authorization-3.0.0-py3-none-any.whl (965 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 965.9/965.9 kB 139.0 MB/s eta 0:00:00\nCollecting detect-secrets~=1.4.0\n  Downloading detect_secrets-1.4.0-py3-none-any.whl (116 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 116.3/116.3 kB 163.4 MB/s eta 0:00:00\nCollecting alive-progress~=2.4.1\n  Downloading alive_progress-2.4.1-py3-none-any.whl (80 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 80.9/80.9 kB 90.6 MB/s eta 0:00:00\nCollecting grapheme==0.6.0\n  Downloading grapheme-0.6.0.tar.gz (207 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 207.3/207.3 kB 85.6 MB/s eta 0:00:00\n  Preparing metadata (setup.py): started\n  Preparing metadata (setup.py): finished with status 'done'\nCollecting about-time==3.1.1\n  Downloading about_time-3.1.1-py3-none-any.whl (9.1 kB)\nCollecting six>=1.12.0\n  Downloading six-1.16.0-py2.py3-none-any.whl (11 kB)\nCollecting cryptography>=2.5\n  Downloading cryptography-39.0.0-cp36-abi3-musllinux_1_1_x86_64.whl (4.3 MB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 4.3/4.3 MB 120.6 MB/s eta 0:00:00\nCollecting azure-core<2.0.0,>=1.11.0\n  Downloading azure_core-1.26.2-py3-none-any.whl (173 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 173.8/173.8 kB 219.9 MB/s eta 0:00:00\nCollecting msal-extensions<2.0.0,>=0.3.0\n  Downloading msal_extensions-1.0.0-py2.py3-none-any.whl (19 kB)\nCollecting msal<2.0.0,>=1.12.0\n  Downloading msal-1.20.0-py2.py3-none-any.whl (90 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 90.0/90.0 kB 159.5 MB/s eta 0:00:00\nCollecting azure-mgmt-core<2.0.0,>=1.3.2\n  Downloading azure_mgmt_core-1.3.2-py3-none-any.whl (26 kB)\nCollecting msrest>=0.7.1\n  Downloading msrest-0.7.1-py3-none-any.whl (85 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 85.4/85.4 kB 212.2 MB/s eta 0:00:00\nCollecting azure-common~=1.1\n  Downloading azure_common-1.1.28-py2.py3-none-any.whl (14 kB)\nCollecting s3transfer<0.7.0,>=0.6.0\n  Downloading s3transfer-0.6.0-py3-none-any.whl (79 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 79.6/79.6 kB 220.4 MB/s eta 0:00:00\nCollecting jmespath<2.0.0,>=0.7.1\n  Downloading jmespath-1.0.1-py3-none-any.whl (20 kB)\nCollecting python-dateutil<3.0.0,>=2.1\n  Downloading python_dateutil-2.8.2-py2.py3-none-any.whl (247 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 247.7/247.7 kB 91.5 MB/s eta 0:00:00\nCollecting urllib3<1.27,>=1.25.4\n  Downloading urllib3-1.26.13-py2.py3-none-any.whl (140 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 140.6/140.6 kB 81.4 MB/s eta 0:00:00\nCollecting requests\n  Downloading requests-2.28.1-py3-none-any.whl (62 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 62.8/62.8 kB 204.9 MB/s eta 0:00:00\nCollecting pyyaml\n  Downloading PyYAML-6.0.tar.gz (124 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 125.0/125.0 kB 253.9 MB/s eta 0:00:00\n  Installing build dependencies: started\n  Installing build dependencies: finished with status 'done'\n  Getting requirements to build wheel: started\n  Getting requirements to build wheel: finished with status 'done'\n  Preparing metadata (pyproject.toml): started\n  Preparing metadata (pyproject.toml): finished with status 'done'\nCollecting typing-extensions>=3.7.4.3\n  Downloading typing_extensions-4.4.0-py3-none-any.whl (26 kB)\nCollecting click\n  Downloading click-8.1.3-py3-none-any.whl (96 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 96.6/96.6 kB 74.6 MB/s eta 0:00:00\nCollecting click-plugins\n  Downloading click_plugins-1.1.1-py2.py3-none-any.whl (7.5 kB)\nCollecting XlsxWriter\n  Downloading XlsxWriter-3.0.6-py3-none-any.whl (152 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 152.4/152.4 kB 248.3 MB/s eta 0:00:00\nCollecting cffi>=1.12\n  Downloading cffi-1.15.1-cp39-cp39-musllinux_1_1_x86_64.whl (463 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 463.1/463.1 kB 102.5 MB/s eta 0:00:00\nCollecting PyJWT[crypto]<3,>=1.0.0\n  Downloading PyJWT-2.6.0-py3-none-any.whl (20 kB)\nCollecting portalocker<3,>=1.0\n  Downloading portalocker-2.6.0-py2.py3-none-any.whl (15 kB)\nCollecting certifi>=2017.4.17\n  Downloading certifi-2022.12.7-py3-none-any.whl (155 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 155.3/155.3 kB 227.0 MB/s eta 0:00:00\nCollecting requests-oauthlib>=0.5.0\n  Downloading requests_oauthlib-1.3.1-py2.py3-none-any.whl (23 kB)\nCollecting isodate>=0.6.0\n  Downloading isodate-0.6.1-py2.py3-none-any.whl (41 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 41.7/41.7 kB 4.8 MB/s eta 0:00:00\nCollecting charset-normalizer<3,>=2\n  Downloading charset_normalizer-2.1.1-py3-none-any.whl (39 kB)\nCollecting idna<4,>=2.5\n  Downloading idna-3.4-py3-none-any.whl (61 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 61.5/61.5 kB 159.8 MB/s eta 0:00:00\nCollecting pycparser\n  Downloading pycparser-2.21-py2.py3-none-any.whl (118 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 118.7/118.7 kB 231.5 MB/s eta 0:00:00\nCollecting oauthlib>=3.0.0\n  Downloading oauthlib-3.2.2-py3-none-any.whl (151 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 151.7/151.7 kB 202.6 MB/s eta 0:00:00\nBuilding wheels for collected packages: prowler-cloud, grapheme, shodan, pyyaml\n  Building wheel for prowler-cloud (pyproject.toml): started\n  Building wheel for prowler-cloud (pyproject.toml): finished with status 'done'\n  Created wheel for prowler-cloud: filename=prowler_cloud-3.0.2-py3-none-any.whl size=827259 sha256=6902a4b4786f9850e66593fde4c03e449a4938fd961e9fae3ef31b9c49a6bc00\n  Stored in directory: /tmp/pip-ephem-wheel-cache-4wexltxh/wheels/df/49/e6/4116a456add0fdc30dbd88c969e7f0197004ebeccbbbe3af1b\n  Building wheel for grapheme (setup.py): started\n  Building wheel for grapheme (setup.py): finished with status 'done'\n  Created wheel for grapheme: filename=grapheme-0.6.0-py3-none-any.whl size=210096 sha256=28297818fbbd72ab75785b3fb236d265a060be3812f002c55273634037d2e599\n  Stored in directory: /tmp/pip-ephem-wheel-cache-4wexltxh/wheels/ea/77/3b/5c11de6388df505ba18f5a7e7173ed997007fdf14b24caba9b\n  Building wheel for shodan (setup.py): started\n  Building wheel for shodan (setup.py): finished with status 'done'\n  Created wheel for shodan: filename=shodan-1.28.0-py3-none-any.whl size=47645 sha256=64dcd5fbe5b815e3ca9b16c586fefd415f4dd3722b7564c4b64fdc85499b4d5d\n  Stored in directory: /tmp/pip-ephem-wheel-cache-4wexltxh/wheels/08/a5/86/f06f5afdc502bfa381e4e002be714dc32e943fdfc57c53ab5a\n  Building wheel for pyyaml (pyproject.toml): started\n  Building wheel for pyyaml (pyproject.toml): finished with status 'done'\n  Created wheel for pyyaml: filename=PyYAML-6.0-cp39-cp39-linux_x86_64.whl size=45332 sha256=c13ac32e1f945c55ea195e9ddfd1864bbb3d77659c6794def60761326993aba2\n  Stored in directory: /tmp/pip-ephem-wheel-cache-4wexltxh/wheels/5c/9d/5f/838ca730866969b9340acf232c4621bd398bc8be7cd6a5f838\nSuccessfully built prowler-cloud grapheme shodan pyyaml\nInstalling collected packages: grapheme, azure-common, arnparse, about-time, XlsxWriter, urllib3, typing-extensions, tabulate, six, pyyaml, PyJWT, pycparser, portalocker, oauthlib, msgraph-core, jmespath, idna, colorama, click, charset-normalizer, certifi, alive-progress, requests, python-dateutil, pydantic, isodate, click-plugins, cffi, shodan, requests-oauthlib, detect-secrets, cryptography, botocore, azure-core, s3transfer, msrest, azure-mgmt-core, msal, boto3, azure-storage-blob, azure-mgmt-subscription, azure-mgmt-storage, azure-mgmt-security, azure-mgmt-authorization, msal-extensions, azure-identity, prowler-cloud\nSuccessfully installed PyJWT-2.6.0 XlsxWriter-3.0.6 about-time-3.1.1 alive-progress-2.4.1 arnparse-0.0.2 azure-common-1.1.28 azure-core-1.26.2 azure-identity-1.12.0 azure-mgmt-authorization-3.0.0 azure-mgmt-core-1.3.2 azure-mgmt-security-3.0.0 azure-mgmt-storage-21.0.0 azure-mgmt-subscription-3.1.1 azure-storage-blob-12.14.1 boto3-1.26.45 botocore-1.29.45 certifi-2022.12.7 cffi-1.15.1 charset-normalizer-2.1.1 click-8.1.3 click-plugins-1.1.1 colorama-0.4.6 cryptography-39.0.0 detect-secrets-1.4.0 grapheme-0.6.0 idna-3.4 isodate-0.6.1 jmespath-1.0.1 msal-1.20.0 msal-extensions-1.0.0 msgraph-core-0.2.2 msrest-0.7.1 oauthlib-3.2.2 portalocker-2.6.0 prowler-cloud-3.0.2 pycparser-2.21 pydantic-1.9.2 python-dateutil-2.8.2 pyyaml-6.0 requests-2.28.1 requests-oauthlib-1.3.1 s3transfer-0.6.0 shodan-1.28.0 six-1.16.0 tabulate-0.9.0 typing-extensions-4.4.0 urllib3-1.26.13\nRemoving intermediate container 758d1d2d4ac9\n ---> 3ca2702b33ca\nStep 12/12 : ENTRYPOINT [\"prowler\"]\n ---> Running in 94f0c5d20d6f\nRemoving intermediate container 94f0c5d20d6f\n ---> 7d7cace54b75\nSuccessfully built 7d7cace54b75\nSuccessfully tagged prowler:latest\n","stderr":"","imageSize":291348553},"repair":{"startTime":1673180532297,"endTime":1673180532410,"violations":[],"repairedDockerfile":"FROM python:3.9-alpine\n\nLABEL maintainer=\"https://github.com/prowler-cloud/prowler\"\n\n# Update system dependencies\nRUN apk --no-cache upgrade\n\n# Create nonroot user\nRUN mkdir -p /home/prowler && \\\n    echo 'prowler:x:1000:1000:prowler:/home/prowler:' > /etc/passwd && \\\n    echo 'prowler:x:1000:' > /etc/group && \\\n    chown -R prowler:prowler /home/prowler\nUSER prowler\n\n# Copy necessary files\nWORKDIR /home/prowler\nCOPY prowler/ /home/prowler/prowler/\nCOPY pyproject.toml /home/prowler\n\n# Install dependencies\nENV HOME='/home/prowler'\nENV PATH=\"$HOME/.local/bin:$PATH\"\n#hadolint ignore=DL3013\nRUN pip install --no-cache-dir --upgrade pip && \\\n    pip install --no-cache-dir .\n\nENTRYPOINT [\"prowler\"]\n"}}