{"repository":"https://github.com/haozibi/leetcode-badge","dockerfilePath":"Dockerfile","startTime":1672211248638,"clone":{"stdout":"","stderr":"Cloning into '/tmp/dinghy-analysis/haozibi/leetcode-badge'...\n","error":null,"commit":"c1e0ed88bd49d1664e327e2ab5c6661f85b895cf"},"originalBuild":{"startTimestamp":1672211249604,"endTimestamp":1672211365835,"error":null,"stdout":"Sending build context to Docker daemon  4.722MB\r\r\nStep 1/20 : FROM haozibi/upx AS build-upx\nlatest: Pulling from haozibi/upx\nb1fbe5b3113f: Pulling fs layer\n6f444a1d6584: Pulling fs layer\n6f444a1d6584: Download complete\nb1fbe5b3113f: Verifying Checksum\nb1fbe5b3113f: Download complete\nb1fbe5b3113f: Pull complete\n6f444a1d6584: Pull complete\nDigest: sha256:db274aebbcde7cc40df6fd9afd3776a9386156d03249e7941b4b6ca9c8c83050\nStatus: Downloaded newer image for haozibi/upx:latest\n ---> ed52ceea825b\nStep 2/20 : FROM golang:1.18.5-alpine3.16 AS build-env\n1.18.5-alpine3.16: Pulling from library/golang\n213ec9aee27d: Already exists\n5299e6f78605: Pulling fs layer\n1cab0e43db0a: Pulling fs layer\naf72e8bb74db: Pulling fs layer\n3a421caacf35: Pulling fs layer\n1cab0e43db0a: Download complete\n5299e6f78605: Download complete\n3a421caacf35: Download complete\n5299e6f78605: Pull complete\naf72e8bb74db: Verifying Checksum\naf72e8bb74db: Download complete\n1cab0e43db0a: Pull complete\naf72e8bb74db: Pull complete\n3a421caacf35: Pull complete\nDigest: sha256:8e45e2ef37d2b6d98900392029db2bc88f42c0f2a9a8035fa7da90014698e86b\nStatus: Downloaded newer image for golang:1.18.5-alpine3.16\n ---> bacc2f10e6e1\nStep 3/20 : RUN apk --no-cache add build-base git libseccomp\n ---> Running in 4a1778cb5f24\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.16/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.16/community/x86_64/APKINDEX.tar.gz\n(1/27) Upgrading musl (1.2.3-r0 -> 1.2.3-r2)\n(2/27) Installing libgcc (11.2.1_git20220219-r2)\n(3/27) Installing libstdc++ (11.2.1_git20220219-r2)\n(4/27) Installing binutils (2.38-r3)\n(5/27) Installing libmagic (5.41-r0)\n(6/27) Installing file (5.41-r0)\n(7/27) Installing libgomp (11.2.1_git20220219-r2)\n(8/27) Installing libatomic (11.2.1_git20220219-r2)\n(9/27) Installing gmp (6.2.1-r2)\n(10/27) Installing isl22 (0.22-r0)\n(11/27) Installing mpfr4 (4.1.0-r0)\n(12/27) Installing mpc1 (1.2.1-r0)\n(13/27) Installing gcc (11.2.1_git20220219-r2)\n(14/27) Installing musl-dev (1.2.3-r2)\n(15/27) Installing libc-dev (0.7.2-r3)\n(16/27) Installing g++ (11.2.1_git20220219-r2)\n(17/27) Installing make (4.3-r0)\n(18/27) Installing fortify-headers (1.1-r1)\n(19/27) Installing patch (2.7.6-r7)\n(20/27) Installing build-base (0.5-r3)\n(21/27) Installing brotli-libs (1.0.9-r6)\n(22/27) Installing nghttp2-libs (1.47.0-r0)\n(23/27) Installing libcurl (7.83.1-r5)\n(24/27) Installing expat (2.5.0-r0)\n(25/27) Installing pcre2 (10.40-r0)\n(26/27) Installing git (2.36.3-r0)\n(27/27) Installing libseccomp (2.5.2-r1)\nExecuting busybox-1.35.0-r17.trigger\nOK: 200 MiB in 41 packages\nRemoving intermediate container 4a1778cb5f24\n ---> 9e5fa428e5fc\nStep 4/20 : ARG BIN_NAME=leetcode-badge\n ---> Running in 3f1a22cfcd5c\nRemoving intermediate container 3f1a22cfcd5c\n ---> f103f8f336e3\nStep 5/20 : WORKDIR /${BIN_NAME}\n ---> Running in fc5f3a11c45b\nRemoving intermediate container fc5f3a11c45b\n ---> b82340400c44\nStep 6/20 : ADD go.mod .\n ---> 7c21df0fb208\nStep 7/20 : ADD go.sum .\n ---> 446a14f6ad44\nStep 8/20 : RUN go env -w GO111MODULE=on && go mod download\n ---> Running in 5509bd7189f6\nRemoving intermediate container 5509bd7189f6\n ---> 8ae2a3347558\nStep 9/20 : ADD . .\n ---> b797c03577b9\nStep 10/20 : RUN scmp_sys_resolver faccessat2\n ---> Running in 9b4c64bfe207\n439\nRemoving intermediate container 9b4c64bfe207\n ---> d9ff1e828119\nStep 11/20 : RUN make build-linux\n ---> Running in 348b993e936c\nGood format\nCGO_ENABLED=1 GOOS=linux GOARCH=amd64 go build \"-v\" -ldflags '-X \"github.com/haozibi/leetcode-badge/app.BuildTime=2022-12-28 07:09:00 UTC\" -X \"github.com/haozibi/leetcode-badge/app.BuildVersion=v0.6.5\" -X \"github.com/haozibi/leetcode-badge/app.BuildAppName=leetcode-badge\" -X \"github.com/haozibi/leetcode-badge/app.CommitHash=c1e0ed8\"' -tags '\"\"' -o bin/leetcode-badge\n\u001b[91mgithub.com/haozibi/leetcode-badge\n\u001b[0mRemoving intermediate container 348b993e936c\n ---> 78f0fe344a40\nStep 12/20 : WORKDIR /data\n ---> Running in e788de169741\nRemoving intermediate container e788de169741\n ---> c8385825e27f\nStep 13/20 : COPY --from=build-upx /bin/upx /bin/upx\n ---> 5e9c137af959\nStep 14/20 : RUN cp /${BIN_NAME}/bin/${BIN_NAME} /data/main\n ---> Running in 2989f00cf030\nRemoving intermediate container 2989f00cf030\n ---> 7dd6bddc54a7\nStep 15/20 : FROM alpine:3.16\n3.16: Pulling from library/alpine\nca7dd9ec2225: Already exists\nDigest: sha256:b95359c2505145f16c6aa384f9cc74eeff78eb36d308ca4fd902eeeb0a0b161b\nStatus: Downloaded newer image for alpine:3.16\n ---> bfe296a52501\nStep 16/20 : RUN apk update && apk add tzdata libseccomp     && ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime     && echo \"Asia/Shanghai\" > /etc/timezone\n ---> Running in 6946065a4674\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.16/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.16/community/x86_64/APKINDEX.tar.gz\nv3.16.3-91-gd0e167f17b [https://dl-cdn.alpinelinux.org/alpine/v3.16/main]\nv3.16.3-88-gef347edb61 [https://dl-cdn.alpinelinux.org/alpine/v3.16/community]\nOK: 17039 distinct packages available\n(1/2) Installing libseccomp (2.5.2-r1)\n(2/2) Installing tzdata (2022f-r1)\nExecuting busybox-1.35.0-r17.trigger\nOK: 9 MiB in 16 packages\nRemoving intermediate container 6946065a4674\n ---> 6dea62c52d52\nStep 17/20 : RUN apk add --update ca-certificates && rm -rf /var/cache/apk/*\n ---> Running in dc6f748d58c8\n(1/1) Installing ca-certificates (20220614-r0)\nExecuting busybox-1.35.0-r17.trigger\nExecuting ca-certificates-20220614-r0.trigger\nOK: 10 MiB in 17 packages\nRemoving intermediate container dc6f748d58c8\n ---> c7d3a94fc7f3\nStep 18/20 : COPY --from=build-env /data/main /home/main\n ---> 54a4b6e2fb5c\nStep 19/20 : RUN ls -alh /home/main && /home/main help\n ---> Running in 110d880d4a16\n-rwxr-xr-x    1 root     root       17.3M Dec 28 15:09 /home/main\nLeetCode Badge CLI\n\nUsage:\n  leetcode-badge [command]\n\nAvailable Commands:\n  completion  Generate the autocompletion script for the specified shell\n  help        Help about any command\n  run         Run Web\n  version     Show version\n\nFlags:\n  -h, --help   help for leetcode-badge\n\nUse \"leetcode-badge [command] --help\" for more information about a command.\nRemoving intermediate container 110d880d4a16\n ---> 5fb77a668f76\nStep 20/20 : ENTRYPOINT [\"/home/main\",\"run\"]\n ---> Running in 2bac2495af7a\nRemoving intermediate container 2bac2495af7a\n ---> 92cc478a4917\nSuccessfully built 92cc478a4917\nSuccessfully tagged leetcode-badge:latest\n","stderr":"","imageSize":28109679},"repair":{"violations":[{"name":"apkAddUseNoCache","position":{"start":31,"end":31,"columnStart":18,"columnEnd":43}},{"name":"apkAddUseNoCache","position":{"start":35,"end":35,"columnStart":4,"columnEnd":36}}],"repairedDockerfile":"FROM haozibi/upx AS build-upx\n\nFROM golang:1.18.5-alpine3.16 AS build-env\n\n#RUN sed -i 's/dl-cdn.alpinelinux.org/mirrors.tuna.tsinghua.edu.cn/g' /etc/apk/repositories\n\n# https://wiki.alpinelinux.org/wiki/Release_Notes_for_Alpine_3.14.0#faccessat2\n# https://command-not-found.com/scmp_sys_resolver\nRUN apk --no-cache add build-base git libseccomp\n\n# build\nARG BIN_NAME=leetcode-badge\nWORKDIR /${BIN_NAME}\nADD go.mod .\nADD go.sum .\n#RUN go env -w GO111MODULE=on && go env -w GOPROXY=\"https://goproxy.cn,direct\" && go mod download\nRUN go env -w GO111MODULE=on && go mod download\nADD . .\nRUN scmp_sys_resolver faccessat2\nRUN make build-linux\n\n# upx\nWORKDIR /data\nCOPY --from=build-upx /bin/upx /bin/upx\nRUN cp /${BIN_NAME}/bin/${BIN_NAME} /data/main\n# RUN upx -k --best --ultra-brute /data/main\n\nFROM alpine:3.16\n\n#RUN sed -i 's/dl-cdn.alpinelinux.org/mirrors.tuna.tsinghua.edu.cn/g' /etc/apk/repositories\n\nRUN apk update && apk add --no-cache tzdata libseccomp \\\n    && ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime \\\n    && echo \"Asia/Shanghai\" > /etc/timezone\n\nRUN apk add --no-cache --update ca-certificates && rm -rf /var/cache/apk/*\n\nCOPY --from=build-env /data/main /home/main\n\nRUN ls -alh /home/main && /home/main help\n\nENTRYPOINT [\"/home/main\",\"run\"]\n"},"repairedBuild":{"startTimestamp":1672211366676,"endTimestamp":1672211469448,"error":null,"stdout":"Sending build context to Docker daemon  4.722MB\r\r\nStep 1/20 : FROM haozibi/upx AS build-upx\n ---> ed52ceea825b\nStep 2/20 : FROM golang:1.18.5-alpine3.16 AS build-env\n ---> bacc2f10e6e1\nStep 3/20 : RUN apk --no-cache add build-base git libseccomp\n ---> Running in e2fdf3c2ea1a\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.16/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.16/community/x86_64/APKINDEX.tar.gz\n(1/27) Upgrading musl (1.2.3-r0 -> 1.2.3-r2)\n(2/27) Installing libgcc (11.2.1_git20220219-r2)\n(3/27) Installing libstdc++ (11.2.1_git20220219-r2)\n(4/27) Installing binutils (2.38-r3)\n(5/27) Installing libmagic (5.41-r0)\n(6/27) Installing file (5.41-r0)\n(7/27) Installing libgomp (11.2.1_git20220219-r2)\n(8/27) Installing libatomic (11.2.1_git20220219-r2)\n(9/27) Installing gmp (6.2.1-r2)\n(10/27) Installing isl22 (0.22-r0)\n(11/27) Installing mpfr4 (4.1.0-r0)\n(12/27) Installing mpc1 (1.2.1-r0)\n(13/27) Installing gcc (11.2.1_git20220219-r2)\n(14/27) Installing musl-dev (1.2.3-r2)\n(15/27) Installing libc-dev (0.7.2-r3)\n(16/27) Installing g++ (11.2.1_git20220219-r2)\n(17/27) Installing make (4.3-r0)\n(18/27) Installing fortify-headers (1.1-r1)\n(19/27) Installing patch (2.7.6-r7)\n(20/27) Installing build-base (0.5-r3)\n(21/27) Installing brotli-libs (1.0.9-r6)\n(22/27) Installing nghttp2-libs (1.47.0-r0)\n(23/27) Installing libcurl (7.83.1-r5)\n(24/27) Installing expat (2.5.0-r0)\n(25/27) Installing pcre2 (10.40-r0)\n(26/27) Installing git (2.36.3-r0)\n(27/27) Installing libseccomp (2.5.2-r1)\nExecuting busybox-1.35.0-r17.trigger\nOK: 200 MiB in 41 packages\nRemoving intermediate container e2fdf3c2ea1a\n ---> 452bce269e4e\nStep 4/20 : ARG BIN_NAME=leetcode-badge\n ---> Running in dbef5c9a4846\nRemoving intermediate container dbef5c9a4846\n ---> bae631e35e71\nStep 5/20 : WORKDIR /${BIN_NAME}\n ---> Running in 2b751522cf9b\nRemoving intermediate container 2b751522cf9b\n ---> 94cc3bd92f6d\nStep 6/20 : ADD go.mod .\n ---> 0971d9edf1e1\nStep 7/20 : ADD go.sum .\n ---> a4993cbc3942\nStep 8/20 : RUN go env -w GO111MODULE=on && go mod download\n ---> Running in 3c086f1a143a\nRemoving intermediate container 3c086f1a143a\n ---> 97db378e9d9b\nStep 9/20 : ADD . .\n ---> 8c97dc0060e2\nStep 10/20 : RUN scmp_sys_resolver faccessat2\n ---> Running in c17e7aadc81e\n439\nRemoving intermediate container c17e7aadc81e\n ---> 5ff80c06b6e2\nStep 11/20 : RUN make build-linux\n ---> Running in f3c8e0133f1e\nGood format\nCGO_ENABLED=1 GOOS=linux GOARCH=amd64 go build \"-v\" -ldflags '-X \"github.com/haozibi/leetcode-badge/app.BuildTime=2022-12-28 07:10:50 UTC\" -X \"github.com/haozibi/leetcode-badge/app.BuildVersion=v0.6.5\" -X \"github.com/haozibi/leetcode-badge/app.BuildAppName=leetcode-badge\" -X \"github.com/haozibi/leetcode-badge/app.CommitHash=c1e0ed8\"' -tags '\"\"' -o bin/leetcode-badge\n\u001b[91mgithub.com/haozibi/leetcode-badge\n\u001b[0mRemoving intermediate container f3c8e0133f1e\n ---> 5cd29f173f06\nStep 12/20 : WORKDIR /data\n ---> Running in 3641e209d398\nRemoving intermediate container 3641e209d398\n ---> 59fec6fe4895\nStep 13/20 : COPY --from=build-upx /bin/upx /bin/upx\n ---> 752930ef7363\nStep 14/20 : RUN cp /${BIN_NAME}/bin/${BIN_NAME} /data/main\n ---> Running in 3260367ff13d\nRemoving intermediate container 3260367ff13d\n ---> 5ff1c50fe8e4\nStep 15/20 : FROM alpine:3.16\n ---> bfe296a52501\nStep 16/20 : RUN apk update && apk add --no-cache tzdata libseccomp     && ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime     && echo \"Asia/Shanghai\" > /etc/timezone\n ---> Running in 646eca4607fe\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.16/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.16/community/x86_64/APKINDEX.tar.gz\nv3.16.3-91-gd0e167f17b [https://dl-cdn.alpinelinux.org/alpine/v3.16/main]\nv3.16.3-88-gef347edb61 [https://dl-cdn.alpinelinux.org/alpine/v3.16/community]\nOK: 17039 distinct packages available\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.16/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.16/community/x86_64/APKINDEX.tar.gz\n(1/2) Installing libseccomp (2.5.2-r1)\n(2/2) Installing tzdata (2022f-r1)\nExecuting busybox-1.35.0-r17.trigger\nOK: 9 MiB in 16 packages\nRemoving intermediate container 646eca4607fe\n ---> 116a2abf63d8\nStep 17/20 : RUN apk add --no-cache --update ca-certificates && rm -rf /var/cache/apk/*\n ---> Running in bf3214a0850d\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.16/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.16/community/x86_64/APKINDEX.tar.gz\n(1/1) Installing ca-certificates (20220614-r0)\nExecuting busybox-1.35.0-r17.trigger\nExecuting ca-certificates-20220614-r0.trigger\nOK: 10 MiB in 17 packages\nRemoving intermediate container bf3214a0850d\n ---> f617e7ce0ecc\nStep 18/20 : COPY --from=build-env /data/main /home/main\n ---> 0ab92819309e\nStep 19/20 : RUN ls -alh /home/main && /home/main help\n ---> Running in 9a6ffa917b32\n-rwxr-xr-x    1 root     root       17.3M Dec 28 15:10 /home/main\nLeetCode Badge CLI\n\nUsage:\n  leetcode-badge [command]\n\nAvailable Commands:\n  completion  Generate the autocompletion script for the specified shell\n  help        Help about any command\n  run         Run Web\n  version     Show version\n\nFlags:\n  -h, --help   help for leetcode-badge\n\nUse \"leetcode-badge [command] --help\" for more information about a command.\nRemoving intermediate container 9a6ffa917b32\n ---> 6e2d550c34c6\nStep 20/20 : ENTRYPOINT [\"/home/main\",\"run\"]\n ---> Running in 34a2a40adaaf\nRemoving intermediate container 34a2a40adaaf\n ---> a91c17f43681\nSuccessfully built a91c17f43681\nSuccessfully tagged leetcode-badge:latest\n","stderr":"","imageSize":28109679},"endTime":1672211470516}