{"repository":"https://github.com/go-kratos/kratos-layout","dockerfilePath":"Dockerfile","startTime":1672167383216,"clone":{"stdout":"","stderr":"Cloning into '/tmp/dinghy-analysis/go-kratos/kratos-layout'...\n","error":null,"commit":"783d0debf0944536c1f5d31dc20710a0d584513e"},"originalBuild":{"startTimestamp":1672167384077,"endTimestamp":1672167547977,"error":null,"stdout":"Sending build context to Docker daemon  570.4kB\r\r\nStep 1/12 : FROM golang:1.16 AS builder\n1.16: Pulling from library/golang\ne4d61adff207: Already exists\n4ff1945c672b: Already exists\nff5b10aec998: Already exists\n12de8c754e45: Already exists\n8c86ff77a317: Pulling fs layer\n0395a1c478ba: Pulling fs layer\n245345d44ed8: Pulling fs layer\n245345d44ed8: Verifying Checksum\n245345d44ed8: Download complete\n8c86ff77a317: Verifying Checksum\n8c86ff77a317: Download complete\n0395a1c478ba: Verifying Checksum\n0395a1c478ba: Download complete\n8c86ff77a317: Pull complete\n0395a1c478ba: Pull complete\n245345d44ed8: Pull complete\nDigest: sha256:5f6a4662de3efc6d6bb812d02e9de3d8698eea16b8eb7281f03e6f3e8383018e\nStatus: Downloaded newer image for golang:1.16\n ---> 972d8c0bc0fc\nStep 2/12 : COPY . /src\n ---> 8665f473dc16\nStep 3/12 : WORKDIR /src\n ---> Running in f6f4e66a9d6b\nRemoving intermediate container f6f4e66a9d6b\n ---> 1f9bb5e8227b\nStep 4/12 : RUN GOPROXY=https://goproxy.cn make build\n ---> Running in c9874dcb7537\nmkdir -p bin/ && go build -ldflags \"-X main.Version=783d0de\" -o ./bin/ ./...\n\u001b[91mgo: downloading github.com/google/wire v0.5.0\n\u001b[0m\u001b[91mgo: downloading github.com/go-kratos/kratos/v2 v2.4.1\n\u001b[0m\u001b[91mgo: downloading google.golang.org/protobuf v1.28.0\n\u001b[0m\u001b[91mgo: downloading google.golang.org/genproto v0.0.0-20220524023933-508584e28198\n\u001b[0m\u001b[91mgo: downloading google.golang.org/grpc v1.46.2\n\u001b[0m\u001b[91mgo: downloading go.uber.org/automaxprocs v1.5.1\n\u001b[0m\u001b[91mgo: downloading github.com/golang/protobuf v1.5.2\n\u001b[0m\u001b[91mgo: downloading golang.org/x/net v0.0.0-20220520000938-2e3eb7b945c2\n\u001b[0m\u001b[91mgo: downloading golang.org/x/sys v0.0.0-20220520151302-bc2c85ada10a\n\u001b[0m\u001b[91mgo: downloading golang.org/x/text v0.3.7\n\u001b[0m\u001b[91mgo: downloading github.com/imdario/mergo v0.3.12\n\u001b[0m\u001b[91mgo: downloading github.com/fsnotify/fsnotify v1.5.4\n\u001b[0m\u001b[91mgo: downloading github.com/go-playground/form/v4 v4.2.0\ngo: downloading gopkg.in/yaml.v3 v3.0.0\n\u001b[0m\u001b[91mgo: downloading go.opentelemetry.io/otel v1.7.0\n\u001b[0m\u001b[91mgo: downloading github.com/google/uuid v1.3.0\n\u001b[0m\u001b[91mgo: downloading golang.org/x/sync v0.0.0-20220513210516-0976fa681c29\n\u001b[0m\u001b[91mgo: downloading github.com/gorilla/mux v1.8.0\n\u001b[0m\u001b[91mgo: downloading go.opentelemetry.io/otel/trace v1.7.0\n\u001b[0m\u001b[91mgo: downloading github.com/go-logr/logr v1.2.3\n\u001b[0m\u001b[91mgo: downloading github.com/go-logr/stdr v1.2.2\n\u001b[0mRemoving intermediate container c9874dcb7537\n ---> ee4d7a7ae758\nStep 5/12 : FROM debian:stable-slim\nstable-slim: Pulling from library/debian\n5ddaeea5da8b: Pulling fs layer\n5ddaeea5da8b: Verifying Checksum\n5ddaeea5da8b: Download complete\n5ddaeea5da8b: Pull complete\nDigest: sha256:cccd5ce5805bc1023b12823f0a26e90c4377ed7790512f8a594ac6712c60caac\nStatus: Downloaded newer image for debian:stable-slim\n ---> c722f32959f0\nStep 6/12 : RUN apt-get update && apt-get install -y --no-install-recommends \t\tca-certificates          netbase         && rm -rf /var/lib/apt/lists/         && apt-get autoremove -y && apt-get autoclean -y\n ---> Running in 4f8a62aa75dc\nGet:1 http://deb.debian.org/debian stable InRelease [116 kB]\nGet:2 http://deb.debian.org/debian-security stable-security InRelease [48.4 kB]\nGet:3 http://deb.debian.org/debian stable-updates InRelease [44.1 kB]\nGet:4 http://deb.debian.org/debian stable/main amd64 Packages [8183 kB]\nGet:5 http://deb.debian.org/debian-security stable-security/main amd64 Packages [210 kB]\nGet:6 http://deb.debian.org/debian stable-updates/main amd64 Packages [14.6 kB]\nFetched 8616 kB in 1s (6645 kB/s)\nReading package lists...\nReading package lists...\nBuilding dependency tree...\nReading state information...\nThe following additional packages will be installed:\n  openssl\nThe following NEW packages will be installed:\n  ca-certificates netbase openssl\n0 upgraded, 3 newly installed, 0 to remove and 0 not upgraded.\nNeed to get 1031 kB of archives.\nAfter this operation, 1934 kB of additional disk space will be used.\nGet:1 http://deb.debian.org/debian stable/main amd64 netbase all 6.3 [19.9 kB]\nGet:2 http://deb.debian.org/debian stable/main amd64 openssl amd64 1.1.1n-0+deb11u3 [853 kB]\nGet:3 http://deb.debian.org/debian stable/main amd64 ca-certificates all 20210119 [158 kB]\n\u001b[91mdebconf: delaying package configuration, since apt-utils is not installed\n\u001b[0mFetched 1031 kB in 0s (14.4 MB/s)\nSelecting previously unselected package netbase.\r\n(Reading database ... \r(Reading database ... 5%\r(Reading database ... 10%\r(Reading database ... 15%\r(Reading database ... 20%\r(Reading database ... 25%\r(Reading database ... 30%\r(Reading database ... 35%\r(Reading database ... 40%\r(Reading database ... 45%\r(Reading database ... 50%\r(Reading database ... 55%\r(Reading database ... 60%\r(Reading database ... 65%\r(Reading database ... 70%\r(Reading database ... 75%\r(Reading database ... 80%\r(Reading database ... 85%\r(Reading database ... 90%\r(Reading database ... 95%\r(Reading database ... 100%\r(Reading database ... 6661 files and directories currently installed.)\r\nPreparing to unpack .../archives/netbase_6.3_all.deb ...\r\nUnpacking netbase (6.3) ...\r\nSelecting previously unselected package openssl.\r\nPreparing to unpack .../openssl_1.1.1n-0+deb11u3_amd64.deb ...\r\nUnpacking openssl (1.1.1n-0+deb11u3) ...\r\nSelecting previously unselected package ca-certificates.\r\nPreparing to unpack .../ca-certificates_20210119_all.deb ...\r\nUnpacking ca-certificates (20210119) ...\r\nSetting up netbase (6.3) ...\r\nSetting up openssl (1.1.1n-0+deb11u3) ...\r\nSetting up ca-certificates (20210119) ...\r\ndebconf: unable to initialize frontend: Dialog\r\ndebconf: (TERM is not set, so the dialog frontend is not usable.)\r\ndebconf: falling back to frontend: Readline\r\ndebconf: unable to initialize frontend: Readline\r\ndebconf: (Can't locate Term/ReadLine.pm in @INC (you may need to install the Term::ReadLine module) (@INC contains: /etc/perl /usr/local/lib/x86_64-linux-gnu/perl/5.32.1 /usr/local/share/perl/5.32.1 /usr/lib/x86_64-linux-gnu/perl5/5.32 /usr/share/perl5 /usr/lib/x86_64-linux-gnu/perl-base /usr/lib/x86_64-linux-gnu/perl/5.32 /usr/share/perl/5.32 /usr/local/lib/site_perl) at /usr/share/perl5/Debconf/FrontEnd/Readline.pm line 7.)\r\ndebconf: falling back to frontend: Teletype\r\nUpdating certificates in /etc/ssl/certs...\r\n129 added, 0 removed; done.\r\nProcessing triggers for ca-certificates (20210119) ...\r\nUpdating certificates in /etc/ssl/certs...\r\n0 added, 0 removed; done.\r\nRunning hooks in /etc/ca-certificates/update.d...\r\ndone.\r\nReading package lists...\nBuilding dependency tree...\nReading state information...\n0 upgraded, 0 newly installed, 0 to remove and 0 not upgraded.\nReading package lists...\nBuilding dependency tree...\nReading state information...\nRemoving intermediate container 4f8a62aa75dc\n ---> f610f7d83ee1\nStep 7/12 : COPY --from=builder /src/bin /app\n ---> 0cedd6318d8a\nStep 8/12 : WORKDIR /app\n ---> Running in 0e841842b4d3\nRemoving intermediate container 0e841842b4d3\n ---> 0b8cccc721bd\nStep 9/12 : EXPOSE 8000\n ---> Running in 96ebe995460d\nRemoving intermediate container 96ebe995460d\n ---> 21b3ae7eb124\nStep 10/12 : EXPOSE 9000\n ---> Running in 78cfbb6c3acd\nRemoving intermediate container 78cfbb6c3acd\n ---> 087de224940c\nStep 11/12 : VOLUME /data/conf\n ---> Running in 780f02fe534c\nRemoving intermediate container 780f02fe534c\n ---> 5494462d0d06\nStep 12/12 : CMD [\"./server\", \"-conf\", \"/data/conf\"]\n ---> Running in c0ddf5c11a86\nRemoving intermediate container c0ddf5c11a86\n ---> 72bf6480b3d3\nSuccessfully built 72bf6480b3d3\nSuccessfully tagged kratos-layout:latest\n","stderr":"","imageSize":100438725},"repair":{"violations":[{"name":"ruleAptGetInstallThenRemoveAptLists","position":{"start":9,"end":11,"columnStart":22,"columnEnd":15}}],"repairedDockerfile":"FROM golang:1.16 AS builder\n\nCOPY . /src\nWORKDIR /src\n\nRUN GOPROXY=https://goproxy.cn make build\n\nFROM debian:stable-slim\n\nRUN apt-get update && apt-get install -y --no-install-recommends \\\n\t\tca-certificates  \\\n        netbase \\\n        && rm -rf /var/lib/apt/lists/ \\\n        && apt-get autoremove -y && apt-get autoclean -y\n\nCOPY --from=builder /src/bin /app\n\nWORKDIR /app\n\nEXPOSE 8000\nEXPOSE 9000\nVOLUME /data/conf\n\nCMD [\"./server\", \"-conf\", \"/data/conf\"]\n"},"repairedBuild":{"startTimestamp":1672167548331,"endTimestamp":1672167618760,"error":null,"stdout":"Sending build context to Docker daemon  570.4kB\r\r\nStep 1/12 : FROM golang:1.16 AS builder\n ---> 972d8c0bc0fc\nStep 2/12 : COPY . /src\n ---> f538e2b53915\nStep 3/12 : WORKDIR /src\n ---> Running in aa5b104b7707\nRemoving intermediate container aa5b104b7707\n ---> a97484074298\nStep 4/12 : RUN GOPROXY=https://goproxy.cn make build\n ---> Running in c2b5167cef4c\nmkdir -p bin/ && go build -ldflags \"-X main.Version=783d0de\" -o ./bin/ ./...\n\u001b[91mgo: downloading github.com/go-kratos/kratos/v2 v2.4.1\n\u001b[0m\u001b[91mgo: downloading github.com/google/wire v0.5.0\n\u001b[0m\u001b[91mgo: downloading google.golang.org/grpc v1.46.2\ngo: downloading google.golang.org/protobuf v1.28.0\ngo: downloading google.golang.org/genproto v0.0.0-20220524023933-508584e28198\n\u001b[0m\u001b[91mgo: downloading go.uber.org/automaxprocs v1.5.1\n\u001b[0m\u001b[91mgo: downloading github.com/fsnotify/fsnotify v1.5.4\n\u001b[0m\u001b[91mgo: downloading github.com/gorilla/mux v1.8.0\n\u001b[0m\u001b[91mgo: downloading github.com/imdario/mergo v0.3.12\n\u001b[0m\u001b[91mgo: downloading github.com/go-playground/form/v4 v4.2.0\n\u001b[0m\u001b[91mgo: downloading github.com/google/uuid v1.3.0\n\u001b[0m\u001b[91mgo: downloading golang.org/x/sync v0.0.0-20220513210516-0976fa681c29\n\u001b[0m\u001b[91mgo: downloading gopkg.in/yaml.v3 v3.0.0\n\u001b[0m\u001b[91mgo: downloading go.opentelemetry.io/otel v1.7.0\n\u001b[0m\u001b[91mgo: downloading golang.org/x/sys v0.0.0-20220520151302-bc2c85ada10a\n\u001b[0m\u001b[91mgo: downloading github.com/golang/protobuf v1.5.2\n\u001b[0m\u001b[91mgo: downloading golang.org/x/net v0.0.0-20220520000938-2e3eb7b945c2\n\u001b[0m\u001b[91mgo: downloading go.opentelemetry.io/otel/trace v1.7.0\n\u001b[0m\u001b[91mgo: downloading github.com/go-logr/logr v1.2.3\n\u001b[0m\u001b[91mgo: downloading github.com/go-logr/stdr v1.2.2\n\u001b[0m\u001b[91mgo: downloading golang.org/x/text v0.3.7\n\u001b[0mRemoving intermediate container c2b5167cef4c\n ---> c5b83c6b9a99\nStep 5/12 : FROM debian:stable-slim\n ---> c722f32959f0\nStep 6/12 : RUN apt-get update && apt-get install -y --no-install-recommends \t\tca-certificates          netbase         && rm -rf /var/lib/apt/lists/         && apt-get autoremove -y && apt-get autoclean -y\n ---> Running in 86967062f385\nGet:1 http://deb.debian.org/debian stable InRelease [116 kB]\nGet:2 http://deb.debian.org/debian-security stable-security InRelease [48.4 kB]\nGet:3 http://deb.debian.org/debian stable-updates InRelease [44.1 kB]\nGet:4 http://deb.debian.org/debian stable/main amd64 Packages [8183 kB]\nGet:5 http://deb.debian.org/debian-security stable-security/main amd64 Packages [210 kB]\nGet:6 http://deb.debian.org/debian stable-updates/main amd64 Packages [14.6 kB]\nFetched 8616 kB in 1s (7057 kB/s)\nReading package lists...\nReading package lists...\nBuilding dependency tree...\nReading state information...\nThe following additional packages will be installed:\n  openssl\nThe following NEW packages will be installed:\n  ca-certificates netbase openssl\n0 upgraded, 3 newly installed, 0 to remove and 0 not upgraded.\nNeed to get 1031 kB of archives.\nAfter this operation, 1934 kB of additional disk space will be used.\nGet:1 http://deb.debian.org/debian stable/main amd64 netbase all 6.3 [19.9 kB]\nGet:2 http://deb.debian.org/debian stable/main amd64 openssl amd64 1.1.1n-0+deb11u3 [853 kB]\nGet:3 http://deb.debian.org/debian stable/main amd64 ca-certificates all 20210119 [158 kB]\n\u001b[91mdebconf: delaying package configuration, since apt-utils is not installed\n\u001b[0mFetched 1031 kB in 0s (26.1 MB/s)\nSelecting previously unselected package netbase.\r\n(Reading database ... \r(Reading database ... 5%\r(Reading database ... 10%\r(Reading database ... 15%\r(Reading database ... 20%\r(Reading database ... 25%\r(Reading database ... 30%\r(Reading database ... 35%\r(Reading database ... 40%\r(Reading database ... 45%\r(Reading database ... 50%\r(Reading database ... 55%\r(Reading database ... 60%\r(Reading database ... 65%\r(Reading database ... 70%\r(Reading database ... 75%\r(Reading database ... 80%\r(Reading database ... 85%\r(Reading database ... 90%\r(Reading database ... 95%\r(Reading database ... 100%\r(Reading database ... 6661 files and directories currently installed.)\r\nPreparing to unpack .../archives/netbase_6.3_all.deb ...\r\nUnpacking netbase (6.3) ...\r\nSelecting previously unselected package openssl.\r\nPreparing to unpack .../openssl_1.1.1n-0+deb11u3_amd64.deb ...\r\nUnpacking openssl (1.1.1n-0+deb11u3) ...\r\nSelecting previously unselected package ca-certificates.\r\nPreparing to unpack .../ca-certificates_20210119_all.deb ...\r\nUnpacking ca-certificates (20210119) ...\r\nSetting up netbase (6.3) ...\r\nSetting up openssl (1.1.1n-0+deb11u3) ...\r\nSetting up ca-certificates (20210119) ...\r\ndebconf: unable to initialize frontend: Dialog\r\ndebconf: (TERM is not set, so the dialog frontend is not usable.)\r\ndebconf: falling back to frontend: Readline\r\ndebconf: unable to initialize frontend: Readline\r\ndebconf: (Can't locate Term/ReadLine.pm in @INC (you may need to install the Term::ReadLine module) (@INC contains: /etc/perl /usr/local/lib/x86_64-linux-gnu/perl/5.32.1 /usr/local/share/perl/5.32.1 /usr/lib/x86_64-linux-gnu/perl5/5.32 /usr/share/perl5 /usr/lib/x86_64-linux-gnu/perl-base /usr/lib/x86_64-linux-gnu/perl/5.32 /usr/share/perl/5.32 /usr/local/lib/site_perl) at /usr/share/perl5/Debconf/FrontEnd/Readline.pm line 7.)\r\ndebconf: falling back to frontend: Teletype\r\nUpdating certificates in /etc/ssl/certs...\r\n129 added, 0 removed; done.\r\nProcessing triggers for ca-certificates (20210119) ...\r\nUpdating certificates in /etc/ssl/certs...\r\n0 added, 0 removed; done.\r\nRunning hooks in /etc/ca-certificates/update.d...\r\ndone.\r\nReading package lists...\nBuilding dependency tree...\nReading state information...\n0 upgraded, 0 newly installed, 0 to remove and 0 not upgraded.\nReading package lists...\nBuilding dependency tree...\nReading state information...\nRemoving intermediate container 86967062f385\n ---> 57bf506a7b1b\nStep 7/12 : COPY --from=builder /src/bin /app\n ---> 411c5463149f\nStep 8/12 : WORKDIR /app\n ---> Running in f63f10f4daf0\nRemoving intermediate container f63f10f4daf0\n ---> 85785f1e0f9f\nStep 9/12 : EXPOSE 8000\n ---> Running in 060c84f9e91e\nRemoving intermediate container 060c84f9e91e\n ---> deaa954fa14a\nStep 10/12 : EXPOSE 9000\n ---> Running in 1de0e4d7560f\nRemoving intermediate container 1de0e4d7560f\n ---> 14454045bd23\nStep 11/12 : VOLUME /data/conf\n ---> Running in 33a0304e9c9a\nRemoving intermediate container 33a0304e9c9a\n ---> 5b92e2aa5922\nStep 12/12 : CMD [\"./server\", \"-conf\", \"/data/conf\"]\n ---> Running in 4dcb52bde049\nRemoving intermediate container 4dcb52bde049\n ---> a0c706b134e3\nSuccessfully built a0c706b134e3\nSuccessfully tagged kratos-layout:latest\n","stderr":"","imageSize":100438725},"endTime":1672167619620}