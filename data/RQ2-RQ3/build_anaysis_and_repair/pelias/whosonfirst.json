{"repository":"https://github.com/pelias/whosonfirst","dockerfilePath":"Dockerfile","startTime":1672278510734,"clone":{"stdout":"","stderr":"Cloning into '/tmp/dinghy-analysis/pelias/whosonfirst'...\n","error":null,"commit":"22f7ad76dbf65bf25f0f4a2af352ad45b72a2a94"},"originalBuild":{"startTimestamp":1672278511580,"endTimestamp":1672278615458,"error":null,"stdout":"Sending build context to Docker daemon  204.8kB\r\r\nStep 1/9 : FROM pelias/baseimage\n ---> 20d46db0f488\nStep 2/9 : RUN apt-get update && apt-get install -y bzip2 lbzip2 unzip && rm -rf /var/lib/apt/lists/*\n ---> Running in c9efc48cdd0c\nGet:1 http://security.ubuntu.com/ubuntu bionic-security InRelease [88.7 kB]\nGet:2 http://archive.ubuntu.com/ubuntu bionic InRelease [242 kB]\nGet:3 http://archive.ubuntu.com/ubuntu bionic-updates InRelease [88.7 kB]\nGet:4 http://archive.ubuntu.com/ubuntu bionic-backports InRelease [83.3 kB]\nGet:5 http://security.ubuntu.com/ubuntu bionic-security/main amd64 Packages [3,099 kB]\nGet:6 http://archive.ubuntu.com/ubuntu bionic/main amd64 Packages [1,344 kB]\nGet:7 http://archive.ubuntu.com/ubuntu bionic/universe amd64 Packages [11.3 MB]\nGet:8 http://security.ubuntu.com/ubuntu bionic-security/restricted amd64 Packages [1,311 kB]\nGet:9 http://security.ubuntu.com/ubuntu bionic-security/universe amd64 Packages [1,568 kB]\nGet:10 http://security.ubuntu.com/ubuntu bionic-security/multiverse amd64 Packages [22.9 kB]\nGet:11 http://archive.ubuntu.com/ubuntu bionic/restricted amd64 Packages [13.5 kB]\nGet:12 http://archive.ubuntu.com/ubuntu bionic/multiverse amd64 Packages [186 kB]\nGet:13 http://archive.ubuntu.com/ubuntu bionic-updates/multiverse amd64 Packages [30.0 kB]\nGet:14 http://archive.ubuntu.com/ubuntu bionic-updates/main amd64 Packages [3,524 kB]\nGet:15 http://archive.ubuntu.com/ubuntu bionic-updates/restricted amd64 Packages [1,352 kB]\nGet:16 http://archive.ubuntu.com/ubuntu bionic-updates/universe amd64 Packages [2,342 kB]\nGet:17 http://archive.ubuntu.com/ubuntu bionic-backports/main amd64 Packages [64.0 kB]\nGet:18 http://archive.ubuntu.com/ubuntu bionic-backports/universe amd64 Packages [20.5 kB]\nFetched 26.7 MB in 6s (4,458 kB/s)\nReading package lists...\nReading package lists...\nBuilding dependency tree...\nReading state information...\nbzip2 is already the newest version (1.0.6-8.1ubuntu0.2).\nSuggested packages:\n  zip\nThe following NEW packages will be installed:\n  lbzip2 unzip\n0 upgraded, 2 newly installed, 0 to remove and 55 not upgraded.\nNeed to get 232 kB of archives.\nAfter this operation, 730 kB of additional disk space will be used.\nGet:1 http://archive.ubuntu.com/ubuntu bionic-updates/main amd64 unzip amd64 6.0-21ubuntu1.2 [168 kB]\nGet:2 http://archive.ubuntu.com/ubuntu bionic/universe amd64 lbzip2 amd64 2.5-2 [63.7 kB]\nFetched 232 kB in 0s (1,143 kB/s)\nSelecting previously unselected package unzip.\r\n(Reading database ... \r(Reading database ... 5%\r(Reading database ... 10%\r(Reading database ... 15%\r(Reading database ... 20%\r(Reading database ... 25%\r(Reading database ... 30%\r(Reading database ... 35%\r(Reading database ... 40%\r(Reading database ... 45%\r(Reading database ... 50%\r(Reading database ... 55%\r(Reading database ... 60%\r(Reading database ... 65%\r(Reading database ... 70%\r(Reading database ... 75%\r(Reading database ... 80%\r(Reading database ... 85%\r(Reading database ... 90%\r(Reading database ... 95%\r(Reading database ... 100%\r(Reading database ... 8575 files and directories currently installed.)\r\nPreparing to unpack .../unzip_6.0-21ubuntu1.2_amd64.deb ...\r\nUnpacking unzip (6.0-21ubuntu1.2) ...\r\nSelecting previously unselected package lbzip2.\r\nPreparing to unpack .../lbzip2_2.5-2_amd64.deb ...\r\nUnpacking lbzip2 (2.5-2) ...\r\nSetting up unzip (6.0-21ubuntu1.2) ...\r\nSetting up lbzip2 (2.5-2) ...\r\nRemoving intermediate container c9efc48cdd0c\n ---> e82fc210550f\nStep 3/9 : ENV WORKDIR /code/pelias/whosonfirst\n ---> Running in f86fe80f51c5\nRemoving intermediate container f86fe80f51c5\n ---> 3152dbef488c\nStep 4/9 : WORKDIR ${WORKDIR}\n ---> Running in 47e6ec673999\nRemoving intermediate container 47e6ec673999\n ---> 142805adfb94\nStep 5/9 : COPY ./package.json ${WORKDIR}\n ---> b6071c050567\nStep 6/9 : RUN npm install\n ---> Running in 5781e3daea9d\n\u001b[91mnpm WARN deprecated\u001b[0m\u001b[91m @hapi/topo@3.1.6: This version has been deprecated and is no longer supported or maintained\n\u001b[0m\u001b[91mnpm WARN deprecated @hapi/formula@1.2.0: Moved to 'npm install @sideway/formula'\n\u001b[0m\u001b[91mnpm WARN deprecated @hapi/address@2.1.4: Moved to 'npm install @sideway/address'\n\u001b[0m\u001b[91mnpm WARN deprecated @hapi/pinpoint@1.0.2: Moved to 'npm install @sideway/pinpoint'\n\u001b[0m\u001b[91mnpm WARN deprecated @hapi/hoek@8.5.1: This version has been deprecated and is no longer supported or maintained\n\u001b[0m\u001b[91mnpm WARN deprecated @hapi/joi@16.1.8: Switch to 'npm install joi'\n\u001b[0m\u001b[91mnpm WARN deprecated elasticsearch@16.7.3: Package no longer supported. Contact Support at https://www.npmjs.com/support for more info.\n\u001b[0m\nadded 225 packages, and audited 226 packages in 28s\n\n67 packages are looking for funding\n  run `npm fund` for details\n\n3 high severity vulnerabilities\n\nTo address all issues (including breaking changes), run:\n  npm audit fix --force\n\nRun `npm audit` for details.\n\u001b[91mnpm notice\u001b[0m\u001b[91m \nnpm \u001b[0m\u001b[91mnotice\u001b[0m\u001b[91m New major version of npm available! 8.1.2 -> 9.2.0\nnpm notice Changelog: <https://github.com/npm/cli/releases/tag/v9.2.0>\nnpm\u001b[0m\u001b[91m notice\u001b[0m\u001b[91m Run `npm install -g npm@9.2.0` to update!\nnpm notice \n\u001b[0mRemoving intermediate container 5781e3daea9d\n ---> 1cc60a8eae81\nStep 7/9 : ADD . ${WORKDIR}\n ---> adbc2c064548\nStep 8/9 : RUN npm test\n ---> Running in 121ccc08f144\n\n> pelias-whosonfirst@0.0.0-development test\n> ./bin/units\n\n\n  ..........................................................................................................................\u001b[91m2022-12-29T01:50:05.922Z - \u001b[31merror\u001b[39m: [whosonfirst] doc generator error: invalid regex test, http://urls_not_allowed_here should not match /https?:\\/\\//\n\u001b[0m\u001b[91m2022-12-29T01:50:05.923Z - \u001b[31merror\u001b[39m: [whosonfirst] {\n  \"id\": 1,\n  \"name\": \"http://urls_not_allowed_here\",\n  \"place_type\": \"country\"\n}\n\u001b[0m................................................................................  \n\n  159 tests\n  202 passed\n  \n  Pass!\nRemoving intermediate container 121ccc08f144\n ---> 93cf3535e085\nStep 9/9 : USER pelias\n ---> Running in 160674b6a270\nRemoving intermediate container 160674b6a270\n ---> 61870911b433\nSuccessfully built 61870911b433\nSuccessfully tagged whosonfirst:latest\n","stderr":"","imageSize":306557079},"repair":{"violations":[{"name":"npmCacheCleanAfterInstall","position":{"start":13,"end":13,"columnStart":4,"columnEnd":15}},{"name":"ruleAptGetInstallUseNoRec","position":{"start":5,"end":5,"columnStart":22,"columnEnd":59}}],"repairedDockerfile":"# base image\nFROM pelias/baseimage\n\n# downloader apt dependencies\n# note: this is done in one command in order to keep down the size of intermediate containers\nRUN apt-get update && apt-get install --no-install-recommends -y bzip2 lbzip2 unzip && rm -rf /var/lib/apt/lists/*\n\n# change working dir\nENV WORKDIR /code/pelias/whosonfirst\nWORKDIR ${WORKDIR}\n\n# copy package.json first to prevent npm install being rerun when only code changes\nCOPY ./package.json ${WORKDIR}\nRUN npm install\n\n# add code from local checkout\nADD . ${WORKDIR}\n\n# run tests\nRUN npm test\n\n# run as the pelias user\nUSER pelias\n"},"repairedBuild":{"startTimestamp":1672278616021,"endTimestamp":1672278738953,"error":null,"stdout":"Sending build context to Docker daemon  204.8kB\r\r\nStep 1/9 : FROM pelias/baseimage\n ---> 20d46db0f488\nStep 2/9 : RUN apt-get update && apt-get install --no-install-recommends -y bzip2 lbzip2 unzip && rm -rf /var/lib/apt/lists/*\n ---> Running in 4a19046911e2\nGet:1 http://security.ubuntu.com/ubuntu bionic-security InRelease [88.7 kB]\nGet:2 http://archive.ubuntu.com/ubuntu bionic InRelease [242 kB]\nGet:3 http://archive.ubuntu.com/ubuntu bionic-updates InRelease [88.7 kB]\nGet:4 http://security.ubuntu.com/ubuntu bionic-security/multiverse amd64 Packages [22.9 kB]\nGet:5 http://archive.ubuntu.com/ubuntu bionic-backports InRelease [83.3 kB]\nGet:6 http://security.ubuntu.com/ubuntu bionic-security/main amd64 Packages [3,099 kB]\nGet:7 http://archive.ubuntu.com/ubuntu bionic/restricted amd64 Packages [13.5 kB]\nGet:8 http://archive.ubuntu.com/ubuntu bionic/main amd64 Packages [1,344 kB]\nGet:9 http://archive.ubuntu.com/ubuntu bionic/universe amd64 Packages [11.3 MB]\nGet:10 http://security.ubuntu.com/ubuntu bionic-security/universe amd64 Packages [1,568 kB]\nGet:11 http://security.ubuntu.com/ubuntu bionic-security/restricted amd64 Packages [1,311 kB]\nGet:12 http://archive.ubuntu.com/ubuntu bionic/multiverse amd64 Packages [186 kB]\nGet:13 http://archive.ubuntu.com/ubuntu bionic-updates/multiverse amd64 Packages [30.0 kB]\nGet:14 http://archive.ubuntu.com/ubuntu bionic-updates/main amd64 Packages [3,524 kB]\nGet:15 http://archive.ubuntu.com/ubuntu bionic-updates/restricted amd64 Packages [1,352 kB]\nGet:16 http://archive.ubuntu.com/ubuntu bionic-updates/universe amd64 Packages [2,342 kB]\nGet:17 http://archive.ubuntu.com/ubuntu bionic-backports/universe amd64 Packages [20.5 kB]\nGet:18 http://archive.ubuntu.com/ubuntu bionic-backports/main amd64 Packages [64.0 kB]\nFetched 26.7 MB in 5s (5,621 kB/s)\nReading package lists...\nReading package lists...\nBuilding dependency tree...\nReading state information...\nbzip2 is already the newest version (1.0.6-8.1ubuntu0.2).\nSuggested packages:\n  zip\nThe following NEW packages will be installed:\n  lbzip2 unzip\n0 upgraded, 2 newly installed, 0 to remove and 55 not upgraded.\nNeed to get 232 kB of archives.\nAfter this operation, 730 kB of additional disk space will be used.\nGet:1 http://archive.ubuntu.com/ubuntu bionic-updates/main amd64 unzip amd64 6.0-21ubuntu1.2 [168 kB]\nGet:2 http://archive.ubuntu.com/ubuntu bionic/universe amd64 lbzip2 amd64 2.5-2 [63.7 kB]\nFetched 232 kB in 1s (218 kB/s)\nSelecting previously unselected package unzip.\r\n(Reading database ... \r(Reading database ... 5%\r(Reading database ... 10%\r(Reading database ... 15%\r(Reading database ... 20%\r(Reading database ... 25%\r(Reading database ... 30%\r(Reading database ... 35%\r(Reading database ... 40%\r(Reading database ... 45%\r(Reading database ... 50%\r(Reading database ... 55%\r(Reading database ... 60%\r(Reading database ... 65%\r(Reading database ... 70%\r(Reading database ... 75%\r(Reading database ... 80%\r(Reading database ... 85%\r(Reading database ... 90%\r(Reading database ... 95%\r(Reading database ... 100%\r(Reading database ... 8575 files and directories currently installed.)\r\nPreparing to unpack .../unzip_6.0-21ubuntu1.2_amd64.deb ...\r\nUnpacking unzip (6.0-21ubuntu1.2) ...\r\nSelecting previously unselected package lbzip2.\r\nPreparing to unpack .../lbzip2_2.5-2_amd64.deb ...\r\nUnpacking lbzip2 (2.5-2) ...\r\nSetting up unzip (6.0-21ubuntu1.2) ...\r\nSetting up lbzip2 (2.5-2) ...\r\nRemoving intermediate container 4a19046911e2\n ---> 851625166376\nStep 3/9 : ENV WORKDIR /code/pelias/whosonfirst\n ---> Running in 7f7115672631\nRemoving intermediate container 7f7115672631\n ---> 8e3592795529\nStep 4/9 : WORKDIR ${WORKDIR}\n ---> Running in 39f453fe658e\nRemoving intermediate container 39f453fe658e\n ---> dca1d462f7a0\nStep 5/9 : COPY ./package.json ${WORKDIR}\n ---> 442816634cea\nStep 6/9 : RUN npm install\n ---> Running in 1907fbc85082\n\u001b[91mnpm WARN deprecated @hapi/pinpoint@1.0.2: Moved to 'npm install @sideway/pinpoint'\n\u001b[0m\u001b[91mnpm WARN deprecated @hapi/formula@1.2.0: Moved to 'npm install @sideway/formula'\n\u001b[0m\u001b[91mnpm WARN deprecated @hapi/topo@3.1.6: This version has been deprecated and is no longer supported or maintained\n\u001b[0m\u001b[91mnpm WARN deprecated @hapi/address@2.1.4: Moved to 'npm install @sideway/address'\n\u001b[0m\u001b[91mnpm WARN deprecated @hapi/hoek@8.5.1: This version has been deprecated and is no longer supported or maintained\n\u001b[0m\u001b[91mnpm WARN deprecated @hapi/joi@16.1.8: Switch to 'npm install joi'\n\u001b[0m\u001b[91mnpm WARN deprecated elasticsearch@16.7.3: Package no longer supported. Contact Support at https://www.npmjs.com/support for more info.\n\u001b[0m\nadded 225 packages, and audited 226 packages in 14s\n\n67 packages are looking for funding\n  run `npm fund` for details\n\n3 high severity vulnerabilities\n\nTo address all issues (including breaking changes), run:\n  npm audit fix --force\n\nRun `npm audit` for details.\n\u001b[91mnpm notice \nnpm notice\u001b[0m\u001b[91m New major version of npm available! 8.1.2 -> 9.2.0\nnpm notice Changelog: <https://github.com/npm/cli/releases/tag/v9.2.0>\n\u001b[0m\u001b[91mnpm notice\u001b[0m\u001b[91m Run `npm install -g npm@9.2.0` to update!\nnpm\u001b[0m\u001b[91m notice\u001b[0m\u001b[91m \n\u001b[0mRemoving intermediate container 1907fbc85082\n ---> e6ea30ea2f7a\nStep 7/9 : ADD . ${WORKDIR}\n ---> bdd82b8a191e\nStep 8/9 : RUN npm test\n ---> Running in ef0380deef7e\n\n> pelias-whosonfirst@0.0.0-development test\n> ./bin/units\n\n\n  ..........................................................................................................................\u001b[91m2022-12-29T01:52:12.811Z - \u001b[31merror\u001b[39m: [whosonfirst] doc generator error: invalid regex test, http://urls_not_allowed_here should not match /https?:\\/\\//\n\u001b[0m\u001b[91m2022-12-29T01:52:12.812Z - \u001b[31merror\u001b[39m: [whosonfirst] {\n  \"id\": 1,\n  \"name\": \"http://urls_not_allowed_here\",\n  \"place_type\": \"country\"\n}\n\u001b[0m................................................................................  \n\n  159 tests\n  202 passed\n  \n  Pass!\nRemoving intermediate container ef0380deef7e\n ---> ad52924b5591\nStep 9/9 : USER pelias\n ---> Running in e980ee9288dc\nRemoving intermediate container e980ee9288dc\n ---> 338108abd1f9\nSuccessfully built 338108abd1f9\nSuccessfully tagged whosonfirst:latest\n","stderr":"","imageSize":306557127},"endTime":1672278739259}