{"repository":"https://github.com/pelias/geonames","dockerfilePath":"Dockerfile","startTime":1672303314327,"clone":{"stdout":"","stderr":"Cloning into '/tmp/dinghy-analysis/pelias/geonames'...\n","error":null,"commit":"26e7630d749a88ec303fecef844d13e043b467af"},"originalBuild":{"startTimestamp":1672303315310,"endTimestamp":1672303424838,"error":null,"stdout":"Sending build context to Docker daemon  1.251MB\r\r\nStep 1/12 : FROM pelias/baseimage\nlatest: Pulling from pelias/baseimage\n284055322776: Pulling fs layer\nfabdd7f2922a: Pulling fs layer\nf8540ef0f7df: Pulling fs layer\n6299b98d2899: Pulling fs layer\nb7a0afcdeee8: Pulling fs layer\na9224d0dd888: Pulling fs layer\n8cbdbe752c4e: Pulling fs layer\nb2c4749dd6b0: Pulling fs layer\n19098de62ed7: Pulling fs layer\nbda15fdc95e9: Pulling fs layer\n625428d5e357: Pulling fs layer\na30d3ceac264: Pulling fs layer\n625428d5e357: Waiting\nb2c4749dd6b0: Waiting\n19098de62ed7: Waiting\na30d3ceac264: Waiting\n6299b98d2899: Waiting\n8cbdbe752c4e: Waiting\nbda15fdc95e9: Waiting\nfabdd7f2922a: Verifying Checksum\nfabdd7f2922a: Download complete\n284055322776: Verifying Checksum\n284055322776: Download complete\n6299b98d2899: Verifying Checksum\n6299b98d2899: Download complete\nf8540ef0f7df: Verifying Checksum\nf8540ef0f7df: Download complete\nb7a0afcdeee8: Verifying Checksum\nb7a0afcdeee8: Download complete\na9224d0dd888: Verifying Checksum\na9224d0dd888: Download complete\n8cbdbe752c4e: Verifying Checksum\n8cbdbe752c4e: Download complete\nb2c4749dd6b0: Verifying Checksum\nb2c4749dd6b0: Download complete\n19098de62ed7: Verifying Checksum\n19098de62ed7: Download complete\nbda15fdc95e9: Verifying Checksum\nbda15fdc95e9: Download complete\n284055322776: Pull complete\nfabdd7f2922a: Pull complete\n625428d5e357: Verifying Checksum\n625428d5e357: Download complete\na30d3ceac264: Download complete\nf8540ef0f7df: Pull complete\n6299b98d2899: Pull complete\nb7a0afcdeee8: Pull complete\na9224d0dd888: Pull complete\n8cbdbe752c4e: Pull complete\nb2c4749dd6b0: Pull complete\n19098de62ed7: Pull complete\nbda15fdc95e9: Pull complete\n625428d5e357: Pull complete\na30d3ceac264: Pull complete\nDigest: sha256:3f8e7b2cd36fee21a33bfcd114666a65bd01ca248a3f65d710ba1f393cf803bf\nStatus: Downloaded newer image for pelias/baseimage:latest\n ---> 20d46db0f488\nStep 2/12 : RUN mkdir -p '/data/geonames'\n ---> Running in fa14bf720107\nRemoving intermediate container fa14bf720107\n ---> 1d8f2677a8bc\nStep 3/12 : RUN apt-get update && apt-get install -y bzip2 unzip && rm -rf /var/lib/apt/lists/*\n ---> Running in 1e96ce839a41\nGet:1 http://security.ubuntu.com/ubuntu bionic-security InRelease [88.7 kB]\nGet:2 http://archive.ubuntu.com/ubuntu bionic InRelease [242 kB]\nGet:3 http://security.ubuntu.com/ubuntu bionic-security/multiverse amd64 Packages [22.9 kB]\nGet:4 http://security.ubuntu.com/ubuntu bionic-security/universe amd64 Packages [1,568 kB]\nGet:5 http://security.ubuntu.com/ubuntu bionic-security/main amd64 Packages [3,099 kB]\nGet:6 http://security.ubuntu.com/ubuntu bionic-security/restricted amd64 Packages [1,311 kB]\nGet:7 http://archive.ubuntu.com/ubuntu bionic-updates InRelease [88.7 kB]\nGet:8 http://archive.ubuntu.com/ubuntu bionic-backports InRelease [83.3 kB]\nGet:9 http://archive.ubuntu.com/ubuntu bionic/main amd64 Packages [1,344 kB]\nGet:10 http://archive.ubuntu.com/ubuntu bionic/restricted amd64 Packages [13.5 kB]\nGet:11 http://archive.ubuntu.com/ubuntu bionic/multiverse amd64 Packages [186 kB]\nGet:12 http://archive.ubuntu.com/ubuntu bionic/universe amd64 Packages [11.3 MB]\nGet:13 http://archive.ubuntu.com/ubuntu bionic-updates/restricted amd64 Packages [1,352 kB]\nGet:14 http://archive.ubuntu.com/ubuntu bionic-updates/main amd64 Packages [3,524 kB]\nGet:15 http://archive.ubuntu.com/ubuntu bionic-updates/multiverse amd64 Packages [30.0 kB]\nGet:16 http://archive.ubuntu.com/ubuntu bionic-updates/universe amd64 Packages [2,342 kB]\nGet:17 http://archive.ubuntu.com/ubuntu bionic-backports/universe amd64 Packages [20.5 kB]\nGet:18 http://archive.ubuntu.com/ubuntu bionic-backports/main amd64 Packages [64.0 kB]\nFetched 26.7 MB in 3s (8,966 kB/s)\nReading package lists...\nReading package lists...\nBuilding dependency tree...\nReading state information...\nbzip2 is already the newest version (1.0.6-8.1ubuntu0.2).\nSuggested packages:\n  zip\nThe following NEW packages will be installed:\n  unzip\n0 upgraded, 1 newly installed, 0 to remove and 55 not upgraded.\nNeed to get 168 kB of archives.\nAfter this operation, 567 kB of additional disk space will be used.\nGet:1 http://archive.ubuntu.com/ubuntu bionic-updates/main amd64 unzip amd64 6.0-21ubuntu1.2 [168 kB]\nFetched 168 kB in 0s (1,048 kB/s)\nSelecting previously unselected package unzip.\r\n(Reading database ... \r(Reading database ... 5%\r(Reading database ... 10%\r(Reading database ... 15%\r(Reading database ... 20%\r(Reading database ... 25%\r(Reading database ... 30%\r(Reading database ... 35%\r(Reading database ... 40%\r(Reading database ... 45%\r(Reading database ... 50%\r(Reading database ... 55%\r(Reading database ... 60%\r(Reading database ... 65%\r(Reading database ... 70%\r(Reading database ... 75%\r(Reading database ... 80%\r(Reading database ... 85%\r(Reading database ... 90%\r(Reading database ... 95%\r(Reading database ... 100%\r(Reading database ... 8575 files and directories currently installed.)\r\nPreparing to unpack .../unzip_6.0-21ubuntu1.2_amd64.deb ...\r\nUnpacking unzip (6.0-21ubuntu1.2) ...\r\nSetting up unzip (6.0-21ubuntu1.2) ...\r\nRemoving intermediate container 1e96ce839a41\n ---> 9bafc8495dfa\nStep 4/12 : ENV WORKDIR=/code/pelias/geonames\n ---> Running in 86a6dff3550a\nRemoving intermediate container 86a6dff3550a\n ---> 4de9f91f34bb\nStep 5/12 : WORKDIR $WORKDIR\n ---> Running in d2c0d89f97a5\nRemoving intermediate container d2c0d89f97a5\n ---> fafa5694d762\nStep 6/12 : COPY ./bin/updateMetadata.js $WORKDIR/bin/updateMetadata.js\n ---> 798aab794ffb\nStep 7/12 : COPY ./lib/tasks/meta.js ./lib/tasks/metafiles.json $WORKDIR/lib/tasks/\n ---> a8101c1950b5\nStep 8/12 : COPY ./package.json ${WORKDIR}\n ---> 211868be3515\nStep 9/12 : RUN npm install\n ---> Running in 24edb785d5e9\n\u001b[91mnpm WARN EBADENGINE\u001b[0m\u001b[91m Unsupported engine {\nnpm WARN EBADENGINE   package: 'bun@0.0.10',\nnpm WARN EBADENGINE   required: { node: '~0.10.12' },\nnpm WARN\u001b[0m\u001b[91m EBADENGINE   current: { node: 'v12.22.2', npm: '8.1.2' }\nnpm WARN \u001b[0m\u001b[91mEBADENGINE }\n\u001b[0m\u001b[91mnpm WARN deprecated formidable@1.2.6: Please upgrade to latest, formidable@v2 or formidable@v3! Check these notes: https://bit.ly/2ZEqIau\n\u001b[0m\u001b[91mnpm\u001b[0m\u001b[91m WARN deprecated har-validator@5.1.5: this library is no longer supported\n\u001b[0m\u001b[91mnpm WARN deprecated uuid@3.4.0: Please upgrade  to version 7 or higher.  Older versions may use Math.random() in certain circumstances, which is known to be problematic.  See https://v8.dev/blog/math-random for details.\n\u001b[0m\u001b[91mnpm WARN deprecated stable@0.1.8: Modern JS already guarantees Array#sort() is a stable sort, so this library is deprecated. See the compatibility table on MDN: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/sort#browser_compatibility\n\u001b[0m\u001b[91mnpm WARN\u001b[0m\u001b[91m deprecated @hapi/topo@3.1.6: This version has been deprecated and is no longer supported or maintained\n\u001b[0m\u001b[91mnpm WARN deprecated @hapi/address@2.1.4: Moved to 'npm install @sideway/address'\n\u001b[0m\u001b[91mnpm WARN deprecated @hapi/pinpoint@1.0.2: Moved to 'npm install @sideway/pinpoint'\n\u001b[0m\u001b[91mnpm WARN deprecated @hapi/formula@1.2.0: Moved to 'npm install @sideway/formula'\n\u001b[0m\u001b[91mnpm WARN deprecated @hapi/hoek@8.5.1: This version has been deprecated and is no longer supported or maintained\n\u001b[0m\u001b[91mnpm WARN deprecated request@2.88.2: request has been deprecated, see https://github.com/request/request/issues/3142\n\u001b[0m\u001b[91mnpm WARN deprecated @hapi/joi@16.1.8: Switch to 'npm install joi'\n\u001b[0m\u001b[91mnpm WARN deprecated superagent@5.3.1: Please upgrade to v7.0.2+ of superagent.  We have fixed numerous issues with streams, form-data, attach(), filesystem errors not bubbling up (ENOENT on attach()), and all tests are now passing.  See the releases tab for more information at <https://github.com/visionmedia/superagent/releases>.\n\u001b[0m\u001b[91mnpm WARN deprecated elasticsearch@16.7.3: Package no longer supported. Contact Support at https://www.npmjs.com/support for more info.\n\u001b[0m\n> pelias-geonames@0.0.0-development postinstall\n> npm run download_metadata\n\n\n> pelias-geonames@0.0.0-development download_metadata\n> mkdir -p metadata && node bin/updateMetadata.js\n\n\nadded 297 packages, and audited 298 packages in 27s\n\n69 packages are looking for funding\n  run `npm fund` for details\n\n5 high severity vulnerabilities\n\nTo address issues that do not require attention, run:\n  npm audit fix\n\nTo address all issues (including breaking changes), run:\n  npm audit fix --force\n\nRun `npm audit` for details.\n\u001b[91mnpm notice \n\u001b[0m\u001b[91mnpm notice\u001b[0m\u001b[91m New major version of npm available! 8.1.2 -> 9.2.0\n\u001b[0m\u001b[91mnpm notice Changelog: <https://github.com/npm/cli/releases/tag/v9.2.0>\nnpm notice\u001b[0m\u001b[91m Run `npm install -g npm@9.2.0` to update!\nnpm\u001b[0m\u001b[91m \u001b[0m\u001b[91mnotice\u001b[0m\u001b[91m \n\u001b[0mRemoving intermediate container 24edb785d5e9\n ---> c2774730f605\nStep 10/12 : ADD . $WORKDIR\n ---> 823e5fb2f11b\nStep 11/12 : RUN npm test\n ---> Running in 8634d0260fde\n\n> pelias-geonames@0.0.0-development test\n> NODE_ENV=test npm run units\n\n\n> pelias-geonames@0.0.0-development units\n> ./bin/units\n\n\n  ..................................  \n\n  40 tests\n  34 passed\n  \n  Pass!\nRemoving intermediate container 8634d0260fde\n ---> d620756e6643\nStep 12/12 : USER pelias\n ---> Running in 02d88908c095\nRemoving intermediate container 02d88908c095\n ---> 14a76d1fa14f\nSuccessfully built 14a76d1fa14f\nSuccessfully tagged geonames:latest\n","stderr":"","imageSize":374515136},"repair":{"violations":[{"name":"npmCacheCleanAfterInstall","position":{"start":20,"end":20,"columnStart":4,"columnEnd":15}},{"name":"ruleAptGetInstallUseNoRec","position":{"start":8,"end":8,"columnStart":22,"columnEnd":52}}],"repairedDockerfile":"# base image\nFROM pelias/baseimage\n\n# ensure data dirs exists\nRUN mkdir -p '/data/geonames'\n\n# downloader apt dependencies\n# note: this is done in one command in order to keep down the size of intermediate containers\nRUN apt-get update && apt-get install --no-install-recommends -y bzip2 unzip && rm -rf /var/lib/apt/lists/*\n\n# change working dir\nENV WORKDIR=/code/pelias/geonames\nWORKDIR $WORKDIR\n\n# copy files needed to update metadata, as it's called with NPM install\nCOPY ./bin/updateMetadata.js $WORKDIR/bin/updateMetadata.js\nCOPY ./lib/tasks/meta.js ./lib/tasks/metafiles.json $WORKDIR/lib/tasks/\n\n# copy package.json first to prevent npm install being rerun when only code changes\nCOPY ./package.json ${WORKDIR}\nRUN npm install\n\n# Copy code into image\nADD . $WORKDIR\n\n# run tests\nRUN npm test\n\n# run as the pelias user\nUSER pelias\n"},"repairedBuild":{"startTimestamp":1672303425280,"endTimestamp":1672303469978,"error":null,"stdout":"Sending build context to Docker daemon  1.251MB\r\r\nStep 1/12 : FROM pelias/baseimage\n ---> 20d46db0f488\nStep 2/12 : RUN mkdir -p '/data/geonames'\n ---> Running in 05223811ebed\nRemoving intermediate container 05223811ebed\n ---> fd83e85273f6\nStep 3/12 : RUN apt-get update && apt-get install --no-install-recommends -y bzip2 unzip && rm -rf /var/lib/apt/lists/*\n ---> Running in acaa1b3d2034\nGet:1 http://archive.ubuntu.com/ubuntu bionic InRelease [242 kB]\nGet:2 http://security.ubuntu.com/ubuntu bionic-security InRelease [88.7 kB]\nGet:3 http://archive.ubuntu.com/ubuntu bionic-updates InRelease [88.7 kB]\nGet:4 http://archive.ubuntu.com/ubuntu bionic-backports InRelease [83.3 kB]\nGet:5 http://archive.ubuntu.com/ubuntu bionic/restricted amd64 Packages [13.5 kB]\nGet:6 http://archive.ubuntu.com/ubuntu bionic/main amd64 Packages [1,344 kB]\nGet:7 http://archive.ubuntu.com/ubuntu bionic/universe amd64 Packages [11.3 MB]\nGet:8 http://archive.ubuntu.com/ubuntu bionic/multiverse amd64 Packages [186 kB]\nGet:9 http://archive.ubuntu.com/ubuntu bionic-updates/universe amd64 Packages [2,342 kB]\nGet:10 http://archive.ubuntu.com/ubuntu bionic-updates/restricted amd64 Packages [1,352 kB]\nGet:11 http://archive.ubuntu.com/ubuntu bionic-updates/main amd64 Packages [3,524 kB]\nGet:12 http://archive.ubuntu.com/ubuntu bionic-updates/multiverse amd64 Packages [30.0 kB]\nGet:13 http://archive.ubuntu.com/ubuntu bionic-backports/universe amd64 Packages [20.5 kB]\nGet:14 http://archive.ubuntu.com/ubuntu bionic-backports/main amd64 Packages [64.0 kB]\nGet:15 http://security.ubuntu.com/ubuntu bionic-security/main amd64 Packages [3,099 kB]\nGet:16 http://security.ubuntu.com/ubuntu bionic-security/restricted amd64 Packages [1,311 kB]\nGet:17 http://security.ubuntu.com/ubuntu bionic-security/multiverse amd64 Packages [22.9 kB]\nGet:18 http://security.ubuntu.com/ubuntu bionic-security/universe amd64 Packages [1,568 kB]\nFetched 26.7 MB in 2s (12.2 MB/s)\nReading package lists...\nReading package lists...\nBuilding dependency tree...\nReading state information...\nbzip2 is already the newest version (1.0.6-8.1ubuntu0.2).\nSuggested packages:\n  zip\nThe following NEW packages will be installed:\n  unzip\n0 upgraded, 1 newly installed, 0 to remove and 55 not upgraded.\nNeed to get 168 kB of archives.\nAfter this operation, 567 kB of additional disk space will be used.\nGet:1 http://archive.ubuntu.com/ubuntu bionic-updates/main amd64 unzip amd64 6.0-21ubuntu1.2 [168 kB]\nFetched 168 kB in 1s (265 kB/s)\nSelecting previously unselected package unzip.\r\n(Reading database ... \r(Reading database ... 5%\r(Reading database ... 10%\r(Reading database ... 15%\r(Reading database ... 20%\r(Reading database ... 25%\r(Reading database ... 30%\r(Reading database ... 35%\r(Reading database ... 40%\r(Reading database ... 45%\r(Reading database ... 50%\r(Reading database ... 55%\r(Reading database ... 60%\r(Reading database ... 65%\r(Reading database ... 70%\r(Reading database ... 75%\r(Reading database ... 80%\r(Reading database ... 85%\r(Reading database ... 90%\r(Reading database ... 95%\r(Reading database ... 100%\r(Reading database ... 8575 files and directories currently installed.)\r\nPreparing to unpack .../unzip_6.0-21ubuntu1.2_amd64.deb ...\r\nUnpacking unzip (6.0-21ubuntu1.2) ...\r\nSetting up unzip (6.0-21ubuntu1.2) ...\r\nRemoving intermediate container acaa1b3d2034\n ---> abe4fc80c795\nStep 4/12 : ENV WORKDIR=/code/pelias/geonames\n ---> Running in 11e5d29e1ae4\nRemoving intermediate container 11e5d29e1ae4\n ---> 64a81fbdd256\nStep 5/12 : WORKDIR $WORKDIR\n ---> Running in 5a7523132389\nRemoving intermediate container 5a7523132389\n ---> ee7500e521da\nStep 6/12 : COPY ./bin/updateMetadata.js $WORKDIR/bin/updateMetadata.js\n ---> c18b50a25d76\nStep 7/12 : COPY ./lib/tasks/meta.js ./lib/tasks/metafiles.json $WORKDIR/lib/tasks/\n ---> 8a45d2d135d5\nStep 8/12 : COPY ./package.json ${WORKDIR}\n ---> 4c5c3a51fde3\nStep 9/12 : RUN npm install\n ---> Running in ec3e27875bd8\n\u001b[91mnpm WARN EBADENGINE Unsupported engine {\nnpm WARN EBADENGINE   package: 'bun@0.0.10',\nnpm WARN EBADENGINE   required: { node: '~0.10.12' },\nnpm\u001b[0m\u001b[91m WARN EBADENGINE   current: { node: 'v12.22.2', npm: '8.1.2' }\nnpm WARN EBADENGINE }\n\u001b[0m\u001b[91mnpm WARN deprecated formidable@1.2.6: Please upgrade to latest, formidable@v2 or formidable@v3! Check these notes: https://bit.ly/2ZEqIau\n\u001b[0m\u001b[91mnpm WARN deprecated har-validator@5.1.5: this library is no longer supported\n\u001b[0m\u001b[91mnpm WARN deprecated uuid@3.4.0: Please upgrade  to version 7 or higher.  Older versions may use Math.random() in certain circumstances, which is known to be problematic.  See https://v8.dev/blog/math-random for details.\n\u001b[0m\u001b[91mnpm WARN deprecated stable@0.1.8: Modern JS already guarantees Array#sort() is a stable sort, so this library is deprecated. See the compatibility table on MDN: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/sort#browser_compatibility\n\u001b[0m\u001b[91mnpm WARN deprecated @hapi/pinpoint@1.0.2: Moved to 'npm install @sideway/pinpoint'\n\u001b[0m\u001b[91mnpm WARN deprecated @hapi/formula@1.2.0: Moved to 'npm install @sideway/formula'\n\u001b[0m\u001b[91mnpm WARN deprecated @hapi/address@2.1.4: Moved to 'npm install @sideway/address'\n\u001b[0m\u001b[91mnpm WARN deprecated @hapi/topo@3.1.6: This version has been deprecated and is no longer supported or maintained\n\u001b[0m\u001b[91mnpm WARN deprecated @hapi/hoek@8.5.1: This version has been deprecated and is no longer supported or maintained\n\u001b[0m\u001b[91mnpm WARN deprecated request@2.88.2: request has been deprecated, see https://github.com/request/request/issues/3142\n\u001b[0m\u001b[91mnpm WARN deprecated @hapi/joi@16.1.8: Switch to 'npm install joi'\n\u001b[0m\u001b[91mnpm WARN deprecated superagent@5.3.1: Please upgrade to v7.0.2+ of superagent.  We have fixed numerous issues with streams, form-data, attach(), filesystem errors not bubbling up (ENOENT on attach()), and all tests are now passing.  See the releases tab for more information at <https://github.com/visionmedia/superagent/releases>.\n\u001b[0m\u001b[91mnpm WARN deprecated elasticsearch@16.7.3: Package no longer supported. Contact Support at https://www.npmjs.com/support for more info.\n\u001b[0m\n> pelias-geonames@0.0.0-development postinstall\n> npm run download_metadata\n\n\n> pelias-geonames@0.0.0-development download_metadata\n> mkdir -p metadata && node bin/updateMetadata.js\n\n\nadded 297 packages, and audited 298 packages in 15s\n\n69 packages are looking for funding\n  run `npm fund` for details\n\n5 high severity vulnerabilities\n\nTo address issues that do not require attention, run:\n  npm audit fix\n\nTo address all issues (including breaking changes), run:\n  npm audit fix --force\n\nRun `npm audit` for details.\n\u001b[91mnpm notice \nnpm notice New major version of npm available! 8.1.2 -> 9.2.0\nnpm notice\u001b[0m\u001b[91m Changelog: <https://github.com/npm/cli/releases/tag/v9.2.0>\nnpm notice Run `npm install -g npm@9.2.0` to update!\nnpm notice \n\u001b[0mRemoving intermediate container ec3e27875bd8\n ---> 661c5531a1e6\nStep 10/12 : ADD . $WORKDIR\n ---> b13a1c6b8c0e\nStep 11/12 : RUN npm test\n ---> Running in 9e325cf1a005\n\n> pelias-geonames@0.0.0-development test\n> NODE_ENV=test npm run units\n\n\n> pelias-geonames@0.0.0-development units\n> ./bin/units\n\n\n  ..................................  \n\n  40 tests\n  34 passed\n  \n  Pass!\nRemoving intermediate container 9e325cf1a005\n ---> b0d6d85a51cc\nStep 12/12 : USER pelias\n ---> Running in ee828b4e6ead\nRemoving intermediate container ee828b4e6ead\n ---> 3f03a90da505\nSuccessfully built 3f03a90da505\nSuccessfully tagged geonames:latest\n","stderr":"","imageSize":374515184},"endTime":1672303470711}