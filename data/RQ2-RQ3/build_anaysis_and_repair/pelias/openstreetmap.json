{"repository":"https://github.com/pelias/openstreetmap","dockerfilePath":"Dockerfile","startTime":1672916794979,"endTime":1672917133511,"clone":{"startTime":1672916794979,"stdout":"","stderr":"Cloning into '/tmp/dinghy-analysis/pelias/openstreetmap'...\n","error":null,"endTime":1672916799989,"commit":"6df14a6a3dd3cede2a42b8d60430036c18b6a781"},"originalBuild":{"startTime":1672916800078,"endTime":1672917019218,"error":null,"stdout":"Sending build context to Docker daemon  264.2kB\r\r\nStep 1/9 : FROM pelias/baseimage\nlatest: Pulling from pelias/baseimage\n284055322776: Pulling fs layer\nfabdd7f2922a: Pulling fs layer\nf8540ef0f7df: Pulling fs layer\n6299b98d2899: Pulling fs layer\nb7a0afcdeee8: Pulling fs layer\na9224d0dd888: Pulling fs layer\n8cbdbe752c4e: Pulling fs layer\nb2c4749dd6b0: Pulling fs layer\n19098de62ed7: Pulling fs layer\n6299b98d2899: Waiting\nbda15fdc95e9: Pulling fs layer\nb7a0afcdeee8: Waiting\n625428d5e357: Pulling fs layer\na9224d0dd888: Waiting\n8cbdbe752c4e: Waiting\na30d3ceac264: Pulling fs layer\nb2c4749dd6b0: Waiting\nbda15fdc95e9: Waiting\n19098de62ed7: Waiting\n625428d5e357: Waiting\na30d3ceac264: Waiting\nfabdd7f2922a: Verifying Checksum\nfabdd7f2922a: Download complete\n284055322776: Verifying Checksum\n284055322776: Download complete\nb7a0afcdeee8: Verifying Checksum\nb7a0afcdeee8: Download complete\nf8540ef0f7df: Verifying Checksum\nf8540ef0f7df: Download complete\n6299b98d2899: Download complete\na9224d0dd888: Verifying Checksum\na9224d0dd888: Download complete\n8cbdbe752c4e: Verifying Checksum\n8cbdbe752c4e: Download complete\nbda15fdc95e9: Download complete\n19098de62ed7: Verifying Checksum\n19098de62ed7: Download complete\n284055322776: Pull complete\n625428d5e357: Verifying Checksum\n625428d5e357: Download complete\na30d3ceac264: Verifying Checksum\na30d3ceac264: Download complete\nb2c4749dd6b0: Verifying Checksum\nb2c4749dd6b0: Download complete\nfabdd7f2922a: Pull complete\nf8540ef0f7df: Pull complete\n6299b98d2899: Pull complete\nb7a0afcdeee8: Pull complete\na9224d0dd888: Pull complete\n8cbdbe752c4e: Pull complete\nb2c4749dd6b0: Pull complete\n19098de62ed7: Pull complete\nbda15fdc95e9: Pull complete\n625428d5e357: Pull complete\na30d3ceac264: Pull complete\nDigest: sha256:3f8e7b2cd36fee21a33bfcd114666a65bd01ca248a3f65d710ba1f393cf803bf\nStatus: Downloaded newer image for pelias/baseimage:latest\n ---> 20d46db0f488\nStep 2/9 : RUN apt-get update && apt-get install -y bzip2 unzip && rm -rf /var/lib/apt/lists/*\n ---> Running in 37e9e9a62a05\nGet:1 http://security.ubuntu.com/ubuntu bionic-security InRelease [88.7 kB]\nGet:2 http://archive.ubuntu.com/ubuntu bionic InRelease [242 kB]\nGet:3 http://security.ubuntu.com/ubuntu bionic-security/restricted amd64 Packages [1,311 kB]\nGet:4 http://archive.ubuntu.com/ubuntu bionic-updates InRelease [88.7 kB]\nGet:5 http://archive.ubuntu.com/ubuntu bionic-backports InRelease [83.3 kB]\nGet:6 http://archive.ubuntu.com/ubuntu bionic/restricted amd64 Packages [13.5 kB]\nGet:7 http://archive.ubuntu.com/ubuntu bionic/multiverse amd64 Packages [186 kB]\nGet:8 http://archive.ubuntu.com/ubuntu bionic/main amd64 Packages [1,344 kB]\nGet:9 http://security.ubuntu.com/ubuntu bionic-security/universe amd64 Packages [1,568 kB]\nGet:10 http://archive.ubuntu.com/ubuntu bionic/universe amd64 Packages [11.3 MB]\nGet:11 http://security.ubuntu.com/ubuntu bionic-security/main amd64 Packages [3,100 kB]\nGet:12 http://security.ubuntu.com/ubuntu bionic-security/multiverse amd64 Packages [22.9 kB]\nGet:13 http://archive.ubuntu.com/ubuntu bionic-updates/main amd64 Packages [3,525 kB]\nGet:14 http://archive.ubuntu.com/ubuntu bionic-updates/restricted amd64 Packages [1,352 kB]\nGet:15 http://archive.ubuntu.com/ubuntu bionic-updates/multiverse amd64 Packages [30.0 kB]\nGet:16 http://archive.ubuntu.com/ubuntu bionic-updates/universe amd64 Packages [2,344 kB]\nGet:17 http://archive.ubuntu.com/ubuntu bionic-backports/universe amd64 Packages [20.5 kB]\nGet:18 http://archive.ubuntu.com/ubuntu bionic-backports/main amd64 Packages [64.0 kB]\nFetched 26.7 MB in 3s (8,724 kB/s)\nReading package lists...\nReading package lists...\nBuilding dependency tree...\nReading state information...\nbzip2 is already the newest version (1.0.6-8.1ubuntu0.2).\nSuggested packages:\n  zip\nThe following NEW packages will be installed:\n  unzip\n0 upgraded, 1 newly installed, 0 to remove and 55 not upgraded.\nNeed to get 168 kB of archives.\nAfter this operation, 567 kB of additional disk space will be used.\nGet:1 http://archive.ubuntu.com/ubuntu bionic-updates/main amd64 unzip amd64 6.0-21ubuntu1.2 [168 kB]\nFetched 168 kB in 0s (1,102 kB/s)\nSelecting previously unselected package unzip.\r\n(Reading database ... \r(Reading database ... 5%\r(Reading database ... 10%\r(Reading database ... 15%\r(Reading database ... 20%\r(Reading database ... 25%\r(Reading database ... 30%\r(Reading database ... 35%\r(Reading database ... 40%\r(Reading database ... 45%\r(Reading database ... 50%\r(Reading database ... 55%\r(Reading database ... 60%\r(Reading database ... 65%\r(Reading database ... 70%\r(Reading database ... 75%\r(Reading database ... 80%\r(Reading database ... 85%\r(Reading database ... 90%\r(Reading database ... 95%\r(Reading database ... 100%\r(Reading database ... 8575 files and directories currently installed.)\r\nPreparing to unpack .../unzip_6.0-21ubuntu1.2_amd64.deb ...\r\nUnpacking unzip (6.0-21ubuntu1.2) ...\r\nSetting up unzip (6.0-21ubuntu1.2) ...\r\nRemoving intermediate container 37e9e9a62a05\n ---> 56f31a98143e\nStep 3/9 : ENV WORKDIR /code/pelias/openstreetmap\n ---> Running in 4f1f85be27e2\nRemoving intermediate container 4f1f85be27e2\n ---> 46322f533721\nStep 4/9 : WORKDIR ${WORKDIR}\n ---> Running in f50b8f3f4217\nRemoving intermediate container f50b8f3f4217\n ---> a1c8223ecead\nStep 5/9 : COPY ./package.json ${WORKDIR}\n ---> a17753ae14ce\nStep 6/9 : RUN npm install\n ---> Running in 895a55e738ca\n\u001b[91mnpm \u001b[0m\u001b[91mWARN deprecated formidable@1.2.6: Please upgrade to latest, formidable@v2 or formidable@v3! Check these notes: https://bit.ly/2ZEqIau\n\u001b[0m\u001b[91mnpm WARN deprecated har-validator@5.1.5: this library is no longer supported\n\u001b[0m\u001b[91mnpm WARN deprecated stable@0.1.8: Modern JS already guarantees Array#sort() is a stable sort, so this library is deprecated. See the compatibility table on MDN: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/sort#browser_compatibility\n\u001b[0m\u001b[91mnpm WARN deprecated @hapi/topo@3.1.6: This version has been deprecated and is no longer supported or maintained\n\u001b[0m\u001b[91mnpm WARN deprecated uuid@3.4.0: Please upgrade  to version 7 or higher.  Older versions may use Math.random() in certain circumstances, which is known to be problematic.  See https://v8.dev/blog/math-random for details.\n\u001b[0m\u001b[91mnpm WARN deprecated @hapi/formula@1.2.0: Moved to 'npm install @sideway/formula'\n\u001b[0m\u001b[91mnpm WARN deprecated hoek@6.1.3: This module has moved and is now available at @hapi/hoek. Please update your dependencies as this version is no longer maintained an may contain bugs and security issues.\n\u001b[0m\u001b[91mnpm WARN \u001b[0m\u001b[91mdeprecated topo@3.0.3: This module has moved and is now available at @hapi/topo. Please update your dependencies as this version is no longer maintained an may contain bugs and security issues.\n\u001b[0m\u001b[91mnpm WARN deprecated @hapi/address@2.1.4: Moved to 'npm install @sideway/address'\n\u001b[0m\u001b[91mnpm WARN deprecated @hapi/pinpoint@1.0.2: Moved to 'npm install @sideway/pinpoint'\n\u001b[0m\u001b[91mnpm WARN deprecated @hapi/hoek@8.5.1: This version has been deprecated and is no longer supported or maintained\n\u001b[0m\u001b[91mnpm\u001b[0m\u001b[91m \u001b[0m\u001b[91mWARN\u001b[0m\u001b[91m deprecated request@2.88.2: request has been deprecated, see https://github.com/request/request/issues/3142\n\u001b[0m\u001b[91mnpm WARN\u001b[0m\u001b[91m deprecated @hapi/joi@16.1.8: Switch to 'npm install joi'\n\u001b[0m\u001b[91mnpm WARN deprecated superagent@5.3.1: Please upgrade to v7.0.2+ of superagent.  We have fixed numerous issues with streams, form-data, attach(), filesystem errors not bubbling up (ENOENT on attach()), and all tests are now passing.  See the releases tab for more information at <https://github.com/visionmedia/superagent/releases>.\n\u001b[0m\u001b[91mnpm WARN deprecated joi@14.3.1: This module has moved and is now available at @hapi/joi. Please update your dependencies as this version is no longer maintained an may contain bugs and security issues.\n\u001b[0m\u001b[91mnpm WARN deprecated istanbul@0.4.5: This module is no longer maintained, try this instead:\nnpm WARN deprecated   npm i nyc\nnpm WARN deprecated Visit https://istanbul.js.org/integrations for other alternatives.\n\u001b[0m\u001b[91mnpm WARN deprecated elasticsearch@16.7.3: Package no longer supported. Contact Support at https://www.npmjs.com/support for more info.\n\u001b[0m\nadded 351 packages, and audited 352 packages in 26s\n\n75 packages are looking for funding\n  run `npm fund` for details\n\n5 high severity vulnerabilities\n\nTo address all issues (including breaking changes), run:\n  npm audit fix --force\n\nRun `npm audit` for details.\n\u001b[91mnpm notice \nnpm notice New major version of npm available! 8.1.2 -> 9.2.0\nnpm notice\u001b[0m\u001b[91m Changelog: <https://github.com/npm/cli/releases/tag/v9.2.0>\nnpm notice Run `npm install -g npm@9.2.0` to update!\nnpm notice \n\u001b[0mRemoving intermediate container 895a55e738ca\n ---> 1dfa0db0b3c6\nStep 7/9 : ADD . ${WORKDIR}\n ---> a314e0f5fc9c\nStep 8/9 : RUN npm test && rm -rf /tmp/*\n ---> Running in 96a725230bce\n\n> pelias-openstreetmap@0.0.0-development test\n> npm run units\n\n\n> pelias-openstreetmap@0.0.0-development units\n> ./bin/test\n\n\u001b[91m2023-01-05T11:10:17.634Z - \u001b[31merror\u001b[39m: [openstreetmap] category_mapper error\n\u001b[0m\u001b[91m2023-01-05T11:10:17.634Z - \u001b[31merror\u001b[39m: [openstreetmap] Error: test\n    at Document.doc.getMeta (/code/pelias/openstreetmap/test/stream/category_mapper.js:178:37)\n    at DestroyableTransform._transform (/code/pelias/openstreetmap/stream/category_mapper.js:32:22)\n    at DestroyableTransform.Transform._read (/code/pelias/openstreetmap/node_modules/through2/node_modules/readable-stream/lib/_stream_transform.js:177:10)\n    at DestroyableTransform.Transform._write (/code/pelias/openstreetmap/node_modules/through2/node_modules/readable-stream/lib/_stream_transform.js:164:83)\n    at doWrite (/code/pelias/openstreetmap/node_modules/through2/node_modules/readable-stream/lib/_stream_writable.js:409:139)\n    at writeOrBuffer (/code/pelias/openstreetmap/node_modules/through2/node_modules/readable-stream/lib/_stream_writable.js:398:5)\n    at DestroyableTransform.Writable.write (/code/pelias/openstreetmap/node_modules/through2/node_modules/readable-stream/lib/_stream_writable.js:307:11)\n    at Test.<anonymous> (/code/pelias/openstreetmap/test/stream/category_mapper.js:186:12)\n    at Test.bound [as _cb] (/code/pelias/openstreetmap/node_modules/tape/lib/test.js:95:17)\n    at Test.run (/code/pelias/openstreetmap/node_modules/tape/lib/test.js:115:28)\n\u001b[0m\u001b[91m2023-01-05T11:10:17.634Z - \u001b[31merror\u001b[39m: [openstreetmap] {\n  \"name\": {},\n  \"parent\": {},\n  \"address_parts\": {},\n  \"center_point\": {},\n  \"category\": [],\n  \"addendum\": {},\n  \"source\": \"osm\",\n  \"layer\": \"a\",\n  \"source_id\": \"1\"\n}\n\u001b[0m\u001b[91m2023-01-05T11:10:17.639Z - \u001b[31merror\u001b[39m: [openstreetmap] addendum_mapper error\n\u001b[0m\u001b[91m2023-01-05T11:10:17.639Z - \u001b[31merror\u001b[39m: [openstreetmap] Error: test\n    at Document.doc.getMeta (/code/pelias/openstreetmap/test/stream/addendum_mapper.js:176:39)\n    at DestroyableTransform._transform (/code/pelias/openstreetmap/stream/addendum_mapper.js:35:22)\n    at DestroyableTransform.Transform._read (/code/pelias/openstreetmap/node_modules/through2/node_modules/readable-stream/lib/_stream_transform.js:177:10)\n    at DestroyableTransform.Transform._write (/code/pelias/openstreetmap/node_modules/through2/node_modules/readable-stream/lib/_stream_transform.js:164:83)\n    at doWrite (/code/pelias/openstreetmap/node_modules/through2/node_modules/readable-stream/lib/_stream_writable.js:409:139)\n    at writeOrBuffer (/code/pelias/openstreetmap/node_modules/through2/node_modules/readable-stream/lib/_stream_writable.js:398:5)\n    at DestroyableTransform.Writable.write (/code/pelias/openstreetmap/node_modules/through2/node_modules/readable-stream/lib/_stream_writable.js:307:11)\n    at Test.<anonymous> (/code/pelias/openstreetmap/test/stream/addendum_mapper.js:184:12)\n    at Test.bound [as _cb] (/code/pelias/openstreetmap/node_modules/tape/lib/test.js:95:17)\n    at Test.run (/code/pelias/openstreetmap/node_modules/tape/lib/test.js:115:28)\n2023-01-05T11:10:17.639Z - \u001b[31merror\u001b[39m: [openstreetmap] {\n  \"name\": {},\n  \"parent\": {},\n  \"address_parts\": {},\n  \"center_point\": {},\n  \"category\": [],\n  \"addendum\": {},\n  \"source\": \"osm\",\n  \"layer\": \"a\",\n  \"source_id\": \"1\"\n}\n\u001b[0m\u001b[91m2023-01-05T11:10:17.649Z - \u001b[31merror\u001b[39m: [openstreetmap] popularity_mapper error\n\u001b[0m\u001b[91m2023-01-05T11:10:17.650Z - \u001b[31merror\u001b[39m: [openstreetmap] Error: test\n    at Document.doc.getMeta (/code/pelias/openstreetmap/test/stream/popularity_mapper.js:315:39)\n    at DestroyableTransform._transform (/code/pelias/openstreetmap/stream/popularity_mapper.js:29:22)\n    at DestroyableTransform.Transform._read (/code/pelias/openstreetmap/node_modules/through2/node_modules/readable-stream/lib/_stream_transform.js:177:10)\n    at DestroyableTransform.Transform._write (/code/pelias/openstreetmap/node_modules/through2/node_modules/readable-stream/lib/_stream_transform.js:164:83)\n    at doWrite (/code/pelias/openstreetmap/node_modules/through2/node_modules/readable-stream/lib/_stream_writable.js:409:139)\n    at writeOrBuffer (/code/pelias/openstreetmap/node_modules/through2/node_modules/readable-stream/lib/_stream_writable.js:398:5)\n    at DestroyableTransform.Writable.write (/code/pelias/openstreetmap/node_modules/through2/node_modules/readable-stream/lib/_stream_writable.js:307:11)\n    at Test.<anonymous> (/code/pelias/openstreetmap/test/stream/popularity_mapper.js:323:12)\n    at Test.bound [as _cb] (/code/pelias/openstreetmap/node_modules/tape/lib/test.js:95:17)\n    at Test.run (/code/pelias/openstreetmap/node_modules/tape/lib/test.js:115:28)\n2023-01-05T11:10:17.650Z - \u001b[31merror\u001b[39m: [openstreetmap] {\n  \"name\": {},\n  \"parent\": {},\n  \"address_parts\": {},\n  \"center_point\": {},\n  \"category\": [],\n  \"addendum\": {},\n  \"source\": \"osm\",\n  \"layer\": \"venue\",\n  \"source_id\": \"1\"\n}\n\u001b[0m\u001b[91m2023-01-05T11:10:17.650Z - \u001b[31merror\u001b[39m: [openstreetmap] error constructing document model Error: doc without valid id or type\n    at DestroyableTransform._transform (/code/pelias/openstreetmap/stream/document_constructor.js:18:15)\n    at DestroyableTransform.Transform._read (/code/pelias/openstreetmap/node_modules/through2/node_modules/readable-stream/lib/_stream_transform.js:177:10)\n    at DestroyableTransform.Transform._write (/code/pelias/openstreetmap/node_modules/through2/node_modules/readable-stream/lib/_stream_transform.js:164:83)\n    at doWrite (/code/pelias/openstreetmap/node_modules/through2/node_modules/readable-stream/lib/_stream_writable.js:409:139)\n    at writeOrBuffer (/code/pelias/openstreetmap/node_modules/through2/node_modules/readable-stream/lib/_stream_writable.js:398:5)\n    at DestroyableTransform.Writable.write (/code/pelias/openstreetmap/node_modules/through2/node_modules/readable-stream/lib/_stream_writable.js:307:11)\n    at emptyDocument (/code/pelias/openstreetmap/test/stream/document_constructor.js:47:14)\n    at Test.doesNotThrow (/code/pelias/openstreetmap/node_modules/tape/lib/test.js:694:3)\n    at Test.bound [as doesNotThrow] (/code/pelias/openstreetmap/node_modules/tape/lib/test.js:95:17)\n    at Test.<anonymous> (/code/pelias/openstreetmap/test/stream/document_constructor.js:46:7)\n\u001b[0m\u001b[91m2023-01-05T11:10:17.653Z - \u001b[31merror\u001b[39m: [openstreetmap] error constructing document model PeliasModelError: invalid boundingBox, property 'upperLeft.lon' must be within range -180 to 180\n    at Object.module.exports.boundingBox (/code/pelias/openstreetmap/node_modules/pelias-model/util/valid.js:85:11)\n    at Document.setBoundingBox (/code/pelias/openstreetmap/node_modules/pelias-model/Document.js:601:11)\n    at DestroyableTransform._transform (/code/pelias/openstreetmap/stream/document_constructor.js:45:13)\n    at DestroyableTransform.Transform._read (/code/pelias/openstreetmap/node_modules/through2/node_modules/readable-stream/lib/_stream_transform.js:177:10)\n    at DestroyableTransform.Transform._write (/code/pelias/openstreetmap/node_modules/through2/node_modules/readable-stream/lib/_stream_transform.js:164:83)\n    at doWrite (/code/pelias/openstreetmap/node_modules/through2/node_modules/readable-stream/lib/_stream_writable.js:409:139)\n    at writeOrBuffer (/code/pelias/openstreetmap/node_modules/through2/node_modules/readable-stream/lib/_stream_writable.js:398:5)\n    at DestroyableTransform.Writable.write (/code/pelias/openstreetmap/node_modules/through2/node_modules/readable-stream/lib/_stream_writable.js:307:11)\n    at emptyDocument (/code/pelias/openstreetmap/test/stream/document_constructor.js:138:14)\n    at Test.doesNotThrow (/code/pelias/openstreetmap/node_modules/tape/lib/test.js:694:3)\n\u001b[0m\u001b[91m2023-01-05T11:10:17.670Z - \u001b[31merror\u001b[39m: [openstreetmap] tag_mapper error\n\u001b[0m\u001b[91m2023-01-05T11:10:17.670Z - \u001b[31merror\u001b[39m: [openstreetmap] Error: test\n    at Document.doc.getMeta (/code/pelias/openstreetmap/test/stream/tag_mapper.js:390:37)\n    at DestroyableTransform._transform (/code/pelias/openstreetmap/stream/tag_mapper.js:27:22)\n    at DestroyableTransform.Transform._read (/code/pelias/openstreetmap/node_modules/through2/node_modules/readable-stream/lib/_stream_transform.js:177:10)\n    at DestroyableTransform.Transform._write (/code/pelias/openstreetmap/node_modules/through2/node_modules/readable-stream/lib/_stream_transform.js:164:83)\n    at doWrite (/code/pelias/openstreetmap/node_modules/through2/node_modules/readable-stream/lib/_stream_writable.js:409:139)\n    at writeOrBuffer (/code/pelias/openstreetmap/node_modules/through2/node_modules/readable-stream/lib/_stream_writable.js:398:5)\n    at DestroyableTransform.Writable.write (/code/pelias/openstreetmap/node_modules/through2/node_modules/readable-stream/lib/_stream_writable.js:307:11)\n    at Test.<anonymous> (/code/pelias/openstreetmap/test/stream/tag_mapper.js:398:12)\n    at Test.bound [as _cb] (/code/pelias/openstreetmap/node_modules/tape/lib/test.js:95:17)\n    at Test.run (/code/pelias/openstreetmap/node_modules/tape/lib/test.js:115:28)\n\u001b[0m\u001b[91m2023-01-05T11:10:17.670Z - \u001b[31merror\u001b[39m: [openstreetmap] {\n  \"name\": {},\n  \"parent\": {},\n  \"address_parts\": {},\n  \"center_point\": {},\n  \"category\": [],\n  \"addendum\": {},\n  \"source\": \"a\",\n  \"layer\": \"b\",\n  \"source_id\": \"1\"\n}\n\u001b[0m\n  configValidation: missing imports should throw error\n\n    ✔ should throw\n    ✔ should throw\n    ✔ should throw\n    ✔ should throw\n    ✔ should throw\n\n  configValidation: non-object imports should throw error\n\n    ✔ should throw\n    ✔ should throw\n    ✔ should throw\n    ✔ should throw\n    ✔ should throw\n\n  configValidation: missing imports.openstreetmap should throw error\n\n    ✔ should throw\n\n  configValidation: non-object imports.openstreetmap should throw error\n\n    ✔ should throw\n    ✔ should throw\n    ✔ should throw\n    ✔ should throw\n    ✔ should throw\n\n  configValidation: missing datapath should throw error\n\n    ✔ should throw\n\n  configValidation: non-string datapath should throw error\n\n    ✔ should throw\n    ✔ should throw\n    ✔ should throw\n    ✔ should throw\n    ✔ should throw\n\n  configValidation: missing leveldbpath should throw error\n\n    ✔ should throw\n\n  configValidation: non-string leveldbpath should throw error\n\n    ✔ should throw\n    ✔ should throw\n    ✔ should throw\n    ✔ should throw\n    ✔ should throw\n\n  configValidation: missing import should throw error\n\n    ✔ should throw\n\n  configValidation: non-array import should throw error\n\n    ✔ should throw\n    ✔ should throw\n    ✔ should throw\n    ✔ should throw\n    ✔ should throw\n\n  configValidation: non-object elements in import array should throw error\n\n    ✔ import elements must be objects\n    ✔ import elements must be objects\n    ✔ import elements must be objects\n    ✔ import elements must be objects\n    ✔ import elements must be objects\n\n  configValidation: object elements in import array missing filename should throw error\n\n    ✔ import elements must contain filename\n\n  configValidation: non-string filenames in import array should throw error\n\n    ✔ should throw\n    ✔ should throw\n    ✔ should throw\n    ✔ should throw\n    ✔ should throw\n\n  configValidation: imports.openstreetmap.adminLookup should not throw error\n\n    ✔ deprecated adminLookup should be allowed\n\n  configValidation: configuration with only required fields should not throw error\n\n    ✔ config should be valid\n\n  configValidation: valid configuration with unknown fields in import objects should not throw error\n\n    ✔ config should be valid\n\n  importPipeline: valid configuration should return function that gets called\n\n    ✔ should be strictly equal\n    ✔ should be truthy\n\n  importPipeline: existence of imports.openstreetmap.adminLookup should log deprecation message and still import\n\n    ✔ should be strictly equal\n    ✔ should be truthy\n    ✔ should be truthy\n\n  importPipeline: configValidation throwing error should rethrow\n\n    ✔ should be strictly equal\n    ✔ should throw\n\n  category mapping: interface: category mapping\n\n    ✔ valid mapping\n\n  features: interface: features\n\n    ✔ valid taglist\n\n  features: blacklist default tags\n\n    ✔ should be falsy\n    ✔ should be falsy\n    ✔ should be falsy\n    ✔ should be falsy\n\n  features: whitelist default tags\n\n    ✔ should be truthy\n    ✔ should be falsy\n\n  features: whitelist venue tags\n\n    ✔ should be truthy\n    ✔ should be truthy\n    ✔ should be truthy\n    ✔ should be truthy\n    ✔ should be truthy\n    ✔ should be truthy\n    ✔ should be truthy\n    ✔ should be truthy\n    ✔ should be truthy\n    ✔ should be truthy\n    ✔ should be truthy\n    ✔ should be truthy\n    ✔ should be truthy\n    ✔ should be truthy\n    ✔ should be truthy\n    ✔ should be truthy\n    ✔ should be truthy\n    ✔ should be truthy\n    ✔ should be truthy\n    ✔ should be truthy\n    ✔ should be truthy\n    ✔ should be truthy\n    ✔ should be truthy\n    ✔ should be truthy\n    ✔ should be truthy\n    ✔ should be truthy\n    ✔ should be truthy\n    ✔ should be truthy\n    ✔ should be truthy\n    ✔ should be truthy\n    ✔ should be truthy\n    ✔ should be truthy\n    ✔ should be truthy\n    ✔ should be truthy\n\n  localized_name_keys: interface: localized_name_keys\n\n    ✔ valid key list\n\n  address_extractor: interface: factory\n\n    ✔ stream factory\n\n  address_extractor: interface: stream\n\n    ✔ valid stream\n    ✔ valid readable\n    ✔ valid writeable\n\n  address_extractor: interface: hasValidAddress\n\n    ✔ function exposed for testing\n\n  address_extractor: hasValidAddress: invalid item\n\n    ✔ should be falsy\n\n  address_extractor: hasValidAddress: invalid address object\n\n    ✔ should be falsy\n\n  address_extractor: hasValidAddress: invalid address number\n\n    ✔ should be falsy\n\n  address_extractor: hasValidAddress: invalid address number length\n\n    ✔ should be falsy\n\n  address_extractor: hasValidAddress: invalid address street\n\n    ✔ should be falsy\n\n  address_extractor: hasValidAddress: invalid address street length\n\n    ✔ should be falsy\n\n  address_extractor: hasValidAddress: valid address\n\n    ✔ should be truthy\n\n  address_extractor: passthrough: regular POI\n\n    ✔ layer not changed\n\n  address_extractor: filter: invalid POI\n\n    ✔ invalid doc should get filtered out\n\n  address_extractor: create: from nameless record\n\n    ✔ correct number of results\n    ✔ address only id schema\n    ✔ only default name set\n    ✔ correct name\n    ✔ layer changed\n\n  address_extractor: create: from named record\n\n    ✔ correct number of results\n    ✔ poi address id schema\n    ✔ correct name\n    ✔ layer changed\n    ✔ id unchanged\n    ✔ correct name\n    ✔ layer unchanged\n\n  address_extractor: create: duplicate records correctly\n\n    ✔ changed\n    ✔ changed\n    ✔ changed\n    ✔ changed\n    ✔ unset\n    ✔ not changed\n    ✔ not changed\n    ✔ not changed\n    ✔ not changed\n    ✔ not changed\n    ✔ not changed\n    ✔ not changed\n    ✔ not changed\n    ✔ not changed\n    ✔ not changed\n    ✔ not changed\n\n  address_extractor: create: one record per street number\n\n    2023-01-05T11:10:17.626Z - \u001b[34mdebug\u001b[39m: [openstreetmap] [address_extractor] found multiple house numbers:  0=1, 1=2, 2=3\n    2023-01-05T11:10:17.627Z - \u001b[34mdebug\u001b[39m: [openstreetmap] [address_extractor] found multiple house numbers:  0=1, 1=2, 2=3\n    ✔ correct number of results\n    ✔ changed\n    ✔ changed\n    ✔ changed\n    ✔ single number\n    ✔ changed\n    ✔ changed\n    ✔ changed\n    ✔ single number\n    ✔ changed\n    ✔ changed\n    ✔ changed\n    ✔ single number\n    ✔ not changed\n    ✔ not changed\n    ✔ not changed\n    ✔ first number\n\n  address_extractor: errors - catch thrown errors\n\n    ✔ no results\n\n  address_extractor: errors - passthrough named poi records\n\n    ✔ changed\n\n  category_mapper: interface: factory\n\n    ✔ stream factory\n\n  category_mapper: interface: stream\n\n    ✔ valid stream\n    ✔ valid readable\n    ✔ valid writeable\n\n  category_mapper: passthrough: no tags\n\n    ✔ no-op for docs with no tags\n    ✔ no name data mapped\n    ✔ no address data mapped\n\n  category_mapper: maps - regular features\n\n    ✔ correctly mapped\n\n  category_mapper: maps - wilcard features\n\n    ✔ correctly mapped\n\n  category_mapper: maps - bakery\n\n    ✔ correctly mapped\n\n  category_mapper: maps - biergarten\n\n    ✔ correctly mapped\n\n  category_mapper: maps - international airport\n\n    ✔ correctly mapped\n\n  category_mapper: maps - public transport\n\n    ✔ correctly mapped\n\n  category_mapper: maps - combination bakery biergarten\n\n    ✔ correctly mapped\n\n  category_mapper: maps - sports inherit recreation via wildcard\n\n    ✔ correctly mapped\n\n  category_mapper: maps - argentinian steak restaurant\n\n    ✔ correctly mapped\n\n  category_mapper: errors - catch thrown errors\n\n    ✔ doc passthrough\n\n  category_mapper: errors - ignore empty tags\n\n    ✔ ignore empty tags\n\n  category_mapper: errors - tab only value\n\n    ✔ remove tabs\n\n  category_mapper: errors - newline only value\n\n    ✔ remove newlines\n\n  addendum_mapper: interface: factory\n\n    ✔ stream factory\n\n  addendum_mapper: interface: stream\n\n    ✔ valid stream\n    ✔ valid readable\n    ✔ valid writeable\n\n  addendum_mapper: maps - wheelchair\n\n    ✔ correctly mapped\n\n  addendum_mapper: maps - iata\n\n    ✔ correctly mapped\n\n  addendum_mapper: maps - icao\n\n    ✔ correctly mapped\n\n  addendum_mapper: maps - wikidata\n\n    ✔ correctly mapped\n\n  addendum_mapper: maps - wikipedia\n\n    ✔ correctly mapped\n\n  addendum_mapper: maps - brand\n\n    ✔ correctly mapped\n\n  addendum_mapper: maps - operator\n\n    ✔ correctly mapped\n\n  addendum_mapper: maps - website\n\n    ✔ correctly mapped\n\n  addendum_mapper: maps - phone\n\n    ✔ correctly mapped\n\n  addendum_mapper: maps - opening_hours\n\n    ✔ correctly mapped\n\n  addendum_mapper: errors - catch thrown errors\n\n    ✔ doc passthrough\n\n  addendum_mapper: errors - ignore empty tags\n\n    ✔ ignore empty tags\n\n  addendum_mapper: errors - tab only value\n\n    ✔ remove tabs\n\n  addendum_mapper: errors - newline only value\n\n    ✔ remove newlines\n\n  popularity_mapper: interface: factory\n\n    ✔ stream factory\n\n  popularity_mapper: interface: stream\n\n    ✔ valid stream\n    ✔ valid readable\n    ✔ valid writeable\n\n  popularity_mapper: maps - importance_international\n\n    ✔ correctly mapped\n\n  popularity_mapper: maps - importance_national\n\n    ✔ correctly mapped\n\n  popularity_mapper: maps - wikidata\n\n    ✔ correctly mapped\n\n  popularity_mapper: maps - wikipedia\n\n    ✔ correctly mapped\n\n  popularity_mapper: maps - building:hospital\n\n    ✔ correctly mapped\n\n  popularity_mapper: maps - tourism:aquarium\n\n    ✔ correctly mapped\n\n  popularity_mapper: maps - amenity:post_office\n\n    ✔ correctly mapped\n\n  popularity_mapper: maps - contact:phone\n\n    ✔ correctly mapped\n\n  popularity_mapper: alias - international airport\n\n    ✔ should be deeply equivalent\n\n  popularity_mapper: alias - regional airport (invalid IATA code)\n\n    ✔ should be deeply equivalent\n\n  popularity_mapper: alias - railway station\n\n    ✔ should be deeply equivalent\n\n  popularity_mapper: does not map - non-venue\n\n    ✔ no mapping performed\n\n  popularity_mapper: does not map - non-venue\n\n    ✔ should be deeply equivalent\n\n  popularity_mapper: does not map - disused\n\n    2023-01-05T11:10:17.645Z - \u001b[33mwarn\u001b[39m: [openstreetmap] removing record osm:venue:1 (undefined) with popularity -100000\n    ✔ document discarded\n\n  popularity_mapper: does not map - abandoned, removal disabled\n\n    ✔ document NOT discarded\n\n  popularity_mapper: does not map - abandoned, removal enabled\n\n    2023-01-05T11:10:17.649Z - \u001b[33mwarn\u001b[39m: [openstreetmap] removing record osm:venue:1 (undefined) with popularity -100000\n    ✔ document discarded\n\n  popularity_mapper: does not map negative value for - abandoned:amenity=place_of_worship\n\n    ✔ should be deeply equivalent\n\n  popularity_mapper: errors - catch thrown errors\n\n    ✔ doc passthrough\n\n  document_constructor: interface: factory\n\n    ✔ stream factory\n\n  document_constructor: interface: stream\n\n    ✔ valid stream\n    ✔ valid readable\n    ✔ valid writeable\n\n  document_constructor: instantiate: valid\n\n    ✔ correct proto\n    ✔ correct id\n    ✔ defaults to venue\n\n  document_constructor: model errors: avoid fatal errors\n\n    ✔ should not throw\n\n  document_constructor: centroid: valid\n\n    ✔ correct centroid\n\n  document_constructor: centroid: invalid\n\n    ✔ no centroid\n\n  document_constructor: centroid: contains zero value\n\n    ✔ accepts zero values\n\n  document_constructor: centroid: from preprocessed centroid property\n\n    ✔ accepts centroid property\n\n  document_constructor: centroid: prefers lat/lon to centroid\n\n    ✔ prefers lat/lon\n\n  document_constructor: bounds: no bbox provided\n\n    ✔ undefined bounds\n\n  document_constructor: bounds: bbox not object\n\n    ✔ undefined bounds\n\n  document_constructor: bounds: valid bbox provided\n\n    ✔ valid bounds\n\n  document_constructor: bounds: partial bbox provided - skip record\n\n    ✔ should not throw\n\n  document_constructor: tags: valid\n\n    ✔ tags set\n\n  document_constructor: tags: invalid\n\n    ✔ no tags\n\n  importPipeline: interface: pbfParser\n\n    ✔ stream factory\n\n  importPipeline: interface: docConstructor\n\n    ✔ stream factory\n\n  importPipeline: interface: blacklistStream\n\n    ✔ stream factory\n\n  importPipeline: interface: addressesWithoutStreet\n\n    ✔ stream factory\n\n  importPipeline: interface: tagMapper\n\n    ✔ stream factory\n\n  importPipeline: interface: adminLookup\n\n    ✔ stream factory\n\n  importPipeline: interface: addressExtractor\n\n    ✔ stream factory\n\n  importPipeline: interface: categoryMapper\n\n    ✔ stream factory\n\n  importPipeline: interface: addendumMapper\n\n    ✔ stream factory\n\n  importPipeline: interface: popularityMapper\n\n    ✔ stream factory\n\n  importPipeline: interface: dbMapper\n\n    ✔ stream factory\n\n  importPipeline: interface: elasticsearch\n\n    ✔ stream factory\n\n  importPipeline: interface: import\n\n    ✔ stream factory\n\n  importPipeline: interface: stream count\n\n    ✔ correct number of streams\n\n  importPipeline: interface: importPipeline.config.categoryDefaults\n\n    ✔ default mapping object\n\n  pbf: interface: config\n\n    ✔ config function\n\n  pbf: interface: parser\n\n    ✔ stream factory\n\n  pbf: config: load defaults\n\n    ✔ load from settings\n    ✔ load from settings\n\n  pbf: validate: pbf path\n\n    ✔ failed to stat pbf file: defaultDataPath/the/file/does/not/exist.pbf\n\n  pbf: validate: leveldb path\n\n    ✔ failed to stat leveldb path: path/doesnt/exist\n\n  pbf: Disable venues import\n\n    ✔ disable importVenues\n\n  stats: interface: stats\n\n    ✔ stats instance\n    ✔ stream factory\n\n  stats: reset metrics\n\n    ✔ reset metrics\n\n  stats: create proxy: init metric\n\n    ✔ metric initialized\n\n  stats: create proxy: return stream\n\n    ✔ valid stream\n    ✔ valid readable\n    ✔ valid writeable\n\n  stats: proxy: record stats\n\n    ✔ track xform ops\n\n  tag_mapper: interface: factory\n\n    ✔ stream factory\n\n  tag_mapper: interface: stream\n\n    ✔ valid stream\n    ✔ valid readable\n    ✔ valid writeable\n\n  tag_mapper: passthrough: no tags\n\n    ✔ no-op for docs with no tags\n    ✔ no name data mapped\n    ✔ no address data mapped\n\n  tag_mapper: maps - localised names\n\n    ✔ correctly mapped\n    ✔ correctly mapped\n\n  tag_mapper: maps - default name\n\n    ✔ correctly mapped\n\n  tag_mapper: maps - name aliases\n\n    ✔ correctly mapped\n    ✔ correctly mapped\n\n  tag_mapper: rejects - extraneous colon\n\n    ✔ extraneous colon tag ignored\n\n  tag_mapper: rejects - difficult keys\n\n    ✔ all keys rejected\n\n  tag_mapper: maps - localized keys\n\n    ✔ correctly mapped\n    ✔ correctly mapped\n    ✔ correctly mapped\n\n  tag_mapper: maps - use name:official as fallback default\n\n    ✔ official_name used as fallback\n    ✔ correctly mapped\n    ✔ correctly mapped\n\n  tag_mapper: maps - use name:en as fallback default\n\n    ✔ name:en used as fallback\n    ✔ correctly mapped\n    ✔ correctly mapped\n    ✔ correctly mapped\n\n  tag_mapper: maps - unambiguous name:** used as default name fallback\n\n    ✔ only name:** tag used as fallback\n    ✔ correctly mapped\n\n  tag_mapper: maps - ambiguous name:** not used as default name fallback\n\n    ✔ do not try to guess\n\n  tag_mapper: maps - lowercase keys\n\n    ✔ correctly mapped\n\n  tag_mapper: alias - airport codes\n\n    ✔ correctly mapped\n    ✔ correctly mapped\n\n  tag_mapper: maps - osm schema\n\n    ✔ correctly mapped\n\n  tag_mapper: maps - naptan schema\n\n    ✔ correctly mapped\n\n  tag_mapper: maps - karlsruhe schema\n\n    ✔ correctly mapped\n    ✔ correctly mapped\n\n  tag_mapper: norm - contract directionals at end\n\n    ✔ contracted\n\n  tag_mapper: norm - contract directionals at start\n\n    ✔ contracted\n\n  tag_mapper: norm - requires trailing word break\n\n    ✔ no-op\n\n  tag_mapper: norm - requires leading word break\n\n    ✔ no-op\n\n  tag_mapper: clean - junk chars\n\n    ✔ correctly mapped\n\n  tag_mapper: clean - preserve brackets\n\n    ✔ correctly mapped\n\n  tag_mapper: errors - catch thrown errors\n\n    ✔ doc passthrough\n\n  tag_mapper: errors - ignore empty tags\n\n    ✔ ignore empty tags\n\n  tag_mapper: errors - tab only value\n\n    ✔ remove tabs\n\n  tag_mapper: errors - tab in value\n\n    ✔ remove tabs\n\n  tag_mapper: errors - newline only value\n\n    ✔ remove newlines\n\n  tag_mapper: errors - newline in value\n\n    ✔ remove newlines\n\n  tag_mapper: skip_inherited_enumerable_properties\n\n    ✔ should be falsy\n    ✔ empty\n\n  address_without_street: interface: factory\n\n    ✔ stream factory\n\n  address_without_street: interface: stream\n\n    ✔ valid stream\n    ✔ valid readable\n    ✔ valid writeable\n\n  address_without_street: passthrough: missing addr:housenumber tag\n\n    ✔ tags not modified\n\n  address_without_street: maps - karlsruhe schema with filled street\n\n    ✔ correctly mapped\n\n  address_without_street: maps - karlsruhe schema with empty street and filled place\n\n    ✔ correctly mapped\n\n  address_without_street: maps - karlsruhe schema without street and with filled place\n\n    ✔ correctly mapped\n\n  address_without_street: maps - karlsruhe schema with both street and place\n\n    ✔ correctly mapped\n\n\n  total:     325\n  passing:   325\n  duration:  29ms\n\n\nRemoving intermediate container 96a725230bce\n ---> 5c8a205a725e\nStep 9/9 : USER pelias\n ---> Running in 9ec70f0acf71\nRemoving intermediate container 9ec70f0acf71\n ---> 4656ebcc7236\nSuccessfully built 4656ebcc7236\nSuccessfully tagged openstreetmap:latest\n","stderr":"","imageSize":402010331},"repair":{"startTime":1672917019262,"endTime":1672917019352,"violations":[{"name":"npmCacheCleanAfterInstall","position":{"start":13,"end":13,"columnStart":4,"columnEnd":15}},{"name":"aptGetInstallUseNoRec","position":{"start":5,"end":5,"columnStart":22,"columnEnd":52}}],"repairedDockerfile":"# base image\nFROM pelias/baseimage\n\n# downloader apt dependencies\n# note: this is done in one command in order to keep down the size of intermediate containers\nRUN apt-get update && apt-get install --no-install-recommends -y bzip2 unzip && rm -rf /var/lib/apt/lists/*\n\n# change working dir\nENV WORKDIR /code/pelias/openstreetmap\nWORKDIR ${WORKDIR}\n\n# copy package.json first to prevent npm install being rerun when only code changes\nCOPY ./package.json ${WORKDIR}\nRUN npm install && npm cache clean --force;\n\n# add local code\nADD . ${WORKDIR}\n\n# run tests, clean up LevelDB lockfile\nRUN npm test && rm -rf /tmp/*\n\n# run as the pelias user\nUSER pelias\n"},"repairedBuild":{"startTime":1672917020824,"endTime":1672917133078,"error":null,"stdout":"Sending build context to Docker daemon  264.2kB\r\r\nStep 1/9 : FROM pelias/baseimage\n ---> 20d46db0f488\nStep 2/9 : RUN apt-get update && apt-get install --no-install-recommends -y bzip2 unzip && rm -rf /var/lib/apt/lists/*\n ---> Running in d6554f3e7c2a\nGet:1 http://security.ubuntu.com/ubuntu bionic-security InRelease [88.7 kB]\nGet:2 http://archive.ubuntu.com/ubuntu bionic InRelease [242 kB]\nGet:3 http://security.ubuntu.com/ubuntu bionic-security/universe amd64 Packages [1,568 kB]\nGet:4 http://security.ubuntu.com/ubuntu bionic-security/multiverse amd64 Packages [22.9 kB]\nGet:5 http://security.ubuntu.com/ubuntu bionic-security/restricted amd64 Packages [1,311 kB]\nGet:6 http://security.ubuntu.com/ubuntu bionic-security/main amd64 Packages [3,100 kB]\nGet:7 http://archive.ubuntu.com/ubuntu bionic-updates InRelease [88.7 kB]\nGet:8 http://archive.ubuntu.com/ubuntu bionic-backports InRelease [83.3 kB]\nGet:9 http://archive.ubuntu.com/ubuntu bionic/universe amd64 Packages [11.3 MB]\nGet:10 http://archive.ubuntu.com/ubuntu bionic/main amd64 Packages [1,344 kB]\nGet:11 http://archive.ubuntu.com/ubuntu bionic/multiverse amd64 Packages [186 kB]\nGet:12 http://archive.ubuntu.com/ubuntu bionic/restricted amd64 Packages [13.5 kB]\nGet:13 http://archive.ubuntu.com/ubuntu bionic-updates/main amd64 Packages [3,525 kB]\nGet:14 http://archive.ubuntu.com/ubuntu bionic-updates/universe amd64 Packages [2,344 kB]\nGet:15 http://archive.ubuntu.com/ubuntu bionic-updates/restricted amd64 Packages [1,352 kB]\nGet:16 http://archive.ubuntu.com/ubuntu bionic-updates/multiverse amd64 Packages [30.0 kB]\nGet:17 http://archive.ubuntu.com/ubuntu bionic-backports/universe amd64 Packages [20.5 kB]\nGet:18 http://archive.ubuntu.com/ubuntu bionic-backports/main amd64 Packages [64.0 kB]\nFetched 26.7 MB in 4s (6,500 kB/s)\nReading package lists...\nReading package lists...\nBuilding dependency tree...\nReading state information...\nbzip2 is already the newest version (1.0.6-8.1ubuntu0.2).\nSuggested packages:\n  zip\nThe following NEW packages will be installed:\n  unzip\n0 upgraded, 1 newly installed, 0 to remove and 55 not upgraded.\nNeed to get 168 kB of archives.\nAfter this operation, 567 kB of additional disk space will be used.\nGet:1 http://archive.ubuntu.com/ubuntu bionic-updates/main amd64 unzip amd64 6.0-21ubuntu1.2 [168 kB]\nFetched 168 kB in 1s (260 kB/s)\nSelecting previously unselected package unzip.\r\n(Reading database ... \r(Reading database ... 5%\r(Reading database ... 10%\r(Reading database ... 15%\r(Reading database ... 20%\r(Reading database ... 25%\r(Reading database ... 30%\r(Reading database ... 35%\r(Reading database ... 40%\r(Reading database ... 45%\r(Reading database ... 50%\r(Reading database ... 55%\r(Reading database ... 60%\r(Reading database ... 65%\r(Reading database ... 70%\r(Reading database ... 75%\r(Reading database ... 80%\r(Reading database ... 85%\r(Reading database ... 90%\r(Reading database ... 95%\r(Reading database ... 100%\r(Reading database ... 8575 files and directories currently installed.)\r\nPreparing to unpack .../unzip_6.0-21ubuntu1.2_amd64.deb ...\r\nUnpacking unzip (6.0-21ubuntu1.2) ...\r\nSetting up unzip (6.0-21ubuntu1.2) ...\r\nRemoving intermediate container d6554f3e7c2a\n ---> 76c5f5d7ea2e\nStep 3/9 : ENV WORKDIR /code/pelias/openstreetmap\n ---> Running in c20c99c0df19\nRemoving intermediate container c20c99c0df19\n ---> 5968fcc6caa8\nStep 4/9 : WORKDIR ${WORKDIR}\n ---> Running in e9d11192eef4\nRemoving intermediate container e9d11192eef4\n ---> a29867effb8b\nStep 5/9 : COPY ./package.json ${WORKDIR}\n ---> a0be632e4f6c\nStep 6/9 : RUN npm install && npm cache clean --force;\n ---> Running in 3f811992cd6c\n\u001b[91mnpm WARN deprecated formidable@1.2.6: Please upgrade to latest, formidable@v2 or formidable@v3! Check these notes: https://bit.ly/2ZEqIau\n\u001b[0m\u001b[91mnpm WARN deprecated har-validator@5.1.5: this library is no longer supported\n\u001b[0m\u001b[91mnpm WARN deprecated stable@0.1.8: Modern JS already guarantees Array#sort() is a stable sort, so this library is deprecated. See the compatibility table on MDN: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/sort#browser_compatibility\n\u001b[0m\u001b[91mnpm WARN deprecated @hapi/formula@1.2.0: Moved to 'npm install @sideway/formula'\n\u001b[0m\u001b[91mnpm WARN \u001b[0m\u001b[91mdeprecated\u001b[0m\u001b[91m @hapi/topo@3.1.6: This version has been deprecated and is no longer supported or maintained\n\u001b[0m\u001b[91mnpm WARN deprecated @hapi/pinpoint@1.0.2: Moved to 'npm install @sideway/pinpoint'\n\u001b[0m\u001b[91mnpm WARN deprecated hoek@6.1.3: This module has moved and is now available at @hapi/hoek. Please update your dependencies as this version is no longer maintained an may contain bugs and security issues.\n\u001b[0m\u001b[91mnpm WARN deprecated topo@3.0.3: This module has moved and is now available at @hapi/topo. Please update your dependencies as this version is no longer maintained an may contain bugs and security issues.\n\u001b[0m\u001b[91mnpm WARN deprecated uuid@3.4.0: Please upgrade  to version 7 or higher.  Older versions may use Math.random() in certain circumstances, which is known to be problematic.  See https://v8.dev/blog/math-random for details.\n\u001b[0m\u001b[91mnpm WARN deprecated @hapi/address@2.1.4: Moved to 'npm install @sideway/address'\n\u001b[0m\u001b[91mnpm WARN deprecated @hapi/hoek@8.5.1: This version has been deprecated and is no longer supported or maintained\n\u001b[0m\u001b[91mnpm WARN deprecated request@2.88.2: request has been deprecated, see https://github.com/request/request/issues/3142\n\u001b[0m\u001b[91mnpm WARN deprecated joi@14.3.1: This module has moved and is now available at @hapi/joi. Please update your dependencies as this version is no longer maintained an may contain bugs and security issues.\n\u001b[0m\u001b[91mnpm WARN deprecated @hapi/joi@16.1.8: Switch to 'npm install joi'\n\u001b[0m\u001b[91mnpm WARN deprecated istanbul@0.4.5: This module is no longer maintained, try this instead:\nnpm WARN deprecated   npm i nyc\nnpm WARN \u001b[0m\u001b[91mdeprecated Visit https://istanbul.js.org/integrations for other alternatives.\n\u001b[0m\u001b[91mnpm WARN deprecated superagent@5.3.1: Please upgrade to v7.0.2+ of superagent.  We have fixed numerous issues with streams, form-data, attach(), filesystem errors not bubbling up (ENOENT on attach()), and all tests are now passing.  See the releases tab for more information at <https://github.com/visionmedia/superagent/releases>.\n\u001b[0m\u001b[91mnpm WARN deprecated elasticsearch@16.7.3: Package no longer supported. Contact Support at https://www.npmjs.com/support for more info.\n\u001b[0m\nadded 351 packages, and audited 352 packages in 18s\n\n75 packages are looking for funding\n  run `npm fund` for details\n\n5 high severity vulnerabilities\n\nTo address all issues (including breaking changes), run:\n  npm audit fix --force\n\nRun `npm audit` for details.\n\u001b[91mnpm notice \nnpm notice\u001b[0m\u001b[91m New major version of npm available! 8.1.2 -> 9.2.0\nnpm notice Changelog: <https://github.com/npm/cli/releases/tag/v9.2.0>\nnpm notice\u001b[0m\u001b[91m Run `npm install -g npm@9.2.0` to update!\n\u001b[0m\u001b[91mnpm notice\u001b[0m\u001b[91m \n\u001b[0m\u001b[91mnpm\u001b[0m\u001b[91m WARN using --force Recommended protections disabled.\n\u001b[0mRemoving intermediate container 3f811992cd6c\n ---> 2b57500e70ef\nStep 7/9 : ADD . ${WORKDIR}\n ---> 7561065e035f\nStep 8/9 : RUN npm test && rm -rf /tmp/*\n ---> Running in f8a73a846989\n\n> pelias-openstreetmap@0.0.0-development test\n> npm run units\n\n\n> pelias-openstreetmap@0.0.0-development units\n> ./bin/test\n\n\n  configValidation: missing imports should throw error\n\n    ✔ should throw\n    ✔ should throw\n    ✔ should throw\n    ✔ should throw\n    ✔ should throw\n\n  configValidation: non-object imports should throw error\n\n    ✔ should throw\n    ✔ should throw\n    ✔ should throw\n    ✔ should throw\n    ✔ should throw\n\n  configValidation: missing imports.openstreetmap should throw error\n\n    ✔ should throw\n\n  configValidation: non-object imports.openstreetmap should throw error\n\n    ✔ should throw\n    ✔ should throw\n    ✔ should throw\n    ✔ should throw\n    ✔ should throw\n\n  configValidation: missing datapath should throw error\n\n    ✔ should throw\n\n  configValidation: non-string datapath should throw error\n\n    ✔ should throw\n    ✔ should throw\n    ✔ should throw\n    ✔ should throw\n    ✔ should throw\n\n  configValidation: missing leveldbpath should throw error\n\n    ✔ should throw\n\n  configValidation: non-string leveldbpath should throw error\n\n    ✔ should throw\n    ✔ should throw\n    ✔ should throw\n    ✔ should throw\n    ✔ should throw\n\n  configValidation: missing import should throw error\n\n    ✔ should throw\n\n  configValidation: non-array import should throw error\n\n    ✔ should throw\n    ✔ should throw\n    ✔ should throw\n    ✔ should throw\n    ✔ should throw\n\n  configValidation: non-object elements in import array should throw error\n\n    ✔ import elements must be objects\n    ✔ import elements must be objects\n    ✔ import elements must be objects\n    ✔ import elements must be objects\n    ✔ import elements must be objects\n\n  configValidation: object elements in import array missing filename should throw error\n\n    ✔ import elements must contain filename\n\n  configValidation: non-string filenames in import array should throw error\n\n    ✔ should throw\n    ✔ should throw\n    ✔ should throw\n    ✔ should throw\n    ✔ should throw\n\n  configValidation: imports.openstreetmap.adminLookup should not throw error\n\n    ✔ deprecated adminLookup should be allowed\n\n  configValidation: configuration with only required fields should not throw error\n\n    ✔ config should be valid\n\n  configValidation: valid configuration with unknown fields in import objects should not throw error\n\n    ✔ config should be valid\n\n  importPipeline: valid configuration should return function that gets called\n\n    ✔ should be strictly equal\n    ✔ should be truthy\n\n  importPipeline: existence of imports.openstreetmap.adminLookup should log deprecation message and still import\n\n    ✔ should be strictly equal\n    ✔ should be truthy\n    ✔ should be truthy\n\n  importPipeline: configValidation throwing error should rethrow\n\n    ✔ should be strictly equal\n    ✔ should throw\n\n  category mapping: interface: category mapping\n\n    ✔ valid mapping\n\n  features: interface: features\n\n    ✔ valid taglist\n\n  features: blacklist default tags\n\n    ✔ should be falsy\n    ✔ should be falsy\n    ✔ should be falsy\n    ✔ should be falsy\n\n  features: whitelist default tags\n\n    ✔ should be truthy\n    ✔ should be falsy\n\n  features: whitelist venue tags\n\n    ✔ should be truthy\n    ✔ should be truthy\n    ✔ should be truthy\n    ✔ should be truthy\n    ✔ should be truthy\n    ✔ should be truthy\n    ✔ should be truthy\n    ✔ should be truthy\n    ✔ should be truthy\n    ✔ should be truthy\n    ✔ should be truthy\n    ✔ should be truthy\n    ✔ should be truthy\n    ✔ should be truthy\n    ✔ should be truthy\n    ✔ should be truthy\n    ✔ should be truthy\n    ✔ should be truthy\n    ✔ should be truthy\n    ✔ should be truthy\n    ✔ should be truthy\n    ✔ should be truthy\n    ✔ should be truthy\n    ✔ should be truthy\n    ✔ should be truthy\n    ✔ should be truthy\n    ✔ should be truthy\n    ✔ should be truthy\n    ✔ should be truthy\n    ✔ should be truthy\n    ✔ should be truthy\n    ✔ should be truthy\n    ✔ should be truthy\n    ✔ should be truthy\n\n  localized_name_keys: interface: localized_name_keys\n\n    ✔ valid key list\n\n  address_extractor: interface: factory\n\n    ✔ stream factory\n\n  address_extractor: interface: stream\n\n    ✔ valid stream\n    ✔ valid readable\n    ✔ valid writeable\n\n  address_extractor: interface: hasValidAddress\n\n    ✔ function exposed for testing\n\n  address_extractor: hasValidAddress: invalid item\n\n    ✔ should be falsy\n\n  address_extractor: hasValidAddress: invalid address object\n\n    ✔ should be falsy\n\n  address_extractor: hasValidAddress: invalid address number\n\n    ✔ should be falsy\n\n  address_extractor: hasValidAddress: invalid address number length\n\n    ✔ should be falsy\n\n  address_extractor: hasValidAddress: invalid address street\n\n    ✔ should be falsy\n\n  address_extractor: hasValidAddress: invalid address street length\n\n    ✔ should be falsy\n\n  address_extractor: hasValidAddress: valid address\n\n    ✔ should be truthy\n\n  address_extractor: passthrough: regular POI\n\n    ✔ layer not changed\n\n  address_extractor: filter: invalid POI\n\n    ✔ invalid doc should get filtered out\n\n  address_extractor: create: from nameless record\n\n    ✔ correct number of results\n    ✔ address only id schema\n    ✔ only default name set\n    ✔ correct name\n    ✔ layer changed\n\n  address_extractor: create: from named record\n\n    ✔ correct number of results\n    ✔ poi address id schema\n    ✔ correct name\n    ✔ layer changed\n    ✔ id unchanged\n    ✔ correct name\n    ✔ layer unchanged\n\n  address_extractor: create: duplicate records correctly\n\n    ✔ changed\n    ✔ changed\n    ✔ changed\n    ✔ changed\n    ✔ unset\n    ✔ not changed\n    ✔ not changed\n    ✔ not changed\n    ✔ not changed\n    ✔ not changed\n    ✔ not changed\n    ✔ not changed\n    ✔ not changed\n    ✔ not changed\n    ✔ not changed\n    ✔ not changed\n\n  address_extractor: create: one record per street number\n\n    2023-01-05T11:11:53.377Z - \u001b[34mdebug\u001b[39m: [openstreetmap] [address_extractor] found multiple house numbers:  0=1, 1=2, 2=3\n    2023-01-05T11:11:53.378Z - \u001b[34mdebug\u001b[39m: [openstreetmap] [address_extractor] found multiple house numbers:  0=1, 1=2, 2=3\n    ✔ correct number of results\n    ✔ changed\n    ✔ changed\n    ✔ changed\n    ✔ single number\n    ✔ changed\n    ✔ changed\n    ✔ changed\n    ✔ single number\n    ✔ changed\n    ✔ changed\n    ✔ changed\n    ✔ single number\n    ✔ not changed\n    ✔ not changed\n    ✔ not changed\n    ✔ first number\n\n  address_extractor: errors - catch thrown errors\n\n    ✔ no results\n\n  address_extractor: errors - passthrough named poi records\n\n    ✔ changed\n\n  category_mapper: interface: factory\n\n    ✔ stream factory\n\n  category_mapper: interface: stream\n\n    ✔ valid stream\n    ✔ valid readable\n    ✔ valid writeable\n\n  category_mapper: passthrough: no tags\n\n    ✔ no-op for docs with no tags\n    ✔ no name data mapped\n    ✔ no address data mapped\n\n  category_mapper: maps - regular features\n\n    ✔ correctly mapped\n\n  category_mapper: maps - wilcard features\n\n    ✔ correctly mapped\n\n  category_mapper: maps - bakery\n\n    ✔ correctly mapped\n\n  category_mapper: maps - biergarten\n\n    ✔ correctly mapped\n\n  category_mapper: maps - international airport\n\n    ✔ correctly mapped\n\n  category_mapper: maps - public transport\n\n    ✔ correctly mapped\n\n  category_mapper: maps - combination bakery biergarten\n\n    ✔ correctly mapped\n\n  category_mapper: maps - sports inherit recreation via wildcard\n\n    ✔ correctly mapped\n\n  category_mapper: maps - argentinian steak restaurant\n\n    ✔ correctly mapped\n\n  category_mapper: errors - catch thrown errors\n\n\u001b[91m2023-01-05T11:11:53.383Z - \u001b[31merror\u001b[39m: [openstreetmap] category_mapper error\n\u001b[0m\u001b[91m2023-01-05T11:11:53.384Z - \u001b[31merror\u001b[39m: [openstreetmap] Error: test\n    at Document.doc.getMeta (/code/pelias/openstreetmap/test/stream/category_mapper.js:178:37)\n    at DestroyableTransform._transform (/code/pelias/openstreetmap/stream/category_mapper.js:32:22)\n    at DestroyableTransform.Transform._read (/code/pelias/openstreetmap/node_modules/through2/node_modules/readable-stream/lib/_stream_transform.js:177:10)\n    at DestroyableTransform.Transform._write (/code/pelias/openstreetmap/node_modules/through2/node_modules/readable-stream/lib/_stream_transform.js:164:83)\n    at doWrite (/code/pelias/openstreetmap/node_modules/through2/node_modules/readable-stream/lib/_stream_writable.js:409:139)\n    at writeOrBuffer (/code/pelias/openstreetmap/node_modules/through2/node_modules/readable-stream/lib/_stream_writable.js:398:5)\n    at DestroyableTransform.Writable.write (/code/pelias/openstreetmap/node_modules/through2/node_modules/readable-stream/lib/_stream_writable.js:307:11)\n    at Test.<anonymous> (/code/pelias/openstreetmap/test/stream/category_mapper.js:186:12)\n    at Test.bound [as _cb] (/code/pelias/openstreetmap/node_modules/tape/lib/test.js:95:17)\n    at Test.run (/code/pelias/openstreetmap/node_modules/tape/lib/test.js:115:28)\n\u001b[0m\u001b[91m2023-01-05T11:11:53.384Z - \u001b[31merror\u001b[39m: [openstreetmap] {\n  \"name\": {},\n  \"parent\": {},\n  \"address_parts\": {},\n  \"center_point\": {},\n  \"category\": [],\n  \"addendum\": {},\n  \"source\": \"osm\",\n  \"layer\": \"a\",\n  \"source_id\": \"1\"\n}\n\u001b[0m    ✔ doc passthrough\n\n  category_mapper: errors - ignore empty tags\n\n    ✔ ignore empty tags\n\n  category_mapper: errors - tab only value\n\n    ✔ remove tabs\n\n  category_mapper: errors - newline only value\n\n    ✔ remove newlines\n\n  addendum_mapper: interface: factory\n\n    ✔ stream factory\n\n  addendum_mapper: interface: stream\n\n    ✔ valid stream\n    ✔ valid readable\n    ✔ valid writeable\n\n  addendum_mapper: maps - wheelchair\n\n    ✔ correctly mapped\n\n  addendum_mapper: maps - iata\n\n    ✔ correctly mapped\n\n  addendum_mapper: maps - icao\n\n    ✔ correctly mapped\n\n  addendum_mapper: maps - wikidata\n\n    ✔ correctly mapped\n\n  addendum_mapper: maps - wikipedia\n\n    ✔ correctly mapped\n\n  addendum_mapper: maps - brand\n\n    ✔ correctly mapped\n\n  addendum_mapper: maps - operator\n\n    ✔ correctly mapped\n\n  addendum_mapper: maps - website\n\n    ✔ correctly mapped\n\n  addendum_mapper: maps - phone\n\n    ✔ correctly mapped\n\n  addendum_mapper: maps - opening_hours\n\n    ✔ correctly mapped\n\n  addendum_mapper: errors - catch thrown errors\n\n\u001b[91m2023-01-05T11:11:53.389Z - \u001b[31merror\u001b[39m: [openstreetmap] addendum_mapper error\n\u001b[0m\u001b[91m2023-01-05T11:11:53.389Z - \u001b[31merror\u001b[39m: [openstreetmap] Error: test\n    at Document.doc.getMeta (/code/pelias/openstreetmap/test/stream/addendum_mapper.js:176:39)\n    at DestroyableTransform._transform (/code/pelias/openstreetmap/stream/addendum_mapper.js:35:22)\n    at DestroyableTransform.Transform._read (/code/pelias/openstreetmap/node_modules/through2/node_modules/readable-stream/lib/_stream_transform.js:177:10)\n    at DestroyableTransform.Transform._write (/code/pelias/openstreetmap/node_modules/through2/node_modules/readable-stream/lib/_stream_transform.js:164:83)\n    at doWrite (/code/pelias/openstreetmap/node_modules/through2/node_modules/readable-stream/lib/_stream_writable.js:409:139)\n    at writeOrBuffer (/code/pelias/openstreetmap/node_modules/through2/node_modules/readable-stream/lib/_stream_writable.js:398:5)\n    at DestroyableTransform.Writable.write (/code/pelias/openstreetmap/node_modules/through2/node_modules/readable-stream/lib/_stream_writable.js:307:11)\n    at Test.<anonymous> (/code/pelias/openstreetmap/test/stream/addendum_mapper.js:184:12)\n    at Test.bound [as _cb] (/code/pelias/openstreetmap/node_modules/tape/lib/test.js:95:17)\n    at Test.run (/code/pelias/openstreetmap/node_modules/tape/lib/test.js:115:28)\n\u001b[0m\u001b[91m2023-01-05T11:11:53.389Z - \u001b[31merror\u001b[39m: [openstreetmap] {\n  \"name\": {},\n  \"parent\": {},\n  \"address_parts\": {},\n  \"center_point\": {},\n  \"category\": [],\n  \"addendum\": {},\n  \"source\": \"osm\",\n  \"layer\": \"a\",\n  \"source_id\": \"1\"\n}\n\u001b[0m    ✔ doc passthrough\n\n  addendum_mapper: errors - ignore empty tags\n\n    ✔ ignore empty tags\n\n  addendum_mapper: errors - tab only value\n\n    ✔ remove tabs\n\n  addendum_mapper: errors - newline only value\n\n    ✔ remove newlines\n\n  popularity_mapper: interface: factory\n\n    ✔ stream factory\n\n  popularity_mapper: interface: stream\n\n    ✔ valid stream\n    ✔ valid readable\n    ✔ valid writeable\n\n  popularity_mapper: maps - importance_international\n\n    ✔ correctly mapped\n\n  popularity_mapper: maps - importance_national\n\n    ✔ correctly mapped\n\n  popularity_mapper: maps - wikidata\n\n    ✔ correctly mapped\n\n  popularity_mapper: maps - wikipedia\n\n    ✔ correctly mapped\n\n  popularity_mapper: maps - building:hospital\n\n    ✔ correctly mapped\n\n  popularity_mapper: maps - tourism:aquarium\n\n    ✔ correctly mapped\n\n  popularity_mapper: maps - amenity:post_office\n\n    ✔ correctly mapped\n\n  popularity_mapper: maps - contact:phone\n\n    ✔ correctly mapped\n\n  popularity_mapper: alias - international airport\n\n    ✔ should be deeply equivalent\n\n  popularity_mapper: alias - regional airport (invalid IATA code)\n\n    ✔ should be deeply equivalent\n\n  popularity_mapper: alias - railway station\n\n    ✔ should be deeply equivalent\n\n  popularity_mapper: does not map - non-venue\n\n    ✔ no mapping performed\n\n  popularity_mapper: does not map - non-venue\n\n    ✔ should be deeply equivalent\n\n  popularity_mapper: does not map - disused\n\n    2023-01-05T11:11:53.396Z - \u001b[33mwarn\u001b[39m: [openstreetmap] removing record osm:venue:1 (undefined) with popularity -100000\n    ✔ document discarded\n\n  popularity_mapper: does not map - abandoned, removal disabled\n\n    ✔ document NOT discarded\n\n  popularity_mapper: does not map - abandoned, removal enabled\n\n    2023-01-05T11:11:53.399Z - \u001b[33mwarn\u001b[39m: [openstreetmap] removing record osm:venue:1 (undefined) with popularity -100000\n    ✔ document discarded\n\n  popularity_mapper: does not map negative value for - abandoned:amenity=place_of_worship\n\n    ✔ should be deeply equivalent\n\n  popularity_mapper: errors - catch thrown errors\n\n\u001b[91m2023-01-05T11:11:53.400Z - \u001b[31merror\u001b[39m: [openstreetmap] popularity_mapper error\n\u001b[0m\u001b[91m2023-01-05T11:11:53.400Z - \u001b[31merror\u001b[39m: [openstreetmap] Error: test\n    at Document.doc.getMeta (/code/pelias/openstreetmap/test/stream/popularity_mapper.js:315:39)\n    at DestroyableTransform._transform (/code/pelias/openstreetmap/stream/popularity_mapper.js:29:22)\n    at DestroyableTransform.Transform._read (/code/pelias/openstreetmap/node_modules/through2/node_modules/readable-stream/lib/_stream_transform.js:177:10)\n    at DestroyableTransform.Transform._write (/code/pelias/openstreetmap/node_modules/through2/node_modules/readable-stream/lib/_stream_transform.js:164:83)\n    at doWrite (/code/pelias/openstreetmap/node_modules/through2/node_modules/readable-stream/lib/_stream_writable.js:409:139)\n    at writeOrBuffer (/code/pelias/openstreetmap/node_modules/through2/node_modules/readable-stream/lib/_stream_writable.js:398:5)\n    at DestroyableTransform.Writable.write (/code/pelias/openstreetmap/node_modules/through2/node_modules/readable-stream/lib/_stream_writable.js:307:11)\n    at Test.<anonymous> (/code/pelias/openstreetmap/test/stream/popularity_mapper.js:323:12)\n    at Test.bound [as _cb] (/code/pelias/openstreetmap/node_modules/tape/lib/test.js:95:17)\n    at Test.run (/code/pelias/openstreetmap/node_modules/tape/lib/test.js:115:28)\n\u001b[0m\u001b[91m2023-01-05T11:11:53.400Z - \u001b[31merror\u001b[39m: [openstreetmap] {\n  \"name\": {},\n  \"parent\": {},\n  \"address_parts\": {},\n  \"center_point\": {},\n  \"category\": [],\n  \"addendum\": {},\n  \"source\": \"osm\",\n  \"layer\": \"venue\",\n  \"source_id\": \"1\"\n}\n\u001b[0m    ✔ doc passthrough\n\n  document_constructor: interface: factory\n\n    ✔ stream factory\n\n  document_constructor: interface: stream\n\n    ✔ valid stream\n    ✔ valid readable\n    ✔ valid writeable\n\n  document_constructor: instantiate: valid\n\n    ✔ correct proto\n    ✔ correct id\n    ✔ defaults to venue\n\n  document_constructor: model errors: avoid fatal errors\n\n\u001b[91m2023-01-05T11:11:53.401Z - \u001b[31merror\u001b[39m: [openstreetmap] error constructing document model Error: doc without valid id or type\n    at DestroyableTransform._transform (/code/pelias/openstreetmap/stream/document_constructor.js:18:15)\n    at DestroyableTransform.Transform._read (/code/pelias/openstreetmap/node_modules/through2/node_modules/readable-stream/lib/_stream_transform.js:177:10)\n    at DestroyableTransform.Transform._write (/code/pelias/openstreetmap/node_modules/through2/node_modules/readable-stream/lib/_stream_transform.js:164:83)\n    at doWrite (/code/pelias/openstreetmap/node_modules/through2/node_modules/readable-stream/lib/_stream_writable.js:409:139)\n    at writeOrBuffer (/code/pelias/openstreetmap/node_modules/through2/node_modules/readable-stream/lib/_stream_writable.js:398:5)\n    at DestroyableTransform.Writable.write (/code/pelias/openstreetmap/node_modules/through2/node_modules/readable-stream/lib/_stream_writable.js:307:11)\n    at emptyDocument (/code/pelias/openstreetmap/test/stream/document_constructor.js:47:14)\n    at Test.doesNotThrow (/code/pelias/openstreetmap/node_modules/tape/lib/test.js:694:3)\n    at Test.bound [as doesNotThrow] (/code/pelias/openstreetmap/node_modules/tape/lib/test.js:95:17)\n    at Test.<anonymous> (/code/pelias/openstreetmap/test/stream/document_constructor.js:46:7)\n\u001b[0m    ✔ should not throw\n\n  document_constructor: centroid: valid\n\n    ✔ correct centroid\n\n  document_constructor: centroid: invalid\n\n    ✔ no centroid\n\n  document_constructor: centroid: contains zero value\n\n    ✔ accepts zero values\n\n  document_constructor: centroid: from preprocessed centroid property\n\n    ✔ accepts centroid property\n\n  document_constructor: centroid: prefers lat/lon to centroid\n\n    ✔ prefers lat/lon\n\n  document_constructor: bounds: no bbox provided\n\n    ✔ undefined bounds\n\n  document_constructor: bounds: bbox not object\n\n    ✔ undefined bounds\n\n  document_constructor: bounds: valid bbox provided\n\n    ✔ valid bounds\n\n  document_constructor: bounds: partial bbox provided - skip record\n\n\u001b[91m2023-01-05T11:11:53.403Z - \u001b[31merror\u001b[39m: [openstreetmap] error constructing document model PeliasModelError: invalid boundingBox, property 'upperLeft.lon' must be within range -180 to 180\n    at Object.module.exports.boundingBox (/code/pelias/openstreetmap/node_modules/pelias-model/util/valid.js:85:11)\n    at Document.setBoundingBox (/code/pelias/openstreetmap/node_modules/pelias-model/Document.js:601:11)\n    at DestroyableTransform._transform (/code/pelias/openstreetmap/stream/document_constructor.js:45:13)\n    at DestroyableTransform.Transform._read (/code/pelias/openstreetmap/node_modules/through2/node_modules/readable-stream/lib/_stream_transform.js:177:10)\n    at DestroyableTransform.Transform._write (/code/pelias/openstreetmap/node_modules/through2/node_modules/readable-stream/lib/_stream_transform.js:164:83)\n    at doWrite (/code/pelias/openstreetmap/node_modules/through2/node_modules/readable-stream/lib/_stream_writable.js:409:139)\n    at writeOrBuffer (/code/pelias/openstreetmap/node_modules/through2/node_modules/readable-stream/lib/_stream_writable.js:398:5)\n    at DestroyableTransform.Writable.write (/code/pelias/openstreetmap/node_modules/through2/node_modules/readable-stream/lib/_stream_writable.js:307:11)\n    at emptyDocument (/code/pelias/openstreetmap/test/stream/document_constructor.js:138:14)\n    at Test.doesNotThrow (/code/pelias/openstreetmap/node_modules/tape/lib/test.js:694:3)\n\u001b[0m    ✔ should not throw\n\n  document_constructor: tags: valid\n\n    ✔ tags set\n\n  document_constructor: tags: invalid\n\n    ✔ no tags\n\n  importPipeline: interface: pbfParser\n\n    ✔ stream factory\n\n  importPipeline: interface: docConstructor\n\n    ✔ stream factory\n\n  importPipeline: interface: blacklistStream\n\n    ✔ stream factory\n\n  importPipeline: interface: addressesWithoutStreet\n\n    ✔ stream factory\n\n  importPipeline: interface: tagMapper\n\n    ✔ stream factory\n\n  importPipeline: interface: adminLookup\n\n    ✔ stream factory\n\n  importPipeline: interface: addressExtractor\n\n    ✔ stream factory\n\n  importPipeline: interface: categoryMapper\n\n    ✔ stream factory\n\n  importPipeline: interface: addendumMapper\n\n    ✔ stream factory\n\n  importPipeline: interface: popularityMapper\n\n    ✔ stream factory\n\n  importPipeline: interface: dbMapper\n\n    ✔ stream factory\n\n  importPipeline: interface: elasticsearch\n\n    ✔ stream factory\n\n  importPipeline: interface: import\n\n    ✔ stream factory\n\n  importPipeline: interface: stream count\n\n    ✔ correct number of streams\n\n  importPipeline: interface: importPipeline.config.categoryDefaults\n\n    ✔ default mapping object\n\n  pbf: interface: config\n\n    ✔ config function\n\n  pbf: interface: parser\n\n    ✔ stream factory\n\n  pbf: config: load defaults\n\n    ✔ load from settings\n    ✔ load from settings\n\n  pbf: validate: pbf path\n\n    ✔ failed to stat pbf file: defaultDataPath/the/file/does/not/exist.pbf\n\n  pbf: validate: leveldb path\n\n    ✔ failed to stat leveldb path: path/doesnt/exist\n\n  pbf: Disable venues import\n\n    ✔ disable importVenues\n\n  stats: interface: stats\n\n    ✔ stats instance\n    ✔ stream factory\n\n  stats: reset metrics\n\n    ✔ reset metrics\n\n  stats: create proxy: init metric\n\n    ✔ metric initialized\n\n  stats: create proxy: return stream\n\n    ✔ valid stream\n    ✔ valid readable\n    ✔ valid writeable\n\n  stats: proxy: record stats\n\n    ✔ track xform ops\n\n  tag_mapper: interface: factory\n\n    ✔ stream factory\n\n  tag_mapper: interface: stream\n\n    ✔ valid stream\n    ✔ valid readable\n    ✔ valid writeable\n\n  tag_mapper: passthrough: no tags\n\n    ✔ no-op for docs with no tags\n    ✔ no name data mapped\n    ✔ no address data mapped\n\n  tag_mapper: maps - localised names\n\n    ✔ correctly mapped\n    ✔ correctly mapped\n\n  tag_mapper: maps - default name\n\n    ✔ correctly mapped\n\n  tag_mapper: maps - name aliases\n\n    ✔ correctly mapped\n    ✔ correctly mapped\n\n  tag_mapper: rejects - extraneous colon\n\n    ✔ extraneous colon tag ignored\n\n  tag_mapper: rejects - difficult keys\n\n    ✔ all keys rejected\n\n  tag_mapper: maps - localized keys\n\n    ✔ correctly mapped\n    ✔ correctly mapped\n    ✔ correctly mapped\n\n  tag_mapper: maps - use name:official as fallback default\n\n    ✔ official_name used as fallback\n    ✔ correctly mapped\n    ✔ correctly mapped\n\n  tag_mapper: maps - use name:en as fallback default\n\n    ✔ name:en used as fallback\n    ✔ correctly mapped\n    ✔ correctly mapped\n    ✔ correctly mapped\n\n  tag_mapper: maps - unambiguous name:** used as default name fallback\n\n    ✔ only name:** tag used as fallback\n    ✔ correctly mapped\n\n  tag_mapper: maps - ambiguous name:** not used as default name fallback\n\n    ✔ do not try to guess\n\n  tag_mapper: maps - lowercase keys\n\n    ✔ correctly mapped\n\n  tag_mapper: alias - airport codes\n\n    ✔ correctly mapped\n    ✔ correctly mapped\n\n  tag_mapper: maps - osm schema\n\n    ✔ correctly mapped\n\n  tag_mapper: maps - naptan schema\n\n    ✔ correctly mapped\n\n  tag_mapper: maps - karlsruhe schema\n\n    ✔ correctly mapped\n    ✔ correctly mapped\n\n  tag_mapper: norm - contract directionals at end\n\n    ✔ contracted\n\n  tag_mapper: norm - contract directionals at start\n\n    ✔ contracted\n\n  tag_mapper: norm - requires trailing word break\n\n\u001b[91m2023-01-05T11:11:53.419Z - \u001b[31merror\u001b[39m: [openstreetmap] tag_mapper error\n\u001b[0m    ✔ no-op\n\n  tag_mapper: norm - requires leading word break\n\n\u001b[91m2023-01-05T11:11:53.420Z - \u001b[31merror\u001b[39m: [openstreetmap] Error: test\n    at Document.doc.getMeta (/code/pelias/openstreetmap/test/stream/tag_mapper.js:390:37)\n    at DestroyableTransform._transform (/code/pelias/openstreetmap/stream/tag_mapper.js:27:22)\n    at DestroyableTransform.Transform._read (/code/pelias/openstreetmap/node_modules/through2/node_modules/readable-stream/lib/_stream_transform.js:177:10)\n    at DestroyableTransform.Transform._write (/code/pelias/openstreetmap/node_modules/through2/node_modules/readable-stream/lib/_stream_transform.js:164:83)\n    at doWrite (/code/pelias/openstreetmap/node_modules/through2/node_modules/readable-stream/lib/_stream_writable.js:409:139)\n    at writeOrBuffer (/code/pelias/openstreetmap/node_modules/through2/node_modules/readable-stream/lib/_stream_writable.js:398:5)\n    at DestroyableTransform.Writable.write (/code/pelias/openstreetmap/node_modules/through2/node_modules/readable-stream/lib/_stream_writable.js:307:11)\n    at Test.<anonymous> (/code/pelias/openstreetmap/test/stream/tag_mapper.js:398:12)\n    at Test.bound [as _cb] (/code/pelias/openstreetmap/node_modules/tape/lib/test.js:95:17)\n    at Test.run (/code/pelias/openstreetmap/node_modules/tape/lib/test.js:115:28)\n\u001b[0m    ✔ no-op\n\u001b[91m2023-01-05T11:11:53.420Z - \u001b[31merror\u001b[39m: [openstreetmap] {\n  \"name\": {},\n  \"parent\": {},\n  \"address_parts\": {},\n  \"center_point\": {},\n  \"category\": [],\n  \"addendum\": {},\n  \"source\": \"a\",\n  \"layer\": \"b\",\n  \"source_id\": \"1\"\n}\n\u001b[0m\n  tag_mapper: clean - junk chars\n\n    ✔ correctly mapped\n\n  tag_mapper: clean - preserve brackets\n\n    ✔ correctly mapped\n\n  tag_mapper: errors - catch thrown errors\n\n    ✔ doc passthrough\n\n  tag_mapper: errors - ignore empty tags\n\n    ✔ ignore empty tags\n\n  tag_mapper: errors - tab only value\n\n    ✔ remove tabs\n\n  tag_mapper: errors - tab in value\n\n    ✔ remove tabs\n\n  tag_mapper: errors - newline only value\n\n    ✔ remove newlines\n\n  tag_mapper: errors - newline in value\n\n    ✔ remove newlines\n\n  tag_mapper: skip_inherited_enumerable_properties\n\n    ✔ should be falsy\n    ✔ empty\n\n  address_without_street: interface: factory\n\n    ✔ stream factory\n\n  address_without_street: interface: stream\n\n    ✔ valid stream\n    ✔ valid readable\n    ✔ valid writeable\n\n  address_without_street: passthrough: missing addr:housenumber tag\n\n    ✔ tags not modified\n\n  address_without_street: maps - karlsruhe schema with filled street\n\n    ✔ correctly mapped\n\n  address_without_street: maps - karlsruhe schema with empty street and filled place\n\n    ✔ correctly mapped\n\n  address_without_street: maps - karlsruhe schema without street and with filled place\n\n    ✔ correctly mapped\n\n  address_without_street: maps - karlsruhe schema with both street and place\n\n    ✔ correctly mapped\n\n\n  total:     325\n  passing:   325\n  duration:  64ms\n\n\nRemoving intermediate container f8a73a846989\n ---> 2ef390204e9b\nStep 9/9 : USER pelias\n ---> Running in c8a86442519a\nRemoving intermediate container c8a86442519a\n ---> 309f0a4d3502\nSuccessfully built 309f0a4d3502\nSuccessfully tagged openstreetmap:latest\n","stderr":"","imageSize":366763940}}