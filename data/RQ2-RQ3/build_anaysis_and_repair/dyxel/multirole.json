{"repository":"https://github.com/dyxel/multirole","dockerfilePath":"Dockerfile","startTime":1672294001004,"clone":{"stdout":"","stderr":"Cloning into '/tmp/dinghy-analysis/dyxel/multirole'...\n","error":null,"commit":"b36893a4c528ae2ade1d52bf38129f9d3f7c6be8"},"originalBuild":{"startTimestamp":1672294001926,"endTimestamp":1672294124888,"error":null,"stdout":"Sending build context to Docker daemon  693.8kB\r\r\nStep 1/19 : FROM alpine:edge AS base\nedge: Pulling from library/alpine\na71ff8a5264a: Pulling fs layer\na71ff8a5264a: Verifying Checksum\na71ff8a5264a: Download complete\na71ff8a5264a: Pull complete\nDigest: sha256:c223f84e05c23c0571ce8decefef818864869187e1a3ea47719412e205c8c64e\nStatus: Downloaded newer image for alpine:edge\n ---> 121d0da75751\nStep 2/19 : RUN apk add --no-cache boost-filesystem ca-certificates libgit2 libssl1.1 sqlite-libs xz && \trm -rf /var/log/* /tmp/* /var/tmp/*\n ---> Running in 7f51fa6e5be1\nfetch https://dl-cdn.alpinelinux.org/alpine/edge/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/edge/community/x86_64/APKINDEX.tar.gz\n(1/12) Installing libgcc (12.2.1_git20220924-r6)\n(2/12) Installing boost1.81-filesystem (1.81.0-r1)\n(3/12) Installing ca-certificates (20221203-r1)\n(4/12) Installing http-parser (2.9.4-r0)\n(5/12) Installing pcre2 (10.42-r0)\n(6/12) Installing libssh2 (1.10.0-r3)\n(7/12) Installing libgit2 (1.5.0-r2)\n(8/12) Installing libcrypto1.1 (1.1.1s-r0)\n(9/12) Installing libssl1.1 (1.1.1s-r0)\n(10/12) Installing sqlite-libs (3.40.1-r0)\n(11/12) Installing xz-libs (5.4.0-r0)\n(12/12) Installing xz (5.4.0-r0)\nExecuting busybox-1.35.0-r27.trigger\nExecuting ca-certificates-20221203-r1.trigger\nOK: 14 MiB in 27 packages\nRemoving intermediate container 7f51fa6e5be1\n ---> f6d800aafa4f\nStep 3/19 : FROM base AS base-dev\n ---> f6d800aafa4f\nStep 4/19 : RUN apk add --no-cache boost-dev fmt-dev g++ libgit2-dev meson ninja openssl-dev sqlite-dev xz-dev && \trm -rf /var/log/* /tmp/* /var/tmp/*\n ---> Running in 704bb110226f\nfetch https://dl-cdn.alpinelinux.org/alpine/edge/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/edge/community/x86_64/APKINDEX.tar.gz\n(1/95) Upgrading musl (1.2.3-r3 -> 1.2.3-r4)\n(2/95) Upgrading libcrypto3 (3.0.7-r0 -> 3.0.7-r1)\n(3/95) Upgrading libssl3 (3.0.7-r0 -> 3.0.7-r1)\n(4/95) Installing boost1.81-atomic (1.81.0-r1)\n(5/95) Installing boost1.81-chrono (1.81.0-r1)\n(6/95) Installing boost1.81-container (1.81.0-r1)\n(7/95) Installing boost1.81-context (1.81.0-r1)\n(8/95) Installing boost1.81-contract (1.81.0-r1)\n(9/95) Installing boost1.81-coroutine (1.81.0-r1)\n(10/95) Installing boost1.81-date_time (1.81.0-r1)\n(11/95) Installing boost1.81-fiber (1.81.0-r1)\n(12/95) Installing boost1.81-graph (1.81.0-r1)\n(13/95) Installing libbz2 (1.0.8-r4)\n(14/95) Installing zstd-libs (1.5.2-r9)\n(15/95) Installing boost1.81-iostreams (1.81.0-r1)\n(16/95) Installing boost1.81-locale (1.81.0-r1)\n(17/95) Installing boost1.81-thread (1.81.0-r1)\n(18/95) Installing boost1.81-log (1.81.0-r1)\n(19/95) Installing boost1.81-log_setup (1.81.0-r1)\n(20/95) Installing boost1.81-math (1.81.0-r1)\n(21/95) Installing boost1.81-prg_exec_monitor (1.81.0-r1)\n(22/95) Installing boost1.81-program_options (1.81.0-r1)\n(23/95) Installing libexpat (2.5.0-r0)\n(24/95) Installing libffi (3.4.4-r0)\n(25/95) Installing gdbm (1.23-r0)\n(26/95) Installing libstdc++ (12.2.1_git20220924-r6)\n(27/95) Installing mpdecimal (2.5.1-r1)\n(28/95) Installing ncurses-terminfo-base (6.3_p20221224-r0)\n(29/95) Installing ncurses-libs (6.3_p20221224-r0)\n(30/95) Installing readline (8.2.0-r0)\n(31/95) Installing python3 (3.11.1-r2)\n(32/95) Installing boost1.81-python3 (1.81.0-r1)\n(33/95) Installing boost1.81-random (1.81.0-r1)\n(34/95) Installing boost1.81-regex (1.81.0-r1)\n(35/95) Installing boost1.81-serialization (1.81.0-r1)\n(36/95) Installing boost1.81-stacktrace_basic (1.81.0-r1)\n(37/95) Installing boost1.81-stacktrace_noop (1.81.0-r1)\n(38/95) Installing boost1.81-system (1.81.0-r1)\n(39/95) Installing boost1.81-timer (1.81.0-r1)\n(40/95) Installing boost1.81-type_erasure (1.81.0-r1)\n(41/95) Installing boost1.81-unit_test_framework (1.81.0-r1)\n(42/95) Installing boost1.81-url (1.81.0-r1)\n(43/95) Installing boost1.81-wave (1.81.0-r1)\n(44/95) Installing boost1.81-wserialization (1.81.0-r1)\n(45/95) Installing boost1.81-json (1.81.0-r1)\n(46/95) Installing boost1.81-nowide (1.81.0-r1)\n(47/95) Installing boost1.81-libs (1.81.0-r1)\n(48/95) Installing boost1.81 (1.81.0-r1)\n(49/95) Installing linux-headers (6.1.0-r0)\n(50/95) Installing pkgconf (1.9.3-r1)\n(51/95) Installing bzip2-dev (1.0.8-r4)\n(52/95) Installing icu-data-en (72.1-r1)\nExecuting icu-data-en-72.1-r1.post-install\n\u001b[91m*\n* If you need ICU with non-English locales and legacy charset support, install\n* package icu-data-full.\n*\n\u001b[0m(53/95) Installing icu-libs (72.1-r1)\n(54/95) Installing icu (72.1-r1)\n(55/95) Installing icu-dev (72.1-r1)\n(56/95) Installing xz-dev (5.4.0-r0)\n(57/95) Installing zlib-dev (1.2.13-r0)\n(58/95) Installing zstd-dev (1.5.2-r9)\n(59/95) Installing boost1.81-dev (1.81.0-r1)\n(60/95) Installing boost-dev (1.81.0-r1)\n(61/95) Installing fmt (9.1.0-r0)\n(62/95) Installing fmt-dev (9.1.0-r0)\n(63/95) Installing libstdc++-dev (12.2.1_git20220924-r6)\n(64/95) Installing binutils (2.39-r2)\n(65/95) Installing libgomp (12.2.1_git20220924-r6)\n(66/95) Installing libatomic (12.2.1_git20220924-r6)\n(67/95) Installing gmp (6.2.1-r2)\n(68/95) Installing isl25 (0.25-r0)\n(69/95) Installing mpfr4 (4.1.1-r1)\n(70/95) Installing mpc1 (1.3.1-r0)\n(71/95) Installing gcc (12.2.1_git20220924-r6)\n(72/95) Installing musl-dev (1.2.3-r4)\n(73/95) Installing libc-dev (0.7.2-r3)\n(74/95) Installing g++ (12.2.1_git20220924-r6)\n(75/95) Installing openssl-dev (3.0.7-r1)\n(76/95) Installing nghttp2-libs (1.51.0-r0)\n(77/95) Installing nghttp2-dev (1.51.0-r0)\n(78/95) Installing brotli-libs (1.0.9-r10)\n(79/95) Installing brotli (1.0.9-r10)\n(80/95) Installing brotli-dev (1.0.9-r10)\n(81/95) Installing libcurl (7.87.0-r1)\n(82/95) Installing curl-dev (7.87.0-r1)\n(83/95) Installing libssh2-dev (1.10.0-r3)\n(84/95) Installing http-parser-dev (2.9.4-r0)\n(85/95) Installing bsd-compat-headers (0.7.2-r3)\n(86/95) Installing ncurses-dev (6.3_p20221224-r0)\n(87/95) Installing libedit (20221030.3.1-r0)\n(88/95) Installing libedit-dev (20221030.3.1-r0)\n(89/95) Installing libpcre2-16 (10.42-r0)\n(90/95) Installing libpcre2-32 (10.42-r0)\n(91/95) Installing pcre2-dev (10.42-r0)\n(92/95) Installing libgit2-dev (1.5.0-r2)\n(93/95) Installing samurai (1.2-r2)\n(94/95) Installing meson (1.0.0-r0)\n(95/95) Installing sqlite-dev (3.40.1-r0)\nExecuting busybox-1.35.0-r27.trigger\nExecuting ca-certificates-20221203-r1.trigger\nOK: 542 MiB in 119 packages\nRemoving intermediate container 704bb110226f\n ---> cd6b8f89ef51\nStep 5/19 : FROM base-dev AS built\n ---> cd6b8f89ef51\nStep 6/19 : WORKDIR /root/multirole-src\n ---> Running in e38342a2f7a6\nRemoving intermediate container e38342a2f7a6\n ---> c0716602502b\nStep 7/19 : COPY src/ ./src/\n ---> 7720259647aa\nStep 8/19 : COPY meson.build .\n ---> 74e1e02c1cb5\nStep 9/19 : COPY meson_options.txt .\n ---> c9366ae03f36\nStep 10/19 : ENV BOOST_INCLUDEDIR=/usr/include/boost BOOST_LIBRARYDIR=/usr/lib\n ---> Running in f323c2471675\nRemoving intermediate container f323c2471675\n ---> 233ff112ee8d\nStep 11/19 : RUN meson setup build --buildtype=debugoptimized -Doptimization=3 -Db_lto=true -Db_pie=true -Dcpp_link_args=\"-static-libstdc++\" -Dfmt_ho=true && \tcd \"build\" && \tmeson compile && \tobjcopy --only-keep-debug \"hornet\" \"hornet.debug\" && \tstrip --strip-debug --strip-unneeded \"hornet\" && \tobjcopy --add-gnu-debuglink=\"hornet.debug\" \"hornet\" && \tobjcopy --only-keep-debug \"multirole\" \"multirole.debug\" && \tstrip --strip-debug --strip-unneeded \"multirole\" && \tobjcopy --add-gnu-debuglink=\"multirole.debug\" \"multirole\"\n ---> Running in d576c6ce6513\nWARNING: Recommend using either -Dbuildtype or -Doptimization + -Ddebug. Using both is redundant since they override each other. See: https://mesonbuild.com/Builtin-options.html#build-type-options\nThe Meson build system\nVersion: 1.0.0\nSource dir: /root/multirole-src\nBuild dir: /root/multirole-src/build\nBuild type: native build\nProject name: multirole\nProject version: 1.0.2\nC compiler for the host machine: cc (gcc 12.2.1 \"cc (Alpine 12.2.1_git20220924-r6) 12.2.1 20220924\")\nC linker for the host machine: cc ld.bfd 2.39\nC++ compiler for the host machine: c++ (gcc 12.2.1 \"c++ (Alpine 12.2.1_git20220924-r6) 12.2.1 20220924\")\nC++ linker for the host machine: c++ ld.bfd 2.39\nHost machine cpu family: x86_64\nHost machine cpu: x86_64\nLibrary atomic found: YES\nRun-time dependency Boost (found: filesystem) found: YES 1.81.0\nLibrary dl found: YES\nFound pkg-config: /usr/bin/pkg-config (1.9.3)\nRun-time dependency libgit2 found: YES 1.5.0\nRun-time dependency liblzma found: YES 5.4.0\nRun-time dependency openssl found: YES 3.0.7\nLibrary rt found: YES\nRun-time dependency sqlite3 found: YES 3.40.1\nDid not find CMake 'cmake'\nFound CMake: NO\nRun-time dependency libtcmalloc_minimal found: NO (tried pkgconfig and cmake)\nRun-time dependency threads found: YES\nRun-time dependency fmt found: YES 9.1.0\nBuild targets in project: 2\n\nmultirole 1.0.2\n\n  User defined options\n    buildtype    : debugoptimized\n    optimization : 3\n    b_lto        : true\n    b_pie        : true\n    cpp_link_args: -static-libstdc++\n    fmt_ho       : true\n\nFound ninja-1.9 at /usr/bin/ninja\n[1/46] Compiling C++ object hornet.p/src_Hornet_main.cpp.o\n[2/46] Compiling C++ object hornet.p/src_DLOpen.cpp.o\n[3/46] Compiling C++ object multirole.p/src_Multirole_YGOPro_StringUtils.cpp.o\n[4/46] Compiling C++ object multirole.p/src_Multirole_YGOPro_Replay.cpp.o\n[5/46] Compiling C++ object multirole.p/src_Multirole_YGOPro_Deck.cpp.o\n[6/46] Compiling C++ object multirole.p/src_Multirole_YGOPro_CoreUtils.cpp.o\n[7/46] Compiling C++ object multirole.p/src_Multirole_YGOPro_CardDatabase.cpp.o\n[8/46] Compiling C++ object multirole.p/src_Multirole_YGOPro_Banlist.cpp.o\n[9/46] Compiling C++ object multirole.p/src_Multirole_Service_LogHandler_Timestamp.cpp.o\n[10/46] Compiling C++ object multirole.p/src_Multirole_Service_LogHandler_StreamFormat.cpp.o\n[11/46] Compiling C++ object multirole.p/src_Multirole_Service_LogHandler_StdoutSink.cpp.o\n[12/46] Compiling C++ object multirole.p/src_Multirole_Service_LogHandler_StderrSink.cpp.o\n[13/46] Compiling C++ object multirole.p/src_Multirole_Service_LogHandler_FileSink.cpp.o\n[14/46] Compiling C++ object multirole.p/src_Multirole_Service_LogHandler_DiscordWebhookSink.cpp.o\n[15/46] Compiling C++ object multirole.p/src_Multirole_Service_ScriptProvider.cpp.o\n[16/46] Compiling C++ object multirole.p/src_Multirole_Service_ReplayManager.cpp.o\n[17/46] Compiling C++ object multirole.p/src_Multirole_Service_LogHandler.cpp.o\n[18/46] Compiling C++ object multirole.p/src_Multirole_Service_DataProvider.cpp.o\n[19/46] Compiling C++ object multirole.p/src_Multirole_Service_CoreProvider.cpp.o\n[20/46] Compiling C++ object multirole.p/src_Multirole_Service_BanlistProvider.cpp.o\n[21/46] Compiling C++ object multirole.p/src_Multirole_Room_State_Waiting.cpp.o\n[22/46] Compiling C++ object multirole.p/src_Multirole_Room_State_Sidedecking.cpp.o\n[23/46] Compiling C++ object multirole.p/src_Multirole_Room_State_RockPaperScissor.cpp.o\n[24/46] Compiling C++ object multirole.p/src_Multirole_Room_State_Rematching.cpp.o\n[25/46] Compiling C++ object multirole.p/src_Multirole_Room_State_Dueling.cpp.o\n[26/46] Compiling C++ object multirole.p/src_Multirole_Room_State_Closing.cpp.o\n[27/46] Compiling C++ object multirole.p/src_Multirole_Room_State_ChoosingTurn.cpp.o\n[28/46] Compiling C++ object multirole.p/src_Multirole_Room_TimerAggregator.cpp.o\n[29/46] Compiling C++ object multirole.p/src_Multirole_Room_ScriptLogger.cpp.o\n[30/46] Compiling C++ object multirole.p/src_Multirole_Room_Instance.cpp.o\n[31/46] Compiling C++ object multirole.p/src_Multirole_Room_Context.cpp.o\n[32/46] Compiling C++ object multirole.p/src_Multirole_Room_Client.cpp.o\n[33/46] Compiling C++ object multirole.p/src_Multirole_Endpoint_Webhook.cpp.o\n[34/46] Compiling C++ object multirole.p/src_Multirole_Endpoint_RoomHosting.cpp.o\n[35/46] Compiling C++ object multirole.p/src_Multirole_Endpoint_LobbyListing.cpp.o\n[36/46] Compiling C++ object multirole.p/src_Multirole_Core_HornetWrapper.cpp.o\n[37/46] Compiling C++ object multirole.p/src_Multirole_Core_DLWrapper.cpp.o\n[38/46] Compiling C++ object multirole.p/src_Multirole_STOCMsgFactory.cpp.o\n[39/46] Compiling C++ object multirole.p/src_Multirole_main.cpp.o\n[40/46] Compiling C++ object multirole.p/src_Multirole_Lobby.cpp.o\n[41/46] Compiling C++ object multirole.p/src_Multirole_Instance.cpp.o\n[42/46] Compiling C++ object multirole.p/src_Multirole_I18N.cpp.o\n[43/46] Compiling C++ object multirole.p/src_Multirole_GitRepo.cpp.o\n[44/46] Compiling C++ object multirole.p/src_DLOpen.cpp.o\n[45/46] Linking target hornet\n[46/46] Linking target multirole\nlto-wrapper: warning: using serial compilation of 15 LTRANS jobs\nlto-wrapper: note: see the '-flto' option documentation for more information\nIn function '__copy_m',\n    inlined from '__copy_move_a2' at /usr/include/c++/12.2.1/bits/stl_algobase.h:495:30,\n    inlined from '__copy_move_a1' at /usr/include/c++/12.2.1/bits/stl_algobase.h:522:42,\n    inlined from '__copy_move_a' at /usr/include/c++/12.2.1/bits/stl_algobase.h:529:31,\n    inlined from 'copy' at /usr/include/c++/12.2.1/bits/stl_algobase.h:620:7,\n    inlined from '__uninit_copy' at /usr/include/c++/12.2.1/bits/stl_uninitialized.h:147:27,\n    inlined from 'uninitialized_copy' at /usr/include/c++/12.2.1/bits/stl_uninitialized.h:185:15,\n    inlined from '__uninitialized_copy_a' at /usr/include/c++/12.2.1/bits/stl_uninitialized.h:372:37,\n    inlined from '__uninitialized_move_if_noexcept_a' at /usr/include/c++/12.2.1/bits/stl_uninitialized.h:397:2,\n    inlined from '_M_fill_insert' at /usr/include/c++/12.2.1/bits/vector.tcc:594:7,\n    inlined from 'resize' at /usr/include/c++/12.2.1/bits/stl_vector.h:1032:18,\n    inlined from 'SerializeSingleQuery' at ../src/Multirole/YGOPro/CoreUtils.cpp:632:12:\n/usr/include/c++/12.2.1/bits/stl_algobase.h:431:30: warning: '__builtin_memcpy' writing 1 or more bytes into a region of size 0 overflows the destination [-Wstringop-overflow=]\n  431 |             __builtin_memmove(__result, __first, sizeof(_Tp) * _Num);\n      |                              ^\nIn member function 'allocate',\n    inlined from 'allocate' at /usr/include/c++/12.2.1/bits/alloc_traits.h:464:28,\n    inlined from '_M_allocate' at /usr/include/c++/12.2.1/bits/stl_vector.h:378:33,\n    inlined from '_M_fill_insert' at /usr/include/c++/12.2.1/bits/vector.tcc:575:45,\n    inlined from 'resize' at /usr/include/c++/12.2.1/bits/stl_vector.h:1032:18,\n    inlined from 'SerializeSingleQuery' at ../src/Multirole/YGOPro/CoreUtils.cpp:632:12:\n/usr/include/c++/12.2.1/bits/new_allocator.h:137:55: note: at offset 2 into destination object of size 2 allocated by 'operator new'\n  137 |         return static_cast<_Tp*>(_GLIBCXX_OPERATOR_NEW(__n * sizeof(_Tp)));\n      |                                                       ^\nINFO: autodetecting backend as ninja\nINFO: calculating backend command to run: /usr/bin/ninja\nRemoving intermediate container d576c6ce6513\n ---> 294e77c8e016\nStep 12/19 : FROM base\n ---> f6d800aafa4f\nStep 13/19 : WORKDIR /multirole\n ---> Running in 4ea882640997\nRemoving intermediate container 4ea882640997\n ---> dafff27e13d2\nStep 14/19 : COPY etc/config.json .\n ---> 215dea9e6ad9\nStep 15/19 : COPY util/area-zero.sh .\n ---> c5aff6d32009\nStep 16/19 : COPY --from=built /root/multirole-src/build/hornet .\n ---> 5f0c8205cfb0\nStep 17/19 : COPY --from=built /root/multirole-src/build/multirole .\n ---> ef55485a20bf\nStep 18/19 : EXPOSE 7922 7911 34343 62672 49382 43632\n ---> Running in a1731b865bbd\nRemoving intermediate container a1731b865bbd\n ---> 88246618ad19\nStep 19/19 : CMD [ \"./area-zero.sh\" ]\n ---> Running in ee43c45ae77e\nRemoving intermediate container ee43c45ae77e\n ---> 6d65e0411967\nSuccessfully built 6d65e0411967\nSuccessfully tagged multirole:latest\n","stderr":"","imageSize":16421937},"repair":{"violations":[],"repairedDockerfile":"# Install all the runtime dependencies for Multirole.\nFROM alpine:edge AS base\nRUN apk add --no-cache boost-filesystem ca-certificates libgit2 libssl1.1 sqlite-libs xz && \\\n\trm -rf /var/log/* /tmp/* /var/tmp/*\n\n# Install all the development environment that Multirole needs.\nFROM base AS base-dev\nRUN apk add --no-cache boost-dev fmt-dev g++ libgit2-dev meson ninja openssl-dev sqlite-dev xz-dev && \\\n\trm -rf /var/log/* /tmp/* /var/tmp/*\n\n# Build multirole, stripping debug symbols to their own files.\nFROM base-dev AS built\nWORKDIR /root/multirole-src\nCOPY src/ ./src/\nCOPY meson.build .\nCOPY meson_options.txt .\nENV BOOST_INCLUDEDIR=/usr/include/boost BOOST_LIBRARYDIR=/usr/lib\nRUN meson setup build --buildtype=debugoptimized -Doptimization=3 -Db_lto=true -Db_pie=true -Dcpp_link_args=\"-static-libstdc++\" -Dfmt_ho=true && \\\n\tcd \"build\" && \\\n\tmeson compile && \\\n\tobjcopy --only-keep-debug \"hornet\" \"hornet.debug\" && \\\n\tstrip --strip-debug --strip-unneeded \"hornet\" && \\\n\tobjcopy --add-gnu-debuglink=\"hornet.debug\" \"hornet\" && \\\n\tobjcopy --only-keep-debug \"multirole\" \"multirole.debug\" && \\\n\tstrip --strip-debug --strip-unneeded \"multirole\" && \\\n\tobjcopy --add-gnu-debuglink=\"multirole.debug\" \"multirole\"\n\n# Setup the final execution environment.\nFROM base\nWORKDIR /multirole\nCOPY etc/config.json .\nCOPY util/area-zero.sh .\nCOPY --from=built /root/multirole-src/build/hornet .\nCOPY --from=built /root/multirole-src/build/multirole .\nEXPOSE 7922 7911 34343 62672 49382 43632\nCMD [ \"./area-zero.sh\" ]\n"},"endTime":1672294125201}