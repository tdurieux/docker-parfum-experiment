{"repository":"https://github.com/falling-sky/source","dockerfilePath":"Dockerfile","startTime":1672903874339,"endTime":1672904075281,"clone":{"startTime":1672903874340,"stdout":"","stderr":"Cloning into '/tmp/dinghy-analysis/falling-sky/source'...\n","error":null,"endTime":1672903877045,"commit":"5bb8b4fa699602176bc28f3b1bc0a95aeae1e660"},"originalBuild":{"startTime":1672903877132,"endTime":1672903985179,"error":null,"stdout":"Sending build context to Docker daemon  63.69MB\r\r\nStep 1/17 : FROM golang:alpine as builder\n ---> cae57157ceaa\nStep 2/17 : RUN apk add make git rsync curl openssh-client\n ---> Running in 81c0d8c0eed3\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/community/x86_64/APKINDEX.tar.gz\n(1/19) Installing brotli-libs (1.0.9-r9)\n(2/19) Installing nghttp2-libs (1.51.0-r0)\n(3/19) Installing libcurl (7.87.0-r0)\n(4/19) Installing curl (7.87.0-r0)\n(5/19) Installing libexpat (2.5.0-r0)\n(6/19) Installing pcre2 (10.42-r0)\n(7/19) Installing git (2.38.2-r0)\n(8/19) Installing make (4.3-r1)\n(9/19) Installing openssh-keygen (9.1_p1-r1)\n(10/19) Installing ncurses-terminfo-base (6.3_p20221119-r0)\n(11/19) Installing ncurses-libs (6.3_p20221119-r0)\n(12/19) Installing libedit (20221030.3.1-r0)\n(13/19) Installing openssh-client-common (9.1_p1-r1)\n(14/19) Installing openssh-client-default (9.1_p1-r1)\n(15/19) Installing libacl (2.3.1-r1)\n(16/19) Installing lz4-libs (1.9.4-r1)\n(17/19) Installing popt (1.19-r0)\n(18/19) Installing zstd-libs (1.5.2-r9)\n(19/19) Installing rsync (3.2.7-r0)\nExecuting busybox-1.35.0-r29.trigger\nOK: 23 MiB in 35 packages\nRemoving intermediate container 81c0d8c0eed3\n ---> 5f802c973054\nStep 3/17 : COPY . /build\n ---> 4a5c8b5a981f\nStep 4/17 : WORKDIR /build\n ---> Running in 81b3a5087ff7\nRemoving intermediate container 81b3a5087ff7\n ---> d57325dc4480\nStep 5/17 : RUN go install github.com/falling-sky/fsbuilder@latest\n ---> Running in c5e32151d85a\n\u001b[91mgo: downloading github.com/falling-sky/fsbuilder v0.0.0-20220103171850-25e7543f787f\n\u001b[0m\u001b[91mgo: downloading golang.org/x/text v0.3.2\n\u001b[0mRemoving intermediate container c5e32151d85a\n ---> 3fd1a360988b\nStep 6/17 : RUN cd sites && go run parse-sites.go --skip-validation\n ---> Running in 333729e8aa96\nRemoving intermediate container 333729e8aa96\n ---> f6983140180e\nStep 7/17 : RUN ls -l cicd_release ; true\n ---> Running in f56fde8ac29c\n\u001b[91mls: cicd_release: No such file or directory\n\u001b[0mRemoving intermediate container f56fde8ac29c\n ---> 4c7399f7ef2f\nStep 8/17 : RUN ls -l cicd_i18n  ; true\n ---> Running in d84cc4f0612e\n\u001b[91mls: cicd_i18n: No such file or directory\n\u001b[0mRemoving intermediate container d84cc4f0612e\n ---> f233a813293c\nStep 9/17 : RUN if [[ -s cicd_release ]]; then cd sites && go run parse-sites.go || exit 1 ; cat ../templates/js/sites_parsed.js ; fi\n ---> Running in 5f176fb1430b\nRemoving intermediate container 5f176fb1430b\n ---> a64eb4811ad4\nStep 10/17 : RUN if [[ -s cicd_i18n ]]; then ./support/add-build-date ; fi\n ---> Running in c3a5e2792e0a\nRemoving intermediate container c3a5e2792e0a\n ---> d6525e209d50\nStep 11/17 : RUN if [[ -s translations/crowdin.yaml ]]; then cd translations && make || exit 1 ; fi\n ---> Running in e4f4bb1bedcc\nRemoving intermediate container e4f4bb1bedcc\n ---> 51e6aa6ec0f8\nStep 12/17 : RUN fsbuilder\n ---> Running in a33211d9c86c\n\u001b[91m2023/01/05 07:32:53 fsbuilder.go:22: Prepping output\n\u001b[0m\u001b[91m2023/01/05 07:32:53 fsbuilder.go:22: Prepping output/htrev\n\u001b[0m\u001b[91m2023/01/05 07:32:53 signature.go:16: ScanDir(templates/css)\n\u001b[0m\u001b[91m2023/01/05 07:32:53 signature.go:16: ScanDir(templates/js)\n\u001b[0m\u001b[91m2023/01/05 07:32:54 signature.go:16: ScanDir(templates/html)\n\u001b[0m\u001b[91m2023/01/05 07:32:54 signature.go:16: ScanDir(templates/php)\n\u001b[0m\u001b[91m2023/01/05 07:32:54 signature.go:16: ScanDir(templates/apache)\n\u001b[0m\u001b[91m2023/01/05 07:32:54 signature.go:16: ScanDir(templates/apache)\n\u001b[0m\u001b[91m2023/01/05 07:32:54 copy.go:45: copyFiles(images,output/images)\n\u001b[0m\u001b[91m2023/01/05 07:32:54 copy.go:45: copyFiles(images,output/images-nc)\n\u001b[0m\u001b[91m2023/01/05 07:32:54 job.go:385: Waiting for queued jobs to finish\n\u001b[0m\u001b[91m2023/01/05 07:32:54 save.go:33: Generating translations/falling-sky.pot\n\u001b[0mRemoving intermediate container a33211d9c86c\n ---> 2cc34ded34b5\nStep 13/17 : RUN if [[ -s translations/crowdin.yaml ]]; then cd translations && make || exit 1 ; fi\n ---> Running in b66be1aa4bb8\nRemoving intermediate container b66be1aa4bb8\n ---> 0dbc24a0c67a\nStep 14/17 : RUN if [ -s cicd_release ]; then  rsync -a -e \"ssh -o StrictHostKeyChecking=no  -i cicd_release -p 2222\"  output/. fskyweb@rsync.test-ipv6.com:stable/content/. || exit 1 ; fi\n ---> Running in 205cfbbbbfaf\nRemoving intermediate container 205cfbbbbfaf\n ---> e4fa6b898547\nStep 15/17 : RUN if [ -s cicd_i18n    ]; then  rsync -a -e \"ssh -o StrictHostKeyChecking=no  -i cicd_i18n -p 2222\"  output/. fskyweb@rsync.test-ipv6.com:i18n/content/. || exit 1 ; fi\n ---> Running in 8b4885db2638\nRemoving intermediate container 8b4885db2638\n ---> 48774333eecd\nStep 16/17 : FROM scratch\n ---> \nStep 17/17 : COPY --from=builder /bin/true /bin/true\n ---> 6f093f74e5ca\nSuccessfully built 6f093f74e5ca\nSuccessfully tagged source:latest\n","stderr":"","imageSize":841392},"repair":{"startTime":1672903985241,"endTime":1672903985340,"violations":[{"name":"apkAddUseNoCache","position":{"start":11,"end":11,"columnStart":4,"columnEnd":46}}],"repairedDockerfile":"FROM golang:alpine as builder\n\n## This dockerfile is for CI/CD.\n## We use docker as a build method, but we are not shipping docker artifacts.\n##\n## If you wish to save the resulting output, map \"output/\" to\n## a local mount, or do a second stage build that copies \"output/\".\n##\n\n\nRUN apk add --no-cache make git rsync curl openssh-client\n\n\nCOPY . /build\nWORKDIR /build\n\nRUN go install github.com/falling-sky/fsbuilder@latest\n\n# Make sure there is a valid sites file (minimum for beta).\n# Under release and i18n conditions, do a full real check.\nRUN cd sites && go run parse-sites.go --skip-validation\nRUN ls -l cicd_release ; true\nRUN ls -l cicd_i18n  ; true\nRUN if [[ -s cicd_release ]]; then cd sites && go run parse-sites.go || exit 1 ; cat ../templates/js/sites_parsed.js ; fi\nRUN if [[ -s cicd_i18n ]]; then ./support/add-build-date ; fi\n\n# Download?\nRUN if [[ -s translations/crowdin.yaml ]]; then cd translations && make || exit 1 ; fi\n\n# Build the project\nRUN fsbuilder\n\n# Post-processing: translation and uploads\nRUN if [[ -s translations/crowdin.yaml ]]; then cd translations && make || exit 1 ; fi\n\n# Publish\nRUN if [ -s cicd_release ]; then  rsync -a -e \"ssh -o StrictHostKeyChecking=no  -i cicd_release -p 2222\"  output/. fskyweb@rsync.test-ipv6.com:stable/content/. || exit 1 ; fi\nRUN if [ -s cicd_i18n    ]; then  rsync -a -e \"ssh -o StrictHostKeyChecking=no  -i cicd_i18n -p 2222\"  output/. fskyweb@rsync.test-ipv6.com:i18n/content/. || exit 1 ; fi\n\n\n\n\n# We're not really wanting to publish anything.\nFROM scratch\nCOPY --from=builder /bin/true /bin/true\n"},"repairedBuild":{"startTime":1672903985462,"endTime":1672904075030,"error":null,"stdout":"Sending build context to Docker daemon  63.69MB\r\r\nStep 1/17 : FROM golang:alpine as builder\n ---> cae57157ceaa\nStep 2/17 : RUN apk add --no-cache make git rsync curl openssh-client\n ---> Running in 457a89bed86a\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/community/x86_64/APKINDEX.tar.gz\n(1/19) Installing brotli-libs (1.0.9-r9)\n(2/19) Installing nghttp2-libs (1.51.0-r0)\n(3/19) Installing libcurl (7.87.0-r0)\n(4/19) Installing curl (7.87.0-r0)\n(5/19) Installing libexpat (2.5.0-r0)\n(6/19) Installing pcre2 (10.42-r0)\n(7/19) Installing git (2.38.2-r0)\n(8/19) Installing make (4.3-r1)\n(9/19) Installing openssh-keygen (9.1_p1-r1)\n(10/19) Installing ncurses-terminfo-base (6.3_p20221119-r0)\n(11/19) Installing ncurses-libs (6.3_p20221119-r0)\n(12/19) Installing libedit (20221030.3.1-r0)\n(13/19) Installing openssh-client-common (9.1_p1-r1)\n(14/19) Installing openssh-client-default (9.1_p1-r1)\n(15/19) Installing libacl (2.3.1-r1)\n(16/19) Installing lz4-libs (1.9.4-r1)\n(17/19) Installing popt (1.19-r0)\n(18/19) Installing zstd-libs (1.5.2-r9)\n(19/19) Installing rsync (3.2.7-r0)\nExecuting busybox-1.35.0-r29.trigger\nOK: 23 MiB in 35 packages\nRemoving intermediate container 457a89bed86a\n ---> c06ccf75c0b9\nStep 3/17 : COPY . /build\n ---> e0bad9a8eec3\nStep 4/17 : WORKDIR /build\n ---> Running in cca37b23e828\nRemoving intermediate container cca37b23e828\n ---> ec824ed05be9\nStep 5/17 : RUN go install github.com/falling-sky/fsbuilder@latest\n ---> Running in 1d36695f53a2\n\u001b[91mgo: downloading github.com/falling-sky/fsbuilder v0.0.0-20220103171850-25e7543f787f\n\u001b[0m\u001b[91mgo: downloading golang.org/x/text v0.3.2\n\u001b[0mRemoving intermediate container 1d36695f53a2\n ---> 1cfd52c7f16a\nStep 6/17 : RUN cd sites && go run parse-sites.go --skip-validation\n ---> Running in 8663de20992f\nRemoving intermediate container 8663de20992f\n ---> 3ea62e1e66d2\nStep 7/17 : RUN ls -l cicd_release ; true\n ---> Running in 5d01aefc3233\n\u001b[91mls: cicd_release: No such file or directory\n\u001b[0mRemoving intermediate container 5d01aefc3233\n ---> 26f374c4cfbb\nStep 8/17 : RUN ls -l cicd_i18n  ; true\n ---> Running in d41da2fcc4ff\n\u001b[91mls: cicd_i18n: No such file or directory\n\u001b[0mRemoving intermediate container d41da2fcc4ff\n ---> 1fd7597c520c\nStep 9/17 : RUN if [[ -s cicd_release ]]; then cd sites && go run parse-sites.go || exit 1 ; cat ../templates/js/sites_parsed.js ; fi\n ---> Running in a5640a3b5434\nRemoving intermediate container a5640a3b5434\n ---> c08c7006e2d5\nStep 10/17 : RUN if [[ -s cicd_i18n ]]; then ./support/add-build-date ; fi\n ---> Running in 018d8fb743a4\nRemoving intermediate container 018d8fb743a4\n ---> fa0549faeba7\nStep 11/17 : RUN if [[ -s translations/crowdin.yaml ]]; then cd translations && make || exit 1 ; fi\n ---> Running in 035f01b84a40\nRemoving intermediate container 035f01b84a40\n ---> dd332f6f82d6\nStep 12/17 : RUN fsbuilder\n ---> Running in 233cf5078c05\n\u001b[91m2023/01/05 07:34:03 fsbuilder.go:22: Prepping output\n\u001b[0m\u001b[91m2023/01/05 07:34:03 fsbuilder.go:22: Prepping output/htrev\n\u001b[0m\u001b[91m2023/01/05 07:34:03 signature.go:16: ScanDir(templates/css)\n\u001b[0m\u001b[91m2023/01/05 07:34:03 signature.go:16: ScanDir(templates/js)\n\u001b[0m\u001b[91m2023/01/05 07:34:03 signature.go:16: ScanDir(templates/html)\n\u001b[0m\u001b[91m2023/01/05 07:34:03 signature.go:16: ScanDir(templates/php)\n\u001b[0m\u001b[91m2023/01/05 07:34:03 signature.go:16: ScanDir(templates/apache)\n\u001b[0m\u001b[91m2023/01/05 07:34:03 signature.go:16: ScanDir(templates/apache)\n\u001b[0m\u001b[91m2023/01/05 07:34:03 copy.go:45: copyFiles(images,output/images)\n\u001b[0m\u001b[91m2023/01/05 07:34:03 copy.go:45: copyFiles(images,output/images-nc)\n\u001b[0m\u001b[91m2023/01/05 07:34:03 job.go:385: Waiting for queued jobs to finish\n\u001b[0m\u001b[91m2023/01/05 07:34:04 save.go:33: Generating translations/falling-sky.pot\n\u001b[0mRemoving intermediate container 233cf5078c05\n ---> 4ae6cff394bd\nStep 13/17 : RUN if [[ -s translations/crowdin.yaml ]]; then cd translations && make || exit 1 ; fi\n ---> Running in 16da6e575918\nRemoving intermediate container 16da6e575918\n ---> 37ca3070b783\nStep 14/17 : RUN if [ -s cicd_release ]; then  rsync -a -e \"ssh -o StrictHostKeyChecking=no  -i cicd_release -p 2222\"  output/. fskyweb@rsync.test-ipv6.com:stable/content/. || exit 1 ; fi\n ---> Running in 4a84f153a782\nRemoving intermediate container 4a84f153a782\n ---> 2bbe38ac871b\nStep 15/17 : RUN if [ -s cicd_i18n    ]; then  rsync -a -e \"ssh -o StrictHostKeyChecking=no  -i cicd_i18n -p 2222\"  output/. fskyweb@rsync.test-ipv6.com:i18n/content/. || exit 1 ; fi\n ---> Running in 2b5df87b65c3\nRemoving intermediate container 2b5df87b65c3\n ---> 35919660a5c8\nStep 16/17 : FROM scratch\n ---> \nStep 17/17 : COPY --from=builder /bin/true /bin/true\n ---> cc20f774fdec\nSuccessfully built cc20f774fdec\nSuccessfully tagged source:latest\n","stderr":"","imageSize":841392}}