{"repository":"https://github.com/elastic/opbeans-java","dockerfilePath":"Dockerfile","startTime":1672584715865,"clone":{"stdout":"","stderr":"Cloning into '/tmp/dinghy-analysis/elastic/opbeans-java'...\n","error":null,"commit":"027c79d0d076de36e0c9cabfa5b2a9b0081798f1"},"originalBuild":{"startTimestamp":1672584717209,"endTimestamp":1672584959935,"error":null,"stdout":"Sending build context to Docker daemon   8.15MB\r\r\nStep 1/18 : FROM maven:3.8.4-jdk-11\n3.8.4-jdk-11: Pulling from library/maven\ne4d61adff207: Already exists\n4ff1945c672b: Already exists\nff5b10aec998: Already exists\n12de8c754e45: Already exists\n4848edf44506: Pulling fs layer\ne80286f947f6: Pulling fs layer\nfe10bb9a5d5c: Pulling fs layer\ne05364bfdbef: Pulling fs layer\n43107496d3ef: Pulling fs layer\n155263e14622: Pulling fs layer\nfe10bb9a5d5c: Waiting\ne80286f947f6: Waiting\ne05364bfdbef: Waiting\n155263e14622: Waiting\n43107496d3ef: Waiting\n4848edf44506: Waiting\n4848edf44506: Download complete\n4848edf44506: Pull complete\ne80286f947f6: Download complete\ne80286f947f6: Pull complete\ne05364bfdbef: Verifying Checksum\ne05364bfdbef: Download complete\n43107496d3ef: Download complete\n155263e14622: Verifying Checksum\n155263e14622: Download complete\nfe10bb9a5d5c: Verifying Checksum\nfe10bb9a5d5c: Download complete\nfe10bb9a5d5c: Pull complete\ne05364bfdbef: Pull complete\n43107496d3ef: Pull complete\n155263e14622: Pull complete\nDigest: sha256:4b82a5896571897aab610b34c09ac326aa1d4fdf5e6993c41493bf3566a8bef6\nStatus: Downloaded newer image for maven:3.8.4-jdk-11\n ---> 6b42b260678c\nStep 2/18 : WORKDIR /usr/src/java-app\n ---> Running in 87dc12e452d4\nRemoving intermediate container 87dc12e452d4\n ---> b343f7bde2c1\nStep 3/18 : ADD . /usr/src/java-code\n ---> 7db4d6e508a8\nStep 4/18 : WORKDIR /usr/src/java-code/opbeans\n ---> Running in 345924e1e928\nRemoving intermediate container 345924e1e928\n ---> 0d12b3c6d7e3\nStep 5/18 : COPY --from=opbeans/opbeans-frontend:latest /app src/main/resources/public\nlatest: Pulling from opbeans/opbeans-frontend\ndf9b9388f04a: Already exists\n3bf6d7380205: Already exists\n7939e601ee5e: Already exists\n31f0fb9de071: Already exists\n287d34488897: Pulling fs layer\n98268b06c2a4: Pulling fs layer\n4850c0ae87bf: Pulling fs layer\n9ac831ea90d7: Pulling fs layer\n9ac831ea90d7: Waiting\n98268b06c2a4: Verifying Checksum\n98268b06c2a4: Download complete\n4850c0ae87bf: Verifying Checksum\n4850c0ae87bf: Download complete\n287d34488897: Verifying Checksum\n287d34488897: Download complete\n287d34488897: Pull complete\n98268b06c2a4: Pull complete\n4850c0ae87bf: Pull complete\n9ac831ea90d7: Verifying Checksum\n9ac831ea90d7: Download complete\n9ac831ea90d7: Pull complete\nDigest: sha256:66b38be191be21fd11819cfd01d4b4ec6b51c939cc18ce90f94eba212f476c17\nStatus: Downloaded newer image for opbeans/opbeans-frontend:latest\n ---> 37b549952ae9\nStep 6/18 : RUN mvn -q --batch-mode package   -DskipTests   -Dmaven.repo.local=.m2   --no-transfer-progress   -Dmaven.wagon.http.retryHandler.count=3   -Dhttps.protocols=TLSv1.2   -Dhttp.keepAlive=false   -Dmaven.javadoc.skip=true   -Dmaven.gitcommitid.skip=true\n ---> Running in a60cf5a10daf\nRemoving intermediate container a60cf5a10daf\n ---> 947ae288c50e\nStep 7/18 : RUN cp -v /usr/src/java-code/opbeans/target/*.jar /usr/src/java-app/app.jar\n ---> Running in 3262b2bd9878\n'/usr/src/java-code/opbeans/target/opbeans-0.0.1-SNAPSHOT.jar' -> '/usr/src/java-app/app.jar'\nRemoving intermediate container 3262b2bd9878\n ---> 6ae9c53c9d40\nStep 8/18 : FROM adoptopenjdk:14-jre-hotspot AS base\n14-jre-hotspot: Pulling from library/adoptopenjdk\n5d3b2c2d21bb: Already exists\n3fc2062ea667: Already exists\n75adf526d75b: Already exists\n9518218b2233: Pulling fs layer\ne797c3064fb4: Pulling fs layer\n9518218b2233: Verifying Checksum\n9518218b2233: Download complete\n9518218b2233: Pull complete\ne797c3064fb4: Verifying Checksum\ne797c3064fb4: Download complete\ne797c3064fb4: Pull complete\nDigest: sha256:d7fe614f79fb4cc879f5f3be2971a854d6cd6719e5fa0631385a676161342e0a\nStatus: Downloaded newer image for adoptopenjdk:14-jre-hotspot\n ---> 157bb71cd724\nStep 9/18 : RUN export\n ---> Running in bedfc935a45b\nexport HOME='/root'\nexport HOSTNAME='bedfc935a45b'\nexport JAVA_HOME='/opt/java/openjdk'\nexport JAVA_VERSION='jdk-14.0.2+12'\nexport LANG='en_US.UTF-8'\nexport LANGUAGE='en_US:en'\nexport LC_ALL='en_US.UTF-8'\nexport PATH='/opt/java/openjdk/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin'\nexport PWD='/'\nRemoving intermediate container bedfc935a45b\n ---> 8d1ba4d1a3ea\nStep 10/18 : RUN apt-get -qq update  && apt-get install --no-install-recommends -y -qq curl  && rm -f /var/cache/apt/archives/*.deb /var/cache/apt/archives/partial/*.deb /var/cache/apt/*.bin || true\n ---> Running in d48a8d170107\n\u001b[91mdebconf: delaying package configuration, since apt-utils is not installed\n\u001b[0m(Reading database ... \r(Reading database ... 5%\r(Reading database ... 10%\r(Reading database ... 15%\r(Reading database ... 20%\r(Reading database ... 25%\r(Reading database ... 30%\r(Reading database ... 35%\r(Reading database ... 40%\r(Reading database ... 45%\r(Reading database ... 50%\r(Reading database ... 55%\r(Reading database ... 60%\r(Reading database ... 65%\r(Reading database ... 70%\r(Reading database ... 75%\r(Reading database ... 80%\r(Reading database ... 85%\r(Reading database ... 90%\r(Reading database ... 95%\r(Reading database ... 100%\r(Reading database ... 7335 files and directories currently installed.)\r\nPreparing to unpack .../curl_7.68.0-1ubuntu2.14_amd64.deb ...\r\nUnpacking curl (7.68.0-1ubuntu2.14) over (7.68.0-1ubuntu2.4) ...\r\nPreparing to unpack .../libcurl4_7.68.0-1ubuntu2.14_amd64.deb ...\r\nUnpacking libcurl4:amd64 (7.68.0-1ubuntu2.14) over (7.68.0-1ubuntu2.4) ...\r\nSetting up libcurl4:amd64 (7.68.0-1ubuntu2.14) ...\r\nSetting up curl (7.68.0-1ubuntu2.14) ...\r\nProcessing triggers for libc-bin (2.31-0ubuntu9.2) ...\r\nRemoving intermediate container d48a8d170107\n ---> dfb39c85b844\nStep 11/18 : WORKDIR /app\n ---> Running in a91cf2977fe6\nRemoving intermediate container a91cf2977fe6\n ---> 8ab76cb57ad2\nStep 12/18 : COPY --from=0 /usr/src/java-app/*.jar ./\n ---> b962f9d2f6f0\nStep 13/18 : COPY --from=docker.elastic.co/observability/apm-agent-java:1.35.0 /usr/agent/elastic-apm-agent.jar /app/elastic-apm-agent.jar\n1.35.0: Pulling from observability/apm-agent-java\n9123ac7c32f7: Pulling fs layer\ne571ca941a8a: Pulling fs layer\n12b147664655: Pulling fs layer\n72849eae61e1: Pulling fs layer\nc2bc068693dc: Pulling fs layer\nc2bc068693dc: Waiting\n9123ac7c32f7: Verifying Checksum\n9123ac7c32f7: Download complete\n9123ac7c32f7: Pull complete\ne571ca941a8a: Download complete\ne571ca941a8a: Pull complete\n72849eae61e1: Verifying Checksum\n72849eae61e1: Download complete\n12b147664655: Verifying Checksum\n12b147664655: Download complete\nc2bc068693dc: Verifying Checksum\nc2bc068693dc: Download complete\n12b147664655: Pull complete\n72849eae61e1: Pull complete\nc2bc068693dc: Pull complete\nDigest: sha256:81e4597d66a76ddc55b3b065ded1eb336fb5a11a10eccefe624de00fb515915f\nStatus: Downloaded newer image for docker.elastic.co/observability/apm-agent-java:1.35.0\n ---> 033426c5a4da\nStep 14/18 : RUN curl -L https://github.com/open-telemetry/opentelemetry-java-instrumentation/releases/download/v1.10.1/opentelemetry-javaagent.jar --output /app/opentelemetry-javaagent.jar\n ---> Running in 24654f422626\n\u001b[91m  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n             \u001b[0m\u001b[91m                 \u001b[0m\u001b[91m  \u001b[0m\u001b[91m D\u001b[0m\u001b[91mload\u001b[0m\u001b[91m  \u001b[0m\u001b[91mUp\u001b[0m\u001b[91mloa\u001b[0m\u001b[91md \u001b[0m\u001b[91m  \u001b[0m\u001b[91mTot\u001b[0m\u001b[91mal\u001b[0m\u001b[91m  \u001b[0m\u001b[91m Sp\u001b[0m\u001b[91ment \u001b[0m\u001b[91m  \u001b[0m\u001b[91m Le\u001b[0m\u001b[91mft\u001b[0m\u001b[91m  Speed\n\r  0     0    \u001b[0m\u001b[91m0     0    0  \u001b[0m\u001b[91m   0      0\u001b[0m\u001b[91m  \u001b[0m\u001b[91m \u001b[0m\u001b[91m   0 --\u001b[0m\u001b[91m:--:-- --:\u001b[0m\u001b[91m--:-- -\u001b[0m\u001b[91m-\u001b[0m\u001b[91m:-\u001b[0m\u001b[91m-:\u001b[0m\u001b[91m--    \u001b[0m\u001b[91m \u001b[0m\u001b[91m0\u001b[0m\u001b[91m\r  0     0    0     0    \u001b[0m\u001b[91m0     0      \u001b[0m\u001b[91m0   \u001b[0m\u001b[91m   \u001b[0m\u001b[91m0 \u001b[0m\u001b[91m--\u001b[0m\u001b[91m:--\u001b[0m\u001b[91m:-\u001b[0m\u001b[91m- \u001b[0m\u001b[91m--:\u001b[0m\u001b[91m--:\u001b[0m\u001b[91m-- --:--\u001b[0m\u001b[91m:--     0\n\u001b[0m\u001b[91m\r  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\u001b[0m\u001b[91m\r100 11.8M  100 11.8M\u001b[0m\u001b[91m    0     0  12.\u001b[0m\u001b[91m0M   \u001b[0m\u001b[91m   0\u001b[0m\u001b[91m --:\u001b[0m\u001b[91m--:-\u001b[0m\u001b[91m- -\u001b[0m\u001b[91m-:--\u001b[0m\u001b[91m:-\u001b[0m\u001b[91m- -\u001b[0m\u001b[91m-\u001b[0m\u001b[91m:--:-- \u001b[0m\u001b[91m2\u001b[0m\u001b[91m4.6M\u001b[0m\u001b[91m\n\u001b[0mRemoving intermediate container 24654f422626\n ---> 2eb1f53a8fef\nStep 15/18 : LABEL     org.label-schema.schema-version=\"1.0\"     org.label-schema.vendor=\"Elastic\"     org.label-schema.name=\"opbeans-java\"     org.label-schema.version=\"1.35.0\"     org.label-schema.url=\"https://hub.docker.com/r/opbeans/opbeans-java\"     org.label-schema.vcs-url=\"https://github.com/elastic/opbeans-java\"     org.label-schema.license=\"MIT\"\n ---> Running in af6fd82c76f4\nRemoving intermediate container af6fd82c76f4\n ---> f81078ab1e43\nStep 16/18 : COPY ./start.sh .\n ---> 0cf3e527c10f\nStep 17/18 : RUN chmod +x ./start.sh\n ---> Running in cf086d9054f4\nRemoving intermediate container cf086d9054f4\n ---> 11e520734a40\nStep 18/18 : CMD [\"./start.sh\"]\n ---> Running in 566e1266ceec\nRemoving intermediate container 566e1266ceec\n ---> e96e7906172b\nSuccessfully built e96e7906172b\nSuccessfully tagged opbeans-java:latest\n","stderr":"","imageSize":449587094},"repair":{"violations":[{"name":"curlUseFlagF","position":{"start":42,"end":42,"columnStart":4,"columnEnd":176}},{"name":"ruleAptGetInstallThenRemoveAptLists","position":{"start":31,"end":31,"columnStart":4,"columnEnd":55}}],"repairedDockerfile":"#Multi-Stage build\n\n#Build application stage\n#We need maven.\nFROM maven:3.8.4-jdk-11\nWORKDIR /usr/src/java-app\n\n#build the application\nADD . /usr/src/java-code\nWORKDIR /usr/src/java-code/opbeans\n\n#Bring the latest frontend code\nCOPY --from=opbeans/opbeans-frontend:latest /app src/main/resources/public\n\nRUN mvn -q --batch-mode package \\\n  -DskipTests \\\n  -Dmaven.repo.local=.m2 \\\n  --no-transfer-progress \\\n  -Dmaven.wagon.http.retryHandler.count=3 \\\n  -Dhttps.protocols=TLSv1.2 \\\n  -Dhttp.keepAlive=false \\\n  -Dmaven.javadoc.skip=true \\\n  -Dmaven.gitcommitid.skip=true\nRUN cp -v /usr/src/java-code/opbeans/target/*.jar /usr/src/java-app/app.jar\n\n#Run application Stage\n#We only need java\nFROM adoptopenjdk:14-jre-hotspot AS base\n\nRUN export\nRUN apt-get -qq update \\\n && apt-get install --no-install-recommends -y -qq curl \\\n && rm -f /var/cache/apt/archives/*.deb /var/cache/apt/archives/partial/*.deb /var/cache/apt/*.bin || true\n\nWORKDIR /app\nCOPY --from=0 /usr/src/java-app/*.jar ./\n\n# Copy Elastic agent from docker image\n# updated by .ci/bump-version.sh\nCOPY --from=docker.elastic.co/observability/apm-agent-java:1.35.0 /usr/agent/elastic-apm-agent.jar /app/elastic-apm-agent.jar\n\n#Download the opentelemetry agent\nRUN curl -f -L https://github.com/open-telemetry/opentelemetry-java-instrumentation/releases/download/v1.10.1/opentelemetry-javaagent.jar --output /app/opentelemetry-javaagent.jar\n\n# updated by .ci/bump-version.sh\nLABEL \\\n    org.label-schema.schema-version=\"1.0\" \\\n    org.label-schema.vendor=\"Elastic\" \\\n    org.label-schema.name=\"opbeans-java\" \\\n    org.label-schema.version=\"1.35.0\" \\\n    org.label-schema.url=\"https://hub.docker.com/r/opbeans/opbeans-java\" \\\n    org.label-schema.vcs-url=\"https://github.com/elastic/opbeans-java\" \\\n    org.label-schema.license=\"MIT\"\n\nCOPY ./start.sh .\nRUN chmod +x ./start.sh\nCMD [\"./start.sh\"]\n"},"repairedBuild":{"startTimestamp":1672584960335,"endTimestamp":1672585121391,"error":null,"stdout":"Sending build context to Docker daemon   8.15MB\r\r\nStep 1/18 : FROM maven:3.8.4-jdk-11\n ---> 6b42b260678c\nStep 2/18 : WORKDIR /usr/src/java-app\n ---> Running in 7e2bb1fdc012\nRemoving intermediate container 7e2bb1fdc012\n ---> 5064ecfed9de\nStep 3/18 : ADD . /usr/src/java-code\n ---> f7e08162ae26\nStep 4/18 : WORKDIR /usr/src/java-code/opbeans\n ---> Running in 32f213b41e20\nRemoving intermediate container 32f213b41e20\n ---> 8f30af714fbd\nStep 5/18 : COPY --from=opbeans/opbeans-frontend:latest /app src/main/resources/public\n ---> 401c046f209c\nStep 6/18 : RUN mvn -q --batch-mode package   -DskipTests   -Dmaven.repo.local=.m2   --no-transfer-progress   -Dmaven.wagon.http.retryHandler.count=3   -Dhttps.protocols=TLSv1.2   -Dhttp.keepAlive=false   -Dmaven.javadoc.skip=true   -Dmaven.gitcommitid.skip=true\n ---> Running in e8ecae742b16\nRemoving intermediate container e8ecae742b16\n ---> 19a1e2ef41c9\nStep 7/18 : RUN cp -v /usr/src/java-code/opbeans/target/*.jar /usr/src/java-app/app.jar\n ---> Running in 2929a3905ced\n'/usr/src/java-code/opbeans/target/opbeans-0.0.1-SNAPSHOT.jar' -> '/usr/src/java-app/app.jar'\nRemoving intermediate container 2929a3905ced\n ---> e059eac95589\nStep 8/18 : FROM adoptopenjdk:14-jre-hotspot AS base\n ---> 157bb71cd724\nStep 9/18 : RUN export\n ---> Running in b73e81a4d017\nexport HOME='/root'\nexport HOSTNAME='b73e81a4d017'\nexport JAVA_HOME='/opt/java/openjdk'\nexport JAVA_VERSION='jdk-14.0.2+12'\nexport LANG='en_US.UTF-8'\nexport LANGUAGE='en_US:en'\nexport LC_ALL='en_US.UTF-8'\nexport PATH='/opt/java/openjdk/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin'\nexport PWD='/'\nRemoving intermediate container b73e81a4d017\n ---> 90e4c39bd010\nStep 10/18 : RUN apt-get -qq update  && apt-get install --no-install-recommends -y -qq curl  && rm -f /var/cache/apt/archives/*.deb /var/cache/apt/archives/partial/*.deb /var/cache/apt/*.bin || true\n ---> Running in c42fa3282f6c\n\u001b[91mdebconf: delaying package configuration, since apt-utils is not installed\n\u001b[0m(Reading database ... \r(Reading database ... 5%\r(Reading database ... 10%\r(Reading database ... 15%\r(Reading database ... 20%\r(Reading database ... 25%\r(Reading database ... 30%\r(Reading database ... 35%\r(Reading database ... 40%\r(Reading database ... 45%\r(Reading database ... 50%\r(Reading database ... 55%\r(Reading database ... 60%\r(Reading database ... 65%\r(Reading database ... 70%\r(Reading database ... 75%\r(Reading database ... 80%\r(Reading database ... 85%\r(Reading database ... 90%\r(Reading database ... 95%\r(Reading database ... 100%\r(Reading database ... 7335 files and directories currently installed.)\r\nPreparing to unpack .../curl_7.68.0-1ubuntu2.14_amd64.deb ...\r\nUnpacking curl (7.68.0-1ubuntu2.14) over (7.68.0-1ubuntu2.4) ...\r\nPreparing to unpack .../libcurl4_7.68.0-1ubuntu2.14_amd64.deb ...\r\nUnpacking libcurl4:amd64 (7.68.0-1ubuntu2.14) over (7.68.0-1ubuntu2.4) ...\r\nSetting up libcurl4:amd64 (7.68.0-1ubuntu2.14) ...\r\nSetting up curl (7.68.0-1ubuntu2.14) ...\r\nProcessing triggers for libc-bin (2.31-0ubuntu9.2) ...\r\nRemoving intermediate container c42fa3282f6c\n ---> 9b0a70794c5a\nStep 11/18 : WORKDIR /app\n ---> Running in 0be8a607b0d0\nRemoving intermediate container 0be8a607b0d0\n ---> f66fd6b8e6a8\nStep 12/18 : COPY --from=0 /usr/src/java-app/*.jar ./\n ---> 1db433729f36\nStep 13/18 : COPY --from=docker.elastic.co/observability/apm-agent-java:1.35.0 /usr/agent/elastic-apm-agent.jar /app/elastic-apm-agent.jar\n ---> 286338b7e927\nStep 14/18 : RUN curl -f -L https://github.com/open-telemetry/opentelemetry-java-instrumentation/releases/download/v1.10.1/opentelemetry-javaagent.jar --output /app/opentelemetry-javaagent.jar\n ---> Running in e7e54b581e57\n\u001b[91m  % Total    % Received % Xf\u001b[0m\u001b[91merd \u001b[0m\u001b[91m Average Spee\u001b[0m\u001b[91md  \u001b[0m\u001b[91m T\u001b[0m\u001b[91mime\u001b[0m\u001b[91m    Time    \u001b[0m\u001b[91m Tim\u001b[0m\u001b[91me  Cu\u001b[0m\u001b[91mrre\u001b[0m\u001b[91mnt\n    \u001b[0m\u001b[91m       \u001b[0m\u001b[91m    \u001b[0m\u001b[91m   \u001b[0m\u001b[91m   \u001b[0m\u001b[91m     \u001b[0m\u001b[91m    \u001b[0m\u001b[91m   Dloa\u001b[0m\u001b[91md \u001b[0m\u001b[91m U\u001b[0m\u001b[91mpload   Total   Spent   \u001b[0m\u001b[91m Lef\u001b[0m\u001b[91mt \u001b[0m\u001b[91m Spee\u001b[0m\u001b[91md\n\u001b[0m\u001b[91m\r  0\u001b[0m\u001b[91m     0   \u001b[0m\u001b[91m 0    \u001b[0m\u001b[91m 0\u001b[0m\u001b[91m    0     \u001b[0m\u001b[91m0  \u001b[0m\u001b[91m    0\u001b[0m\u001b[91m     \u001b[0m\u001b[91m 0 --:--:-- --\u001b[0m\u001b[91m:--\u001b[0m\u001b[91m:-- --\u001b[0m\u001b[91m:-\u001b[0m\u001b[91m-:-- \u001b[0m\u001b[91m    0\u001b[0m\u001b[91m\r  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\n\u001b[0m\u001b[91m\r100 11.8M  100 11.8M    0     0  21.6M     \u001b[0m\u001b[91m 0 --:--:-- --\u001b[0m\u001b[91m:--:-- --:--:\u001b[0m\u001b[91m-- 21.6M\n\u001b[0mRemoving intermediate container e7e54b581e57\n ---> 30d25dc7d75c\nStep 15/18 : LABEL     org.label-schema.schema-version=\"1.0\"     org.label-schema.vendor=\"Elastic\"     org.label-schema.name=\"opbeans-java\"     org.label-schema.version=\"1.35.0\"     org.label-schema.url=\"https://hub.docker.com/r/opbeans/opbeans-java\"     org.label-schema.vcs-url=\"https://github.com/elastic/opbeans-java\"     org.label-schema.license=\"MIT\"\n ---> Running in 1e8d7d9d8960\nRemoving intermediate container 1e8d7d9d8960\n ---> f74782665f54\nStep 16/18 : COPY ./start.sh .\n ---> 738eb5978f5e\nStep 17/18 : RUN chmod +x ./start.sh\n ---> Running in 7c29fd5690ef\nRemoving intermediate container 7c29fd5690ef\n ---> 15501ca54c95\nStep 18/18 : CMD [\"./start.sh\"]\n ---> Running in 192e3ff776f8\nRemoving intermediate container 192e3ff776f8\n ---> b95695f65a2c\nSuccessfully built b95695f65a2c\nSuccessfully tagged opbeans-java:latest\n","stderr":"","imageSize":449587094},"endTime":1672585121674}