{"repository":"https://github.com/halfer/cd-demo-container","dockerfilePath":"Dockerfile","startTime":1672163346836,"clone":{"stdout":"","stderr":"Cloning into '/tmp/dinghy-analysis/halfer/cd-demo-container'...\n","error":null,"commit":"cc8197ae02c6c2cd58c769f0de2b92f8336d2794"},"originalBuild":{"startTimestamp":1672163347637,"endTimestamp":1672163403227,"error":null,"stdout":"Sending build context to Docker daemon  180.7kB\r\r\nStep 1/15 : FROM alpine:3.8\n3.8: Pulling from library/alpine\n486039affc0a: Pulling fs layer\n486039affc0a: Verifying Checksum\n486039affc0a: Download complete\n486039affc0a: Pull complete\nDigest: sha256:2bb501e6173d9d006e56de5bce2720eb06396803300fe1687b58a7ff32bf4c14\nStatus: Downloaded newer image for alpine:3.8\n ---> c8bccc0af957\nStep 2/15 : RUN apk update\n ---> Running in 71b5df3927ab\nfetch http://dl-cdn.alpinelinux.org/alpine/v3.8/main/x86_64/APKINDEX.tar.gz\nfetch http://dl-cdn.alpinelinux.org/alpine/v3.8/community/x86_64/APKINDEX.tar.gz\nv3.8.5-67-gf94de196ca [http://dl-cdn.alpinelinux.org/alpine/v3.8/main]\nv3.8.5-66-gccbd6a8ae7 [http://dl-cdn.alpinelinux.org/alpine/v3.8/community]\nOK: 9564 distinct packages available\nRemoving intermediate container 71b5df3927ab\n ---> 6dedc51406c7\nStep 3/15 : RUN apk add php-cli php-apache2\n ---> Running in f5d0b2ec37a6\n(1/14) Installing php7-common (7.2.26-r0)\n(2/14) Installing libuuid (2.32-r0)\n(3/14) Installing apr (1.6.3-r1)\n(4/14) Installing expat (2.2.8-r0)\n(5/14) Installing apr-util (1.6.1-r3)\n(6/14) Installing pcre (8.42-r0)\n(7/14) Installing apache2 (2.4.43-r0)\nExecuting apache2-2.4.43-r0.pre-install\n(8/14) Installing ncurses-terminfo-base (6.1_p20180818-r1)\n(9/14) Installing ncurses-terminfo (6.1_p20180818-r1)\n(10/14) Installing ncurses-libs (6.1_p20180818-r1)\n(11/14) Installing libedit (20170329.3.1-r3)\n(12/14) Installing libxml2 (2.9.8-r2)\n(13/14) Installing php7-apache2 (7.2.26-r0)\n(14/14) Installing php7 (7.2.26-r0)\nExecuting busybox-1.28.4-r3.trigger\nOK: 26 MiB in 27 packages\nRemoving intermediate container f5d0b2ec37a6\n ---> 6a7a2837e073\nStep 4/15 : RUN mkdir -p /run/apache2\n ---> Running in 1d43a81ebf40\nRemoving intermediate container 1d43a81ebf40\n ---> 8575e58ebf4a\nStep 5/15 : RUN echo \"ServerName localhost\" > /etc/apache2/conf.d/server-name.conf\n ---> Running in b3efa37b914c\nRemoving intermediate container b3efa37b914c\n ---> 79b2b5e3751d\nStep 6/15 : RUN wget -O /usr/local/bin/dumb-init https://github.com/Yelp/dumb-init/releases/download/v1.2.2/dumb-init_1.2.2_amd64\n ---> Running in f22b425cc4e1\n\u001b[91mConnecting to github.com (140.82.121.3:443)\n\u001b[0m\u001b[91mConnecting to objects.githubusercontent.com (185.199.111.133:443)\n\u001b[0m\u001b[91mdumb-init            100% |*******************************| 54744   0:00:00 ETA\n\n\u001b[0mRemoving intermediate container f22b425cc4e1\n ---> f60ccbdf004b\nStep 7/15 : RUN chmod +x /usr/local/bin/dumb-init\n ---> Running in 15a27d342e04\nRemoving intermediate container 15a27d342e04\n ---> ca1ed8e03938\nStep 8/15 : COPY bin /app/bin\n ---> 0c49523268a1\nStep 9/15 : RUN chmod -R +x /app/bin\n ---> Running in 8579a5fe04ed\nRemoving intermediate container 8579a5fe04ed\n ---> 2d019041835b\nStep 10/15 : RUN rm /var/www/localhost/htdocs/*\n ---> Running in 530de79426a4\nRemoving intermediate container 530de79426a4\n ---> 9a1071124532\nStep 11/15 : COPY web/* /var/www/localhost/htdocs/\n ---> 647b70c35b52\nStep 12/15 : EXPOSE 80\n ---> Running in 557bfcbfd3f7\nRemoving intermediate container 557bfcbfd3f7\n ---> 0f0bbaa9081c\nStep 13/15 : HEALTHCHECK --interval=5s --timeout=5s --start-period=2s --retries=5     CMD wget -qO- http://localhost/health.php > /dev/null || exit 1\n ---> Running in 12be4886cce9\nRemoving intermediate container 12be4886cce9\n ---> 23162192cad8\nStep 14/15 : ENTRYPOINT [\"/usr/local/bin/dumb-init\", \"--\"]\n ---> Running in 2759f30eea17\nRemoving intermediate container 2759f30eea17\n ---> cc2a8e76ed00\nStep 15/15 : CMD [\"sh\", \"/app/bin/container-start.sh\"]\n ---> Running in ae1c2f29de24\nRemoving intermediate container ae1c2f29de24\n ---> d232fa6036a6\nSuccessfully built d232fa6036a6\nSuccessfully tagged cd-demo-container:latest\n","stderr":"","imageSize":22632958},"repair":{"violations":[{"name":"apkAddUseNoCache","position":{"start":6,"end":6,"columnStart":4,"columnEnd":31}}],"repairedDockerfile":"# Docker build script for continuous deployment demo container\n\nFROM alpine:3.8\n\n# Install software\nRUN apk update\nRUN apk add --no-cache php-cli php-apache2\n\n# Prep Apache\nRUN mkdir -p /run/apache2\nRUN echo \"ServerName localhost\" > /etc/apache2/conf.d/server-name.conf\n\n# Add dumb init to improve sig handling (stop time in CircleCI of 10sec is too slow)\nRUN wget -O /usr/local/bin/dumb-init https://github.com/Yelp/dumb-init/releases/download/v1.2.2/dumb-init_1.2.2_amd64\nRUN chmod +x /usr/local/bin/dumb-init\n\n# Copy shell scripts\nCOPY bin /app/bin\nRUN chmod -R +x /app/bin\n\n# Copy contents of a web dir\nRUN rm /var/www/localhost/htdocs/*\nCOPY web/* /var/www/localhost/htdocs/\n\nEXPOSE 80\n\n# The healthcheck is used by the Routing Mesh, during a rolling update, to understand\n# when to avoid a container that is not ready to receive HTTP traffic.\nHEALTHCHECK --interval=5s --timeout=5s --start-period=2s --retries=5 \\\n    CMD wget -qO- http://localhost/health.php > /dev/null || exit 1\n\n# Start the web server\nENTRYPOINT [\"/usr/local/bin/dumb-init\", \"--\"]\nCMD [\"sh\", \"/app/bin/container-start.sh\"]\n"},"repairedBuild":{"startTimestamp":1672163404117,"endTimestamp":1672163460145,"error":null,"stdout":"Sending build context to Docker daemon  180.7kB\r\r\nStep 1/15 : FROM alpine:3.8\n ---> c8bccc0af957\nStep 2/15 : RUN apk update\n ---> Running in e958b7173095\nfetch http://dl-cdn.alpinelinux.org/alpine/v3.8/main/x86_64/APKINDEX.tar.gz\nfetch http://dl-cdn.alpinelinux.org/alpine/v3.8/community/x86_64/APKINDEX.tar.gz\nv3.8.5-67-gf94de196ca [http://dl-cdn.alpinelinux.org/alpine/v3.8/main]\nv3.8.5-66-gccbd6a8ae7 [http://dl-cdn.alpinelinux.org/alpine/v3.8/community]\nOK: 9564 distinct packages available\nRemoving intermediate container e958b7173095\n ---> 00a781010f26\nStep 3/15 : RUN apk add --no-cache php-cli php-apache2\n ---> Running in 60c35e254333\nfetch http://dl-cdn.alpinelinux.org/alpine/v3.8/main/x86_64/APKINDEX.tar.gz\nfetch http://dl-cdn.alpinelinux.org/alpine/v3.8/community/x86_64/APKINDEX.tar.gz\n(1/14) Installing php7-common (7.2.26-r0)\n(2/14) Installing libuuid (2.32-r0)\n(3/14) Installing apr (1.6.3-r1)\n(4/14) Installing expat (2.2.8-r0)\n(5/14) Installing apr-util (1.6.1-r3)\n(6/14) Installing pcre (8.42-r0)\n(7/14) Installing apache2 (2.4.43-r0)\nExecuting apache2-2.4.43-r0.pre-install\n(8/14) Installing ncurses-terminfo-base (6.1_p20180818-r1)\n(9/14) Installing ncurses-terminfo (6.1_p20180818-r1)\n(10/14) Installing ncurses-libs (6.1_p20180818-r1)\n(11/14) Installing libedit (20170329.3.1-r3)\n(12/14) Installing libxml2 (2.9.8-r2)\n(13/14) Installing php7-apache2 (7.2.26-r0)\n(14/14) Installing php7 (7.2.26-r0)\nExecuting busybox-1.28.4-r3.trigger\nOK: 26 MiB in 27 packages\nRemoving intermediate container 60c35e254333\n ---> 808cb60acb51\nStep 4/15 : RUN mkdir -p /run/apache2\n ---> Running in 4048b1d6e18a\nRemoving intermediate container 4048b1d6e18a\n ---> fb5e22b9997c\nStep 5/15 : RUN echo \"ServerName localhost\" > /etc/apache2/conf.d/server-name.conf\n ---> Running in fbda6e7ac8b4\nRemoving intermediate container fbda6e7ac8b4\n ---> 0d5944bee2c9\nStep 6/15 : RUN wget -O /usr/local/bin/dumb-init https://github.com/Yelp/dumb-init/releases/download/v1.2.2/dumb-init_1.2.2_amd64\n ---> Running in f9eacee094d8\n\u001b[91mConnecting to github.com (140.82.121.4:443)\n\u001b[0m\u001b[91mConnecting to objects.githubusercontent.com (185.199.109.133:443)\n\u001b[0m\u001b[91mdumb-init            100% |*******************************| 54744   0:00:00 ETA\n\n\u001b[0mRemoving intermediate container f9eacee094d8\n ---> adeb9a1ac397\nStep 7/15 : RUN chmod +x /usr/local/bin/dumb-init\n ---> Running in 5f852c14b4c0\nRemoving intermediate container 5f852c14b4c0\n ---> f73cb37fe320\nStep 8/15 : COPY bin /app/bin\n ---> 73359320ec4e\nStep 9/15 : RUN chmod -R +x /app/bin\n ---> Running in 7ac0aee0248b\nRemoving intermediate container 7ac0aee0248b\n ---> d90ce267855d\nStep 10/15 : RUN rm /var/www/localhost/htdocs/*\n ---> Running in 700f517c8507\nRemoving intermediate container 700f517c8507\n ---> fc6a4b08aebc\nStep 11/15 : COPY web/* /var/www/localhost/htdocs/\n ---> 42fa47149493\nStep 12/15 : EXPOSE 80\n ---> Running in 2af44ea1b761\nRemoving intermediate container 2af44ea1b761\n ---> 67bf99c9ec06\nStep 13/15 : HEALTHCHECK --interval=5s --timeout=5s --start-period=2s --retries=5     CMD wget -qO- http://localhost/health.php > /dev/null || exit 1\n ---> Running in a90912abcb84\nRemoving intermediate container a90912abcb84\n ---> 05c5e5d474e8\nStep 14/15 : ENTRYPOINT [\"/usr/local/bin/dumb-init\", \"--\"]\n ---> Running in 9d203ec25f7b\nRemoving intermediate container 9d203ec25f7b\n ---> afbfd6f4b719\nStep 15/15 : CMD [\"sh\", \"/app/bin/container-start.sh\"]\n ---> Running in 8739ab447609\nRemoving intermediate container 8739ab447609\n ---> 485e06352b5f\nSuccessfully built 485e06352b5f\nSuccessfully tagged cd-demo-container:latest\n","stderr":"","imageSize":22632958},"endTime":1672163461180}