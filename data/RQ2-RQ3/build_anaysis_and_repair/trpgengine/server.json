{"repository":"https://github.com/trpgengine/server","dockerfilePath":"Dockerfile","startTime":1672623902423,"clone":{"stdout":"","stderr":"Cloning into '/tmp/dinghy-analysis/trpgengine/server'...\n","error":null,"commit":"5de71c8e90c886fd2ebf4e2373ec8eacbd1cf251"},"originalBuild":{"startTimestamp":1672623905308,"endTimestamp":1672624309204,"error":null,"stdout":"Sending build context to Docker daemon  17.77MB\r\r\nStep 1/40 : FROM node:14.15.1-alpine\n14.15.1-alpine: Pulling from library/node\ncbdbe7a5bc2a: Pulling fs layer\nf2ffd52523c3: Pulling fs layer\n48a445fb9d78: Pulling fs layer\n7a27e63388b2: Pulling fs layer\n7a27e63388b2: Waiting\ncbdbe7a5bc2a: Verifying Checksum\ncbdbe7a5bc2a: Download complete\n48a445fb9d78: Verifying Checksum\n48a445fb9d78: Download complete\ncbdbe7a5bc2a: Pull complete\n7a27e63388b2: Verifying Checksum\n7a27e63388b2: Download complete\nf2ffd52523c3: Verifying Checksum\nf2ffd52523c3: Download complete\nf2ffd52523c3: Pull complete\n48a445fb9d78: Pull complete\n7a27e63388b2: Pull complete\nDigest: sha256:d41417bb7fd04744cd159a40632f918c13bc1af3486a848782e1f68af2c3e6cb\nStatus: Downloaded newer image for node:14.15.1-alpine\n ---> 7f1893c3ede0\nStep 2/40 : LABEL maintainer=moonrailgun\n ---> Running in bf3dd6c8b1be\nRemoving intermediate container bf3dd6c8b1be\n ---> dc8218cc354d\nStep 3/40 : LABEL description=\"TRPG Engine Docker Image\"\n ---> Running in 4fa01e043a9c\nRemoving intermediate container 4fa01e043a9c\n ---> b86fc0fc5fc8\nStep 4/40 : WORKDIR /usr/src/app\n ---> Running in b21557118032\nRemoving intermediate container b21557118032\n ---> c0fd47340420\nStep 5/40 : RUN echo \"https://mirror.tuna.tsinghua.edu.cn/alpine/v3.4/main/\" > /etc/apk/repositories\n ---> Running in 7ad41b6e902f\nRemoving intermediate container 7ad41b6e902f\n ---> 9ebfc840dd9a\nStep 6/40 : RUN echo \"http://mirrors.aliyun.com/alpine/v3.8/main/\" >> /etc/apk/repositories\n ---> Running in 1e632318f4ee\nRemoving intermediate container 1e632318f4ee\n ---> 184abb6932ce\nStep 7/40 : RUN echo \"http://mirrors.aliyun.com/alpine/v3.8/community/\" >> /etc/apk/repositories\n ---> Running in e37e2c4ccab3\nRemoving intermediate container e37e2c4ccab3\n ---> 3fa1155fdddb\nStep 8/40 : RUN apk update     && apk upgrade     && apk add --no-cache bash       bash-doc       bash-completion     && rm -rf /var/cache/apk/*     && /bin/bash\n ---> Running in 20f7522c3851\nfetch https://mirror.tuna.tsinghua.edu.cn/alpine/v3.4/main/x86_64/APKINDEX.tar.gz\nfetch http://mirrors.aliyun.com/alpine/v3.8/main/x86_64/APKINDEX.tar.gz\nfetch http://mirrors.aliyun.com/alpine/v3.8/community/x86_64/APKINDEX.tar.gz\nv3.4.6-316-g63ea6d0 [https://mirror.tuna.tsinghua.edu.cn/alpine/v3.4/main/]\nv3.8.5-67-gf94de196ca [http://mirrors.aliyun.com/alpine/v3.8/main/]\nv3.8.5-66-gccbd6a8ae7 [http://mirrors.aliyun.com/alpine/v3.8/community/]\nOK: 14814 distinct packages available\nUpgrading critical system libraries and apk-tools:\n(1/8) Purging ssl_client (1.31.1-r9)\n(2/8) Installing libressl2.7-libcrypto (2.7.5-r0)\n(3/8) Installing libressl2.7-libssl (2.7.5-r0)\n(4/8) Upgrading apk-tools (2.10.5-r0 -> 2.10.6-r0)\n(5/8) Purging libtls-standalone (2.9.1-r0)\n(6/8) Purging ca-certificates-cacert (20191127-r1)\n(7/8) Purging libssl1.1 (1.1.1g-r0)\n(8/8) Purging libcrypto1.1 (1.1.1g-r0)\nExecuting busybox-1.31.1-r9.trigger\nContinuing the upgrade transaction with new apk-tools:\nOK: 6 MiB in 13 packages\nfetch https://mirror.tuna.tsinghua.edu.cn/alpine/v3.4/main/x86_64/APKINDEX.tar.gz\n\u001b[91m139637670550916:error:14007086:SSL routines:CONNECT_CR_CERT:certificate verify failed:ssl_clnt.c:1132:\nWARNING: Ignoring https://mirror.tuna.tsinghua.edu.cn/alpine/v3.4/main/: Permission denied\n\u001b[0mfetch http://mirrors.aliyun.com/alpine/v3.8/main/x86_64/APKINDEX.tar.gz\nfetch http://mirrors.aliyun.com/alpine/v3.8/community/x86_64/APKINDEX.tar.gz\n(1/7) Installing ncurses-terminfo-base (6.1_p20180818-r1)\n(2/7) Installing ncurses-terminfo (6.1_p20180818-r1)\n(3/7) Installing ncurses-libs (6.1_p20180818-r1)\n(4/7) Installing readline (7.0.003-r0)\n(5/7) Installing bash (4.4.19-r1)\nExecuting bash-4.4.19-r1.post-install\n(6/7) Installing bash-completion (2.8-r0)\n(7/7) Installing bash-doc (4.4.19-r1)\nExecuting busybox-1.31.1-r9.trigger\nOK: 19 MiB in 20 packages\nRemoving intermediate container 20f7522c3851\n ---> 9e5389515159\nStep 9/40 : RUN apk add --no-cache python2\n ---> Running in 247bfec3a759\nfetch https://mirror.tuna.tsinghua.edu.cn/alpine/v3.4/main/x86_64/APKINDEX.tar.gz\n\u001b[91m139814651452804:error:14007086:SSL routines:CONNECT_CR_CERT:certificate verify failed:ssl_clnt.c:1132:\nWARNING: Ignoring https://mirror.tuna.tsinghua.edu.cn/alpine/v3.4/main/: Permission denied\n\u001b[0mfetch http://mirrors.aliyun.com/alpine/v3.8/main/x86_64/APKINDEX.tar.gz\nfetch http://mirrors.aliyun.com/alpine/v3.8/community/x86_64/APKINDEX.tar.gz\n(1/6) Installing libbz2 (1.0.6-r7)\n(2/6) Installing expat (2.2.8-r0)\n(3/6) Installing libffi (3.2.1-r4)\n(4/6) Installing gdbm (1.13-r1)\n(5/6) Installing sqlite-libs (3.25.3-r4)\n(6/6) Installing python2 (2.7.15-r3)\nExecuting busybox-1.31.1-r9.trigger\nOK: 58 MiB in 26 packages\nRemoving intermediate container 247bfec3a759\n ---> ac26c20261ff\nStep 10/40 : RUN apk add --no-cache git\n ---> Running in ef3f0692d0a5\nfetch https://mirror.tuna.tsinghua.edu.cn/alpine/v3.4/main/x86_64/APKINDEX.tar.gz\n\u001b[91m139740209102212:error:14007086:SSL routines:CONNECT_CR_CERT:certificate verify failed:ssl_clnt.c:1132:\n\u001b[0m\u001b[91mWARNING: Ignoring https://mirror.tuna.tsinghua.edu.cn/alpine/v3.4/main/: Permission denied\n\u001b[0mfetch http://mirrors.aliyun.com/alpine/v3.8/main/x86_64/APKINDEX.tar.gz\nfetch http://mirrors.aliyun.com/alpine/v3.8/community/x86_64/APKINDEX.tar.gz\n(1/7) Installing ca-certificates (20191127-r2)\n(2/7) Installing nghttp2-libs (1.39.2-r0)\n(3/7) Installing libssh2 (1.9.0-r1)\n(4/7) Installing libcurl (7.61.1-r3)\n(5/7) Installing pcre2 (10.31-r0)\n(6/7) Installing git (2.18.4-r0)\n(7/7) Installing git-bash-completion (2.18.4-r0)\nExecuting busybox-1.31.1-r9.trigger\nExecuting ca-certificates-20191127-r2.trigger\nOK: 73 MiB in 33 packages\nRemoving intermediate container ef3f0692d0a5\n ---> 78732f78b904\nStep 11/40 : RUN apk add make\n ---> Running in 226065f05e50\nfetch https://mirror.tuna.tsinghua.edu.cn/alpine/v3.4/main/x86_64/APKINDEX.tar.gz\n\u001b[91m139840270151044:error:14007086:SSL routines:CONNECT_CR_CERT:certificate verify failed:ssl_clnt.c:1132:\n\u001b[0m\u001b[91mERROR: https://mirror.tuna.tsinghua.edu.cn/alpine/v3.4/main/: Permission denied\nWARNING: Ignoring https://mirror.tuna.tsinghua.edu.cn/alpine/v3.4/main/: No such file or directory\n\u001b[0mfetch http://mirrors.aliyun.com/alpine/v3.8/main/x86_64/APKINDEX.tar.gz\nfetch http://mirrors.aliyun.com/alpine/v3.8/community/x86_64/APKINDEX.tar.gz\n(1/1) Installing make (4.2.1-r2)\nExecuting busybox-1.31.1-r9.trigger\nOK: 73 MiB in 34 packages\nRemoving intermediate container 226065f05e50\n ---> a5a0990b4130\nStep 12/40 : RUN apk add gcc musl-dev g++ zlib-dev\n ---> Running in 79d323136925\nfetch https://mirror.tuna.tsinghua.edu.cn/alpine/v3.4/main/x86_64/APKINDEX.tar.gz\n\u001b[91m140530942664068:error:14007086:SSL routines:CONNECT_CR_CERT:certificate verify failed:ssl_clnt.c:1132:\n\u001b[0m\u001b[91mERROR: https://mirror.tuna.tsinghua.edu.cn/alpine/v3.4/main/: Permission denied\nWARNING: Ignoring https://mirror.tuna.tsinghua.edu.cn/alpine/v3.4/main/: No such file or directory\n\u001b[0m(1/16) Downgrading musl (1.1.24-r2 -> 1.1.19-r11)\n(2/16) Downgrading zlib (1.2.11-r3 -> 1.2.11-r1)\n(3/16) Downgrading libstdc++ (9.3.0-r0 -> 6.4.0-r9)\n(4/16) Installing binutils (2.30-r6)\n(5/16) Installing gmp (6.1.2-r1)\n(6/16) Installing isl (0.18-r0)\n(7/16) Installing libgomp (6.4.0-r9)\n(8/16) Installing libatomic (6.4.0-r9)\n(9/16) Installing pkgconf (1.5.3-r0)\n(10/16) Installing mpfr3 (3.1.5-r1)\n(11/16) Installing mpc1 (1.0.3-r1)\n(12/16) Installing gcc (6.4.0-r9)\n(13/16) Installing musl-dev (1.1.19-r11)\n(14/16) Installing libc-dev (0.7.1-r0)\n(15/16) Installing g++ (6.4.0-r9)\n(16/16) Installing zlib-dev (1.2.11-r1)\nExecuting busybox-1.31.1-r9.trigger\nOK: 227 MiB in 47 packages\nRemoving intermediate container 79d323136925\n ---> 3d816c00d96a\nStep 13/40 : COPY packages/foreach.sh ./packages/\n ---> d344a60753c4\nStep 14/40 : COPY packages/Actor/package.json packages/Actor/yarn.lock ./packages/Actor/\n ---> 3ffd4213dfa8\nStep 15/40 : COPY packages/Bot/package.json packages/Bot/yarn.lock ./packages/Bot/\n ---> 2059159444d2\nStep 16/40 : COPY packages/Chat/package.json packages/Chat/yarn.lock ./packages/Chat/\n ---> 96edc8da9ea4\nStep 17/40 : COPY packages/ChatEmotion/package.json packages/ChatEmotion/yarn.lock ./packages/ChatEmotion/\n ---> d60a116e2036\nStep 18/40 : COPY packages/Core/package.json packages/Core/yarn.lock ./packages/Core/\n ---> 0817c54ec63e\nStep 19/40 : COPY packages/Dashboard/package.json packages/Dashboard/yarn.lock ./packages/Dashboard/\n ---> adb49f981c02\nStep 20/40 : COPY packages/Deploy/package.json packages/Deploy/yarn.lock ./packages/Deploy/\n ---> 52630ec30937\nStep 21/40 : COPY packages/Dice/package.json packages/Dice/yarn.lock ./packages/Dice/\n ---> c4b2e43fc2ca\nStep 22/40 : COPY packages/File/package.json packages/File/yarn.lock ./packages/File/\n ---> 050543290598\nStep 23/40 : COPY packages/Group/package.json packages/Group/yarn.lock ./packages/Group/\n ---> 1a6ffde37d3c\nStep 24/40 : COPY packages/Help/package.json packages/Help/yarn.lock ./packages/Help/\n ---> 78c543e0114f\nStep 25/40 : COPY packages/Info/package.json packages/Info/yarn.lock ./packages/Info/\n ---> c497179f6ebe\nStep 26/40 : COPY packages/Mail/package.json packages/Mail/yarn.lock ./packages/Mail/\n ---> 720c9b0741e5\nStep 27/40 : COPY packages/Note/package.json packages/Note/yarn.lock ./packages/Note/\n ---> 3a471c6f4bc9\nStep 28/40 : COPY packages/Notify/package.json packages/Notify/yarn.lock ./packages/Notify/\n ---> 89690c207141\nStep 29/40 : COPY packages/Player/package.json packages/Player/yarn.lock ./packages/Player/\n ---> df4f3f153f63\nStep 30/40 : COPY packages/QQConnect/package.json packages/QQConnect/yarn.lock ./packages/QQConnect/\n ---> 44bbe5849f19\nStep 31/40 : COPY packages/Report/package.json packages/Report/yarn.lock ./packages/Report/\n ---> 149d24f43aa2\nStep 32/40 : COPY packages/TRPG/package.json packages/TRPG/yarn.lock ./packages/TRPG/\n ---> dde6b159b01d\nStep 33/40 : RUN bash packages/foreach.sh 'yarn install'\n ---> Running in f02af4d72fd4\n开始处理:\\tActor\nyarn install v1.22.5\n[1/4] Resolving packages...\n[2/4] Fetching packages...\n[3/4] Linking dependencies...\n[4/4] Building fresh packages...\nDone in 3.28s.\n开始处理:\\tBot\nyarn install v1.22.5\n[1/4] Resolving packages...\n[2/4] Fetching packages...\n[3/4] Linking dependencies...\n[4/4] Building fresh packages...\nDone in 2.83s.\n开始处理:\\tChat\nyarn install v1.22.5\n[1/4] Resolving packages...\n[2/4] Fetching packages...\n[3/4] Linking dependencies...\n[4/4] Building fresh packages...\nDone in 1.35s.\n开始处理:\\tChatEmotion\nyarn install v1.22.5\n[1/4] Resolving packages...\n[2/4] Fetching packages...\n[3/4] Linking dependencies...\n[4/4] Building fresh packages...\nDone in 1.84s.\n开始处理:\\tCore\nyarn install v1.22.5\n[1/4] Resolving packages...\n[2/4] Fetching packages...\n[3/4] Linking dependencies...\n\u001b[91mwarning \" > graphql-sequelize@9.4.3\" has unmet peer dependency \"sequelize@>=3.0.0\".\n\u001b[0m[4/4] Building fresh packages...\nDone in 51.06s.\n开始处理:\\tDashboard\nyarn install v1.22.5\n[1/4] Resolving packages...\n[2/4] Fetching packages...\n[3/4] Linking dependencies...\n[4/4] Building fresh packages...\nDone in 3.06s.\n开始处理:\\tDeploy\nyarn install v1.22.5\n[1/4] Resolving packages...\n[2/4] Fetching packages...\n[3/4] Linking dependencies...\n[4/4] Building fresh packages...\nDone in 0.80s.\n开始处理:\\tDice\nyarn install v1.22.5\n[1/4] Resolving packages...\n[2/4] Fetching packages...\n[3/4] Linking dependencies...\n[4/4] Building fresh packages...\nDone in 0.16s.\n开始处理:\\tFile\nyarn install v1.22.5\n[1/4] Resolving packages...\n[2/4] Fetching packages...\n[3/4] Linking dependencies...\n[4/4] Building fresh packages...\nDone in 12.94s.\n开始处理:\\tGroup\nyarn install v1.22.5\n[1/4] Resolving packages...\n[2/4] Fetching packages...\n[3/4] Linking dependencies...\n[4/4] Building fresh packages...\nDone in 0.11s.\n开始处理:\\tHelp\nyarn install v1.22.5\n[1/4] Resolving packages...\n[2/4] Fetching packages...\n[3/4] Linking dependencies...\n[4/4] Building fresh packages...\nDone in 0.76s.\n开始处理:\\tInfo\nyarn install v1.22.5\n[1/4] Resolving packages...\n[2/4] Fetching packages...\n[3/4] Linking dependencies...\n[4/4] Building fresh packages...\nDone in 1.15s.\n开始处理:\\tMail\nyarn install v1.22.5\n[1/4] Resolving packages...\n[2/4] Fetching packages...\n[3/4] Linking dependencies...\n[4/4] Building fresh packages...\nDone in 2.31s.\n开始处理:\\tNote\nyarn install v1.22.5\n[1/4] Resolving packages...\n[2/4] Fetching packages...\n[3/4] Linking dependencies...\n[4/4] Building fresh packages...\nDone in 2.92s.\n开始处理:\\tNotify\nyarn install v1.22.5\n[1/4] Resolving packages...\n[2/4] Fetching packages...\n[3/4] Linking dependencies...\n[4/4] Building fresh packages...\nDone in 1.93s.\n开始处理:\\tPlayer\nyarn install v1.22.5\n[1/4] Resolving packages...\n[2/4] Fetching packages...\n[3/4] Linking dependencies...\n[4/4] Building fresh packages...\nDone in 1.52s.\n开始处理:\\tQQConnect\nyarn install v1.22.5\n[1/4] Resolving packages...\n[2/4] Fetching packages...\n[3/4] Linking dependencies...\n[4/4] Building fresh packages...\nDone in 0.79s.\n开始处理:\\tReport\nyarn install v1.22.5\n[1/4] Resolving packages...\n[2/4] Fetching packages...\n[3/4] Linking dependencies...\n[4/4] Building fresh packages...\nDone in 0.09s.\n开始处理:\\tTRPG\nyarn install v1.22.5\n[1/4] Resolving packages...\n[2/4] Fetching packages...\n[3/4] Linking dependencies...\n[4/4] Building fresh packages...\nDone in 1.28s.\n命令 yarn install 执行完毕\nRemoving intermediate container f02af4d72fd4\n ---> 0dd3d28201ce\nStep 34/40 : COPY package.json yarn.lock ./\n ---> c7463e2eb653\nStep 35/40 : RUN yarn install\n ---> Running in 5242b5ea2e9a\nyarn install v1.22.5\n[1/4] Resolving packages...\n[2/4] Fetching packages...\ninfo fsevents@2.3.2: The platform \"linux\" is incompatible with this module.\ninfo \"fsevents@2.3.2\" is an optional dependency and failed compatibility check. Excluding it from installation.\n[3/4] Linking dependencies...\n[4/4] Building fresh packages...\nDone in 44.85s.\nRemoving intermediate container 5242b5ea2e9a\n ---> 2ccfe9fbcf9d\nStep 36/40 : COPY . .\n ---> cd28d4f0d41d\nStep 37/40 : RUN yarn install && yarn run packages:install\n ---> Running in 8ae0918c45e8\nyarn install v1.22.5\n[1/4] Resolving packages...\nsuccess Already up-to-date.\nDone in 0.43s.\nyarn run v1.22.5\n$ bash packages/foreach.sh 'yarn install --registry https://registry.npm.taobao.org'\n开始处理:\\tActor\n[1/4] Resolving packages...\nsuccess Already up-to-date.\n开始处理:\\tBot\n[1/4] Resolving packages...\nsuccess Already up-to-date.\n开始处理:\\tChat\n[1/4] Resolving packages...\nsuccess Already up-to-date.\n开始处理:\\tChatEmotion\n[1/4] Resolving packages...\nsuccess Already up-to-date.\n开始处理:\\tCore\n[1/4] Resolving packages...\nsuccess Already up-to-date.\n开始处理:\\tDashboard\n[1/4] Resolving packages...\nsuccess Already up-to-date.\n开始处理:\\tDeploy\n[1/4] Resolving packages...\nsuccess Already up-to-date.\n开始处理:\\tDice\n[1/4] Resolving packages...\nsuccess Already up-to-date.\n开始处理:\\tFile\n[1/4] Resolving packages...\nsuccess Already up-to-date.\n开始处理:\\tGroup\n[1/4] Resolving packages...\nsuccess Already up-to-date.\n开始处理:\\tHelp\n[1/4] Resolving packages...\nsuccess Already up-to-date.\n开始处理:\\tInfo\n[1/4] Resolving packages...\nsuccess Already up-to-date.\n开始处理:\\tMail\n[1/4] Resolving packages...\nsuccess Already up-to-date.\n开始处理:\\tNote\n[1/4] Resolving packages...\nsuccess Already up-to-date.\n开始处理:\\tNotify\n[1/4] Resolving packages...\nsuccess Already up-to-date.\n开始处理:\\tOAuth\n[1/4] Resolving packages...\n[2/4] Fetching packages...\n[3/4] Linking dependencies...\n[4/4] Building fresh packages...\nsuccess Saved lockfile.\n开始处理:\\tPlayer\n[1/4] Resolving packages...\nsuccess Already up-to-date.\n开始处理:\\tQQConnect\n[1/4] Resolving packages...\nsuccess Already up-to-date.\n开始处理:\\tReport\n[1/4] Resolving packages...\nsuccess Already up-to-date.\n开始处理:\\tTRPG\n[1/4] Resolving packages...\nsuccess Already up-to-date.\n命令 yarn install --registry https://registry.npm.taobao.org 执行完毕\nDone in 5.12s.\nRemoving intermediate container 8ae0918c45e8\n ---> 08f107db0257\nStep 38/40 : EXPOSE 23256\n ---> Running in 54796c7b7ecd\nRemoving intermediate container 54796c7b7ecd\n ---> 85d3c6b3b988\nStep 39/40 : ENV NODE_ENV production\n ---> Running in 07d7b862b47e\nRemoving intermediate container 07d7b862b47e\n ---> 57cc77a228a3\nStep 40/40 : CMD yarn run pro\n ---> Running in d7bc16410b68\nRemoving intermediate container d7bc16410b68\n ---> 4bab07b78ba6\nSuccessfully built 4bab07b78ba6\nSuccessfully tagged server:latest\n","stderr":"","imageSize":984063241},"repair":{"violations":[{"name":"apkAddUseNoCache","position":{"start":30,"end":30,"columnStart":4,"columnEnd":16}},{"name":"apkAddUseNoCache","position":{"start":31,"end":31,"columnStart":4,"columnEnd":37}}],"repairedDockerfile":"FROM node:14.15.1-alpine\n\nLABEL maintainer=moonrailgun\nLABEL description=\"TRPG Engine Docker Image\"\n\nWORKDIR /usr/src/app\n\n# # 更新到最新版本的yarn\n# RUN npm install -g yarn@latest\n\nRUN echo \"https://mirror.tuna.tsinghua.edu.cn/alpine/v3.4/main/\" > /etc/apk/repositories\nRUN echo \"http://mirrors.aliyun.com/alpine/v3.8/main/\" >> /etc/apk/repositories\nRUN echo \"http://mirrors.aliyun.com/alpine/v3.8/community/\" >> /etc/apk/repositories\n\n# 安装Bash\nRUN apk update \\\n    && apk upgrade \\\n    && apk add --no-cache bash \\\n      bash-doc \\\n      bash-completion \\\n    && rm -rf /var/cache/apk/* \\\n    && /bin/bash\n\n# 安装Python\nRUN apk add --no-cache python2\n\n# 安装git\nRUN apk add --no-cache git\n\n# 安装gcc\nRUN apk add --no-cache make\nRUN apk add --no-cache gcc musl-dev g++ zlib-dev\n\n\n# node_module cache\nCOPY packages/foreach.sh ./packages/\nCOPY packages/Actor/package.json packages/Actor/yarn.lock ./packages/Actor/\nCOPY packages/Bot/package.json packages/Bot/yarn.lock ./packages/Bot/\nCOPY packages/Chat/package.json packages/Chat/yarn.lock ./packages/Chat/\nCOPY packages/ChatEmotion/package.json packages/ChatEmotion/yarn.lock ./packages/ChatEmotion/\nCOPY packages/Core/package.json packages/Core/yarn.lock ./packages/Core/\nCOPY packages/Dashboard/package.json packages/Dashboard/yarn.lock ./packages/Dashboard/\nCOPY packages/Deploy/package.json packages/Deploy/yarn.lock ./packages/Deploy/\nCOPY packages/Dice/package.json packages/Dice/yarn.lock ./packages/Dice/\nCOPY packages/File/package.json packages/File/yarn.lock ./packages/File/\nCOPY packages/Group/package.json packages/Group/yarn.lock ./packages/Group/\nCOPY packages/Help/package.json packages/Help/yarn.lock ./packages/Help/\nCOPY packages/Info/package.json packages/Info/yarn.lock ./packages/Info/\nCOPY packages/Mail/package.json packages/Mail/yarn.lock ./packages/Mail/\nCOPY packages/Note/package.json packages/Note/yarn.lock ./packages/Note/\nCOPY packages/Notify/package.json packages/Notify/yarn.lock ./packages/Notify/\n# COPY packages/OAuth/package.json packages/OAuth/yarn.lock ./packages/OAuth/\nCOPY packages/Player/package.json packages/Player/yarn.lock ./packages/Player/\nCOPY packages/QQConnect/package.json packages/QQConnect/yarn.lock ./packages/QQConnect/\nCOPY packages/Report/package.json packages/Report/yarn.lock ./packages/Report/\nCOPY packages/TRPG/package.json packages/TRPG/yarn.lock ./packages/TRPG/\nRUN bash packages/foreach.sh 'yarn install'\n\n# 先安装子模块的依赖再安装外部依赖。因为每次升级外部package.json必然会丢失缓存\nCOPY package.json yarn.lock ./\nRUN yarn install\n\nCOPY . .\n# 再更新一遍防止上面没有缓存的包\nRUN yarn install && yarn run packages:install\n\nEXPOSE 23256\n\nENV NODE_ENV production\nCMD yarn run pro\n# CMD echo '测试'\n"},"repairedBuild":{"startTimestamp":1672624311446,"endTimestamp":1672624664666,"error":null,"stdout":"Sending build context to Docker daemon  17.77MB\r\r\nStep 1/40 : FROM node:14.15.1-alpine\n ---> 7f1893c3ede0\nStep 2/40 : LABEL maintainer=moonrailgun\n ---> Running in 9670663b3dd4\nRemoving intermediate container 9670663b3dd4\n ---> f8e66bb712db\nStep 3/40 : LABEL description=\"TRPG Engine Docker Image\"\n ---> Running in 7761533d3d90\nRemoving intermediate container 7761533d3d90\n ---> 1fa8a4c7d923\nStep 4/40 : WORKDIR /usr/src/app\n ---> Running in 82c46394247d\nRemoving intermediate container 82c46394247d\n ---> 6d1fef672201\nStep 5/40 : RUN echo \"https://mirror.tuna.tsinghua.edu.cn/alpine/v3.4/main/\" > /etc/apk/repositories\n ---> Running in 06fde0859854\nRemoving intermediate container 06fde0859854\n ---> 161be013769d\nStep 6/40 : RUN echo \"http://mirrors.aliyun.com/alpine/v3.8/main/\" >> /etc/apk/repositories\n ---> Running in ba687b164606\nRemoving intermediate container ba687b164606\n ---> b27daac02ec0\nStep 7/40 : RUN echo \"http://mirrors.aliyun.com/alpine/v3.8/community/\" >> /etc/apk/repositories\n ---> Running in e88166ad1f13\nRemoving intermediate container e88166ad1f13\n ---> e8bd06ef22d4\nStep 8/40 : RUN apk update     && apk upgrade     && apk add --no-cache bash       bash-doc       bash-completion     && rm -rf /var/cache/apk/*     && /bin/bash\n ---> Running in ba10353ef47f\nfetch https://mirror.tuna.tsinghua.edu.cn/alpine/v3.4/main/x86_64/APKINDEX.tar.gz\nfetch http://mirrors.aliyun.com/alpine/v3.8/main/x86_64/APKINDEX.tar.gz\nfetch http://mirrors.aliyun.com/alpine/v3.8/community/x86_64/APKINDEX.tar.gz\nv3.4.6-316-g63ea6d0 [https://mirror.tuna.tsinghua.edu.cn/alpine/v3.4/main/]\nv3.8.5-67-gf94de196ca [http://mirrors.aliyun.com/alpine/v3.8/main/]\nv3.8.5-66-gccbd6a8ae7 [http://mirrors.aliyun.com/alpine/v3.8/community/]\nOK: 14814 distinct packages available\nUpgrading critical system libraries and apk-tools:\n(1/8) Purging ssl_client (1.31.1-r9)\n(2/8) Installing libressl2.7-libcrypto (2.7.5-r0)\n(3/8) Installing libressl2.7-libssl (2.7.5-r0)\n(4/8) Upgrading apk-tools (2.10.5-r0 -> 2.10.6-r0)\n(5/8) Purging libtls-standalone (2.9.1-r0)\n(6/8) Purging ca-certificates-cacert (20191127-r1)\n(7/8) Purging libssl1.1 (1.1.1g-r0)\n(8/8) Purging libcrypto1.1 (1.1.1g-r0)\nExecuting busybox-1.31.1-r9.trigger\nContinuing the upgrade transaction with new apk-tools:\nOK: 6 MiB in 13 packages\nfetch https://mirror.tuna.tsinghua.edu.cn/alpine/v3.4/main/x86_64/APKINDEX.tar.gz\n\u001b[91m139866440195460:error:14007086:SSL routines:CONNECT_CR_CERT:certificate verify failed:ssl_clnt.c:1132:\nWARNING: Ignoring https://mirror.tuna.tsinghua.edu.cn/alpine/v3.4/main/: Permission denied\n\u001b[0mfetch http://mirrors.aliyun.com/alpine/v3.8/main/x86_64/APKINDEX.tar.gz\nfetch http://mirrors.aliyun.com/alpine/v3.8/community/x86_64/APKINDEX.tar.gz\n(1/7) Installing ncurses-terminfo-base (6.1_p20180818-r1)\n(2/7) Installing ncurses-terminfo (6.1_p20180818-r1)\n(3/7) Installing ncurses-libs (6.1_p20180818-r1)\n(4/7) Installing readline (7.0.003-r0)\n(5/7) Installing bash (4.4.19-r1)\nExecuting bash-4.4.19-r1.post-install\n(6/7) Installing bash-completion (2.8-r0)\n(7/7) Installing bash-doc (4.4.19-r1)\nExecuting busybox-1.31.1-r9.trigger\nOK: 19 MiB in 20 packages\nRemoving intermediate container ba10353ef47f\n ---> bee2ce7d4c5a\nStep 9/40 : RUN apk add --no-cache python2\n ---> Running in 2ad2bab228bc\nfetch https://mirror.tuna.tsinghua.edu.cn/alpine/v3.4/main/x86_64/APKINDEX.tar.gz\n\u001b[91m140305361911172:error:14007086:SSL routines:CONNECT_CR_CERT:certificate verify failed:ssl_clnt.c:1132:\n\u001b[0m\u001b[91mWARNING: Ignoring https://mirror.tuna.tsinghua.edu.cn/alpine/v3.4/main/: Permission denied\n\u001b[0mfetch http://mirrors.aliyun.com/alpine/v3.8/main/x86_64/APKINDEX.tar.gz\nfetch http://mirrors.aliyun.com/alpine/v3.8/community/x86_64/APKINDEX.tar.gz\n(1/6) Installing libbz2 (1.0.6-r7)\n(2/6) Installing expat (2.2.8-r0)\n(3/6) Installing libffi (3.2.1-r4)\n(4/6) Installing gdbm (1.13-r1)\n(5/6) Installing sqlite-libs (3.25.3-r4)\n(6/6) Installing python2 (2.7.15-r3)\nExecuting busybox-1.31.1-r9.trigger\nOK: 58 MiB in 26 packages\nRemoving intermediate container 2ad2bab228bc\n ---> ab150f0777f2\nStep 10/40 : RUN apk add --no-cache git\n ---> Running in f2cc1496e09d\nfetch https://mirror.tuna.tsinghua.edu.cn/alpine/v3.4/main/x86_64/APKINDEX.tar.gz\n\u001b[91m140254427008388:error:14007086:SSL routines:CONNECT_CR_CERT:certificate verify failed:ssl_clnt.c:1132:\nWARNING: Ignoring https://mirror.tuna.tsinghua.edu.cn/alpine/v3.4/main/: Permission denied\n\u001b[0mfetch http://mirrors.aliyun.com/alpine/v3.8/main/x86_64/APKINDEX.tar.gz\nfetch http://mirrors.aliyun.com/alpine/v3.8/community/x86_64/APKINDEX.tar.gz\n(1/7) Installing ca-certificates (20191127-r2)\n(2/7) Installing nghttp2-libs (1.39.2-r0)\n(3/7) Installing libssh2 (1.9.0-r1)\n(4/7) Installing libcurl (7.61.1-r3)\n(5/7) Installing pcre2 (10.31-r0)\n(6/7) Installing git (2.18.4-r0)\n(7/7) Installing git-bash-completion (2.18.4-r0)\nExecuting busybox-1.31.1-r9.trigger\nExecuting ca-certificates-20191127-r2.trigger\nOK: 73 MiB in 33 packages\nRemoving intermediate container f2cc1496e09d\n ---> cb9837c6a8a2\nStep 11/40 : RUN apk add --no-cache make\n ---> Running in 1e18c4004a94\nfetch https://mirror.tuna.tsinghua.edu.cn/alpine/v3.4/main/x86_64/APKINDEX.tar.gz\n\u001b[91m140261149433220:error:14007086:SSL routines:CONNECT_CR_CERT:certificate verify failed:ssl_clnt.c:1132:\nWARNING: Ignoring https://mirror.tuna.tsinghua.edu.cn/alpine/v3.4/main/: Permission denied\n\u001b[0mfetch http://mirrors.aliyun.com/alpine/v3.8/main/x86_64/APKINDEX.tar.gz\nfetch http://mirrors.aliyun.com/alpine/v3.8/community/x86_64/APKINDEX.tar.gz\n(1/1) Installing make (4.2.1-r2)\nExecuting busybox-1.31.1-r9.trigger\nOK: 73 MiB in 34 packages\nRemoving intermediate container 1e18c4004a94\n ---> 2ee89f62ba30\nStep 12/40 : RUN apk add --no-cache gcc musl-dev g++ zlib-dev\n ---> Running in fa764d088baa\nfetch https://mirror.tuna.tsinghua.edu.cn/alpine/v3.4/main/x86_64/APKINDEX.tar.gz\n\u001b[91m140601687801220:error:14007086:SSL routines:CONNECT_CR_CERT:certificate verify failed:ssl_clnt.c:1132:\nWARNING: Ignoring https://mirror.tuna.tsinghua.edu.cn/alpine/v3.4/main/: Permission denied\n\u001b[0mfetch http://mirrors.aliyun.com/alpine/v3.8/main/x86_64/APKINDEX.tar.gz\nfetch http://mirrors.aliyun.com/alpine/v3.8/community/x86_64/APKINDEX.tar.gz\n(1/16) Downgrading musl (1.1.24-r2 -> 1.1.19-r11)\n(2/16) Downgrading zlib (1.2.11-r3 -> 1.2.11-r1)\n(3/16) Downgrading libstdc++ (9.3.0-r0 -> 6.4.0-r9)\n(4/16) Installing binutils (2.30-r6)\n(5/16) Installing gmp (6.1.2-r1)\n(6/16) Installing isl (0.18-r0)\n(7/16) Installing libgomp (6.4.0-r9)\n(8/16) Installing libatomic (6.4.0-r9)\n(9/16) Installing pkgconf (1.5.3-r0)\n(10/16) Installing mpfr3 (3.1.5-r1)\n(11/16) Installing mpc1 (1.0.3-r1)\n(12/16) Installing gcc (6.4.0-r9)\n(13/16) Installing musl-dev (1.1.19-r11)\n(14/16) Installing libc-dev (0.7.1-r0)\n(15/16) Installing g++ (6.4.0-r9)\n(16/16) Installing zlib-dev (1.2.11-r1)\nExecuting busybox-1.31.1-r9.trigger\nOK: 227 MiB in 47 packages\nRemoving intermediate container fa764d088baa\n ---> 7e78a479f963\nStep 13/40 : COPY packages/foreach.sh ./packages/\n ---> 47df537134c9\nStep 14/40 : COPY packages/Actor/package.json packages/Actor/yarn.lock ./packages/Actor/\n ---> 17e80d881a7f\nStep 15/40 : COPY packages/Bot/package.json packages/Bot/yarn.lock ./packages/Bot/\n ---> 5975e87edef1\nStep 16/40 : COPY packages/Chat/package.json packages/Chat/yarn.lock ./packages/Chat/\n ---> 3bdbc52ca965\nStep 17/40 : COPY packages/ChatEmotion/package.json packages/ChatEmotion/yarn.lock ./packages/ChatEmotion/\n ---> f7d70a3cb8aa\nStep 18/40 : COPY packages/Core/package.json packages/Core/yarn.lock ./packages/Core/\n ---> a334652c42f1\nStep 19/40 : COPY packages/Dashboard/package.json packages/Dashboard/yarn.lock ./packages/Dashboard/\n ---> fa1cf60b4dc4\nStep 20/40 : COPY packages/Deploy/package.json packages/Deploy/yarn.lock ./packages/Deploy/\n ---> e3c8fb4d82b0\nStep 21/40 : COPY packages/Dice/package.json packages/Dice/yarn.lock ./packages/Dice/\n ---> 22d440d215e0\nStep 22/40 : COPY packages/File/package.json packages/File/yarn.lock ./packages/File/\n ---> d7a1a56fd9e3\nStep 23/40 : COPY packages/Group/package.json packages/Group/yarn.lock ./packages/Group/\n ---> 85117846ab18\nStep 24/40 : COPY packages/Help/package.json packages/Help/yarn.lock ./packages/Help/\n ---> e9d29f0fbcf5\nStep 25/40 : COPY packages/Info/package.json packages/Info/yarn.lock ./packages/Info/\n ---> 639be37653d3\nStep 26/40 : COPY packages/Mail/package.json packages/Mail/yarn.lock ./packages/Mail/\n ---> 3c8cee1acc99\nStep 27/40 : COPY packages/Note/package.json packages/Note/yarn.lock ./packages/Note/\n ---> 68e4d2e80f3f\nStep 28/40 : COPY packages/Notify/package.json packages/Notify/yarn.lock ./packages/Notify/\n ---> 8df26b580647\nStep 29/40 : COPY packages/Player/package.json packages/Player/yarn.lock ./packages/Player/\n ---> e702cf966129\nStep 30/40 : COPY packages/QQConnect/package.json packages/QQConnect/yarn.lock ./packages/QQConnect/\n ---> 8fe1f995bd98\nStep 31/40 : COPY packages/Report/package.json packages/Report/yarn.lock ./packages/Report/\n ---> 390971defdea\nStep 32/40 : COPY packages/TRPG/package.json packages/TRPG/yarn.lock ./packages/TRPG/\n ---> d604ae06806a\nStep 33/40 : RUN bash packages/foreach.sh 'yarn install'\n ---> Running in b122ff697757\n开始处理:\\tActor\nyarn install v1.22.5\n[1/4] Resolving packages...\n[2/4] Fetching packages...\n[3/4] Linking dependencies...\n[4/4] Building fresh packages...\nDone in 1.48s.\n开始处理:\\tBot\nyarn install v1.22.5\n[1/4] Resolving packages...\n[2/4] Fetching packages...\n[3/4] Linking dependencies...\n[4/4] Building fresh packages...\nDone in 2.52s.\n开始处理:\\tChat\nyarn install v1.22.5\n[1/4] Resolving packages...\n[2/4] Fetching packages...\n[3/4] Linking dependencies...\n[4/4] Building fresh packages...\nDone in 0.50s.\n开始处理:\\tChatEmotion\nyarn install v1.22.5\n[1/4] Resolving packages...\n[2/4] Fetching packages...\n[3/4] Linking dependencies...\n[4/4] Building fresh packages...\nDone in 0.49s.\n开始处理:\\tCore\nyarn install v1.22.5\n[1/4] Resolving packages...\n[2/4] Fetching packages...\n[3/4] Linking dependencies...\n\u001b[91mwarning \" > graphql-sequelize@9.4.3\" has unmet peer dependency \"sequelize@>=3.0.0\".\n\u001b[0m[4/4] Building fresh packages...\nDone in 33.10s.\n开始处理:\\tDashboard\nyarn install v1.22.5\n[1/4] Resolving packages...\n[2/4] Fetching packages...\n[3/4] Linking dependencies...\n[4/4] Building fresh packages...\nDone in 1.38s.\n开始处理:\\tDeploy\nyarn install v1.22.5\n[1/4] Resolving packages...\n[2/4] Fetching packages...\n[3/4] Linking dependencies...\n[4/4] Building fresh packages...\nDone in 0.53s.\n开始处理:\\tDice\nyarn install v1.22.5\n[1/4] Resolving packages...\n[2/4] Fetching packages...\n[3/4] Linking dependencies...\n[4/4] Building fresh packages...\nDone in 0.10s.\n开始处理:\\tFile\nyarn install v1.22.5\n[1/4] Resolving packages...\n[2/4] Fetching packages...\n[3/4] Linking dependencies...\n[4/4] Building fresh packages...\nDone in 8.11s.\n开始处理:\\tGroup\nyarn install v1.22.5\n[1/4] Resolving packages...\n[2/4] Fetching packages...\n[3/4] Linking dependencies...\n[4/4] Building fresh packages...\nDone in 0.13s.\n开始处理:\\tHelp\nyarn install v1.22.5\n[1/4] Resolving packages...\n[2/4] Fetching packages...\n[3/4] Linking dependencies...\n[4/4] Building fresh packages...\nDone in 2.23s.\n开始处理:\\tInfo\nyarn install v1.22.5\n[1/4] Resolving packages...\n[2/4] Fetching packages...\n[3/4] Linking dependencies...\n[4/4] Building fresh packages...\nDone in 0.48s.\n开始处理:\\tMail\nyarn install v1.22.5\n[1/4] Resolving packages...\n[2/4] Fetching packages...\n[3/4] Linking dependencies...\n[4/4] Building fresh packages...\nDone in 2.13s.\n开始处理:\\tNote\nyarn install v1.22.5\n[1/4] Resolving packages...\n[2/4] Fetching packages...\n[3/4] Linking dependencies...\n[4/4] Building fresh packages...\nDone in 1.21s.\n开始处理:\\tNotify\nyarn install v1.22.5\n[1/4] Resolving packages...\n[2/4] Fetching packages...\n[3/4] Linking dependencies...\n[4/4] Building fresh packages...\nDone in 1.34s.\n开始处理:\\tPlayer\nyarn install v1.22.5\n[1/4] Resolving packages...\n[2/4] Fetching packages...\n[3/4] Linking dependencies...\n[4/4] Building fresh packages...\nDone in 0.71s.\n开始处理:\\tQQConnect\nyarn install v1.22.5\n[1/4] Resolving packages...\n[2/4] Fetching packages...\n[3/4] Linking dependencies...\n[4/4] Building fresh packages...\nDone in 0.70s.\n开始处理:\\tReport\nyarn install v1.22.5\n[1/4] Resolving packages...\n[2/4] Fetching packages...\n[3/4] Linking dependencies...\n[4/4] Building fresh packages...\nDone in 0.09s.\n开始处理:\\tTRPG\nyarn install v1.22.5\n[1/4] Resolving packages...\n[2/4] Fetching packages...\n[3/4] Linking dependencies...\n[4/4] Building fresh packages...\nDone in 1.13s.\n命令 yarn install 执行完毕\nRemoving intermediate container b122ff697757\n ---> 76f3c7c66182\nStep 34/40 : COPY package.json yarn.lock ./\n ---> f9846dc48cae\nStep 35/40 : RUN yarn install\n ---> Running in d95909eee189\nyarn install v1.22.5\n[1/4] Resolving packages...\n[2/4] Fetching packages...\ninfo fsevents@2.3.2: The platform \"linux\" is incompatible with this module.\ninfo \"fsevents@2.3.2\" is an optional dependency and failed compatibility check. Excluding it from installation.\n[3/4] Linking dependencies...\n[4/4] Building fresh packages...\nDone in 31.70s.\nRemoving intermediate container d95909eee189\n ---> 7625b93fe209\nStep 36/40 : COPY . .\n ---> 1c52a865191c\nStep 37/40 : RUN yarn install && yarn run packages:install\n ---> Running in 651570f12152\nyarn install v1.22.5\n[1/4] Resolving packages...\nsuccess Already up-to-date.\nDone in 0.43s.\nyarn run v1.22.5\n$ bash packages/foreach.sh 'yarn install --registry https://registry.npm.taobao.org'\n开始处理:\\tActor\n[1/4] Resolving packages...\nsuccess Already up-to-date.\n开始处理:\\tBot\n[1/4] Resolving packages...\nsuccess Already up-to-date.\n开始处理:\\tChat\n[1/4] Resolving packages...\nsuccess Already up-to-date.\n开始处理:\\tChatEmotion\n[1/4] Resolving packages...\nsuccess Already up-to-date.\n开始处理:\\tCore\n[1/4] Resolving packages...\nsuccess Already up-to-date.\n开始处理:\\tDashboard\n[1/4] Resolving packages...\nsuccess Already up-to-date.\n开始处理:\\tDeploy\n[1/4] Resolving packages...\nsuccess Already up-to-date.\n开始处理:\\tDice\n[1/4] Resolving packages...\nsuccess Already up-to-date.\n开始处理:\\tFile\n[1/4] Resolving packages...\nsuccess Already up-to-date.\n开始处理:\\tGroup\n[1/4] Resolving packages...\nsuccess Already up-to-date.\n开始处理:\\tHelp\n[1/4] Resolving packages...\nsuccess Already up-to-date.\n开始处理:\\tInfo\n[1/4] Resolving packages...\nsuccess Already up-to-date.\n开始处理:\\tMail\n[1/4] Resolving packages...\nsuccess Already up-to-date.\n开始处理:\\tNote\n[1/4] Resolving packages...\nsuccess Already up-to-date.\n开始处理:\\tNotify\n[1/4] Resolving packages...\nsuccess Already up-to-date.\n开始处理:\\tOAuth\n[1/4] Resolving packages...\n[2/4] Fetching packages...\n[3/4] Linking dependencies...\n[4/4] Building fresh packages...\nsuccess Saved lockfile.\n开始处理:\\tPlayer\n[1/4] Resolving packages...\nsuccess Already up-to-date.\n开始处理:\\tQQConnect\n[1/4] Resolving packages...\nsuccess Already up-to-date.\n开始处理:\\tReport\n[1/4] Resolving packages...\nsuccess Already up-to-date.\n开始处理:\\tTRPG\n[1/4] Resolving packages...\nsuccess Already up-to-date.\n命令 yarn install --registry https://registry.npm.taobao.org 执行完毕\nDone in 5.20s.\nRemoving intermediate container 651570f12152\n ---> cc435864bd38\nStep 38/40 : EXPOSE 23256\n ---> Running in 1b4314685f44\nRemoving intermediate container 1b4314685f44\n ---> 3bd8ac1380c3\nStep 39/40 : ENV NODE_ENV production\n ---> Running in 79e43ed33a05\nRemoving intermediate container 79e43ed33a05\n ---> f2106442df9b\nStep 40/40 : CMD yarn run pro\n ---> Running in bc1b824833cb\nRemoving intermediate container bc1b824833cb\n ---> 390d641ee3a2\nSuccessfully built 390d641ee3a2\nSuccessfully tagged server:latest\n","stderr":"","imageSize":982780763},"endTime":1672624667586}