{"repository":"https://github.com/neoteric-eu/nestjs-auth","dockerfilePath":"Dockerfile","startTime":1672802465988,"clone":{"stdout":"","stderr":"Cloning into '/tmp/dinghy-analysis/neoteric-eu/nestjs-auth'...\n","error":null,"commit":"dc294e4ce2436579dea9958e24b90c0cc0ef2569"},"originalBuild":{"startTimestamp":1672802466988,"endTimestamp":1672802582388,"error":null,"stdout":"Sending build context to Docker daemon  1.118MB\r\r\nStep 1/20 : FROM node:12-alpine as builder\n12-alpine: Pulling from library/node\ndf9b9388f04a: Pulling fs layer\n3bf6d7380205: Pulling fs layer\n7939e601ee5e: Pulling fs layer\n31f0fb9de071: Pulling fs layer\n31f0fb9de071: Waiting\ndf9b9388f04a: Verifying Checksum\ndf9b9388f04a: Download complete\n7939e601ee5e: Verifying Checksum\n7939e601ee5e: Download complete\n3bf6d7380205: Verifying Checksum\n3bf6d7380205: Download complete\n31f0fb9de071: Verifying Checksum\n31f0fb9de071: Download complete\ndf9b9388f04a: Pull complete\n3bf6d7380205: Pull complete\n7939e601ee5e: Pull complete\n31f0fb9de071: Pull complete\nDigest: sha256:d4b15b3d48f42059a15bd659be60afe21762aae9d6cbea6f124440895c27db68\nStatus: Downloaded newer image for node:12-alpine\n ---> bb6d28039b8c\nStep 2/20 : WORKDIR /usr/src/app\n ---> Running in bfb525bc57be\nRemoving intermediate container bfb525bc57be\n ---> 10eceeeba63e\nStep 3/20 : ENV OPENCOLLECTIVE_HIDE=1\n ---> Running in 84ce00cb0a93\nRemoving intermediate container 84ce00cb0a93\n ---> 21dcba337c38\nStep 4/20 : ENV SUPPRESS_SUPPORT=1\n ---> Running in 5a1c36304d80\nRemoving intermediate container 5a1c36304d80\n ---> 5886f8bc4bd3\nStep 5/20 : COPY package.json package-lock.json ./\n ---> ab2b9836dae2\nStep 6/20 : RUN npm ci --loglevel error\n ---> Running in efe1a03d3731\n\n> protobufjs@6.8.8 postinstall /usr/src/app/node_modules/protobufjs\n> node scripts/postinstall\n\n\n> @nestjs/core@5.7.4 postinstall /usr/src/app/node_modules/@nestjs/core\n> opencollective || exit 0\n\n\n> spawn-sync@1.0.15 postinstall /usr/src/app/node_modules/spawn-sync\n> node postinstall\n\n\n> pre-commit@1.2.2 install /usr/src/app/node_modules/pre-commit\n> node install.js\n\n\n> fsevents@1.2.7 install /usr/src/app/node_modules/fsevents\n> node install\n\n\n> nodemon@1.18.10 postinstall /usr/src/app/node_modules/nodemon\n> node bin/postinstall || exit 0\n\nadded 907 packages in 11.002s\nRemoving intermediate container efe1a03d3731\n ---> 44120384f69a\nStep 7/20 : COPY . .\n ---> e2559f8edd4b\nStep 8/20 : RUN npm run build\n ---> Running in ee6b704c0f42\n\n> ava@0.10.2 prebuild /usr/src/app\n> rm -rf ./dist\n\n\n> ava@0.10.2 build /usr/src/app\n> tsc\n\n\n> ava@0.10.2 postbuild /usr/src/app\n> cp -R ./src/assets ./dist\n\nRemoving intermediate container ee6b704c0f42\n ---> 13e0b4215155\nStep 9/20 : FROM node:12-alpine as cleaner\n ---> bb6d28039b8c\nStep 10/20 : WORKDIR /usr/src/app\n ---> Running in 6152f5366d8e\nRemoving intermediate container 6152f5366d8e\n ---> eb5325da0cd2\nStep 11/20 : COPY --from=builder /usr/src/app .\n ---> eddfd207c327\nStep 12/20 : RUN npm prune --production\n ---> Running in d1a31a7e33f8\n\u001b[91mnpm WARN lifecycle pre-commit@1.2.2~uninstall: cannot run in wd pre-commit@1.2.2 node uninstall.js (wd=node_modules/pre-commit)\n\u001b[0m\u001b[91mnpm WARN @firebase/database@0.4.11 requires a peer of @firebase/app@0.x but none is installed. You must install peer dependencies yourself.\n\u001b[0m\u001b[91mnpm WARN @firebase/database@0.4.11 requires a peer of @firebase/app-types@0.x but none is installed. You must install peer dependencies yourself.\n\u001b[0m\u001b[91mnpm WARN @firebase/database-types@0.4.2 requires a peer of @firebase/app-types@0.x but none is installed. You must install peer dependencies yourself.\n\u001b[0m\u001b[91m\n\u001b[0mremoved 103 packages and audited 811 packages in 3.831s\nfound 228 vulnerabilities (28 low, 61 moderate, 107 high, 32 critical)\n  run `npm audit fix` to fix them, or `npm audit` for details\nRemoving intermediate container d1a31a7e33f8\n ---> 98a3a1be5c23\nStep 13/20 : FROM node:12-alpine\n ---> bb6d28039b8c\nStep 14/20 : LABEL maintainer=\"Przemysław Czekaj <pczekaj@neoteric.eu>\"\n ---> Running in ee5d598642b5\nRemoving intermediate container ee5d598642b5\n ---> 3e73f667b4b3\nStep 15/20 : HEALTHCHECK CMD curl -f http://localhost/healthcheck || exit 1\n ---> Running in c36f66c6999d\nRemoving intermediate container c36f66c6999d\n ---> 3f8002bc62ca\nStep 16/20 : RUN apk add --update curl\n ---> Running in 960b4488537a\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.15/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.15/community/x86_64/APKINDEX.tar.gz\n(1/5) Installing ca-certificates (20220614-r0)\n(2/5) Installing brotli-libs (1.0.9-r5)\n(3/5) Installing nghttp2-libs (1.46.0-r0)\n(4/5) Installing libcurl (7.80.0-r5)\n(5/5) Installing curl (7.80.0-r5)\nExecuting busybox-1.34.1-r5.trigger\nExecuting ca-certificates-20220614-r0.trigger\nOK: 10 MiB in 21 packages\nRemoving intermediate container 960b4488537a\n ---> bde62dbcc88e\nStep 17/20 : WORKDIR /usr/src/app\n ---> Running in d429f13707c1\nRemoving intermediate container d429f13707c1\n ---> 7ed4309a57f8\nStep 18/20 : COPY --from=cleaner /usr/src/app .\n ---> e686c5fb81fa\nStep 19/20 : EXPOSE 80\n ---> Running in f29197770c82\nRemoving intermediate container f29197770c82\n ---> 786361df6857\nStep 20/20 : CMD [ \"npm\", \"run\", \"prod\" ]\n ---> Running in 4d542ea833ae\nRemoving intermediate container 4d542ea833ae\n ---> ca9a65e00193\nSuccessfully built ca9a65e00193\nSuccessfully tagged nestjs-auth:latest\n","stderr":"","imageSize":334204323},"repair":{"violations":[{"name":"apkAddUseNoCache","position":{"start":37,"end":37,"columnStart":4,"columnEnd":25}}],"repairedDockerfile":"## The builder\n\nFROM node:12-alpine as builder\n\nWORKDIR /usr/src/app\n\nENV OPENCOLLECTIVE_HIDE=1\nENV SUPPRESS_SUPPORT=1\n\nCOPY package.json package-lock.json ./\n\nRUN npm ci --loglevel error\n\nCOPY . .\n\nRUN npm run build\n\n\n## The cleaner\n\nFROM node:12-alpine as cleaner\n\nWORKDIR /usr/src/app\n\nCOPY --from=builder /usr/src/app .\n\nRUN npm prune --production\n\n\n## Output image\n\nFROM node:12-alpine\n\nLABEL maintainer=\"Przemysław Czekaj <pczekaj@neoteric.eu>\"\n\nHEALTHCHECK CMD curl -f http://localhost/healthcheck || exit 1\n\nRUN apk add --no-cache --update curl\n\nWORKDIR /usr/src/app\n\nCOPY --from=cleaner /usr/src/app .\n\nEXPOSE 80\n\nCMD [ \"npm\", \"run\", \"prod\" ]\n"},"repairedBuild":{"startTimestamp":1672802583087,"endTimestamp":1672802687233,"error":null,"stdout":"Sending build context to Docker daemon  1.118MB\r\r\nStep 1/20 : FROM node:12-alpine as builder\n ---> bb6d28039b8c\nStep 2/20 : WORKDIR /usr/src/app\n ---> Running in 734da1bb5fd7\nRemoving intermediate container 734da1bb5fd7\n ---> a667467e862c\nStep 3/20 : ENV OPENCOLLECTIVE_HIDE=1\n ---> Running in f3c55fa6dd22\nRemoving intermediate container f3c55fa6dd22\n ---> 8574d08e9dfc\nStep 4/20 : ENV SUPPRESS_SUPPORT=1\n ---> Running in 3328f523b77c\nRemoving intermediate container 3328f523b77c\n ---> 51bd1b77fe3f\nStep 5/20 : COPY package.json package-lock.json ./\n ---> 7a2ae6bc8c3f\nStep 6/20 : RUN npm ci --loglevel error\n ---> Running in 52a1488b23ea\n\n> protobufjs@6.8.8 postinstall /usr/src/app/node_modules/protobufjs\n> node scripts/postinstall\n\n\n> @nestjs/core@5.7.4 postinstall /usr/src/app/node_modules/@nestjs/core\n> opencollective || exit 0\n\n\n> spawn-sync@1.0.15 postinstall /usr/src/app/node_modules/spawn-sync\n> node postinstall\n\n\n> pre-commit@1.2.2 install /usr/src/app/node_modules/pre-commit\n> node install.js\n\n\n> fsevents@1.2.7 install /usr/src/app/node_modules/fsevents\n> node install\n\n\n> nodemon@1.18.10 postinstall /usr/src/app/node_modules/nodemon\n> node bin/postinstall || exit 0\n\nadded 907 packages in 9.982s\nRemoving intermediate container 52a1488b23ea\n ---> 2e2d0ab39ed7\nStep 7/20 : COPY . .\n ---> 6220a594012c\nStep 8/20 : RUN npm run build\n ---> Running in d3b22052ead9\n\n> ava@0.10.2 prebuild /usr/src/app\n> rm -rf ./dist\n\n\n> ava@0.10.2 build /usr/src/app\n> tsc\n\n\n> ava@0.10.2 postbuild /usr/src/app\n> cp -R ./src/assets ./dist\n\nRemoving intermediate container d3b22052ead9\n ---> 11459730530a\nStep 9/20 : FROM node:12-alpine as cleaner\n ---> bb6d28039b8c\nStep 10/20 : WORKDIR /usr/src/app\n ---> Running in 3a514765742a\nRemoving intermediate container 3a514765742a\n ---> ba29b0b4997f\nStep 11/20 : COPY --from=builder /usr/src/app .\n ---> cfaac557e4cc\nStep 12/20 : RUN npm prune --production\n ---> Running in 8590409a5a2e\n\u001b[91mnpm WARN lifecycle pre-commit@1.2.2~uninstall: cannot run in wd pre-commit@1.2.2 node uninstall.js (wd=node_modules/pre-commit)\n\u001b[0m\u001b[91mnpm WARN @firebase/database@0.4.11 requires a peer of @firebase/app@0.x but none is installed. You must install peer dependencies yourself.\n\u001b[0m\u001b[91mnpm WARN @firebase/database@0.4.11 requires a peer of @firebase/app-types@0.x but none is installed. You must install peer dependencies yourself.\n\u001b[0m\u001b[91mnpm WARN @firebase/database-types@0.4.2 requires a peer of @firebase/app-types@0.x but none is installed. You must install peer dependencies yourself.\n\u001b[0m\u001b[91m\n\u001b[0mremoved 103 packages and audited 811 packages in 3.984s\nfound 228 vulnerabilities (28 low, 61 moderate, 107 high, 32 critical)\n  run `npm audit fix` to fix them, or `npm audit` for details\nRemoving intermediate container 8590409a5a2e\n ---> 73d693fc14a8\nStep 13/20 : FROM node:12-alpine\n ---> bb6d28039b8c\nStep 14/20 : LABEL maintainer=\"Przemysław Czekaj <pczekaj@neoteric.eu>\"\n ---> Running in a54a3943f40f\nRemoving intermediate container a54a3943f40f\n ---> d398bc526db3\nStep 15/20 : HEALTHCHECK CMD curl -f http://localhost/healthcheck || exit 1\n ---> Running in 943bcf002158\nRemoving intermediate container 943bcf002158\n ---> 3d880edb8fd5\nStep 16/20 : RUN apk add --no-cache --update curl\n ---> Running in 9c66e02eec73\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.15/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.15/community/x86_64/APKINDEX.tar.gz\n(1/5) Installing ca-certificates (20220614-r0)\n(2/5) Installing brotli-libs (1.0.9-r5)\n(3/5) Installing nghttp2-libs (1.46.0-r0)\n(4/5) Installing libcurl (7.80.0-r5)\n(5/5) Installing curl (7.80.0-r5)\nExecuting busybox-1.34.1-r5.trigger\nExecuting ca-certificates-20220614-r0.trigger\nOK: 10 MiB in 21 packages\nRemoving intermediate container 9c66e02eec73\n ---> c82857f08db0\nStep 17/20 : WORKDIR /usr/src/app\n ---> Running in 9ef9db82a99f\nRemoving intermediate container 9ef9db82a99f\n ---> 65c4a8dfc530\nStep 18/20 : COPY --from=cleaner /usr/src/app .\n ---> c8d6f1ac2122\nStep 19/20 : EXPOSE 80\n ---> Running in 52df0aec5fb1\nRemoving intermediate container 52df0aec5fb1\n ---> 8199652504a8\nStep 20/20 : CMD [ \"npm\", \"run\", \"prod\" ]\n ---> Running in 69f1c04eb5eb\nRemoving intermediate container 69f1c04eb5eb\n ---> 61dc43a2ff77\nSuccessfully built 61dc43a2ff77\nSuccessfully tagged nestjs-auth:latest\n","stderr":"","imageSize":331908453},"endTime":1672802687846}