{"repository":"https://github.com/consensys/orchestrate","dockerfilePath":"Dockerfile","startTime":1672879091124,"endTime":1672880127715,"clone":{"startTime":1672879091125,"stdout":"","stderr":"Cloning into '/tmp/dinghy-analysis/consensys/orchestrate'...\n","error":null,"endTime":1672879092942,"commit":"74f42ad66c397cae06e97bc7ce24b638c46f7af0"},"originalBuild":{"startTime":1672879093042,"endTime":1672879632386,"error":null,"stdout":"Sending build context to Docker daemon  17.02MB\r\r\nStep 1/22 : ARG VERSION=nonroot\nStep 2/22 : FROM golang:1.16.9 AS builder\n1.16.9: Pulling from library/golang\nbb7d5a84853b: Pulling fs layer\nf02b617c6a8c: Pulling fs layer\nd32e17419b7e: Pulling fs layer\nc9d2d81226a4: Pulling fs layer\n7bd370e02e50: Pulling fs layer\n5cdf2d652a4d: Pulling fs layer\n4573d57ef426: Pulling fs layer\nc9d2d81226a4: Waiting\n7bd370e02e50: Waiting\n4573d57ef426: Waiting\n5cdf2d652a4d: Waiting\nd32e17419b7e: Verifying Checksum\nd32e17419b7e: Download complete\nf02b617c6a8c: Verifying Checksum\nf02b617c6a8c: Download complete\nbb7d5a84853b: Download complete\nc9d2d81226a4: Verifying Checksum\nc9d2d81226a4: Download complete\n4573d57ef426: Verifying Checksum\n4573d57ef426: Download complete\n7bd370e02e50: Verifying Checksum\n7bd370e02e50: Download complete\nbb7d5a84853b: Pull complete\nf02b617c6a8c: Pull complete\nd32e17419b7e: Pull complete\nc9d2d81226a4: Pull complete\n5cdf2d652a4d: Verifying Checksum\n5cdf2d652a4d: Download complete\n7bd370e02e50: Pull complete\n5cdf2d652a4d: Pull complete\n4573d57ef426: Pull complete\nDigest: sha256:c8b7bf9166093208456120876e51e9cb387b0523bddb9d8c0b33ff621347e26f\nStatus: Downloaded newer image for golang:1.16.9\n ---> 135e37b786c8\nStep 3/22 : ARG TARGETOS\n ---> Running in 27bb0a6bfbb6\nRemoving intermediate container 27bb0a6bfbb6\n ---> 2873fb09de51\nStep 4/22 : ARG TARGETARCH\n ---> Running in 5e1d7e20d032\nRemoving intermediate container 5e1d7e20d032\n ---> 268f5d3285a4\nStep 5/22 : RUN apt-get update && \tapt-get install --no-install-recommends -y \tca-certificates upx-ucl\n ---> Running in 16e8ac7d33cf\nGet:1 http://deb.debian.org/debian bullseye InRelease [116 kB]\nGet:2 http://security.debian.org/debian-security bullseye-security InRelease [48.4 kB]\nGet:3 http://deb.debian.org/debian bullseye-updates InRelease [44.1 kB]\nGet:4 http://security.debian.org/debian-security bullseye-security/main amd64 Packages [210 kB]\nGet:5 http://deb.debian.org/debian bullseye/main amd64 Packages [8183 kB]\nGet:6 http://deb.debian.org/debian bullseye-updates/main amd64 Packages [14.6 kB]\nFetched 8616 kB in 1s (6000 kB/s)\nReading package lists...\nReading package lists...\nBuilding dependency tree...\nReading state information...\nca-certificates is already the newest version (20210119).\nThe following NEW packages will be installed:\n  libucl1 upx-ucl\n0 upgraded, 2 newly installed, 0 to remove and 60 not upgraded.\nNeed to get 438 kB of archives.\nAfter this operation, 2137 kB of additional disk space will be used.\nGet:1 http://deb.debian.org/debian bullseye/main amd64 libucl1 amd64 1.03+repack-6 [27.1 kB]\nGet:2 http://deb.debian.org/debian bullseye/main amd64 upx-ucl amd64 3.96-2 [411 kB]\n\u001b[91mdebconf: delaying package configuration, since apt-utils is not installed\n\u001b[0mFetched 438 kB in 0s (5975 kB/s)\nSelecting previously unselected package libucl1:amd64.\r\n(Reading database ... \r(Reading database ... 5%\r(Reading database ... 10%\r(Reading database ... 15%\r(Reading database ... 20%\r(Reading database ... 25%\r(Reading database ... 30%\r(Reading database ... 35%\r(Reading database ... 40%\r(Reading database ... 45%\r(Reading database ... 50%\r(Reading database ... 55%\r(Reading database ... 60%\r(Reading database ... 65%\r(Reading database ... 70%\r(Reading database ... 75%\r(Reading database ... 80%\r(Reading database ... 85%\r(Reading database ... 90%\r(Reading database ... 95%\r(Reading database ... 100%\r(Reading database ... 15713 files and directories currently installed.)\r\nPreparing to unpack .../libucl1_1.03+repack-6_amd64.deb ...\r\nUnpacking libucl1:amd64 (1.03+repack-6) ...\r\nSelecting previously unselected package upx-ucl.\r\nPreparing to unpack .../upx-ucl_3.96-2_amd64.deb ...\r\nUnpacking upx-ucl (3.96-2) ...\r\nSetting up libucl1:amd64 (1.03+repack-6) ...\r\nSetting up upx-ucl (3.96-2) ...\r\nupdate-alternatives: error: no alternatives for upx\r\nupdate-alternatives: using /usr/bin/upx-ucl to provide /usr/bin/upx (upx) in auto mode\r\nProcessing triggers for libc-bin (2.31-13+deb11u2) ...\r\nRemoving intermediate container 16e8ac7d33cf\n ---> 637bc8c8192e\nStep 6/22 : RUN useradd appuser && mkdir /app\n ---> Running in 33d967275f64\nRemoving intermediate container 33d967275f64\n ---> 8df8052e58d7\nStep 7/22 : WORKDIR /app\n ---> Running in cab863c46c8a\nRemoving intermediate container cab863c46c8a\n ---> 5475a13a61f9\nStep 8/22 : ENV GO111MODULE=on\n ---> Running in 6d2b8a706f19\nRemoving intermediate container 6d2b8a706f19\n ---> a48545bbf103\nStep 9/22 : COPY go.mod go.sum ./\n ---> 69d378bcc8b2\nStep 10/22 : COPY LICENSE ./\n ---> 54471b63e85d\nStep 11/22 : RUN go mod download\n ---> Running in 87606c4fb616\nRemoving intermediate container 87606c4fb616\n ---> bc7f35c1619a\nStep 12/22 : COPY . .\n ---> e7803ff9697b\nStep 13/22 : RUN GOOS=${TARGETOS} GOARCH=${TARGETARCH} go build -o /bin/main -a -tags netgo -ldflags '-w -s -extldflags \"-static\"' .\n ---> Running in 1e1714bd4ad1\n\u001b[91m# github.com/consensys/orchestrate\n/usr/bin/ld: /tmp/go-link-286251337/000002.o: in function `mygetgrouplist':\n/usr/local/go/src/os/user/getgrouplist_unix.go:16: warning: Using 'getgrouplist' in statically linked applications requires at runtime the shared libraries from the glibc version used for linking\n/usr/bin/ld: /tmp/go-link-286251337/000001.o: in function `mygetgrgid_r':\n/usr/local/go/src/os/user/cgo_lookup_unix.go:38: warning: Using 'getgrgid_r' in statically linked applications requires at runtime the shared libraries from the glibc version used for linking\n/usr/bin/ld: /tmp/go-link-286251337/000001.o: in function `mygetgrnam_r':\n/usr/local/go/src/os/user/cgo_lookup_unix.go:43: warning: Using 'getgrnam_r' in statically linked applications requires at runtime the shared libraries from the glibc version used for linking\n/usr/bin/ld: /tmp/go-link-286251337/000001.o: in function `mygetpwnam_r':\n/usr/local/go/src/os/user/cgo_lookup_unix.go:33: warning: Using 'getpwnam_r' in statically linked applications requires at runtime the shared libraries from the glibc version used for linking\n/usr/bin/ld: /tmp/go-link-286251337/000001.o: in function `mygetpwuid_r':\n/usr/local/go/src/os/user/cgo_lookup_unix.go:28: warning: Using 'getpwuid_r' in statically linked applications requires at runtime the shared libraries from the glibc version used for linking\n\u001b[0mRemoving intermediate container 1e1714bd4ad1\n ---> d9c0c5691a6e\nStep 14/22 : RUN upx /bin/main\n ---> Running in cbd871ee2c71\n                       Ultimate Packer for eXecutables\n                          Copyright (C) 1996 - 2020\nUPX 3.96        Markus Oberhumer, Laszlo Molnar & John Reiser   Jan 23rd 2020\n\n        File size         Ratio      Format      Name\n   --------------------   ------   -----------   -----------\n  81647640 ->  24953608   30.56%   linux/amd64   main\n\nPacked 1 file.\nRemoving intermediate container cbd871ee2c71\n ---> 55a98b89c0c1\nStep 15/22 : FROM gcr.io/distroless/static:$VERSION\nnonroot: Pulling from distroless/static\nDigest: sha256:cacb3d85a593c44e2f3998175164f0c694e475b40e639294f224062842e90724\nStatus: Downloaded newer image for gcr.io/distroless/static:nonroot\n ---> a65c2e382650\nStep 16/22 : COPY --from=builder /etc/ssl/certs/ca-certificates.crt /etc/ssl/certs/\n ---> 3367180b0714\nStep 17/22 : COPY --from=builder /etc/passwd /etc/passwd\n ---> e190c55f5b7c\nStep 18/22 : COPY --from=builder /bin/main /go/bin/main\n ---> 5dd11dda8745\nStep 19/22 : COPY --from=builder /app/LICENSE /\n ---> 4c5667467341\nStep 20/22 : USER appuser\n ---> Running in 47a3bee83fb1\nRemoving intermediate container 47a3bee83fb1\n ---> 1dd229dc8451\nStep 21/22 : EXPOSE 8080\n ---> Running in cd91afcb4632\nRemoving intermediate container cd91afcb4632\n ---> 11c4c207d5e3\nStep 22/22 : ENTRYPOINT [\"/go/bin/main\"]\n ---> Running in a7bf4e7b2719\nRemoving intermediate container a7bf4e7b2719\n ---> 42e18920434d\nSuccessfully built 42e18920434d\nSuccessfully tagged orchestrate:latest\n","stderr":"","imageSize":27510154},"repair":{"startTime":1672879632449,"endTime":1672879632582,"violations":[{"name":"ruleAptGetInstallThenRemoveAptLists","position":{"start":11,"end":12,"columnStart":1,"columnEnd":24}}],"repairedDockerfile":"ARG VERSION=nonroot\n\n############################\n# STEP 1 build executable Orchestrate binary\n############################\nFROM golang:1.16.9 AS builder\n\nARG TARGETOS\nARG TARGETARCH\n\nRUN apt-get update && \\\n\tapt-get install --no-install-recommends -y \\\n\tca-certificates upx-ucl && rm -rf /var/lib/apt/lists/*;\n\nRUN useradd appuser && mkdir /app\nWORKDIR /app\n\n# Use go mod with go 1.15\nENV GO111MODULE=on\nCOPY go.mod go.sum ./\nCOPY LICENSE ./\nRUN go mod download\n\nCOPY . .\n\nRUN GOOS=${TARGETOS} GOARCH=${TARGETARCH} go build -o /bin/main -a -tags netgo -ldflags '-w -s -extldflags \"-static\"' .\nRUN upx /bin/main\n\n############################\n# STEP 2 build a small image\n############################\nFROM gcr.io/distroless/static:$VERSION\n\nCOPY --from=builder /etc/ssl/certs/ca-certificates.crt /etc/ssl/certs/\nCOPY --from=builder /etc/passwd /etc/passwd\n\nCOPY --from=builder /bin/main /go/bin/main\nCOPY --from=builder /app/LICENSE /\n\n# Use an unprivileged user.\nUSER appuser\nEXPOSE 8080\nENTRYPOINT [\"/go/bin/main\"]\n"},"repairedBuild":{"startTime":1672879633278,"endTime":1672880127000,"error":null,"stdout":"Sending build context to Docker daemon  17.02MB\r\r\nStep 1/22 : ARG VERSION=nonroot\nStep 2/22 : FROM golang:1.16.9 AS builder\n ---> 135e37b786c8\nStep 3/22 : ARG TARGETOS\n ---> Running in 061efa848999\nRemoving intermediate container 061efa848999\n ---> b81fa0bea963\nStep 4/22 : ARG TARGETARCH\n ---> Running in f6d793c6ac10\nRemoving intermediate container f6d793c6ac10\n ---> 86b4c3fede5c\nStep 5/22 : RUN apt-get update && \tapt-get install --no-install-recommends -y \tca-certificates upx-ucl && rm -rf /var/lib/apt/lists/*;\n ---> Running in 6e7917263fb0\nGet:1 http://deb.debian.org/debian bullseye InRelease [116 kB]\nGet:2 http://security.debian.org/debian-security bullseye-security InRelease [48.4 kB]\nGet:3 http://deb.debian.org/debian bullseye-updates InRelease [44.1 kB]\nGet:4 http://deb.debian.org/debian bullseye/main amd64 Packages [8183 kB]\nGet:5 http://deb.debian.org/debian bullseye-updates/main amd64 Packages [14.6 kB]\nGet:6 http://security.debian.org/debian-security bullseye-security/main amd64 Packages [210 kB]\nFetched 8616 kB in 1s (6150 kB/s)\nReading package lists...\nReading package lists...\nBuilding dependency tree...\nReading state information...\nca-certificates is already the newest version (20210119).\nThe following NEW packages will be installed:\n  libucl1 upx-ucl\n0 upgraded, 2 newly installed, 0 to remove and 60 not upgraded.\nNeed to get 438 kB of archives.\nAfter this operation, 2137 kB of additional disk space will be used.\nGet:1 http://deb.debian.org/debian bullseye/main amd64 libucl1 amd64 1.03+repack-6 [27.1 kB]\nGet:2 http://deb.debian.org/debian bullseye/main amd64 upx-ucl amd64 3.96-2 [411 kB]\n\u001b[91mdebconf: delaying package configuration, since apt-utils is not installed\n\u001b[0mFetched 438 kB in 0s (2710 kB/s)\nSelecting previously unselected package libucl1:amd64.\r\n(Reading database ... \r(Reading database ... 5%\r(Reading database ... 10%\r(Reading database ... 15%\r(Reading database ... 20%\r(Reading database ... 25%\r(Reading database ... 30%\r(Reading database ... 35%\r(Reading database ... 40%\r(Reading database ... 45%\r(Reading database ... 50%\r(Reading database ... 55%\r(Reading database ... 60%\r(Reading database ... 65%\r(Reading database ... 70%\r(Reading database ... 75%\r(Reading database ... 80%\r(Reading database ... 85%\r(Reading database ... 90%\r(Reading database ... 95%\r(Reading database ... 100%\r(Reading database ... 15713 files and directories currently installed.)\r\nPreparing to unpack .../libucl1_1.03+repack-6_amd64.deb ...\r\nUnpacking libucl1:amd64 (1.03+repack-6) ...\r\nSelecting previously unselected package upx-ucl.\r\nPreparing to unpack .../upx-ucl_3.96-2_amd64.deb ...\r\nUnpacking upx-ucl (3.96-2) ...\r\nSetting up libucl1:amd64 (1.03+repack-6) ...\r\nSetting up upx-ucl (3.96-2) ...\r\nupdate-alternatives: error: no alternatives for upx\r\nupdate-alternatives: using /usr/bin/upx-ucl to provide /usr/bin/upx (upx) in auto mode\r\nProcessing triggers for libc-bin (2.31-13+deb11u2) ...\r\nRemoving intermediate container 6e7917263fb0\n ---> a200261f3af2\nStep 6/22 : RUN useradd appuser && mkdir /app\n ---> Running in 832897214ca6\nRemoving intermediate container 832897214ca6\n ---> 31b2f6bee608\nStep 7/22 : WORKDIR /app\n ---> Running in 8329caed7238\nRemoving intermediate container 8329caed7238\n ---> 22584279e8e8\nStep 8/22 : ENV GO111MODULE=on\n ---> Running in 8f5c98c8ef6e\nRemoving intermediate container 8f5c98c8ef6e\n ---> e55c40af4de4\nStep 9/22 : COPY go.mod go.sum ./\n ---> 153ab4883953\nStep 10/22 : COPY LICENSE ./\n ---> 59b2f79efee3\nStep 11/22 : RUN go mod download\n ---> Running in e8a22b53542c\nRemoving intermediate container e8a22b53542c\n ---> b99db8c5e59c\nStep 12/22 : COPY . .\n ---> a05d64f2adb1\nStep 13/22 : RUN GOOS=${TARGETOS} GOARCH=${TARGETARCH} go build -o /bin/main -a -tags netgo -ldflags '-w -s -extldflags \"-static\"' .\n ---> Running in c5db967b48f3\n\u001b[91m# github.com/consensys/orchestrate\n/usr/bin/ld: /tmp/go-link-169957337/000002.o: in function `mygetgrouplist':\n/usr/local/go/src/os/user/getgrouplist_unix.go:16: warning: Using 'getgrouplist' in statically linked applications requires at runtime the shared libraries from the glibc version used for linking\n/usr/bin/ld: /tmp/go-link-169957337/000001.o: in function `mygetgrgid_r':\n/usr/local/go/src/os/user/cgo_lookup_unix.go:38: warning: Using 'getgrgid_r' in statically linked applications requires at runtime the shared libraries from the glibc version used for linking\n/usr/bin/ld: /tmp/go-link-169957337/000001.o: in function `mygetgrnam_r':\n/usr/local/go/src/os/user/cgo_lookup_unix.go:43: warning: Using 'getgrnam_r' in statically linked applications requires at runtime the shared libraries from the glibc version used for linking\n/usr/bin/ld: /tmp/go-link-169957337/000001.o: in function `mygetpwnam_r':\n/usr/local/go/src/os/user/cgo_lookup_unix.go:33: warning: Using 'getpwnam_r' in statically linked applications requires at runtime the shared libraries from the glibc version used for linking\n/usr/bin/ld: /tmp/go-link-169957337/000001.o: in function `mygetpwuid_r':\n/usr/local/go/src/os/user/cgo_lookup_unix.go:28: warning: Using 'getpwuid_r' in statically linked applications requires at runtime the shared libraries from the glibc version used for linking\n\u001b[0mRemoving intermediate container c5db967b48f3\n ---> 965176e6cade\nStep 14/22 : RUN upx /bin/main\n ---> Running in 485a8d319220\n                       Ultimate Packer for eXecutables\n                          Copyright (C) 1996 - 2020\nUPX 3.96        Markus Oberhumer, Laszlo Molnar & John Reiser   Jan 23rd 2020\n\n        File size         Ratio      Format      Name\n   --------------------   ------   -----------   -----------\n  81647640 ->  24953608   30.56%   linux/amd64   main\n\nPacked 1 file.\nRemoving intermediate container 485a8d319220\n ---> 2dfe6325ab47\nStep 15/22 : FROM gcr.io/distroless/static:$VERSION\n ---> a65c2e382650\nStep 16/22 : COPY --from=builder /etc/ssl/certs/ca-certificates.crt /etc/ssl/certs/\n ---> a790c5545a3a\nStep 17/22 : COPY --from=builder /etc/passwd /etc/passwd\n ---> 788216edde57\nStep 18/22 : COPY --from=builder /bin/main /go/bin/main\n ---> 888b03b99842\nStep 19/22 : COPY --from=builder /app/LICENSE /\n ---> 301b1a1f846f\nStep 20/22 : USER appuser\n ---> Running in 1fb699a81c74\nRemoving intermediate container 1fb699a81c74\n ---> 6b05d3bdc98c\nStep 21/22 : EXPOSE 8080\n ---> Running in 18f7063b760c\nRemoving intermediate container 18f7063b760c\n ---> 7d2c0f805f08\nStep 22/22 : ENTRYPOINT [\"/go/bin/main\"]\n ---> Running in 9456be0c0018\nRemoving intermediate container 9456be0c0018\n ---> 0b8d3f21bfde\nSuccessfully built 0b8d3f21bfde\nSuccessfully tagged orchestrate:latest\n","stderr":"","imageSize":27510154}}