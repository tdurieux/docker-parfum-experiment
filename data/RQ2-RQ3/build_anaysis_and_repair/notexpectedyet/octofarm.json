{"repository":"https://github.com/notexpectedyet/octofarm","dockerfilePath":"Dockerfile","startTime":1672585861393,"clone":{"stdout":"","stderr":"Cloning into '/tmp/dinghy-analysis/notexpectedyet/octofarm'...\n","error":null,"commit":"f22996b739b4c2285e7d342a026e86058d91c519"},"originalBuild":{"startTimestamp":1672585863432,"endTimestamp":1672586061149,"error":null,"stdout":"Sending build context to Docker daemon  61.62MB\r\r\nStep 1/24 : FROM alpine:3.14 as base\n3.14: Pulling from library/alpine\nc7ed990a2339: Pulling fs layer\nc7ed990a2339: Verifying Checksum\nc7ed990a2339: Download complete\nc7ed990a2339: Pull complete\nDigest: sha256:4c869a63e1b7c0722fed1e402a6466610327c3b83bdddb94bd94fb71da7f638a\nStatus: Downloaded newer image for alpine:3.14\n ---> dd53f409bf0b\nStep 2/24 : RUN apk add --no-cache --virtual .base-deps     nodejs     npm     tini\n ---> Running in f6c810881454\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.14/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.14/community/x86_64/APKINDEX.tar.gz\n(1/10) Installing ca-certificates (20220614-r0)\n(2/10) Installing nghttp2-libs (1.43.0-r0)\n(3/10) Installing brotli-libs (1.0.9-r5)\n(4/10) Installing c-ares (1.17.2-r0)\n(5/10) Installing libgcc (10.3.1_git20210424-r2)\n(6/10) Installing libstdc++ (10.3.1_git20210424-r2)\n(7/10) Installing nodejs (14.20.1-r0)\n(8/10) Installing npm (7.17.0-r0)\n(9/10) Installing tini (0.19.0-r0)\n(10/10) Installing .base-deps (20230101.151111)\nExecuting busybox-1.33.1-r8.trigger\nExecuting ca-certificates-20220614-r0.trigger\nOK: 58 MiB in 24 packages\nRemoving intermediate container f6c810881454\n ---> 504adbb3b7ce\nStep 3/24 : ENV NODE_ENV=production\n ---> Running in c34fe4b9d7b5\nRemoving intermediate container c34fe4b9d7b5\n ---> befcab877df3\nStep 4/24 : RUN npm install -g npm@latest\n ---> Running in 48d5317f290e\n\nadded 1 package, and audited 232 packages in 2s\n\n14 packages are looking for funding\n  run `npm fund` for details\n\nfound 0 vulnerabilities\nRemoving intermediate container 48d5317f290e\n ---> 01dc4ff56101\nStep 5/24 : RUN npm install -g pm2\n ---> Running in 9342d66e916f\n\u001b[91mnpm WARN \u001b[0m\u001b[91mdeprecated uuid@3.4.0: Please upgrade  to version 7 or higher.  Older versions may use Math.random() in certain circumstances, which is known to be problematic.  See https://v8.dev/blog/math-random for details.\n\u001b[0m\nadded 184 packages in 6s\n\n12 packages are looking for funding\n  run `npm fund` for details\nRemoving intermediate container 9342d66e916f\n ---> e888667a7a97\nStep 6/24 : RUN adduser -D octofarm --home /app &&     mkdir -p /scripts &&     chown -R octofarm:octofarm /scripts/\n ---> Running in d561137a0d40\nRemoving intermediate container d561137a0d40\n ---> a5dcd9cff9a1\nStep 7/24 : FROM base as compiler\n ---> a5dcd9cff9a1\nStep 8/24 : RUN apk add --no-cache --virtual .build-deps     alpine-sdk     make     gcc     g++     python3\n ---> Running in 48e728396a79\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.14/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.14/community/x86_64/APKINDEX.tar.gz\n(1/44) Installing fakeroot (1.25.3-r3)\n(2/44) Installing openssl (1.1.1s-r0)\n(3/44) Installing libattr (2.5.1-r0)\n(4/44) Installing attr (2.5.1-r0)\n(5/44) Installing libacl (2.2.53-r0)\n(6/44) Installing tar (1.34-r0)\n(7/44) Installing pkgconf (1.7.4-r0)\n(8/44) Installing patch (2.7.6-r7)\n(9/44) Installing lzip (1.22-r0)\n(10/44) Installing libcurl (7.79.1-r4)\n(11/44) Installing curl (7.79.1-r4)\n(12/44) Installing abuild (3.8.0_rc4-r0)\nExecuting abuild-3.8.0_rc4-r0.pre-install\n(13/44) Installing binutils (2.35.2-r2)\n(14/44) Installing libmagic (5.40-r1)\n(15/44) Installing file (5.40-r1)\n(16/44) Installing libgomp (10.3.1_git20210424-r2)\n(17/44) Installing libatomic (10.3.1_git20210424-r2)\n(18/44) Installing libgphobos (10.3.1_git20210424-r2)\n(19/44) Installing gmp (6.2.1-r1)\n(20/44) Installing isl22 (0.22-r0)\n(21/44) Installing mpfr4 (4.1.0-r0)\n(22/44) Installing mpc1 (1.2.1-r0)\n(23/44) Installing gcc (10.3.1_git20210424-r2)\n(24/44) Installing musl-dev (1.2.2-r3)\n(25/44) Installing libc-dev (0.7.2-r3)\n(26/44) Installing g++ (10.3.1_git20210424-r2)\n(27/44) Installing make (4.3-r0)\n(28/44) Installing fortify-headers (1.1-r1)\n(29/44) Installing build-base (0.5-r3)\n(30/44) Installing expat (2.5.0-r0)\n(31/44) Installing pcre2 (10.36-r1)\n(32/44) Installing git (2.32.4-r0)\n(33/44) Installing alpine-sdk (1.0-r1)\n(34/44) Installing libbz2 (1.0.8-r1)\n(35/44) Installing libffi (3.3-r2)\n(36/44) Installing gdbm (1.19-r0)\n(37/44) Installing xz-libs (5.2.5-r1)\n(38/44) Installing mpdecimal (2.5.1-r1)\n(39/44) Installing ncurses-terminfo-base (6.2_p20210612-r1)\n(40/44) Installing ncurses-libs (6.2_p20210612-r1)\n(41/44) Installing readline (8.1.0-r0)\n(42/44) Installing sqlite-libs (3.35.5-r0)\n(43/44) Installing python3 (3.9.16-r0)\n(44/44) Installing .build-deps (20230101.151214)\nExecuting busybox-1.33.1-r8.trigger\nOK: 310 MiB in 68 packages\nRemoving intermediate container 48e728396a79\n ---> ec9a40ff2430\nStep 9/24 : WORKDIR /tmp/app\n ---> Running in 1e16d7a3edd6\nRemoving intermediate container 1e16d7a3edd6\n ---> 6dfeba71f819\nStep 10/24 : COPY server/package.json ./server/package.json\n ---> c3d884bfad36\nStep 11/24 : COPY server/package-lock.json ./server/package-lock.json\n ---> f91d6c503adf\nStep 12/24 : WORKDIR /tmp/app/server\n ---> Running in b33145200c38\nRemoving intermediate container b33145200c38\n ---> b86a74b2146d\nStep 13/24 : RUN npm ci --omit=dev\n ---> Running in d3bca133da9d\n\nadded 427 packages, and audited 428 packages in 16s\n\n33 packages are looking for funding\n  run `npm fund` for details\n\n5 vulnerabilities (2 moderate, 3 high)\n\nTo address issues that do not require attention, run:\n  npm audit fix\n\nTo address all issues possible (including breaking changes), run:\n  npm audit fix --force\n\nSome issues need review, and may require choosing\na different dependency.\n\nRun `npm audit` for details.\nRemoving intermediate container d3bca133da9d\n ---> d7bb141cb303\nStep 14/24 : RUN apk del .build-deps\n ---> Running in e26a8e0e2018\n\u001b[91mWARNING: Ignoring https://dl-cdn.alpinelinux.org/alpine/v3.14/main: No such file or directory\nWARNING: Ignoring https://dl-cdn.alpinelinux.org/alpine/v3.14/community: No such file or directory\n\u001b[0m(1/44) Purging .build-deps (20230101.151214)\n(2/44) Purging alpine-sdk (1.0-r1)\n(3/44) Purging abuild (3.8.0_rc4-r0)\n(4/44) Purging fakeroot (1.25.3-r3)\n(5/44) Purging openssl (1.1.1s-r0)\n(6/44) Purging attr (2.5.1-r0)\n(7/44) Purging tar (1.34-r0)\n(8/44) Purging pkgconf (1.7.4-r0)\n(9/44) Purging lzip (1.22-r0)\n(10/44) Purging curl (7.79.1-r4)\n(11/44) Purging build-base (0.5-r3)\n(12/44) Purging file (5.40-r1)\n(13/44) Purging fortify-headers (1.1-r1)\n(14/44) Purging patch (2.7.6-r7)\n(15/44) Purging git (2.32.4-r0)\n(16/44) Purging make (4.3-r0)\n(17/44) Purging g++ (10.3.1_git20210424-r2)\n(18/44) Purging gcc (10.3.1_git20210424-r2)\n(19/44) Purging binutils (2.35.2-r2)\n(20/44) Purging libatomic (10.3.1_git20210424-r2)\n(21/44) Purging libgomp (10.3.1_git20210424-r2)\n(22/44) Purging libgphobos (10.3.1_git20210424-r2)\n(23/44) Purging libc-dev (0.7.2-r3)\n(24/44) Purging musl-dev (1.2.2-r3)\n(25/44) Purging python3 (3.9.16-r0)\n(26/44) Purging libattr (2.5.1-r0)\n(27/44) Purging libacl (2.2.53-r0)\n(28/44) Purging libcurl (7.79.1-r4)\n(29/44) Purging libmagic (5.40-r1)\n(30/44) Purging mpc1 (1.2.1-r0)\n(31/44) Purging mpfr4 (4.1.0-r0)\n(32/44) Purging isl22 (0.22-r0)\n(33/44) Purging gmp (6.2.1-r1)\n(34/44) Purging expat (2.5.0-r0)\n(35/44) Purging pcre2 (10.36-r1)\n(36/44) Purging libbz2 (1.0.8-r1)\n(37/44) Purging libffi (3.3-r2)\n(38/44) Purging gdbm (1.19-r0)\n(39/44) Purging xz-libs (5.2.5-r1)\n(40/44) Purging mpdecimal (2.5.1-r1)\n(41/44) Purging readline (8.1.0-r0)\n(42/44) Purging ncurses-libs (6.2_p20210612-r1)\n(43/44) Purging ncurses-terminfo-base (6.2_p20210612-r1)\n(44/44) Purging sqlite-libs (3.35.5-r0)\nExecuting busybox-1.33.1-r8.trigger\nOK: 58 MiB in 24 packages\nRemoving intermediate container e26a8e0e2018\n ---> c2bcd161e29a\nStep 15/24 : WORKDIR /tmp/app\n ---> Running in 7bf6f410ada5\nRemoving intermediate container 7bf6f410ada5\n ---> 37577703e9f4\nStep 16/24 : FROM base as runtime\n ---> a5dcd9cff9a1\nStep 17/24 : COPY --chown=octofarm:octofarm --from=compiler /tmp/app/server/node_modules /app/server/node_modules\n ---> 9788e896d325\nStep 18/24 : COPY --chown=octofarm:octofarm . /app\n ---> e64f13e64fbe\nStep 19/24 : RUN rm -rf /tmp/app\n ---> Running in a58cec07a6fa\nRemoving intermediate container a58cec07a6fa\n ---> 2990cbf05439\nStep 20/24 : USER octofarm\n ---> Running in 1a5678d1c716\nRemoving intermediate container 1a5678d1c716\n ---> 04b91ecfe9d2\nStep 21/24 : WORKDIR /app\n ---> Running in 62dfecf25f77\nRemoving intermediate container 62dfecf25f77\n ---> 770c00ae26c4\nStep 22/24 : RUN chmod +x ./docker/entrypoint.sh\n ---> Running in 32082b1d3766\nRemoving intermediate container 32082b1d3766\n ---> 64fdca1d25f6\nStep 23/24 : ENTRYPOINT [ \"/sbin/tini\", \"--\" ]\n ---> Running in 48b4604bc47b\nRemoving intermediate container 48b4604bc47b\n ---> c27d88d27927\nStep 24/24 : CMD [\"./docker/entrypoint.sh\"]\n ---> Running in e2690285b402\nRemoving intermediate container e2690285b402\n ---> a121cea0ec4a\nSuccessfully built a121cea0ec4a\nSuccessfully tagged octofarm:latest\n","stderr":"","imageSize":234448708},"repair":{"violations":[{"name":"npmCacheCleanAfterInstall","position":{"start":11,"end":11,"columnStart":4,"columnEnd":29}},{"name":"npmCacheCleanAfterInstall","position":{"start":12,"end":12,"columnStart":4,"columnEnd":22}}],"repairedDockerfile":"# Results in NodeJS 14.17.0\nFROM alpine:3.14 as base\n\nRUN apk add --no-cache --virtual .base-deps \\\n    nodejs \\\n    npm \\\n    tini\n\nENV NODE_ENV=production\n\nRUN npm install -g npm@latest\nRUN npm install -g pm2\n\nRUN adduser -D /app octofarm --home && \\\n    mkdir -p /scripts && \\\n    chown -R octofarm:octofarm /scripts/\n\nFROM base as compiler\n\nRUN apk add --no-cache --virtual .build-deps \\\n    alpine-sdk \\\n    make \\\n    gcc \\\n    g++ \\\n    python3\n\nWORKDIR /tmp/app\n\nCOPY server/package.json ./server/package.json\nCOPY server/package-lock.json ./server/package-lock.json\n\nWORKDIR /tmp/app/server\n\nRUN npm ci --omit=dev\n\nRUN apk del .build-deps\n\nWORKDIR /tmp/app\n\nFROM base as runtime\n\nCOPY --chown=octofarm:octofarm --from=compiler /tmp/app/server/node_modules /app/server/node_modules\nCOPY --chown=octofarm:octofarm . /app\n\nRUN rm -rf /tmp/app\n\nUSER octofarm\nWORKDIR /app\n\nRUN chmod +x ./docker/entrypoint.sh\nENTRYPOINT [ \"/sbin/tini\", \"--\" ]\nCMD [\"./docker/entrypoint.sh\"]"},"repairedBuild":{"startTimestamp":1672586061818,"endTimestamp":1672586110659,"error":{"code":1,"killed":false,"signal":null,"cmd":"docker build --no-cache --force-rm -t octofarm:latest -f /tmp/dinghy-analysis/notexpectedyet/octofarm/Dockerfile ."},"stdout":"Sending build context to Docker daemon  61.62MB\r\r\nStep 1/24 : FROM alpine:3.14 as base\n ---> dd53f409bf0b\nStep 2/24 : RUN apk add --no-cache --virtual .base-deps     nodejs     npm     tini\n ---> Running in b45921e5d1f2\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.14/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.14/community/x86_64/APKINDEX.tar.gz\n(1/10) Installing ca-certificates (20220614-r0)\n(2/10) Installing nghttp2-libs (1.43.0-r0)\n(3/10) Installing brotli-libs (1.0.9-r5)\n(4/10) Installing c-ares (1.17.2-r0)\n(5/10) Installing libgcc (10.3.1_git20210424-r2)\n(6/10) Installing libstdc++ (10.3.1_git20210424-r2)\n(7/10) Installing nodejs (14.20.1-r0)\n(8/10) Installing npm (7.17.0-r0)\n(9/10) Installing tini (0.19.0-r0)\n(10/10) Installing .base-deps (20230101.151425)\nExecuting busybox-1.33.1-r8.trigger\nExecuting ca-certificates-20220614-r0.trigger\nOK: 58 MiB in 24 packages\nRemoving intermediate container b45921e5d1f2\n ---> 01a16f09c3ba\nStep 3/24 : ENV NODE_ENV=production\n ---> Running in dde4a3931f6d\nRemoving intermediate container dde4a3931f6d\n ---> e0889196acae\nStep 4/24 : RUN npm install -g npm@latest\n ---> Running in b1e10f9fd0a9\n\nadded 1 package, and audited 232 packages in 2s\n\n14 packages are looking for funding\n  run `npm fund` for details\n\nfound 0 vulnerabilities\nRemoving intermediate container b1e10f9fd0a9\n ---> 58784fa0c46f\nStep 5/24 : RUN npm install -g pm2\n ---> Running in f08a5b664e4a\n\u001b[91mnpm WARN deprecated uuid@3.4.0: Please upgrade  to version 7 or higher.  Older versions may use Math.random() in certain circumstances, which is known to be problematic.  See https://v8.dev/blog/math-random for details.\n\u001b[0m\nadded 184 packages in 9s\n\n12 packages are looking for funding\n  run `npm fund` for details\nRemoving intermediate container f08a5b664e4a\n ---> e7152055a3d4\nStep 6/24 : RUN adduser -D /app octofarm --home &&     mkdir -p /scripts &&     chown -R octofarm:octofarm /scripts/\n ---> Running in 4a3383af3378\n\u001b[91madduser: option requires an argument: home\n\u001b[0m\u001b[91mBusyBox v1.33.1 () multi-call binary.\n\nUsage: adduser [OPTIONS] USER [GROUP]\n\nCreate new user, or add USER to GROUP\n\n\t-h DIR\t\tHome directory\n\t-g GECOS\tGECOS field\n\t-s SHELL\tLogin shell\n\t-G GRP\t\tGroup\n\t-S\t\tCreate a system user\n\t-D\t\tDon't assign a password\n\t-H\t\tDon't create home directory\n\t-u UID\t\tUser id\n\t-k SKEL\t\tSkeleton directory (/etc/skel)\n\u001b[0mRemoving intermediate container 4a3383af3378\n","stderr":"The command '/bin/sh -c adduser -D /app octofarm --home &&     mkdir -p /scripts &&     chown -R octofarm:octofarm /scripts/' returned a non-zero code: 1\n"},"endTime":1672586110749}