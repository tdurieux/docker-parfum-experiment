{"repository":"https://github.com/alphagov/content-store","dockerfilePath":"Dockerfile","startTime":1672867485299,"endTime":1672867589892,"clone":{"startTime":1672867485300,"stdout":"","stderr":"Cloning into '/tmp/dinghy-analysis/alphagov/content-store'...\n","error":null,"endTime":1672867486246,"commit":"452c4b71a7350df18a85617c0c4bb713e664915e"},"originalBuild":{"startTime":1672867486331,"endTime":1672867587947,"error":null,"stdout":"Sending build context to Docker daemon  198.7kB\r\r\nStep 1/14 : ARG base_image=ghcr.io/alphagov/govuk-ruby-base:3.1.2\nStep 2/14 : ARG builder_image=ghcr.io/alphagov/govuk-ruby-builder:3.1.2\nStep 3/14 : FROM $builder_image AS builder\n3.1.2: Pulling from alphagov/govuk-ruby-builder\n6e3729cf69e0: Already exists\n9ed578074b1a: Pulling fs layer\n02b53ac527fc: Pulling fs layer\nf8da887a8cac: Pulling fs layer\nca0762064fad: Pulling fs layer\n2064e02aa443: Pulling fs layer\n697ea29b76e7: Pulling fs layer\n01a0ce535e3f: Pulling fs layer\n3c8a917351b0: Pulling fs layer\n61d08558db01: Pulling fs layer\nc9b599fe367b: Pulling fs layer\n1577f1d76e07: Pulling fs layer\nf1e6f96d7fb3: Pulling fs layer\ne9b2a1cb21c0: Pulling fs layer\n3ea2c1545d38: Pulling fs layer\n92734e53a0df: Pulling fs layer\n2064e02aa443: Waiting\nbb699660c937: Pulling fs layer\n697ea29b76e7: Waiting\nd0ecf1301853: Pulling fs layer\nf491c7daf300: Pulling fs layer\n088b48a7438b: Pulling fs layer\n4b209c130eb0: Pulling fs layer\nca0762064fad: Waiting\n92734e53a0df: Waiting\n3c8a917351b0: Waiting\nf491c7daf300: Waiting\n088b48a7438b: Waiting\ne9b2a1cb21c0: Waiting\n4b209c130eb0: Waiting\nf1e6f96d7fb3: Waiting\n61d08558db01: Waiting\n1577f1d76e07: Waiting\n3ea2c1545d38: Waiting\nc9b599fe367b: Waiting\nbb699660c937: Waiting\nd0ecf1301853: Waiting\n9ed578074b1a: Verifying Checksum\n9ed578074b1a: Download complete\n02b53ac527fc: Verifying Checksum\n02b53ac527fc: Download complete\nf8da887a8cac: Verifying Checksum\nf8da887a8cac: Download complete\n9ed578074b1a: Pull complete\n02b53ac527fc: Pull complete\n2064e02aa443: Verifying Checksum\n2064e02aa443: Download complete\nf8da887a8cac: Pull complete\n697ea29b76e7: Verifying Checksum\n697ea29b76e7: Download complete\n01a0ce535e3f: Verifying Checksum\n01a0ce535e3f: Download complete\nca0762064fad: Verifying Checksum\nca0762064fad: Download complete\n3c8a917351b0: Verifying Checksum\n61d08558db01: Verifying Checksum\n61d08558db01: Download complete\nc9b599fe367b: Verifying Checksum\nc9b599fe367b: Download complete\n1577f1d76e07: Verifying Checksum\n1577f1d76e07: Download complete\ne9b2a1cb21c0: Download complete\n3ea2c1545d38: Download complete\nf1e6f96d7fb3: Verifying Checksum\nf1e6f96d7fb3: Download complete\nbb699660c937: Verifying Checksum\n92734e53a0df: Verifying Checksum\nbb699660c937: Download complete\n92734e53a0df: Download complete\nf491c7daf300: Verifying Checksum\nf491c7daf300: Download complete\nd0ecf1301853: Verifying Checksum\nd0ecf1301853: Download complete\n4b209c130eb0: Verifying Checksum\n4b209c130eb0: Download complete\nca0762064fad: Pull complete\n2064e02aa443: Pull complete\n697ea29b76e7: Pull complete\n088b48a7438b: Verifying Checksum\n088b48a7438b: Download complete\n01a0ce535e3f: Pull complete\n3c8a917351b0: Pull complete\n61d08558db01: Pull complete\nc9b599fe367b: Pull complete\n1577f1d76e07: Pull complete\nf1e6f96d7fb3: Pull complete\ne9b2a1cb21c0: Pull complete\n3ea2c1545d38: Pull complete\n92734e53a0df: Pull complete\nbb699660c937: Pull complete\nd0ecf1301853: Pull complete\nf491c7daf300: Pull complete\n088b48a7438b: Pull complete\n4b209c130eb0: Pull complete\nDigest: sha256:0fc6e07708b50c6ba04c599ebd5897c158325f69f0dc99863f3406ff7f3c9f89\nStatus: Downloaded newer image for ghcr.io/alphagov/govuk-ruby-builder:3.1.2\n ---> 85c6ac4e7a0a\nStep 4/14 : WORKDIR /app\n ---> Running in 0e8c09affb7c\nRemoving intermediate container 0e8c09affb7c\n ---> 6083b7a3e78c\nStep 5/14 : COPY Gemfile* .ruby-version /app/\n ---> c12173f3b2e3\nStep 6/14 : RUN bundle install\n ---> Running in c54b1d2f79ce\n\u001b[91mINFO: with_tmpdir_for_ruby: execing bundle with TMPDIR=/tmp/ruby-app-TEfFCXz2\n\u001b[0mBundler 2.3.26 is running, but your lockfile was generated with 2.3.22. Installing Bundler 2.3.22 and restarting using that version.\nFetching gem metadata from https://rubygems.org/.\nFetching bundler 2.3.22\nInstalling bundler 2.3.22\nFetching gem metadata from https://rubygems.org/.........\nFetching rake 13.0.6\nInstalling rake 13.0.6\nFetching erubi 1.11.0\nFetching racc 1.6.1\nFetching nio4r 2.5.8\nFetching builder 3.2.4\nFetching timeout 0.3.0\nFetching mini_mime 1.1.2\nFetching concurrent-ruby 1.1.10\nFetching minitest 5.16.3\nFetching crass 1.0.6\nFetching rack 2.2.4\nFetching websocket-extensions 0.1.5\nFetching marcel 1.0.2\nInstalling timeout 0.3.0\nInstalling erubi 1.11.0\nInstalling websocket-extensions 0.1.5\nInstalling crass 1.0.6\nInstalling builder 3.2.4\nInstalling mini_mime 1.1.2\nInstalling marcel 1.0.2\nInstalling racc 1.6.1 with native extensions\nFetching public_suffix 5.0.0\nInstalling minitest 5.16.3\nUsing bundler 2.3.22\nFetching bson 4.15.0\nFetching chronic 0.10.2\nInstalling nio4r 2.5.8 with native extensions\nInstalling rack 2.2.4\nInstalling chronic 0.10.2\nFetching unf_ext 0.0.8.2\nFetching faraday-net_http 3.0.2\nInstalling public_suffix 5.0.0\nInstalling faraday-net_http 3.0.2\nUsing ruby2_keywords 0.0.5\nFetching link_header 0.0.8\nInstalling bson 4.15.0 with native extensions\nInstalling link_header 0.0.8\nInstalling concurrent-ruby 1.1.10\nFetching null_logger 0.0.1\nFetching plek 5.0.0\nInstalling plek 5.0.0\nFetching http-accept 1.7.0\nFetching netrc 0.11.0\nFetching mime-types-data 3.2022.0105\nInstalling unf_ext 0.0.8.2 with native extensions\nInstalling netrc 0.11.0\nInstalling http-accept 1.7.0\nInstalling null_logger 0.0.1\nInstalling mime-types-data 3.2022.0105\nFetching jwt 2.5.0\nFetching multi_xml 0.6.0\nFetching hashie 5.0.0\nInstalling multi_xml 0.6.0\nInstalling hashie 5.0.0\nInstalling jwt 2.5.0\nFetching version_gem 1.1.1\nInstalling version_gem 1.1.1\nFetching method_source 1.0.0\nFetching thor 1.2.1\nInstalling method_source 1.0.0\nInstalling thor 1.2.1\nFetching zeitwerk 2.6.6\nInstalling zeitwerk 2.6.6\nFetching webrick 1.7.0\nFetching statsd-ruby 1.5.0\nFetching kgio 2.11.4\nInstalling statsd-ruby 1.5.0\nFetching raindrops 0.20.0\nInstalling webrick 1.7.0\nInstalling kgio 2.11.4 with native extensions\nFetching uuidtools 2.2.0\nInstalling raindrops 0.20.0 with native extensions\nFetching net-protocol 0.1.3\nInstalling uuidtools 2.2.0\nInstalling net-protocol 0.1.3\nFetching websocket-driver 0.7.5\nInstalling websocket-driver 0.7.5 with native extensions\nFetching mail 2.7.1\nFetching faraday 2.7.1\nFetching addressable 2.8.1\nInstalling faraday 2.7.1\nFetching whenever 1.0.0\nInstalling addressable 2.8.1\nInstalling whenever 1.0.0\nFetching mime-types 3.4.1\nInstalling mail 2.7.1\nInstalling mime-types 3.4.1\nFetching rack-test 2.0.2\nFetching rack-protection 3.0.3\nFetching warden 1.2.9\nFetching request_store 1.5.1\nInstalling rack-test 2.0.2\nInstalling rack-protection 3.0.3\nInstalling warden 1.2.9\nInstalling request_store 1.5.1\nFetching rack-proxy 0.7.4\nInstalling rack-proxy 0.7.4\nFetching rack-cache 1.13.0\nFetching snaky_hash 2.0.1\nFetching net-imap 0.3.1\nInstalling rack-cache 1.13.0\nInstalling snaky_hash 2.0.1\nInstalling net-imap 0.3.1\nFetching net-pop 0.1.2\nFetching net-smtp 0.3.3\nFetching prometheus_exporter 2.0.6\nInstalling net-pop 0.1.2\nInstalling net-smtp 0.3.3\nFetching i18n 1.12.0\nInstalling prometheus_exporter 2.0.6\nFetching tzinfo 2.0.5\nFetching sentry-ruby 5.7.0\nFetching nokogiri 1.13.10 (x86_64-linux)\nInstalling i18n 1.12.0\nFetching warden-oauth2 0.0.1\nInstalling sentry-ruby 5.7.0\nInstalling tzinfo 2.0.5\nFetching omniauth 2.1.0\nInstalling omniauth 2.1.0\nFetching oauth2 2.0.9\nInstalling oauth2 2.0.9\nInstalling warden-oauth2 0.0.1\nFetching activesupport 7.0.4\nFetching mongo 2.15.0\nFetching unf 0.1.4\nFetching omniauth-oauth2 1.8.0\nInstalling unf 0.1.4\nInstalling activesupport 7.0.4\nInstalling omniauth-oauth2 1.8.0\nFetching domain_name 0.5.20190701\nInstalling domain_name 0.5.20190701\nFetching http-cookie 1.0.5\nInstalling http-cookie 1.0.5\nFetching rest-client 2.1.0\nInstalling rest-client 2.1.0\nFetching gds-api-adapters 85.0.0\nFetching globalid 1.0.0\nFetching activemodel 7.0.4\nFetching logstasher 2.1.5\nInstalling gds-api-adapters 85.0.0\nInstalling globalid 1.0.0\nInstalling logstasher 2.1.5\nInstalling activemodel 7.0.4\nInstalling mongo 2.15.0\nFetching activejob 7.0.4\nFetching puma 6.0.0\nInstalling activejob 7.0.4\nInstalling nokogiri 1.13.10 (x86_64-linux)\nInstalling puma 6.0.0 with native extensions\nFetching activerecord 7.0.4\nInstalling activerecord 7.0.4\nFetching rails-dom-testing 2.0.3\nFetching loofah 2.19.1\nInstalling rails-dom-testing 2.0.3\nInstalling loofah 2.19.1\nFetching rails-html-sanitizer 1.4.4\nInstalling rails-html-sanitizer 1.4.4\nFetching actionview 7.0.4\nInstalling actionview 7.0.4\nFetching actionpack 7.0.4\nInstalling actionpack 7.0.4\nFetching railties 7.0.4\nFetching activestorage 7.0.4\nFetching actionmailer 7.0.4\nFetching actioncable 7.0.4\nInstalling actionmailer 7.0.4\nInstalling actioncable 7.0.4\nInstalling activestorage 7.0.4\nInstalling railties 7.0.4\nFetching actionmailbox 7.0.4\nFetching actiontext 7.0.4\nInstalling actionmailbox 7.0.4\nInstalling actiontext 7.0.4\nFetching mongoid 7.5.2\nInstalling mongoid 7.5.2\nFetching rails 7.0.4\nFetching sentry-rails 5.7.0\nInstalling rails 7.0.4\nInstalling sentry-rails 5.7.0\nFetching gds-sso 17.1.1\nInstalling gds-sso 17.1.1\nFetching unicorn 6.1.0\nInstalling unicorn 6.1.0 with native extensions\nFetching govuk_app_config 4.11.1\nInstalling govuk_app_config 4.11.1\nBundle complete! 26 Gemfile dependencies, 94 gems now installed.\nGems in the groups 'development', 'test' and 'cucumber' were not installed.\nBundled gems are installed into `/usr/local/bundle`\nRemoving intermediate container c54b1d2f79ce\n ---> efa376185348\nStep 7/14 : COPY . /app\n ---> d381892c0a16\nStep 8/14 : FROM $base_image\n3.1.2: Pulling from alphagov/govuk-ruby-base\n6e3729cf69e0: Already exists\n9ed578074b1a: Already exists\n02b53ac527fc: Already exists\nf8da887a8cac: Already exists\nca0762064fad: Already exists\n2064e02aa443: Already exists\n697ea29b76e7: Already exists\n01a0ce535e3f: Already exists\n3c8a917351b0: Already exists\n61d08558db01: Already exists\nc9b599fe367b: Already exists\n1577f1d76e07: Already exists\nf1e6f96d7fb3: Already exists\ne9b2a1cb21c0: Already exists\n3ea2c1545d38: Already exists\n92734e53a0df: Already exists\nbb699660c937: Already exists\nd0ecf1301853: Already exists\nf491c7daf300: Already exists\nDigest: sha256:fce05ecdb079beff03d080fa35f787925a83faab8fb6d7141fb59cd6ebf824bb\nStatus: Downloaded newer image for ghcr.io/alphagov/govuk-ruby-base:3.1.2\n ---> e4a1ce37f1c5\nStep 9/14 : ENV GOVUK_APP_NAME=content-store\n ---> Running in dbfbff8081de\nRemoving intermediate container dbfbff8081de\n ---> 2039bc2d96d5\nStep 10/14 : WORKDIR /app\n ---> Running in c93b3aa51d07\nRemoving intermediate container c93b3aa51d07\n ---> 23ea70404087\nStep 11/14 : COPY --from=builder /usr/local/bundle/ /usr/local/bundle/\n ---> dda3a36335f5\nStep 12/14 : COPY --from=builder /app /app/\n ---> ea93e98666a2\nStep 13/14 : USER app\n ---> Running in da3cf9ed97df\nRemoving intermediate container da3cf9ed97df\n ---> c796f0b76329\nStep 14/14 : CMD [\"bundle\", \"exec\", \"puma\"]\n ---> Running in 4e58bf8d76c6\nRemoving intermediate container 4e58bf8d76c6\n ---> 0fe7018c0086\nSuccessfully built 0fe7018c0086\nSuccessfully tagged content-store:latest\n","stderr":"","imageSize":379590696},"repair":{"startTime":1672867588014,"endTime":1672867588027,"violations":[],"repairedDockerfile":"ARG base_image=ghcr.io/alphagov/govuk-ruby-base:3.1.2\nARG builder_image=ghcr.io/alphagov/govuk-ruby-builder:3.1.2\n\nFROM $builder_image AS builder\n\nWORKDIR /app\n\nCOPY Gemfile* .ruby-version /app/\nRUN bundle install\n\nCOPY . /app\n\n\nFROM $base_image\n\nENV GOVUK_APP_NAME=content-store\n\nWORKDIR /app\n\nCOPY --from=builder /usr/local/bundle/ /usr/local/bundle/\nCOPY --from=builder /app /app/\n\nUSER app\n\nCMD [\"bundle\", \"exec\", \"puma\"]\n"}}