{"repository":"https://github.com/alphagov/search-api","dockerfilePath":"Dockerfile","startTime":1672003848409,"clone":{"stdout":"","stderr":"Cloning into '/tmp/dinghy-analysis/alphagov/search-api'...\n","error":null,"commit":"5d5694f9ff9e714d332f8f590768c9de57bdd1a2"},"originalBuild":{"startTimestamp":1672003850052,"endTimestamp":1672003923283,"error":null,"stdout":"Sending build context to Docker daemon  1.025MB\r\r\nStep 1/14 : ARG base_image=ghcr.io/alphagov/govuk-ruby-base:2.7.6\nStep 2/14 : ARG builder_image=ghcr.io/alphagov/govuk-ruby-builder:2.7.6\nStep 3/14 : FROM $builder_image AS builder\n2.7.6: Pulling from alphagov/govuk-ruby-builder\n6e3729cf69e0: Already exists\n9ed578074b1a: Pulling fs layer\na293fbc481d2: Pulling fs layer\n66d6249f7723: Pulling fs layer\n0ccab39fa2b7: Pulling fs layer\n7ed245faf103: Pulling fs layer\ne285f360bd2d: Pulling fs layer\na694e73ecbdb: Pulling fs layer\ncade44e1873f: Pulling fs layer\n71c24a54be1c: Pulling fs layer\n0ccab39fa2b7: Waiting\n79757db74ad2: Pulling fs layer\n7ed245faf103: Waiting\n1ada2f983041: Pulling fs layer\n7f1cf08454f7: Pulling fs layer\ne285f360bd2d: Waiting\ncade44e1873f: Waiting\n2d231cfef723: Pulling fs layer\n79757db74ad2: Waiting\n71c24a54be1c: Waiting\nc2c618a94b10: Pulling fs layer\n7f1cf08454f7: Waiting\n2d231cfef723: Waiting\n5726ca8dd778: Pulling fs layer\nc2c618a94b10: Waiting\n1ada2f983041: Waiting\n3f67163c0e4b: Pulling fs layer\n5726ca8dd778: Waiting\n5167c0960a61: Pulling fs layer\n3f67163c0e4b: Waiting\nbbbfd58288e7: Pulling fs layer\nc02c062d696e: Pulling fs layer\n539b618c67a4: Pulling fs layer\n539b618c67a4: Waiting\n9ed578074b1a: Download complete\n66d6249f7723: Verifying Checksum\n66d6249f7723: Download complete\n9ed578074b1a: Pull complete\n7ed245faf103: Verifying Checksum\n7ed245faf103: Download complete\n0ccab39fa2b7: Verifying Checksum\n0ccab39fa2b7: Download complete\ne285f360bd2d: Verifying Checksum\ne285f360bd2d: Download complete\na694e73ecbdb: Verifying Checksum\na694e73ecbdb: Download complete\ncade44e1873f: Verifying Checksum\ncade44e1873f: Download complete\n71c24a54be1c: Verifying Checksum\n71c24a54be1c: Download complete\n79757db74ad2: Verifying Checksum\n79757db74ad2: Download complete\na293fbc481d2: Download complete\n1ada2f983041: Verifying Checksum\n1ada2f983041: Download complete\n2d231cfef723: Download complete\nc2c618a94b10: Verifying Checksum\nc2c618a94b10: Download complete\na293fbc481d2: Pull complete\n5726ca8dd778: Verifying Checksum\n5726ca8dd778: Download complete\n66d6249f7723: Pull complete\n3f67163c0e4b: Download complete\n5167c0960a61: Verifying Checksum\n5167c0960a61: Download complete\n7f1cf08454f7: Verifying Checksum\n7f1cf08454f7: Download complete\nbbbfd58288e7: Verifying Checksum\n539b618c67a4: Download complete\n0ccab39fa2b7: Pull complete\n7ed245faf103: Pull complete\ne285f360bd2d: Pull complete\na694e73ecbdb: Pull complete\ncade44e1873f: Pull complete\n71c24a54be1c: Pull complete\n79757db74ad2: Pull complete\n1ada2f983041: Pull complete\nc02c062d696e: Verifying Checksum\nc02c062d696e: Download complete\n7f1cf08454f7: Pull complete\n2d231cfef723: Pull complete\nc2c618a94b10: Pull complete\n5726ca8dd778: Pull complete\n3f67163c0e4b: Pull complete\n5167c0960a61: Pull complete\nbbbfd58288e7: Pull complete\nc02c062d696e: Pull complete\n539b618c67a4: Pull complete\nDigest: sha256:c1a65721f10d1ef211f6eed20ad5f838f526b58e88da7d821b20d395a2eb6957\nStatus: Downloaded newer image for ghcr.io/alphagov/govuk-ruby-builder:2.7.6\n ---> b426d9924fb4\nStep 4/14 : WORKDIR /app\n ---> Running in 71d1ccb92e7a\nRemoving intermediate container 71d1ccb92e7a\n ---> 6caeb01be7fb\nStep 5/14 : COPY Gemfile* .ruby-version /app/\n ---> e9ebaeecc8d2\nStep 6/14 : RUN bundle install\n ---> Running in 6939699d74e0\n\u001b[91mINFO: with_tmpdir_for_ruby: execing bundle with TMPDIR=/tmp/ruby-app-Dy4wuwsS\n\u001b[0mBundler 2.3.26 is running, but your lockfile was generated with 2.1.4. Installing Bundler 2.1.4 and restarting using that version.\nFetching gem metadata from https://rubygems.org/.\nFetching bundler 2.1.4\nInstalling bundler 2.1.4\nFetching gem metadata from https://rubygems.org/.......\nFetching rake 13.0.6\nInstalling rake 13.0.6\nFetching public_suffix 5.0.1\nFetching amq-protocol 2.3.2\nFetching minitest 5.16.3\nFetching builder 3.2.4\nFetching crass 1.0.6\nFetching rack 2.2.3.1\nFetching mini_portile2 2.8.0\nFetching aws-eventstream 1.2.0\nFetching erubi 1.11.0\nFetching concurrent-ruby 1.1.10\nFetching racc 1.6.1\nInstalling aws-eventstream 1.2.0\nInstalling erubi 1.11.0\nInstalling crass 1.0.6\nInstalling mini_portile2 2.8.0\nInstalling builder 3.2.4\nInstalling amq-protocol 2.3.2\nInstalling racc 1.6.1 with native extensions\nInstalling minitest 5.16.3\nInstalling public_suffix 5.0.1\nInstalling rack 2.2.3.1\nFetching aws-partitions 1.591.0\nFetching jmespath 1.6.1\nInstalling aws-partitions 1.591.0\nFetching msgpack 1.5.1\nInstalling jmespath 1.6.1\nInstalling concurrent-ruby 1.1.10\nInstalling msgpack 1.5.1 with native extensions\nUsing bundler 2.1.4\nFetching rbtree 0.4.6\nFetching set 1.0.3\nFetching connection_pool 2.2.5\nInstalling rbtree 0.4.6 with native extensions\nInstalling set 1.0.3\nInstalling connection_pool 2.2.5\nFetching declarative 0.0.20\nFetching unf_ext 0.0.8.2\nInstalling declarative 0.0.20\nFetching multi_json 1.15.0\nFetching faraday-em_http 1.0.0\nFetching faraday-em_synchrony 1.0.0\nFetching faraday-excon 1.1.0\nInstalling multi_json 1.15.0\nInstalling faraday-em_http 1.0.0\nInstalling faraday-em_synchrony 1.0.0\nInstalling faraday-excon 1.1.0\nFetching faraday-httpclient 1.0.1\nInstalling faraday-httpclient 1.0.1\nFetching multipart-post 2.1.1\nFetching faraday-net_http 1.0.1\nFetching faraday-net_http_persistent 1.2.0\nInstalling faraday-net_http 1.0.1\nInstalling multipart-post 2.1.1\nInstalling faraday-net_http_persistent 1.2.0\nFetching faraday-patron 1.0.0\nFetching faraday-rack 1.0.0\nInstalling unf_ext 0.0.8.2 with native extensions\nFetching faraday-retry 1.0.3\nInstalling faraday-rack 1.0.0\nInstalling faraday-patron 1.0.0\nInstalling faraday-retry 1.0.3\nFetching ruby2_keywords 0.0.5\nFetching link_header 0.0.8\nInstalling ruby2_keywords 0.0.5\nFetching null_logger 0.0.1\nFetching plek 5.0.0\nFetching http-accept 1.7.0\nFetching mime-types-data 3.2022.0105\nInstalling http-accept 1.7.0\nFetching netrc 0.11.0\nInstalling link_header 0.0.8\nInstalling mime-types-data 3.2022.0105\nFetching gems 1.2.0\nInstalling plek 5.0.0\nInstalling gems 1.2.0\nInstalling netrc 0.11.0\nInstalling null_logger 0.0.1\nFetching jwt 2.3.0\nFetching memoist 0.16.2\nInstalling memoist 0.16.2\nFetching os 1.1.4\nInstalling jwt 2.3.0\nFetching httpclient 2.8.3\nFetching mini_mime 1.1.2\nInstalling os 1.1.4\nFetching trailblazer-option 0.1.2\nInstalling mini_mime 1.1.2\nInstalling trailblazer-option 0.1.2\nFetching uber 0.1.0\nInstalling uber 0.1.0\nFetching retriable 3.1.2\nInstalling retriable 3.1.2\nInstalling httpclient 2.8.3\nFetching rexml 3.2.5\nFetching webrick 1.7.0\nFetching thor 1.2.1\nFetching google-cloud-errors 1.2.0\nFetching nio4r 2.5.8\nInstalling google-cloud-errors 1.2.0\nInstalling thor 1.2.1\nInstalling webrick 1.7.0\nInstalling rexml 3.2.5\nFetching method_source 1.0.0\nFetching zeitwerk 2.6.6\nInstalling method_source 1.0.0\nInstalling zeitwerk 2.6.6\nInstalling nio4r 2.5.8 with native extensions\nFetching statsd-ruby 1.5.0\nFetching kgio 2.11.4\nInstalling statsd-ruby 1.5.0\nFetching raindrops 0.20.0\nInstalling kgio 2.11.4 with native extensions\nFetching govuk_document_types 1.0.1\nInstalling raindrops 0.20.0 with native extensions\nFetching redis 4.6.0\nFetching multi_xml 0.6.0\nFetching io-console 0.5.11\nInstalling multi_xml 0.6.0\nInstalling redis 4.6.0\nFetching little-plugger 1.1.4\nInstalling io-console 0.5.11 with native extensions\nInstalling little-plugger 1.1.4\nInstalling govuk_document_types 1.0.1\nFetching logstash-event 1.2.02\nFetching oj 3.11.3\nFetching rainbow 3.1.1\nInstalling rainbow 3.1.1\nFetching rubyzip 2.3.2\nInstalling rubyzip 2.3.2\nInstalling logstash-event 1.2.02\nFetching tilt 2.0.10\nFetching aws-sigv4 1.5.0\nFetching addressable 2.8.1\nInstalling aws-sigv4 1.5.0\nInstalling tilt 2.0.10\nInstalling addressable 2.8.1\nFetching elasticsearch-api 6.8.3\nInstalling oj 3.11.3 with native extensions\nFetching rack-test 1.1.0\nInstalling elasticsearch-api 6.8.3\nInstalling rack-test 1.1.0\nFetching request_store 1.5.1\nFetching rack-proxy 0.7.4\nInstalling request_store 1.5.1\nInstalling rack-proxy 0.7.4\nFetching rack-protection 2.2.0\nInstalling rack-protection 2.2.0\nFetching warden 1.2.9\nFetching faraday-multipart 1.0.3\nInstalling warden 1.2.9\nInstalling faraday-multipart 1.0.3\nFetching mustermann 1.1.1\nFetching nokogiri 1.13.6 (x86_64-linux)\nFetching representable 3.2.0\nInstalling mustermann 1.1.1\nFetching i18n 1.12.0\nFetching tzinfo 2.0.5\nInstalling i18n 1.12.0\nInstalling representable 3.2.0\nInstalling tzinfo 2.0.5\nFetching sentry-ruby 5.7.0\nFetching mime-types 3.4.1\nFetching bootsnap 1.11.1\nInstalling mime-types 3.4.1\nInstalling sentry-ruby 5.7.0\nInstalling bootsnap 1.11.1 with native extensions\nFetching sorted_set 1.0.3\nInstalling sorted_set 1.0.3\nFetching prometheus_exporter 2.0.6\nFetching logging 2.3.1\nFetching redis-namespace 1.8.2\nInstalling prometheus_exporter 2.0.6\nInstalling redis-namespace 1.8.2\nInstalling logging 2.3.1\nFetching aws-sdk-core 3.131.1\nFetching rack-logstasher 1.0.2\nInstalling aws-sdk-core 3.131.1\nFetching json-schema 2.8.1\nInstalling json-schema 2.8.1\nInstalling rack-logstasher 1.0.2\nFetching unf 0.1.4\nFetching faraday 1.10.0\nFetching sidekiq 5.2.7\nFetching warden-oauth2 0.0.1\nInstalling unf 0.1.4\nInstalling faraday 1.10.0\nFetching sinatra 2.2.0\nInstalling sidekiq 5.2.7\nFetching reline 0.3.1\nFetching activesupport 7.0.3\nInstalling warden-oauth2 0.0.1\nInstalling reline 0.3.1\nInstalling sinatra 2.2.0\nInstalling activesupport 7.0.3\nFetching bunny 2.19.0\nFetching httparty 0.20.0\nInstalling httparty 0.20.0\nFetching puma 6.0.0\nInstalling bunny 2.19.0\nInstalling puma 6.0.0 with native extensions\nInstalling nokogiri 1.13.6 (x86_64-linux)\nFetching govuk_schemas 4.5.0\nFetching domain_name 0.5.20190701\nFetching irb 1.4.1\nInstalling domain_name 0.5.20190701\nFetching elasticsearch-transport 6.8.3\nInstalling irb 1.4.1\nInstalling govuk_schemas 4.5.0\nInstalling elasticsearch-transport 6.8.3\nFetching signet 0.16.1\nInstalling signet 0.16.1\nFetching google-cloud-env 1.6.0\nInstalling google-cloud-env 1.6.0\nFetching oauth2 1.4.9\nInstalling oauth2 1.4.9\nFetching aws-sdk-kms 1.57.0\nFetching aws-sdk-sagemaker 1.124.0\nFetching aws-sdk-sagemakerruntime 1.42.0\nFetching sidekiq-logging-json 0.0.19\nInstalling aws-sdk-sagemakerruntime 1.42.0\nInstalling aws-sdk-kms 1.57.0\nFetching sidekiq-limit_fetch 4.1.0\nInstalling sidekiq-limit_fetch 4.1.0\nFetching http-cookie 1.0.5\nInstalling sidekiq-logging-json 0.0.19\nInstalling http-cookie 1.0.5\nFetching govuk_message_queue_consumer 4.1.0\nFetching elasticsearch 6.8.3\nInstalling aws-sdk-sagemaker 1.124.0\nFetching google-cloud-core 1.6.0\nInstalling elasticsearch 6.8.3\nInstalling google-cloud-core 1.6.0\nFetching googleauth 1.1.3\nFetching aws-sdk-s3 1.114.0\nInstalling govuk_message_queue_consumer 4.1.0\nFetching rest-client 2.1.0\nInstalling googleauth 1.1.3\nFetching logstasher 2.1.5\nInstalling logstasher 2.1.5\nFetching sidekiq-statsd 2.1.0\nInstalling rest-client 2.1.0\nFetching google-apis-core 0.5.0\nInstalling aws-sdk-s3 1.114.0\nInstalling google-apis-core 0.5.0\nInstalling sidekiq-statsd 2.1.0\nFetching google-apis-discovery_v1 0.8.0\nFetching google-apis-bigquery_v2 0.33.0\nFetching gds-api-adapters 85.0.0\nInstalling google-apis-discovery_v1 0.8.0\nInstalling gds-api-adapters 85.0.0\nFetching google-apis-generator 0.4.1\nInstalling google-apis-generator 0.4.1\nFetching google-api-client 0.53.0\nInstalling google-apis-bigquery_v2 0.33.0\nFetching google-cloud-bigquery 1.38.1\nInstalling google-cloud-bigquery 1.38.1\nFetching rails-dom-testing 2.0.3\nFetching loofah 2.18.0\nInstalling rails-dom-testing 2.0.3\nInstalling loofah 2.18.0\nFetching rails-html-sanitizer 1.4.3\nInstalling rails-html-sanitizer 1.4.3\nFetching actionview 7.0.3\nInstalling actionview 7.0.3\nFetching actionpack 7.0.3\nInstalling actionpack 7.0.3\nFetching railties 7.0.3\nInstalling google-api-client 0.53.0\nInstalling railties 7.0.3\nFetching sentry-rails 5.7.0\nInstalling sentry-rails 5.7.0\nFetching unicorn 6.1.0\nInstalling unicorn 6.1.0 with native extensions\nFetching govuk_app_config 4.11.1\nInstalling govuk_app_config 4.11.1\nFetching govuk_sidekiq 5.0.0\nInstalling govuk_sidekiq 5.0.0\nBundle complete! 45 Gemfile dependencies, 140 gems now installed.\nGems in the groups development, test and cucumber were not installed.\nBundled gems are installed into `/usr/local/bundle`\nRemoving intermediate container 6939699d74e0\n ---> 00841c01db9a\nStep 7/14 : COPY . /app\n ---> ca9776708ff9\nStep 8/14 : FROM $base_image\n2.7.6: Pulling from alphagov/govuk-ruby-base\n6e3729cf69e0: Already exists\n9ed578074b1a: Already exists\na293fbc481d2: Already exists\n66d6249f7723: Already exists\n0ccab39fa2b7: Already exists\n7ed245faf103: Already exists\ne285f360bd2d: Already exists\na694e73ecbdb: Already exists\ncade44e1873f: Already exists\n71c24a54be1c: Already exists\n79757db74ad2: Already exists\n1ada2f983041: Already exists\n7f1cf08454f7: Already exists\n2d231cfef723: Already exists\nc2c618a94b10: Already exists\n5726ca8dd778: Already exists\n3f67163c0e4b: Already exists\n5167c0960a61: Already exists\nbbbfd58288e7: Already exists\nDigest: sha256:7564f1e673413bd237a8e5d9a694942083da9ecb195124bfe7ce27f3f8b91f52\nStatus: Downloaded newer image for ghcr.io/alphagov/govuk-ruby-base:2.7.6\n ---> 10a0db98f661\nStep 9/14 : ENV GOVUK_APP_NAME=search-api     LOG_TO_STDOUT=true\n ---> Running in d518555d333d\nRemoving intermediate container d518555d333d\n ---> 8ecc09f5d698\nStep 10/14 : COPY --from=builder /usr/local/bundle/ /usr/local/bundle/\n ---> 4810e5f08a53\nStep 11/14 : COPY --from=builder /app /app/\n ---> 0999c9056f52\nStep 12/14 : WORKDIR /app\n ---> Running in 7b6b225b32f0\nRemoving intermediate container 7b6b225b32f0\n ---> 274d0c282ca8\nStep 13/14 : USER app\n ---> Running in 80a7dad908e0\nRemoving intermediate container 80a7dad908e0\n ---> 7b43d8973f81\nStep 14/14 : CMD bundle exec puma\n ---> Running in 48f7e1675ce5\nRemoving intermediate container 48f7e1675ce5\n ---> a93ba3b6730a\nSuccessfully built a93ba3b6730a\nSuccessfully tagged search-api:latest\n","stderr":"","imageSize":424091683},"repair":{"violations":[],"repairedDockerfile":"ARG base_image=ghcr.io/alphagov/govuk-ruby-base:2.7.6\nARG builder_image=ghcr.io/alphagov/govuk-ruby-builder:2.7.6\n\nFROM $builder_image AS builder\n\nWORKDIR /app\n\nCOPY Gemfile* .ruby-version /app/\nRUN bundle install\n\nCOPY . /app\n\n\nFROM $base_image\n\nENV GOVUK_APP_NAME=search-api \\\n    LOG_TO_STDOUT=true\n\nCOPY --from=builder /usr/local/bundle/ /usr/local/bundle/\nCOPY --from=builder /app /app/\n\nWORKDIR /app\n\nUSER app\n\nCMD bundle exec puma\n"},"endTime":1672003924304}