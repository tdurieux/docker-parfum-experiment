{"repository":"https://github.com/alphagov/publishing-api","dockerfilePath":"Dockerfile","startTime":1672075177703,"clone":{"stdout":"","stderr":"Cloning into '/tmp/dinghy-analysis/alphagov/publishing-api'...\n","error":null,"commit":"a27db74a2ead7edc0d27d918e7ad499a180cccf3"},"originalBuild":{"startTimestamp":1672075178944,"endTimestamp":1672075310279,"error":null,"stdout":"Sending build context to Docker daemon  12.32MB\r\r\nStep 1/14 : ARG base_image=ghcr.io/alphagov/govuk-ruby-base:3.1.2\nStep 2/14 : ARG builder_image=ghcr.io/alphagov/govuk-ruby-builder:3.1.2\nStep 3/14 : FROM $builder_image AS builder\n3.1.2: Pulling from alphagov/govuk-ruby-builder\n6e3729cf69e0: Already exists\n9ed578074b1a: Pulling fs layer\n02b53ac527fc: Pulling fs layer\nf8da887a8cac: Pulling fs layer\nca0762064fad: Pulling fs layer\n2064e02aa443: Pulling fs layer\n697ea29b76e7: Pulling fs layer\n01a0ce535e3f: Pulling fs layer\n3c8a917351b0: Pulling fs layer\n61d08558db01: Pulling fs layer\nc9b599fe367b: Pulling fs layer\nca0762064fad: Waiting\n1577f1d76e07: Pulling fs layer\n697ea29b76e7: Waiting\nf1e6f96d7fb3: Pulling fs layer\n2064e02aa443: Waiting\n01a0ce535e3f: Waiting\ne9b2a1cb21c0: Pulling fs layer\n3ea2c1545d38: Pulling fs layer\n3c8a917351b0: Waiting\n92734e53a0df: Pulling fs layer\nbb699660c937: Pulling fs layer\n61d08558db01: Waiting\nd0ecf1301853: Pulling fs layer\nf491c7daf300: Pulling fs layer\nc9b599fe367b: Waiting\n088b48a7438b: Pulling fs layer\n4b209c130eb0: Pulling fs layer\n1577f1d76e07: Waiting\nf1e6f96d7fb3: Waiting\ne9b2a1cb21c0: Waiting\n3ea2c1545d38: Waiting\n92734e53a0df: Waiting\nbb699660c937: Waiting\n088b48a7438b: Waiting\n4b209c130eb0: Waiting\nd0ecf1301853: Waiting\nf491c7daf300: Waiting\n02b53ac527fc: Verifying Checksum\n02b53ac527fc: Download complete\nf8da887a8cac: Verifying Checksum\nf8da887a8cac: Download complete\n9ed578074b1a: Download complete\n9ed578074b1a: Pull complete\n02b53ac527fc: Pull complete\n2064e02aa443: Download complete\nf8da887a8cac: Pull complete\n697ea29b76e7: Verifying Checksum\n697ea29b76e7: Download complete\n01a0ce535e3f: Verifying Checksum\n01a0ce535e3f: Download complete\nca0762064fad: Download complete\n3c8a917351b0: Verifying Checksum\n3c8a917351b0: Download complete\n61d08558db01: Verifying Checksum\n61d08558db01: Download complete\nc9b599fe367b: Download complete\n1577f1d76e07: Verifying Checksum\n1577f1d76e07: Download complete\ne9b2a1cb21c0: Verifying Checksum\ne9b2a1cb21c0: Download complete\n3ea2c1545d38: Download complete\n92734e53a0df: Verifying Checksum\n92734e53a0df: Download complete\nbb699660c937: Download complete\nca0762064fad: Pull complete\n2064e02aa443: Pull complete\nd0ecf1301853: Verifying Checksum\nd0ecf1301853: Download complete\nf491c7daf300: Verifying Checksum\nf491c7daf300: Download complete\nf1e6f96d7fb3: Verifying Checksum\nf1e6f96d7fb3: Download complete\n697ea29b76e7: Pull complete\n01a0ce535e3f: Pull complete\n4b209c130eb0: Verifying Checksum\n4b209c130eb0: Download complete\n3c8a917351b0: Pull complete\n61d08558db01: Pull complete\nc9b599fe367b: Pull complete\n1577f1d76e07: Pull complete\n088b48a7438b: Verifying Checksum\n088b48a7438b: Download complete\nf1e6f96d7fb3: Pull complete\ne9b2a1cb21c0: Pull complete\n3ea2c1545d38: Pull complete\n92734e53a0df: Pull complete\nbb699660c937: Pull complete\nd0ecf1301853: Pull complete\nf491c7daf300: Pull complete\n088b48a7438b: Pull complete\n4b209c130eb0: Pull complete\nDigest: sha256:0fc6e07708b50c6ba04c599ebd5897c158325f69f0dc99863f3406ff7f3c9f89\nStatus: Downloaded newer image for ghcr.io/alphagov/govuk-ruby-builder:3.1.2\n ---> 85c6ac4e7a0a\nStep 4/14 : ENV GOVUK_APP_NAME=publishing-api\n ---> Running in 8c19c2c35412\nRemoving intermediate container 8c19c2c35412\n ---> fb838e3379ef\nStep 5/14 : WORKDIR /app\n ---> Running in adc11dc6f104\nRemoving intermediate container adc11dc6f104\n ---> eafdf951824b\nStep 6/14 : COPY Gemfile Gemfile.lock .ruby-version /app/\n ---> 5b93d613fd3d\nStep 7/14 : RUN bundle install\n ---> Running in 7da7ee7298a7\n\u001b[91mINFO: with_tmpdir_for_ruby: execing bundle with TMPDIR=/tmp/ruby-app-ttY5Ju9B\n\u001b[0mBundler 2.3.26 is running, but your lockfile was generated with 2.3.17. Installing Bundler 2.3.17 and restarting using that version.\nFetching gem metadata from https://rubygems.org/.\nFetching bundler 2.3.17\nInstalling bundler 2.3.17\nFetching gem metadata from https://rubygems.org/.........\nFetching rake 13.0.6\nInstalling rake 13.0.6\nFetching minitest 5.16.3\nFetching crass 1.0.6\nFetching date 3.3.2\nFetching builder 3.2.4\nFetching erubi 1.11.0\nFetching racc 1.6.1\nFetching websocket-extensions 0.1.5\nFetching marcel 1.0.2\nFetching concurrent-ruby 1.1.10\nFetching rack 2.2.4\nFetching nio4r 2.5.8\nFetching mini_mime 1.1.2\nInstalling websocket-extensions 0.1.5\nInstalling crass 1.0.6\nInstalling erubi 1.11.0\nInstalling builder 3.2.4\nInstalling mini_mime 1.1.2\nInstalling marcel 1.0.2\nInstalling racc 1.6.1 with native extensions\nFetching timeout 0.3.1\nInstalling date 3.3.2 with native extensions\nInstalling minitest 5.16.3\nFetching public_suffix 5.0.1\nInstalling timeout 0.3.1\nInstalling rack 2.2.4\nInstalling nio4r 2.5.8 with native extensions\nFetching amq-protocol 2.3.2\nFetching aws-eventstream 1.2.0\nFetching aws-partitions 1.669.0\nFetching jmespath 1.6.2\nInstalling public_suffix 5.0.1\nInstalling amq-protocol 2.3.2\nInstalling aws-eventstream 1.2.0\nInstalling aws-partitions 1.669.0\nInstalling jmespath 1.6.2\nFetching redis 4.5.1\nInstalling concurrent-ruby 1.1.10\nUsing bundler 2.3.17\nInstalling redis 4.5.1\nFetching rbtree 0.4.6\nFetching set 1.0.3\nInstalling set 1.0.3\nInstalling rbtree 0.4.6 with native extensions\nFetching chronic 0.10.2\nFetching connection_pool 2.3.0\nFetching dalli 3.2.3\nFetching unf_ext 0.0.8.2\nInstalling connection_pool 2.3.0\nInstalling dalli 3.2.3\nInstalling chronic 0.10.2\nFetching faraday-net_http 3.0.1\nUsing ruby2_keywords 0.0.5\nFetching fuzzy_match 2.1.0\nFetching link_header 0.0.8\nInstalling faraday-net_http 3.0.1\nFetching null_logger 0.0.1\nFetching plek 5.0.0\nInstalling plek 5.0.0\nFetching http-accept 1.7.0\nInstalling unf_ext 0.0.8.2 with native extensions\nFetching mime-types-data 3.2022.0105\nInstalling http-accept 1.7.0\nFetching netrc 0.11.0\nInstalling mime-types-data 3.2022.0105\nFetching jwt 2.5.0\nInstalling null_logger 0.0.1\nInstalling fuzzy_match 2.1.0\nInstalling link_header 0.0.8\nInstalling netrc 0.11.0\nInstalling jwt 2.5.0\nFetching multi_xml 0.6.0\nInstalling multi_xml 0.6.0\nFetching hashie 5.0.0\nFetching version_gem 1.1.1\nInstalling hashie 5.0.0\nInstalling version_gem 1.1.1\nFetching method_source 1.0.0\nInstalling method_source 1.0.0\nFetching thor 1.2.1\nFetching zeitwerk 2.6.6\nFetching webrick 1.7.0\nInstalling thor 1.2.1\nFetching statsd-ruby 1.5.0\nFetching kgio 2.11.4\nFetching raindrops 0.20.0\nInstalling statsd-ruby 1.5.0\nInstalling webrick 1.7.0\nInstalling zeitwerk 2.6.6\nInstalling kgio 2.11.4 with native extensions\nInstalling raindrops 0.20.0 with native extensions\nFetching rexml 3.2.5\nFetching rouge 4.0.0\nFetching htmlentities 4.3.4\nInstalling rexml 3.2.5\nInstalling htmlentities 4.3.4\nFetching rinku 2.0.6\nFetching govuk_document_types 1.0.1\nInstalling rinku 2.0.6 with native extensions\nInstalling govuk_document_types 1.0.1\nFetching mini_portile2 2.8.0\nInstalling mini_portile2 2.8.0\nFetching oj 3.13.23\nInstalling rouge 4.0.0\nFetching pg 1.4.5\nFetching websocket-driver 0.7.5\nInstalling oj 3.13.23 with native extensions\nInstalling websocket-driver 0.7.5 with native extensions\nInstalling pg 1.4.5 with native extensions\nFetching net-protocol 0.2.1\nInstalling net-protocol 0.2.1\nFetching mail 2.7.1\nFetching aws-sigv4 1.5.2\nInstalling aws-sigv4 1.5.2\nFetching redis-namespace 1.8.2\nFetching addressable 2.8.1\nInstalling redis-namespace 1.8.2\nFetching rack-test 2.0.2\nInstalling addressable 2.8.1\nInstalling rack-test 2.0.2\nInstalling mail 2.7.1\nFetching rack-protection 3.0.4\nInstalling rack-protection 3.0.4\nFetching warden 1.2.9\nFetching request_store 1.5.1\nInstalling warden 1.2.9\nInstalling request_store 1.5.1\nFetching rack-proxy 0.7.4\nFetching faraday 2.6.0\nInstalling rack-proxy 0.7.4\nInstalling faraday 2.6.0\nFetching whenever 1.0.0\nInstalling whenever 1.0.0\nFetching mime-types 3.4.1\nFetching i18n 1.12.0\nInstalling mime-types 3.4.1\nInstalling i18n 1.12.0\nFetching brpoplpush-redis_script 0.1.3\nFetching tzinfo 2.0.5\nInstalling brpoplpush-redis_script 0.1.3\nInstalling tzinfo 2.0.5\nFetching sentry-ruby 5.7.0\nFetching sprockets 4.1.1\nInstalling sentry-ruby 5.7.0\nFetching snaky_hash 2.0.1\nInstalling sprockets 4.1.1\nInstalling snaky_hash 2.0.1\nFetching prometheus_exporter 2.0.6\nFetching jsonnet 0.4.0\nFetching kramdown 2.4.0\nInstalling jsonnet 0.4.0 with native extensions\nInstalling prometheus_exporter 2.0.6\nInstalling kramdown 2.4.0\nFetching nokogiri 1.13.10 (x86_64-linux)\nFetching net-pop 0.1.2\nInstalling net-pop 0.1.2\nFetching net-smtp 0.3.3\nFetching aws-sdk-core 3.168.2\nInstalling net-smtp 0.3.3\nFetching json-schema 2.8.1\nInstalling json-schema 2.8.1\nFetching omniauth 2.1.0\nInstalling omniauth 2.1.0\nInstalling aws-sdk-core 3.168.2\nFetching sidekiq 5.2.10\nFetching warden-oauth2 0.0.1\nInstalling sidekiq 5.2.10\nFetching activesupport 7.0.4\nInstalling warden-oauth2 0.0.1\nInstalling activesupport 7.0.4\nFetching oauth2 2.0.9\nInstalling oauth2 2.0.9\nFetching unf 0.1.4\nInstalling unf 0.1.4\nFetching sorted_set 1.0.3\nInstalling sorted_set 1.0.3\nFetching govuk_schemas 4.5.0\nFetching puma 6.0.0\nInstalling govuk_schemas 4.5.0\nInstalling puma 6.0.0 with native extensions\nFetching omniauth-oauth2 1.8.0\nInstalling omniauth-oauth2 1.8.0\nFetching sidekiq-logging-json 0.0.19\nInstalling sidekiq-logging-json 0.0.19\nFetching sentry-sidekiq 5.7.0\nFetching sidekiq-unique-jobs 7.1.29\nInstalling sentry-sidekiq 5.7.0\nInstalling sidekiq-unique-jobs 7.1.29\nFetching bunny 2.20.1\nFetching domain_name 0.5.20190701\nInstalling bunny 2.20.1\nInstalling domain_name 0.5.20190701\nFetching aws-sdk-kms 1.60.0\nInstalling nokogiri 1.13.10 (x86_64-linux)\nFetching http-cookie 1.0.5\nInstalling http-cookie 1.0.5\nInstalling aws-sdk-kms 1.60.0\nFetching globalid 1.0.0\nInstalling globalid 1.0.0\nFetching activemodel 7.0.4\nFetching logstasher 2.1.5\nFetching sidekiq-statsd 2.1.0\nInstalling logstasher 2.1.5\nFetching rest-client 2.1.0\nInstalling sidekiq-statsd 2.1.0\nInstalling activemodel 7.0.4\nFetching aws-sdk-s3 1.117.2\nFetching net-imap 0.3.2\nInstalling rest-client 2.1.0\nFetching activejob 7.0.4\nInstalling net-imap 0.3.2\nInstalling activejob 7.0.4\nInstalling aws-sdk-s3 1.117.2\nFetching activerecord 7.0.4\nFetching gds-api-adapters 85.0.0\nInstalling gds-api-adapters 85.0.0\nInstalling activerecord 7.0.4\nFetching with_advisory_lock 4.6.0\nInstalling with_advisory_lock 4.6.0\nFetching sanitize 6.0.0\nFetching rails-dom-testing 2.0.3\nFetching loofah 2.19.1\nInstalling rails-dom-testing 2.0.3\nInstalling loofah 2.19.1\nInstalling sanitize 6.0.0\nFetching rails-html-sanitizer 1.4.4\nInstalling rails-html-sanitizer 1.4.4\nFetching actionview 7.0.4\nInstalling actionview 7.0.4\nFetching actionpack 7.0.4\nInstalling actionpack 7.0.4\nFetching activestorage 7.0.4\nFetching railties 7.0.4\nFetching actioncable 7.0.4\nFetching actionmailer 7.0.4\nInstalling actionmailer 7.0.4\nInstalling activestorage 7.0.4\nInstalling actioncable 7.0.4\nInstalling railties 7.0.4\nFetching actionmailbox 7.0.4\nFetching actiontext 7.0.4\nInstalling actionmailbox 7.0.4\nInstalling actiontext 7.0.4\nFetching rails 7.0.4\nFetching sentry-rails 5.7.0\nInstalling rails 7.0.4\nFetching gds-sso 17.1.1\nFetching govuk_personalisation 0.12.0\nInstalling sentry-rails 5.7.0\nInstalling govuk_personalisation 0.12.0\nInstalling gds-sso 17.1.1\nFetching unicorn 6.1.0\nInstalling unicorn 6.1.0 with native extensions\nFetching govuk_app_config 4.11.1\nInstalling govuk_app_config 4.11.1\nFetching govuk_publishing_components 34.1.1\nFetching govuk_sidekiq 5.0.0\nInstalling govuk_sidekiq 5.0.0\nInstalling govuk_publishing_components 34.1.1\nFetching govspeak 7.0.1\nInstalling govspeak 7.0.1\nBundle complete! 36 Gemfile dependencies, 132 gems now installed.\nGems in the groups 'development', 'test' and 'cucumber' were not installed.\nBundled gems are installed into `/usr/local/bundle`\nRemoving intermediate container 7da7ee7298a7\n ---> e4b118c55e1c\nStep 8/14 : COPY . /app\n ---> 69f73312a0de\nStep 9/14 : FROM $base_image\n3.1.2: Pulling from alphagov/govuk-ruby-base\n6e3729cf69e0: Already exists\n9ed578074b1a: Already exists\n02b53ac527fc: Already exists\nf8da887a8cac: Already exists\nca0762064fad: Already exists\n2064e02aa443: Already exists\n697ea29b76e7: Already exists\n01a0ce535e3f: Already exists\n3c8a917351b0: Already exists\n61d08558db01: Already exists\nc9b599fe367b: Already exists\n1577f1d76e07: Already exists\nf1e6f96d7fb3: Already exists\ne9b2a1cb21c0: Already exists\n3ea2c1545d38: Already exists\n92734e53a0df: Already exists\nbb699660c937: Already exists\nd0ecf1301853: Already exists\nf491c7daf300: Already exists\nDigest: sha256:fce05ecdb079beff03d080fa35f787925a83faab8fb6d7141fb59cd6ebf824bb\nStatus: Downloaded newer image for ghcr.io/alphagov/govuk-ruby-base:3.1.2\n ---> e4a1ce37f1c5\nStep 10/14 : ENV GOVUK_APP_NAME=publishing-api\n ---> Running in ca11bbbfb393\nRemoving intermediate container ca11bbbfb393\n ---> a9512b2515cd\nStep 11/14 : COPY --from=builder /usr/local/bundle/ /usr/local/bundle/\n ---> 5bd2666cd879\nStep 12/14 : COPY --from=builder /app /app/\n ---> f584a4e48883\nStep 13/14 : WORKDIR /app\n ---> Running in 6784ad73e1db\nRemoving intermediate container 6784ad73e1db\n ---> c0e2a16287ad\nStep 14/14 : CMD [\"bundle\", \"exec\", \"puma\"]\n ---> Running in 070b90d0b4a5\nRemoving intermediate container 070b90d0b4a5\n ---> 03c592a7c3eb\nSuccessfully built 03c592a7c3eb\nSuccessfully tagged publishing-api:latest\n","stderr":"","imageSize":753699311},"repair":{"violations":[],"repairedDockerfile":"ARG base_image=ghcr.io/alphagov/govuk-ruby-base:3.1.2\nARG builder_image=ghcr.io/alphagov/govuk-ruby-builder:3.1.2\n\nFROM $builder_image AS builder\n\nENV GOVUK_APP_NAME=publishing-api\nWORKDIR /app\nCOPY Gemfile Gemfile.lock .ruby-version /app/\nRUN bundle install\nCOPY . /app\n\n\nFROM $base_image\n\nENV GOVUK_APP_NAME=publishing-api\n\nCOPY --from=builder /usr/local/bundle/ /usr/local/bundle/\nCOPY --from=builder /app /app/\nWORKDIR /app\nCMD [\"bundle\", \"exec\", \"puma\"]\n"},"endTime":1672075310888}