{"repository":"https://github.com/alphagov/router-api","dockerfilePath":"Dockerfile","startTime":1672004257324,"clone":{"stdout":"","stderr":"Cloning into '/tmp/dinghy-analysis/alphagov/router-api'...\n","error":null,"commit":"463bb32d508c2c774e718e0060c7bf5f6481761f"},"originalBuild":{"startTimestamp":1672004258269,"endTimestamp":1672004329988,"error":null,"stdout":"Sending build context to Docker daemon    128kB\r\r\nStep 1/18 : ARG base_image=ghcr.io/alphagov/govuk-ruby-base:3.1.2\nStep 2/18 : ARG builder_image=ghcr.io/alphagov/govuk-ruby-builder:3.1.2\nStep 3/18 : FROM $builder_image AS builder\n3.1.2: Pulling from alphagov/govuk-ruby-builder\n6e3729cf69e0: Already exists\n9ed578074b1a: Already exists\n02b53ac527fc: Pulling fs layer\nf8da887a8cac: Pulling fs layer\nca0762064fad: Pulling fs layer\n2064e02aa443: Pulling fs layer\n697ea29b76e7: Pulling fs layer\n01a0ce535e3f: Pulling fs layer\n3c8a917351b0: Pulling fs layer\n61d08558db01: Pulling fs layer\nc9b599fe367b: Pulling fs layer\n1577f1d76e07: Pulling fs layer\nf1e6f96d7fb3: Pulling fs layer\ne9b2a1cb21c0: Pulling fs layer\n3ea2c1545d38: Pulling fs layer\n92734e53a0df: Pulling fs layer\nbb699660c937: Pulling fs layer\nd0ecf1301853: Pulling fs layer\nf491c7daf300: Pulling fs layer\n088b48a7438b: Pulling fs layer\n4b209c130eb0: Pulling fs layer\n2064e02aa443: Waiting\n697ea29b76e7: Waiting\n92734e53a0df: Waiting\nbb699660c937: Waiting\nd0ecf1301853: Waiting\n01a0ce535e3f: Waiting\n1577f1d76e07: Waiting\nf1e6f96d7fb3: Waiting\nf491c7daf300: Waiting\n3c8a917351b0: Waiting\n088b48a7438b: Waiting\ne9b2a1cb21c0: Waiting\n61d08558db01: Waiting\n4b209c130eb0: Waiting\n3ea2c1545d38: Waiting\nc9b599fe367b: Waiting\n02b53ac527fc: Verifying Checksum\n02b53ac527fc: Download complete\nf8da887a8cac: Verifying Checksum\nf8da887a8cac: Download complete\n02b53ac527fc: Pull complete\nf8da887a8cac: Pull complete\n2064e02aa443: Verifying Checksum\n2064e02aa443: Download complete\n697ea29b76e7: Verifying Checksum\n697ea29b76e7: Download complete\nca0762064fad: Verifying Checksum\nca0762064fad: Download complete\n01a0ce535e3f: Verifying Checksum\n01a0ce535e3f: Download complete\n3c8a917351b0: Verifying Checksum\n3c8a917351b0: Download complete\n61d08558db01: Verifying Checksum\n61d08558db01: Download complete\nc9b599fe367b: Verifying Checksum\nc9b599fe367b: Download complete\n1577f1d76e07: Download complete\ne9b2a1cb21c0: Verifying Checksum\ne9b2a1cb21c0: Download complete\n3ea2c1545d38: Verifying Checksum\n3ea2c1545d38: Download complete\n92734e53a0df: Verifying Checksum\n92734e53a0df: Download complete\nbb699660c937: Download complete\nd0ecf1301853: Download complete\nf1e6f96d7fb3: Verifying Checksum\nf1e6f96d7fb3: Download complete\nf491c7daf300: Verifying Checksum\nf491c7daf300: Download complete\n4b209c130eb0: Download complete\nca0762064fad: Pull complete\n2064e02aa443: Pull complete\n697ea29b76e7: Pull complete\n01a0ce535e3f: Pull complete\n3c8a917351b0: Pull complete\n61d08558db01: Pull complete\nc9b599fe367b: Pull complete\n088b48a7438b: Verifying Checksum\n088b48a7438b: Download complete\n1577f1d76e07: Pull complete\nf1e6f96d7fb3: Pull complete\ne9b2a1cb21c0: Pull complete\n3ea2c1545d38: Pull complete\n92734e53a0df: Pull complete\nbb699660c937: Pull complete\nd0ecf1301853: Pull complete\nf491c7daf300: Pull complete\n088b48a7438b: Pull complete\n4b209c130eb0: Pull complete\nDigest: sha256:0fc6e07708b50c6ba04c599ebd5897c158325f69f0dc99863f3406ff7f3c9f89\nStatus: Downloaded newer image for ghcr.io/alphagov/govuk-ruby-builder:3.1.2\n ---> 85c6ac4e7a0a\nStep 4/18 : RUN apt update &&     apt install -y wget\n ---> Running in 6f0629d101f3\n\u001b[91m\nWARNING: apt does not have a stable CLI interface. Use with caution in scripts.\n\n\u001b[0mGet:1 http://archive.ubuntu.com/ubuntu jammy InRelease [270 kB]\nGet:2 http://security.ubuntu.com/ubuntu jammy-security InRelease [110 kB]\nGet:3 https://deb.nodesource.com/node_16.x jammy InRelease [4583 B]\nGet:4 http://archive.ubuntu.com/ubuntu jammy-updates InRelease [114 kB]\nGet:5 http://security.ubuntu.com/ubuntu jammy-security/multiverse amd64 Packages [4732 B]\nGet:6 http://archive.ubuntu.com/ubuntu jammy-backports InRelease [99.8 kB]\nGet:7 http://security.ubuntu.com/ubuntu jammy-security/universe amd64 Packages [781 kB]\nGet:8 http://archive.ubuntu.com/ubuntu jammy/multiverse amd64 Packages [266 kB]\nGet:9 http://archive.ubuntu.com/ubuntu jammy/main amd64 Packages [1792 kB]\nGet:10 http://security.ubuntu.com/ubuntu jammy-security/main amd64 Packages [667 kB]\nGet:11 https://deb.nodesource.com/node_16.x jammy/main amd64 Packages [773 B]\nGet:12 http://archive.ubuntu.com/ubuntu jammy/restricted amd64 Packages [164 kB]\nGet:13 http://archive.ubuntu.com/ubuntu jammy/universe amd64 Packages [17.5 MB]\nGet:14 http://security.ubuntu.com/ubuntu jammy-security/restricted amd64 Packages [593 kB]\nGet:15 http://archive.ubuntu.com/ubuntu jammy-updates/multiverse amd64 Packages [8150 B]\nGet:16 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 Packages [972 kB]\nGet:17 http://archive.ubuntu.com/ubuntu jammy-updates/restricted amd64 Packages [641 kB]\nGet:18 http://archive.ubuntu.com/ubuntu jammy-updates/universe amd64 Packages [970 kB]\nGet:19 http://archive.ubuntu.com/ubuntu jammy-backports/main amd64 Packages [3520 B]\nGet:20 http://archive.ubuntu.com/ubuntu jammy-backports/universe amd64 Packages [7278 B]\nFetched 24.9 MB in 3s (8100 kB/s)\nReading package lists...\nBuilding dependency tree...\nReading state information...\n2 packages can be upgraded. Run 'apt list --upgradable' to see them.\n\u001b[91m\nWARNING: apt does not have a stable CLI interface. Use with caution in scripts.\n\n\u001b[0mReading package lists...\nBuilding dependency tree...\nReading state information...\nThe following NEW packages will be installed:\n  wget\n0 upgraded, 1 newly installed, 0 to remove and 2 not upgraded.\nNeed to get 367 kB of archives.\nAfter this operation, 1008 kB of additional disk space will be used.\nGet:1 http://archive.ubuntu.com/ubuntu jammy/main amd64 wget amd64 1.21.2-2ubuntu1 [367 kB]\n\u001b[91mdebconf: delaying package configuration, since apt-utils is not installed\n\u001b[0mFetched 367 kB in 0s (1848 kB/s)\nSelecting previously unselected package wget.\r\n(Reading database ... \r(Reading database ... 5%\r(Reading database ... 10%\r(Reading database ... 15%\r(Reading database ... 20%\r(Reading database ... 25%\r(Reading database ... 30%\r(Reading database ... 35%\r(Reading database ... 40%\r(Reading database ... 45%\r(Reading database ... 50%\r(Reading database ... 55%\r(Reading database ... 60%\r(Reading database ... 65%\r(Reading database ... 70%\r(Reading database ... 75%\r(Reading database ... 80%\r(Reading database ... 85%\r(Reading database ... 90%\r(Reading database ... 95%\r(Reading database ... 100%\r(Reading database ... 16831 files and directories currently installed.)\r\nPreparing to unpack .../wget_1.21.2-2ubuntu1_amd64.deb ...\r\nUnpacking wget (1.21.2-2ubuntu1) ...\r\nSetting up wget (1.21.2-2ubuntu1) ...\r\nRemoving intermediate container 6f0629d101f3\n ---> e9bed7c3d90d\nStep 5/18 : WORKDIR /app\n ---> Running in 125dc388156b\nRemoving intermediate container 125dc388156b\n ---> 7ce693a82a03\nStep 6/18 : COPY Gemfile* .ruby-version /app/\n ---> 925e63036849\nStep 7/18 : RUN bundle config set without 'development test webkit' &&     bundle install\n ---> Running in 6ce5917b2065\n\u001b[91mINFO: with_tmpdir_for_ruby: execing bundle with TMPDIR=/tmp/ruby-app-3WxBEQ1K\n\u001b[0m\u001b[91mINFO: with_tmpdir_for_ruby: execing bundle with TMPDIR=/tmp/ruby-app-wQaSPvYo\n\u001b[0mBundler 2.3.26 is running, but your lockfile was generated with 2.3.22. Installing Bundler 2.3.22 and restarting using that version.\nFetching gem metadata from https://rubygems.org/.\nFetching bundler 2.3.22\nInstalling bundler 2.3.22\nFetching gem metadata from https://rubygems.org/.........\nFetching rake 13.0.6\nInstalling rake 13.0.6\nFetching concurrent-ruby 1.1.10\nFetching erubi 1.11.0\nFetching crass 1.0.6\nFetching rack 2.2.4\nFetching timeout 0.3.0\nFetching minitest 5.16.3\nFetching marcel 1.0.2\nFetching builder 3.2.4\nFetching racc 1.6.1\nFetching nio4r 2.5.8\nFetching websocket-extensions 0.1.5\nFetching mini_mime 1.1.2\nInstalling timeout 0.3.0\nInstalling erubi 1.11.0\nInstalling websocket-extensions 0.1.5\nInstalling crass 1.0.6\nInstalling builder 3.2.4\nInstalling mini_mime 1.1.2\nInstalling marcel 1.0.2\nInstalling racc 1.6.1 with native extensions\nFetching bson 4.15.0\nUsing bundler 2.3.22\nInstalling minitest 5.16.3\nFetching faraday-net_http 3.0.2\nInstalling nio4r 2.5.8 with native extensions\nUsing ruby2_keywords 0.0.5\nFetching jwt 2.5.0\nInstalling faraday-net_http 3.0.2\nInstalling rack 2.2.4\nFetching multi_xml 0.6.0\nFetching hashie 5.0.0\nInstalling jwt 2.5.0\nFetching version_gem 1.1.1\nInstalling multi_xml 0.6.0\nFetching plek 5.0.0\nInstalling hashie 5.0.0\nInstalling bson 4.15.0 with native extensions\nInstalling version_gem 1.1.1\nInstalling plek 5.0.0\nInstalling concurrent-ruby 1.1.10\nFetching method_source 1.0.0\nInstalling method_source 1.0.0\nFetching thor 1.2.1\nFetching zeitwerk 2.6.6\nFetching webrick 1.7.0\nFetching statsd-ruby 1.5.0\nInstalling zeitwerk 2.6.6\nInstalling thor 1.2.1\nInstalling statsd-ruby 1.5.0\nInstalling webrick 1.7.0\nFetching kgio 2.11.4\nInstalling kgio 2.11.4 with native extensions\nFetching raindrops 0.20.0\nFetching websocket-driver 0.7.5\nFetching net-protocol 0.1.3\nInstalling websocket-driver 0.7.5 with native extensions\nInstalling net-protocol 0.1.3\nInstalling raindrops 0.20.0 with native extensions\nFetching faraday 2.7.1\nFetching mail 2.7.1\nFetching snaky_hash 2.0.1\nInstalling faraday 2.7.1\nFetching net-imap 0.3.1\nInstalling snaky_hash 2.0.1\nInstalling net-imap 0.3.1\nFetching net-pop 0.1.2\nFetching net-smtp 0.3.3\nInstalling net-pop 0.1.2\nInstalling net-smtp 0.3.3\nFetching prometheus_exporter 2.0.6\nFetching rack-test 2.0.2\nFetching rack-protection 3.0.3\nInstalling rack-test 2.0.2\nInstalling prometheus_exporter 2.0.6\nInstalling rack-protection 3.0.3\nInstalling mail 2.7.1\nFetching warden 1.2.9\nFetching request_store 1.5.1\nInstalling warden 1.2.9\nInstalling request_store 1.5.1\nFetching rack-proxy 0.7.4\nInstalling rack-proxy 0.7.4\nFetching omniauth 2.1.0\nFetching oauth2 2.0.9\nFetching warden-oauth2 0.0.1\nInstalling omniauth 2.1.0\nInstalling warden-oauth2 0.0.1\nInstalling oauth2 2.0.9\nFetching sentry-ruby 5.7.0\nFetching i18n 1.12.0\nFetching tzinfo 2.0.5\nFetching omniauth-oauth2 1.8.0\nFetching nokogiri 1.13.10 (x86_64-linux)\nInstalling i18n 1.12.0\nInstalling sentry-ruby 5.7.0\nInstalling omniauth-oauth2 1.8.0\nInstalling tzinfo 2.0.5\nFetching activesupport 7.0.4\nInstalling activesupport 7.0.4\nInstalling nokogiri 1.13.10 (x86_64-linux)\nFetching loofah 2.19.1\nInstalling loofah 2.19.1\nFetching rails-html-sanitizer 1.4.4\nInstalling rails-html-sanitizer 1.4.4\nFetching logstasher 2.1.5\nFetching rails-dom-testing 2.0.3\nFetching globalid 1.0.0\nFetching activemodel 7.0.4\nInstalling logstasher 2.1.5\nInstalling globalid 1.0.0\nInstalling rails-dom-testing 2.0.3\nInstalling activemodel 7.0.4\nFetching activejob 7.0.4\nFetching actionview 7.0.4\nFetching mongo 2.15.1\nInstalling activejob 7.0.4\nInstalling actionview 7.0.4\nFetching activerecord 7.0.4\nInstalling mongo 2.15.1\nInstalling activerecord 7.0.4\nFetching actionpack 7.0.4\nInstalling actionpack 7.0.4\nFetching puma 6.0.0\nInstalling puma 6.0.0 with native extensions\nFetching actioncable 7.0.4\nFetching railties 7.0.4\nFetching actionmailer 7.0.4\nInstalling actionmailer 7.0.4\nInstalling actioncable 7.0.4\nInstalling railties 7.0.4\nFetching activestorage 7.0.4\nInstalling activestorage 7.0.4\nFetching actionmailbox 7.0.4\nFetching actiontext 7.0.4\nInstalling actionmailbox 7.0.4\nInstalling actiontext 7.0.4\nFetching sentry-rails 5.7.0\nFetching rails 7.0.4\nInstalling rails 7.0.4\nInstalling sentry-rails 5.7.0\nFetching gds-sso 17.1.1\nInstalling gds-sso 17.1.1\nFetching mongoid 7.5.2\nInstalling mongoid 7.5.2\nFetching unicorn 6.1.0\nInstalling unicorn 6.1.0 with native extensions\nFetching govuk_app_config 4.11.1\nInstalling govuk_app_config 4.11.1\nBundle complete! 18 Gemfile dependencies, 76 gems now installed.\nGems in the groups 'development', 'test' and 'webkit' were not installed.\nBundled gems are installed into `/usr/local/bundle`\nRemoving intermediate container 6ce5917b2065\n ---> 557d801643cc\nStep 8/18 : RUN wget -O /etc/ssl/certs/rds-combined-ca-bundle.pem https://s3.amazonaws.com/rds-downloads/rds-combined-ca-bundle.pem\n ---> Running in 02154e11982e\n\u001b[91m--2022-12-25 21:38:37--  https://s3.amazonaws.com/rds-downloads/rds-combined-ca-bundle.pem\n\u001b[0m\u001b[91mResolving s3.amazonaws.com (s3.amazonaws.com)... \u001b[0m\u001b[91m54.231.225.248, 52.217.98.246, 54.231.170.16, ...\nConnecting to s3.amazonaws.com (s3.amazonaws.com)|54.231.225.248|:443... \u001b[0m\u001b[91mconnected.\n\u001b[0m\u001b[91mHTTP request sent, awaiting response... \u001b[0m\u001b[91m200 OK\nLength: 43888 (43K) [binary/octet-stream]\nSaving to: '/etc/ssl/certs/rds-combined-ca-bundle.pem'\n\u001b[0m\u001b[91m\n     0K ........\u001b[0m\u001b[91m.. ......\u001b[0m\u001b[91m.... .......... ..\u001b[0m\u001b[91m.\u001b[0m\u001b[91m.\u001b[0m\u001b[91m...... ..\u001b[0m\u001b[91m      \u001b[0m\u001b[91m  100%  370K=0.1s\n\n\u001b[0m\u001b[91m2022-12-25 21:38:37 (370 KB/s) - '/etc/ssl/certs/rds-combined-ca-bundle.pem' saved [43888/43888]\n\n\u001b[0mRemoving intermediate container 02154e11982e\n ---> f0eac32a89ee\nStep 9/18 : COPY . /app\n ---> 983e5a168bd8\nStep 10/18 : FROM $base_image\n3.1.2: Pulling from alphagov/govuk-ruby-base\n6e3729cf69e0: Already exists\n9ed578074b1a: Already exists\n02b53ac527fc: Already exists\nf8da887a8cac: Already exists\nca0762064fad: Already exists\n2064e02aa443: Already exists\n697ea29b76e7: Already exists\n01a0ce535e3f: Already exists\n3c8a917351b0: Already exists\n61d08558db01: Already exists\nc9b599fe367b: Already exists\n1577f1d76e07: Already exists\nf1e6f96d7fb3: Already exists\ne9b2a1cb21c0: Already exists\n3ea2c1545d38: Already exists\n92734e53a0df: Already exists\nbb699660c937: Already exists\nd0ecf1301853: Already exists\nf491c7daf300: Already exists\nDigest: sha256:fce05ecdb079beff03d080fa35f787925a83faab8fb6d7141fb59cd6ebf824bb\nStatus: Downloaded newer image for ghcr.io/alphagov/govuk-ruby-base:3.1.2\n ---> e4a1ce37f1c5\nStep 11/18 : ENV GOVUK_APP_NAME=router-api\n ---> Running in eb1d338f981e\nRemoving intermediate container eb1d338f981e\n ---> b6c06fa99e79\nStep 12/18 : WORKDIR /app\n ---> Running in d25746a097a2\nRemoving intermediate container d25746a097a2\n ---> e0d2f88cfebc\nStep 13/18 : RUN ln -fs /tmp /app/tmp\n ---> Running in 227aeef8f6ad\nRemoving intermediate container 227aeef8f6ad\n ---> b56ea57a2652\nStep 14/18 : COPY --from=builder /usr/local/bundle/ /usr/local/bundle/\n ---> bd73ff520d29\nStep 15/18 : COPY --from=builder /app /app/\n ---> babaf7b1ba98\nStep 16/18 : COPY --from=builder /etc/ssl/certs/rds-combined-ca-bundle.pem /etc/ssl/certs/rds-combined-ca-bundle.pem\n ---> 7bf863738204\nStep 17/18 : USER app\n ---> Running in bcc9c5261813\nRemoving intermediate container bcc9c5261813\n ---> b601e2933e1c\nStep 18/18 : CMD bundle exec puma\n ---> Running in c106f8e52899\nRemoving intermediate container c106f8e52899\n ---> 7b16d6b8a412\nSuccessfully built 7b16d6b8a412\nSuccessfully tagged router-api:latest\n","stderr":"","imageSize":369120315},"repair":{"violations":[],"repairedDockerfile":"ARG base_image=ghcr.io/alphagov/govuk-ruby-base:3.1.2\nARG builder_image=ghcr.io/alphagov/govuk-ruby-builder:3.1.2\n\nFROM $builder_image AS builder\n\nRUN apt update && \\\n    apt install -y wget\n\nWORKDIR /app\n\nCOPY Gemfile* .ruby-version /app/\n\nRUN bundle config set without 'development test webkit' && \\\n    bundle install\n\nRUN wget -O /etc/ssl/certs/rds-combined-ca-bundle.pem https://s3.amazonaws.com/rds-downloads/rds-combined-ca-bundle.pem\n\nCOPY . /app\n\n\nFROM $base_image\n\nENV GOVUK_APP_NAME=router-api\n\nWORKDIR /app\n\nRUN ln -fs /tmp /app/tmp\n\nCOPY --from=builder /usr/local/bundle/ /usr/local/bundle/\nCOPY --from=builder /app /app/\nCOPY --from=builder /etc/ssl/certs/rds-combined-ca-bundle.pem /etc/ssl/certs/rds-combined-ca-bundle.pem\n\nUSER app\n\nCMD bundle exec puma\n"},"endTime":1672004330386}