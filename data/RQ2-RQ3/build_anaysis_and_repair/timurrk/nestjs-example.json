{"repository":"https://github.com/timurrk/nestjs-example","dockerfilePath":"Dockerfile","startTime":1672432244405,"clone":{"stdout":"","stderr":"Cloning into '/tmp/dinghy-analysis/timurrk/nestjs-example'...\n","error":null,"commit":"1784fd0c6f5150d98526576513a3c39aef29284a"},"originalBuild":{"startTimestamp":1672432245330,"endTimestamp":1672432301044,"error":null,"stdout":"Sending build context to Docker daemon  948.2kB\r\r\nStep 1/23 : FROM mhart/alpine-node:14\n14: Pulling from mhart/alpine-node\n3c55fec5aa21: Pulling fs layer\n3c55fec5aa21: Verifying Checksum\n3c55fec5aa21: Download complete\n3c55fec5aa21: Pull complete\nDigest: sha256:9cd7d62ecd745f058931c42d32c60edd9a8f6c8eaa0a65c1547ae2bce4859652\nStatus: Downloaded newer image for mhart/alpine-node:14\n ---> 6a07b03bf25c\nStep 2/23 : ARG env\n ---> Running in a050654e6d26\nRemoving intermediate container a050654e6d26\n ---> 0fd2613c3eb0\nStep 3/23 : ARG commit_short_sha\n ---> Running in 06df133f43a1\nRemoving intermediate container 06df133f43a1\n ---> b11730967846\nStep 4/23 : ARG pipeline_created_at\n ---> Running in 2509814271da\nRemoving intermediate container 2509814271da\n ---> 38681a9b2e5e\nStep 5/23 : RUN apk update\n ---> Running in 637290a83e5b\nfetch http://dl-cdn.alpinelinux.org/alpine/v3.11/main/x86_64/APKINDEX.tar.gz\nfetch http://dl-cdn.alpinelinux.org/alpine/v3.11/community/x86_64/APKINDEX.tar.gz\nv3.11.13-12-g2cfa91a2b4 [http://dl-cdn.alpinelinux.org/alpine/v3.11/main]\nv3.11.11-124-gf2729ece5a [http://dl-cdn.alpinelinux.org/alpine/v3.11/community]\nOK: 11281 distinct packages available\nRemoving intermediate container 637290a83e5b\n ---> 1fc341e9f59c\nStep 6/23 : RUN apk add --update tzdata &&                      cp /usr/share/zoneinfo/UTC /etc/localtime &&                      echo \"UTC\" > /etc/timezone\n ---> Running in c942115912bd\n(1/1) Installing tzdata (2021e-r0)\nExecuting busybox-1.31.1-r10.trigger\nOK: 11 MiB in 17 packages\nRemoving intermediate container c942115912bd\n ---> 8b94ec34d5da\nStep 7/23 : RUN apk add --update --no-cache nginx &&                                 mkdir -p /run/nginx\n ---> Running in 05aedec0dd61\nfetch http://dl-cdn.alpinelinux.org/alpine/v3.11/main/x86_64/APKINDEX.tar.gz\nfetch http://dl-cdn.alpinelinux.org/alpine/v3.11/community/x86_64/APKINDEX.tar.gz\n(1/2) Installing pcre (8.43-r1)\n(2/2) Installing nginx (1.16.1-r8)\nExecuting nginx-1.16.1-r8.pre-install\nExecuting busybox-1.31.1-r10.trigger\nOK: 12 MiB in 19 packages\nRemoving intermediate container 05aedec0dd61\n ---> 3e2bd6c91e81\nStep 8/23 : RUN apk add --update --no-cache --virtual runtime-deps                                           nano                                           postgresql-client                                           readline                                           bash                                           htop\n ---> Running in 28f6a3265cb7\nfetch http://dl-cdn.alpinelinux.org/alpine/v3.11/main/x86_64/APKINDEX.tar.gz\nfetch http://dl-cdn.alpinelinux.org/alpine/v3.11/community/x86_64/APKINDEX.tar.gz\n(1/14) Installing libmagic (5.37-r1)\n(2/14) Installing ncurses-terminfo-base (6.1_p20200118-r4)\n(3/14) Installing ncurses-libs (6.1_p20200118-r4)\n(4/14) Installing nano (4.6-r0)\n(5/14) Installing libedit (20191211.3.1-r0)\n(6/14) Installing db (5.3.28-r1)\n(7/14) Installing libsasl (2.1.27-r5)\n(8/14) Installing libldap (2.4.48-r3)\n(9/14) Installing libpq (12.9-r0)\n(10/14) Installing postgresql-client (12.9-r0)\n(11/14) Installing readline (8.0.1-r0)\n(12/14) Installing bash (5.0.11-r1)\nExecuting bash-5.0.11-r1.post-install\n(13/14) Installing htop (2.2.0-r0)\n(14/14) Installing runtime-deps (20221230.203057)\nExecuting busybox-1.31.1-r10.trigger\nOK: 25 MiB in 33 packages\nRemoving intermediate container 28f6a3265cb7\n ---> 21baa7d80027\nStep 9/23 : WORKDIR /server\n ---> Running in 85c70b05d7f6\nRemoving intermediate container 85c70b05d7f6\n ---> 2f65a2df67cb\nStep 10/23 : COPY package.json package-lock.json ./\n ---> 1914dbe6225f\nStep 11/23 : RUN HUSKY_SKIP_INSTALL=true npm ci\n ---> Running in f120cde9873a\n\n> @nestjs/core@9.0.11 postinstall /server/node_modules/@nestjs/core\n> opencollective || exit 0\n\n                           Thanks for installing nest \n                 Please consider donating to our open collective\n                        to help us maintain this package.\n                                         \n                            Number of contributors: 0\n                              Number of backers: 878\n                             Annual budget: $184,733\n                             Current balance: $14,309\n                                         \n             Become a partner: https://opencollective.com/nest/donate\n                                         \n\n> @apollo/protobufjs@1.2.4 postinstall /server/node_modules/@apollo/protobufjs\n> node scripts/postinstall\n\n\n> nodemon@2.0.19 postinstall /server/node_modules/nodemon\n> node bin/postinstall || exit 0\n\n\u001b[32mLove nodemon? You can now support the project via the open collective:\u001b[22m\u001b[39m\n > \u001b[96m\u001b[1mhttps://opencollective.com/nodemon/donate\u001b[0m\n\n\u001b[91mnpm WARN lifecycle nestjs-example@0.0.1~prepare: cannot run in wd nestjs-example@0.0.1 husky install (wd=/server)\n\u001b[0madded 675 packages in 8.523s\nRemoving intermediate container f120cde9873a\n ---> ee52b728a12a\nStep 12/23 : COPY . .\n ---> bce15a55d978\nStep 13/23 : COPY nginx.conf /etc/nginx/conf.d/default.conf\n ---> 73fc059c52b6\nStep 14/23 : ENV NODE_ENV ${env}\n ---> Running in 11ce169c0590\nRemoving intermediate container 11ce169c0590\n ---> 0a88c959cd70\nStep 15/23 : RUN npm run build\n ---> Running in 04ae0d1e2c3b\n\n> nestjs-example@0.0.1 build /server\n> rimraf dist && tsc -p tsconfig.build.json\n\nRemoving intermediate container 04ae0d1e2c3b\n ---> ba178f76c446\nStep 16/23 : ENV COMMIT_SHORT_SHA ${commit_short_sha}\n ---> Running in c186d08dd8ea\nRemoving intermediate container c186d08dd8ea\n ---> fa7203309e6c\nStep 17/23 : ENV PIPELINE_CREATED_AT ${pipeline_created_at}\n ---> Running in f5bacfc60d39\nRemoving intermediate container f5bacfc60d39\n ---> ff5953163cdc\nStep 18/23 : RUN touch build_info.txt\n ---> Running in e124137323c2\nRemoving intermediate container e124137323c2\n ---> cb95f2a37a9b\nStep 19/23 : RUN echo \"env: ${env}\" >> build_info.txt\n ---> Running in ec6e5dc6d75d\nRemoving intermediate container ec6e5dc6d75d\n ---> 9f824a82a952\nStep 20/23 : RUN echo \"commit_short_sha: ${commit_short_sha}\" >> build_info.txt\n ---> Running in 952296cff855\nRemoving intermediate container 952296cff855\n ---> 85c12d59c349\nStep 21/23 : RUN echo \"pipeline_created_at: ${pipeline_created_at}\" >> build_info.txt\n ---> Running in ed1b67755b52\nRemoving intermediate container ed1b67755b52\n ---> 80f388da1c1d\nStep 22/23 : EXPOSE 80\n ---> Running in 75086df0f116\nRemoving intermediate container 75086df0f116\n ---> b2e41dc7eaf8\nStep 23/23 : CMD nginx; node -r ts-node/register -r tsconfig-paths/register ./dist/main.js\n ---> Running in 35a53a9ee4b2\nRemoving intermediate container 35a53a9ee4b2\n ---> d7d2c25a898d\nSuccessfully built d7d2c25a898d\nSuccessfully tagged nestjs-example:latest\n","stderr":"","imageSize":392741553},"repair":{"violations":[{"name":"apkAddUseNoCache","position":{"start":15,"end":15,"columnStart":4,"columnEnd":27}}],"repairedDockerfile":"FROM mhart/alpine-node:14\n# FROM node:16-alpine\n\n# Env\n\nARG env\n\nARG commit_short_sha\nARG pipeline_created_at\n\n# RUN echo \"http://dl-cdn.alpinelinux.org/alpine/edge/testing\" >> /etc/apk/repositories\n\n# Timezone\n\nRUN apk update\nRUN apk add --no-cache --update tzdata && \\\n                     cp /usr/share/zoneinfo/UTC /etc/localtime && \\\n                     echo \"UTC\" > /etc/timezone\n\n# Nginx\n\nRUN apk add --update --no-cache nginx && \\\n                                mkdir -p /run/nginx\n\n# Apk\n\nRUN apk add --update --no-cache --virtual runtime-deps \\\n                                          nano \\\n                                          postgresql-client \\\n                                          readline \\\n                                          bash \\\n                                          htop\n\nWORKDIR /server\n\nCOPY package.json package-lock.json ./\n\nRUN HUSKY_SKIP_INSTALL=true npm ci\n\nCOPY . .\n\nCOPY nginx.conf /etc/nginx/conf.d/default.conf\n\nENV NODE_ENV ${env}\n\nRUN npm run build\n\nENV COMMIT_SHORT_SHA ${commit_short_sha}\nENV PIPELINE_CREATED_AT ${pipeline_created_at}\n\nRUN touch build_info.txt\nRUN echo \"env: ${env}\" >> build_info.txt\nRUN echo \"commit_short_sha: ${commit_short_sha}\" >> build_info.txt\nRUN echo \"pipeline_created_at: ${pipeline_created_at}\" >> build_info.txt\n\nEXPOSE 80\n\nCMD nginx; node -r ts-node/register -r tsconfig-paths/register ./dist/main.js\n"},"repairedBuild":{"startTimestamp":1672432302146,"endTimestamp":1672432356878,"error":null,"stdout":"Sending build context to Docker daemon  948.2kB\r\r\nStep 1/23 : FROM mhart/alpine-node:14\n ---> 6a07b03bf25c\nStep 2/23 : ARG env\n ---> Running in b0b6817c2879\nRemoving intermediate container b0b6817c2879\n ---> dc0d12167c5f\nStep 3/23 : ARG commit_short_sha\n ---> Running in 90d0b0564ce4\nRemoving intermediate container 90d0b0564ce4\n ---> 74e38a3660bd\nStep 4/23 : ARG pipeline_created_at\n ---> Running in 2bcdd9d29113\nRemoving intermediate container 2bcdd9d29113\n ---> 2489ee1cb8e4\nStep 5/23 : RUN apk update\n ---> Running in c2634d8c89b9\nfetch http://dl-cdn.alpinelinux.org/alpine/v3.11/main/x86_64/APKINDEX.tar.gz\nfetch http://dl-cdn.alpinelinux.org/alpine/v3.11/community/x86_64/APKINDEX.tar.gz\nv3.11.13-12-g2cfa91a2b4 [http://dl-cdn.alpinelinux.org/alpine/v3.11/main]\nv3.11.11-124-gf2729ece5a [http://dl-cdn.alpinelinux.org/alpine/v3.11/community]\nOK: 11281 distinct packages available\nRemoving intermediate container c2634d8c89b9\n ---> cbc5a1e42b1a\nStep 6/23 : RUN apk add --no-cache --update tzdata &&                      cp /usr/share/zoneinfo/UTC /etc/localtime &&                      echo \"UTC\" > /etc/timezone\n ---> Running in aff56b004a1e\nfetch http://dl-cdn.alpinelinux.org/alpine/v3.11/main/x86_64/APKINDEX.tar.gz\nfetch http://dl-cdn.alpinelinux.org/alpine/v3.11/community/x86_64/APKINDEX.tar.gz\n(1/1) Installing tzdata (2021e-r0)\nExecuting busybox-1.31.1-r10.trigger\nOK: 11 MiB in 17 packages\nRemoving intermediate container aff56b004a1e\n ---> e9de2dcb536a\nStep 7/23 : RUN apk add --update --no-cache nginx &&                                 mkdir -p /run/nginx\n ---> Running in e05b7de39256\nfetch http://dl-cdn.alpinelinux.org/alpine/v3.11/main/x86_64/APKINDEX.tar.gz\nfetch http://dl-cdn.alpinelinux.org/alpine/v3.11/community/x86_64/APKINDEX.tar.gz\n(1/2) Installing pcre (8.43-r1)\n(2/2) Installing nginx (1.16.1-r8)\nExecuting nginx-1.16.1-r8.pre-install\nExecuting busybox-1.31.1-r10.trigger\nOK: 12 MiB in 19 packages\nRemoving intermediate container e05b7de39256\n ---> 988e7c9584d6\nStep 8/23 : RUN apk add --update --no-cache --virtual runtime-deps                                           nano                                           postgresql-client                                           readline                                           bash                                           htop\n ---> Running in 26bdfe0fdf06\nfetch http://dl-cdn.alpinelinux.org/alpine/v3.11/main/x86_64/APKINDEX.tar.gz\nfetch http://dl-cdn.alpinelinux.org/alpine/v3.11/community/x86_64/APKINDEX.tar.gz\n(1/14) Installing libmagic (5.37-r1)\n(2/14) Installing ncurses-terminfo-base (6.1_p20200118-r4)\n(3/14) Installing ncurses-libs (6.1_p20200118-r4)\n(4/14) Installing nano (4.6-r0)\n(5/14) Installing libedit (20191211.3.1-r0)\n(6/14) Installing db (5.3.28-r1)\n(7/14) Installing libsasl (2.1.27-r5)\n(8/14) Installing libldap (2.4.48-r3)\n(9/14) Installing libpq (12.9-r0)\n(10/14) Installing postgresql-client (12.9-r0)\n(11/14) Installing readline (8.0.1-r0)\n(12/14) Installing bash (5.0.11-r1)\nExecuting bash-5.0.11-r1.post-install\n(13/14) Installing htop (2.2.0-r0)\n(14/14) Installing runtime-deps (20221230.203147)\nExecuting busybox-1.31.1-r10.trigger\nOK: 25 MiB in 33 packages\nRemoving intermediate container 26bdfe0fdf06\n ---> 6fc046331ec6\nStep 9/23 : WORKDIR /server\n ---> Running in f816978fb7ff\nRemoving intermediate container f816978fb7ff\n ---> afd5c987306b\nStep 10/23 : COPY package.json package-lock.json ./\n ---> b654f7c36475\nStep 11/23 : RUN HUSKY_SKIP_INSTALL=true npm ci\n ---> Running in 579fb45fef70\n\n> @nestjs/core@9.0.11 postinstall /server/node_modules/@nestjs/core\n> opencollective || exit 0\n\n                           Thanks for installing nest \n                 Please consider donating to our open collective\n                        to help us maintain this package.\n                                         \n                            Number of contributors: 0\n                              Number of backers: 878\n                             Annual budget: $184,733\n                             Current balance: $14,309\n                                         \n             Become a partner: https://opencollective.com/nest/donate\n                                         \n\n> @apollo/protobufjs@1.2.4 postinstall /server/node_modules/@apollo/protobufjs\n> node scripts/postinstall\n\n\n> nodemon@2.0.19 postinstall /server/node_modules/nodemon\n> node bin/postinstall || exit 0\n\n\u001b[32mLove nodemon? You can now support the project via the open collective:\u001b[22m\u001b[39m\n > \u001b[96m\u001b[1mhttps://opencollective.com/nodemon/donate\u001b[0m\n\n\u001b[91mnpm WARN lifecycle nestjs-example@0.0.1~prepare: cannot run in wd nestjs-example@0.0.1 husky install (wd=/server)\n\u001b[0madded 675 packages in 7.684s\nRemoving intermediate container 579fb45fef70\n ---> 060ac6d5f469\nStep 12/23 : COPY . .\n ---> d103cc8bc1ff\nStep 13/23 : COPY nginx.conf /etc/nginx/conf.d/default.conf\n ---> a4bbf58604fa\nStep 14/23 : ENV NODE_ENV ${env}\n ---> Running in 759bf0c3511f\nRemoving intermediate container 759bf0c3511f\n ---> 3dab0d546dbd\nStep 15/23 : RUN npm run build\n ---> Running in f3a1e874ea51\n\n> nestjs-example@0.0.1 build /server\n> rimraf dist && tsc -p tsconfig.build.json\n\nRemoving intermediate container f3a1e874ea51\n ---> 47215ec62151\nStep 16/23 : ENV COMMIT_SHORT_SHA ${commit_short_sha}\n ---> Running in 2e156eb440d7\nRemoving intermediate container 2e156eb440d7\n ---> e771c20768e1\nStep 17/23 : ENV PIPELINE_CREATED_AT ${pipeline_created_at}\n ---> Running in 8e0dcb6e5327\nRemoving intermediate container 8e0dcb6e5327\n ---> 30f21bbcd9f6\nStep 18/23 : RUN touch build_info.txt\n ---> Running in 7de656229614\nRemoving intermediate container 7de656229614\n ---> 3af0a5756267\nStep 19/23 : RUN echo \"env: ${env}\" >> build_info.txt\n ---> Running in 143432011a2a\nRemoving intermediate container 143432011a2a\n ---> ed802d360afd\nStep 20/23 : RUN echo \"commit_short_sha: ${commit_short_sha}\" >> build_info.txt\n ---> Running in 940312c1f06d\nRemoving intermediate container 940312c1f06d\n ---> 77de10f977ca\nStep 21/23 : RUN echo \"pipeline_created_at: ${pipeline_created_at}\" >> build_info.txt\n ---> Running in ff51ad226817\nRemoving intermediate container ff51ad226817\n ---> a489b904876c\nStep 22/23 : EXPOSE 80\n ---> Running in 5f4fd75dc938\nRemoving intermediate container 5f4fd75dc938\n ---> 80567f16f9e0\nStep 23/23 : CMD nginx; node -r ts-node/register -r tsconfig-paths/register ./dist/main.js\n ---> Running in f5b666589716\nRemoving intermediate container f5b666589716\n ---> 7b70dc6028f5\nSuccessfully built 7b70dc6028f5\nSuccessfully tagged nestjs-example:latest\n","stderr":"","imageSize":392737767},"endTime":1672432357785}