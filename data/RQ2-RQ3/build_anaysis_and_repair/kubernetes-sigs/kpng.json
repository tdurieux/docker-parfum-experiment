{"repository":"https://github.com/kubernetes-sigs/kpng","dockerfilePath":"Dockerfile","startTime":1672864040941,"endTime":1672864700363,"clone":{"startTime":1672864041444,"stdout":"","stderr":"Cloning into '/tmp/dinghy-analysis/kubernetes-sigs/kpng'...\n","error":null,"endTime":1672864042922,"commit":"ed47ecc0d1321a3b89a2eb916e103616720dde32"},"originalBuild":{"startTime":1672864043346,"endTime":1672864428290,"error":null,"stdout":"Sending build context to Docker daemon  2.863MB\r\r\nStep 1/16 : from alpine:3.16 as gomods\n3.16: Pulling from library/alpine\nca7dd9ec2225: Pulling fs layer\nca7dd9ec2225: Waiting\nca7dd9ec2225: Verifying Checksum\nca7dd9ec2225: Pull complete\nDigest: sha256:b95359c2505145f16c6aa384f9cc74eeff78eb36d308ca4fd902eeeb0a0b161b\nStatus: Downloaded newer image for alpine:3.16\n ---> bfe296a52501\nStep 2/16 : copy . /src/\n ---> 60c56c3ae5d5\nStep 3/16 : run cd /src/ && find -type f \\! \\( -name go.work -o -name go.mod -o -name go.sum \\) -exec rm {} +\n ---> Running in c32aa6ac37ae\nRemoving intermediate container c32aa6ac37ae\n ---> 9fb3f73b881e\nStep 4/16 : from golang:1.19.2-alpine3.16 as build\n1.19.2-alpine3.16: Pulling from library/golang\nDigest: sha256:e4dcdac3ed37d8c2b3b8bcef2909573b2ad9c2ab53ba53c608909e8b89ccee36\nStatus: Downloaded newer image for golang:1.19.2-alpine3.16\n ---> f9a40cb7e8ec\nStep 5/16 : run apk add --update --no-cache     gcc musl-dev git     linux-headers libnl3-dev\n ---> Running in 3971e4a28fb3\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.16/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.16/community/x86_64/APKINDEX.tar.gz\n(1/23) Upgrading musl (1.2.3-r0 -> 1.2.3-r2)\n(2/23) Installing libgcc (11.2.1_git20220219-r2)\n(3/23) Installing libstdc++ (11.2.1_git20220219-r2)\n(4/23) Installing binutils (2.38-r3)\n(5/23) Installing libgomp (11.2.1_git20220219-r2)\n(6/23) Installing libatomic (11.2.1_git20220219-r2)\n(7/23) Installing gmp (6.2.1-r2)\n(8/23) Installing isl22 (0.22-r0)\n(9/23) Installing mpfr4 (4.1.0-r0)\n(10/23) Installing mpc1 (1.2.1-r0)\n(11/23) Installing gcc (11.2.1_git20220219-r2)\n(12/23) Installing brotli-libs (1.0.9-r6)\n(13/23) Installing nghttp2-libs (1.47.0-r0)\n(14/23) Installing libcurl (7.83.1-r5)\n(15/23) Installing expat (2.5.0-r0)\n(16/23) Installing pcre2 (10.40-r0)\n(17/23) Installing git (2.36.3-r0)\n(18/23) Installing libnl3 (3.5.0-r0)\n(19/23) Installing libnl3-cli (3.5.0-r0)\n(20/23) Installing pkgconf (1.8.0-r1)\n(21/23) Installing libnl3-dev (3.5.0-r0)\n(22/23) Installing linux-headers (5.16.7-r1)\n(23/23) Installing musl-dev (1.2.3-r2)\nExecuting busybox-1.35.0-r17.trigger\nOK: 143 MiB in 37 packages\nRemoving intermediate container 3971e4a28fb3\n ---> b899e4f8a4ee\nStep 6/16 : arg GOPROXY\n ---> Running in cc7e1a8ade70\nRemoving intermediate container cc7e1a8ade70\n ---> 0baf35fbb509\nStep 7/16 : arg GONOSUMDB\n ---> Running in a05aba4f8f90\nRemoving intermediate container a05aba4f8f90\n ---> 6b47bbed93da\nStep 8/16 : copy --from=gomods /src/ /src/\n ---> a802705b6995\nStep 9/16 : workdir /src\n ---> Running in 95028f2a16b1\nRemoving intermediate container 95028f2a16b1\n ---> 7723adb51759\nStep 10/16 : run go mod download\n ---> Running in cc967b1fa0a4\nRemoving intermediate container cc967b1fa0a4\n ---> c21444d0b57d\nStep 11/16 : add . ./\n ---> 5336158e651f\nStep 12/16 : run go install -trimpath -buildvcs=false ./cmd/...\n ---> Running in 80ce11445a02\nRemoving intermediate container 80ce11445a02\n ---> 11ae11385516\nStep 13/16 : from alpine:3.16\n ---> bfe296a52501\nStep 14/16 : entrypoint [\"/bin/kpng\"]\n ---> Running in 14244eebaf0b\nRemoving intermediate container 14244eebaf0b\n ---> e28ed34ceddf\nStep 15/16 : run apk add --update iptables ip6tables iproute2 ipvsadm nftables ipset conntrack-tools\n ---> Running in fe8845449e04\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.16/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.16/community/x86_64/APKINDEX.tar.gz\n(1/29) Installing libmnl (1.0.5-r0)\n(2/29) Installing libnfnetlink (1.0.2-r0)\n(3/29) Installing libnetfilter_conntrack (1.0.8-r1)\n(4/29) Installing libnetfilter_cthelper (1.0.1-r0)\n(5/29) Installing libnetfilter_cttimeout (1.0.1-r0)\n(6/29) Installing libnetfilter_queue (1.0.5-r1)\n(7/29) Installing conntrack-tools (1.4.6-r1)\n(8/29) Installing libnftnl (1.2.3-r0)\n(9/29) Installing iptables (1.8.8-r1)\n(10/29) Installing ip6tables (1.8.8-r1)\n(11/29) Installing libcap (2.64-r0)\n(12/29) Installing libbz2 (1.0.8-r1)\n(13/29) Installing fts (1.2.7-r1)\n(14/29) Installing xz-libs (5.2.5-r1)\n(15/29) Installing libelf (0.186-r0)\n(16/29) Installing iproute2-minimal (5.17.0-r0)\n(17/29) Installing iproute2-tc (5.17.0-r0)\n(18/29) Installing iproute2-ss (5.17.0-r0)\n(19/29) Installing iproute2 (5.17.0-r0)\nExecuting iproute2-5.17.0-r0.post-install\n(20/29) Installing ipset (7.15-r0)\n(21/29) Installing libnl3 (3.5.0-r0)\n(22/29) Installing popt (1.18-r0)\n(23/29) Installing ipvsadm (1.31-r0)\n(24/29) Installing gmp (6.2.1-r2)\n(25/29) Installing jansson (2.14-r0)\n(26/29) Installing ncurses-terminfo-base (6.3_p20220521-r0)\n(27/29) Installing ncurses-libs (6.3_p20220521-r0)\n(28/29) Installing readline (8.1.2-r0)\n(29/29) Installing nftables (1.0.2-r1)\nExecuting busybox-1.35.0-r17.trigger\nOK: 16 MiB in 43 packages\nRemoving intermediate container fe8845449e04\n ---> ee1dfbf83124\nStep 16/16 : copy --from=build /go/bin/ /bin/\n ---> 7ced0708586b\nSuccessfully built 7ced0708586b\nSuccessfully tagged kpng:latest\n","stderr":"","imageSize":102687324},"repair":{"startTime":1672864428446,"endTime":1672864428542,"violations":[{"name":"apkAddUseNoCache","position":{"start":31,"end":31,"columnStart":4,"columnEnd":87}}],"repairedDockerfile":"from alpine:3.16 as gomods\n\ncopy . /src/\nrun cd /src/ && find -type f \\! \\( -name go.work -o -name go.mod -o -name go.sum \\) -exec rm {} +\n\nfrom golang:1.19.2-alpine3.16 as build\n\n# install dependencies\nrun apk add --update --no-cache \\\n    gcc musl-dev git \\\n    linux-headers libnl3-dev\n\n# go mod args\narg GOPROXY\narg GONOSUMDB\n\n# cache dependencies, they don't change as much as the code\ncopy --from=gomods /src/ /src/\n\nworkdir /src\nrun go mod download\n\n# test and build\n\nadd . ./\n#run for f in $(find -name go.mod); do d=$(dirname $f); echo \"testing in $d\"; ( cd $d && go test ./... ); done\nrun go install -trimpath -buildvcs=false ./cmd/...\n\n# the real image\nfrom alpine:3.16\nentrypoint [\"/bin/kpng\"]\nrun apk add --no-cache --update iptables ip6tables iproute2 ipvsadm nftables ipset conntrack-tools\ncopy --from=build /go/bin/ /bin/\n"},"repairedBuild":{"startTime":1672864428797,"endTime":1672864699736,"error":null,"stdout":"Sending build context to Docker daemon  2.863MB\r\r\nStep 1/16 : from alpine:3.16 as gomods\n ---> bfe296a52501\nStep 2/16 : copy . /src/\n ---> dedc27fbb7fe\nStep 3/16 : run cd /src/ && find -type f \\! \\( -name go.work -o -name go.mod -o -name go.sum \\) -exec rm {} +\n ---> Running in 1b551760ad11\nRemoving intermediate container 1b551760ad11\n ---> 53d1aa6baf2a\nStep 4/16 : from golang:1.19.2-alpine3.16 as build\n ---> f9a40cb7e8ec\nStep 5/16 : run apk add --update --no-cache     gcc musl-dev git     linux-headers libnl3-dev\n ---> Running in 06918ef168a3\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.16/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.16/community/x86_64/APKINDEX.tar.gz\n(1/23) Upgrading musl (1.2.3-r0 -> 1.2.3-r2)\n(2/23) Installing libgcc (11.2.1_git20220219-r2)\n(3/23) Installing libstdc++ (11.2.1_git20220219-r2)\n(4/23) Installing binutils (2.38-r3)\n(5/23) Installing libgomp (11.2.1_git20220219-r2)\n(6/23) Installing libatomic (11.2.1_git20220219-r2)\n(7/23) Installing gmp (6.2.1-r2)\n(8/23) Installing isl22 (0.22-r0)\n(9/23) Installing mpfr4 (4.1.0-r0)\n(10/23) Installing mpc1 (1.2.1-r0)\n(11/23) Installing gcc (11.2.1_git20220219-r2)\n(12/23) Installing brotli-libs (1.0.9-r6)\n(13/23) Installing nghttp2-libs (1.47.0-r0)\n(14/23) Installing libcurl (7.83.1-r5)\n(15/23) Installing expat (2.5.0-r0)\n(16/23) Installing pcre2 (10.40-r0)\n(17/23) Installing git (2.36.3-r0)\n(18/23) Installing libnl3 (3.5.0-r0)\n(19/23) Installing libnl3-cli (3.5.0-r0)\n(20/23) Installing pkgconf (1.8.0-r1)\n(21/23) Installing libnl3-dev (3.5.0-r0)\n(22/23) Installing linux-headers (5.16.7-r1)\n(23/23) Installing musl-dev (1.2.3-r2)\nExecuting busybox-1.35.0-r17.trigger\nOK: 143 MiB in 37 packages\nRemoving intermediate container 06918ef168a3\n ---> 59b3d17ed988\nStep 6/16 : arg GOPROXY\n ---> Running in d8d5f268d3ed\nRemoving intermediate container d8d5f268d3ed\n ---> 26c5e08ab0be\nStep 7/16 : arg GONOSUMDB\n ---> Running in cfc2b31e62ab\nRemoving intermediate container cfc2b31e62ab\n ---> 033c8db8ea19\nStep 8/16 : copy --from=gomods /src/ /src/\n ---> 00aa614f0304\nStep 9/16 : workdir /src\n ---> Running in 48cdb43afb7e\nRemoving intermediate container 48cdb43afb7e\n ---> 74506c1923ec\nStep 10/16 : run go mod download\n ---> Running in 39f7cee62dba\nRemoving intermediate container 39f7cee62dba\n ---> a8b3a91ebc21\nStep 11/16 : add . ./\n ---> 886380acab1c\nStep 12/16 : run go install -trimpath -buildvcs=false ./cmd/...\n ---> Running in 5962d0458b6c\nRemoving intermediate container 5962d0458b6c\n ---> 422aa325250f\nStep 13/16 : from alpine:3.16\n ---> bfe296a52501\nStep 14/16 : entrypoint [\"/bin/kpng\"]\n ---> Running in 8e97e50cfca8\nRemoving intermediate container 8e97e50cfca8\n ---> f59b88d2510d\nStep 15/16 : run apk add --no-cache --update iptables ip6tables iproute2 ipvsadm nftables ipset conntrack-tools\n ---> Running in 76bbcd4da3e3\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.16/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.16/community/x86_64/APKINDEX.tar.gz\n(1/29) Installing libmnl (1.0.5-r0)\n(2/29) Installing libnfnetlink (1.0.2-r0)\n(3/29) Installing libnetfilter_conntrack (1.0.8-r1)\n(4/29) Installing libnetfilter_cthelper (1.0.1-r0)\n(5/29) Installing libnetfilter_cttimeout (1.0.1-r0)\n(6/29) Installing libnetfilter_queue (1.0.5-r1)\n(7/29) Installing conntrack-tools (1.4.6-r1)\n(8/29) Installing libnftnl (1.2.3-r0)\n(9/29) Installing iptables (1.8.8-r1)\n(10/29) Installing ip6tables (1.8.8-r1)\n(11/29) Installing libcap (2.64-r0)\n(12/29) Installing libbz2 (1.0.8-r1)\n(13/29) Installing fts (1.2.7-r1)\n(14/29) Installing xz-libs (5.2.5-r1)\n(15/29) Installing libelf (0.186-r0)\n(16/29) Installing iproute2-minimal (5.17.0-r0)\n(17/29) Installing iproute2-tc (5.17.0-r0)\n(18/29) Installing iproute2-ss (5.17.0-r0)\n(19/29) Installing iproute2 (5.17.0-r0)\nExecuting iproute2-5.17.0-r0.post-install\n(20/29) Installing ipset (7.15-r0)\n(21/29) Installing libnl3 (3.5.0-r0)\n(22/29) Installing popt (1.18-r0)\n(23/29) Installing ipvsadm (1.31-r0)\n(24/29) Installing gmp (6.2.1-r2)\n(25/29) Installing jansson (2.14-r0)\n(26/29) Installing ncurses-terminfo-base (6.3_p20220521-r0)\n(27/29) Installing ncurses-libs (6.3_p20220521-r0)\n(28/29) Installing readline (8.1.2-r0)\n(29/29) Installing nftables (1.0.2-r1)\nExecuting busybox-1.35.0-r17.trigger\nOK: 16 MiB in 43 packages\nRemoving intermediate container 76bbcd4da3e3\n ---> bf16e31669d9\nStep 16/16 : copy --from=build /go/bin/ /bin/\n ---> f54965607547\nSuccessfully built f54965607547\nSuccessfully tagged kpng:latest\n","stderr":"","imageSize":100220987}}