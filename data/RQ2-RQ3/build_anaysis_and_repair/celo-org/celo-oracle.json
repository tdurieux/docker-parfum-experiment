{"repository":"https://github.com/celo-org/celo-oracle","dockerfilePath":"Dockerfile","startTime":1672258151612,"clone":{"stdout":"","stderr":"Cloning into '/tmp/dinghy-analysis/celo-org/celo-oracle'...\n","error":null,"commit":"42aea6cd74f58f77b7a9fd5ba4be1485b6416f4c"},"originalBuild":{"startTimestamp":1672258152536,"endTimestamp":1672258352256,"error":null,"stdout":"Sending build context to Docker daemon  1.192MB\r\r\nStep 1/22 : FROM node:12 as BUILDER\n12: Pulling from library/node\nf5196cdf2518: Pulling fs layer\n9bed1e86f01e: Pulling fs layer\nf44e4bdb3a6c: Pulling fs layer\n2f75d131f406: Pulling fs layer\n07dff4ad21eb: Pulling fs layer\ne0ac4f13b766: Pulling fs layer\ndf2c3b2eb7cc: Pulling fs layer\nefe636eac583: Pulling fs layer\nfe17849545bb: Pulling fs layer\n2f75d131f406: Waiting\nefe636eac583: Waiting\n07dff4ad21eb: Waiting\nfe17849545bb: Waiting\ne0ac4f13b766: Waiting\ndf2c3b2eb7cc: Waiting\nf44e4bdb3a6c: Verifying Checksum\nf44e4bdb3a6c: Download complete\n9bed1e86f01e: Verifying Checksum\n9bed1e86f01e: Download complete\nf5196cdf2518: Verifying Checksum\nf5196cdf2518: Download complete\ne0ac4f13b766: Verifying Checksum\ne0ac4f13b766: Download complete\ndf2c3b2eb7cc: Verifying Checksum\ndf2c3b2eb7cc: Download complete\n2f75d131f406: Verifying Checksum\n2f75d131f406: Download complete\nefe636eac583: Verifying Checksum\nefe636eac583: Download complete\nfe17849545bb: Download complete\nf5196cdf2518: Pull complete\n9bed1e86f01e: Pull complete\nf44e4bdb3a6c: Pull complete\n07dff4ad21eb: Verifying Checksum\n07dff4ad21eb: Download complete\n2f75d131f406: Pull complete\n07dff4ad21eb: Pull complete\ne0ac4f13b766: Pull complete\ndf2c3b2eb7cc: Pull complete\nefe636eac583: Pull complete\nfe17849545bb: Pull complete\nDigest: sha256:01627afeb110b3054ba4a1405541ca095c8bfca1cb6f2be9479c767a2711879e\nStatus: Downloaded newer image for node:12\n ---> 6c8de432fc7f\nStep 2/22 : RUN apt-get update\n ---> Running in 6ba3d2a7219e\nGet:1 http://security.debian.org/debian-security stretch/updates InRelease [59.1 kB]\nIgn:2 http://deb.debian.org/debian stretch InRelease\nGet:3 http://deb.debian.org/debian stretch-updates InRelease [93.6 kB]\nGet:4 http://deb.debian.org/debian stretch Release [118 kB]\nGet:5 http://deb.debian.org/debian stretch Release.gpg [3177 B]\nGet:6 http://security.debian.org/debian-security stretch/updates/main amd64 Packages [782 kB]\nGet:7 http://deb.debian.org/debian stretch/main amd64 Packages [7080 kB]\nFetched 8135 kB in 1s (4885 kB/s)\nReading package lists...\nRemoving intermediate container 6ba3d2a7219e\n ---> ce5947edf84b\nStep 3/22 : RUN apt-get install -y libusb-1.0-0-dev\n ---> Running in 44f99be9de57\nReading package lists...\nBuilding dependency tree...\nReading state information...\nThe following additional packages will be installed:\n  libusb-1.0-0 libusb-1.0-doc\nThe following NEW packages will be installed:\n  libusb-1.0-0 libusb-1.0-0-dev libusb-1.0-doc\n0 upgraded, 3 newly installed, 0 to remove and 38 not upgraded.\nNeed to get 307 kB of archives.\nAfter this operation, 1919 kB of additional disk space will be used.\nGet:1 http://deb.debian.org/debian stretch/main amd64 libusb-1.0-0 amd64 2:1.0.21-1 [53.9 kB]\nGet:2 http://deb.debian.org/debian stretch/main amd64 libusb-1.0-0-dev amd64 2:1.0.21-1 [72.7 kB]\nGet:3 http://deb.debian.org/debian stretch/main amd64 libusb-1.0-doc all 2:1.0.21-1 [180 kB]\n\u001b[91mdebconf: delaying package configuration, since apt-utils is not installed\n\u001b[0mFetched 307 kB in 0s (18.3 MB/s)\nSelecting previously unselected package libusb-1.0-0:amd64.\r\n(Reading database ... \r(Reading database ... 5%\r(Reading database ... 10%\r(Reading database ... 15%\r(Reading database ... 20%\r(Reading database ... 25%\r(Reading database ... 30%\r(Reading database ... 35%\r(Reading database ... 40%\r(Reading database ... 45%\r(Reading database ... 50%\r(Reading database ... 55%\r(Reading database ... 60%\r(Reading database ... 65%\r(Reading database ... 70%\r(Reading database ... 75%\r(Reading database ... 80%\r(Reading database ... 85%\r(Reading database ... 90%\r(Reading database ... 95%\r(Reading database ... 100%\r(Reading database ... 29963 files and directories currently installed.)\r\nPreparing to unpack .../libusb-1.0-0_2%3a1.0.21-1_amd64.deb ...\r\nUnpacking libusb-1.0-0:amd64 (2:1.0.21-1) ...\r\nSelecting previously unselected package libusb-1.0-0-dev:amd64.\r\nPreparing to unpack .../libusb-1.0-0-dev_2%3a1.0.21-1_amd64.deb ...\r\nUnpacking libusb-1.0-0-dev:amd64 (2:1.0.21-1) ...\r\nSelecting previously unselected package libusb-1.0-doc.\r\nPreparing to unpack .../libusb-1.0-doc_2%3a1.0.21-1_all.deb ...\r\nUnpacking libusb-1.0-doc (2:1.0.21-1) ...\r\nSetting up libusb-1.0-doc (2:1.0.21-1) ...\r\nSetting up libusb-1.0-0:amd64 (2:1.0.21-1) ...\r\nProcessing triggers for libc-bin (2.24-11+deb9u4) ...\r\nSetting up libusb-1.0-0-dev:amd64 (2:1.0.21-1) ...\r\nRemoving intermediate container 44f99be9de57\n ---> be6788e0a5f3\nStep 4/22 : WORKDIR /celo-oracle\n ---> Running in 64b3db39f2ac\nRemoving intermediate container 64b3db39f2ac\n ---> 892076e4e92a\nStep 5/22 : COPY package.json yarn.lock ./\n ---> 21b093a43eef\nStep 6/22 : RUN yarn install --frozen-lockfile --network-timeout 100000 && yarn cache clean\n ---> Running in f70a5592ff82\nyarn install v1.22.18\n[1/4] Resolving packages...\n[2/4] Fetching packages...\n[3/4] Linking dependencies...\n\u001b[91mwarning \" > tslint-eslint-rules@5.4.0\" has incorrect peer dependency \"tslint@^5.0.0\".\nwarning \" > tslint-eslint-rules@5.4.0\" has incorrect peer dependency \"typescript@^2.2.0 || ^3.0.0\".\n\u001b[0m\u001b[91mwarning \" > tslint-microsoft-contrib@6.2.0\" has incorrect peer dependency \"tslint@^5.1.0\".\n\u001b[0m\u001b[91mwarning \" > tslint-microsoft-contrib@6.2.0\" has incorrect peer dependency \"typescript@^2.1.0 || ^3.0.0\".\n\u001b[0m\u001b[91mwarning \" > tslint-react@4.2.0\" has incorrect peer dependency \"tslint@^5.1.0\".\n\u001b[0m[4/4] Building fresh packages...\n\u001b[91mwarning Error running install script for optional dependency: \"/celo-oracle/node_modules/keytar: Command failed.\nExit code: 1\nCommand: prebuild-install || node-gyp rebuild\nArguments: \nDirectory: /celo-oracle/node_modules/keytar\nOutput:\nprebuild-install WARN install libsecret-1.so.0: cannot open shared object file: No such file or directory\ngyp info it worked if it ends with ok\ngyp info using node-gyp@5.1.0\ngyp info using node@12.22.12 | linux | x64\ngyp info find Python using Python version 2.7.13 found at \\\"/usr/bin/python\\\"\ngyp info spawn /usr/bin/python\ngyp info spawn args [\ngyp info spawn args   '/usr/local/lib/node_modules/npm/node_modules/node-gyp/gyp/gyp_main.py',\ngyp info spawn args   'binding.gyp',\ngyp info spawn args   '-f',\ngyp info spawn args   'make',\ngyp info spawn args   '-I',\ngyp info spawn args   '/celo-oracle/node_modules/keytar/build/config.gypi',\ngyp info spawn args   '-I',\ngyp info spawn args   '/usr/local/lib/node_modules/npm/node_modules/node-gyp/addon.gypi',\ngyp info spawn args   '-I',\ngyp info spawn args   '/root/.cache/node-gyp/12.22.12/include/node/common.gypi',\ngyp info spawn args   '-Dlibrary=shared_library',\ngyp info spawn args   '-Dvisibility=default',\ngyp info spawn args   '-Dnode_root_dir=/root/.cache/node-gyp/12.22.12',\ngyp info spawn args   '-Dnode_gyp_dir=/usr/local/lib/node_modules/npm/node_modules/node-gyp',\ngyp info spawn args   '-Dnode_lib_file=/root/.cache/node-gyp/12.22.12/<(target_arch)/node.lib',\ngyp info spawn args   '-Dmodule_root_dir=/celo-oracle/node_modules/keytar',\ngyp info spawn args   '-Dnode_engine=v8',\ngyp info spawn args   '--depth=.',\ngyp info spawn args   '--no-parallel',\ngyp info spawn args   '--generator-output',\ngyp info spawn args   'build',\ngyp info spawn args   '-Goutput_dir=.'\ngyp info spawn args ]\nPackage libsecret-1 was not found in the pkg-config search path.\nPerhaps you should add the directory containing `libsecret-1.pc'\nto the PKG_CONFIG_PATH environment variable\nNo package 'libsecret-1' found\ngyp: Call to 'pkg-config --libs-only-l libsecret-1' returned exit status 1 while in binding.gyp. while trying to load binding.gyp\ngyp ERR! configure error \ngyp ERR! stack Error: `gyp` failed with exit code: 1\ngyp ERR! stack     at ChildProcess.onCpExit (/usr/local/lib/node_modules/npm/node_modules/node-gyp/lib/configure.js:351:16)\ngyp ERR! stack     at ChildProcess.emit (events.js:314:20)\ngyp ERR! stack     at Process.ChildProcess._handle.onexit (internal/child_process.js:276:12)\ngyp ERR! System Linux 5.4.0-113-generic\ngyp ERR! command \\\"/usr/local/bin/node\\\" \\\"/usr/local/lib/node_modules/npm/node_modules/node-gyp/bin/node-gyp.js\\\" \\\"rebuild\\\"\ngyp ERR! cwd /celo-oracle/node_modules/keytar\ngyp ERR! node -v v12.22.12\ngyp ERR! node-gyp -v v5.1.0\ngyp ERR! not ok\"\n\u001b[0minfo This module is OPTIONAL, you can safely ignore this error\nDone in 38.74s.\nyarn cache v1.22.18\nsuccess Cleared cache.\nDone in 2.92s.\nRemoving intermediate container f70a5592ff82\n ---> 89fc40e2d12f\nStep 7/22 : COPY tsconfig.json ./\n ---> cde98b543705\nStep 8/22 : COPY src src\n ---> 7743623f7ced\nStep 9/22 : RUN yarn build\n ---> Running in 8273d45408fc\nyarn run v1.22.18\n$ tsc -b .\nDone in 6.53s.\nRemoving intermediate container 8273d45408fc\n ---> 0e11d89164d3\nStep 10/22 : FROM node:12\n ---> 6c8de432fc7f\nStep 11/22 : ARG COMMIT_SHA\n ---> Running in a9682dc01122\nRemoving intermediate container a9682dc01122\n ---> 0da09c6678ea\nStep 12/22 : RUN apt-get update\n ---> Running in a7e64548e546\nIgn:1 http://deb.debian.org/debian stretch InRelease\nGet:2 http://security.debian.org/debian-security stretch/updates InRelease [59.1 kB]\nGet:3 http://deb.debian.org/debian stretch-updates InRelease [93.6 kB]\nGet:4 http://deb.debian.org/debian stretch Release [118 kB]\nGet:5 http://deb.debian.org/debian stretch Release.gpg [3177 B]\nGet:6 http://security.debian.org/debian-security stretch/updates/main amd64 Packages [782 kB]\nGet:7 http://deb.debian.org/debian stretch/main amd64 Packages [7080 kB]\nFetched 8135 kB in 1s (5163 kB/s)\nReading package lists...\nRemoving intermediate container a7e64548e546\n ---> 786506bc640c\nStep 13/22 : RUN apt-get install -y libusb-1.0-0-dev\n ---> Running in c36b998f3560\nReading package lists...\nBuilding dependency tree...\nReading state information...\nThe following additional packages will be installed:\n  libusb-1.0-0 libusb-1.0-doc\nThe following NEW packages will be installed:\n  libusb-1.0-0 libusb-1.0-0-dev libusb-1.0-doc\n0 upgraded, 3 newly installed, 0 to remove and 38 not upgraded.\nNeed to get 307 kB of archives.\nAfter this operation, 1919 kB of additional disk space will be used.\nGet:1 http://deb.debian.org/debian stretch/main amd64 libusb-1.0-0 amd64 2:1.0.21-1 [53.9 kB]\nGet:2 http://deb.debian.org/debian stretch/main amd64 libusb-1.0-0-dev amd64 2:1.0.21-1 [72.7 kB]\nGet:3 http://deb.debian.org/debian stretch/main amd64 libusb-1.0-doc all 2:1.0.21-1 [180 kB]\n\u001b[91mdebconf: delaying package configuration, since apt-utils is not installed\n\u001b[0mFetched 307 kB in 0s (20.1 MB/s)\nSelecting previously unselected package libusb-1.0-0:amd64.\r\n(Reading database ... \r(Reading database ... 5%\r(Reading database ... 10%\r(Reading database ... 15%\r(Reading database ... 20%\r(Reading database ... 25%\r(Reading database ... 30%\r(Reading database ... 35%\r(Reading database ... 40%\r(Reading database ... 45%\r(Reading database ... 50%\r(Reading database ... 55%\r(Reading database ... 60%\r(Reading database ... 65%\r(Reading database ... 70%\r(Reading database ... 75%\r(Reading database ... 80%\r(Reading database ... 85%\r(Reading database ... 90%\r(Reading database ... 95%\r(Reading database ... 100%\r(Reading database ... 29963 files and directories currently installed.)\r\nPreparing to unpack .../libusb-1.0-0_2%3a1.0.21-1_amd64.deb ...\r\nUnpacking libusb-1.0-0:amd64 (2:1.0.21-1) ...\r\nSelecting previously unselected package libusb-1.0-0-dev:amd64.\r\nPreparing to unpack .../libusb-1.0-0-dev_2%3a1.0.21-1_amd64.deb ...\r\nUnpacking libusb-1.0-0-dev:amd64 (2:1.0.21-1) ...\r\nSelecting previously unselected package libusb-1.0-doc.\r\nPreparing to unpack .../libusb-1.0-doc_2%3a1.0.21-1_all.deb ...\r\nUnpacking libusb-1.0-doc (2:1.0.21-1) ...\r\nSetting up libusb-1.0-doc (2:1.0.21-1) ...\r\nSetting up libusb-1.0-0:amd64 (2:1.0.21-1) ...\r\nProcessing triggers for libc-bin (2.24-11+deb9u4) ...\r\nSetting up libusb-1.0-0-dev:amd64 (2:1.0.21-1) ...\r\nRemoving intermediate container c36b998f3560\n ---> f6370e4910d1\nStep 14/22 : WORKDIR /celo-oracle\n ---> Running in 4b490414b19f\nRemoving intermediate container 4b490414b19f\n ---> 12017eb02ec6\nStep 15/22 : ENV NODE_ENV production\n ---> Running in dbb558dfaf47\nRemoving intermediate container dbb558dfaf47\n ---> ea804ed0a87f\nStep 16/22 : COPY package.json package.json yarn.lock tsconfig.json readinessProbe.sh ./\n ---> 40dc1ae7faeb\nStep 17/22 : COPY --from=BUILDER /celo-oracle/lib ./lib\n ---> 18134e6e769a\nStep 18/22 : RUN yarn install --production --frozen-lockfile --network-timeout 100000 && yarn cache clean\n ---> Running in cffbbb1e2c1f\nyarn install v1.22.18\n[1/4] Resolving packages...\n[2/4] Fetching packages...\n[3/4] Linking dependencies...\n\u001b[91mwarning \" > tslint-eslint-rules@5.4.0\" has incorrect peer dependency \"tslint@^5.0.0\".\nwarning \" > tslint-eslint-rules@5.4.0\" has incorrect peer dependency \"typescript@^2.2.0 || ^3.0.0\".\n\u001b[0m\u001b[91mwarning \" > tslint-microsoft-contrib@6.2.0\" has incorrect peer dependency \"tslint@^5.1.0\".\n\u001b[0m\u001b[91mwarning \" > tslint-microsoft-contrib@6.2.0\" has incorrect peer dependency \"typescript@^2.1.0 || ^3.0.0\".\n\u001b[0m\u001b[91mwarning \" > tslint-react@4.2.0\" has incorrect peer dependency \"tslint@^5.1.0\".\n\u001b[0m[4/4] Building fresh packages...\n\u001b[91mwarning Error running install script for optional dependency: \"/celo-oracle/node_modules/keytar: Command failed.\nExit code: 1\nCommand: prebuild-install || node-gyp rebuild\nArguments: \nDirectory: /celo-oracle/node_modules/keytar\nOutput:\nprebuild-install WARN install libsecret-1.so.0: cannot open shared object file: No such file or directory\ngyp info it worked if it ends with ok\ngyp info using node-gyp@5.1.0\ngyp info using node@12.22.12 | linux | x64\ngyp info find Python using Python version 2.7.13 found at \\\"/usr/bin/python\\\"\ngyp info spawn /usr/bin/python\ngyp info spawn args [\ngyp info spawn args   '/usr/local/lib/node_modules/npm/node_modules/node-gyp/gyp/gyp_main.py',\ngyp info spawn args   'binding.gyp',\ngyp info spawn args   '-f',\ngyp info spawn args   'make',\ngyp info spawn args   '-I',\ngyp info spawn args   '/celo-oracle/node_modules/keytar/build/config.gypi',\ngyp info spawn args   '-I',\ngyp info spawn args   '/usr/local/lib/node_modules/npm/node_modules/node-gyp/addon.gypi',\ngyp info spawn args   '-I',\ngyp info spawn args   '/root/.cache/node-gyp/12.22.12/include/node/common.gypi',\ngyp info spawn args   '-Dlibrary=shared_library',\ngyp info spawn args   '-Dvisibility=default',\ngyp info spawn args   '-Dnode_root_dir=/root/.cache/node-gyp/12.22.12',\ngyp info spawn args   '-Dnode_gyp_dir=/usr/local/lib/node_modules/npm/node_modules/node-gyp',\ngyp info spawn args   '-Dnode_lib_file=/root/.cache/node-gyp/12.22.12/<(target_arch)/node.lib',\ngyp info spawn args   '-Dmodule_root_dir=/celo-oracle/node_modules/keytar',\ngyp info spawn args   '-Dnode_engine=v8',\ngyp info spawn args   '--depth=.',\ngyp info spawn args   '--no-parallel',\ngyp info spawn args   '--generator-output',\ngyp info spawn args   'build',\ngyp info spawn args   '-Goutput_dir=.'\ngyp info spawn args ]\nPackage libsecret-1 was not found in the pkg-config search path.\nPerhaps you should add the directory containing `libsecret-1.pc'\nto the PKG_CONFIG_PATH environment variable\nNo package 'libsecret-1' found\ngyp: Call to 'pkg-config --libs-only-l libsecret-1' returned exit status 1 while in binding.gyp. while trying to load binding.gyp\ngyp ERR! configure error \ngyp ERR! stack Error: `gyp` failed with exit code: 1\ngyp ERR! stack     at ChildProcess.onCpExit (/usr/local/lib/node_modules/npm/node_modules/node-gyp/lib/configure.js:351:16)\ngyp ERR! stack     at ChildProcess.emit (events.js:314:20)\ngyp ERR! stack     at Process.ChildProcess._handle.onexit (internal/child_process.js:276:12)\ngyp ERR! System Linux 5.4.0-113-generic\ngyp ERR! command \\\"/usr/local/bin/node\\\" \\\"/usr/local/lib/node_modules/npm/node_modules/node-gyp/bin/node-gyp.js\\\" \\\"rebuild\\\"\ngyp ERR! cwd /celo-oracle/node_modules/keytar\ngyp ERR! node -v v12.22.12\ngyp ERR! node-gyp -v v5.1.0\ngyp ERR! not ok\"\n\u001b[0minfo This module is OPTIONAL, you can safely ignore this error\nDone in 28.86s.\nyarn cache v1.22.18\nsuccess Cleared cache.\nDone in 2.19s.\nRemoving intermediate container cffbbb1e2c1f\n ---> 6a778bd03a6a\nStep 19/22 : RUN echo $COMMIT_SHA > /version\n ---> Running in 0dd2d86dc91f\nRemoving intermediate container 0dd2d86dc91f\n ---> beb4b6a76e2e\nStep 20/22 : RUN [\"chmod\", \"+x\", \"/celo-oracle/readinessProbe.sh\"]\n ---> Running in da2be6a97929\nRemoving intermediate container da2be6a97929\n ---> e8fcf5b70ae3\nStep 21/22 : USER 1000:1000\n ---> Running in fc09d2ffdb69\nRemoving intermediate container fc09d2ffdb69\n ---> d04a0b5bc3a9\nStep 22/22 : CMD yarn start\n ---> Running in ea40b81d5f0e\nRemoving intermediate container ea40b81d5f0e\n ---> 97e48f7abf03\nSuccessfully built 97e48f7abf03\nSuccessfully tagged celo-oracle:latest\n","stderr":"","imageSize":1228595066},"repair":{"violations":[{"name":"ruleAptGetInstallUseNoRec","position":{"start":12,"end":12,"columnStart":4,"columnEnd":39}},{"name":"ruleAptGetInstallUseNoRec","position":{"start":34,"end":34,"columnStart":4,"columnEnd":39}},{"name":"ruleAptGetUpdatePrecedesInstall","position":{"start":12,"end":12,"columnStart":4,"columnEnd":39}},{"name":"ruleAptGetUpdatePrecedesInstall","position":{"start":34,"end":34,"columnStart":4,"columnEnd":39}},{"name":"ruleAptGetInstallThenRemoveAptLists","position":{"start":12,"end":12,"columnStart":4,"columnEnd":39}},{"name":"ruleAptGetInstallThenRemoveAptLists","position":{"start":34,"end":34,"columnStart":4,"columnEnd":39}}],"repairedDockerfile":"# How to build:\n# export COMMIT_SHA=$(git rev-parse HEAD)\n# docker build -f Dockerfile --build-arg COMMIT_SHA=$COMMIT_SHA -t oracletest.azurecr.io/test/oracle:$COMMIT_SHA .\n\n# How to push to registry\n# az acr login -n oracletest\n# docker push oracletest.azurecr.io/test/oracle:$COMMIT_SHA\n\n# First stage, builder to install devDependencies to build TypeScript\nFROM node:12 as BUILDER\n\nRUN apt-get update\nRUN apt-get install --no-install-recommends -y libusb-1.0-0-dev\n\nWORKDIR /celo-oracle\n\n# ensure yarn.lock is evaluated by kaniko cache diff\nCOPY package.json yarn.lock ./\n\nRUN yarn install --frozen-lockfile --network-timeout 100000 && yarn cache clean\n\nCOPY tsconfig.json ./\n\n# copy contents\nCOPY src src\n\n# build contents\nRUN yarn build\n\n# Second stage, create slimmed down production-ready image\nFROM node:12\nARG COMMIT_SHA\n\nRUN apt-get update\nRUN apt-get install --no-install-recommends -y libusb-1.0-0-dev\n\nWORKDIR /celo-oracle\nENV NODE_ENV production\n\nCOPY package.json package.json yarn.lock tsconfig.json readinessProbe.sh ./\n\nCOPY --from=BUILDER /celo-oracle/lib ./lib\n\nRUN yarn install --production --frozen-lockfile --network-timeout 100000 && yarn cache clean\nRUN echo $COMMIT_SHA > /version\nRUN [\"chmod\", \"+x\", \"/celo-oracle/readinessProbe.sh\"]\n\nUSER 1000:1000\n\nCMD yarn start\n"},"repairedBuild":{"startTimestamp":1672258353119,"endTimestamp":1672258657891,"error":null,"stdout":"Sending build context to Docker daemon  1.192MB\r\r\nStep 1/22 : FROM node:12 as BUILDER\n ---> 6c8de432fc7f\nStep 2/22 : RUN apt-get update\n ---> Running in 0689290356ec\nIgn:1 http://deb.debian.org/debian stretch InRelease\nGet:2 http://security.debian.org/debian-security stretch/updates InRelease [59.1 kB]\nGet:3 http://deb.debian.org/debian stretch-updates InRelease [93.6 kB]\nGet:4 http://deb.debian.org/debian stretch Release [118 kB]\nGet:5 http://deb.debian.org/debian stretch Release.gpg [3177 B]\nGet:6 http://security.debian.org/debian-security stretch/updates/main amd64 Packages [782 kB]\nGet:7 http://deb.debian.org/debian stretch/main amd64 Packages [7080 kB]\nFetched 8135 kB in 1s (5152 kB/s)\nReading package lists...\nRemoving intermediate container 0689290356ec\n ---> 842c9bbe1934\nStep 3/22 : RUN apt-get install --no-install-recommends -y libusb-1.0-0-dev\n ---> Running in 4dcd8b40fb79\nReading package lists...\nBuilding dependency tree...\nReading state information...\nThe following additional packages will be installed:\n  libusb-1.0-0\nRecommended packages:\n  libusb-1.0-doc\nThe following NEW packages will be installed:\n  libusb-1.0-0 libusb-1.0-0-dev\n0 upgraded, 2 newly installed, 0 to remove and 38 not upgraded.\nNeed to get 127 kB of archives.\nAfter this operation, 427 kB of additional disk space will be used.\nGet:1 http://deb.debian.org/debian stretch/main amd64 libusb-1.0-0 amd64 2:1.0.21-1 [53.9 kB]\nGet:2 http://deb.debian.org/debian stretch/main amd64 libusb-1.0-0-dev amd64 2:1.0.21-1 [72.7 kB]\n\u001b[91mdebconf: delaying package configuration, since apt-utils is not installed\n\u001b[0mFetched 127 kB in 0s (1579 kB/s)\nSelecting previously unselected package libusb-1.0-0:amd64.\r\n(Reading database ... \r(Reading database ... 5%\r(Reading database ... 10%\r(Reading database ... 15%\r(Reading database ... 20%\r(Reading database ... 25%\r(Reading database ... 30%\r(Reading database ... 35%\r(Reading database ... 40%\r(Reading database ... 45%\r(Reading database ... 50%\r(Reading database ... 55%\r(Reading database ... 60%\r(Reading database ... 65%\r(Reading database ... 70%\r(Reading database ... 75%\r(Reading database ... 80%\r(Reading database ... 85%\r(Reading database ... 90%\r(Reading database ... 95%\r(Reading database ... 100%\r(Reading database ... 29963 files and directories currently installed.)\r\nPreparing to unpack .../libusb-1.0-0_2%3a1.0.21-1_amd64.deb ...\r\nUnpacking libusb-1.0-0:amd64 (2:1.0.21-1) ...\r\nSelecting previously unselected package libusb-1.0-0-dev:amd64.\r\nPreparing to unpack .../libusb-1.0-0-dev_2%3a1.0.21-1_amd64.deb ...\r\nUnpacking libusb-1.0-0-dev:amd64 (2:1.0.21-1) ...\r\nSetting up libusb-1.0-0:amd64 (2:1.0.21-1) ...\r\nProcessing triggers for libc-bin (2.24-11+deb9u4) ...\r\nSetting up libusb-1.0-0-dev:amd64 (2:1.0.21-1) ...\r\nRemoving intermediate container 4dcd8b40fb79\n ---> 1b79e6e89c37\nStep 4/22 : WORKDIR /celo-oracle\n ---> Running in 1b14b30f941b\nRemoving intermediate container 1b14b30f941b\n ---> 4aeac764b25d\nStep 5/22 : COPY package.json yarn.lock ./\n ---> 17737197920c\nStep 6/22 : RUN yarn install --frozen-lockfile --network-timeout 100000 && yarn cache clean\n ---> Running in 12399c524eb9\nyarn install v1.22.18\n[1/4] Resolving packages...\n[2/4] Fetching packages...\n[3/4] Linking dependencies...\n\u001b[91mwarning \" > tslint-eslint-rules@5.4.0\" has incorrect peer dependency \"tslint@^5.0.0\".\nwarning \" > tslint-eslint-rules@5.4.0\" has incorrect peer dependency \"typescript@^2.2.0 || ^3.0.0\".\n\u001b[0m\u001b[91mwarning \" > tslint-microsoft-contrib@6.2.0\" has incorrect peer dependency \"tslint@^5.1.0\".\n\u001b[0m\u001b[91mwarning \" > tslint-microsoft-contrib@6.2.0\" has incorrect peer dependency \"typescript@^2.1.0 || ^3.0.0\".\n\u001b[0m\u001b[91mwarning \" > tslint-react@4.2.0\" has incorrect peer dependency \"tslint@^5.1.0\".\n\u001b[0m[4/4] Building fresh packages...\n\u001b[91mwarning Error running install script for optional dependency: \"/celo-oracle/node_modules/keytar: Command failed.\nExit code: 1\nCommand: prebuild-install || node-gyp rebuild\nArguments: \nDirectory: /celo-oracle/node_modules/keytar\nOutput:\nprebuild-install WARN install libsecret-1.so.0: cannot open shared object file: No such file or directory\ngyp info it worked if it ends with ok\ngyp info using node-gyp@5.1.0\ngyp info using node@12.22.12 | linux | x64\ngyp info find Python using Python version 2.7.13 found at \\\"/usr/bin/python\\\"\ngyp info spawn /usr/bin/python\ngyp info spawn args [\ngyp info spawn args   '/usr/local/lib/node_modules/npm/node_modules/node-gyp/gyp/gyp_main.py',\ngyp info spawn args   'binding.gyp',\ngyp info spawn args   '-f',\ngyp info spawn args   'make',\ngyp info spawn args   '-I',\ngyp info spawn args   '/celo-oracle/node_modules/keytar/build/config.gypi',\ngyp info spawn args   '-I',\ngyp info spawn args   '/usr/local/lib/node_modules/npm/node_modules/node-gyp/addon.gypi',\ngyp info spawn args   '-I',\ngyp info spawn args   '/root/.cache/node-gyp/12.22.12/include/node/common.gypi',\ngyp info spawn args   '-Dlibrary=shared_library',\ngyp info spawn args   '-Dvisibility=default',\ngyp info spawn args   '-Dnode_root_dir=/root/.cache/node-gyp/12.22.12',\ngyp info spawn args   '-Dnode_gyp_dir=/usr/local/lib/node_modules/npm/node_modules/node-gyp',\ngyp info spawn args   '-Dnode_lib_file=/root/.cache/node-gyp/12.22.12/<(target_arch)/node.lib',\ngyp info spawn args   '-Dmodule_root_dir=/celo-oracle/node_modules/keytar',\ngyp info spawn args   '-Dnode_engine=v8',\ngyp info spawn args   '--depth=.',\ngyp info spawn args   '--no-parallel',\ngyp info spawn args   '--generator-output',\ngyp info spawn args   'build',\ngyp info spawn args   '-Goutput_dir=.'\ngyp info spawn args ]\nPackage libsecret-1 was not found in the pkg-config search path.\nPerhaps you should add the directory containing `libsecret-1.pc'\nto the PKG_CONFIG_PATH environment variable\nNo package 'libsecret-1' found\ngyp: Call to 'pkg-config --libs-only-l libsecret-1' returned exit status 1 while in binding.gyp. while trying to load binding.gyp\ngyp ERR! configure error \ngyp ERR! stack Error: `gyp` failed with exit code: 1\ngyp ERR! stack     at ChildProcess.onCpExit (/usr/local/lib/node_modules/npm/node_modules/node-gyp/lib/configure.js:351:16)\ngyp ERR! stack     at ChildProcess.emit (events.js:314:20)\ngyp ERR! stack     at Process.ChildProcess._handle.onexit (internal/child_process.js:276:12)\ngyp ERR! System Linux 5.4.0-113-generic\ngyp ERR! command \\\"/usr/local/bin/node\\\" \\\"/usr/local/lib/node_modules/npm/node_modules/node-gyp/bin/node-gyp.js\\\" \\\"rebuild\\\"\ngyp ERR! cwd /celo-oracle/node_modules/keytar\ngyp ERR! node -v v12.22.12\ngyp ERR! node-gyp -v v5.1.0\ngyp ERR! not ok\"\n\u001b[0minfo This module is OPTIONAL, you can safely ignore this error\nDone in 32.56s.\nyarn cache v1.22.18\nsuccess Cleared cache.\nDone in 1.47s.\nRemoving intermediate container 12399c524eb9\n ---> 6367e9591289\nStep 7/22 : COPY tsconfig.json ./\n ---> 87beff2e94bc\nStep 8/22 : COPY src src\n ---> d7c0232cffb2\nStep 9/22 : RUN yarn build\n ---> Running in 9700677d1981\nyarn run v1.22.18\n$ tsc -b .\nDone in 7.78s.\nRemoving intermediate container 9700677d1981\n ---> 803353165d98\nStep 10/22 : FROM node:12\n ---> 6c8de432fc7f\nStep 11/22 : ARG COMMIT_SHA\n ---> Running in 4dd9ba44f0b9\nRemoving intermediate container 4dd9ba44f0b9\n ---> bf7930756f7a\nStep 12/22 : RUN apt-get update\n ---> Running in d131d536a647\nGet:1 http://security.debian.org/debian-security stretch/updates InRelease [59.1 kB]\nIgn:2 http://deb.debian.org/debian stretch InRelease\nGet:3 http://deb.debian.org/debian stretch-updates InRelease [93.6 kB]\nGet:4 http://deb.debian.org/debian stretch Release [118 kB]\nGet:5 http://deb.debian.org/debian stretch Release.gpg [3177 B]\nGet:6 http://security.debian.org/debian-security stretch/updates/main amd64 Packages [782 kB]\nGet:7 http://deb.debian.org/debian stretch/main amd64 Packages [7080 kB]\nFetched 8135 kB in 1s (4788 kB/s)\nReading package lists...\nRemoving intermediate container d131d536a647\n ---> 5718a6463618\nStep 13/22 : RUN apt-get install --no-install-recommends -y libusb-1.0-0-dev\n ---> Running in 3e5c9dde74c8\nReading package lists...\nBuilding dependency tree...\nReading state information...\nThe following additional packages will be installed:\n  libusb-1.0-0\nRecommended packages:\n  libusb-1.0-doc\nThe following NEW packages will be installed:\n  libusb-1.0-0 libusb-1.0-0-dev\n0 upgraded, 2 newly installed, 0 to remove and 38 not upgraded.\nNeed to get 127 kB of archives.\nAfter this operation, 427 kB of additional disk space will be used.\nGet:1 http://deb.debian.org/debian stretch/main amd64 libusb-1.0-0 amd64 2:1.0.21-1 [53.9 kB]\nGet:2 http://deb.debian.org/debian stretch/main amd64 libusb-1.0-0-dev amd64 2:1.0.21-1 [72.7 kB]\n\u001b[91mdebconf: delaying package configuration, since apt-utils is not installed\n\u001b[0mFetched 127 kB in 0s (3666 kB/s)\nSelecting previously unselected package libusb-1.0-0:amd64.\r\n(Reading database ... \r(Reading database ... 5%\r(Reading database ... 10%\r(Reading database ... 15%\r(Reading database ... 20%\r(Reading database ... 25%\r(Reading database ... 30%\r(Reading database ... 35%\r(Reading database ... 40%\r(Reading database ... 45%\r(Reading database ... 50%\r(Reading database ... 55%\r(Reading database ... 60%\r(Reading database ... 65%\r(Reading database ... 70%\r(Reading database ... 75%\r(Reading database ... 80%\r(Reading database ... 85%\r(Reading database ... 90%\r(Reading database ... 95%\r(Reading database ... 100%\r(Reading database ... 29963 files and directories currently installed.)\r\nPreparing to unpack .../libusb-1.0-0_2%3a1.0.21-1_amd64.deb ...\r\nUnpacking libusb-1.0-0:amd64 (2:1.0.21-1) ...\r\nSelecting previously unselected package libusb-1.0-0-dev:amd64.\r\nPreparing to unpack .../libusb-1.0-0-dev_2%3a1.0.21-1_amd64.deb ...\r\nUnpacking libusb-1.0-0-dev:amd64 (2:1.0.21-1) ...\r\nSetting up libusb-1.0-0:amd64 (2:1.0.21-1) ...\r\nProcessing triggers for libc-bin (2.24-11+deb9u4) ...\r\nSetting up libusb-1.0-0-dev:amd64 (2:1.0.21-1) ...\r\nRemoving intermediate container 3e5c9dde74c8\n ---> d67aaf0d3361\nStep 14/22 : WORKDIR /celo-oracle\n ---> Running in d006fb69672b\nRemoving intermediate container d006fb69672b\n ---> b2b11e14eb96\nStep 15/22 : ENV NODE_ENV production\n ---> Running in 7a03cf3957d8\nRemoving intermediate container 7a03cf3957d8\n ---> aa8a503453f1\nStep 16/22 : COPY package.json package.json yarn.lock tsconfig.json readinessProbe.sh ./\n ---> 15893b6e5320\nStep 17/22 : COPY --from=BUILDER /celo-oracle/lib ./lib\n ---> 49e7835e9a10\nStep 18/22 : RUN yarn install --production --frozen-lockfile --network-timeout 100000 && yarn cache clean\n ---> Running in 244feea546f9\nyarn install v1.22.18\n[1/4] Resolving packages...\n[2/4] Fetching packages...\n[3/4] Linking dependencies...\n\u001b[91mwarning \" > tslint-eslint-rules@5.4.0\" has incorrect peer dependency \"tslint@^5.0.0\".\n\u001b[0m\u001b[91mwarning \" > tslint-eslint-rules@5.4.0\" has incorrect peer dependency \"typescript@^2.2.0 || ^3.0.0\".\n\u001b[0m\u001b[91mwarning \" > tslint-microsoft-contrib@6.2.0\" has incorrect peer dependency \"tslint@^5.1.0\".\n\u001b[0m\u001b[91mwarning \" > tslint-microsoft-contrib@6.2.0\" has incorrect peer dependency \"typescript@^2.1.0 || ^3.0.0\".\n\u001b[0m\u001b[91mwarning \" > tslint-react@4.2.0\" has incorrect peer dependency \"tslint@^5.1.0\".\n\u001b[0m[4/4] Building fresh packages...\n\u001b[91mwarning Error running install script for optional dependency: \"/celo-oracle/node_modules/keytar: Command failed.\nExit code: 1\nCommand: prebuild-install || node-gyp rebuild\nArguments: \nDirectory: /celo-oracle/node_modules/keytar\nOutput:\nprebuild-install WARN install libsecret-1.so.0: cannot open shared object file: No such file or directory\ngyp info it worked if it ends with ok\ngyp info using node-gyp@5.1.0\ngyp info using node@12.22.12 | linux | x64\ngyp info find Python using Python version 2.7.13 found at \\\"/usr/bin/python\\\"\ngyp http GET https://nodejs.org/download/release/v12.22.12/node-v12.22.12-headers.tar.gz\ngyp http 200 https://nodejs.org/download/release/v12.22.12/node-v12.22.12-headers.tar.gz\ngyp http GET https://nodejs.org/download/release/v12.22.12/SHASUMS256.txt\ngyp http 200 https://nodejs.org/download/release/v12.22.12/SHASUMS256.txt\ngyp info spawn /usr/bin/python\ngyp info spawn args [\ngyp info spawn args   '/usr/local/lib/node_modules/npm/node_modules/node-gyp/gyp/gyp_main.py',\ngyp info spawn args   'binding.gyp',\ngyp info spawn args   '-f',\ngyp info spawn args   'make',\ngyp info spawn args   '-I',\ngyp info spawn args   '/celo-oracle/node_modules/keytar/build/config.gypi',\ngyp info spawn args   '-I',\ngyp info spawn args   '/usr/local/lib/node_modules/npm/node_modules/node-gyp/addon.gypi',\ngyp info spawn args   '-I',\ngyp info spawn args   '/root/.cache/node-gyp/12.22.12/include/node/common.gypi',\ngyp info spawn args   '-Dlibrary=shared_library',\ngyp info spawn args   '-Dvisibility=default',\ngyp info spawn args   '-Dnode_root_dir=/root/.cache/node-gyp/12.22.12',\ngyp info spawn args   '-Dnode_gyp_dir=/usr/local/lib/node_modules/npm/node_modules/node-gyp',\ngyp info spawn args   '-Dnode_lib_file=/root/.cache/node-gyp/12.22.12/<(target_arch)/node.lib',\ngyp info spawn args   '-Dmodule_root_dir=/celo-oracle/node_modules/keytar',\ngyp info spawn args   '-Dnode_engine=v8',\ngyp info spawn args   '--depth=.',\ngyp info spawn args   '--no-parallel',\ngyp info spawn args   '--generator-output',\ngyp info spawn args   'build',\ngyp info spawn args   '-Goutput_dir=.'\ngyp info spawn args ]\nPackage libsecret-1 was not found in the pkg-config search path.\nPerhaps you should add the directory containing `libsecret-1.pc'\nto the PKG_CONFIG_PATH environment variable\nNo package 'libsecret-1' found\ngyp: Call to 'pkg-config --libs-only-l libsecret-1' returned exit status 1 while in binding.gyp. while trying to load binding.gyp\ngyp ERR! configure error \ngyp ERR! stack Error: `gyp` failed with exit code: 1\ngyp ERR! stack     at ChildProcess.onCpExit (/usr/local/lib/node_modules/npm/node_modules/node-gyp/lib/configure.js:351:16)\ngyp ERR! stack     at ChildProcess.emit (events.js:314:20)\ngyp ERR! stack     at Process.ChildProcess._handle.onexit (internal/child_process.js:276:12)\ngyp ERR! System Linux 5.4.0-113-generic\ngyp ERR! command \\\"/usr/local/bin/node\\\" \\\"/usr/local/lib/node_modules/npm/node_modules/node-gyp/bin/node-gyp.js\\\" \\\"rebuild\\\"\ngyp ERR! cwd /celo-oracle/node_modules/keytar\ngyp ERR! node -v v12.22.12\ngyp ERR! node-gyp -v v5.1.0\ngyp ERR! not ok\"\n\u001b[0minfo This module is OPTIONAL, you can safely ignore this error\nDone in 35.17s.\nyarn cache v1.22.18\nsuccess Cleared cache.\nDone in 1.98s.\nRemoving intermediate container 244feea546f9\n ---> 2baab9bcdac0\nStep 19/22 : RUN echo $COMMIT_SHA > /version\n ---> Running in 8db212247e26\nRemoving intermediate container 8db212247e26\n ---> 2c8d6ccc0611\nStep 20/22 : RUN [\"chmod\", \"+x\", \"/celo-oracle/readinessProbe.sh\"]\n ---> Running in 2132e940fe68\nRemoving intermediate container 2132e940fe68\n ---> 3c0023f92a9a\nStep 21/22 : USER 1000:1000\n ---> Running in a2ef3e92349b\nRemoving intermediate container a2ef3e92349b\n ---> 6b32f2d036eb\nStep 22/22 : CMD yarn start\n ---> Running in b261e1a17fed\nRemoving intermediate container b261e1a17fed\n ---> 4bead164622c\nSuccessfully built 4bead164622c\nSuccessfully tagged celo-oracle:latest\n","stderr":"","imageSize":1227136600},"endTime":1672258659624}