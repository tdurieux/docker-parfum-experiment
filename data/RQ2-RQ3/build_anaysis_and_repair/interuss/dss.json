{"repository":"https://github.com/interuss/dss","dockerfilePath":"Dockerfile","startTime":1672320214724,"clone":{"stdout":"","stderr":"Cloning into '/tmp/dinghy-analysis/interuss/dss'...\n","error":null,"commit":"c917d03aadaa4bb7adfdc203a2fefab38e006857"},"originalBuild":{"startTimestamp":1672320216176,"endTimestamp":1672320459125,"error":null,"stdout":"Sending build context to Docker daemon  14.62MB\r\r\nStep 1/26 : FROM golang:1.17-alpine AS build\n ---> 270c4f58750f\nStep 2/26 : RUN apk add build-base\n ---> Running in 8f3ab6c97b70\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.16/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.16/community/x86_64/APKINDEX.tar.gz\n(1/20) Upgrading musl (1.2.3-r0 -> 1.2.3-r2)\n(2/20) Installing libgcc (11.2.1_git20220219-r2)\n(3/20) Installing libstdc++ (11.2.1_git20220219-r2)\n(4/20) Installing binutils (2.38-r3)\n(5/20) Installing libmagic (5.41-r0)\n(6/20) Installing file (5.41-r0)\n(7/20) Installing libgomp (11.2.1_git20220219-r2)\n(8/20) Installing libatomic (11.2.1_git20220219-r2)\n(9/20) Installing gmp (6.2.1-r2)\n(10/20) Installing isl22 (0.22-r0)\n(11/20) Installing mpfr4 (4.1.0-r0)\n(12/20) Installing mpc1 (1.2.1-r0)\n(13/20) Installing gcc (11.2.1_git20220219-r2)\n(14/20) Installing musl-dev (1.2.3-r2)\n(15/20) Installing libc-dev (0.7.2-r3)\n(16/20) Installing g++ (11.2.1_git20220219-r2)\n(17/20) Installing make (4.3-r0)\n(18/20) Installing fortify-headers (1.1-r1)\n(19/20) Installing patch (2.7.6-r7)\n(20/20) Installing build-base (0.5-r3)\nExecuting busybox-1.35.0-r15.trigger\nOK: 187 MiB in 34 packages\nRemoving intermediate container 8f3ab6c97b70\n ---> 9b9331d09bc6\nStep 3/26 : RUN apk add git bash make\n ---> Running in 1f55343df179\n(1/10) Installing ncurses-terminfo-base (6.3_p20220521-r0)\n(2/10) Installing ncurses-libs (6.3_p20220521-r0)\n(3/10) Installing readline (8.1.2-r0)\n(4/10) Installing bash (5.1.16-r2)\nExecuting bash-5.1.16-r2.post-install\n(5/10) Installing brotli-libs (1.0.9-r6)\n(6/10) Installing nghttp2-libs (1.47.0-r0)\n(7/10) Installing libcurl (7.83.1-r5)\n(8/10) Installing expat (2.5.0-r0)\n(9/10) Installing pcre2 (10.40-r0)\n(10/10) Installing git (2.36.3-r0)\nExecuting busybox-1.35.0-r15.trigger\nOK: 202 MiB in 44 packages\nRemoving intermediate container 1f55343df179\n ---> 8de58c8158d4\nStep 4/26 : RUN mkdir /app\n ---> Running in 044d455ac79b\nRemoving intermediate container 044d455ac79b\n ---> e36bae08f7e7\nStep 5/26 : COPY go.mod go.sum /app/\n ---> 660c12f3b3b3\nStep 6/26 : RUN go install github.com/go-delve/delve/cmd/dlv@v1.8.2\n ---> Running in 260f414891dd\n\u001b[91mgo: downloading github.com/go-delve/delve v1.8.2\n\u001b[0m\u001b[91mgo: downloading github.com/sirupsen/logrus v1.6.0\ngo: downloading github.com/spf13/cobra v1.1.3\n\u001b[0m\u001b[91mgo: downloading gopkg.in/yaml.v2 v2.4.0\n\u001b[0m\u001b[91mgo: downloading github.com/go-delve/liner v1.2.2-1\n\u001b[0m\u001b[91mgo: downloading github.com/mattn/go-isatty v0.0.3\n\u001b[0m\u001b[91mgo: downloading github.com/google/go-dap v0.6.0\n\u001b[0m\u001b[91mgo: downloading golang.org/x/sys v0.0.0-20211117180635-dee7805ff2e1\n\u001b[0m\u001b[91mgo: downloading github.com/cosiner/argv v0.1.0\n\u001b[0m\u001b[91mgo: downloading github.com/derekparker/trie v0.0.0-20200317170641-1fdf38b7b0e9\n\u001b[0m\u001b[91mgo: downloading go.starlark.net v0.0.0-20200821142938-949cc6f4b097\n\u001b[0m\u001b[91mgo: downloading golang.org/x/arch v0.0.0-20190927153633-4e8777c89be4\n\u001b[0m\u001b[91mgo: downloading github.com/hashicorp/golang-lru v0.5.4\n\u001b[0m\u001b[91mgo: downloading github.com/cilium/ebpf v0.7.0\n\u001b[0m\u001b[91mgo: downloading github.com/spf13/pflag v1.0.5\n\u001b[0m\u001b[91mgo: downloading github.com/cpuguy83/go-md2man/v2 v2.0.0\n\u001b[0m\u001b[91mgo: downloading github.com/mattn/go-runewidth v0.0.13\n\u001b[0m\u001b[91mgo: downloading github.com/russross/blackfriday/v2 v2.0.1\n\u001b[0m\u001b[91mgo: downloading github.com/rivo/uniseg v0.2.0\n\u001b[0m\u001b[91mgo: downloading github.com/shurcooL/sanitized_anchor_name v1.0.0\n\u001b[0mRemoving intermediate container 260f414891dd\n ---> da33868ce2a9\nStep 7/26 : WORKDIR /app\n ---> Running in 179a594bccef\nRemoving intermediate container 179a594bccef\n ---> 21e83840f54f\nStep 8/26 : RUN go mod download\n ---> Running in 2b1273949fba\nRemoving intermediate container 2b1273949fba\n ---> b5fcacadef13\nStep 9/26 : COPY .git /app/.git\n ---> 27ed9c78012c\nStep 10/26 : COPY cmds /app/cmds\n ---> 0df2376c8782\nStep 11/26 : RUN mkdir -p cmds/db-manager\n ---> Running in 24677d087eaf\nRemoving intermediate container 24677d087eaf\n ---> 8f4efac22ec5\nStep 12/26 : COPY pkg /app/pkg\n ---> 25226f3a0a6e\nStep 13/26 : COPY cmds/db-manager cmds/db-manager\n ---> c46593f78635\nStep 14/26 : RUN go install ./...\n ---> Running in 4438c4c00d8c\nRemoving intermediate container 4438c4c00d8c\n ---> 8ee843b27ca3\nStep 15/26 : COPY scripts /app/scripts\n ---> 9cce86c3b789\nStep 16/26 : COPY Makefile /app\n ---> b14fdced21f8\nStep 17/26 : RUN make interuss\n ---> Running in 978368ee14cf\ngo install -ldflags \"-X github.com/interuss/dss/pkg/build.time=2022-12-29.13:27:10 -X github.com/interuss/dss/pkg/build.commit=c917d03-dirty -X github.com/interuss/dss/pkg/build.host=978368ee14cf -X github.com/interuss/dss/pkg/version.tag=v0.6.0-dirty -X github.com/interuss/dss/pkg/version.commit=c917d03-dirty\" ./cmds/...\nRemoving intermediate container 978368ee14cf\n ---> a93e9c4bcf82\nStep 18/26 : FROM alpine:latest\nlatest: Pulling from library/alpine\nDigest: sha256:8914eb54f968791faf6a8638949e480fef81e697984fba772b3976835194c6d4\nStatus: Downloaded newer image for alpine:latest\n ---> 49176f190c7e\nStep 19/26 : RUN apk update && apk add ca-certificates\n ---> Running in 03350dc618a5\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/community/x86_64/APKINDEX.tar.gz\nv3.17.0-306-g917d743036 [https://dl-cdn.alpinelinux.org/alpine/v3.17/main]\nv3.17.0-302-g55f6d884d7 [https://dl-cdn.alpinelinux.org/alpine/v3.17/community]\nOK: 17813 distinct packages available\n(1/1) Installing ca-certificates (20220614-r3)\nExecuting busybox-1.35.0-r29.trigger\nExecuting ca-certificates-20220614-r3.trigger\nOK: 8 MiB in 16 packages\nRemoving intermediate container 03350dc618a5\n ---> b842b4026a49\nStep 20/26 : COPY --from=build /go/bin/core-service /usr/bin\n ---> f0dd0be0bb20\nStep 21/26 : COPY --from=build /go/bin/db-manager /usr/bin\n ---> 70bda659b8c2\nStep 22/26 : COPY --from=build /go/bin/dlv /usr/bin\n ---> ef0227648306\nStep 23/26 : COPY build/jwt-public-certs /jwt-public-certs\n ---> 2688a3efb035\nStep 24/26 : COPY build/test-certs /test-certs\n ---> 2b92ec488ab9\nStep 25/26 : COPY build/deploy/db_schemas /db-schemas\n ---> 273c8c6df121\nStep 26/26 : HEALTHCHECK CMD cat service.ready || exit 1\n ---> Running in d0ccf6bed424\nRemoving intermediate container d0ccf6bed424\n ---> c14322aa74ff\nSuccessfully built c14322aa74ff\nSuccessfully tagged dss:latest\n","stderr":"","imageSize":58408378},"repair":{"violations":[{"name":"apkAddUseNoCache","position":{"start":7,"end":7,"columnStart":4,"columnEnd":22}},{"name":"apkAddUseNoCache","position":{"start":8,"end":8,"columnStart":4,"columnEnd":25}},{"name":"apkAddUseNoCache","position":{"start":34,"end":34,"columnStart":18,"columnEnd":41}}],"repairedDockerfile":"# This Dockerfile builds the InterUSS `dss` image which contains the binary\n# executables for the core-service and the db-manager. It also\n# contains a light weight tool that provides debugging capability. To run a\n# container for this image, the desired binary must be specified (either\n# /usr/bin/core-service or /usr/bin/db-manager).\n\nFROM golang:1.17-alpine AS build\nRUN apk add --no-cache build-base\nRUN apk add --no-cache git bash make\nRUN mkdir /app\nCOPY go.mod go.sum /app/\n# Intend to run delve download outside the go module directory to prevent it\n# from being added as a dependency\nRUN go install github.com/go-delve/delve/cmd/dlv@v1.8.2\nWORKDIR /app\n\n# Get dependencies - will also be cached if we won't change mod/sum\nRUN go mod download\n\nCOPY .git /app/.git\nCOPY cmds /app/cmds\nRUN mkdir -p cmds/db-manager\n\nCOPY pkg /app/pkg\nCOPY cmds/db-manager cmds/db-manager\n\nRUN go install ./...\n\nCOPY scripts /app/scripts\nCOPY Makefile /app\nRUN make interuss\n\n\nFROM alpine:latest\nRUN apk update && apk add --no-cache ca-certificates\nCOPY --from=build /go/bin/core-service /usr/bin\nCOPY --from=build /go/bin/db-manager /usr/bin\nCOPY --from=build /go/bin/dlv /usr/bin\nCOPY build/jwt-public-certs /jwt-public-certs\nCOPY build/test-certs /test-certs\nCOPY build/deploy/db_schemas /db-schemas\nHEALTHCHECK CMD cat service.ready || exit 1\n"},"repairedBuild":{"startTimestamp":1672320461343,"endTimestamp":1672320807839,"error":null,"stdout":"Sending build context to Docker daemon  14.62MB\r\r\nStep 1/26 : FROM golang:1.17-alpine AS build\n ---> 270c4f58750f\nStep 2/26 : RUN apk add --no-cache build-base\n ---> Running in 7f8624078485\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.16/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.16/community/x86_64/APKINDEX.tar.gz\n(1/20) Upgrading musl (1.2.3-r0 -> 1.2.3-r2)\n(2/20) Installing libgcc (11.2.1_git20220219-r2)\n(3/20) Installing libstdc++ (11.2.1_git20220219-r2)\n(4/20) Installing binutils (2.38-r3)\n(5/20) Installing libmagic (5.41-r0)\n(6/20) Installing file (5.41-r0)\n(7/20) Installing libgomp (11.2.1_git20220219-r2)\n(8/20) Installing libatomic (11.2.1_git20220219-r2)\n(9/20) Installing gmp (6.2.1-r2)\n(10/20) Installing isl22 (0.22-r0)\n(11/20) Installing mpfr4 (4.1.0-r0)\n(12/20) Installing mpc1 (1.2.1-r0)\n(13/20) Installing gcc (11.2.1_git20220219-r2)\n(14/20) Installing musl-dev (1.2.3-r2)\n(15/20) Installing libc-dev (0.7.2-r3)\n(16/20) Installing g++ (11.2.1_git20220219-r2)\n(17/20) Installing make (4.3-r0)\n(18/20) Installing fortify-headers (1.1-r1)\n(19/20) Installing patch (2.7.6-r7)\n(20/20) Installing build-base (0.5-r3)\nExecuting busybox-1.35.0-r15.trigger\nOK: 187 MiB in 34 packages\nRemoving intermediate container 7f8624078485\n ---> 3ec3da4e1d9e\nStep 3/26 : RUN apk add --no-cache git bash make\n ---> Running in 5e440455b8f6\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.16/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.16/community/x86_64/APKINDEX.tar.gz\n(1/10) Installing ncurses-terminfo-base (6.3_p20220521-r0)\n(2/10) Installing ncurses-libs (6.3_p20220521-r0)\n(3/10) Installing readline (8.1.2-r0)\n(4/10) Installing bash (5.1.16-r2)\nExecuting bash-5.1.16-r2.post-install\n(5/10) Installing brotli-libs (1.0.9-r6)\n(6/10) Installing nghttp2-libs (1.47.0-r0)\n(7/10) Installing libcurl (7.83.1-r5)\n(8/10) Installing expat (2.5.0-r0)\n(9/10) Installing pcre2 (10.40-r0)\n(10/10) Installing git (2.36.3-r0)\nExecuting busybox-1.35.0-r15.trigger\nOK: 202 MiB in 44 packages\nRemoving intermediate container 5e440455b8f6\n ---> d8c1003507b4\nStep 4/26 : RUN mkdir /app\n ---> Running in 3827d3ad0e60\nRemoving intermediate container 3827d3ad0e60\n ---> 391bd1d3243b\nStep 5/26 : COPY go.mod go.sum /app/\n ---> 679ed7445230\nStep 6/26 : RUN go install github.com/go-delve/delve/cmd/dlv@v1.8.2\n ---> Running in 05b36f42be8d\n\u001b[91mgo: downloading github.com/go-delve/delve v1.8.2\n\u001b[0m\u001b[91mgo: downloading github.com/sirupsen/logrus v1.6.0\n\u001b[0m\u001b[91mgo: downloading github.com/spf13/cobra v1.1.3\n\u001b[0m\u001b[91mgo: downloading github.com/mattn/go-isatty v0.0.3\ngo: downloading golang.org/x/sys v0.0.0-20211117180635-dee7805ff2e1\n\u001b[0m\u001b[91mgo: downloading gopkg.in/yaml.v2 v2.4.0\n\u001b[0m\u001b[91mgo: downloading github.com/cosiner/argv v0.1.0\n\u001b[0m\u001b[91mgo: downloading github.com/derekparker/trie v0.0.0-20200317170641-1fdf38b7b0e9\n\u001b[0m\u001b[91mgo: downloading github.com/go-delve/liner v1.2.2-1\n\u001b[0m\u001b[91mgo: downloading github.com/google/go-dap v0.6.0\ngo: downloading github.com/cilium/ebpf v0.7.0\n\u001b[0m\u001b[91mgo: downloading go.starlark.net v0.0.0-20200821142938-949cc6f4b097\n\u001b[0m\u001b[91mgo: downloading github.com/hashicorp/golang-lru v0.5.4\n\u001b[0m\u001b[91mgo: downloading golang.org/x/arch v0.0.0-20190927153633-4e8777c89be4\n\u001b[0m\u001b[91mgo: downloading github.com/mattn/go-runewidth v0.0.13\n\u001b[0m\u001b[91mgo: downloading github.com/cpuguy83/go-md2man/v2 v2.0.0\ngo: downloading github.com/spf13/pflag v1.0.5\n\u001b[0m\u001b[91mgo: downloading github.com/rivo/uniseg v0.2.0\n\u001b[0m\u001b[91mgo: downloading github.com/russross/blackfriday/v2 v2.0.1\n\u001b[0m\u001b[91mgo: downloading github.com/shurcooL/sanitized_anchor_name v1.0.0\n\u001b[0mRemoving intermediate container 05b36f42be8d\n ---> cbd4f5bd0d99\nStep 7/26 : WORKDIR /app\n ---> Running in f0e1e7f82734\nRemoving intermediate container f0e1e7f82734\n ---> 627a10c00339\nStep 8/26 : RUN go mod download\n ---> Running in b1b79d201e94\nRemoving intermediate container b1b79d201e94\n ---> 99cf99042d1a\nStep 9/26 : COPY .git /app/.git\n ---> e5c81616180a\nStep 10/26 : COPY cmds /app/cmds\n ---> 29b579b95dfb\nStep 11/26 : RUN mkdir -p cmds/db-manager\n ---> Running in 3299a7ccd27a\nRemoving intermediate container 3299a7ccd27a\n ---> 1ed0a137231d\nStep 12/26 : COPY pkg /app/pkg\n ---> bfa65c5411ac\nStep 13/26 : COPY cmds/db-manager cmds/db-manager\n ---> 537bd580aa19\nStep 14/26 : RUN go install ./...\n ---> Running in 15dbb07a9794\nRemoving intermediate container 15dbb07a9794\n ---> f630de63b979\nStep 15/26 : COPY scripts /app/scripts\n ---> 01325c2f042e\nStep 16/26 : COPY Makefile /app\n ---> 079474f58e62\nStep 17/26 : RUN make interuss\n ---> Running in 95e3b3a0e23d\ngo install -ldflags \"-X github.com/interuss/dss/pkg/build.time=2022-12-29.13:32:54 -X github.com/interuss/dss/pkg/build.commit=c917d03-dirty -X github.com/interuss/dss/pkg/build.host=95e3b3a0e23d -X github.com/interuss/dss/pkg/version.tag=v0.6.0-dirty -X github.com/interuss/dss/pkg/version.commit=c917d03-dirty\" ./cmds/...\nRemoving intermediate container 95e3b3a0e23d\n ---> 6261de2e3c1f\nStep 18/26 : FROM alpine:latest\n ---> 49176f190c7e\nStep 19/26 : RUN apk update && apk add --no-cache ca-certificates\n ---> Running in 2586b23ce944\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/community/x86_64/APKINDEX.tar.gz\nv3.17.0-306-g917d743036 [https://dl-cdn.alpinelinux.org/alpine/v3.17/main]\nv3.17.0-302-g55f6d884d7 [https://dl-cdn.alpinelinux.org/alpine/v3.17/community]\nOK: 17813 distinct packages available\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/community/x86_64/APKINDEX.tar.gz\n(1/1) Installing ca-certificates (20220614-r3)\nExecuting busybox-1.35.0-r29.trigger\nExecuting ca-certificates-20220614-r3.trigger\nOK: 8 MiB in 16 packages\nRemoving intermediate container 2586b23ce944\n ---> ef4872e3c7f9\nStep 20/26 : COPY --from=build /go/bin/core-service /usr/bin\n ---> 8be3d38e37eb\nStep 21/26 : COPY --from=build /go/bin/db-manager /usr/bin\n ---> 0bbf75edb65b\nStep 22/26 : COPY --from=build /go/bin/dlv /usr/bin\n ---> da9a77341a40\nStep 23/26 : COPY build/jwt-public-certs /jwt-public-certs\n ---> 19283cf78dfa\nStep 24/26 : COPY build/test-certs /test-certs\n ---> 4d345cdc5a1a\nStep 25/26 : COPY build/deploy/db_schemas /db-schemas\n ---> 1ae1b3a45669\nStep 26/26 : HEALTHCHECK CMD cat service.ready || exit 1\n ---> Running in 693b580e640a\nRemoving intermediate container 693b580e640a\n ---> d1a5791eb3d9\nSuccessfully built d1a5791eb3d9\nSuccessfully tagged dss:latest\n","stderr":"","imageSize":58408378},"endTime":1672320808136}