{"repository":"https://github.com/maddox/harmony-api","dockerfilePath":"Dockerfile","startTime":1672907342145,"endTime":1672907416916,"clone":{"startTime":1672907342146,"stdout":"","stderr":"Cloning into '/tmp/dinghy-analysis/maddox/harmony-api'...\n","error":null,"endTime":1672907343844,"commit":"e4d7b721b70f2e4121ca77039c26500856fbc47f"},"originalBuild":{"startTime":1672907343930,"endTime":1672907397672,"error":null,"stdout":"Sending build context to Docker daemon  199.7kB\r\r\nStep 1/11 : FROM node:argon\nargon: Pulling from library/node\n3d77ce4481b1: Pulling fs layer\n534514c83d69: Pulling fs layer\nd562b1c3ac3f: Pulling fs layer\n4b85e68dc01d: Pulling fs layer\nf6a66c5de9db: Pulling fs layer\n7a4e7d9a081d: Pulling fs layer\n876b13112871: Pulling fs layer\n95d109ce6b5d: Pulling fs layer\nf6a66c5de9db: Waiting\n7a4e7d9a081d: Waiting\n876b13112871: Waiting\n95d109ce6b5d: Waiting\n4b85e68dc01d: Waiting\n534514c83d69: Verifying Checksum\n534514c83d69: Download complete\n3d77ce4481b1: Verifying Checksum\n3d77ce4481b1: Download complete\nd562b1c3ac3f: Verifying Checksum\nd562b1c3ac3f: Download complete\nf6a66c5de9db: Download complete\n7a4e7d9a081d: Download complete\n876b13112871: Verifying Checksum\n876b13112871: Download complete\n95d109ce6b5d: Verifying Checksum\n95d109ce6b5d: Download complete\n3d77ce4481b1: Pull complete\n534514c83d69: Pull complete\n4b85e68dc01d: Verifying Checksum\n4b85e68dc01d: Download complete\nd562b1c3ac3f: Pull complete\n4b85e68dc01d: Pull complete\nf6a66c5de9db: Pull complete\n7a4e7d9a081d: Pull complete\n876b13112871: Pull complete\n95d109ce6b5d: Pull complete\nDigest: sha256:fab73fccce5abc3fade13a99179884a306aa6c5292a2fc11833ee25ca15c1f85\nStatus: Downloaded newer image for node:argon\n ---> ef4b194d8fcf\nStep 2/11 : RUN mkdir -p /usr/src/app\n ---> Running in 34c4c206ff6c\nRemoving intermediate container 34c4c206ff6c\n ---> 648e8fb9c9ba\nStep 3/11 : WORKDIR /usr/src/app\n ---> Running in 6197cb210c0b\nRemoving intermediate container 6197cb210c0b\n ---> f0e6298751c8\nStep 4/11 : COPY package.json /usr/src/app\n ---> 09d96651aebe\nStep 5/11 : RUN rm -Rf node_modules\n ---> Running in c48a3f712ec8\nRemoving intermediate container c48a3f712ec8\n ---> 8d260b05a203\nStep 6/11 : RUN npm install\n ---> Running in c53330aba1c3\n\u001b[91mnpm\u001b[0m\u001b[91m \u001b[0m\u001b[91mWARN package.json harmony-api@2.3.5 No README data\n\u001b[0m\u001b[91mnpm WARN engine harmonyhubjs-client@1.1.11: wanted: {\"npm\":\">=3.0.0\"} (current: {\"node\":\"4.9.1\",\"npm\":\"2.15.11\"})\n\u001b[0m\u001b[91mnpm WARN deprecated request@2.88.2: request has been deprecated, see https://github.com/request/request/issues/3142\n\u001b[0m\u001b[91mnpm WARN deprecated node-xmpp-stanza@1.1.0: use @xmpp/xml package <https://www.npmjs.com/package/@xmpp/xml>\n\u001b[0m\u001b[91mnpm WARN deprecated node-xmpp-client@3.0.0: this package is deprecated please use https://www.npmjs.com/package/@xmpp/client\n\u001b[0m\u001b[91mnpm WARN engine request@2.88.2: wanted: {\"node\":\">= 6\"} (current: {\"node\":\"4.9.1\",\"npm\":\"2.15.11\"})\n\u001b[0m\u001b[91mnpm WARN deprecated har-validator@5.1.5: this library is no longer supported\n\u001b[0m\u001b[91mnpm WARN deprecated uuid@3.4.0: Please upgrade  to version 7 or higher.  Older versions may use Math.random() in certain circumstances, which is known to be problematic.  See https://v8.dev/blog/math-random for details.\n\u001b[0m\u001b[91mnpm WARN deprecated istanbul@0.4.5: This module is no longer maintained, try this instead:\nnpm WARN deprecated   npm i nyc\nnpm WARN deprecated Visit https://istanbul.js.org/integrations for other alternatives.\n\u001b[0m\u001b[91mnpm WARN engine har-validator@5.1.5: wanted: {\"node\":\">=6\"} (current: {\"node\":\"4.9.1\",\"npm\":\"2.15.11\"})\n\u001b[0m\u001b[91mnpm WARN engine punycode@2.1.1: wanted: {\"node\":\">=6\"} (current: {\"node\":\"4.9.1\",\"npm\":\"2.15.11\"})\n\u001b[0m\u001b[91mnpm WARN deprecated node-xmpp-core@4.2.0: this package is deprecated please use https://github.com/xmppjs/xmpp.js\n\u001b[0m\u001b[91mnpm WARN engine punycode@2.1.1: wanted: {\"node\":\">=6\"} (current: {\"node\":\"4.9.1\",\"npm\":\"2.15.11\"})\n\u001b[0m\u001b[91mnpm WARN deprecated node-xmpp-jid@2.3.0: use @xmpp/jid package <https://www.npmjs.com/package/@xmpp/jid>\n\u001b[0mparameterize@0.0.7 node_modules/parameterize\n\nharmonyhubjs-discover@1.1.1 node_modules/harmonyhubjs-discover\n└── debug@2.6.9 (ms@2.0.0)\n\nmorgan@1.10.0 node_modules/morgan\n├── on-headers@1.0.2\n├── depd@2.0.0\n├── on-finished@2.3.0 (ee-first@1.1.1)\n├── basic-auth@2.0.1 (safe-buffer@5.1.2)\n└── debug@2.6.9 (ms@2.0.0)\n\nexpress@4.18.2 node_modules/express\n├── escape-html@1.0.3\n├── array-flatten@1.1.1\n├── utils-merge@1.0.1\n├── encodeurl@1.0.2\n├── content-type@1.0.4\n├── merge-descriptors@1.0.1\n├── cookie-signature@1.0.6\n├── methods@1.1.2\n├── fresh@0.5.2\n├── depd@2.0.0\n├── etag@1.8.1\n├── content-disposition@0.5.4\n├── parseurl@1.3.3\n├── range-parser@1.2.1\n├── path-to-regexp@0.1.7\n├── vary@1.1.2\n├── serve-static@1.15.0\n├── safe-buffer@5.2.1\n├── setprototypeof@1.2.0\n├── cookie@0.5.0\n├── statuses@2.0.1\n├── on-finished@2.4.1 (ee-first@1.1.1)\n├── finalhandler@1.2.0 (unpipe@1.0.0)\n├── http-errors@2.0.0 (toidentifier@1.0.1, inherits@2.0.4)\n├── debug@2.6.9 (ms@2.0.0)\n├── send@0.18.0 (destroy@1.2.0, ms@2.1.3, mime@1.6.0)\n├── type-is@1.6.18 (media-typer@0.3.0, mime-types@2.1.35)\n├── proxy-addr@2.0.7 (forwarded@0.2.0, ipaddr.js@1.9.1)\n├── accepts@1.3.8 (negotiator@0.6.3, mime-types@2.1.35)\n└── qs@6.11.0 (side-channel@1.0.4)\n\nbody-parser@1.20.1 node_modules/body-parser\n├── destroy@1.2.0\n├── content-type@1.0.4\n├── unpipe@1.0.0\n├── bytes@3.1.2\n├── depd@2.0.0\n├── raw-body@2.5.1\n├── on-finished@2.4.1 (ee-first@1.1.1)\n├── debug@2.6.9 (ms@2.0.0)\n├── http-errors@2.0.0 (setprototypeof@1.2.0, statuses@2.0.1, toidentifier@1.0.1, inherits@2.0.4)\n├── iconv-lite@0.4.24 (safer-buffer@2.1.2)\n├── type-is@1.6.18 (media-typer@0.3.0, mime-types@2.1.35)\n└── qs@6.11.0 (side-channel@1.0.4)\n\nmqtt@1.14.1 node_modules/mqtt\n├── inherits@2.0.4\n├── xtend@4.0.2\n├── reinterval@1.1.0\n├── minimist@1.2.7\n├── commist@1.1.0 (leven@2.1.0)\n├── readable-stream@1.0.34 (core-util-is@1.0.3, string_decoder@0.10.31, isarray@0.0.1)\n├── mqtt-connection@2.1.1 (through2@0.6.5, reduplexer@1.1.0)\n├── concat-stream@1.6.2 (buffer-from@1.1.2, typedarray@0.0.6, readable-stream@2.3.7)\n├── split2@2.2.0 (through2@2.0.5)\n├── mqtt-packet@3.5.1 (bl@1.2.3)\n├── pump@1.0.3 (once@1.4.0)\n├── end-of-stream@1.4.4 (once@1.4.0)\n├── websocket-stream@3.3.3 (through2@2.0.5, duplexify@3.7.1, ws@1.1.5)\n└── help-me@1.1.0 (callback-stream@1.1.0, through2@2.0.5, glob-stream@6.1.0)\n\nharmonyhubjs-client@1.1.11 node_modules/harmonyhubjs-client\n├── q@1.5.1\n├── node-xmpp-stanza@1.1.0 (inherits@2.0.4)\n├── debug@2.6.9 (ms@2.0.0)\n├── ltx@2.2.0 (inherits@2.0.4)\n├── request@2.88.2 (safe-buffer@5.2.1, aws-sign2@0.7.0, forever-agent@0.6.1, oauth-sign@0.9.0, tunnel-agent@0.6.0, is-typedarray@1.0.0, caseless@0.12.0, aws4@1.11.0, isstream@0.1.2, extend@3.0.2, json-stringify-safe@5.0.1, performance-now@2.1.0, qs@6.5.3, uuid@3.4.0, mime-types@2.1.35, combined-stream@1.0.8, tough-cookie@2.5.0, form-data@2.3.3, har-validator@5.1.5, http-signature@1.2.0)\n└── node-xmpp-client@3.0.0 (browser-request@0.3.3, minimist@1.2.7, faye-websocket@0.10.0, istanbul@0.4.5, node-xmpp-core@4.2.0)\nRemoving intermediate container c53330aba1c3\n ---> 9e585228dbda\nStep 7/11 : COPY . /usr/src/app\n ---> 81bc88747fd5\nStep 8/11 : COPY ./config/config.sample.json /config/config.json\n ---> 54975b0f8352\nStep 9/11 : ENV CONFIG_DIR /config\n ---> Running in 9552cbb7a936\nRemoving intermediate container 9552cbb7a936\n ---> c09cb7a5aaaf\nStep 10/11 : EXPOSE 8282\n ---> Running in efd434eadb97\nRemoving intermediate container efd434eadb97\n ---> 417c0cb5192f\nStep 11/11 : CMD [ \"npm\", \"start\" ]\n ---> Running in 28c33fef0906\nRemoving intermediate container 28c33fef0906\n ---> e937fb1bf622\nSuccessfully built e937fb1bf622\nSuccessfully tagged harmony-api:latest\n","stderr":"","imageSize":696745317},"repair":{"startTime":1672907397744,"endTime":1672907397816,"violations":[{"name":"npmCacheCleanAfterInstall","position":{"start":9,"end":9,"columnStart":4,"columnEnd":15}},{"name":"mkdirUsrSrcThenRemove","position":{"start":3,"end":3,"columnStart":4,"columnEnd":25}}],"repairedDockerfile":"FROM node:argon\n\n# Create app directory\nRUN mkdir -p /usr/src/app && rm -rf /usr/src/app\nWORKDIR /usr/src/app\n\n# Install app dependencies\nCOPY package.json /usr/src/app\nRUN rm -Rf node_modules\nRUN npm install && npm cache clean --force;\n\nCOPY . /usr/src/app\nCOPY ./config/config.sample.json /config/config.json\n\nENV CONFIG_DIR /config\n\nEXPOSE 8282\nCMD [ \"npm\", \"start\" ]\n"},"repairedBuild":{"startTime":1672907398068,"endTime":1672907416607,"error":null,"stdout":"Sending build context to Docker daemon  199.7kB\r\r\nStep 1/11 : FROM node:argon\n ---> ef4b194d8fcf\nStep 2/11 : RUN mkdir -p /usr/src/app && rm -rf /usr/src/app\n ---> Running in 8952307bfc1c\nRemoving intermediate container 8952307bfc1c\n ---> e431f078bc2c\nStep 3/11 : WORKDIR /usr/src/app\n ---> Running in 81beb87021a4\nRemoving intermediate container 81beb87021a4\n ---> b682711326fd\nStep 4/11 : COPY package.json /usr/src/app\n ---> ff9a9e363b7e\nStep 5/11 : RUN rm -Rf node_modules\n ---> Running in 098a456a1261\nRemoving intermediate container 098a456a1261\n ---> 86df8ac6d7d1\nStep 6/11 : RUN npm install && npm cache clean --force;\n ---> Running in 3c7104640d63\n\u001b[91mnpm\u001b[0m\u001b[91m \u001b[0m\u001b[91mWARN package.json harmony-api@2.3.5 No README data\n\u001b[0m\u001b[91mnpm WARN engine harmonyhubjs-client@1.1.11: wanted: {\"npm\":\">=3.0.0\"} (current: {\"node\":\"4.9.1\",\"npm\":\"2.15.11\"})\n\u001b[0m\u001b[91mnpm WARN deprecated node-xmpp-stanza@1.1.0: use @xmpp/xml package <https://www.npmjs.com/package/@xmpp/xml>\n\u001b[0m\u001b[91mnpm WARN deprecated node-xmpp-client@3.0.0: this package is deprecated please use https://www.npmjs.com/package/@xmpp/client\n\u001b[0m\u001b[91mnpm WARN deprecated request@2.88.2: request has been deprecated, see https://github.com/request/request/issues/3142\n\u001b[0m\u001b[91mnpm WARN engine request@2.88.2: wanted: {\"node\":\">= 6\"} (current: {\"node\":\"4.9.1\",\"npm\":\"2.15.11\"})\n\u001b[0m\u001b[91mnpm WARN deprecated har-validator@5.1.5: this library is no longer supported\n\u001b[0m\u001b[91mnpm WARN deprecated uuid@3.4.0: Please upgrade  to version 7 or higher.  Older versions may use Math.random() in certain circumstances, which is known to be problematic.  See https://v8.dev/blog/math-random for details.\n\u001b[0m\u001b[91mnpm WARN deprecated node-xmpp-core@4.2.0: this package is deprecated please use https://github.com/xmppjs/xmpp.js\n\u001b[0m\u001b[91mnpm WARN deprecated istanbul@0.4.5: This module is no longer maintained, try this instead:\nnpm WARN deprecated   npm i nyc\nnpm WARN deprecated Visit https://istanbul.js.org/integrations for other alternatives.\n\u001b[0m\u001b[91mnpm WARN engine har-validator@5.1.5: wanted: {\"node\":\">=6\"} (current: {\"node\":\"4.9.1\",\"npm\":\"2.15.11\"})\n\u001b[0m\u001b[91mnpm WARN deprecated node-xmpp-jid@2.3.0: use @xmpp/jid package <https://www.npmjs.com/package/@xmpp/jid>\n\u001b[0m\u001b[91mnpm WARN engine punycode@2.1.1: wanted: {\"node\":\">=6\"} (current: {\"node\":\"4.9.1\",\"npm\":\"2.15.11\"})\n\u001b[0m\u001b[91mnpm WARN engine punycode@2.1.1: wanted: {\"node\":\">=6\"} (current: {\"node\":\"4.9.1\",\"npm\":\"2.15.11\"})\n\u001b[0mparameterize@0.0.7 node_modules/parameterize\n\nmorgan@1.10.0 node_modules/morgan\n├── on-headers@1.0.2\n├── depd@2.0.0\n├── basic-auth@2.0.1 (safe-buffer@5.1.2)\n├── on-finished@2.3.0 (ee-first@1.1.1)\n└── debug@2.6.9 (ms@2.0.0)\n\nharmonyhubjs-discover@1.1.1 node_modules/harmonyhubjs-discover\n└── debug@2.6.9 (ms@2.0.0)\n\nbody-parser@1.20.1 node_modules/body-parser\n├── destroy@1.2.0\n├── content-type@1.0.4\n├── unpipe@1.0.0\n├── bytes@3.1.2\n├── depd@2.0.0\n├── raw-body@2.5.1\n├── on-finished@2.4.1 (ee-first@1.1.1)\n├── http-errors@2.0.0 (setprototypeof@1.2.0, statuses@2.0.1, toidentifier@1.0.1, inherits@2.0.4)\n├── debug@2.6.9 (ms@2.0.0)\n├── type-is@1.6.18 (media-typer@0.3.0, mime-types@2.1.35)\n├── iconv-lite@0.4.24 (safer-buffer@2.1.2)\n└── qs@6.11.0 (side-channel@1.0.4)\n\nexpress@4.18.2 node_modules/express\n├── escape-html@1.0.3\n├── array-flatten@1.1.1\n├── cookie-signature@1.0.6\n├── utils-merge@1.0.1\n├── encodeurl@1.0.2\n├── merge-descriptors@1.0.1\n├── methods@1.1.2\n├── depd@2.0.0\n├── content-type@1.0.4\n├── fresh@0.5.2\n├── content-disposition@0.5.4\n├── etag@1.8.1\n├── parseurl@1.3.3\n├── serve-static@1.15.0\n├── range-parser@1.2.1\n├── path-to-regexp@0.1.7\n├── vary@1.1.2\n├── safe-buffer@5.2.1\n├── setprototypeof@1.2.0\n├── cookie@0.5.0\n├── statuses@2.0.1\n├── on-finished@2.4.1 (ee-first@1.1.1)\n├── finalhandler@1.2.0 (unpipe@1.0.0)\n├── http-errors@2.0.0 (toidentifier@1.0.1, inherits@2.0.4)\n├── proxy-addr@2.0.7 (forwarded@0.2.0, ipaddr.js@1.9.1)\n├── debug@2.6.9 (ms@2.0.0)\n├── accepts@1.3.8 (negotiator@0.6.3, mime-types@2.1.35)\n├── send@0.18.0 (destroy@1.2.0, ms@2.1.3, mime@1.6.0)\n├── type-is@1.6.18 (media-typer@0.3.0, mime-types@2.1.35)\n└── qs@6.11.0 (side-channel@1.0.4)\n\nmqtt@1.14.1 node_modules/mqtt\n├── inherits@2.0.4\n├── xtend@4.0.2\n├── reinterval@1.1.0\n├── minimist@1.2.7\n├── commist@1.1.0 (leven@2.1.0)\n├── readable-stream@1.0.34 (core-util-is@1.0.3, string_decoder@0.10.31, isarray@0.0.1)\n├── mqtt-connection@2.1.1 (through2@0.6.5, reduplexer@1.1.0)\n├── end-of-stream@1.4.4 (once@1.4.0)\n├── pump@1.0.3 (once@1.4.0)\n├── concat-stream@1.6.2 (buffer-from@1.1.2, typedarray@0.0.6, readable-stream@2.3.7)\n├── split2@2.2.0 (through2@2.0.5)\n├── mqtt-packet@3.5.1 (bl@1.2.3)\n├── websocket-stream@3.3.3 (ws@1.1.5, through2@2.0.5, duplexify@3.7.1)\n└── help-me@1.1.0 (callback-stream@1.1.0, through2@2.0.5, glob-stream@6.1.0)\n\nharmonyhubjs-client@1.1.11 node_modules/harmonyhubjs-client\n├── q@1.5.1\n├── node-xmpp-stanza@1.1.0 (inherits@2.0.4)\n├── debug@2.6.9 (ms@2.0.0)\n├── ltx@2.2.0 (inherits@2.0.4)\n├── request@2.88.2 (safe-buffer@5.2.1, tunnel-agent@0.6.0, oauth-sign@0.9.0, aws-sign2@0.7.0, forever-agent@0.6.1, is-typedarray@1.0.0, caseless@0.12.0, aws4@1.11.0, isstream@0.1.2, extend@3.0.2, json-stringify-safe@5.0.1, performance-now@2.1.0, qs@6.5.3, uuid@3.4.0, mime-types@2.1.35, combined-stream@1.0.8, form-data@2.3.3, tough-cookie@2.5.0, http-signature@1.2.0, har-validator@5.1.5)\n└── node-xmpp-client@3.0.0 (browser-request@0.3.3, minimist@1.2.7, faye-websocket@0.10.0, node-xmpp-core@4.2.0, istanbul@0.4.5)\n\u001b[91mnpm\u001b[0m\u001b[91m \u001b[0m\u001b[91mWARN using --force\u001b[0m\u001b[91m I sure hope you know what you are doing.\n\u001b[0mRemoving intermediate container 3c7104640d63\n ---> e4271ec9e7c4\nStep 7/11 : COPY . /usr/src/app\n ---> a03f52db72e5\nStep 8/11 : COPY ./config/config.sample.json /config/config.json\n ---> 367e0b454faa\nStep 9/11 : ENV CONFIG_DIR /config\n ---> Running in 73cb782dbf8c\nRemoving intermediate container 73cb782dbf8c\n ---> e288aeb1e693\nStep 10/11 : EXPOSE 8282\n ---> Running in 2535d1671630\nRemoving intermediate container 2535d1671630\n ---> 640ee0a37b4b\nStep 11/11 : CMD [ \"npm\", \"start\" ]\n ---> Running in ae2b96c9e237\nRemoving intermediate container ae2b96c9e237\n ---> 767b814d87fa\nSuccessfully built 767b814d87fa\nSuccessfully tagged harmony-api:latest\n","stderr":"","imageSize":676565264}}