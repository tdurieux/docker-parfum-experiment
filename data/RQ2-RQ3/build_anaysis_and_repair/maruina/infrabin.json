{"repository":"https://github.com/maruina/infrabin","dockerfilePath":"Dockerfile","startTime":1672197950402,"clone":{"stdout":"","stderr":"Cloning into '/tmp/dinghy-analysis/maruina/infrabin'...\n","error":null,"commit":"75defc8b52d1beaa79485bcbb0758415d48dd2c8"},"originalBuild":{"startTimestamp":1672197951204,"endTimestamp":1672198148160,"error":null,"stdout":"Sending build context to Docker daemon    257kB\r\r\nStep 1/19 : FROM golang:1.13-alpine3.10 as go-builder\n1.13-alpine3.10: Pulling from library/golang\n21c83c524219: Already exists\n93fb370585b2: Pulling fs layer\ne3eaf3a77a91: Pulling fs layer\nc061b7ac4607: Pulling fs layer\n00a52a315a3d: Pulling fs layer\n00a52a315a3d: Waiting\ne3eaf3a77a91: Verifying Checksum\ne3eaf3a77a91: Download complete\n93fb370585b2: Verifying Checksum\n93fb370585b2: Download complete\n93fb370585b2: Pull complete\ne3eaf3a77a91: Pull complete\n00a52a315a3d: Verifying Checksum\n00a52a315a3d: Download complete\nc061b7ac4607: Verifying Checksum\nc061b7ac4607: Download complete\nc061b7ac4607: Pull complete\n00a52a315a3d: Pull complete\nDigest: sha256:4c0cdb817e8450ec2cecbd72ce51d5e789bd21eba91177947ecd105e80b6732b\nStatus: Downloaded newer image for golang:1.13-alpine3.10\n ---> 569e3fae2346\nStep 2/19 : WORKDIR /go/src\n ---> Running in 287da17384af\nRemoving intermediate container 287da17384af\n ---> 489caf81d3c0\nStep 3/19 : RUN mkdir monzo\n ---> Running in 937bc740a92f\nRemoving intermediate container 937bc740a92f\n ---> 5ef6136d2da5\nStep 4/19 : WORKDIR /go/src/monzo\n ---> Running in 132cfdd46e3d\nRemoving intermediate container 132cfdd46e3d\n ---> 3d27f87a9268\nStep 5/19 : RUN apk add --no-cache git &&     git clone https://github.com/monzo/envoy-preflight\n ---> Running in 9e154bb81a1a\nfetch http://dl-cdn.alpinelinux.org/alpine/v3.10/main/x86_64/APKINDEX.tar.gz\nfetch http://dl-cdn.alpinelinux.org/alpine/v3.10/community/x86_64/APKINDEX.tar.gz\n(1/5) Installing nghttp2-libs (1.39.2-r1)\n(2/5) Installing libcurl (7.66.0-r4)\n(3/5) Installing expat (2.2.8-r0)\n(4/5) Installing pcre2 (10.33-r0)\n(5/5) Installing git (2.22.5-r0)\nExecuting busybox-1.30.1-r3.trigger\nOK: 21 MiB in 20 packages\n\u001b[91mCloning into 'envoy-preflight'...\n\u001b[0mRemoving intermediate container 9e154bb81a1a\n ---> 639473174f6f\nStep 6/19 : WORKDIR /go/src/monzo/envoy-preflight\n ---> Running in 8e00b7c85652\nRemoving intermediate container 8e00b7c85652\n ---> 68320c8495d1\nStep 7/19 : RUN go build &&     chmod +x envoy-preflight\n ---> Running in 068c3b8c7089\nRemoving intermediate container 068c3b8c7089\n ---> c9b5fbe39016\nStep 8/19 : FROM python:3.7-alpine\n ---> 23de60bcccb1\nStep 9/19 : ENV PORT=8080\n ---> Running in 57057cc289fd\nRemoving intermediate container 57057cc289fd\n ---> 7d3644ccd1e8\nStep 10/19 : ENV THREADS=8\n ---> Running in 1a9b15bc4ec3\nRemoving intermediate container 1a9b15bc4ec3\n ---> e832612121fc\nStep 11/19 : RUN addgroup infrabin &&     adduser -S -G infrabin infrabin\n ---> Running in e973b3e370e6\nRemoving intermediate container e973b3e370e6\n ---> 634810baba90\nStep 12/19 : RUN apk add --no-cache gcc musl-dev linux-headers curl bind-tools dumb-init\n ---> Running in 3bf46a85cc99\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/community/x86_64/APKINDEX.tar.gz\n(1/23) Installing fstrm (0.6.1-r1)\n(2/23) Installing nghttp2-libs (1.51.0-r0)\n(3/23) Installing protobuf-c (1.4.1-r1)\n(4/23) Installing libuv (1.44.2-r0)\n(5/23) Installing libxml2 (2.10.3-r1)\n(6/23) Installing bind-libs (9.18.10-r0)\n(7/23) Installing bind-tools (9.18.10-r0)\n(8/23) Installing brotli-libs (1.0.9-r9)\n(9/23) Installing libcurl (7.87.0-r0)\n(10/23) Installing curl (7.87.0-r0)\n(11/23) Installing dumb-init (1.2.5-r2)\n(12/23) Installing libgcc (12.2.1_git20220924-r4)\n(13/23) Installing libstdc++ (12.2.1_git20220924-r4)\n(14/23) Installing binutils (2.39-r2)\n(15/23) Installing libgomp (12.2.1_git20220924-r4)\n(16/23) Installing libatomic (12.2.1_git20220924-r4)\n(17/23) Installing gmp (6.2.1-r2)\n(18/23) Installing isl25 (0.25-r0)\n(19/23) Installing mpfr4 (4.1.0-r0)\n(20/23) Installing mpc1 (1.2.1-r1)\n(21/23) Installing gcc (12.2.1_git20220924-r4)\n(22/23) Installing linux-headers (5.19.5-r0)\n(23/23) Installing musl-dev (1.2.3-r4)\nExecuting busybox-1.35.0-r29.trigger\nOK: 180 MiB in 60 packages\nRemoving intermediate container 3bf46a85cc99\n ---> 1cdc6a531d03\nStep 13/19 : ADD . /infrabin\n ---> 91ee5e2af394\nStep 14/19 : WORKDIR /infrabin\n ---> Running in 803ee9c8e28e\nRemoving intermediate container 803ee9c8e28e\n ---> 779f050ecbeb\nStep 15/19 : RUN pip install pip pipenv -U &&     pipenv install --deploy --system --skip-lock\n ---> Running in f8f487fb00a6\nRequirement already satisfied: pip in /usr/local/lib/python3.7/site-packages (22.0.4)\nCollecting pip\n  Downloading pip-22.3.1-py3-none-any.whl (2.1 MB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 2.1/2.1 MB 15.6 MB/s eta 0:00:00\nCollecting pipenv\n  Downloading pipenv-2022.12.19-py3-none-any.whl (2.9 MB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 2.9/2.9 MB 28.0 MB/s eta 0:00:00\nCollecting virtualenv\n  Downloading virtualenv-20.17.1-py3-none-any.whl (8.8 MB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 8.8/8.8 MB 47.6 MB/s eta 0:00:00\nRequirement already satisfied: setuptools>=36.2.1 in /usr/local/lib/python3.7/site-packages (from pipenv) (57.5.0)\nCollecting virtualenv-clone>=0.2.5\n  Downloading virtualenv_clone-0.5.7-py3-none-any.whl (6.6 kB)\nCollecting certifi\n  Downloading certifi-2022.12.7-py3-none-any.whl (155 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 155.3/155.3 KB 11.4 MB/s eta 0:00:00\nCollecting distlib<1,>=0.3.6\n  Downloading distlib-0.3.6-py2.py3-none-any.whl (468 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 468.5/468.5 KB 22.7 MB/s eta 0:00:00\nCollecting platformdirs<3,>=2.4\n  Downloading platformdirs-2.6.0-py3-none-any.whl (14 kB)\nCollecting importlib-metadata>=4.8.3\n  Downloading importlib_metadata-5.2.0-py3-none-any.whl (21 kB)\nCollecting filelock<4,>=3.4.1\n  Downloading filelock-3.8.2-py3-none-any.whl (10 kB)\nCollecting typing-extensions>=3.6.4\n  Downloading typing_extensions-4.4.0-py3-none-any.whl (26 kB)\nCollecting zipp>=0.5\n  Downloading zipp-3.11.0-py3-none-any.whl (6.6 kB)\nInstalling collected packages: distlib, zipp, virtualenv-clone, typing-extensions, platformdirs, pip, filelock, certifi, importlib-metadata, virtualenv, pipenv\n  Attempting uninstall: pip\n    Found existing installation: pip 22.0.4\n    Uninstalling pip-22.0.4:\n      Successfully uninstalled pip-22.0.4\nSuccessfully installed certifi-2022.12.7 distlib-0.3.6 filelock-3.8.2 importlib-metadata-5.2.0 pip-22.3.1 pipenv-2022.12.19 platformdirs-2.6.0 typing-extensions-4.4.0 virtualenv-20.17.1 virtualenv-clone-0.5.7 zipp-3.11.0\n\u001b[91mWARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv\n\u001b[0mInstalling dependencies from Pipfile...\nRemoving intermediate container f8f487fb00a6\n ---> 0f7812131c56\nStep 16/19 : EXPOSE ${PORT}\n ---> Running in cae34d158090\nRemoving intermediate container cae34d158090\n ---> cdacae68bbec\nStep 17/19 : COPY docker-entrypoint.sh /usr/local/bin/docker-entrypoint.sh\n ---> 5a8a2d285c95\nStep 18/19 : COPY --from=go-builder /go/src/monzo/envoy-preflight/envoy-preflight /usr/local/bin/envoy-preflight\n ---> 6efa94c8a2eb\nStep 19/19 : ENTRYPOINT [\"docker-entrypoint.sh\"]\n ---> Running in 766687b3798d\nRemoving intermediate container 766687b3798d\n ---> 81e3ae61fc92\nSuccessfully built 81e3ae61fc92\nSuccessfully tagged infrabin:latest\n","stderr":"","imageSize":302765861},"repair":{"violations":[{"name":"pipUseNoCacheDir","position":{"start":21,"end":21,"columnStart":4,"columnEnd":29}}],"repairedDockerfile":"FROM golang:1.13-alpine3.10 as go-builder\nWORKDIR /go/src\nRUN mkdir monzo\nWORKDIR /go/src/monzo\nRUN apk add --no-cache git && \\\n    git clone https://github.com/monzo/envoy-preflight\nWORKDIR /go/src/monzo/envoy-preflight\nRUN go build && \\\n    chmod +x envoy-preflight\n\nFROM python:3.7-alpine\nENV PORT=8080\nENV THREADS=8\n\nRUN addgroup infrabin && \\\n    adduser -S -G infrabin infrabin\n\nRUN apk add --no-cache gcc musl-dev linux-headers curl bind-tools dumb-init\n\nADD . /infrabin\nWORKDIR /infrabin\nRUN pip install --no-cache-dir pip pipenv -U && \\\n    pipenv install --deploy --system --skip-lock\n\nEXPOSE ${PORT}\n\nCOPY docker-entrypoint.sh /usr/local/bin/docker-entrypoint.sh\nCOPY --from=go-builder /go/src/monzo/envoy-preflight/envoy-preflight /usr/local/bin/envoy-preflight\n\nENTRYPOINT [\"docker-entrypoint.sh\"]\n"},"repairedBuild":{"startTimestamp":1672198148997,"endTimestamp":1672198251659,"error":null,"stdout":"Sending build context to Docker daemon    257kB\r\r\nStep 1/19 : FROM golang:1.13-alpine3.10 as go-builder\n ---> 569e3fae2346\nStep 2/19 : WORKDIR /go/src\n ---> Running in 9bd8583ffc55\nRemoving intermediate container 9bd8583ffc55\n ---> 9de2bcd621e8\nStep 3/19 : RUN mkdir monzo\n ---> Running in 07653560e2e5\nRemoving intermediate container 07653560e2e5\n ---> ee49f1802b0b\nStep 4/19 : WORKDIR /go/src/monzo\n ---> Running in df43386e3778\nRemoving intermediate container df43386e3778\n ---> 784d04ef51a1\nStep 5/19 : RUN apk add --no-cache git &&     git clone https://github.com/monzo/envoy-preflight\n ---> Running in 8ee5ee263036\nfetch http://dl-cdn.alpinelinux.org/alpine/v3.10/main/x86_64/APKINDEX.tar.gz\nfetch http://dl-cdn.alpinelinux.org/alpine/v3.10/community/x86_64/APKINDEX.tar.gz\n(1/5) Installing nghttp2-libs (1.39.2-r1)\n(2/5) Installing libcurl (7.66.0-r4)\n(3/5) Installing expat (2.2.8-r0)\n(4/5) Installing pcre2 (10.33-r0)\n(5/5) Installing git (2.22.5-r0)\nExecuting busybox-1.30.1-r3.trigger\nOK: 21 MiB in 20 packages\n\u001b[91mCloning into 'envoy-preflight'...\n\u001b[0mRemoving intermediate container 8ee5ee263036\n ---> 9c4638595fea\nStep 6/19 : WORKDIR /go/src/monzo/envoy-preflight\n ---> Running in 611ec6968b0f\nRemoving intermediate container 611ec6968b0f\n ---> c597d3ffb0f6\nStep 7/19 : RUN go build &&     chmod +x envoy-preflight\n ---> Running in 867cbd463967\nRemoving intermediate container 867cbd463967\n ---> 61bcc611474e\nStep 8/19 : FROM python:3.7-alpine\n ---> 23de60bcccb1\nStep 9/19 : ENV PORT=8080\n ---> Running in 83df94d4cc74\nRemoving intermediate container 83df94d4cc74\n ---> b2631fe4d770\nStep 10/19 : ENV THREADS=8\n ---> Running in 54b76254cd09\nRemoving intermediate container 54b76254cd09\n ---> 1df177e3ab2b\nStep 11/19 : RUN addgroup infrabin &&     adduser -S -G infrabin infrabin\n ---> Running in 10b35091baf9\nRemoving intermediate container 10b35091baf9\n ---> b5f9dcc5d96d\nStep 12/19 : RUN apk add --no-cache gcc musl-dev linux-headers curl bind-tools dumb-init\n ---> Running in 1cef66912b06\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/community/x86_64/APKINDEX.tar.gz\n(1/23) Installing fstrm (0.6.1-r1)\n(2/23) Installing nghttp2-libs (1.51.0-r0)\n(3/23) Installing protobuf-c (1.4.1-r1)\n(4/23) Installing libuv (1.44.2-r0)\n(5/23) Installing libxml2 (2.10.3-r1)\n(6/23) Installing bind-libs (9.18.10-r0)\n(7/23) Installing bind-tools (9.18.10-r0)\n(8/23) Installing brotli-libs (1.0.9-r9)\n(9/23) Installing libcurl (7.87.0-r0)\n(10/23) Installing curl (7.87.0-r0)\n(11/23) Installing dumb-init (1.2.5-r2)\n(12/23) Installing libgcc (12.2.1_git20220924-r4)\n(13/23) Installing libstdc++ (12.2.1_git20220924-r4)\n(14/23) Installing binutils (2.39-r2)\n(15/23) Installing libgomp (12.2.1_git20220924-r4)\n(16/23) Installing libatomic (12.2.1_git20220924-r4)\n(17/23) Installing gmp (6.2.1-r2)\n(18/23) Installing isl25 (0.25-r0)\n(19/23) Installing mpfr4 (4.1.0-r0)\n(20/23) Installing mpc1 (1.2.1-r1)\n(21/23) Installing gcc (12.2.1_git20220924-r4)\n(22/23) Installing linux-headers (5.19.5-r0)\n(23/23) Installing musl-dev (1.2.3-r4)\nExecuting busybox-1.35.0-r29.trigger\nOK: 180 MiB in 60 packages\nRemoving intermediate container 1cef66912b06\n ---> e997ecf57a2d\nStep 13/19 : ADD . /infrabin\n ---> cf908ee68b3c\nStep 14/19 : WORKDIR /infrabin\n ---> Running in 80d41b821ee5\nRemoving intermediate container 80d41b821ee5\n ---> f77236052bc9\nStep 15/19 : RUN pip install --no-cache-dir pip pipenv -U &&     pipenv install --deploy --system --skip-lock\n ---> Running in c83f0bc35fc6\nRequirement already satisfied: pip in /usr/local/lib/python3.7/site-packages (22.0.4)\nCollecting pip\n  Downloading pip-22.3.1-py3-none-any.whl (2.1 MB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 2.1/2.1 MB 49.3 MB/s eta 0:00:00\nCollecting pipenv\n  Downloading pipenv-2022.12.19-py3-none-any.whl (2.9 MB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 2.9/2.9 MB 107.2 MB/s eta 0:00:00\nCollecting virtualenv-clone>=0.2.5\n  Downloading virtualenv_clone-0.5.7-py3-none-any.whl (6.6 kB)\nRequirement already satisfied: setuptools>=36.2.1 in /usr/local/lib/python3.7/site-packages (from pipenv) (57.5.0)\nCollecting virtualenv\n  Downloading virtualenv-20.17.1-py3-none-any.whl (8.8 MB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 8.8/8.8 MB 98.5 MB/s eta 0:00:00\nCollecting certifi\n  Downloading certifi-2022.12.7-py3-none-any.whl (155 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 155.3/155.3 KB 205.6 MB/s eta 0:00:00\nCollecting distlib<1,>=0.3.6\n  Downloading distlib-0.3.6-py2.py3-none-any.whl (468 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 468.5/468.5 KB 178.9 MB/s eta 0:00:00\nCollecting platformdirs<3,>=2.4\n  Downloading platformdirs-2.6.0-py3-none-any.whl (14 kB)\nCollecting importlib-metadata>=4.8.3\n  Downloading importlib_metadata-5.2.0-py3-none-any.whl (21 kB)\nCollecting filelock<4,>=3.4.1\n  Downloading filelock-3.8.2-py3-none-any.whl (10 kB)\nCollecting typing-extensions>=3.6.4\n  Downloading typing_extensions-4.4.0-py3-none-any.whl (26 kB)\nCollecting zipp>=0.5\n  Downloading zipp-3.11.0-py3-none-any.whl (6.6 kB)\nInstalling collected packages: distlib, zipp, virtualenv-clone, typing-extensions, platformdirs, pip, filelock, certifi, importlib-metadata, virtualenv, pipenv\n  Attempting uninstall: pip\n    Found existing installation: pip 22.0.4\n    Uninstalling pip-22.0.4:\n      Successfully uninstalled pip-22.0.4\nSuccessfully installed certifi-2022.12.7 distlib-0.3.6 filelock-3.8.2 importlib-metadata-5.2.0 pip-22.3.1 pipenv-2022.12.19 platformdirs-2.6.0 typing-extensions-4.4.0 virtualenv-20.17.1 virtualenv-clone-0.5.7 zipp-3.11.0\n\u001b[91mWARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv\n\u001b[0mInstalling dependencies from Pipfile...\nRemoving intermediate container c83f0bc35fc6\n ---> fe1c89923601\nStep 16/19 : EXPOSE ${PORT}\n ---> Running in 14a43d48a3c1\nRemoving intermediate container 14a43d48a3c1\n ---> 27f7e4fd44fd\nStep 17/19 : COPY docker-entrypoint.sh /usr/local/bin/docker-entrypoint.sh\n ---> 2c9694cf6ac9\nStep 18/19 : COPY --from=go-builder /go/src/monzo/envoy-preflight/envoy-preflight /usr/local/bin/envoy-preflight\n ---> 79ec7840ca1b\nStep 19/19 : ENTRYPOINT [\"docker-entrypoint.sh\"]\n ---> Running in 5e302ad17138\nRemoving intermediate container 5e302ad17138\n ---> 6d4d2c5215fd\nSuccessfully built 6d4d2c5215fd\nSuccessfully tagged infrabin:latest\n","stderr":"","imageSize":288110845},"endTime":1672198252115}