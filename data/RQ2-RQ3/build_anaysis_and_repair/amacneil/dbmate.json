{"repository":"https://github.com/amacneil/dbmate","dockerfilePath":"Dockerfile","startTime":1672844522699,"endTime":1672845285218,"clone":{"startTime":1672844522699,"stdout":"","stderr":"Cloning into '/tmp/dinghy-analysis/amacneil/dbmate'...\n","error":null,"endTime":1672844523729,"commit":"cd19cb4f672e0804c6ab6204287f170aea5d9b44"},"originalBuild":{"startTime":1672844523852,"endTime":1672844949091,"error":null,"stdout":"Sending build context to Docker daemon  212.5kB\r\r\nStep 1/12 : FROM golang:1.19 as dev\n ---> 6650307efe4a\nStep 2/12 : WORKDIR /src\n ---> Running in 39a83030ef7d\nRemoving intermediate container 39a83030ef7d\n ---> 672c79ba7024\nStep 3/12 : RUN apt-get update \t&& apt-get install -qq --no-install-recommends \t\tcurl \t\tfile \t\tmariadb-client \t\tpostgresql-client \t\tsqlite3 \t&& rm -rf /var/lib/apt/lists/*\n ---> Running in 5e6f2fd06e21\nGet:1 http://deb.debian.org/debian bullseye InRelease [116 kB]\nGet:2 http://deb.debian.org/debian-security bullseye-security InRelease [48.4 kB]\nGet:3 http://deb.debian.org/debian bullseye-updates InRelease [44.1 kB]\nGet:4 http://deb.debian.org/debian bullseye/main amd64 Packages [8183 kB]\nGet:5 http://deb.debian.org/debian-security bullseye-security/main amd64 Packages [210 kB]\nGet:6 http://deb.debian.org/debian bullseye-updates/main amd64 Packages [14.6 kB]\nFetched 8616 kB in 2s (5388 kB/s)\nReading package lists...\n\u001b[91mdebconf: delaying package configuration, since apt-utils is not installed\n\u001b[0mSelecting previously unselected package libmagic-mgc.\r\n(Reading database ... \r(Reading database ... 5%\r(Reading database ... 10%\r(Reading database ... 15%\r(Reading database ... 20%\r(Reading database ... 25%\r(Reading database ... 30%\r(Reading database ... 35%\r(Reading database ... 40%\r(Reading database ... 45%\r(Reading database ... 50%\r(Reading database ... 55%\r(Reading database ... 60%\r(Reading database ... 65%\r(Reading database ... 70%\r(Reading database ... 75%\r(Reading database ... 80%\r(Reading database ... 85%\r(Reading database ... 90%\r(Reading database ... 95%\r(Reading database ... 100%\r(Reading database ... 15718 files and directories currently installed.)\r\nPreparing to unpack .../00-libmagic-mgc_1%3a5.39-3_amd64.deb ...\r\nUnpacking libmagic-mgc (1:5.39-3) ...\r\nSelecting previously unselected package libmagic1:amd64.\r\nPreparing to unpack .../01-libmagic1_1%3a5.39-3_amd64.deb ...\r\nUnpacking libmagic1:amd64 (1:5.39-3) ...\r\nSelecting previously unselected package file.\r\nPreparing to unpack .../02-file_1%3a5.39-3_amd64.deb ...\r\nUnpacking file (1:5.39-3) ...\r\nSelecting previously unselected package libconfig-inifiles-perl.\r\nPreparing to unpack .../03-libconfig-inifiles-perl_3.000003-1_all.deb ...\r\nUnpacking libconfig-inifiles-perl (3.000003-1) ...\r\nSelecting previously unselected package mysql-common.\r\nPreparing to unpack .../04-mysql-common_5.8+1.0.7_all.deb ...\r\nUnpacking mysql-common (5.8+1.0.7) ...\r\nSelecting previously unselected package mariadb-common.\r\nPreparing to unpack .../05-mariadb-common_1%3a10.5.18-0+deb11u1_all.deb ...\r\nUnpacking mariadb-common (1:10.5.18-0+deb11u1) ...\r\nSelecting previously unselected package libmariadb3:amd64.\r\nPreparing to unpack .../06-libmariadb3_1%3a10.5.18-0+deb11u1_amd64.deb ...\r\nUnpacking libmariadb3:amd64 (1:10.5.18-0+deb11u1) ...\r\nSelecting previously unselected package libpq5:amd64.\r\nPreparing to unpack .../07-libpq5_13.9-0+deb11u1_amd64.deb ...\r\nUnpacking libpq5:amd64 (13.9-0+deb11u1) ...\r\nSelecting previously unselected package mariadb-client-core-10.5.\r\nPreparing to unpack .../08-mariadb-client-core-10.5_1%3a10.5.18-0+deb11u1_amd64.deb ...\r\nUnpacking mariadb-client-core-10.5 (1:10.5.18-0+deb11u1) ...\r\nSelecting previously unselected package mariadb-client-10.5.\r\nPreparing to unpack .../09-mariadb-client-10.5_1%3a10.5.18-0+deb11u1_amd64.deb ...\r\nUnpacking mariadb-client-10.5 (1:10.5.18-0+deb11u1) ...\r\nSelecting previously unselected package mariadb-client.\r\nPreparing to unpack .../10-mariadb-client_1%3a10.5.18-0+deb11u1_all.deb ...\r\nUnpacking mariadb-client (1:10.5.18-0+deb11u1) ...\r\nSelecting previously unselected package postgresql-client-common.\r\nPreparing to unpack .../11-postgresql-client-common_225_all.deb ...\r\nUnpacking postgresql-client-common (225) ...\r\nSelecting previously unselected package postgresql-client-13.\r\nPreparing to unpack .../12-postgresql-client-13_13.9-0+deb11u1_amd64.deb ...\r\nUnpacking postgresql-client-13 (13.9-0+deb11u1) ...\r\nSelecting previously unselected package postgresql-client.\r\nPreparing to unpack .../13-postgresql-client_13+225_all.deb ...\r\nUnpacking postgresql-client (13+225) ...\r\nSelecting previously unselected package sqlite3.\r\nPreparing to unpack .../14-sqlite3_3.34.1-3_amd64.deb ...\r\nUnpacking sqlite3 (3.34.1-3) ...\r\nSetting up libconfig-inifiles-perl (3.000003-1) ...\r\nSetting up postgresql-client-common (225) ...\r\nSetting up mysql-common (5.8+1.0.7) ...\r\nupdate-alternatives: using /etc/mysql/my.cnf.fallback to provide /etc/mysql/my.cnf (my.cnf) in auto mode\r\nSetting up libmagic-mgc (1:5.39-3) ...\r\nSetting up libmagic1:amd64 (1:5.39-3) ...\r\nSetting up libpq5:amd64 (13.9-0+deb11u1) ...\r\nSetting up file (1:5.39-3) ...\r\nSetting up postgresql-client-13 (13.9-0+deb11u1) ...\r\nupdate-alternatives: using /usr/share/postgresql/13/man/man1/psql.1.gz to provide /usr/share/man/man1/psql.1.gz (psql.1.gz) in auto mode\r\nSetting up mariadb-common (1:10.5.18-0+deb11u1) ...\r\nupdate-alternatives: using /etc/mysql/mariadb.cnf to provide /etc/mysql/my.cnf (my.cnf) in auto mode\r\nSetting up libmariadb3:amd64 (1:10.5.18-0+deb11u1) ...\r\nSetting up sqlite3 (3.34.1-3) ...\r\nSetting up postgresql-client (13+225) ...\r\nSetting up mariadb-client-core-10.5 (1:10.5.18-0+deb11u1) ...\r\nSetting up mariadb-client-10.5 (1:10.5.18-0+deb11u1) ...\r\nSetting up mariadb-client (1:10.5.18-0+deb11u1) ...\r\nProcessing triggers for libc-bin (2.31-13+deb11u5) ...\r\nRemoving intermediate container 5e6f2fd06e21\n ---> 006698ef85a2\nStep 4/12 : RUN curl -fsSL https://raw.githubusercontent.com/golangci/golangci-lint/master/install.sh \t| sh -s -- -b /usr/local/bin v1.50.1\n ---> Running in c9f423a9a6f8\n\u001b[91mgolangci/golangci-lint info checking GitHub for tag 'v1.50.1'\n\u001b[0m\u001b[91mgolangci/golangci-lint info found version: 1.50.1 for v1.50.1/linux/amd64\n\u001b[0m\u001b[91mgolangci/golangci-lint info installed /usr/local/bin/golangci-lint\n\u001b[0mRemoving intermediate container c9f423a9a6f8\n ---> 78e2b00d480f\nStep 5/12 : COPY go.* /src/\n ---> bd7d82baa203\nStep 6/12 : RUN go mod download\n ---> Running in c3e18aba7fc2\nRemoving intermediate container c3e18aba7fc2\n ---> 3c4411ab42f0\nStep 7/12 : COPY . /src/\n ---> aa74585fa4f4\nStep 8/12 : RUN make build\n ---> Running in 204db98dab24\nrm -rf dist\ngo build -o dist/dbmate -tags netgo,osusergo,sqlite_omit_load_extension,sqlite_json  -ldflags '-s -extldflags \"-static\"' .\nRemoving intermediate container 204db98dab24\n ---> d79b2847c62b\nStep 9/12 : FROM alpine as release\n ---> 49176f190c7e\nStep 10/12 : RUN apk add --no-cache \tmariadb-client \tmariadb-connector-c \tpostgresql-client \tsqlite \ttzdata\n ---> Running in 71e1ce6394a7\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/community/x86_64/APKINDEX.tar.gz\n(1/15) Installing mariadb-common (10.6.11-r0)\n(2/15) Installing libgcc (12.2.1_git20220924-r4)\n(3/15) Installing ncurses-terminfo-base (6.3_p20221119-r0)\n(4/15) Installing ncurses-libs (6.3_p20221119-r0)\n(5/15) Installing libstdc++ (12.2.1_git20220924-r4)\n(6/15) Installing mariadb-client (10.6.11-r0)\n(7/15) Installing mariadb-connector-c (3.3.3-r0)\n(8/15) Installing postgresql-common (1.1-r2)\nExecuting postgresql-common-1.1-r2.pre-install\n(9/15) Installing lz4-libs (1.9.4-r1)\n(10/15) Installing libpq (15.1-r0)\n(11/15) Installing readline (8.2.0-r0)\n(12/15) Installing zstd-libs (1.5.2-r9)\n(13/15) Installing postgresql15-client (15.1-r0)\n(14/15) Installing sqlite (3.40.1-r0)\n(15/15) Installing tzdata (2022f-r1)\nExecuting busybox-1.35.0-r29.trigger\nExecuting postgresql-common-1.1-r2.trigger\n\u001b[91m* Setting postgresql15 as the default version\n\u001b[0m\u001b[91mWARNING: Ignoring https://dl-cdn.alpinelinux.org/alpine/v3.17/main: No such file or directory\nWARNING: Ignoring https://dl-cdn.alpinelinux.org/alpine/v3.17/community: No such file or directory\n\u001b[0m\u001b[91msh: out of range\n\u001b[0mOK: 50 MiB in 30 packages\nRemoving intermediate container 71e1ce6394a7\n ---> 1fedb74be7a2\nStep 11/12 : COPY --from=dev /src/dist/dbmate /usr/local/bin/dbmate\n ---> 750cbf44ede8\nStep 12/12 : ENTRYPOINT [\"/usr/local/bin/dbmate\"]\n ---> Running in 2d7d8b9a4247\nRemoving intermediate container 2d7d8b9a4247\n ---> 43c01a9867c3\nSuccessfully built 43c01a9867c3\nSuccessfully tagged dbmate:latest\n","stderr":"","imageSize":58307347},"repair":{"startTime":1672844949146,"endTime":1672844949255,"violations":[{"name":"ruleAptGetInstallUseY","position":{"start":6,"end":11,"columnStart":4,"columnEnd":9}}],"repairedDockerfile":"# development image\nFROM golang:1.19 as dev\nWORKDIR /src\n\n# install database clients\nRUN apt-get update \\\n\t&& apt-get install -y -qq --no-install-recommends \\\n\t\tcurl \\\n\t\tfile \\\n\t\tmariadb-client \\\n\t\tpostgresql-client \\\n\t\tsqlite3 \\\n\t&& rm -rf /var/lib/apt/lists/*\n\n# golangci-lint\nRUN curl -fsSL https://raw.githubusercontent.com/golangci/golangci-lint/master/install.sh \\\n\t| sh -s -- -b /usr/local/bin v1.50.1\n\n# download modules\nCOPY go.* /src/\nRUN go mod download\nCOPY . /src/\nRUN make build\n\n# release stage\nFROM alpine as release\nRUN apk add --no-cache \\\n\tmariadb-client \\\n\tmariadb-connector-c \\\n\tpostgresql-client \\\n\tsqlite \\\n\ttzdata\nCOPY --from=dev /src/dist/dbmate /usr/local/bin/dbmate\nENTRYPOINT [\"/usr/local/bin/dbmate\"]\n"},"repairedBuild":{"startTime":1672844958068,"endTime":1672845284960,"error":null,"stdout":"Sending build context to Docker daemon  212.5kB\r\r\nStep 1/12 : FROM golang:1.19 as dev\n ---> 6650307efe4a\nStep 2/12 : WORKDIR /src\n ---> Running in a13b773618e2\nRemoving intermediate container a13b773618e2\n ---> 515fbc7625e8\nStep 3/12 : RUN apt-get update \t&& apt-get install -y -qq --no-install-recommends \t\tcurl \t\tfile \t\tmariadb-client \t\tpostgresql-client \t\tsqlite3 \t&& rm -rf /var/lib/apt/lists/*\n ---> Running in e2a8d1d1fd3b\nGet:1 http://deb.debian.org/debian bullseye InRelease [116 kB]\nGet:2 http://deb.debian.org/debian-security bullseye-security InRelease [48.4 kB]\nGet:3 http://deb.debian.org/debian bullseye-updates InRelease [44.1 kB]\nGet:4 http://deb.debian.org/debian bullseye/main amd64 Packages [8183 kB]\nGet:5 http://deb.debian.org/debian-security bullseye-security/main amd64 Packages [210 kB]\nGet:6 http://deb.debian.org/debian bullseye-updates/main amd64 Packages [14.6 kB]\nFetched 8616 kB in 2s (4123 kB/s)\nReading package lists...\n\u001b[91mdebconf: delaying package configuration, since apt-utils is not installed\n\u001b[0mSelecting previously unselected package libmagic-mgc.\r\n(Reading database ... \r(Reading database ... 5%\r(Reading database ... 10%\r(Reading database ... 15%\r(Reading database ... 20%\r(Reading database ... 25%\r(Reading database ... 30%\r(Reading database ... 35%\r(Reading database ... 40%\r(Reading database ... 45%\r(Reading database ... 50%\r(Reading database ... 55%\r(Reading database ... 60%\r(Reading database ... 65%\r(Reading database ... 70%\r(Reading database ... 75%\r(Reading database ... 80%\r(Reading database ... 85%\r(Reading database ... 90%\r(Reading database ... 95%\r(Reading database ... 100%\r(Reading database ... 15718 files and directories currently installed.)\r\nPreparing to unpack .../00-libmagic-mgc_1%3a5.39-3_amd64.deb ...\r\nUnpacking libmagic-mgc (1:5.39-3) ...\r\nSelecting previously unselected package libmagic1:amd64.\r\nPreparing to unpack .../01-libmagic1_1%3a5.39-3_amd64.deb ...\r\nUnpacking libmagic1:amd64 (1:5.39-3) ...\r\nSelecting previously unselected package file.\r\nPreparing to unpack .../02-file_1%3a5.39-3_amd64.deb ...\r\nUnpacking file (1:5.39-3) ...\r\nSelecting previously unselected package libconfig-inifiles-perl.\r\nPreparing to unpack .../03-libconfig-inifiles-perl_3.000003-1_all.deb ...\r\nUnpacking libconfig-inifiles-perl (3.000003-1) ...\r\nSelecting previously unselected package mysql-common.\r\nPreparing to unpack .../04-mysql-common_5.8+1.0.7_all.deb ...\r\nUnpacking mysql-common (5.8+1.0.7) ...\r\nSelecting previously unselected package mariadb-common.\r\nPreparing to unpack .../05-mariadb-common_1%3a10.5.18-0+deb11u1_all.deb ...\r\nUnpacking mariadb-common (1:10.5.18-0+deb11u1) ...\r\nSelecting previously unselected package libmariadb3:amd64.\r\nPreparing to unpack .../06-libmariadb3_1%3a10.5.18-0+deb11u1_amd64.deb ...\r\nUnpacking libmariadb3:amd64 (1:10.5.18-0+deb11u1) ...\r\nSelecting previously unselected package libpq5:amd64.\r\nPreparing to unpack .../07-libpq5_13.9-0+deb11u1_amd64.deb ...\r\nUnpacking libpq5:amd64 (13.9-0+deb11u1) ...\r\nSelecting previously unselected package mariadb-client-core-10.5.\r\nPreparing to unpack .../08-mariadb-client-core-10.5_1%3a10.5.18-0+deb11u1_amd64.deb ...\r\nUnpacking mariadb-client-core-10.5 (1:10.5.18-0+deb11u1) ...\r\nSelecting previously unselected package mariadb-client-10.5.\r\nPreparing to unpack .../09-mariadb-client-10.5_1%3a10.5.18-0+deb11u1_amd64.deb ...\r\nUnpacking mariadb-client-10.5 (1:10.5.18-0+deb11u1) ...\r\nSelecting previously unselected package mariadb-client.\r\nPreparing to unpack .../10-mariadb-client_1%3a10.5.18-0+deb11u1_all.deb ...\r\nUnpacking mariadb-client (1:10.5.18-0+deb11u1) ...\r\nSelecting previously unselected package postgresql-client-common.\r\nPreparing to unpack .../11-postgresql-client-common_225_all.deb ...\r\nUnpacking postgresql-client-common (225) ...\r\nSelecting previously unselected package postgresql-client-13.\r\nPreparing to unpack .../12-postgresql-client-13_13.9-0+deb11u1_amd64.deb ...\r\nUnpacking postgresql-client-13 (13.9-0+deb11u1) ...\r\nSelecting previously unselected package postgresql-client.\r\nPreparing to unpack .../13-postgresql-client_13+225_all.deb ...\r\nUnpacking postgresql-client (13+225) ...\r\nSelecting previously unselected package sqlite3.\r\nPreparing to unpack .../14-sqlite3_3.34.1-3_amd64.deb ...\r\nUnpacking sqlite3 (3.34.1-3) ...\r\nSetting up libconfig-inifiles-perl (3.000003-1) ...\r\nSetting up postgresql-client-common (225) ...\r\nSetting up mysql-common (5.8+1.0.7) ...\r\nupdate-alternatives: using /etc/mysql/my.cnf.fallback to provide /etc/mysql/my.cnf (my.cnf) in auto mode\r\nSetting up libmagic-mgc (1:5.39-3) ...\r\nSetting up libmagic1:amd64 (1:5.39-3) ...\r\nSetting up libpq5:amd64 (13.9-0+deb11u1) ...\r\nSetting up file (1:5.39-3) ...\r\nSetting up postgresql-client-13 (13.9-0+deb11u1) ...\r\nupdate-alternatives: using /usr/share/postgresql/13/man/man1/psql.1.gz to provide /usr/share/man/man1/psql.1.gz (psql.1.gz) in auto mode\r\nSetting up mariadb-common (1:10.5.18-0+deb11u1) ...\r\nupdate-alternatives: using /etc/mysql/mariadb.cnf to provide /etc/mysql/my.cnf (my.cnf) in auto mode\r\nSetting up libmariadb3:amd64 (1:10.5.18-0+deb11u1) ...\r\nSetting up sqlite3 (3.34.1-3) ...\r\nSetting up postgresql-client (13+225) ...\r\nSetting up mariadb-client-core-10.5 (1:10.5.18-0+deb11u1) ...\r\nSetting up mariadb-client-10.5 (1:10.5.18-0+deb11u1) ...\r\nSetting up mariadb-client (1:10.5.18-0+deb11u1) ...\r\nProcessing triggers for libc-bin (2.31-13+deb11u5) ...\r\nRemoving intermediate container e2a8d1d1fd3b\n ---> 2fde9b7153b7\nStep 4/12 : RUN curl -fsSL https://raw.githubusercontent.com/golangci/golangci-lint/master/install.sh \t| sh -s -- -b /usr/local/bin v1.50.1\n ---> Running in 4c38740f2eb8\n\u001b[91mgolangci/golangci-lint info checking GitHub for tag 'v1.50.1'\n\u001b[0m\u001b[91mgolangci/golangci-lint info found version: 1.50.1 for v1.50.1/linux/amd64\n\u001b[0m\u001b[91mgolangci/golangci-lint info installed /usr/local/bin/golangci-lint\n\u001b[0mRemoving intermediate container 4c38740f2eb8\n ---> 99ed3e3c73f4\nStep 5/12 : COPY go.* /src/\n ---> 0151f1048c2d\nStep 6/12 : RUN go mod download\n ---> Running in 4549d7ac397e\nRemoving intermediate container 4549d7ac397e\n ---> 9682a4d37940\nStep 7/12 : COPY . /src/\n ---> 86bfa5f15da5\nStep 8/12 : RUN make build\n ---> Running in e2d2c98b8e8e\nrm -rf dist\ngo build -o dist/dbmate -tags netgo,osusergo,sqlite_omit_load_extension,sqlite_json  -ldflags '-s -extldflags \"-static\"' .\nRemoving intermediate container e2d2c98b8e8e\n ---> d33b626bd7cd\nStep 9/12 : FROM alpine as release\nlatest: Pulling from library/alpine\nc158987b0551: Already exists\nDigest: sha256:8914eb54f968791faf6a8638949e480fef81e697984fba772b3976835194c6d4\nStatus: Downloaded newer image for alpine:latest\n ---> 49176f190c7e\nStep 10/12 : RUN apk add --no-cache \tmariadb-client \tmariadb-connector-c \tpostgresql-client \tsqlite \ttzdata\n ---> Running in 1bf71670ff95\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/community/x86_64/APKINDEX.tar.gz\n(1/15) Installing mariadb-common (10.6.11-r0)\n(2/15) Installing libgcc (12.2.1_git20220924-r4)\n(3/15) Installing ncurses-terminfo-base (6.3_p20221119-r0)\n(4/15) Installing ncurses-libs (6.3_p20221119-r0)\n(5/15) Installing libstdc++ (12.2.1_git20220924-r4)\n(6/15) Installing mariadb-client (10.6.11-r0)\n(7/15) Installing mariadb-connector-c (3.3.3-r0)\n(8/15) Installing postgresql-common (1.1-r2)\nExecuting postgresql-common-1.1-r2.pre-install\n(9/15) Installing lz4-libs (1.9.4-r1)\n(10/15) Installing libpq (15.1-r0)\n(11/15) Installing readline (8.2.0-r0)\n(12/15) Installing zstd-libs (1.5.2-r9)\n(13/15) Installing postgresql15-client (15.1-r0)\n(14/15) Installing sqlite (3.40.1-r0)\n(15/15) Installing tzdata (2022f-r1)\nExecuting busybox-1.35.0-r29.trigger\nExecuting postgresql-common-1.1-r2.trigger\n\u001b[91m* Setting postgresql15 as the default version\n\u001b[0m\u001b[91mWARNING: Ignoring https://dl-cdn.alpinelinux.org/alpine/v3.17/main: No such file or directory\nWARNING: Ignoring https://dl-cdn.alpinelinux.org/alpine/v3.17/community: No such file or directory\n\u001b[0m\u001b[91msh: out of range\n\u001b[0mOK: 50 MiB in 30 packages\nRemoving intermediate container 1bf71670ff95\n ---> 5789542a32de\nStep 11/12 : COPY --from=dev /src/dist/dbmate /usr/local/bin/dbmate\n ---> a03192060076\nStep 12/12 : ENTRYPOINT [\"/usr/local/bin/dbmate\"]\n ---> Running in b62aba9d0e67\nRemoving intermediate container b62aba9d0e67\n ---> 054e807a18b8\nSuccessfully built 054e807a18b8\nSuccessfully tagged dbmate:latest\n","stderr":"","imageSize":58307347}}