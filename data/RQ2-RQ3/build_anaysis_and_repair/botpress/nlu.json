{"repository":"https://github.com/botpress/nlu","dockerfilePath":"Dockerfile","startTime":1672546516897,"clone":{"stdout":"","stderr":"Cloning into '/tmp/dinghy-analysis/botpress/nlu'...\n","error":null,"commit":"d55a2fb9269f925491b7d64b3500044ebef80ac0"},"originalBuild":{"startTimestamp":1672546520662,"endTimestamp":1672546793695,"error":null,"stdout":"Sending build context to Docker daemon  91.84MB\r\r\nStep 1/7 : FROM node:12.13.1\n12.13.1: Pulling from library/node\n844c33c7e6ea: Pulling fs layer\nada5d61ae65d: Pulling fs layer\nf8427fdf4292: Pulling fs layer\nf025bafc4ab8: Pulling fs layer\n7a9577c07934: Pulling fs layer\n9b4289f800f5: Pulling fs layer\n55e3fcab47b9: Pulling fs layer\nc7a94e331913: Pulling fs layer\nbb9efc0c132a: Pulling fs layer\nf025bafc4ab8: Waiting\n7a9577c07934: Waiting\n9b4289f800f5: Waiting\n55e3fcab47b9: Waiting\nc7a94e331913: Waiting\nbb9efc0c132a: Waiting\nf8427fdf4292: Verifying Checksum\nf8427fdf4292: Download complete\nada5d61ae65d: Verifying Checksum\nada5d61ae65d: Download complete\nf025bafc4ab8: Verifying Checksum\nf025bafc4ab8: Download complete\n844c33c7e6ea: Verifying Checksum\n844c33c7e6ea: Download complete\n9b4289f800f5: Verifying Checksum\n9b4289f800f5: Download complete\nc7a94e331913: Verifying Checksum\nc7a94e331913: Download complete\nbb9efc0c132a: Verifying Checksum\nbb9efc0c132a: Download complete\n7a9577c07934: Verifying Checksum\n7a9577c07934: Download complete\n844c33c7e6ea: Pull complete\nada5d61ae65d: Pull complete\n55e3fcab47b9: Verifying Checksum\n55e3fcab47b9: Download complete\nf8427fdf4292: Pull complete\nf025bafc4ab8: Pull complete\n7a9577c07934: Pull complete\n9b4289f800f5: Pull complete\n55e3fcab47b9: Pull complete\nc7a94e331913: Pull complete\nbb9efc0c132a: Pull complete\nDigest: sha256:88ee7d2a5e18d359b4b5750ecb50a9b238ab467397c306aeb9955f4f11be44ce\nStatus: Downloaded newer image for node:12.13.1\n ---> 7be6a8478f5f\nStep 2/7 : ADD . /nlu\n ---> a0b157aa1717\nStep 3/7 : WORKDIR /nlu\n ---> Running in c0b47d8c10a2\nRemoving intermediate container c0b47d8c10a2\n ---> a8ff51ea16c4\nStep 4/7 : RUN apt update && \tapt install -y wget ca-certificates\n ---> Running in 0534eec86475\n\u001b[91m\nWARNING: apt \u001b[0m\u001b[91mdoes not have a stable CLI interface. Use with caution in scripts.\n\n\u001b[0mIgn:1 http://deb.debian.org/debian stretch InRelease\nGet:2 http://security.debian.org/debian-security stretch/updates InRelease [59.1 kB]\nGet:3 http://deb.debian.org/debian stretch-updates InRelease [93.6 kB]\nGet:4 http://deb.debian.org/debian stretch Release [118 kB]\nGet:5 http://deb.debian.org/debian stretch Release.gpg [3177 B]\nGet:6 http://security.debian.org/debian-security stretch/updates/main amd64 Packages [782 kB]\nGet:7 http://deb.debian.org/debian stretch/main amd64 Packages [7080 kB]\nFetched 8135 kB in 1s (4960 kB/s)\nReading package lists...\nBuilding dependency tree...\nReading state information...\n162 packages can be upgraded. Run 'apt list --upgradable' to see them.\n\u001b[91m\nWARNING: apt does not have a stable CLI interface. Use with caution in scripts.\n\n\u001b[0mReading package lists...\nBuilding dependency tree...\nReading state information...\nwget is already the newest version (1.18-5+deb9u3).\nThe following packages will be upgraded:\n  ca-certificates\n1 upgraded, 0 newly installed, 0 to remove and 161 not upgraded.\nNeed to get 168 kB of archives.\nAfter this operation, 33.8 kB disk space will be freed.\nGet:1 http://security.debian.org/debian-security stretch/updates/main amd64 ca-certificates all 20200601~deb9u2 [168 kB]\n\u001b[91mdebconf: delaying package configuration, since apt-utils is not installed\n\u001b[0mFetched 168 kB in 0s (15.1 MB/s)\n(Reading database ... \r(Reading database ... 5%\r(Reading database ... 10%\r(Reading database ... 15%\r(Reading database ... 20%\r(Reading database ... 25%\r(Reading database ... 30%\r(Reading database ... 35%\r(Reading database ... 40%\r(Reading database ... 45%\r(Reading database ... 50%\r(Reading database ... 55%\r(Reading database ... 60%\r(Reading database ... 65%\r(Reading database ... 70%\r(Reading database ... 75%\r(Reading database ... 80%\r(Reading database ... 85%\r(Reading database ... 90%\r(Reading database ... 95%\r(Reading database ... 100%\r(Reading database ... 29962 files and directories currently installed.)\r\nPreparing to unpack .../ca-certificates_20200601~deb9u2_all.deb ...\r\nUnpacking ca-certificates (20200601~deb9u2) over (20161130+nmu1+deb9u1) ...\r\nSetting up ca-certificates (20200601~deb9u2) ...\r\ndebconf: unable to initialize frontend: Dialog\r\ndebconf: (TERM is not set, so the dialog frontend is not usable.)\r\ndebconf: falling back to frontend: Readline\r\nUpdating certificates in /etc/ssl/certs...\r\n15 added, 29 removed; done.\r\nProcessing triggers for ca-certificates (20200601~deb9u2) ...\r\nUpdating certificates in /etc/ssl/certs...\r\n0 added, 0 removed; done.\r\nRunning hooks in /etc/ca-certificates/update.d...\r\ndone.\r\nRemoving intermediate container 0534eec86475\n ---> b25a7570298a\nStep 5/7 : RUN yarn\n ---> Running in b13f4c2e6236\nyarn install v1.19.1\n[1/4] Resolving packages...\n[2/4] Fetching packages...\ninfo fsevents@1.2.7: The platform \"linux\" is incompatible with this module.\ninfo \"fsevents@1.2.7\" is an optional dependency and failed compatibility check. Excluding it from installation.\ninfo fsevents@2.3.2: The platform \"linux\" is incompatible with this module.\ninfo \"fsevents@2.3.2\" is an optional dependency and failed compatibility check. Excluding it from installation.\n[3/4] Linking dependencies...\n\u001b[91mwarning \" > ts-node@10.4.0\" has unmet peer dependency \"@types/node@*\".\nwarning \" > ts-node@10.4.0\" has unmet peer dependency \"typescript@>=2.7\".\nwarning \" > ts-node-dev@1.1.8\" has unmet peer dependency \"typescript@*\".\n\u001b[0m\u001b[91mwarning \"ts-node-dev > ts-node@9.1.1\" has unmet peer dependency \"typescript@>=2.7\".\n\u001b[0m\u001b[91mwarning \"workspace-aggregator-6844f15a-96a6-4b63-9161-9ab133128151 > @botpress/lang-server > ts-jest@26.5.5\" has incorrect peer dependency \"jest@>=26 <27\".\n\u001b[0m[4/4] Building fresh packages...\n$ yarn cmd config\nyarn run v1.19.1\n$ yarn run gulp config\n$ /nlu/node_modules/.bin/gulp config\n[04:17:36] Using gulpfile /nlu/gulpfile.js\n[04:17:36] Starting 'config'...\n[04:17:36] Finished 'config' after 1.26 ms\nDone in 5.00s.\nDone in 55.19s.\nRemoving intermediate container b13f4c2e6236\n ---> a71182cc58f5\nStep 6/7 : RUN yarn build\n ---> Running in 3e07b0ec8eeb\nyarn run v1.19.1\n$ tsc --build\n$ yarn workspace @botpress/nlu-server postbuild\n$ cross-env node ./scripts/buildinfo.js ./.buildinfo.json\n\u001b[91mCouldn't get active branch Error: Command failed: git rev-parse --abbrev-ref HEAD\nfatal: Not a git repository (or any of the parent directories): .git\n\n    at ChildProcess.exithandler (child_process.js:295:12)\n    at ChildProcess.emit (events.js:210:5)\n    at maybeClose (internal/child_process.js:1021:16)\n    at Socket.<anonymous> (internal/child_process.js:430:11)\n    at Socket.emit (events.js:210:5)\n    at Pipe.<anonymous> (net.js:659:12) {\n  killed: false,\n  code: 128,\n  signal: null,\n  cmd: 'git rev-parse --abbrev-ref HEAD'\n}\n\u001b[0mDone in 15.63s.\nRemoving intermediate container 3e07b0ec8eeb\n ---> 3d49364f75b7\nStep 7/7 : ENTRYPOINT [\"yarn\", \"start\"]\n ---> Running in 943cf6a091b6\nRemoving intermediate container 943cf6a091b6\n ---> 6a738f6bdcf4\nSuccessfully built 6a738f6bdcf4\nSuccessfully tagged nlu:latest\n","stderr":"","imageSize":1549107913},"repair":{"violations":[{"name":"ruleAptGetInstallUseNoRec","position":{"start":7,"end":7,"columnStart":1,"columnEnd":36}},{"name":"ruleAptGetInstallThenRemoveAptLists","position":{"start":7,"end":7,"columnStart":1,"columnEnd":36}}],"repairedDockerfile":"FROM node:12.13.1\n\nADD . /nlu\n\nWORKDIR /nlu\n\nRUN apt update && \\\n\tapt install --no-install-recommends -y wget ca-certificates\n\nRUN yarn\n\nRUN yarn build\n\nENTRYPOINT [\"yarn\", \"start\"]\n"},"repairedBuild":{"startTimestamp":1672546795981,"endTimestamp":1672546970482,"error":null,"stdout":"Sending build context to Docker daemon  91.84MB\r\r\nStep 1/7 : FROM node:12.13.1\n ---> 7be6a8478f5f\nStep 2/7 : ADD . /nlu\n ---> a53a90ec3590\nStep 3/7 : WORKDIR /nlu\n ---> Running in 7718f2087fc8\nRemoving intermediate container 7718f2087fc8\n ---> 085f68d81108\nStep 4/7 : RUN apt update && \tapt install --no-install-recommends -y wget ca-certificates\n ---> Running in 790938f069d7\n\u001b[91m\nWARNING: apt does not have a stable CLI interface. Use with caution in scripts.\n\n\u001b[0mIgn:1 http://deb.debian.org/debian stretch InRelease\nGet:2 http://security.debian.org/debian-security stretch/updates InRelease [59.1 kB]\nGet:3 http://deb.debian.org/debian stretch-updates InRelease [93.6 kB]\nGet:4 http://deb.debian.org/debian stretch Release [118 kB]\nGet:5 http://deb.debian.org/debian stretch Release.gpg [3177 B]\nGet:6 http://security.debian.org/debian-security stretch/updates/main amd64 Packages [782 kB]\nGet:7 http://deb.debian.org/debian stretch/main amd64 Packages [7080 kB]\nFetched 8135 kB in 1s (4844 kB/s)\nReading package lists...\nBuilding dependency tree...\nReading state information...\n162 packages can be upgraded. Run 'apt list --upgradable' to see them.\n\u001b[91m\nWARNING: apt does not have a stable CLI interface. Use with caution in scripts.\n\n\u001b[0mReading package lists...\nBuilding dependency tree...\nReading state information...\nwget is already the newest version (1.18-5+deb9u3).\nThe following packages will be upgraded:\n  ca-certificates\n1 upgraded, 0 newly installed, 0 to remove and 161 not upgraded.\nNeed to get 168 kB of archives.\nAfter this operation, 33.8 kB disk space will be freed.\nGet:1 http://security.debian.org/debian-security stretch/updates/main amd64 ca-certificates all 20200601~deb9u2 [168 kB]\n\u001b[91mdebconf: delaying package configuration, since apt-utils is not installed\n\u001b[0mFetched 168 kB in 0s (14.5 MB/s)\n(Reading database ... \r(Reading database ... 5%\r(Reading database ... 10%\r(Reading database ... 15%\r(Reading database ... 20%\r(Reading database ... 25%\r(Reading database ... 30%\r(Reading database ... 35%\r(Reading database ... 40%\r(Reading database ... 45%\r(Reading database ... 50%\r(Reading database ... 55%\r(Reading database ... 60%\r(Reading database ... 65%\r(Reading database ... 70%\r(Reading database ... 75%\r(Reading database ... 80%\r(Reading database ... 85%\r(Reading database ... 90%\r(Reading database ... 95%\r(Reading database ... 100%\r(Reading database ... 29962 files and directories currently installed.)\r\nPreparing to unpack .../ca-certificates_20200601~deb9u2_all.deb ...\r\nUnpacking ca-certificates (20200601~deb9u2) over (20161130+nmu1+deb9u1) ...\r\nSetting up ca-certificates (20200601~deb9u2) ...\r\ndebconf: unable to initialize frontend: Dialog\r\ndebconf: (TERM is not set, so the dialog frontend is not usable.)\r\ndebconf: falling back to frontend: Readline\r\nUpdating certificates in /etc/ssl/certs...\r\n15 added, 29 removed; done.\r\nProcessing triggers for ca-certificates (20200601~deb9u2) ...\r\nUpdating certificates in /etc/ssl/certs...\r\n0 added, 0 removed; done.\r\nRunning hooks in /etc/ca-certificates/update.d...\r\ndone.\r\nRemoving intermediate container 790938f069d7\n ---> 19c02994741f\nStep 5/7 : RUN yarn\n ---> Running in 13d2ab8704ab\nyarn install v1.19.1\n[1/4] Resolving packages...\n[2/4] Fetching packages...\ninfo fsevents@1.2.7: The platform \"linux\" is incompatible with this module.\ninfo \"fsevents@1.2.7\" is an optional dependency and failed compatibility check. Excluding it from installation.\ninfo fsevents@2.3.2: The platform \"linux\" is incompatible with this module.\ninfo \"fsevents@2.3.2\" is an optional dependency and failed compatibility check. Excluding it from installation.\n[3/4] Linking dependencies...\n\u001b[91mwarning \" > ts-node@10.4.0\" has unmet peer dependency \"@types/node@*\".\nwarning \" > ts-node@10.4.0\" has unmet peer dependency \"typescript@>=2.7\".\nwarning \" > ts-node-dev@1.1.8\" has unmet peer dependency \"typescript@*\".\nwarning \"ts-node-dev > ts-node@9.1.1\" has unmet peer dependency \"typescript@>=2.7\".\n\u001b[0m\u001b[91mwarning \"workspace-aggregator-afd27150-7cf8-4fcc-9ad2-63df5a0d3148 > @botpress/lang-server > ts-jest@26.5.5\" has incorrect peer dependency \"jest@>=26 <27\".\n\u001b[0m[4/4] Building fresh packages...\n$ yarn cmd config\nyarn run v1.19.1\n$ yarn run gulp config\n$ /nlu/node_modules/.bin/gulp config\n[04:21:47] Using gulpfile /nlu/gulpfile.js\n[04:21:47] Starting 'config'...\n[04:21:47] Finished 'config' after 1.2 ms\nDone in 4.81s.\nDone in 35.51s.\nRemoving intermediate container 13d2ab8704ab\n ---> 6304fe8a619d\nStep 6/7 : RUN yarn build\n ---> Running in d880985b94f0\nyarn run v1.19.1\n$ tsc --build\n$ yarn workspace @botpress/nlu-server postbuild\n$ cross-env node ./scripts/buildinfo.js ./.buildinfo.json\n\u001b[91mCouldn't get active branch Error: Command failed: git rev-parse --abbrev-ref HEAD\nfatal: Not a git repository (or any of the parent directories): .git\n\n    at ChildProcess.exithandler (child_process.js:295:12)\n    at ChildProcess.emit (events.js:210:5)\n    at maybeClose (internal/child_process.js:1021:16)\n    at Socket.<anonymous> (internal/child_process.js:430:11)\n    at Socket.emit (events.js:210:5)\n    at Pipe.<anonymous> (net.js:659:12) {\n  killed: false,\n  code: 128,\n  signal: null,\n  cmd: 'git rev-parse --abbrev-ref HEAD'\n}\n\u001b[0mDone in 15.55s.\nRemoving intermediate container d880985b94f0\n ---> af6d6d5ddb42\nStep 7/7 : ENTRYPOINT [\"yarn\", \"start\"]\n ---> Running in 7bd0e0dc7671\nRemoving intermediate container 7bd0e0dc7671\n ---> 314377102878\nSuccessfully built 314377102878\nSuccessfully tagged nlu:latest\n","stderr":"","imageSize":1549107929},"endTime":1672546981498}