{"repository":"https://github.com/masb0ymas/expresso","dockerfilePath":"Dockerfile","startTime":1672267385479,"clone":{"stdout":"","stderr":"Cloning into '/tmp/dinghy-analysis/masb0ymas/expresso'...\n","error":null,"commit":"d8a6fa1886a21c4588635343350c10ea4ec55087"},"originalBuild":{"startTimestamp":1672267387275,"endTimestamp":1672268909768,"error":null,"stdout":"Sending build context to Docker daemon  1.195MB\r\r\nStep 1/44 : FROM node:16.18-alpine as deps\n16.18-alpine: Pulling from library/node\nc158987b0551: Already exists\n68554efeeace: Pulling fs layer\nc999b5bed5bf: Pulling fs layer\ncbc47022ee33: Pulling fs layer\ncbc47022ee33: Download complete\nc999b5bed5bf: Verifying Checksum\nc999b5bed5bf: Download complete\n68554efeeace: Verifying Checksum\n68554efeeace: Download complete\n68554efeeace: Pull complete\nc999b5bed5bf: Pull complete\ncbc47022ee33: Pull complete\nDigest: sha256:b66869a9dc6bfeed416395c2a2f717bd1779af1cef828fe7941af3a8d0837fdc\nStatus: Downloaded newer image for node:16.18-alpine\n ---> bb97fd22e6f8\nStep 2/44 : LABEL author=\"masb0ymas\"\n ---> Running in bc5be810d8a4\nRemoving intermediate container bc5be810d8a4\n ---> 9ebe5ddf291b\nStep 3/44 : LABEL name=\"expresso\"\n ---> Running in 571fca7976ce\nRemoving intermediate container 571fca7976ce\n ---> fa3517608db5\nStep 4/44 : RUN apk add --no-cache libc6-compat\n ---> Running in 4658b945dc3c\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/community/x86_64/APKINDEX.tar.gz\n(1/1) Installing libc6-compat (1.2.3-r4)\nOK: 10 MiB in 18 packages\nRemoving intermediate container 4658b945dc3c\n ---> b3ccfbcc7d4c\nStep 5/44 : RUN apk add --update --no-cache curl py-pip\n ---> Running in 424f38267982\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/community/x86_64/APKINDEX.tar.gz\n(1/22) Installing ca-certificates (20220614-r3)\n(2/22) Installing brotli-libs (1.0.9-r9)\n(3/22) Installing nghttp2-libs (1.51.0-r0)\n(4/22) Installing libcurl (7.87.0-r0)\n(5/22) Installing curl (7.87.0-r0)\n(6/22) Installing libbz2 (1.0.8-r4)\n(7/22) Installing libexpat (2.5.0-r0)\n(8/22) Installing libffi (3.4.4-r0)\n(9/22) Installing gdbm (1.23-r0)\n(10/22) Installing xz-libs (5.2.9-r0)\n(11/22) Installing mpdecimal (2.5.1-r1)\n(12/22) Installing ncurses-terminfo-base (6.3_p20221119-r0)\n(13/22) Installing ncurses-libs (6.3_p20221119-r0)\n(14/22) Installing readline (8.2.0-r0)\n(15/22) Installing sqlite-libs (3.40.0-r0)\n(16/22) Installing python3 (3.10.9-r1)\n(17/22) Installing py3-six (1.16.0-r3)\n(18/22) Installing py3-retrying (1.3.3-r3)\n(19/22) Installing py3-parsing (3.0.9-r0)\n(20/22) Installing py3-packaging (21.3-r2)\n(21/22) Installing py3-setuptools (65.6.0-r0)\n(22/22) Installing py3-pip (22.3.1-r1)\nExecuting busybox-1.35.0-r29.trigger\nExecuting ca-certificates-20220614-r3.trigger\nOK: 84 MiB in 40 packages\nRemoving intermediate container 424f38267982\n ---> 8fd801b6c51b\nStep 6/44 : RUN apk add --no-cache make python3 g++ gcc libgcc libstdc++\n ---> Running in be6d3e540ab5\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/community/x86_64/APKINDEX.tar.gz\n(1/13) Installing libstdc++-dev (12.2.1_git20220924-r4)\n(2/13) Installing binutils (2.39-r2)\n(3/13) Installing libgomp (12.2.1_git20220924-r4)\n(4/13) Installing libatomic (12.2.1_git20220924-r4)\n(5/13) Installing gmp (6.2.1-r2)\n(6/13) Installing isl25 (0.25-r0)\n(7/13) Installing mpfr4 (4.1.0-r0)\n(8/13) Installing mpc1 (1.2.1-r1)\n(9/13) Installing gcc (12.2.1_git20220924-r4)\n(10/13) Installing musl-dev (1.2.3-r4)\n(11/13) Installing libc-dev (0.7.2-r3)\n(12/13) Installing g++ (12.2.1_git20220924-r4)\n(13/13) Installing make (4.3-r1)\nExecuting busybox-1.35.0-r29.trigger\nOK: 311 MiB in 53 packages\nRemoving intermediate container be6d3e540ab5\n ---> 04e1f7c4b43d\nStep 7/44 : RUN npm install --quiet node-gyp -g\n ---> Running in 7d66303e108e\n\u001b[91mnpm WARN deprecated @npmcli/move-file@2.0.1: This functionality has been moved to @npmcli/fs\n\u001b[0m\nadded 95 packages, and audited 96 packages in 6s\n\n5 packages are looking for funding\n  run `npm fund` for details\n\nfound 0 vulnerabilities\n\u001b[91mnpm notice \nnpm notice New major version of npm available! 8.19.2 -> 9.2.0\nnpm notice Changelog: <https://github.com/npm/cli/releases/tag/v9.2.0>\nnpm\u001b[0m\u001b[91m notice Run `npm install -g npm@9.2.0` to update!\nnpm notice \n\u001b[0mRemoving intermediate container 7d66303e108e\n ---> bfc2041aeabc\nStep 8/44 : RUN apk add --update --no-cache --repository http://dl-3.alpinelinux.org/alpine/edge/community --repository http://dl-3.alpinelinux.org/alpine/edge/main vips-dev\n ---> Running in af793b6e4e0c\nfetch http://dl-3.alpinelinux.org/alpine/edge/main/x86_64/APKINDEX.tar.gz\nfetch http://dl-3.alpinelinux.org/alpine/edge/community/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/community/x86_64/APKINDEX.tar.gz\n(1/131) Upgrading brotli-libs (1.0.9-r9 -> 1.0.9-r10)\n(2/131) Upgrading ncurses-terminfo-base (6.3_p20221119-r0 -> 6.3_p20221224-r0)\n(3/131) Upgrading ncurses-libs (6.3_p20221119-r0 -> 6.3_p20221224-r0)\n(4/131) Installing openexr (3.1.5-r4)\n(5/131) Installing pkgconf (1.9.3-r1)\n(6/131) Installing openexr-dev (3.1.5-r4)\n(7/131) Installing cairo-tools (1.17.6-r3)\n(8/131) Installing libpng (1.6.39-r2)\n(9/131) Installing freetype (2.12.1-r0)\n(10/131) Installing fontconfig (2.14.1-r0)\n(11/131) Installing expat (2.5.0-r0)\n(12/131) Installing expat-dev (2.5.0-r0)\n(13/131) Installing brotli (1.0.9-r10)\n(14/131) Installing brotli-dev (1.0.9-r10)\n(15/131) Installing zlib-dev (1.2.13-r0)\n(16/131) Installing libpng-dev (1.6.39-r2)\n(17/131) Installing freetype-dev (2.12.1-r0)\n(18/131) Installing fontconfig-dev (2.14.1-r0)\n(19/131) Installing libxau (1.0.11-r0)\n(20/131) Installing xorgproto (2022.2-r0)\n(21/131) Installing libxau-dev (1.0.11-r0)\n(22/131) Installing libmd (1.0.4-r0)\n(23/131) Installing libbsd (0.11.7-r0)\n(24/131) Installing libxdmcp (1.1.4-r0)\n(25/131) Installing libxcb (1.15-r0)\n(26/131) Installing libx11 (1.8.3-r0)\n(27/131) Installing libxext (1.3.5-r0)\n(28/131) Installing xcb-proto (1.15.2-r1)\n(29/131) Installing libxdmcp-dev (1.1.4-r0)\n(30/131) Installing libxcb-dev (1.15-r0)\n(31/131) Installing xtrans (1.4.0-r2)\n(32/131) Installing libx11-dev (1.8.3-r0)\n(33/131) Installing libxext-dev (1.3.5-r0)\n(34/131) Installing libxrender (0.9.11-r0)\n(35/131) Installing libxrender-dev (0.9.11-r0)\n(36/131) Installing pixman (0.42.2-r0)\n(37/131) Installing pixman-dev (0.42.2-r0)\n(38/131) Installing util-macros (1.19.3-r0)\n(39/131) Installing xcb-util (0.4.1-r0)\n(40/131) Installing xcb-util-dev (0.4.1-r0)\n(41/131) Installing cairo (1.17.6-r3)\n(42/131) Installing libintl (0.21.1-r1)\n(43/131) Installing libblkid (2.38.1-r1)\n(44/131) Installing libmount (2.38.1-r1)\n(45/131) Installing pcre2 (10.42-r0)\n(46/131) Installing glib (2.74.4-r0)\n(47/131) Installing cairo-gobject (1.17.6-r3)\n(48/131) Installing bzip2-dev (1.0.8-r4)\n(49/131) Installing libxml2 (2.10.3-r2)\n(50/131) Installing libxml2-utils (2.10.3-r2)\n(51/131) Installing docbook-xml (4.5-r8)\nExecuting docbook-xml-4.5-r8.post-install\n(52/131) Installing libgpg-error (1.46-r1)\n(53/131) Installing libgcrypt (1.10.1-r0)\n(54/131) Installing libxslt (1.1.37-r0)\n(55/131) Installing docbook-xsl (1.79.2-r8)\nExecuting docbook-xsl-1.79.2-r8.post-install\n(56/131) Installing gettext-asprintf (0.21.1-r1)\n(57/131) Installing libunistring (1.1-r0)\n(58/131) Installing gettext-libs (0.21.1-r1)\n(59/131) Installing gettext (0.21.1-r1)\n(60/131) Installing gettext-dev (0.21.1-r1)\n(61/131) Installing linux-headers (6.1.0-r0)\n(62/131) Installing libffi-dev (3.4.4-r0)\n(63/131) Installing bsd-compat-headers (0.7.2-r3)\n(64/131) Installing ncurses-dev (6.3_p20221224-r0)\n(65/131) Installing libedit (20221030.3.1-r0)\n(66/131) Installing libedit-dev (20221030.3.1-r0)\n(67/131) Installing libpcre2-16 (10.42-r0)\n(68/131) Installing libpcre2-32 (10.42-r0)\n(69/131) Installing pcre2-dev (10.42-r0)\n(70/131) Installing libuuid (2.38.1-r1)\n(71/131) Installing libfdisk (2.38.1-r1)\n(72/131) Installing libsmartcols (2.38.1-r1)\n(73/131) Installing util-linux-dev (2.38.1-r1)\n(74/131) Installing glib-dev (2.74.4-r0)\n(75/131) Installing cairo-dev (1.17.6-r3)\n(76/131) Installing cfitsio (4.2.0-r0)\n(77/131) Installing cfitsio-dev (4.2.0-r0)\n(78/131) Installing cgif (0.3.0-r0)\n(79/131) Installing cgif-dev (0.3.0-r0)\n(80/131) Installing fftw-double-libs (3.3.10-r1)\n(81/131) Installing fftw-long-double-libs (3.3.10-r1)\n(82/131) Installing fftw-single-libs (3.3.10-r1)\n(83/131) Installing fftw-dev (3.3.10-r1)\n(84/131) Installing libimagequant (4.0.4-r0)\n(85/131) Installing libimagequant-dev (4.0.4-r0)\n(86/131) Installing libjpeg-turbo (2.1.4-r0)\n(87/131) Installing libjpeg-turbo-dev (2.1.4-r0)\n(88/131) Installing libwebp (1.2.4-r1)\n(89/131) Installing libwebp-dev (1.2.4-r1)\n(90/131) Installing zstd-libs (1.5.2-r9)\n(91/131) Installing zstd-dev (1.5.2-r9)\n(92/131) Installing tiff (4.5.0-r1)\n(93/131) Installing libtiffxx (4.5.0-r1)\n(94/131) Installing tiff-dev (4.5.0-r1)\n(95/131) Installing lcms2 (2.14-r2)\n(96/131) Installing lcms2-dev (2.14-r2)\n(97/131) Installing libexif (0.6.24-r0)\n(98/131) Installing libexif-dev (0.6.24-r0)\n(99/131) Installing openjpeg (2.5.0-r2)\n(100/131) Installing openjpeg-tools (2.5.0-r2)\n(101/131) Installing openjpeg-dev (2.5.0-r2)\n(102/131) Installing shared-mime-info (2.2-r2)\n(103/131) Installing gdk-pixbuf (2.42.10-r2)\n(104/131) Installing libxft (2.3.7-r0)\n(105/131) Installing fribidi (1.0.12-r0)\n(106/131) Installing graphite2 (1.3.14-r2)\n(107/131) Installing harfbuzz (6.0.0-r0)\n(108/131) Installing pango (1.50.12-r0)\n(109/131) Installing rsvg-convert (2.55.1-r0)\n(110/131) Installing librsvg (2.55.1-r0)\n(111/131) Installing gdk-pixbuf-dev (2.42.10-r2)\n(112/131) Installing librsvg-dev (2.55.1-r0)\n(113/131) Installing orc (0.4.33-r0)\n(114/131) Installing orc-compiler (0.4.33-r0)\n(115/131) Installing orc-dev (0.4.33-r0)\n(116/131) Installing pango-tools (1.50.12-r0)\n(117/131) Installing fribidi-dev (1.0.12-r0)\n(118/131) Installing icu-data-en (72.1-r1)\nExecuting icu-data-en-72.1-r1.post-install\n\u001b[91m*\n* If you need ICU with non-English locales and legacy charset support, install\n* package icu-data-full.\n*\n\u001b[0m(119/131) Installing icu-libs (72.1-r1)\n(120/131) Installing harfbuzz-icu (6.0.0-r0)\n(121/131) Installing graphite2-dev (1.3.14-r2)\n(122/131) Installing icu (72.1-r1)\n(123/131) Installing icu-dev (72.1-r1)\n(124/131) Installing harfbuzz-dev (6.0.0-r0)\n(125/131) Installing libxft-dev (2.3.7-r0)\n(126/131) Installing pango-dev (1.50.12-r0)\n(127/131) Installing libspng (0.7.3-r0)\n(128/131) Installing libspng-dev (0.7.3-r0)\n(129/131) Installing vips (8.13.3-r2)\n(130/131) Installing vips-cpp (8.13.3-r2)\n(131/131) Installing vips-dev (8.13.3-r2)\nExecuting busybox-1.35.0-r29.trigger\nExecuting glib-2.74.4-r0.trigger\nNo schema files found: doing nothing.\nExecuting shared-mime-info-2.2-r2.trigger\nExecuting gdk-pixbuf-2.42.10-r2.trigger\nOK: 455 MiB in 181 packages\nRemoving intermediate container af793b6e4e0c\n ---> 18387bb8857c\nStep 9/44 : WORKDIR /temp-deps\n ---> Running in bd3c2f74203b\nRemoving intermediate container bd3c2f74203b\n ---> c28ee3be22a6\nStep 10/44 : COPY [\"package.json\", \"yarn.lock\", \"./\"]\n ---> 9ce8cf416df5\nStep 11/44 : RUN yarn install --frozen-lockfile\n ---> Running in 0eca86e47fb8\nyarn install v1.22.19\n[1/5] Validating package.json...\n[2/5] Resolving packages...\n[3/5] Fetching packages...\n[4/5] Linking dependencies...\n\u001b[91mwarning \"firebase-admin > @firebase/database-compat > @firebase/database > @firebase/auth-interop-types@0.1.7\" has unmet peer dependency \"@firebase/app-types@0.x\".\n\u001b[0m\u001b[91mwarning \" > sequelize-typescript@2.1.5\" has unmet peer dependency \"@types/validator@*\".\n\u001b[0m\u001b[91mwarning \"swagger-jsdoc > swagger-parser > @apidevtools/swagger-parser@10.0.2\" has unmet peer dependency \"openapi-types@>=7\".\n\u001b[0m[5/5] Building fresh packages...\nDone in 103.20s.\nRemoving intermediate container 0eca86e47fb8\n ---> e9236fb68137\nStep 12/44 : FROM node:16.18-alpine as build_base\n ---> bb97fd22e6f8\nStep 13/44 : LABEL author=\"masb0ymas\"\n ---> Running in d2302fe1637d\nRemoving intermediate container d2302fe1637d\n ---> fb21195963bd\nStep 14/44 : LABEL name=\"expresso\"\n ---> Running in 1a457a70fc92\nRemoving intermediate container 1a457a70fc92\n ---> c4cb57579355\nStep 15/44 : WORKDIR /temp-build\n ---> Running in 3c459ad91021\nRemoving intermediate container 3c459ad91021\n ---> 6ee482ca6d7b\nStep 16/44 : RUN export NODE_OPTIONS=\\\"--max_old_space_size=4096\\\"\n ---> Running in c4a49cdc0cf4\nRemoving intermediate container c4a49cdc0cf4\n ---> e1ecd234ba06\nStep 17/44 : COPY . .\n ---> 37a2cb6966c9\nStep 18/44 : RUN cp .env.docker-production .env\n ---> Running in ee6be146b26d\nRemoving intermediate container ee6be146b26d\n ---> 643f1525f2ba\nStep 19/44 : COPY --from=deps /temp-deps/node_modules ./node_modules\n ---> 85491647138e\nStep 20/44 : RUN yarn build && yarn install --production --ignore-scripts --prefer-offline\n ---> Running in 6591ed5d45b4\nyarn run v1.22.19\n$ npm-run-all clean test:lint test:types\n$ rm -rf ./dist\n$ npx eslint '*/**/*.{js,jsx,ts,tsx}' --quiet --fix\n\u001b[91mnpm\u001b[0m\u001b[91m notice \nnpm notice New major version of npm available! 8.19.2 -> 9.2.0\nnpm notice\u001b[0m\u001b[91m Changelog: <https://github.com/npm/cli/releases/tag/v9.2.0>\nnpm notice Run `npm install -g npm@9.2.0` to update!\nnpm notice\u001b[0m\u001b[91m \n\u001b[0m$ tsc --noEmit\n$ npx swc src -d dist\nSuccessfully compiled: 105 files with swc (155.84ms)\nDone in 41.56s.\nyarn install v1.22.19\n[1/5] Validating package.json...\n[2/5] Resolving packages...\n[3/5] Fetching packages...\n[4/5] Linking dependencies...\n\u001b[91mwarning \"firebase-admin > @firebase/database-compat > @firebase/database > @firebase/auth-interop-types@0.1.7\" has unmet peer dependency \"@firebase/app-types@0.x\".\n\u001b[0m\u001b[91mwarning \" > sequelize-typescript@2.1.5\" has unmet peer dependency \"@types/validator@*\".\n\u001b[0m\u001b[91mwarning \"swagger-jsdoc > swagger-parser > @apidevtools/swagger-parser@10.0.2\" has unmet peer dependency \"openapi-types@>=7\".\n\u001b[0m[5/5] Building fresh packages...\n\u001b[91mwarning Ignored scripts due to flag.\n\u001b[0mDone in 86.76s.\nRemoving intermediate container 6591ed5d45b4\n ---> 33065984f6af\nStep 21/44 : FROM node:16.18-alpine as runner\n ---> bb97fd22e6f8\nStep 22/44 : LABEL author=\"masb0ymas\"\n ---> Running in 41edb766bdb6\nRemoving intermediate container 41edb766bdb6\n ---> e95a107fe956\nStep 23/44 : LABEL name=\"expresso\"\n ---> Running in 56c1ae85b46c\nRemoving intermediate container 56c1ae85b46c\n ---> 7b8516083aa5\nStep 24/44 : RUN apk add ca-certificates\n ---> Running in 97b076112b09\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/community/x86_64/APKINDEX.tar.gz\n(1/1) Installing ca-certificates (20220614-r3)\nExecuting busybox-1.35.0-r29.trigger\nExecuting ca-certificates-20220614-r3.trigger\nOK: 10 MiB in 18 packages\nRemoving intermediate container 97b076112b09\n ---> 20998aa41166\nStep 25/44 : RUN npm config set scripts-prepend-node-path true\n ---> Running in e339ff7f54ee\nRemoving intermediate container e339ff7f54ee\n ---> 677d6df45346\nStep 26/44 : RUN npm i -g typescript\n ---> Running in f7230c2b349c\n\nadded 1 package, and audited 2 packages in 1s\n\nfound 0 vulnerabilities\n\u001b[91mnpm notice\u001b[0m\u001b[91m \n\u001b[0m\u001b[91mnpm notice\u001b[0m\u001b[91m New major version of npm available! 8.19.2 -> 9.2.0\nnpm notice Changelog: <https://github.com/npm/cli/releases/tag/v9.2.0>\nnpm\u001b[0m\u001b[91m notice Run `npm install -g npm@9.2.0` to update!\nnpm notice \n\u001b[0mRemoving intermediate container f7230c2b349c\n ---> b83da75ff35b\nStep 27/44 : RUN npm i -g pm2\n ---> Running in 3f474767fd43\n\u001b[91mnpm WARN deprecated uuid@3.4.0: Please upgrade  to version 7 or higher.  Older versions may use Math.random() in certain circumstances, which is known to be problematic.  See https://v8.dev/blog/math-random for details.\n\u001b[0m\nadded 184 packages, and audited 185 packages in 9s\n\n12 packages are looking for funding\n  run `npm fund` for details\n\nfound 0 vulnerabilities\nRemoving intermediate container 3f474767fd43\n ---> 2ef065c0655a\nStep 28/44 : WORKDIR /app\n ---> Running in a4c381c84aaa\nRemoving intermediate container a4c381c84aaa\n ---> 5e3b1676516b\nStep 29/44 : ENV NODE_ENV production\n ---> Running in dd6fb7c641b5\nRemoving intermediate container dd6fb7c641b5\n ---> de1632a4d596\nStep 30/44 : RUN apk add tzdata\n ---> Running in 469702185e15\n(1/1) Installing tzdata (2022f-r1)\nOK: 13 MiB in 19 packages\nRemoving intermediate container 469702185e15\n ---> 3fe5482c8cac\nStep 31/44 : ENV TZ=Asia/Jakarta\n ---> Running in f8fb00863748\nRemoving intermediate container f8fb00863748\n ---> f570704ef0e9\nStep 32/44 : RUN apk add nano\n ---> Running in ada80d3bfaa7\n(1/3) Installing ncurses-terminfo-base (6.3_p20221119-r0)\n(2/3) Installing ncurses-libs (6.3_p20221119-r0)\n(3/3) Installing nano (7.0-r0)\nExecuting busybox-1.35.0-r29.trigger\nOK: 14 MiB in 22 packages\nRemoving intermediate container ada80d3bfaa7\n ---> 1e4450b0d593\nStep 33/44 : COPY --from=build_base /temp-build/public ./public\n ---> dfdfe1beeef3\nStep 34/44 : COPY --from=build_base /temp-build/node_modules ./node_modules\n ---> cd89ba476a77\nStep 35/44 : COPY --from=build_base /temp-build/package.json ./package.json\n ---> a3ce929a1685\nStep 36/44 : COPY --from=build_base /temp-build/tsconfig.json ./tsconfig.json\n ---> cd1ae3ef00f1\nStep 37/44 : COPY --from=build_base /temp-build/.swcrc ./.swcrc\n ---> d9ace5bb8081\nStep 38/44 : COPY --from=build_base /temp-build/logs ./logs\n ---> 4dfcbcff6c37\nStep 39/44 : COPY --from=build_base /temp-build/dist ./dist\n ---> e4ef6a1a80a5\nStep 40/44 : COPY --from=build_base /temp-build/src ./src\n ---> f7b5a7579dca\nStep 41/44 : COPY --from=build_base /temp-build/.env ./.env\n ---> 6d8e7328d9cd\nStep 42/44 : RUN node ./dist/scripts/generate.js\n ---> Running in 5f496525017b\nRefresh APP_KEY=yzfEQzsTYJNWjvGxKegx504cUD3iFwMB Success\nRefresh SECRET_OTP=sXk0Z0uGCf5ICH8NxHeRqSybG6JFv87Z Success\nRefresh JWT_SECRET_ACCESS_TOKEN=23uyARzRDWpCzoCFeyctnF1SFxjyKqVe Success\nRefresh JWT_SECRET_REFRESH_TOKEN=vkXb5IZL26hI3abVIK1YbLHFvSdrYfnX Success\nRemoving intermediate container 5f496525017b\n ---> 6bda79881a77\nStep 43/44 : EXPOSE 8000\n ---> Running in 7a153061f25d\nRemoving intermediate container 7a153061f25d\n ---> afd9de3abd07\nStep 44/44 : CMD [\"yarn\", \"serve:production-docker\"]\n ---> Running in 155bd2b12d0a\nRemoving intermediate container 155bd2b12d0a\n ---> de683b23fdfd\nSuccessfully built de683b23fdfd\nSuccessfully tagged expresso:latest\n","stderr":"","imageSize":670109765},"repair":{"violations":[{"name":"npmCacheCleanAfterInstall","position":{"start":9,"end":9,"columnStart":4,"columnEnd":35}},{"name":"npmCacheCleanAfterInstall","position":{"start":51,"end":51,"columnStart":4,"columnEnd":23}},{"name":"npmCacheCleanAfterInstall","position":{"start":52,"end":52,"columnStart":4,"columnEnd":16}},{"name":"apkAddUseNoCache","position":{"start":47,"end":47,"columnStart":4,"columnEnd":27}},{"name":"apkAddUseNoCache","position":{"start":60,"end":60,"columnStart":4,"columnEnd":18}},{"name":"apkAddUseNoCache","position":{"start":64,"end":64,"columnStart":4,"columnEnd":16}}],"repairedDockerfile":"# Install dependencies only when needed\nFROM node:16.18-alpine as deps\nLABEL author=\"masb0ymas\"\nLABEL name=\"expresso\"\n\n# Check https://github.com/nodejs/docker-node/tree/b4117f9333da4138b03a546ec926ef50a31506c3#nodealpine to understand why libc6-compat might be needed.\nRUN apk add --no-cache libc6-compat\nRUN apk add --update --no-cache curl py-pip\nRUN apk add --no-cache make python3 g++ gcc libgcc libstdc++\nRUN npm install --quiet node-gyp -g\n\n# install for sharp library\nRUN apk add --update --no-cache --repository http://dl-3.alpinelinux.org/alpine/edge/community --repository http://dl-3.alpinelinux.org/alpine/edge/main vips-dev http://dl-3.alpinelinux.org/alpine/edge/community --repository http://dl-3.alpinelinux.org/alpine/edge/main vips-dev\n\n# Set the Temp Working Directory inside the container\nWORKDIR /temp-deps\n\n# copy package json\nCOPY [\"package.json\", \"yarn.lock\", \"./\"]\n\nRUN yarn install --frozen-lockfile\n\nFROM node:16.18-alpine as build_base\nLABEL author=\"masb0ymas\"\nLABEL name=\"expresso\"\n\n# Set the Temp Working Directory inside the container\nWORKDIR /temp-build\n\nRUN export NODE_OPTIONS=\\\"--max_old_space_size=4096\\\"\n\n# copy base code\nCOPY . .\n\n# copy environment\nRUN cp .env.docker-production .env\n\nCOPY --from=deps /temp-deps/node_modules ./node_modules\n\n# prune devDependencies\nRUN yarn build && yarn install --production --ignore-scripts --prefer-offline\n\n# image runner app\nFROM node:16.18-alpine as runner\nLABEL author=\"masb0ymas\"\nLABEL name=\"expresso\"\n\nRUN apk add --no-cache ca-certificates\n\n# install global package for runner\nRUN npm config set scripts-prepend-node-path true\nRUN npm i -g typescript\nRUN npm i -g pm2\n\n# Set the Current Working Directory inside the container\nWORKDIR /app\n\nENV NODE_ENV production\n\n# Setup Timezone\nRUN apk add --no-cache tzdata\nENV TZ=Asia/Jakarta\n\n# editor cli with nano\nRUN apk add --no-cache nano\n\nCOPY --from=build_base /temp-build/public ./public\nCOPY --from=build_base /temp-build/node_modules ./node_modules\nCOPY --from=build_base /temp-build/package.json ./package.json\nCOPY --from=build_base /temp-build/tsconfig.json ./tsconfig.json\nCOPY --from=build_base /temp-build/.swcrc ./.swcrc\nCOPY --from=build_base /temp-build/logs ./logs\nCOPY --from=build_base /temp-build/dist ./dist\nCOPY --from=build_base /temp-build/src ./src\nCOPY --from=build_base /temp-build/.env ./.env\n\n# initial app\nRUN node ./dist/scripts/generate.js\n\n# This container exposes port 8000 to the outside world\nEXPOSE 8000\n\n# Run for production\nCMD [\"yarn\", \"serve:production-docker\"]\n"},"repairedBuild":{"startTimestamp":1672268911100,"endTimestamp":1672268965195,"error":{"code":1,"killed":false,"signal":null,"cmd":"docker build --no-cache --force-rm -t expresso:latest -f /tmp/dinghy-analysis/masb0ymas/expresso/Dockerfile ."},"stdout":"Sending build context to Docker daemon  1.195MB\r\r\nStep 1/44 : FROM node:16.18-alpine as deps\n ---> bb97fd22e6f8\nStep 2/44 : LABEL author=\"masb0ymas\"\n ---> Running in 90c21b6964c2\nRemoving intermediate container 90c21b6964c2\n ---> d7d5325d89fa\nStep 3/44 : LABEL name=\"expresso\"\n ---> Running in 69e025256b7a\nRemoving intermediate container 69e025256b7a\n ---> 462c393ed2f9\nStep 4/44 : RUN apk add --no-cache libc6-compat\n ---> Running in edb6f15a438f\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/community/x86_64/APKINDEX.tar.gz\n(1/1) Installing libc6-compat (1.2.3-r4)\nOK: 10 MiB in 18 packages\nRemoving intermediate container edb6f15a438f\n ---> 72bf688c1128\nStep 5/44 : RUN apk add --update --no-cache curl py-pip\n ---> Running in 29fbd8fdd5d8\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/community/x86_64/APKINDEX.tar.gz\n(1/22) Installing ca-certificates (20220614-r3)\n(2/22) Installing brotli-libs (1.0.9-r9)\n(3/22) Installing nghttp2-libs (1.51.0-r0)\n(4/22) Installing libcurl (7.87.0-r0)\n(5/22) Installing curl (7.87.0-r0)\n(6/22) Installing libbz2 (1.0.8-r4)\n(7/22) Installing libexpat (2.5.0-r0)\n(8/22) Installing libffi (3.4.4-r0)\n(9/22) Installing gdbm (1.23-r0)\n(10/22) Installing xz-libs (5.2.9-r0)\n(11/22) Installing mpdecimal (2.5.1-r1)\n(12/22) Installing ncurses-terminfo-base (6.3_p20221119-r0)\n(13/22) Installing ncurses-libs (6.3_p20221119-r0)\n(14/22) Installing readline (8.2.0-r0)\n(15/22) Installing sqlite-libs (3.40.1-r0)\n(16/22) Installing python3 (3.10.9-r1)\n(17/22) Installing py3-six (1.16.0-r3)\n(18/22) Installing py3-retrying (1.3.3-r3)\n(19/22) Installing py3-parsing (3.0.9-r0)\n(20/22) Installing py3-packaging (21.3-r2)\n(21/22) Installing py3-setuptools (65.6.0-r0)\n(22/22) Installing py3-pip (22.3.1-r1)\nExecuting busybox-1.35.0-r29.trigger\nExecuting ca-certificates-20220614-r3.trigger\nOK: 84 MiB in 40 packages\nRemoving intermediate container 29fbd8fdd5d8\n ---> e100d8462438\nStep 6/44 : RUN apk add --no-cache make python3 g++ gcc libgcc libstdc++\n ---> Running in 778097bfb061\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/community/x86_64/APKINDEX.tar.gz\n(1/13) Installing libstdc++-dev (12.2.1_git20220924-r4)\n(2/13) Installing binutils (2.39-r2)\n(3/13) Installing libgomp (12.2.1_git20220924-r4)\n(4/13) Installing libatomic (12.2.1_git20220924-r4)\n(5/13) Installing gmp (6.2.1-r2)\n(6/13) Installing isl25 (0.25-r0)\n(7/13) Installing mpfr4 (4.1.0-r0)\n(8/13) Installing mpc1 (1.2.1-r1)\n(9/13) Installing gcc (12.2.1_git20220924-r4)\n(10/13) Installing musl-dev (1.2.3-r4)\n(11/13) Installing libc-dev (0.7.2-r3)\n(12/13) Installing g++ (12.2.1_git20220924-r4)\n(13/13) Installing make (4.3-r1)\nExecuting busybox-1.35.0-r29.trigger\nOK: 311 MiB in 53 packages\nRemoving intermediate container 778097bfb061\n ---> c7007c390c8c\nStep 7/44 : RUN npm install --quiet node-gyp -g\n ---> Running in 75bfd8e8c5d8\n\u001b[91mnpm WARN deprecated @npmcli/move-file@2.0.1: This functionality has been moved to @npmcli/fs\n\u001b[0m\nadded 95 packages, and audited 96 packages in 2s\n\n5 packages are looking for funding\n  run `npm fund` for details\n\nfound 0 vulnerabilities\n\u001b[91mnpm notice\u001b[0m\u001b[91m \nnpm \u001b[0m\u001b[91mnotice\u001b[0m\u001b[91m New major version of npm available! 8.19.2 -> 9.2.0\nnpm notice\u001b[0m\u001b[91m Changelog: <https://github.com/npm/cli/releases/tag/v9.2.0>\nnpm \u001b[0m\u001b[91mnotice Run `npm install -g npm@9.2.0` to update!\n\u001b[0m\u001b[91mnpm \u001b[0m\u001b[91mnotice \n\u001b[0mRemoving intermediate container 75bfd8e8c5d8\n ---> 2e28fd27221f\nStep 8/44 : RUN apk add --update --no-cache --repository http://dl-3.alpinelinux.org/alpine/edge/community --repository http://dl-3.alpinelinux.org/alpine/edge/main vips-dev http://dl-3.alpinelinux.org/alpine/edge/community --repository http://dl-3.alpinelinux.org/alpine/edge/main vips-dev\n ---> Running in c6bbc46efef7\nfetch http://dl-3.alpinelinux.org/alpine/edge/main/x86_64/APKINDEX.tar.gz\nfetch http://dl-3.alpinelinux.org/alpine/edge/community/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/community/x86_64/APKINDEX.tar.gz\n\u001b[91mERROR: unable to select packages:\n\u001b[0m  http://dl-3.alpinelinux.org/alpine/edge/community (no such package):\n    required by: world[http://dl-3.alpinelinux.org/alpine/edge/community]\nRemoving intermediate container c6bbc46efef7\n","stderr":"The command '/bin/sh -c apk add --update --no-cache --repository http://dl-3.alpinelinux.org/alpine/edge/community --repository http://dl-3.alpinelinux.org/alpine/edge/main vips-dev http://dl-3.alpinelinux.org/alpine/edge/community --repository http://dl-3.alpinelinux.org/alpine/edge/main vips-dev' returned a non-zero code: 1\n"},"endTime":1672268965269}