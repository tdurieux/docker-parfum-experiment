{"repository":"https://github.com/skerkour/phaser","dockerfilePath":"Dockerfile","startTime":1672587104336,"clone":{"stdout":"","stderr":"Cloning into '/tmp/dinghy-analysis/skerkour/phaser'...\n","error":null,"commit":"20277d827191b29f72188f204e5d50f36ac4e973"},"originalBuild":{"startTimestamp":1672587111909,"endTimestamp":1672587306395,"error":null,"stdout":"Sending build context to Docker daemon  218.1MB\r\r\nStep 1/27 : FROM rust:latest AS builder_rust\nlatest: Pulling from library/rust\n32de3c850997: Already exists\nfa1d4c8d85a4: Already exists\nc796299bbbdd: Already exists\n81283a9569ad: Already exists\n60b38700e7fb: Already exists\n5e868601ee3b: Pulling fs layer\n5e868601ee3b: Verifying Checksum\n5e868601ee3b: Download complete\n5e868601ee3b: Pull complete\nDigest: sha256:0067330b7e0eacacc5c32f21b720607c0cd61eda905c8d55e6a745f579ddeee9\nStatus: Downloaded newer image for rust:latest\n ---> 5e0d0367026b\nStep 2/27 : RUN rustup update\n ---> Running in 8820280a3cc3\n\u001b[91minfo: no updatable toolchains installed\n\u001b[0m\u001b[91minfo: checking for self-updates\n\u001b[0m\u001b[91minfo: cleaning up downloads & tmp directories\n\u001b[0mRemoving intermediate container 8820280a3cc3\n ---> 7e1aac1fe7df\nStep 3/27 : RUN rustup target add x86_64-unknown-linux-musl\n ---> Running in a1189a59eeff\n\u001b[91minfo: downloading component 'rust-std' for 'x86_64-unknown-linux-musl'\n\u001b[0m\u001b[91minfo: installing component 'rust-std' for 'x86_64-unknown-linux-musl'\n\u001b[0mRemoving intermediate container a1189a59eeff\n ---> 9916b1d44a8e\nStep 4/27 : RUN apt update && apt install -y musl-tools musl-dev libssl-dev\n ---> Running in e33fd25f4cc5\n\u001b[91m\nWARNING: apt does not have a stable CLI interface. Use with caution in scripts.\n\n\u001b[0mGet:1 http://deb.debian.org/debian bullseye InRelease [116 kB]\nGet:2 http://deb.debian.org/debian-security bullseye-security InRelease [48.4 kB]\nGet:3 http://deb.debian.org/debian bullseye-updates InRelease [44.1 kB]\nGet:4 http://deb.debian.org/debian bullseye/main amd64 Packages [8183 kB]\nGet:5 http://deb.debian.org/debian-security bullseye-security/main amd64 Packages [210 kB]\nGet:6 http://deb.debian.org/debian bullseye-updates/main amd64 Packages [14.6 kB]\nFetched 8616 kB in 2s (5689 kB/s)\nReading package lists...\nBuilding dependency tree...\nReading state information...\n1 package can be upgraded. Run 'apt list --upgradable' to see it.\n\u001b[91m\nWARNING: apt does not have a stable CLI interface. Use with caution in scripts.\n\n\u001b[0mReading package lists...\nBuilding dependency tree...\nReading state information...\nlibssl-dev is already the newest version (1.1.1n-0+deb11u3).\nRecommended packages:\n  linux-musl-dev\nThe following NEW packages will be installed:\n  musl musl-dev musl-tools\n0 upgraded, 3 newly installed, 0 to remove and 1 not upgraded.\nNeed to get 1063 kB of archives.\nAfter this operation, 4240 kB of additional disk space will be used.\nGet:1 http://deb.debian.org/debian bullseye/main amd64 musl amd64 1.2.2-1 [418 kB]\nGet:2 http://deb.debian.org/debian bullseye/main amd64 musl-dev amd64 1.2.2-1 [604 kB]\nGet:3 http://deb.debian.org/debian bullseye/main amd64 musl-tools amd64 1.2.2-1 [41.7 kB]\n\u001b[91mdebconf: delaying package configuration, since apt-utils is not installed\n\u001b[0mFetched 1063 kB in 0s (23.3 MB/s)\nSelecting previously unselected package musl:amd64.\r\n(Reading database ... \r(Reading database ... 5%\r(Reading database ... 10%\r(Reading database ... 15%\r(Reading database ... 20%\r(Reading database ... 25%\r(Reading database ... 30%\r(Reading database ... 35%\r(Reading database ... 40%\r(Reading database ... 45%\r(Reading database ... 50%\r(Reading database ... 55%\r(Reading database ... 60%\r(Reading database ... 65%\r(Reading database ... 70%\r(Reading database ... 75%\r(Reading database ... 80%\r(Reading database ... 85%\r(Reading database ... 90%\r(Reading database ... 95%\r(Reading database ... 100%\r(Reading database ... 22790 files and directories currently installed.)\r\nPreparing to unpack .../musl_1.2.2-1_amd64.deb ...\r\nUnpacking musl:amd64 (1.2.2-1) ...\r\nSelecting previously unselected package musl-dev:amd64.\r\nPreparing to unpack .../musl-dev_1.2.2-1_amd64.deb ...\r\nUnpacking musl-dev:amd64 (1.2.2-1) ...\r\nSelecting previously unselected package musl-tools.\r\nPreparing to unpack .../musl-tools_1.2.2-1_amd64.deb ...\r\nUnpacking musl-tools (1.2.2-1) ...\r\nSetting up musl:amd64 (1.2.2-1) ...\r\nSetting up musl-dev:amd64 (1.2.2-1) ...\r\nSetting up musl-tools (1.2.2-1) ...\r\nRemoving intermediate container e33fd25f4cc5\n ---> 879425a06f5f\nStep 5/27 : RUN update-ca-certificates\n ---> Running in 93427b8c8a55\nUpdating certificates in /etc/ssl/certs...\n0 added, 0 removed; done.\nRunning hooks in /etc/ca-certificates/update.d...\ndone.\nRemoving intermediate container 93427b8c8a55\n ---> c4bf447fdf6f\nStep 6/27 : ENV USER=phaser\n ---> Running in db2342bdf08d\nRemoving intermediate container db2342bdf08d\n ---> b4c48f98da74\nStep 7/27 : ENV UID=10001\n ---> Running in 4486e5f9ef03\nRemoving intermediate container 4486e5f9ef03\n ---> dd40df91cf23\nStep 8/27 : RUN adduser     --disabled-password     --gecos \"\"     --home \"/nonexistent\"     --shell \"/sbin/nologin\"     --no-create-home     --uid \"${UID}\"     \"${USER}\"\n ---> Running in ffee2d43ba9f\nWarning: The home dir /nonexistent you specified can't be accessed: No such file or directory\nAdding user `phaser' ...\nAdding new group `phaser' (10001) ...\nAdding new user `phaser' (10001) with group `phaser' ...\nNot creating home directory `/nonexistent'.\nRemoving intermediate container ffee2d43ba9f\n ---> 6298e685ac60\nStep 9/27 : WORKDIR /phaser\n ---> Running in 03cc6464ca63\nRemoving intermediate container 03cc6464ca63\n ---> 627d4d790a6a\nStep 10/27 : COPY ./ .\n ---> 2e2fdca8a28f\nStep 11/27 : WORKDIR /phaser/phaser\n ---> Running in 99df724d0cbb\nRemoving intermediate container 99df724d0cbb\n ---> 0245fbfe4127\nStep 12/27 : RUN make build_static\n ---> Running in c46fe2845722\nmkdir -p dist\ncargo build --target x86_64-unknown-linux-musl --release\n\u001b[91m   Compiling libc v0.2.103\n   Compiling autocfg v1.0.1\n   Compiling proc-macro2 v1.0.29\n   Compiling unicode-xid v0.2.2\n\u001b[0m\u001b[91m   Compiling syn v1.0.77\n   Compiling cfg-if v1.0.0\n\u001b[0m\u001b[91m   Compiling memchr v2.4.1\n\u001b[0m\u001b[91m   Compiling log\u001b[0m\u001b[91m v0.4.14\n\u001b[0m\u001b[91m   Compiling pin-project-lite v0.2.\u001b[0m\u001b[91m7\n\u001b[0m\u001b[91m   Compiling once_cell v1.8.0\n\u001b[0m\u001b[91m   Compiling futures-core v0.3.17\u001b[0m\u001b[91m\n\u001b[0m\u001b[91m   Compiling cc v1.0.70\n\u001b[0m\u001b[91m   Compiling parking_lot_core v0.8.5\n\u001b[0m\u001b[91m   Compiling scopeguard v1.1.0\n\u001b[0m\u001b[91m   Compiling smallvec v1.7.0\n\u001b[0m\u001b[91m   Compiling bytes v1.1.0\n\u001b[0m\u001b[91m   Compiling proc-macro-hack v0.5.19\n\u001b[0m\u001b[91m   Compiling proc-macro-nested v0.1.7\n\u001b[0m\u001b[91m   Compiling futures-sink v0.3.17\n\u001b[0m\u001b[91m   Compiling futures-channel v0.3.17\n\u001b[0m\u001b[91m   Compiling futures-task v0.3.17\n\u001b[0m\u001b[91m   Compiling pin-utils v0.1.0\n\u001b[0m\u001b[91m   Compiling futures-io v0.3.17\n\u001b[0m\u001b[91m   Compiling slab v0.4.4\n\u001b[0m\u001b[91m   Compiling lazy_static v1.4.0\n\u001b[0m\u001b[91m   Compiling itoa v0.4.8\n\u001b[0m\u001b[91m   Compiling untrusted v0.7\u001b[0m\u001b[91m.1\n\u001b[0m\u001b[91m   Compiling spin v0.5.2\n\u001b[0m\u001b[91m   Compiling matches v0.1.9\n\u001b[0m\u001b[91m   Compiling serde_derive v1.0.130\u001b[0m\u001b[91m\n\u001b[0m\u001b[91m   Compiling tinyvec_macros v0.1.0\u001b[0m\u001b[91m\n\u001b[0m\u001b[91m   Compiling percent-encoding v2.1.0\u001b[0m\u001b[91m\n\u001b[0m\u001b[91m   Compiling serde v1.0.130\n\u001b[0m\u001b[91m   Compiling fnv v1.0.7\n\u001b[0m\u001b[91m   Compiling httparse v1.5\u001b[0m\u001b[91m.1\n\u001b[0m\u001b[91m   Compiling unicode-bidi v0.3.6\n\u001b[0m\u001b[91m   Compiling instant v0.1.11\n\u001b[0m\u001b[91m   Compiling lock_api v0.4.5\n\u001b[0m\u001b[91m   Compiling hashbrown v0.11.2\n\u001b[0m\u001b[91m   Compiling ryu v1.0.5\n\u001b[0m\u001b[91m   Compiling tracing-core v0.1.20\n\u001b[0m\u001b[91m   Compiling unicode-segmentation v1.8.0\n\u001b[0m\u001b[91m   Compiling fs_extra v1.2.0\n\u001b[0m\u001b[91m   Compiling async-trait v0.1.51\n\u001b[0m\u001b[91m   Compiling try-lock v0.2.3\n\u001b[0m\u001b[91m   Compiling ppv-lite86 v0.2.10\n\u001b[0m\u001b[91m   Compiling base64 v0.13.0\n\u001b[0m\u001b[91m   Compiling tinyvec v1.5.0\n\u001b[0m\u001b[91m   Compiling tower-service v0.3.1\n\u001b[0m\u001b[91m   Compiling form_urlencoded v1.0.1\n\u001b[0m\u001b[91m  \u001b[0m\u001b[91m \u001b[0m\u001b[91mCompiling\u001b[0m\u001b[91m encoding_rs\u001b[0m\u001b[91m v0.8.28\n\u001b[0m\u001b[91m   Compiling match_cfg v0.1.0\n\u001b[0m\u001b[91m   Compiling httpdate v1.0.1\n\u001b[0m\u001b[91m   Compiling ipnet v2.3.1\n\u001b[0m\u001b[91m   Compiling serde_json v1.0.68\n\u001b[0m\u001b[91m   Compiling regex-syntax v0.6.25\n\u001b[0m\u001b[91m \u001b[0m\u001b[91m \u001b[0m\u001b[91m Compiling anyhow v1\u001b[0m\u001b[91m.0.44\n\u001b[0m\u001b[91m  \u001b[0m\u001b[91m Compiling \u001b[0m\u001b[91mlinked-hash-map\u001b[0m\u001b[91m v\u001b[0m\u001b[91m0.\u001b[0m\u001b[91m5.4\n\u001b[0m\u001b[91m   Compiling unicode-width v0.1.9\n\u001b[0m\u001b[91m   Compiling http v0.2.5\n\u001b[0m\u001b[91m   Compiling quick-error v1.2.3\n\u001b[0m\u001b[91m \u001b[0m\u001b[91m  \u001b[0m\u001b[91mCompiling\u001b[0m\u001b[91m \u001b[0m\u001b[91mfutures-macro v0.3.17\n\u001b[0m\u001b[91m  \u001b[0m\u001b[91m Compiling \u001b[0m\u001b[91mtokio\u001b[0m\u001b[91m v\u001b[0m\u001b[91m1\u001b[0m\u001b[91m.\u001b[0m\u001b[91m12\u001b[0m\u001b[91m.\u001b[0m\u001b[91m0\u001b[0m\u001b[91m\n\u001b[0m\u001b[91m   Compiling futures-util v0.3.17\n\u001b[0m\u001b[91m   \u001b[0m\u001b[91mCompiling\u001b[0m\u001b[91m \u001b[0m\u001b[91mindexmap\u001b[0m\u001b[91m v\u001b[0m\u001b[91m1\u001b[0m\u001b[91m.7\u001b[0m\u001b[91m.\u001b[0m\u001b[91m0\u001b[0m\u001b[91m\n\u001b[0m\u001b[91m  \u001b[0m\u001b[91m Compiling\u001b[0m\u001b[91m num-traits\u001b[0m\u001b[91m v\u001b[0m\u001b[91m0.2.14\n\u001b[0m\u001b[91m   Compiling tracing v0.1.28\n\u001b[0m\u001b[91m \u001b[0m\u001b[91m  Compiling heck v0.3.3\n\u001b[0m\u001b[91m   Compiling num-integer v0.1.44\n\u001b[0m\u001b[91m  \u001b[0m\u001b[91m Compiling \u001b[0m\u001b[91mdata-encoding\u001b[0m\u001b[91m v\u001b[0m\u001b[91m2.3\u001b[0m\u001b[91m.\u001b[0m\u001b[91m2\n\u001b[0m\u001b[91m   Compiling want v0.3.0\n\u001b[0m\u001b[91m   Compiling lru-cache v0.1.2\n\u001b[0m\u001b[91m   Compiling textwrap v0.11.0\n\u001b[0m\u001b[91m   Compiling termcolor v1.1.2\n\u001b[0m\u001b[91m   Compiling bitflags v1.3.2\n\u001b[0m\u001b[91m   Compiling mime v0.3.16\n\u001b[0m\u001b[91m   Compiling humantime v2.1.0\n\u001b[0m\u001b[91m   Compiling vec_map v0.8.2\n\u001b[0m\u001b[91m   Compiling ansi_term v0.11.0\n\u001b[0m\u001b[91m \u001b[0m\u001b[91m  Compiling\u001b[0m\u001b[91m \u001b[0m\u001b[91mstrsim v0\u001b[0m\u001b[91m.\u001b[0m\u001b[91m8.\u001b[0m\u001b[91m0\n\u001b[0m\u001b[91m   Compiling aho-corasick v0.7.18\n\u001b[0m\u001b[91m   Compiling quote v1.0.9\n\u001b[0m\u001b[91m   Compiling ring v0.16.20\n\u001b[0m\u001b[91m   Compiling jemalloc-sys v0.3.2\n\u001b[0m\u001b[91m   Compiling signal-hook-registry v1.4.0\n   Compiling mio v0.7.13\n\u001b[0m\u001b[91m   Compiling num_cpus v1.13.0\n\u001b[0m\u001b[91m   Compiling getrandom v0.2.3\n\u001b[0m\u001b[91m   Compiling socket2 v0.4.2\n\u001b[0m\u001b[91m   Compiling hostname v0.3.1\n\u001b[0m\u001b[91m   Compiling atty v0.2.14\n\u001b[0m\u001b[91m   Compiling time v0.1.43\n\u001b[0m\u001b[91m   Compiling unicode-normalization v0.1.19\n\u001b[0m\u001b[91m   Compiling clap v2.33.3\n\u001b[0m\u001b[91m \u001b[0m\u001b[91m  \u001b[0m\u001b[91mCompiling\u001b[0m\u001b[91m resolv-conf v0.7\u001b[0m\u001b[91m.\u001b[0m\u001b[91m0\n\u001b[0m\u001b[91m   Compiling rand_core v0.6.3\n\u001b[0m\u001b[91m   Compiling parking_lot v0.11.2\n\u001b[0m\u001b[91m   Compiling rand_chacha v0.3.1\n\u001b[0m\u001b[91m   Compiling rand v0.8.4\n\u001b[0m\u001b[91m   Compiling http-body v0.4.3\n\u001b[0m\u001b[91m   Compiling regex v1.5.4\n\u001b[0m\u001b[91m   Compiling idna v0.2.3\n\u001b[0m\u001b[91m   Compiling url v2.2.2\n\u001b[0m\u001b[91m   Compiling env_logger v0.8.4\n\u001b[0m\u001b[91m   Compiling tokio-macros v1.4.1\n   Compiling thiserror-impl v1.0.29\n   Compiling enum-as-inner v0.3.3\n\u001b[0m\u001b[91m   Compiling thiserror v1.0.29\n\u001b[0m\u001b[91m   Compiling futures-executor v0.3.17\n\u001b[0m\u001b[91m   Compiling futures v0.3.17\n\u001b[0m\u001b[91m   Compiling tokio-util v0.6.8\n   Compiling trust-dns-proto v0\u001b[0m\u001b[91m.20.3\n\u001b[0m\u001b[91m   Compiling tokio-stream v0.1.7\n\u001b[0m\u001b[91m   Compiling h2 v0.3.6\n\u001b[0m\u001b[91m   Compiling webpki v0.21.4\n\u001b[0m\u001b[91m   Compiling sct\u001b[0m\u001b[91m v0.6.1\n\u001b[0m\u001b[91m   Compiling rustls v0.19.1\n   Compiling webpki-roots v0.21.1\n\u001b[0m\u001b[91m   Compiling trust-dns-resolver v0.20.3\n\u001b[0m\u001b[91m   Compiling serde_urlencoded v0.7.0\n   Compiling chrono v0.4.19\n\u001b[0m\u001b[91m   Compiling tokio-rustls v0.22.0\n\u001b[0m\u001b[91m   Compiling hyper v0.14.13\n\u001b[0m\u001b[91m   Compiling hyper-rustls v0.22.1\n\u001b[0m\u001b[91m   Compiling reqwest v0.11.4\n\u001b[0m\u001b[91m   Compiling jemallocator v0.3.2\n\u001b[0m\u001b[91m   Compiling phaser v0.7.8 (/phaser/phaser)\n\u001b[0m\u001b[91m    Finished release [optimized] target(s) in 1m 17s\n\u001b[0mcp target/x86_64-unknown-linux-musl/release/phaser dist/phaser\ncp takeover_fingerprints.json dist/takeover_fingerprints.json\nRemoving intermediate container c46fe2845722\n ---> 656c4b48e677\nStep 13/27 : FROM alpine:latest\n ---> 49176f190c7e\nStep 14/27 : RUN apk update && apk add --no-cache ca-certificates\n ---> Running in 2f75b43477fa\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/community/x86_64/APKINDEX.tar.gz\nv3.17.0-306-g917d743036 [https://dl-cdn.alpinelinux.org/alpine/v3.17/main]\nv3.17.0-312-gf3974f8f5f [https://dl-cdn.alpinelinux.org/alpine/v3.17/community]\nOK: 17813 distinct packages available\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/community/x86_64/APKINDEX.tar.gz\n(1/1) Installing ca-certificates (20220614-r3)\nExecuting busybox-1.35.0-r29.trigger\nExecuting ca-certificates-20220614-r3.trigger\nOK: 8 MiB in 16 packages\nRemoving intermediate container 2f75b43477fa\n ---> 2933ce3c11cf\nStep 15/27 : RUN update-ca-certificates\n ---> Running in eb810e75792c\n\u001b[91mWARNING: ca-certificates.crt does not contain exactly one certificate or CRL: skipping\n\u001b[0mRemoving intermediate container eb810e75792c\n ---> fbfcbb0a5733\nStep 16/27 : COPY --from=builder_rust /etc/passwd /etc/passwd\n ---> aa513de08733\nStep 17/27 : COPY --from=builder_rust /etc/group /etc/group\n ---> 555c7a994928\nStep 18/27 : WORKDIR /phaser\n ---> Running in 8c975053af3d\nRemoving intermediate container 8c975053af3d\n ---> 465ed95ef7cf\nStep 19/27 : ENV PATH=\"/phaser:${PATH}\"\n ---> Running in bb308d00d72c\nRemoving intermediate container bb308d00d72c\n ---> 880c08687434\nStep 20/27 : COPY --from=builder_rust /phaser/phaser/dist/ ./\n ---> c018c670fc32\nStep 21/27 : USER phaser:phaser\n ---> Running in deda1698e176\nRemoving intermediate container deda1698e176\n ---> 2c959fb2c166\nStep 22/27 : CMD [\"/phaser/phaser\", \"--help\"]\n ---> Running in 032cb20031eb\nRemoving intermediate container 032cb20031eb\n ---> 6236e7bc9754\nStep 23/27 : LABEL maintainer=\"Sylvain Kerkour <https://kerkour.com>\"\n ---> Running in e292205e3a4c\nRemoving intermediate container e292205e3a4c\n ---> a0574ac6d8e2\nStep 24/27 : LABEL homepage=https://github.com/skerkour/phaser\n ---> Running in 89929b46458e\nRemoving intermediate container 89929b46458e\n ---> fa6e9e801fa3\nStep 25/27 : LABEL org.opencontainers.image.name=phaser\n ---> Running in 3a91b0d5654d\nRemoving intermediate container 3a91b0d5654d\n ---> f5964cf5ac72\nStep 26/27 : LABEL repository=https://github.com/skerkour/phaser\n ---> Running in 12f69f1b685d\nRemoving intermediate container 12f69f1b685d\n ---> d807c03ec253\nStep 27/27 : LABEL org.opencontainers.image.source https://github.com/skerkour/phaser\n ---> Running in cea9e3c08b06\nRemoving intermediate container cea9e3c08b06\n ---> d5e639685c9c\nSuccessfully built d5e639685c9c\nSuccessfully tagged phaser:latest\n","stderr":"","imageSize":25314441},"repair":{"violations":[{"name":"ruleAptGetInstallUseNoRec","position":{"start":7,"end":7,"columnStart":18,"columnEnd":63}},{"name":"ruleAptGetInstallThenRemoveAptLists","position":{"start":7,"end":7,"columnStart":18,"columnEnd":63}}],"repairedDockerfile":"####################################################################################################\n## Build phaser\n####################################################################################################\nFROM rust:latest AS builder_rust\n\nRUN rustup update\nRUN rustup target add x86_64-unknown-linux-musl\nRUN apt update && apt install --no-install-recommends -y musl-tools musl-dev libssl-dev\nRUN update-ca-certificates\n\n# Create appuser\nENV USER=phaser\nENV UID=10001\n\n# See https://stackoverflow.com/a/55757473/12429735RUN\nRUN adduser \\\n    --disabled-password \\\n    --gecos \"\" \\\n    --home \"/nonexistent\" \\\n    --shell \"/sbin/nologin\" \\\n    --no-create-home \\\n    --uid \"${UID}\" \\\n    \"${USER}\"\n\n\nWORKDIR /phaser\n\nCOPY ./ .\nWORKDIR /phaser/phaser\n\nRUN make build_static\n# RUN make build\n\n\n####################################################################################################\n## Final image\n####################################################################################################\n# FROM scratch\n# Here we prefer alpine because otherwise the container won't launch on heroku\nFROM alpine:latest\n\nRUN apk update && apk add --no-cache ca-certificates\nRUN update-ca-certificates\n\n# Import from builder.\nCOPY --from=builder_rust /etc/passwd /etc/passwd\nCOPY --from=builder_rust /etc/group /etc/group\n\nWORKDIR /phaser\nENV PATH=\"/phaser:${PATH}\"\n\n# Copy our builds\nCOPY --from=builder_rust /phaser/phaser/dist/ ./\n\n# Use an unprivileged user.\nUSER phaser:phaser\n\nCMD [\"/phaser/phaser\", \"--help\"]\n\nLABEL maintainer=\"Sylvain Kerkour <https://kerkour.com>\"\nLABEL homepage=https://github.com/skerkour/phaser\nLABEL org.opencontainers.image.name=phaser\nLABEL repository=https://github.com/skerkour/phaser\nLABEL org.opencontainers.image.source https://github.com/skerkour/phaser\n"},"repairedBuild":{"startTimestamp":1672587306727,"endTimestamp":1672587529906,"error":null,"stdout":"Sending build context to Docker daemon  218.1MB\r\r\nStep 1/27 : FROM rust:latest AS builder_rust\n ---> 5e0d0367026b\nStep 2/27 : RUN rustup update\n ---> Running in 017f1b2afcdb\n\u001b[91minfo: no updatable toolchains installed\n\u001b[0m\u001b[91minfo: checking for self-updates\n\u001b[0m\u001b[91minfo: cleaning up downloads & tmp directories\n\u001b[0mRemoving intermediate container 017f1b2afcdb\n ---> 3b72165809aa\nStep 3/27 : RUN rustup target add x86_64-unknown-linux-musl\n ---> Running in f66b859328f3\n\u001b[91minfo: downloading component 'rust-std' for 'x86_64-unknown-linux-musl'\n\u001b[0m\u001b[91minfo: installing component 'rust-std' for 'x86_64-unknown-linux-musl'\n\u001b[0mRemoving intermediate container f66b859328f3\n ---> 1a05637f24f4\nStep 4/27 : RUN apt update && apt install --no-install-recommends -y musl-tools musl-dev libssl-dev\n ---> Running in a41e63a8751f\n\u001b[91m\nWARNING: apt does not have a stable CLI interface. Use with caution in scripts.\n\n\u001b[0mGet:1 http://deb.debian.org/debian bullseye InRelease [116 kB]\nGet:2 http://deb.debian.org/debian-security bullseye-security InRelease [48.4 kB]\nGet:3 http://deb.debian.org/debian bullseye-updates InRelease [44.1 kB]\nGet:4 http://deb.debian.org/debian bullseye/main amd64 Packages [8183 kB]\nGet:5 http://deb.debian.org/debian-security bullseye-security/main amd64 Packages [210 kB]\nGet:6 http://deb.debian.org/debian bullseye-updates/main amd64 Packages [14.6 kB]\nFetched 8616 kB in 1s (6766 kB/s)\nReading package lists...\nBuilding dependency tree...\nReading state information...\n1 package can be upgraded. Run 'apt list --upgradable' to see it.\n\u001b[91m\nWARNING: apt does not have a stable CLI interface. Use with caution in scripts.\n\n\u001b[0mReading package lists...\nBuilding dependency tree...\nReading state information...\nlibssl-dev is already the newest version (1.1.1n-0+deb11u3).\nRecommended packages:\n  linux-musl-dev\nThe following NEW packages will be installed:\n  musl musl-dev musl-tools\n0 upgraded, 3 newly installed, 0 to remove and 1 not upgraded.\nNeed to get 1063 kB of archives.\nAfter this operation, 4240 kB of additional disk space will be used.\nGet:1 http://deb.debian.org/debian bullseye/main amd64 musl amd64 1.2.2-1 [418 kB]\nGet:2 http://deb.debian.org/debian bullseye/main amd64 musl-dev amd64 1.2.2-1 [604 kB]\nGet:3 http://deb.debian.org/debian bullseye/main amd64 musl-tools amd64 1.2.2-1 [41.7 kB]\n\u001b[91mdebconf: delaying package configuration, since apt-utils is not installed\n\u001b[0mFetched 1063 kB in 0s (27.2 MB/s)\nSelecting previously unselected package musl:amd64.\r\n(Reading database ... \r(Reading database ... 5%\r(Reading database ... 10%\r(Reading database ... 15%\r(Reading database ... 20%\r(Reading database ... 25%\r(Reading database ... 30%\r(Reading database ... 35%\r(Reading database ... 40%\r(Reading database ... 45%\r(Reading database ... 50%\r(Reading database ... 55%\r(Reading database ... 60%\r(Reading database ... 65%\r(Reading database ... 70%\r(Reading database ... 75%\r(Reading database ... 80%\r(Reading database ... 85%\r(Reading database ... 90%\r(Reading database ... 95%\r(Reading database ... 100%\r(Reading database ... 22790 files and directories currently installed.)\r\nPreparing to unpack .../musl_1.2.2-1_amd64.deb ...\r\nUnpacking musl:amd64 (1.2.2-1) ...\r\nSelecting previously unselected package musl-dev:amd64.\r\nPreparing to unpack .../musl-dev_1.2.2-1_amd64.deb ...\r\nUnpacking musl-dev:amd64 (1.2.2-1) ...\r\nSelecting previously unselected package musl-tools.\r\nPreparing to unpack .../musl-tools_1.2.2-1_amd64.deb ...\r\nUnpacking musl-tools (1.2.2-1) ...\r\nSetting up musl:amd64 (1.2.2-1) ...\r\nSetting up musl-dev:amd64 (1.2.2-1) ...\r\nSetting up musl-tools (1.2.2-1) ...\r\nRemoving intermediate container a41e63a8751f\n ---> 9b721a974183\nStep 5/27 : RUN update-ca-certificates\n ---> Running in 89ebb9118cd4\nUpdating certificates in /etc/ssl/certs...\n0 added, 0 removed; done.\nRunning hooks in /etc/ca-certificates/update.d...\ndone.\nRemoving intermediate container 89ebb9118cd4\n ---> 619331235a44\nStep 6/27 : ENV USER=phaser\n ---> Running in 0b36f6ae95ba\nRemoving intermediate container 0b36f6ae95ba\n ---> 4359e039b7fa\nStep 7/27 : ENV UID=10001\n ---> Running in d273f7c28a5e\nRemoving intermediate container d273f7c28a5e\n ---> 3c96b714700f\nStep 8/27 : RUN adduser     --disabled-password     --gecos \"\"     --home \"/nonexistent\"     --shell \"/sbin/nologin\"     --no-create-home     --uid \"${UID}\"     \"${USER}\"\n ---> Running in b9c7f3c44919\nWarning: The home dir /nonexistent you specified can't be accessed: No such file or directory\nAdding user `phaser' ...\nAdding new group `phaser' (10001) ...\nAdding new user `phaser' (10001) with group `phaser' ...\nNot creating home directory `/nonexistent'.\nRemoving intermediate container b9c7f3c44919\n ---> 25458488ebf0\nStep 9/27 : WORKDIR /phaser\n ---> Running in eb2eb1e34b23\nRemoving intermediate container eb2eb1e34b23\n ---> 076c406a9e60\nStep 10/27 : COPY ./ .\n ---> 84bb742753fb\nStep 11/27 : WORKDIR /phaser/phaser\n ---> Running in ed73722d5ecb\nRemoving intermediate container ed73722d5ecb\n ---> 47455dfd6ece\nStep 12/27 : RUN make build_static\n ---> Running in eab0cca51ff2\nmkdir -p dist\ncargo build --target x86_64-unknown-linux-musl --release\n\u001b[91m   Compiling libc v0.2.103\n   Compiling autocfg v1.0.1\n\u001b[0m\u001b[91m   Compiling proc-macro2 v1.0.29\n\u001b[0m\u001b[91m   Compiling unicode-xid v0.2.2\n   Compiling syn v1.0.77\n\u001b[0m\u001b[91m   Compiling cfg-if v1.0.0\n\u001b[0m\u001b[91m   Compiling memchr v2.4.1\n\u001b[0m\u001b[91m   Compiling log v\u001b[0m\u001b[91m0.4.14\n\u001b[0m\u001b[91m   Compiling pin-project-lite v0.2.7\n\u001b[0m\u001b[91m   Compiling once_cell v1.8.0\n\u001b[0m\u001b[91m   Compiling cc v1.0.70\n\u001b[0m\u001b[91m   Compiling futures-core v0.3.\u001b[0m\u001b[91m17\n\u001b[0m\u001b[91m   Compiling parking_lot_core v0.8.5\n\u001b[0m\u001b[91m   Compiling smallvec v1.7.0\n\u001b[0m\u001b[91m   Compiling scopeguard v1.1.0\n\u001b[0m\u001b[91m   Compiling proc-macro-hack v0.5.19\n\u001b[0m\u001b[91m   Compiling bytes v1.1.0\n\u001b[0m\u001b[91m   Compiling proc-macro-nested v0.1.7\n\u001b[0m\u001b[91m   Compiling futures-channel v0.3.17\n\u001b[0m\u001b[91m   Compiling futures-task v0.3.17\n\u001b[0m\u001b[91m   Compiling futures-sink v0.3.17\u001b[0m\u001b[91m\n\u001b[0m\u001b[91m   Compiling slab v0.4.4\n\u001b[0m\u001b[91m   Compiling futures-io v0.3.17\n\u001b[0m\u001b[91m   Compiling pin-utils v0.1.0\n\u001b[0m\u001b[91m   Compiling spin v\u001b[0m\u001b[91m0.5.2\n\u001b[0m\u001b[91m   Compiling untrusted v0.7\u001b[0m\u001b[91m.1\n\u001b[0m\u001b[91m   Compiling lazy_static v1.4.0\n\u001b[0m\u001b[91m   Compiling itoa v0.4.8\n\u001b[0m\u001b[91m   Compiling tinyvec_macros v0.1.0\n\u001b[0m\u001b[91m   Compiling matches v0.1.\u001b[0m\u001b[91m9\n\u001b[0m\u001b[91m   Compiling serde_derive v1.0.130\n\u001b[0m\u001b[91m   Compiling fnv v1.0.7\n\u001b[0m\u001b[91m   Compiling percent-encoding v2.1.0\n\u001b[0m\u001b[91m   Compiling serde v1.0.130\n\u001b[0m\u001b[91m   Compiling unicode-bidi\u001b[0m\u001b[91m v0.3.6\n\u001b[0m\u001b[91m   Compiling hashbrown v0.11.2\n\u001b[0m\u001b[91m   Compiling instant v0.1.11\n\u001b[0m\u001b[91m   Compiling lock_api v0.4.5\n\u001b[0m\u001b[91m   Compiling httparse v1.5.1\n\u001b[0m\u001b[91m   Compiling ryu v1.0.5\n\u001b[0m\u001b[91m   Compiling tinyvec v1.5.0\n\u001b[0m\u001b[91m   Compiling try-lock v0.2.3\n\u001b[0m\u001b[91m   Compiling form_urlencoded v1.0.1\n   Compiling ppv-lite86 v0.2.10\n\u001b[0m\u001b[91m   Compiling tracing-core v0.1.20\n\u001b[0m\u001b[91m   Compiling unicode-segmentation v1.8.0\n\u001b[0m\u001b[91m   Compiling base64 v0.13.0\n\u001b[0m\u001b[91m   Compiling async-trait v0.1.51\n\u001b[0m\u001b[91m   Compiling fs_extra v1.2.0\n\u001b[0m\u001b[91m   Compiling tower-service v0\u001b[0m\u001b[91m.3.1\n\u001b[0m\u001b[91m   Compiling serde_json v1.0.68\n\u001b[0m\u001b[91m   Compiling encoding_rs v0.8.28\u001b[0m\u001b[91m\n\u001b[0m\u001b[91m   Compiling ipnet v2.3.1\n\u001b[0m\u001b[91m   Compiling httpdate v1.0.1\n\u001b[0m\u001b[91m   Compiling match_cfg v0.1.0\n\u001b[0m\u001b[91m   Compiling regex-syntax v0.6.25\n\u001b[0m\u001b[91m \u001b[0m\u001b[91m  Compiling unicode-width v0.1.9\n\u001b[0m\u001b[91m   Compiling anyhow v1.0.44\n\u001b[0m\u001b[91m   Compiling data-encoding v2.3.2\n\u001b[0m\u001b[91m   Compiling \u001b[0m\u001b[91mhttp v0\u001b[0m\u001b[91m.\u001b[0m\u001b[91m2\u001b[0m\u001b[91m.\u001b[0m\u001b[91m5\u001b[0m\u001b[91m\n\u001b[0m\u001b[91m   Compiling quick-error v1.2.3\n\u001b[0m\u001b[91m   Compiling linked-hash-map v0.5.4\n   Compiling textwrap v0.11.0\n\u001b[0m\u001b[91m   Compiling tokio v1.12.0\n\u001b[0m\u001b[91m \u001b[0m\u001b[91m \u001b[0m\u001b[91m Compiling futures-macro v0.3\u001b[0m\u001b[91m.17\n\u001b[0m\u001b[91m   Compiling futures-util v0.3.17\n\u001b[0m\u001b[91m   Compiling indexmap v1.7.0\n\u001b[0m\u001b[91m   Compiling num-traits v0.2.14\n\u001b[0m\u001b[91m   Compiling tracing v0.1.28\n\u001b[0m\u001b[91m   Compiling heck v0.3.3\n\u001b[0m\u001b[91m   Compiling want v0.3.0\n\u001b[0m\u001b[91m   Compiling num-integer v0.1.44\n\u001b[0m\u001b[91m   Compiling lru-cache v0.1.2\n\u001b[0m\u001b[91m   Compiling termcolor v1.1.2\n\u001b[0m\u001b[91m   Compiling vec_map v0.8.2\n\u001b[0m\u001b[91m   \u001b[0m\u001b[91mCompiling mime\u001b[0m\u001b[91m v\u001b[0m\u001b[91m0\u001b[0m\u001b[91m.\u001b[0m\u001b[91m3\u001b[0m\u001b[91m.\u001b[0m\u001b[91m16\n\u001b[0m\u001b[91m   Compiling strsim v0.8.0\n\u001b[0m\u001b[91m   Compiling humantime v2.\u001b[0m\u001b[91m1.0\u001b[0m\u001b[91m\n\u001b[0m\u001b[91m   Compiling ansi_term v0.11.0\n\u001b[0m\u001b[91m   Compiling bitflags v1.3.2\n\u001b[0m\u001b[91m   Compiling aho-corasick v0.7.18\n\u001b[0m\u001b[91m   Compiling ring v0.16.20\n   Compiling jemalloc-sys v0.3.2\n\u001b[0m\u001b[91m  \u001b[0m\u001b[91m Compiling\u001b[0m\u001b[91m \u001b[0m\u001b[91mquote v\u001b[0m\u001b[91m1\u001b[0m\u001b[91m.\u001b[0m\u001b[91m0\u001b[0m\u001b[91m.\u001b[0m\u001b[91m9\u001b[0m\u001b[91m\n\u001b[0m\u001b[91m   Compiling signal-hook-registry v1.4.0\n   Compiling num_cpus v1.13.0\n\u001b[0m\u001b[91m   Compiling mio\u001b[0m\u001b[91m v0.7.13\n\u001b[0m\u001b[91m   Compiling getrandom v0.2.3\n\u001b[0m\u001b[91m   Compiling socket2 v0.4.2\n\u001b[0m\u001b[91m   Compiling atty v\u001b[0m\u001b[91m0\u001b[0m\u001b[91m.2.\u001b[0m\u001b[91m14\u001b[0m\u001b[91m\n\u001b[0m\u001b[91m   Compiling hostname v0.3.1\n\u001b[0m\u001b[91m   Compiling time v0.1.43\n\u001b[0m\u001b[91m \u001b[0m\u001b[91m  \u001b[0m\u001b[91mCompiling\u001b[0m\u001b[91m \u001b[0m\u001b[91municode-normalization\u001b[0m\u001b[91m v0\u001b[0m\u001b[91m.\u001b[0m\u001b[91m1\u001b[0m\u001b[91m.\u001b[0m\u001b[91m19\u001b[0m\u001b[91m\n\u001b[0m\u001b[91m   Compiling resolv-conf v0.7.0\n\u001b[0m\u001b[91m   Compiling clap v2.33.3\n\u001b[0m\u001b[91m   Compiling rand_core v0.6.3\n\u001b[0m\u001b[91m   Compiling parking_lot v0.11.2\n\u001b[0m\u001b[91m   Compiling rand_chacha v0.3.1\n\u001b[0m\u001b[91m   Compiling rand v0.8.4\n\u001b[0m\u001b[91m   Compiling http-body v0.4.3\n\u001b[0m\u001b[91m   Compiling regex v1.5.4\n\u001b[0m\u001b[91m   Compiling idna v0.2.3\n\u001b[0m\u001b[91m   Compiling url v2.2.2\n\u001b[0m\u001b[91m   Compiling env_logger v0.8.4\n\u001b[0m\u001b[91m   Compiling tokio-macros v1.4.1\n\u001b[0m\u001b[91m   Compiling thiserror-impl v1.0.29\n\u001b[0m\u001b[91m   Compiling enum-as-inner v0.3.3\n\u001b[0m\u001b[91m   Compiling thiserror v1.0.29\n\u001b[0m\u001b[91m   Compiling webpki v0.21.4\n\u001b[0m\u001b[91m   Compiling sct v0.6.1\n\u001b[0m\u001b[91m   Compiling rustls v0.19.1\n   Compiling webpki-roots v0.21.1\n\u001b[0m\u001b[91m   Compiling futures-executor v0.3.17\n\u001b[0m\u001b[91m   Compiling futures v0.3.17\n\u001b[0m\u001b[91m   Compiling tokio-util v0.6.8\n   Compiling trust-dns-proto v0.20.3\n\u001b[0m\u001b[91m   Compiling tokio-stream v0.1.7\n\u001b[0m\u001b[91m   Compiling tokio-rustls v0.22.0\n\u001b[0m\u001b[91m   Compiling h2 v0.3.6\n\u001b[0m\u001b[91m   Compiling trust-dns-resolver v0.20.3\n\u001b[0m\u001b[91m   Compiling serde_urlencoded v0.7.0\n   Compiling\u001b[0m\u001b[91m chrono v0.4\u001b[0m\u001b[91m.19\n\u001b[0m\u001b[91m   Compiling hyper v0.14.13\n\u001b[0m\u001b[91m   Compiling hyper-rustls v0.22.1\n\u001b[0m\u001b[91m   Compiling reqwest v0.11.4\n\u001b[0m\u001b[91m   Compiling jemallocator v0.3.2\n\u001b[0m\u001b[91m   Compiling phaser v0.7.8 (/phaser/phaser)\n\u001b[0m\u001b[91m    Finished release [optimized] target(s) in 1m 19s\n\u001b[0mcp target/x86_64-unknown-linux-musl/release/phaser dist/phaser\ncp takeover_fingerprints.json dist/takeover_fingerprints.json\nRemoving intermediate container eab0cca51ff2\n ---> d3ec413615a5\nStep 13/27 : FROM alpine:latest\n ---> 49176f190c7e\nStep 14/27 : RUN apk update && apk add --no-cache ca-certificates\n ---> Running in 5a0429992e1c\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/community/x86_64/APKINDEX.tar.gz\nv3.17.0-306-g917d743036 [https://dl-cdn.alpinelinux.org/alpine/v3.17/main]\nv3.17.0-312-gf3974f8f5f [https://dl-cdn.alpinelinux.org/alpine/v3.17/community]\nOK: 17813 distinct packages available\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/community/x86_64/APKINDEX.tar.gz\n(1/1) Installing ca-certificates (20220614-r3)\nExecuting busybox-1.35.0-r29.trigger\nExecuting ca-certificates-20220614-r3.trigger\nOK: 8 MiB in 16 packages\nRemoving intermediate container 5a0429992e1c\n ---> 7ec9b6ad1985\nStep 15/27 : RUN update-ca-certificates\n ---> Running in b7489b7b7b15\n\u001b[91mWARNING: ca-certificates.crt does not contain exactly one certificate or CRL: skipping\n\u001b[0mRemoving intermediate container b7489b7b7b15\n ---> 4f745650e3bf\nStep 16/27 : COPY --from=builder_rust /etc/passwd /etc/passwd\n ---> 66adf9bb1e0c\nStep 17/27 : COPY --from=builder_rust /etc/group /etc/group\n ---> 574071a44a29\nStep 18/27 : WORKDIR /phaser\n ---> Running in cdeee65977da\nRemoving intermediate container cdeee65977da\n ---> cae958858aef\nStep 19/27 : ENV PATH=\"/phaser:${PATH}\"\n ---> Running in 699958d16754\nRemoving intermediate container 699958d16754\n ---> 94f99a7200fd\nStep 20/27 : COPY --from=builder_rust /phaser/phaser/dist/ ./\n ---> 3b10c267eef4\nStep 21/27 : USER phaser:phaser\n ---> Running in a726627ebf3c\nRemoving intermediate container a726627ebf3c\n ---> 14fa103d40a3\nStep 22/27 : CMD [\"/phaser/phaser\", \"--help\"]\n ---> Running in f457afbec8aa\nRemoving intermediate container f457afbec8aa\n ---> 6d4093a06a61\nStep 23/27 : LABEL maintainer=\"Sylvain Kerkour <https://kerkour.com>\"\n ---> Running in 6e87c22d8cb6\nRemoving intermediate container 6e87c22d8cb6\n ---> 3ed1a5ca5813\nStep 24/27 : LABEL homepage=https://github.com/skerkour/phaser\n ---> Running in 554df91aecba\nRemoving intermediate container 554df91aecba\n ---> 7f6c206bac9b\nStep 25/27 : LABEL org.opencontainers.image.name=phaser\n ---> Running in c73a6ba9c2c7\nRemoving intermediate container c73a6ba9c2c7\n ---> 8d89e455dae2\nStep 26/27 : LABEL repository=https://github.com/skerkour/phaser\n ---> Running in 635856132d3a\nRemoving intermediate container 635856132d3a\n ---> 11a0cec790f1\nStep 27/27 : LABEL org.opencontainers.image.source https://github.com/skerkour/phaser\n ---> Running in c688b7c34233\nRemoving intermediate container c688b7c34233\n ---> ce385e1c8af0\nSuccessfully built ce385e1c8af0\nSuccessfully tagged phaser:latest\n","stderr":"","imageSize":25314441},"endTime":1672587530328}