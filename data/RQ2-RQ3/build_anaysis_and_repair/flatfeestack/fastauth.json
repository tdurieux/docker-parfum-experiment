{"repository":"https://github.com/flatfeestack/fastauth","dockerfilePath":"Dockerfile","startTime":1672350539148,"clone":{"stdout":"","stderr":"Cloning into '/tmp/dinghy-analysis/flatfeestack/fastauth'...\n","error":null,"commit":"03bc12266d45a5f5bba3934a8211606f8bf70f59"},"originalBuild":{"startTimestamp":1672350540091,"endTimestamp":1672350660608,"error":null,"stdout":"Sending build context to Docker daemon  159.2kB\r\r\nStep 1/15 : FROM golang:1.19-alpine AS base\n1.19-alpine: Pulling from library/golang\nDigest: sha256:a9b24b67dc83b3383d22a14941c2b2b2ca6a103d805cac6820fd1355943beaf1\nStatus: Downloaded newer image for golang:1.19-alpine\n ---> cae57157ceaa\nStep 2/15 : RUN apk update && apk add --update make gcc musl-dev\n ---> Running in 3831d3c6da37\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/community/x86_64/APKINDEX.tar.gz\nv3.17.0-306-g917d743036 [https://dl-cdn.alpinelinux.org/alpine/v3.17/main]\nv3.17.0-307-g96eb718a77 [https://dl-cdn.alpinelinux.org/alpine/v3.17/community]\nOK: 17814 distinct packages available\n(1/12) Installing libgcc (12.2.1_git20220924-r4)\n(2/12) Installing libstdc++ (12.2.1_git20220924-r4)\n(3/12) Installing binutils (2.39-r2)\n(4/12) Installing libgomp (12.2.1_git20220924-r4)\n(5/12) Installing libatomic (12.2.1_git20220924-r4)\n(6/12) Installing gmp (6.2.1-r2)\n(7/12) Installing isl25 (0.25-r0)\n(8/12) Installing mpfr4 (4.1.0-r0)\n(9/12) Installing mpc1 (1.2.1-r1)\n(10/12) Installing gcc (12.2.1_git20220924-r4)\n(11/12) Installing make (4.3-r1)\n(12/12) Installing musl-dev (1.2.3-r4)\nExecuting busybox-1.35.0-r29.trigger\nOK: 153 MiB in 28 packages\nRemoving intermediate container 3831d3c6da37\n ---> f004617f5732\nStep 3/15 : WORKDIR /app\n ---> Running in 420dbde00cff\nRemoving intermediate container 420dbde00cff\n ---> cd2c90a076b0\nStep 4/15 : COPY go.* cache ./\n ---> 9850990444cf\nStep 5/15 : RUN go mod download\n ---> Running in 230858326a73\nRemoving intermediate container 230858326a73\n ---> b8b47c686a6f\nStep 6/15 : RUN go build && rm fastauth cache.go\n ---> Running in 3ae776a7b6c2\nRemoving intermediate container 3ae776a7b6c2\n ---> bd9232bc2fd1\nStep 7/15 : FROM base as builder\n ---> bd9232bc2fd1\nStep 8/15 : COPY *.go *.sql login.html banner.txt ./\n ---> 1ee7b0bd5038\nStep 9/15 : RUN go build\n ---> Running in 94c1067c29ee\nRemoving intermediate container 94c1067c29ee\n ---> adaaffaca0a3\nStep 10/15 : FROM alpine:3.17\n ---> 49176f190c7e\nStep 11/15 : RUN addgroup -S nonroot -g 31323 && adduser -S nonroot -G nonroot -u 31323\n ---> Running in 28f7ce12323f\nRemoving intermediate container 28f7ce12323f\n ---> 606c2cead15f\nStep 12/15 : WORKDIR /app\n ---> Running in 4e148d328b40\nRemoving intermediate container 4e148d328b40\n ---> e6d602e97bd6\nStep 13/15 : COPY --from=builder /app/login.html /app/banner.txt /app/fastauth /app/rmdb.sql /app/init.sql ./\n ---> 995d171cd53e\nStep 14/15 : USER nonroot\n ---> Running in ae005144fe6b\nRemoving intermediate container ae005144fe6b\n ---> df6edccc1071\nStep 15/15 : ENTRYPOINT [\"/app/fastauth\"]\n ---> Running in 1d3d358f54de\nRemoving intermediate container 1d3d358f54de\n ---> 6e9358ae15c7\nSuccessfully built 6e9358ae15c7\nSuccessfully tagged fastauth:latest\n","stderr":"","imageSize":23950404},"repair":{"violations":[{"name":"apkAddUseNoCache","position":{"start":1,"end":1,"columnStart":18,"columnEnd":52}}],"repairedDockerfile":"FROM golang:1.19-alpine AS base\nRUN apk update && apk add --no-cache --update make gcc musl-dev\nWORKDIR /app\nCOPY go.* cache ./\nRUN go mod download\n#here we build cache.go, as this takes ages to compile and does not change\nRUN go build && rm fastauth cache.go\n\nFROM base as builder\nCOPY *.go *.sql login.html banner.txt ./\nRUN go build\n\nFROM alpine:3.17\nRUN addgroup -S nonroot -g 31323 && adduser -S nonroot -G nonroot -u 31323\nWORKDIR /app\nCOPY --from=builder /app/login.html /app/banner.txt /app/fastauth /app/rmdb.sql /app/init.sql ./\nUSER nonroot\nENTRYPOINT [\"/app/fastauth\"]\n"},"repairedBuild":{"startTimestamp":1672350662018,"endTimestamp":1672350753501,"error":null,"stdout":"Sending build context to Docker daemon  159.2kB\r\r\nStep 1/15 : FROM golang:1.19-alpine AS base\n ---> cae57157ceaa\nStep 2/15 : RUN apk update && apk add --no-cache --update make gcc musl-dev\n ---> Running in fffbee4c40ef\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/community/x86_64/APKINDEX.tar.gz\nv3.17.0-306-g917d743036 [https://dl-cdn.alpinelinux.org/alpine/v3.17/main]\nv3.17.0-307-g96eb718a77 [https://dl-cdn.alpinelinux.org/alpine/v3.17/community]\nOK: 17814 distinct packages available\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/community/x86_64/APKINDEX.tar.gz\n(1/12) Installing libgcc (12.2.1_git20220924-r4)\n(2/12) Installing libstdc++ (12.2.1_git20220924-r4)\n(3/12) Installing binutils (2.39-r2)\n(4/12) Installing libgomp (12.2.1_git20220924-r4)\n(5/12) Installing libatomic (12.2.1_git20220924-r4)\n(6/12) Installing gmp (6.2.1-r2)\n(7/12) Installing isl25 (0.25-r0)\n(8/12) Installing mpfr4 (4.1.0-r0)\n(9/12) Installing mpc1 (1.2.1-r1)\n(10/12) Installing gcc (12.2.1_git20220924-r4)\n(11/12) Installing make (4.3-r1)\n(12/12) Installing musl-dev (1.2.3-r4)\nExecuting busybox-1.35.0-r29.trigger\nOK: 153 MiB in 28 packages\nRemoving intermediate container fffbee4c40ef\n ---> 5e2018125043\nStep 3/15 : WORKDIR /app\n ---> Running in 97f7d1d1a34e\nRemoving intermediate container 97f7d1d1a34e\n ---> c8ce2adc6ba1\nStep 4/15 : COPY go.* cache ./\n ---> f8ee839744f5\nStep 5/15 : RUN go mod download\n ---> Running in d830a83d25a2\nRemoving intermediate container d830a83d25a2\n ---> 4018c7cafd41\nStep 6/15 : RUN go build && rm fastauth cache.go\n ---> Running in 832950eee5a3\nRemoving intermediate container 832950eee5a3\n ---> 8b88980d4d26\nStep 7/15 : FROM base as builder\n ---> 8b88980d4d26\nStep 8/15 : COPY *.go *.sql login.html banner.txt ./\n ---> 2290fd08c49a\nStep 9/15 : RUN go build\n ---> Running in ac51a674dbf9\nRemoving intermediate container ac51a674dbf9\n ---> 1fb58c220e87\nStep 10/15 : FROM alpine:3.17\n ---> 49176f190c7e\nStep 11/15 : RUN addgroup -S nonroot -g 31323 && adduser -S nonroot -G nonroot -u 31323\n ---> Running in dfa86d048bb5\nRemoving intermediate container dfa86d048bb5\n ---> 78573fbbf95c\nStep 12/15 : WORKDIR /app\n ---> Running in b347619e1105\nRemoving intermediate container b347619e1105\n ---> 5b903e0845ac\nStep 13/15 : COPY --from=builder /app/login.html /app/banner.txt /app/fastauth /app/rmdb.sql /app/init.sql ./\n ---> 8b2c6706d802\nStep 14/15 : USER nonroot\n ---> Running in 5f9226e0e3c3\nRemoving intermediate container 5f9226e0e3c3\n ---> 68c870bb98f4\nStep 15/15 : ENTRYPOINT [\"/app/fastauth\"]\n ---> Running in fa20a59f05eb\nRemoving intermediate container fa20a59f05eb\n ---> d2eb7da372cc\nSuccessfully built d2eb7da372cc\nSuccessfully tagged fastauth:latest\n","stderr":"","imageSize":23950404},"endTime":1672350753819}