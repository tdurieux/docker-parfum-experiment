{"repository":"https://github.com/metal-stack/metal-api","dockerfilePath":"Dockerfile","startTime":1672868963695,"endTime":1672869317342,"clone":{"startTime":1672868963697,"stdout":"","stderr":"Cloning into '/tmp/dinghy-analysis/metal-stack/metal-api'...\n","error":null,"endTime":1672868964603,"commit":"7c919f1faf671d8962a1a8ab02d5e07d59673062"},"originalBuild":{"startTime":1672868964698,"endTime":1672869179641,"error":null,"stdout":"Sending build context to Docker daemon  2.227MB\r\r\nStep 1/5 : FROM metalstack/builder:latest as builder\nlatest: Pulling from metalstack/builder\nfd31ec14dccd: Pulling fs layer\n1b6422bfa326: Pulling fs layer\n335cbfc794fe: Pulling fs layer\n2a348ba61fbe: Pulling fs layer\nb5858f738f60: Pulling fs layer\n22471a90e48c: Pulling fs layer\n8c7f5f13898f: Pulling fs layer\n07f16d750022: Pulling fs layer\n1246aef3b7e2: Pulling fs layer\nc74e1f0d4bc2: Pulling fs layer\na6c30024c469: Pulling fs layer\neec60f59e3c4: Pulling fs layer\nf06485308b3e: Pulling fs layer\n965cd65b22a9: Pulling fs layer\ne3df4a0a5a6f: Pulling fs layer\n0a262e418506: Pulling fs layer\n2a348ba61fbe: Waiting\na9fb7c518235: Pulling fs layer\nb5858f738f60: Waiting\na9fb7c518235: Waiting\n07f16d750022: Waiting\n22471a90e48c: Waiting\na6c30024c469: Waiting\n8c7f5f13898f: Waiting\nc74e1f0d4bc2: Waiting\neec60f59e3c4: Waiting\n965cd65b22a9: Waiting\nf06485308b3e: Waiting\n0a262e418506: Waiting\ne3df4a0a5a6f: Waiting\n1b6422bfa326: Verifying Checksum\n1b6422bfa326: Download complete\n335cbfc794fe: Verifying Checksum\n335cbfc794fe: Download complete\n2a348ba61fbe: Verifying Checksum\n2a348ba61fbe: Download complete\nfd31ec14dccd: Verifying Checksum\nfd31ec14dccd: Download complete\n8c7f5f13898f: Verifying Checksum\n8c7f5f13898f: Download complete\n22471a90e48c: Verifying Checksum\n22471a90e48c: Download complete\n07f16d750022: Verifying Checksum\n07f16d750022: Download complete\nb5858f738f60: Verifying Checksum\nb5858f738f60: Download complete\nc74e1f0d4bc2: Verifying Checksum\nc74e1f0d4bc2: Download complete\nfd31ec14dccd: Pull complete\na6c30024c469: Verifying Checksum\na6c30024c469: Download complete\n1b6422bfa326: Pull complete\nf06485308b3e: Verifying Checksum\nf06485308b3e: Download complete\n965cd65b22a9: Verifying Checksum\n965cd65b22a9: Download complete\n1246aef3b7e2: Verifying Checksum\n1246aef3b7e2: Download complete\n335cbfc794fe: Pull complete\ne3df4a0a5a6f: Download complete\n0a262e418506: Verifying Checksum\n0a262e418506: Download complete\na9fb7c518235: Download complete\neec60f59e3c4: Verifying Checksum\neec60f59e3c4: Download complete\n2a348ba61fbe: Pull complete\nb5858f738f60: Pull complete\n22471a90e48c: Pull complete\n8c7f5f13898f: Pull complete\n07f16d750022: Pull complete\n1246aef3b7e2: Pull complete\nc74e1f0d4bc2: Pull complete\na6c30024c469: Pull complete\neec60f59e3c4: Pull complete\nf06485308b3e: Pull complete\n965cd65b22a9: Pull complete\ne3df4a0a5a6f: Pull complete\n0a262e418506: Pull complete\na9fb7c518235: Pull complete\nDigest: sha256:e5d4040b6c5bb7278de03ac9816f84daa77e4f1f1d0c68a6439247e406e1e93f\nStatus: Downloaded newer image for metalstack/builder:latest\n# Executing 5 build triggers\n ---> Running in 0b447fe2264e\nRemoving intermediate container 0b447fe2264e\n ---> Running in 4fe07a9342ff\nRemoving intermediate container 4fe07a9342ff\n ---> Running in e2ed507949b7\nCGO_ENABLED=1 go test -cover ./...\n?   \tgithub.com/metal-stack/metal-api/cmd/metal-api\t[no test files]\nok  \tgithub.com/metal-stack/metal-api/cmd/metal-api/internal/datastore\t0.123s\tcoverage: 38.8% of statements\n?   \tgithub.com/metal-stack/metal-api/cmd/metal-api/internal/datastore/migrations\t[no test files]\nok  \tgithub.com/metal-stack/metal-api/cmd/metal-api/internal/eventbus\t0.015s\tcoverage: 43.8% of statements\nok  \tgithub.com/metal-stack/metal-api/cmd/metal-api/internal/fsm\t0.021s\tcoverage: 91.9% of statements\n?   \tgithub.com/metal-stack/metal-api/cmd/metal-api/internal/fsm/states\t[no test files]\nok  \tgithub.com/metal-stack/metal-api/cmd/metal-api/internal/grpc\t0.043s\tcoverage: 35.2% of statements\n?   \tgithub.com/metal-stack/metal-api/cmd/metal-api/internal/headscale\t[no test files]\n?   \tgithub.com/metal-stack/metal-api/cmd/metal-api/internal/ipam\t[no test files]\nok  \tgithub.com/metal-stack/metal-api/cmd/metal-api/internal/metal\t0.021s\tcoverage: 70.6% of statements\n?   \tgithub.com/metal-stack/metal-api/cmd/metal-api/internal/metrics\t[no test files]\nok  \tgithub.com/metal-stack/metal-api/cmd/metal-api/internal/service\t0.648s\tcoverage: 42.4% of statements\n?   \tgithub.com/metal-stack/metal-api/cmd/metal-api/internal/service/s3client\t[no test files]\n?   \tgithub.com/metal-stack/metal-api/cmd/metal-api/internal/service/v1\t[no test files]\nok  \tgithub.com/metal-stack/metal-api/cmd/metal-api/internal/tags\t0.109s\tcoverage: 100.0% of statements\n?   \tgithub.com/metal-stack/metal-api/cmd/metal-api/internal/tools/visualize_fsm\t[no test files]\n?   \tgithub.com/metal-stack/metal-api/cmd/metal-api/internal/utils\t[no test files]\n?   \tgithub.com/metal-stack/metal-api/pkg/api/v1\t[no test files]\n?   \tgithub.com/metal-stack/metal-api/test\t[no test files]\nCGO_ENABLED=\"0\"\n\ngo build \\\n\t-tags netgo \\\n\t-ldflags \\\n\t\" -X 'github.com/metal-stack/v.Version=master' -X 'github.com/metal-stack/v.Revision=heads/master-0-g7c919f1' -X 'github.com/metal-stack/v.GitSHA1=7c919f1f' -X 'github.com/metal-stack/v.BuildDate=2023-01-04T21:51:38Z'\" \\\n\t-o bin/metal-api \\\n\tgithub.com/metal-stack/metal-api/cmd/metal-api\nbin/metal-api dump-swagger | jq -r -S 'walk(if type == \"array\" then sort_by(strings) else . end)' > spec/metal-api.json || { echo \"jq >=1.6 required\"; exit 1; }\n\u001b[91m{\"level\":\"info\",\"timestamp\":\"2023-01-04T21:52:12Z\",\"caller\":\"metal-api/main.go:709\",\"msg\":\"s3 server that provides firmware is disabled\"}\n\u001b[0mgit diff --exit-code spec pkg\nRemoving intermediate container e2ed507949b7\n ---> 5e304df7fcc0\nStep 2/5 : FROM alpine:3.16\n ---> bfe296a52501\nStep 3/5 : RUN apk -U add ca-certificates\n ---> Running in b3c78bab0434\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.16/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.16/community/x86_64/APKINDEX.tar.gz\n(1/1) Installing ca-certificates (20220614-r0)\nExecuting busybox-1.35.0-r17.trigger\nExecuting ca-certificates-20220614-r0.trigger\nOK: 6 MiB in 15 packages\nRemoving intermediate container b3c78bab0434\n ---> 9c3477f32542\nStep 4/5 : COPY --from=builder /work/bin/metal-api /metal-api\n ---> 8ccaf797b287\nStep 5/5 : CMD [\"/metal-api\"]\n ---> Running in 5c1eb07cae34\nRemoving intermediate container 5c1eb07cae34\n ---> 998bdbd93c54\nSuccessfully built 998bdbd93c54\nSuccessfully tagged metal-api:latest\n","stderr":"","imageSize":54914201},"repair":{"startTime":1672869179711,"endTime":1672869179733,"violations":[{"name":"apkAddUseNoCache","position":{"start":3,"end":3,"columnStart":4,"columnEnd":30}}],"repairedDockerfile":"FROM metalstack/builder:latest as builder\n\nFROM alpine:3.16\nRUN apk -U --no-cache add ca-certificates\nCOPY --from=builder /work/bin/metal-api /metal-api\nCMD [\"/metal-api\"]\n"},"repairedBuild":{"startTime":1672869179968,"endTime":1672869317058,"error":null,"stdout":"Sending build context to Docker daemon  2.227MB\r\r\nStep 1/5 : FROM metalstack/builder:latest as builder\n# Executing 5 build triggers\n ---> Running in 61a7a6c46e34\nRemoving intermediate container 61a7a6c46e34\n ---> Running in 08056babf1f7\nRemoving intermediate container 08056babf1f7\n ---> Running in 4a4dd3008a40\nCGO_ENABLED=1 go test -cover ./...\n?   \tgithub.com/metal-stack/metal-api/cmd/metal-api\t[no test files]\nok  \tgithub.com/metal-stack/metal-api/cmd/metal-api/internal/datastore\t0.144s\tcoverage: 38.8% of statements\n?   \tgithub.com/metal-stack/metal-api/cmd/metal-api/internal/datastore/migrations\t[no test files]\nok  \tgithub.com/metal-stack/metal-api/cmd/metal-api/internal/eventbus\t0.026s\tcoverage: 43.8% of statements\nok  \tgithub.com/metal-stack/metal-api/cmd/metal-api/internal/fsm\t0.054s\tcoverage: 91.9% of statements\n?   \tgithub.com/metal-stack/metal-api/cmd/metal-api/internal/fsm/states\t[no test files]\nok  \tgithub.com/metal-stack/metal-api/cmd/metal-api/internal/grpc\t0.057s\tcoverage: 35.2% of statements\n?   \tgithub.com/metal-stack/metal-api/cmd/metal-api/internal/headscale\t[no test files]\n?   \tgithub.com/metal-stack/metal-api/cmd/metal-api/internal/ipam\t[no test files]\nok  \tgithub.com/metal-stack/metal-api/cmd/metal-api/internal/metal\t0.013s\tcoverage: 70.6% of statements\n?   \tgithub.com/metal-stack/metal-api/cmd/metal-api/internal/metrics\t[no test files]\nok  \tgithub.com/metal-stack/metal-api/cmd/metal-api/internal/service\t0.629s\tcoverage: 42.4% of statements\n?   \tgithub.com/metal-stack/metal-api/cmd/metal-api/internal/service/s3client\t[no test files]\n?   \tgithub.com/metal-stack/metal-api/cmd/metal-api/internal/service/v1\t[no test files]\nok  \tgithub.com/metal-stack/metal-api/cmd/metal-api/internal/tags\t0.008s\tcoverage: 100.0% of statements\n?   \tgithub.com/metal-stack/metal-api/cmd/metal-api/internal/tools/visualize_fsm\t[no test files]\n?   \tgithub.com/metal-stack/metal-api/cmd/metal-api/internal/utils\t[no test files]\n?   \tgithub.com/metal-stack/metal-api/pkg/api/v1\t[no test files]\n?   \tgithub.com/metal-stack/metal-api/test\t[no test files]\nCGO_ENABLED=\"0\"\n\ngo build \\\n\t-tags netgo \\\n\t-ldflags \\\n\t\" -X 'github.com/metal-stack/v.Version=master' -X 'github.com/metal-stack/v.Revision=heads/master-0-g7c919f1' -X 'github.com/metal-stack/v.GitSHA1=7c919f1f' -X 'github.com/metal-stack/v.BuildDate=2023-01-04T21:54:26Z'\" \\\n\t-o bin/metal-api \\\n\tgithub.com/metal-stack/metal-api/cmd/metal-api\nbin/metal-api dump-swagger | jq -r -S 'walk(if type == \"array\" then sort_by(strings) else . end)' > spec/metal-api.json || { echo \"jq >=1.6 required\"; exit 1; }\n\u001b[91m{\"level\":\"info\",\"timestamp\":\"2023-01-04T21:54:51Z\",\"caller\":\"metal-api/main.go:709\",\"msg\":\"s3 server that provides firmware is disabled\"}\n\u001b[0mgit diff --exit-code spec pkg\nRemoving intermediate container 4a4dd3008a40\n ---> cfa228850558\nStep 2/5 : FROM alpine:3.16\n ---> bfe296a52501\nStep 3/5 : RUN apk -U --no-cache add ca-certificates\n ---> Running in bdfadc28b403\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.16/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.16/community/x86_64/APKINDEX.tar.gz\n(1/1) Installing ca-certificates (20220614-r0)\nExecuting busybox-1.35.0-r17.trigger\nExecuting ca-certificates-20220614-r0.trigger\nOK: 6 MiB in 15 packages\nRemoving intermediate container bdfadc28b403\n ---> 4880d1865b7d\nStep 4/5 : COPY --from=builder /work/bin/metal-api /metal-api\n ---> c6f9914efc7f\nStep 5/5 : CMD [\"/metal-api\"]\n ---> Running in 17a1820ab617\nRemoving intermediate container 17a1820ab617\n ---> ad2ea3cf77e5\nSuccessfully built ad2ea3cf77e5\nSuccessfully tagged metal-api:latest\n","stderr":"","imageSize":52447864}}