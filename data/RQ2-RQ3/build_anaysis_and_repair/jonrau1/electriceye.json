{"repository":"https://github.com/jonrau1/electriceye","dockerfilePath":"Dockerfile","startTime":1672292392042,"clone":{"stdout":"","stderr":"Cloning into '/tmp/dinghy-analysis/jonrau1/electriceye'...\n","error":null,"commit":"6b6ab97f80e7d8fead5944966f5f911027b1b802"},"originalBuild":{"startTimestamp":1672292395275,"endTimestamp":1672292461740,"error":null,"stdout":"Sending build context to Docker daemon  84.27MB\r\r\nStep 1/11 : FROM alpine@sha256:1304f174557314a7ed9eddb4eab12fed12cb0cd9809e4c28f29af86979a3c870 AS builder\ndocker.io/library/alpine@sha256:1304f174557314a7ed9eddb4eab12fed12cb0cd9809e4c28f29af86979a3c870: Pulling from library/alpine\n213ec9aee27d: Already exists\nDigest: sha256:1304f174557314a7ed9eddb4eab12fed12cb0cd9809e4c28f29af86979a3c870\nStatus: Downloaded newer image for alpine@sha256:1304f174557314a7ed9eddb4eab12fed12cb0cd9809e4c28f29af86979a3c870\n ---> 9c6f07244728\nStep 2/11 : ENV PYTHONUNBUFFERED=1\n ---> Running in 2950962b129c\nRemoving intermediate container 2950962b129c\n ---> 4b468c4686e6\nStep 3/11 : COPY requirements.txt /tmp/requirements.txt\n ---> d83e5894c1a4\nStep 4/11 : COPY ./eeauditor/ /eeauditor/\n ---> 01fae2cb7cd0\nStep 5/11 : RUN     apk update &&     apk add --no-cache python3 postgresql-libs bash nmap &&     apk add --no-cache --virtual .build-deps gcc python3-dev musl-dev postgresql-dev &&     python3 -m ensurepip &&     pip3 install --no-cache --upgrade pip setuptools wheel &&     rm -r /usr/lib/python*/ensurepip &&     pip3 install -r /tmp/requirements.txt --no-cache-dir &&     apk --purge del .build-deps &&     rm -f /var/cache/apk/*\n ---> Running in 2cac423cc48b\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.16/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.16/community/x86_64/APKINDEX.tar.gz\nv3.16.3-91-gd0e167f17b [https://dl-cdn.alpinelinux.org/alpine/v3.16/main]\nv3.16.3-88-gef347edb61 [https://dl-cdn.alpinelinux.org/alpine/v3.16/community]\nOK: 17043 distinct packages available\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.16/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.16/community/x86_64/APKINDEX.tar.gz\n(1/21) Installing ncurses-terminfo-base (6.3_p20220521-r0)\n(2/21) Installing ncurses-libs (6.3_p20220521-r0)\n(3/21) Installing readline (8.1.2-r0)\n(4/21) Installing bash (5.1.16-r2)\nExecuting bash-5.1.16-r2.post-install\n(5/21) Installing libgcc (11.2.1_git20220219-r2)\n(6/21) Installing lua5.3-libs (5.3.6-r3)\n(7/21) Installing libpcap (1.10.1-r0)\n(8/21) Installing pcre (8.45-r2)\n(9/21) Installing libssh2 (1.10.0-r2)\n(10/21) Installing libstdc++ (11.2.1_git20220219-r2)\n(11/21) Installing nmap (7.92-r2)\n(12/21) Installing libpq (14.5-r0)\n(13/21) Installing libecpg (14.5-r0)\n(14/21) Installing libbz2 (1.0.8-r1)\n(15/21) Installing expat (2.5.0-r0)\n(16/21) Installing libffi (3.4.2-r1)\n(17/21) Installing gdbm (1.23-r0)\n(18/21) Installing xz-libs (5.2.5-r1)\n(19/21) Installing mpdecimal (2.5.1-r1)\n(20/21) Installing sqlite-libs (3.38.5-r0)\n(21/21) Installing python3 (3.10.9-r0)\nExecuting busybox-1.35.0-r17.trigger\nOK: 72 MiB in 35 packages\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.16/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.16/community/x86_64/APKINDEX.tar.gz\n(1/28) Upgrading musl (1.2.3-r0 -> 1.2.3-r2)\n(2/28) Installing binutils (2.38-r3)\n(3/28) Installing libgomp (11.2.1_git20220219-r2)\n(4/28) Installing libatomic (11.2.1_git20220219-r2)\n(5/28) Installing gmp (6.2.1-r2)\n(6/28) Installing isl22 (0.22-r0)\n(7/28) Installing mpfr4 (4.1.0-r0)\n(8/28) Installing mpc1 (1.2.1-r0)\n(9/28) Installing gcc (11.2.1_git20220219-r2)\n(10/28) Installing pkgconf (1.8.0-r1)\n(11/28) Upgrading libcrypto1.1 (1.1.1q-r0 -> 1.1.1s-r0)\n(12/28) Upgrading libssl1.1 (1.1.1q-r0 -> 1.1.1s-r0)\n(13/28) Installing python3-dev (3.10.9-r0)\n(14/28) Installing musl-dev (1.2.3-r2)\n(15/28) Installing openssl-dev (1.1.1s-r0)\n(16/28) Installing libpq-dev (14.5-r0)\n(17/28) Installing libecpg-dev (14.5-r0)\n(18/28) Installing libxml2 (2.9.14-r2)\n(19/28) Installing llvm13-libs (13.0.1-r2)\n(20/28) Installing clang-libs (13.0.1-r1)\n(21/28) Installing clang (13.0.1-r1)\n(22/28) Installing icu-data-en (71.1-r2)\nExecuting icu-data-en-71.1-r2.post-install\n\u001b[91m*\n* If you need ICU with non-English locales and legacy charset support, install\n* package icu-data-full.\n*\n\u001b[0m(23/28) Installing icu-libs (71.1-r2)\n(24/28) Installing icu (71.1-r2)\n(25/28) Installing icu-dev (71.1-r2)\n(26/28) Installing llvm13 (13.0.1-r2)\n(27/28) Installing postgresql14-dev (14.5-r0)\n(28/28) Installing .build-deps (20221229.054004)\nExecuting busybox-1.35.0-r17.trigger\nOK: 529 MiB in 60 packages\nLooking in links: /tmp/tmpcav9tjkk\nProcessing /tmp/tmpcav9tjkk/setuptools-65.5.0-py3-none-any.whl\nProcessing /tmp/tmpcav9tjkk/pip-22.3.1-py3-none-any.whl\nInstalling collected packages: setuptools, pip\nSuccessfully installed pip-22.3.1 setuptools-65.5.0\n\u001b[91mWARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv\n\u001b[0mRequirement already satisfied: pip in /usr/lib/python3.10/site-packages (22.3.1)\nRequirement already satisfied: setuptools in /usr/lib/python3.10/site-packages (65.5.0)\nCollecting setuptools\n  Downloading setuptools-65.6.3-py3-none-any.whl (1.2 MB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 1.2/1.2 MB 60.8 MB/s eta 0:00:00\nCollecting wheel\n  Downloading wheel-0.38.4-py3-none-any.whl (36 kB)\nInstalling collected packages: wheel, setuptools\n  Attempting uninstall: setuptools\n    Found existing installation: setuptools 65.5.0\n    Uninstalling setuptools-65.5.0:\n      Successfully uninstalled setuptools-65.5.0\nSuccessfully installed setuptools-65.6.3 wheel-0.38.4\n\u001b[91mWARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv\n\u001b[0mCollecting awscli\n  Downloading awscli-1.27.39-py3-none-any.whl (4.0 MB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 4.0/4.0 MB 90.9 MB/s eta 0:00:00\nCollecting boto3\n  Downloading boto3-1.26.39-py3-none-any.whl (132 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 132.7/132.7 kB 67.9 MB/s eta 0:00:00\nCollecting click\n  Downloading click-8.1.3-py3-none-any.whl (96 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 96.6/96.6 kB 138.5 MB/s eta 0:00:00\nCollecting detect-secrets\n  Downloading detect_secrets-1.4.0-py3-none-any.whl (116 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 116.3/116.3 kB 176.5 MB/s eta 0:00:00\nCollecting pluginbase\n  Downloading pluginbase-1.0.1.tar.gz (43 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 43.6/43.6 kB 173.7 MB/s eta 0:00:00\n  Preparing metadata (setup.py): started\n  Preparing metadata (setup.py): finished with status 'done'\nCollecting psycopg2-binary\n  Downloading psycopg2_binary-2.9.5-cp310-cp310-musllinux_1_1_x86_64.whl (1.9 MB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 1.9/1.9 MB 104.5 MB/s eta 0:00:00\nCollecting pymongo\n  Downloading pymongo-4.3.3.tar.gz (814 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 814.2/814.2 kB 75.6 MB/s eta 0:00:00\n  Preparing metadata (setup.py): started\n  Preparing metadata (setup.py): finished with status 'done'\nCollecting python3-nmap\n  Downloading python3_nmap-1.6.0-py3-none-any.whl (26 kB)\nCollecting colorama<0.4.5,>=0.2.5\n  Downloading colorama-0.4.4-py2.py3-none-any.whl (16 kB)\nCollecting botocore==1.29.39\n  Downloading botocore-1.29.39-py3-none-any.whl (10.3 MB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 10.3/10.3 MB 110.5 MB/s eta 0:00:00\nCollecting rsa<4.8,>=3.1.2\n  Downloading rsa-4.7.2-py3-none-any.whl (34 kB)\nCollecting s3transfer<0.7.0,>=0.6.0\n  Downloading s3transfer-0.6.0-py3-none-any.whl (79 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 79.6/79.6 kB 223.2 MB/s eta 0:00:00\nCollecting PyYAML<5.5,>=3.10\n  Downloading PyYAML-5.4.1.tar.gz (175 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 175.1/175.1 kB 3.3 MB/s eta 0:00:00\n  Installing build dependencies: started\n  Installing build dependencies: finished with status 'done'\n  Getting requirements to build wheel: started\n  Getting requirements to build wheel: finished with status 'done'\n  Preparing metadata (pyproject.toml): started\n  Preparing metadata (pyproject.toml): finished with status 'done'\nCollecting docutils<0.17,>=0.10\n  Downloading docutils-0.16-py2.py3-none-any.whl (548 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 548.2/548.2 kB 154.1 MB/s eta 0:00:00\nCollecting jmespath<2.0.0,>=0.7.1\n  Downloading jmespath-1.0.1-py3-none-any.whl (20 kB)\nCollecting urllib3<1.27,>=1.25.4\n  Downloading urllib3-1.26.13-py2.py3-none-any.whl (140 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 140.6/140.6 kB 224.0 MB/s eta 0:00:00\nCollecting python-dateutil<3.0.0,>=2.1\n  Downloading python_dateutil-2.8.2-py2.py3-none-any.whl (247 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 247.7/247.7 kB 231.7 MB/s eta 0:00:00\nCollecting requests\n  Downloading requests-2.28.1-py3-none-any.whl (62 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 62.8/62.8 kB 193.7 MB/s eta 0:00:00\nCollecting dnspython<3.0.0,>=1.16.0\n  Downloading dnspython-2.2.1-py3-none-any.whl (269 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 269.1/269.1 kB 169.4 MB/s eta 0:00:00\nCollecting simplejson\n  Downloading simplejson-3.18.0-cp310-cp310-musllinux_1_1_x86_64.whl (142 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 142.0/142.0 kB 233.4 MB/s eta 0:00:00\nCollecting pyasn1>=0.1.3\n  Downloading pyasn1-0.4.8-py2.py3-none-any.whl (77 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 77.1/77.1 kB 206.1 MB/s eta 0:00:00\nCollecting charset-normalizer<3,>=2\n  Downloading charset_normalizer-2.1.1-py3-none-any.whl (39 kB)\nCollecting idna<4,>=2.5\n  Downloading idna-3.4-py3-none-any.whl (61 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 61.5/61.5 kB 199.5 MB/s eta 0:00:00\nCollecting certifi>=2017.4.17\n  Downloading certifi-2022.12.7-py3-none-any.whl (155 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 155.3/155.3 kB 83.3 MB/s eta 0:00:00\nCollecting six>=1.5\n  Downloading six-1.16.0-py2.py3-none-any.whl (11 kB)\nBuilding wheels for collected packages: pluginbase, pymongo, PyYAML\n  Building wheel for pluginbase (setup.py): started\n  Building wheel for pluginbase (setup.py): finished with status 'done'\n  Created wheel for pluginbase: filename=pluginbase-1.0.1-py3-none-any.whl size=7797 sha256=403effe9d399dd10fcebe16197ec8aef8d50fe94890aead2ad97a43a3c09daaf\n  Stored in directory: /tmp/pip-ephem-wheel-cache-rw6e6ukz/wheels/c8/0d/ec/32df6e228294449d38912d44c717519496a19aaca0eb142dd4\n  Building wheel for pymongo (setup.py): started\n  Building wheel for pymongo (setup.py): finished with status 'done'\n  Created wheel for pymongo: filename=pymongo-4.3.3-cp310-cp310-linux_x86_64.whl size=490166 sha256=108147c0ef37b8b2e66dd3170cfc41b88693eb59b8541a0f92d03010038685b9\n  Stored in directory: /tmp/pip-ephem-wheel-cache-rw6e6ukz/wheels/bc/67/a8/221bab1038a04f2f53ece550fcd125d567d7abc80fa9a38e35\n  Building wheel for PyYAML (pyproject.toml): started\n  Building wheel for PyYAML (pyproject.toml): finished with status 'done'\n  Created wheel for PyYAML: filename=PyYAML-5.4.1-cp310-cp310-linux_x86_64.whl size=45658 sha256=ffe10af657c2ffb29254a6a9bc86082ebc280e8d8b9e57feb6d76ab348484cc9\n  Stored in directory: /tmp/pip-ephem-wheel-cache-rw6e6ukz/wheels/10/3f/c1/6feec52270653969575b83de934b04be56d7a9e961be5041ea\nSuccessfully built pluginbase pymongo PyYAML\nInstalling collected packages: pyasn1, pluginbase, urllib3, six, simplejson, rsa, PyYAML, psycopg2-binary, jmespath, idna, docutils, dnspython, colorama, click, charset-normalizer, certifi, requests, python3-nmap, python-dateutil, pymongo, detect-secrets, botocore, s3transfer, boto3, awscli\nSuccessfully installed PyYAML-5.4.1 awscli-1.27.39 boto3-1.26.39 botocore-1.29.39 certifi-2022.12.7 charset-normalizer-2.1.1 click-8.1.3 colorama-0.4.4 detect-secrets-1.4.0 dnspython-2.2.1 docutils-0.16 idna-3.4 jmespath-1.0.1 pluginbase-1.0.1 psycopg2-binary-2.9.5 pyasn1-0.4.8 pymongo-4.3.3 python-dateutil-2.8.2 python3-nmap-1.6.0 requests-2.28.1 rsa-4.7.2 s3transfer-0.6.0 simplejson-3.18.0 six-1.16.0 urllib3-1.26.13\n\u001b[91mWARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv\n\u001b[0m(1/25) Purging .build-deps (20221229.054004)\n(2/25) Purging gcc (11.2.1_git20220219-r2)\n(3/25) Purging binutils (2.38-r3)\n(4/25) Purging libatomic (11.2.1_git20220219-r2)\n(5/25) Purging libgomp (11.2.1_git20220219-r2)\n(6/25) Purging python3-dev (3.10.9-r0)\n(7/25) Purging musl-dev (1.2.3-r2)\n(8/25) Purging postgresql14-dev (14.5-r0)\n(9/25) Purging libecpg-dev (14.5-r0)\n(10/25) Purging libpq-dev (14.5-r0)\n(11/25) Purging clang (13.0.1-r1)\n(12/25) Purging icu-dev (71.1-r2)\n(13/25) Purging llvm13 (13.0.1-r2)\n(14/25) Purging mpc1 (1.2.1-r0)\n(15/25) Purging mpfr4 (4.1.0-r0)\n(16/25) Purging isl22 (0.22-r0)\n(17/25) Purging gmp (6.2.1-r2)\n(18/25) Purging openssl-dev (1.1.1s-r0)\n(19/25) Purging pkgconf (1.8.0-r1)\n(20/25) Purging clang-libs (13.0.1-r1)\n(21/25) Purging llvm13-libs (13.0.1-r2)\n(22/25) Purging libxml2 (2.9.14-r2)\n(23/25) Purging icu (71.1-r2)\n(24/25) Purging icu-libs (71.1-r2)\n(25/25) Purging icu-data-en (71.1-r2)\nExecuting busybox-1.35.0-r17.trigger\nOK: 72 MiB in 35 packages\nRemoving intermediate container 2cac423cc48b\n ---> 459920920ba9\nStep 6/11 : FROM builder as electriceye\n ---> 459920920ba9\nStep 7/11 : ENV     SH_SCRIPTS_BUCKET=SH_SCRIPTS_BUCKET     SHODAN_API_KEY_PARAM=SHODAN_API_KEY_PARAM     DOPS_CLIENT_ID_PARAM=DOPS_CLIENT_ID_PARAM     DOPS_API_KEY_PARAM=DOPS_API_KEY_PARAM     POSTGRES_USERNAME=POSTGRES_USERNAME     ELECTRICEYE_POSTGRESQL_DB_NAME=ELECTRICEYE_POSTGRESQL_DB_NAME     POSTGRES_DB_ENDPOINT=POSTGRES_DB_ENDPOINT     POSTGRES_DB_PORT=POSTGRES_DB_PORT     POSTGRES_PASSWORD_SSM_PARAM_NAME=POSTGRES_PASSWORD_SSM_PARAM_NAME     MONGODB_USERNAME=MONGODB_USERNAME     MONGODB_HOSTNAME=MONGODB_HOSTNAME     MONGODB_PASSWORD_PARAMETER=MONGODB_PASSWORD_PARAMETER\n ---> Running in af108dec3f7a\nRemoving intermediate container af108dec3f7a\n ---> eac527525254\nStep 8/11 : LABEL     maintainer=\"https://github.com/jonrau1\"     version=\"3.1\"     license=\"Apache-2.0\"     description=\"ElectricEye continuously monitor your AWS services for configurations that can lead to degradation of confidentiality, integrity     or availability. All results can be exported to Security Hub, JSON, CSV, Databases, and more for further aggregation and analysis.\"\n ---> Running in b5afc446c61c\nRemoving intermediate container b5afc446c61c\n ---> 692766939d9c\nStep 9/11 : RUN     addgroup -S eeuser &&     adduser -S -G eeuser eeuser &&     chown eeuser /eeauditor &&     chown eeuser /eeauditor/* &&     chgrp eeuser /eeauditor &&     chown -R eeuser:eeuser /eeauditor/* &&     chown -R eeuser:eeuser /eeauditor\n ---> Running in 12925a57a3bc\nRemoving intermediate container 12925a57a3bc\n ---> f13f40ce1d1e\nStep 10/11 : USER eeuser\n ---> Running in 88172a1985e1\nRemoving intermediate container 88172a1985e1\n ---> 688182f2c084\nStep 11/11 : CMD     aws s3 cp s3://${SH_SCRIPTS_BUCKET}/ /eeauditor/auditors/aws/ --recursive &&     python3 eeauditor/controller.py\n ---> Running in 9dc8f40d8766\nRemoving intermediate container 9dc8f40d8766\n ---> 2f70ed42fde2\nSuccessfully built 2f70ed42fde2\nSuccessfully tagged electriceye:latest\n","stderr":"","imageSize":201147474},"repair":{"violations":[{"name":"pipUseNoCacheDir","position":{"start":38,"end":38,"columnStart":4,"columnEnd":58}}],"repairedDockerfile":"#This file is part of ElectricEye.\n#SPDX-License-Identifier: Apache-2.0\n\n#Licensed to the Apache Software Foundation (ASF) under one\n#or more contributor license agreements.  See the NOTICE file\n#distributed with this work for additional information\n#regarding copyright ownership.  The ASF licenses this file\n#to you under the Apache License, Version 2.0 (the\n#\"License\"); you may not use this file except in compliance\n#with the License.  You may obtain a copy of the License at\n\n#http://www.apache.org/licenses/LICENSE-2.0\n\n#Unless required by applicable law or agreed to in writing,\n#software distributed under the License is distributed on an\n#\"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n#KIND, either express or implied.  See the License for the\n#specific language governing permissions and limitations\n#under the License.\n\n# latest hash as of 8 AUG 2022 - Alpine 3.16.2\n# https://hub.docker.com/layers/library/alpine/3.16.2/images/sha256-1304f174557314a7ed9eddb4eab12fed12cb0cd9809e4c28f29af86979a3c870?context=explore\n# use as builder image to pull in required deps\nFROM alpine@sha256:1304f174557314a7ed9eddb4eab12fed12cb0cd9809e4c28f29af86979a3c870 AS builder\n\n# This hack is widely applied to avoid python printing issues in docker containers.\n# See: https://github.com/Docker-Hub-frolvlad/docker-alpine-python3/pull/13\nENV PYTHONUNBUFFERED=1\n\nCOPY requirements.txt /tmp/requirements.txt\n# NOTE: This will copy all application files and auditors to the container\nCOPY ./eeauditor/ /eeauditor/\n# Installing dependencies\nRUN \\\n    apk update && \\\n    apk add --no-cache python3 postgresql-libs bash nmap && \\\n    apk add --no-cache --virtual .build-deps gcc python3-dev musl-dev postgresql-dev && \\\n    python3 -m ensurepip && \\\n    pip3 install --no-cache-dir --no-cache --upgrade pip setuptools wheel && \\\n    rm -r /usr/lib/python*/ensurepip && \\\n    pip3 install -r /tmp/requirements.txt --no-cache-dir && \\\n    apk --purge del .build-deps && \\\n    rm -f /var/cache/apk/*\n\n# new stage to bring in Labels and ENV Vars\nFROM builder as electriceye\n\nENV \\\n    SH_SCRIPTS_BUCKET=SH_SCRIPTS_BUCKET \\\n    # SHODAN ENV VARS\n    SHODAN_API_KEY_PARAM=SHODAN_API_KEY_PARAM \\\n    # DISRUPTOPS ENV VARS\n    DOPS_CLIENT_ID_PARAM=DOPS_CLIENT_ID_PARAM \\\n    DOPS_API_KEY_PARAM=DOPS_API_KEY_PARAM \\\n    # POSTGRES VARS\n    POSTGRES_USERNAME=POSTGRES_USERNAME \\\n    ELECTRICEYE_POSTGRESQL_DB_NAME=ELECTRICEYE_POSTGRESQL_DB_NAME \\\n    POSTGRES_DB_ENDPOINT=POSTGRES_DB_ENDPOINT \\\n    POSTGRES_DB_PORT=POSTGRES_DB_PORT \\\n    POSTGRES_PASSWORD_SSM_PARAM_NAME=POSTGRES_PASSWORD_SSM_PARAM_NAME \\\n    # DOCUMENTDB/MONGO VARS\n    MONGODB_USERNAME=MONGODB_USERNAME \\\n    MONGODB_HOSTNAME=MONGODB_HOSTNAME \\\n    MONGODB_PASSWORD_PARAMETER=MONGODB_PASSWORD_PARAMETER\n\nLABEL \\ \n    maintainer=\"https://github.com/jonrau1\" \\\n    version=\"3.1\" \\\n    license=\"Apache-2.0\" \\\n    description=\"ElectricEye continuously monitor your AWS services for configurations that can lead to degradation of confidentiality, integrity \\ \n    or availability. All results can be exported to Security Hub, JSON, CSV, Databases, and more for further aggregation and analysis.\"\n\n# Create a System Group and User for ElectricEye so we don't run as root\nRUN \\\n    addgroup -S eeuser && \\ \n    adduser -S -G eeuser eeuser && \\\n    chown eeuser /eeauditor && \\\n    chown eeuser /eeauditor/* && \\\n    chgrp eeuser /eeauditor && \\\n    chown -R eeuser:eeuser /eeauditor/* && \\\n    chown -R eeuser:eeuser /eeauditor\n\nUSER eeuser\n\nCMD \\\n    # Upon startup we will run all checks and auditors - we grab the latest from S3\n    # in case there are updates so you can just grab the latest auditors from the\n    # bucket versus rebuilding the entire Docker image!\n    aws s3 cp s3://${SH_SCRIPTS_BUCKET}/ /eeauditor/auditors/aws/ --recursive && \\\n    # this would also be a good place to modify the `controller.py` command to output to where you wanted if you didn't want sechub\n    python3 eeauditor/controller.py"},"repairedBuild":{"startTimestamp":1672292462291,"endTimestamp":1672292533899,"error":null,"stdout":"Sending build context to Docker daemon  84.27MB\r\r\nStep 1/11 : FROM alpine@sha256:1304f174557314a7ed9eddb4eab12fed12cb0cd9809e4c28f29af86979a3c870 AS builder\n ---> 9c6f07244728\nStep 2/11 : ENV PYTHONUNBUFFERED=1\n ---> Running in d3397b329149\nRemoving intermediate container d3397b329149\n ---> e684d8b9d082\nStep 3/11 : COPY requirements.txt /tmp/requirements.txt\n ---> fca1acd02463\nStep 4/11 : COPY ./eeauditor/ /eeauditor/\n ---> 516288a30972\nStep 5/11 : RUN     apk update &&     apk add --no-cache python3 postgresql-libs bash nmap &&     apk add --no-cache --virtual .build-deps gcc python3-dev musl-dev postgresql-dev &&     python3 -m ensurepip &&     pip3 install --no-cache-dir --no-cache --upgrade pip setuptools wheel &&     rm -r /usr/lib/python*/ensurepip &&     pip3 install -r /tmp/requirements.txt --no-cache-dir &&     apk --purge del .build-deps &&     rm -f /var/cache/apk/*\n ---> Running in 038ddad2dfa4\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.16/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.16/community/x86_64/APKINDEX.tar.gz\nv3.16.3-91-gd0e167f17b [https://dl-cdn.alpinelinux.org/alpine/v3.16/main]\nv3.16.3-88-gef347edb61 [https://dl-cdn.alpinelinux.org/alpine/v3.16/community]\nOK: 17043 distinct packages available\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.16/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.16/community/x86_64/APKINDEX.tar.gz\n(1/21) Installing ncurses-terminfo-base (6.3_p20220521-r0)\n(2/21) Installing ncurses-libs (6.3_p20220521-r0)\n(3/21) Installing readline (8.1.2-r0)\n(4/21) Installing bash (5.1.16-r2)\nExecuting bash-5.1.16-r2.post-install\n(5/21) Installing libgcc (11.2.1_git20220219-r2)\n(6/21) Installing lua5.3-libs (5.3.6-r3)\n(7/21) Installing libpcap (1.10.1-r0)\n(8/21) Installing pcre (8.45-r2)\n(9/21) Installing libssh2 (1.10.0-r2)\n(10/21) Installing libstdc++ (11.2.1_git20220219-r2)\n(11/21) Installing nmap (7.92-r2)\n(12/21) Installing libpq (14.5-r0)\n(13/21) Installing libecpg (14.5-r0)\n(14/21) Installing libbz2 (1.0.8-r1)\n(15/21) Installing expat (2.5.0-r0)\n(16/21) Installing libffi (3.4.2-r1)\n(17/21) Installing gdbm (1.23-r0)\n(18/21) Installing xz-libs (5.2.5-r1)\n(19/21) Installing mpdecimal (2.5.1-r1)\n(20/21) Installing sqlite-libs (3.38.5-r0)\n(21/21) Installing python3 (3.10.9-r0)\nExecuting busybox-1.35.0-r17.trigger\nOK: 72 MiB in 35 packages\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.16/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.16/community/x86_64/APKINDEX.tar.gz\n(1/28) Upgrading musl (1.2.3-r0 -> 1.2.3-r2)\n(2/28) Installing binutils (2.38-r3)\n(3/28) Installing libgomp (11.2.1_git20220219-r2)\n(4/28) Installing libatomic (11.2.1_git20220219-r2)\n(5/28) Installing gmp (6.2.1-r2)\n(6/28) Installing isl22 (0.22-r0)\n(7/28) Installing mpfr4 (4.1.0-r0)\n(8/28) Installing mpc1 (1.2.1-r0)\n(9/28) Installing gcc (11.2.1_git20220219-r2)\n(10/28) Installing pkgconf (1.8.0-r1)\n(11/28) Upgrading libcrypto1.1 (1.1.1q-r0 -> 1.1.1s-r0)\n(12/28) Upgrading libssl1.1 (1.1.1q-r0 -> 1.1.1s-r0)\n(13/28) Installing python3-dev (3.10.9-r0)\n(14/28) Installing musl-dev (1.2.3-r2)\n(15/28) Installing openssl-dev (1.1.1s-r0)\n(16/28) Installing libpq-dev (14.5-r0)\n(17/28) Installing libecpg-dev (14.5-r0)\n(18/28) Installing libxml2 (2.9.14-r2)\n(19/28) Installing llvm13-libs (13.0.1-r2)\n(20/28) Installing clang-libs (13.0.1-r1)\n(21/28) Installing clang (13.0.1-r1)\n(22/28) Installing icu-data-en (71.1-r2)\nExecuting icu-data-en-71.1-r2.post-install\n\u001b[91m*\n* If you need ICU with non-English locales and legacy charset support, install\n* package icu-data-full.\n*\n\u001b[0m(23/28) Installing icu-libs (71.1-r2)\n(24/28) Installing icu (71.1-r2)\n(25/28) Installing icu-dev (71.1-r2)\n(26/28) Installing llvm13 (13.0.1-r2)\n(27/28) Installing postgresql14-dev (14.5-r0)\n(28/28) Installing .build-deps (20221229.054115)\nExecuting busybox-1.35.0-r17.trigger\nOK: 529 MiB in 60 packages\nLooking in links: /tmp/tmp_fqvekrt\nProcessing /tmp/tmp_fqvekrt/setuptools-65.5.0-py3-none-any.whl\nProcessing /tmp/tmp_fqvekrt/pip-22.3.1-py3-none-any.whl\nInstalling collected packages: setuptools, pip\nSuccessfully installed pip-22.3.1 setuptools-65.5.0\n\u001b[91mWARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv\n\u001b[0mRequirement already satisfied: pip in /usr/lib/python3.10/site-packages (22.3.1)\nRequirement already satisfied: setuptools in /usr/lib/python3.10/site-packages (65.5.0)\nCollecting setuptools\n  Downloading setuptools-65.6.3-py3-none-any.whl (1.2 MB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 1.2/1.2 MB 95.1 MB/s eta 0:00:00\nCollecting wheel\n  Downloading wheel-0.38.4-py3-none-any.whl (36 kB)\nInstalling collected packages: wheel, setuptools\n  Attempting uninstall: setuptools\n    Found existing installation: setuptools 65.5.0\n    Uninstalling setuptools-65.5.0:\n      Successfully uninstalled setuptools-65.5.0\nSuccessfully installed setuptools-65.6.3 wheel-0.38.4\n\u001b[91mWARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv\n\u001b[0mCollecting awscli\n  Downloading awscli-1.27.39-py3-none-any.whl (4.0 MB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 4.0/4.0 MB 111.6 MB/s eta 0:00:00\nCollecting boto3\n  Downloading boto3-1.26.39-py3-none-any.whl (132 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 132.7/132.7 kB 212.8 MB/s eta 0:00:00\nCollecting click\n  Downloading click-8.1.3-py3-none-any.whl (96 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 96.6/96.6 kB 193.1 MB/s eta 0:00:00\nCollecting detect-secrets\n  Downloading detect_secrets-1.4.0-py3-none-any.whl (116 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 116.3/116.3 kB 197.4 MB/s eta 0:00:00\nCollecting pluginbase\n  Downloading pluginbase-1.0.1.tar.gz (43 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 43.6/43.6 kB 175.7 MB/s eta 0:00:00\n  Preparing metadata (setup.py): started\n  Preparing metadata (setup.py): finished with status 'done'\nCollecting psycopg2-binary\n  Downloading psycopg2_binary-2.9.5-cp310-cp310-musllinux_1_1_x86_64.whl (1.9 MB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 1.9/1.9 MB 129.7 MB/s eta 0:00:00\nCollecting pymongo\n  Downloading pymongo-4.3.3.tar.gz (814 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 814.2/814.2 kB 159.4 MB/s eta 0:00:00\n  Preparing metadata (setup.py): started\n  Preparing metadata (setup.py): finished with status 'done'\nCollecting python3-nmap\n  Downloading python3_nmap-1.6.0-py3-none-any.whl (26 kB)\nCollecting colorama<0.4.5,>=0.2.5\n  Downloading colorama-0.4.4-py2.py3-none-any.whl (16 kB)\nCollecting PyYAML<5.5,>=3.10\n  Downloading PyYAML-5.4.1.tar.gz (175 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 175.1/175.1 kB 232.9 MB/s eta 0:00:00\n  Installing build dependencies: started\n  Installing build dependencies: finished with status 'done'\n  Getting requirements to build wheel: started\n  Getting requirements to build wheel: finished with status 'done'\n  Preparing metadata (pyproject.toml): started\n  Preparing metadata (pyproject.toml): finished with status 'done'\nCollecting s3transfer<0.7.0,>=0.6.0\n  Downloading s3transfer-0.6.0-py3-none-any.whl (79 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 79.6/79.6 kB 71.5 MB/s eta 0:00:00\nCollecting botocore==1.29.39\n  Downloading botocore-1.29.39-py3-none-any.whl (10.3 MB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 10.3/10.3 MB 111.3 MB/s eta 0:00:00\nCollecting docutils<0.17,>=0.10\n  Downloading docutils-0.16-py2.py3-none-any.whl (548 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 548.2/548.2 kB 177.4 MB/s eta 0:00:00\nCollecting rsa<4.8,>=3.1.2\n  Downloading rsa-4.7.2-py3-none-any.whl (34 kB)\nCollecting urllib3<1.27,>=1.25.4\n  Downloading urllib3-1.26.13-py2.py3-none-any.whl (140 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 140.6/140.6 kB 225.0 MB/s eta 0:00:00\nCollecting python-dateutil<3.0.0,>=2.1\n  Downloading python_dateutil-2.8.2-py2.py3-none-any.whl (247 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 247.7/247.7 kB 69.3 MB/s eta 0:00:00\nCollecting jmespath<2.0.0,>=0.7.1\n  Downloading jmespath-1.0.1-py3-none-any.whl (20 kB)\nCollecting requests\n  Downloading requests-2.28.1-py3-none-any.whl (62 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 62.8/62.8 kB 178.1 MB/s eta 0:00:00\nCollecting dnspython<3.0.0,>=1.16.0\n  Downloading dnspython-2.2.1-py3-none-any.whl (269 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 269.1/269.1 kB 211.0 MB/s eta 0:00:00\nCollecting simplejson\n  Downloading simplejson-3.18.0-cp310-cp310-musllinux_1_1_x86_64.whl (142 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 142.0/142.0 kB 224.2 MB/s eta 0:00:00\nCollecting pyasn1>=0.1.3\n  Downloading pyasn1-0.4.8-py2.py3-none-any.whl (77 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 77.1/77.1 kB 67.0 MB/s eta 0:00:00\nCollecting idna<4,>=2.5\n  Downloading idna-3.4-py3-none-any.whl (61 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 61.5/61.5 kB 184.7 MB/s eta 0:00:00\nCollecting charset-normalizer<3,>=2\n  Downloading charset_normalizer-2.1.1-py3-none-any.whl (39 kB)\nCollecting certifi>=2017.4.17\n  Downloading certifi-2022.12.7-py3-none-any.whl (155 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 155.3/155.3 kB 240.2 MB/s eta 0:00:00\nCollecting six>=1.5\n  Downloading six-1.16.0-py2.py3-none-any.whl (11 kB)\nBuilding wheels for collected packages: pluginbase, pymongo, PyYAML\n  Building wheel for pluginbase (setup.py): started\n  Building wheel for pluginbase (setup.py): finished with status 'done'\n  Created wheel for pluginbase: filename=pluginbase-1.0.1-py3-none-any.whl size=7797 sha256=ab9afad8c7be5b3a049eea9eb62b29f8a0509620ac14c53f17f192570f285f6c\n  Stored in directory: /tmp/pip-ephem-wheel-cache-2_k1wu3l/wheels/c8/0d/ec/32df6e228294449d38912d44c717519496a19aaca0eb142dd4\n  Building wheel for pymongo (setup.py): started\n  Building wheel for pymongo (setup.py): finished with status 'done'\n  Created wheel for pymongo: filename=pymongo-4.3.3-cp310-cp310-linux_x86_64.whl size=490166 sha256=0bb9e5de36a1f482910f7c92aadcc13e014916d80b47ce222c4071e050cb6b88\n  Stored in directory: /tmp/pip-ephem-wheel-cache-2_k1wu3l/wheels/bc/67/a8/221bab1038a04f2f53ece550fcd125d567d7abc80fa9a38e35\n  Building wheel for PyYAML (pyproject.toml): started\n  Building wheel for PyYAML (pyproject.toml): finished with status 'done'\n  Created wheel for PyYAML: filename=PyYAML-5.4.1-cp310-cp310-linux_x86_64.whl size=45658 sha256=3f59b9119d121857e307eec0f14eb3d993399929a899ba0ddfe9a95445b7fc96\n  Stored in directory: /tmp/pip-ephem-wheel-cache-2_k1wu3l/wheels/10/3f/c1/6feec52270653969575b83de934b04be56d7a9e961be5041ea\nSuccessfully built pluginbase pymongo PyYAML\nInstalling collected packages: pyasn1, pluginbase, urllib3, six, simplejson, rsa, PyYAML, psycopg2-binary, jmespath, idna, docutils, dnspython, colorama, click, charset-normalizer, certifi, requests, python3-nmap, python-dateutil, pymongo, detect-secrets, botocore, s3transfer, boto3, awscli\nSuccessfully installed PyYAML-5.4.1 awscli-1.27.39 boto3-1.26.39 botocore-1.29.39 certifi-2022.12.7 charset-normalizer-2.1.1 click-8.1.3 colorama-0.4.4 detect-secrets-1.4.0 dnspython-2.2.1 docutils-0.16 idna-3.4 jmespath-1.0.1 pluginbase-1.0.1 psycopg2-binary-2.9.5 pyasn1-0.4.8 pymongo-4.3.3 python-dateutil-2.8.2 python3-nmap-1.6.0 requests-2.28.1 rsa-4.7.2 s3transfer-0.6.0 simplejson-3.18.0 six-1.16.0 urllib3-1.26.13\n\u001b[91mWARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv\n\u001b[0m(1/25) Purging .build-deps (20221229.054115)\n(2/25) Purging gcc (11.2.1_git20220219-r2)\n(3/25) Purging binutils (2.38-r3)\n(4/25) Purging libatomic (11.2.1_git20220219-r2)\n(5/25) Purging libgomp (11.2.1_git20220219-r2)\n(6/25) Purging python3-dev (3.10.9-r0)\n(7/25) Purging musl-dev (1.2.3-r2)\n(8/25) Purging postgresql14-dev (14.5-r0)\n(9/25) Purging libecpg-dev (14.5-r0)\n(10/25) Purging libpq-dev (14.5-r0)\n(11/25) Purging clang (13.0.1-r1)\n(12/25) Purging icu-dev (71.1-r2)\n(13/25) Purging llvm13 (13.0.1-r2)\n(14/25) Purging mpc1 (1.2.1-r0)\n(15/25) Purging mpfr4 (4.1.0-r0)\n(16/25) Purging isl22 (0.22-r0)\n(17/25) Purging gmp (6.2.1-r2)\n(18/25) Purging openssl-dev (1.1.1s-r0)\n(19/25) Purging pkgconf (1.8.0-r1)\n(20/25) Purging clang-libs (13.0.1-r1)\n(21/25) Purging llvm13-libs (13.0.1-r2)\n(22/25) Purging libxml2 (2.9.14-r2)\n(23/25) Purging icu (71.1-r2)\n(24/25) Purging icu-libs (71.1-r2)\n(25/25) Purging icu-data-en (71.1-r2)\nExecuting busybox-1.35.0-r17.trigger\nOK: 72 MiB in 35 packages\nRemoving intermediate container 038ddad2dfa4\n ---> bd8298b4b7e5\nStep 6/11 : FROM builder as electriceye\n ---> bd8298b4b7e5\nStep 7/11 : ENV     SH_SCRIPTS_BUCKET=SH_SCRIPTS_BUCKET     SHODAN_API_KEY_PARAM=SHODAN_API_KEY_PARAM     DOPS_CLIENT_ID_PARAM=DOPS_CLIENT_ID_PARAM     DOPS_API_KEY_PARAM=DOPS_API_KEY_PARAM     POSTGRES_USERNAME=POSTGRES_USERNAME     ELECTRICEYE_POSTGRESQL_DB_NAME=ELECTRICEYE_POSTGRESQL_DB_NAME     POSTGRES_DB_ENDPOINT=POSTGRES_DB_ENDPOINT     POSTGRES_DB_PORT=POSTGRES_DB_PORT     POSTGRES_PASSWORD_SSM_PARAM_NAME=POSTGRES_PASSWORD_SSM_PARAM_NAME     MONGODB_USERNAME=MONGODB_USERNAME     MONGODB_HOSTNAME=MONGODB_HOSTNAME     MONGODB_PASSWORD_PARAMETER=MONGODB_PASSWORD_PARAMETER\n ---> Running in 131d481d0212\nRemoving intermediate container 131d481d0212\n ---> 391aa467ae2b\nStep 8/11 : LABEL     maintainer=\"https://github.com/jonrau1\"     version=\"3.1\"     license=\"Apache-2.0\"     description=\"ElectricEye continuously monitor your AWS services for configurations that can lead to degradation of confidentiality, integrity     or availability. All results can be exported to Security Hub, JSON, CSV, Databases, and more for further aggregation and analysis.\"\n ---> Running in b2fe14973001\nRemoving intermediate container b2fe14973001\n ---> 6d9bb6f73dfb\nStep 9/11 : RUN     addgroup -S eeuser &&     adduser -S -G eeuser eeuser &&     chown eeuser /eeauditor &&     chown eeuser /eeauditor/* &&     chgrp eeuser /eeauditor &&     chown -R eeuser:eeuser /eeauditor/* &&     chown -R eeuser:eeuser /eeauditor\n ---> Running in b5b246d3452c\nRemoving intermediate container b5b246d3452c\n ---> 3b4579b66e71\nStep 10/11 : USER eeuser\n ---> Running in b5572af8620c\nRemoving intermediate container b5572af8620c\n ---> 3ce8d0d1fb7d\nStep 11/11 : CMD     aws s3 cp s3://${SH_SCRIPTS_BUCKET}/ /eeauditor/auditors/aws/ --recursive &&     python3 eeauditor/controller.py\n ---> Running in f919452b46f4\nRemoving intermediate container f919452b46f4\n ---> f8c527431503\nSuccessfully built f8c527431503\nSuccessfully tagged electriceye:latest\n","stderr":"","imageSize":201147475},"endTime":1672292534426}