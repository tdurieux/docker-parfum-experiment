{"repository":"https://github.com/brave-intl/bat-go","dockerfilePath":"Dockerfile","startTime":1672798116292,"clone":{"stdout":"","stderr":"Cloning into '/tmp/dinghy-analysis/brave-intl/bat-go'...\n","error":null,"commit":"88d57e1f1bd93981a47a84ed48c01810f2836b94"},"originalBuild":{"startTimestamp":1672798117370,"endTimestamp":1672798304252,"error":null,"stdout":"Sending build context to Docker daemon  4.491MB\r\r\nStep 1/27 : FROM golang:1.18-alpine as builder\n1.18-alpine: Pulling from library/golang\nc158987b0551: Already exists\n019cfb932eb0: Pulling fs layer\n4e0e94741593: Pulling fs layer\n1ba1ea060658: Pulling fs layer\n019cfb932eb0: Verifying Checksum\n019cfb932eb0: Download complete\n1ba1ea060658: Verifying Checksum\n1ba1ea060658: Download complete\n019cfb932eb0: Pull complete\n4e0e94741593: Download complete\n4e0e94741593: Pull complete\n1ba1ea060658: Pull complete\nDigest: sha256:c2bb8281641f39a32e01854ae6b5fea45870f6f4c0c04365eadc0be596675456\nStatus: Downloaded newer image for golang:1.18-alpine\n ---> f37f1bcb329f\nStep 2/27 : RUN apk update\n ---> Running in f7881aa72e24\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/community/x86_64/APKINDEX.tar.gz\nv3.17.0-320-g38723e0931 [https://dl-cdn.alpinelinux.org/alpine/v3.17/main]\nv3.17.0-326-g3ec324c127 [https://dl-cdn.alpinelinux.org/alpine/v3.17/community]\nOK: 17814 distinct packages available\nRemoving intermediate container f7881aa72e24\n ---> 5470c566ba1f\nStep 3/27 : RUN apk add -U --no-cache ca-certificates && update-ca-certificates\n ---> Running in ddac1917098a\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/community/x86_64/APKINDEX.tar.gz\nOK: 8 MiB in 16 packages\n\u001b[91mWARNING: ca-certificates.crt does not contain exactly one certificate or CRL: skipping\n\u001b[0mRemoving intermediate container ddac1917098a\n ---> cdf3bd68730c\nStep 4/27 : RUN apk add make\n ---> Running in d5e72fdd068a\n(1/1) Installing make (4.3-r1)\nExecuting busybox-1.35.0-r29.trigger\nOK: 8 MiB in 17 packages\nRemoving intermediate container d5e72fdd068a\n ---> dc4967deda26\nStep 5/27 : RUN apk add build-base\n ---> Running in ddf474fd93ec\n(1/19) Installing libgcc (12.2.1_git20220924-r4)\n(2/19) Installing libstdc++ (12.2.1_git20220924-r4)\n(3/19) Installing binutils (2.39-r2)\n(4/19) Installing libmagic (5.43-r0)\n(5/19) Installing file (5.43-r0)\n(6/19) Installing libgomp (12.2.1_git20220924-r4)\n(7/19) Installing libatomic (12.2.1_git20220924-r4)\n(8/19) Installing gmp (6.2.1-r2)\n(9/19) Installing isl25 (0.25-r0)\n(10/19) Installing mpfr4 (4.1.0-r0)\n(11/19) Installing mpc1 (1.2.1-r1)\n(12/19) Installing gcc (12.2.1_git20220924-r4)\n(13/19) Installing libstdc++-dev (12.2.1_git20220924-r4)\n(14/19) Installing musl-dev (1.2.3-r4)\n(15/19) Installing libc-dev (0.7.2-r3)\n(16/19) Installing g++ (12.2.1_git20220924-r4)\n(17/19) Installing fortify-headers (1.1-r1)\n(18/19) Installing patch (2.7.6-r8)\n(19/19) Installing build-base (0.5-r3)\nExecuting busybox-1.35.0-r29.trigger\nOK: 245 MiB in 36 packages\nRemoving intermediate container ddf474fd93ec\n ---> 9065a9700c9b\nStep 6/27 : RUN apk add git\n ---> Running in 92baf07fe7ab\n(1/6) Installing brotli-libs (1.0.9-r9)\n(2/6) Installing nghttp2-libs (1.51.0-r0)\n(3/6) Installing libcurl (7.87.0-r0)\n(4/6) Installing libexpat (2.5.0-r0)\n(5/6) Installing pcre2 (10.42-r0)\n(6/6) Installing git (2.38.2-r0)\nExecuting busybox-1.35.0-r29.trigger\nOK: 253 MiB in 42 packages\nRemoving intermediate container 92baf07fe7ab\n ---> 8939bbfefff7\nStep 7/27 : RUN apk add bash\n ---> Running in a0beac3d2336\n(1/4) Installing ncurses-terminfo-base (6.3_p20221119-r0)\n(2/4) Installing ncurses-libs (6.3_p20221119-r0)\n(3/4) Installing readline (8.2.0-r0)\n(4/4) Installing bash (5.2.15-r0)\nExecuting bash-5.2.15-r0.post-install\nExecuting busybox-1.35.0-r29.trigger\nOK: 255 MiB in 46 packages\nRemoving intermediate container a0beac3d2336\n ---> f9d44f9e3c62\nStep 8/27 : ARG VERSION\n ---> Running in d1cd9e4d9c34\nRemoving intermediate container d1cd9e4d9c34\n ---> 10c71e0df208\nStep 9/27 : ARG BUILD_TIME\n ---> Running in db99b77dd082\nRemoving intermediate container db99b77dd082\n ---> 9e541abfde63\nStep 10/27 : ARG COMMIT\n ---> Running in f0677622089c\nRemoving intermediate container f0677622089c\n ---> 677c9bdf50a6\nStep 11/27 : WORKDIR /src\n ---> Running in 67a37d52c199\nRemoving intermediate container 67a37d52c199\n ---> e14c164c7097\nStep 12/27 : COPY . ./\n ---> ddfdb949e6a2\nStep 13/27 : RUN chown -R nobody:nobody /src/\n ---> Running in e5470dfd8546\nRemoving intermediate container e5470dfd8546\n ---> 7b50652a2755\nStep 14/27 : RUN mkdir /.cache\n ---> Running in 1c9b95824c89\nRemoving intermediate container 1c9b95824c89\n ---> 0982dadd5771\nStep 15/27 : RUN chown -R nobody:nobody /.cache\n ---> Running in e068b6461868\nRemoving intermediate container e068b6461868\n ---> 3c03f2b49f5a\nStep 16/27 : USER nobody\n ---> Running in 2a28e62b0caa\nRemoving intermediate container 2a28e62b0caa\n ---> a868eafc1ff7\nStep 17/27 : RUN cd main && go mod download\n ---> Running in df47c6998185\nRemoving intermediate container df47c6998185\n ---> 3e4b438569c4\nStep 18/27 : RUN cd main && CGO_ENABLED=0 GOOS=linux go build     -ldflags \"-w -s -X main.version=${VERSION} -X main.buildTime=${BUILD_TIME} -X main.commit=${COMMIT}\"     -o bat-go main.go\n ---> Running in 51123604758c\nRemoving intermediate container 51123604758c\n ---> ad4caa07e181\nStep 19/27 : FROM alpine:3.15 as base\n3.15: Pulling from library/alpine\n9621f1afde84: Pulling fs layer\n9621f1afde84: Verifying Checksum\n9621f1afde84: Download complete\n9621f1afde84: Pull complete\nDigest: sha256:cf34c62ee8eb3fe8aa24c1fab45d7e9d12768d945c3f5a6fd6a63d901e898479\nStatus: Downloaded newer image for alpine:3.15\n ---> c4fc93816858\nStep 20/27 : COPY --from=builder /etc/ssl/certs/ca-certificates.crt /etc/ssl/certs/\n ---> 5a070319e404\nStep 21/27 : COPY --from=builder /src/main/bat-go /bin/\n ---> 4c3d32df8a8e\nStep 22/27 : FROM base as payments\n ---> 4c3d32df8a8e\nStep 23/27 : CMD [\"bat-go\", \"serve\", \"nitro\", \"inside-enclave\", \"--log-address\", \"vm(3):2345\", \"--egress-address\", \"vm(3):1234\", \"--upstream-url\", \"http://0.0.0.0:8080\", \"--address\", \":8080\"]\n ---> Running in e7d802b8fadd\nRemoving intermediate container e7d802b8fadd\n ---> 635f24a094f2\nStep 24/27 : FROM base as artifact\n ---> 4c3d32df8a8e\nStep 25/27 : COPY --from=builder /src/migrations/ /migrations/\n ---> 477833ff6b68\nStep 26/27 : EXPOSE 3333\n ---> Running in 2a6b0a3c74f4\nRemoving intermediate container 2a6b0a3c74f4\n ---> 8a1317a6f331\nStep 27/27 : CMD [\"bat-go\", \"serve\", \"grant\", \"--enable-job-workers\", \"true\"]\n ---> Running in 595e345a0de1\nRemoving intermediate container 595e345a0de1\n ---> 30829a6a5e47\nSuccessfully built 30829a6a5e47\nSuccessfully tagged bat-go:latest\n","stderr":"","imageSize":46817244},"repair":{"violations":[{"name":"apkAddUseNoCache","position":{"start":6,"end":6,"columnStart":4,"columnEnd":16}},{"name":"apkAddUseNoCache","position":{"start":7,"end":7,"columnStart":4,"columnEnd":22}},{"name":"apkAddUseNoCache","position":{"start":8,"end":8,"columnStart":4,"columnEnd":15}},{"name":"apkAddUseNoCache","position":{"start":9,"end":9,"columnStart":4,"columnEnd":16}}],"repairedDockerfile":"FROM golang:1.18-alpine as builder\n\n\n# put certs in builder image\nRUN apk update\nRUN apk add -U --no-cache ca-certificates && update-ca-certificates\nRUN apk add --no-cache make\nRUN apk add --no-cache build-base\nRUN apk add --no-cache git\nRUN apk add --no-cache bash\n\nARG VERSION\nARG BUILD_TIME\nARG COMMIT\n\nWORKDIR /src\nCOPY . ./\nRUN chown -R nobody:nobody /src/\nRUN mkdir /.cache\nRUN chown -R nobody:nobody /.cache\n\nUSER nobody\nRUN cd main && go mod download\n\nRUN cd main && CGO_ENABLED=0 GOOS=linux go build \\\n    -ldflags \"-w -s -X main.version=${VERSION} -X main.buildTime=${BUILD_TIME} -X main.commit=${COMMIT}\" \\\n    -o bat-go main.go\n\nFROM alpine:3.15 as base\n# put certs in artifact from builder\nCOPY --from=builder /etc/ssl/certs/ca-certificates.crt /etc/ssl/certs/\nCOPY --from=builder /src/main/bat-go /bin/\n\nFROM base as payments\nCMD [\"bat-go\", \"serve\", \"nitro\", \"inside-enclave\", \"--log-address\", \"vm(3):2345\", \"--egress-address\", \"vm(3):1234\", \"--upstream-url\", \"http://0.0.0.0:8080\", \"--address\", \":8080\"]\n\nFROM base as artifact\nCOPY --from=builder /src/migrations/ /migrations/\nEXPOSE 3333\nCMD [\"bat-go\", \"serve\", \"grant\", \"--enable-job-workers\", \"true\"]\n\n"},"repairedBuild":{"startTimestamp":1672798304527,"endTimestamp":1672798458733,"error":null,"stdout":"Sending build context to Docker daemon  4.491MB\r\r\nStep 1/27 : FROM golang:1.18-alpine as builder\n ---> f37f1bcb329f\nStep 2/27 : RUN apk update\n ---> Running in 80c7c716ad86\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/community/x86_64/APKINDEX.tar.gz\nv3.17.0-320-g38723e0931 [https://dl-cdn.alpinelinux.org/alpine/v3.17/main]\nv3.17.0-326-g3ec324c127 [https://dl-cdn.alpinelinux.org/alpine/v3.17/community]\nOK: 17814 distinct packages available\nRemoving intermediate container 80c7c716ad86\n ---> dec278e3c526\nStep 3/27 : RUN apk add -U --no-cache ca-certificates && update-ca-certificates\n ---> Running in f6a1aab6ce98\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/community/x86_64/APKINDEX.tar.gz\nOK: 8 MiB in 16 packages\n\u001b[91mWARNING: ca-certificates.crt does not contain exactly one certificate or CRL: skipping\n\u001b[0mRemoving intermediate container f6a1aab6ce98\n ---> ebad85abfc45\nStep 4/27 : RUN apk add --no-cache make\n ---> Running in 0b319301cfd5\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/community/x86_64/APKINDEX.tar.gz\n(1/1) Installing make (4.3-r1)\nExecuting busybox-1.35.0-r29.trigger\nOK: 8 MiB in 17 packages\nRemoving intermediate container 0b319301cfd5\n ---> bc026afa7528\nStep 5/27 : RUN apk add --no-cache build-base\n ---> Running in 1bef1a9243b1\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/community/x86_64/APKINDEX.tar.gz\n(1/19) Installing libgcc (12.2.1_git20220924-r4)\n(2/19) Installing libstdc++ (12.2.1_git20220924-r4)\n(3/19) Installing binutils (2.39-r2)\n(4/19) Installing libmagic (5.43-r0)\n(5/19) Installing file (5.43-r0)\n(6/19) Installing libgomp (12.2.1_git20220924-r4)\n(7/19) Installing libatomic (12.2.1_git20220924-r4)\n(8/19) Installing gmp (6.2.1-r2)\n(9/19) Installing isl25 (0.25-r0)\n(10/19) Installing mpfr4 (4.1.0-r0)\n(11/19) Installing mpc1 (1.2.1-r1)\n(12/19) Installing gcc (12.2.1_git20220924-r4)\n(13/19) Installing libstdc++-dev (12.2.1_git20220924-r4)\n(14/19) Installing musl-dev (1.2.3-r4)\n(15/19) Installing libc-dev (0.7.2-r3)\n(16/19) Installing g++ (12.2.1_git20220924-r4)\n(17/19) Installing fortify-headers (1.1-r1)\n(18/19) Installing patch (2.7.6-r8)\n(19/19) Installing build-base (0.5-r3)\nExecuting busybox-1.35.0-r29.trigger\nOK: 245 MiB in 36 packages\nRemoving intermediate container 1bef1a9243b1\n ---> b1318e076f7e\nStep 6/27 : RUN apk add --no-cache git\n ---> Running in 4d37223f9fb9\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/community/x86_64/APKINDEX.tar.gz\n(1/6) Installing brotli-libs (1.0.9-r9)\n(2/6) Installing nghttp2-libs (1.51.0-r0)\n(3/6) Installing libcurl (7.87.0-r0)\n(4/6) Installing libexpat (2.5.0-r0)\n(5/6) Installing pcre2 (10.42-r0)\n(6/6) Installing git (2.38.2-r0)\nExecuting busybox-1.35.0-r29.trigger\nOK: 253 MiB in 42 packages\nRemoving intermediate container 4d37223f9fb9\n ---> 087ada23b81b\nStep 7/27 : RUN apk add --no-cache bash\n ---> Running in 33b8308b312d\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/community/x86_64/APKINDEX.tar.gz\n(1/4) Installing ncurses-terminfo-base (6.3_p20221119-r0)\n(2/4) Installing ncurses-libs (6.3_p20221119-r0)\n(3/4) Installing readline (8.2.0-r0)\n(4/4) Installing bash (5.2.15-r0)\nExecuting bash-5.2.15-r0.post-install\nExecuting busybox-1.35.0-r29.trigger\nOK: 255 MiB in 46 packages\nRemoving intermediate container 33b8308b312d\n ---> ce39c8853614\nStep 8/27 : ARG VERSION\n ---> Running in a7c49f471cac\nRemoving intermediate container a7c49f471cac\n ---> 71af293b053b\nStep 9/27 : ARG BUILD_TIME\n ---> Running in ee5f9f43be55\nRemoving intermediate container ee5f9f43be55\n ---> 888ead7a2e0f\nStep 10/27 : ARG COMMIT\n ---> Running in fd8d18b0fdfc\nRemoving intermediate container fd8d18b0fdfc\n ---> f23ae152b86c\nStep 11/27 : WORKDIR /src\n ---> Running in 7689bdc15c73\nRemoving intermediate container 7689bdc15c73\n ---> 422e2c06106d\nStep 12/27 : COPY . ./\n ---> d9ef8032d097\nStep 13/27 : RUN chown -R nobody:nobody /src/\n ---> Running in b82053f89faa\nRemoving intermediate container b82053f89faa\n ---> abecae81fac8\nStep 14/27 : RUN mkdir /.cache\n ---> Running in cb639bc7e609\nRemoving intermediate container cb639bc7e609\n ---> 7aff78722f7a\nStep 15/27 : RUN chown -R nobody:nobody /.cache\n ---> Running in 78d629592cdf\nRemoving intermediate container 78d629592cdf\n ---> 1036c7276dea\nStep 16/27 : USER nobody\n ---> Running in ffca905785f2\nRemoving intermediate container ffca905785f2\n ---> d33fda965c82\nStep 17/27 : RUN cd main && go mod download\n ---> Running in bc29cdee0ad8\nRemoving intermediate container bc29cdee0ad8\n ---> 00f6d21c7662\nStep 18/27 : RUN cd main && CGO_ENABLED=0 GOOS=linux go build     -ldflags \"-w -s -X main.version=${VERSION} -X main.buildTime=${BUILD_TIME} -X main.commit=${COMMIT}\"     -o bat-go main.go\n ---> Running in dabb5880d0dd\nRemoving intermediate container dabb5880d0dd\n ---> a02d2ed9761b\nStep 19/27 : FROM alpine:3.15 as base\n ---> c4fc93816858\nStep 20/27 : COPY --from=builder /etc/ssl/certs/ca-certificates.crt /etc/ssl/certs/\n ---> 7afce648cd16\nStep 21/27 : COPY --from=builder /src/main/bat-go /bin/\n ---> 97229d1e30f9\nStep 22/27 : FROM base as payments\n ---> 97229d1e30f9\nStep 23/27 : CMD [\"bat-go\", \"serve\", \"nitro\", \"inside-enclave\", \"--log-address\", \"vm(3):2345\", \"--egress-address\", \"vm(3):1234\", \"--upstream-url\", \"http://0.0.0.0:8080\", \"--address\", \":8080\"]\n ---> Running in 771e31d22aba\nRemoving intermediate container 771e31d22aba\n ---> 9254726d6ecd\nStep 24/27 : FROM base as artifact\n ---> 97229d1e30f9\nStep 25/27 : COPY --from=builder /src/migrations/ /migrations/\n ---> e9a0f6d53faa\nStep 26/27 : EXPOSE 3333\n ---> Running in ae572f4dc461\nRemoving intermediate container ae572f4dc461\n ---> 7fa1d630bd58\nStep 27/27 : CMD [\"bat-go\", \"serve\", \"grant\", \"--enable-job-workers\", \"true\"]\n ---> Running in e3f276a3fb7f\nRemoving intermediate container e3f276a3fb7f\n ---> 22116baa1e1a\nSuccessfully built 22116baa1e1a\nSuccessfully tagged bat-go:latest\n","stderr":"","imageSize":46817244},"endTime":1672798459099}