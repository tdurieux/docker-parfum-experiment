{"repository":"https://github.com/pagarme/tldr","dockerfilePath":"Dockerfile","startTime":1672025814161,"clone":{"stdout":"","stderr":"Cloning into '/tmp/dinghy-analysis/pagarme/tldr'...\n","error":null,"commit":"0d308fa634f603047a9b88c2d1b9d549e3f883b8"},"originalBuild":{"startTimestamp":1672025815130,"endTimestamp":1672025874390,"error":null,"stdout":"Sending build context to Docker daemon  1.229MB\r\r\nStep 1/24 : FROM pagarme/docker-nodejs:8.9\n8.9: Pulling from pagarme/docker-nodejs\n605ce1bd3f31: Already exists\n79b85b1676b5: Already exists\n20865485d0c2: Already exists\nbc50b9e3ef44: Pulling fs layer\nbc144a15ec25: Pulling fs layer\nfd7995f075e4: Pulling fs layer\n05da1068f32e: Pulling fs layer\n05da1068f32e: Waiting\nfd7995f075e4: Verifying Checksum\nfd7995f075e4: Download complete\nbc50b9e3ef44: Verifying Checksum\nbc50b9e3ef44: Download complete\nbc144a15ec25: Verifying Checksum\nbc144a15ec25: Download complete\nbc50b9e3ef44: Pull complete\n05da1068f32e: Verifying Checksum\n05da1068f32e: Download complete\nbc144a15ec25: Pull complete\nfd7995f075e4: Pull complete\n05da1068f32e: Pull complete\nDigest: sha256:7a3bc722e2009107ee5deabe51c5ad0d10d2de219e54c62c69908323b0d3dcc4\nStatus: Downloaded newer image for pagarme/docker-nodejs:8.9\n ---> a951586f6b7c\nStep 2/24 : ARG NODE_ENV\n ---> Running in cce6bb589312\nRemoving intermediate container cce6bb589312\n ---> 9512082e3e8b\nStep 3/24 : ARG DOT_ENV\n ---> Running in b94bd3ffafec\nRemoving intermediate container b94bd3ffafec\n ---> ae4f84f88a23\nStep 4/24 : COPY ${DOT_ENV} /tldr/${DOT_ENV}\n ---> 09676bb013e0\nStep 5/24 : COPY newrelic.js /tldr\n ---> ef1930fe0d36\nStep 6/24 : COPY package.json /tldr\n ---> 8d34574cf07f\nStep 7/24 : COPY scripts/start_server.sh /tldr\n ---> 683322fbef36\nStep 8/24 : COPY scripts/start_worker.sh /tldr\n ---> 4288dad6e34b\nStep 9/24 : COPY yarn.lock /tldr\n ---> 9b09be961990\nStep 10/24 : COPY src /tldr\n ---> 65a90e33bcbc\nStep 11/24 : COPY views /tldr/views\n ---> 2a242db35d84\nStep 12/24 : WORKDIR /tldr\n ---> Running in 7dd42cd62df5\nRemoving intermediate container 7dd42cd62df5\n ---> 5e200dc53c18\nStep 13/24 : RUN apk --update add --no-cache python make g++\n ---> Running in 84676f7a55c0\nfetch http://dl-cdn.alpinelinux.org/alpine/v3.6/main/x86_64/APKINDEX.tar.gz\nfetch http://dl-cdn.alpinelinux.org/alpine/v3.6/main/x86_64/APKINDEX.tar.gz\nfetch http://dl-cdn.alpinelinux.org/alpine/v3.6/community/x86_64/APKINDEX.tar.gz\nfetch http://dl-cdn.alpinelinux.org/alpine/v3.6/community/x86_64/APKINDEX.tar.gz\n(1/26) Upgrading musl (1.1.16-r14 -> 1.1.16-r15)\n(2/26) Installing binutils-libs (2.30-r1)\n(3/26) Installing binutils (2.30-r1)\n(4/26) Installing gmp (6.1.2-r0)\n(5/26) Installing isl (0.17.1-r0)\n(6/26) Installing libgomp (6.3.0-r4)\n(7/26) Installing libatomic (6.3.0-r4)\n(8/26) Installing pkgconf (1.3.7-r0)\n(9/26) Installing mpfr3 (3.1.5-r0)\n(10/26) Installing mpc1 (1.0.3-r0)\n(11/26) Installing gcc (6.3.0-r4)\n(12/26) Installing musl-dev (1.1.16-r15)\n(13/26) Installing libc-dev (0.7.1-r0)\n(14/26) Installing g++ (6.3.0-r4)\n(15/26) Upgrading musl-utils (1.1.16-r14 -> 1.1.16-r15)\n(16/26) Installing make (4.2.1-r0)\n(17/26) Installing libbz2 (1.0.6-r5)\n(18/26) Installing expat (2.2.0-r1)\n(19/26) Installing libffi (3.2.1-r3)\n(20/26) Installing gdbm (1.12-r0)\n(21/26) Installing ncurses-terminfo-base (6.0_p20171125-r1)\n(22/26) Installing ncurses-terminfo (6.0_p20171125-r1)\n(23/26) Installing ncurses-libs (6.0_p20171125-r1)\n(24/26) Installing readline (6.3.008-r5)\n(25/26) Installing sqlite-libs (3.25.3-r0)\n(26/26) Installing python2 (2.7.15-r0)\nExecuting busybox-1.26.2-r9.trigger\nOK: 208 MiB in 38 packages\nRemoving intermediate container 84676f7a55c0\n ---> c149ef74a55a\nStep 14/24 : RUN if [ \"x$NODE_ENV\" == \"xproduction\" ]; then yarn install --production ; else yarn install ; fi\n ---> Running in ef408c6c3c68\nyarn install v1.3.2\n[1/4] Resolving packages...\n[2/4] Fetching packages...\ninfo fsevents@1.1.3: The platform \"linux\" is incompatible with this module.\ninfo \"fsevents@1.1.3\" is an optional dependency and failed compatibility check. Excluding it from installation.\ninfo fsevents@1.2.11: The platform \"linux\" is incompatible with this module.\ninfo \"fsevents@1.2.11\" is an optional dependency and failed compatibility check. Excluding it from installation.\n[3/4] Linking dependencies...\n[4/4] Building fresh packages...\nDone in 17.66s.\nRemoving intermediate container ef408c6c3c68\n ---> d17ae5a60e79\nStep 15/24 : FROM pagarme/docker-nodejs:8.9\n ---> a951586f6b7c\nStep 16/24 : ARG NODE_ENV\n ---> Running in 0d468f28d33d\nRemoving intermediate container 0d468f28d33d\n ---> 4a335aad55fc\nStep 17/24 : ARG DOT_ENV\n ---> Running in 630933357dd5\nRemoving intermediate container 630933357dd5\n ---> 355bf460f414\nStep 18/24 : ENV APP_NAME 'tldr'\n ---> Running in a1cdb4a5055a\nRemoving intermediate container a1cdb4a5055a\n ---> 33c998da68fd\nStep 19/24 : ENV PORT 3000\n ---> Running in fa4013603756\nRemoving intermediate container fa4013603756\n ---> 660edefb70a6\nStep 20/24 : COPY --from=0 /tldr /tldr\n ---> fe90d05f9bdc\nStep 21/24 : RUN apk --update add curl\n ---> Running in 1f10be7a3421\nfetch http://dl-cdn.alpinelinux.org/alpine/v3.6/main/x86_64/APKINDEX.tar.gz\nfetch http://dl-cdn.alpinelinux.org/alpine/v3.6/community/x86_64/APKINDEX.tar.gz\n(1/3) Installing libssh2 (1.8.2-r0)\n(2/3) Installing libcurl (7.61.1-r2)\n(3/3) Installing curl (7.61.1-r2)\nExecuting busybox-1.26.2-r9.trigger\nOK: 7 MiB in 17 packages\nRemoving intermediate container 1f10be7a3421\n ---> 6df8451ec56a\nStep 22/24 : WORKDIR /tldr\n ---> Running in ea353ff6f297\nRemoving intermediate container ea353ff6f297\n ---> f62c5cade161\nStep 23/24 : HEALTHCHECK   --interval=5s   --timeout=30s   --start-period=10s   --retries=3   CMD curl -f http://localhost:${PORT}/_health_check || exit 1\n ---> Running in 2b7848b59d1f\nRemoving intermediate container 2b7848b59d1f\n ---> 05850c8bd54f\nStep 24/24 : EXPOSE ${PORT}\n ---> Running in 25dcd16eb1a1\nRemoving intermediate container 25dcd16eb1a1\n ---> b0ca90c01a44\nSuccessfully built b0ca90c01a44\nSuccessfully tagged tldr:latest\n","stderr":"","imageSize":188321735},"repair":{"violations":[],"repairedDockerfile":"# Install npm dependencies\nFROM pagarme/docker-nodejs:8.9\n\nARG NODE_ENV\nARG DOT_ENV\n\nCOPY ${DOT_ENV} /tldr/${DOT_ENV}\nCOPY newrelic.js /tldr\nCOPY package.json /tldr\nCOPY scripts/start_server.sh /tldr\nCOPY scripts/start_worker.sh /tldr\nCOPY yarn.lock /tldr\nCOPY src /tldr\nCOPY views /tldr/views\n\nWORKDIR /tldr\n\nRUN apk --update add --no-cache python make g++\nRUN if [ \"x$NODE_ENV\" == \"xproduction\" ]; then yarn install --production ; else yarn install ; fi\n\n# Build the application\nFROM pagarme/docker-nodejs:8.9\n\nARG NODE_ENV\nARG DOT_ENV\nENV APP_NAME 'tldr'\nENV PORT 3000\n\nCOPY --from=0 /tldr /tldr\n\nRUN apk --update add curl\n\nWORKDIR /tldr\n\nHEALTHCHECK \\\n  --interval=5s \\\n  --timeout=30s \\\n  --start-period=10s \\\n  --retries=3 \\\n  CMD curl -f http://localhost:${PORT}/_health_check || exit 1\n\nEXPOSE ${PORT}\n"},"endTime":1672025874955}