{"repository":"https://github.com/curveball/a12n-server","dockerfilePath":"Dockerfile","startTime":1672253878597,"clone":{"stdout":"","stderr":"Cloning into '/tmp/dinghy-analysis/curveball/a12n-server'...\n","error":null,"commit":"23df2d69ad3cc270c9d5e32709e69ad0cd87ba42"},"originalBuild":{"startTimestamp":1672253879687,"endTimestamp":1672254078111,"error":null,"stdout":"Sending build context to Docker daemon  1.608MB\r\r\nStep 1/16 : FROM node:16-alpine as build-stage\n ---> 610c0494e820\nStep 2/16 : WORKDIR /opt/app\n ---> Running in eb05f0da318f\nRemoving intermediate container eb05f0da318f\n ---> d93ac84b0e93\nStep 3/16 : RUN apk add python3 make gcc musl-dev g++\n ---> Running in 3f5ad11321a1\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/community/x86_64/APKINDEX.tar.gz\n(1/24) Installing libstdc++-dev (12.2.1_git20220924-r4)\n(2/24) Installing binutils (2.39-r2)\n(3/24) Installing libgomp (12.2.1_git20220924-r4)\n(4/24) Installing libatomic (12.2.1_git20220924-r4)\n(5/24) Installing gmp (6.2.1-r2)\n(6/24) Installing isl25 (0.25-r0)\n(7/24) Installing mpfr4 (4.1.0-r0)\n(8/24) Installing mpc1 (1.2.1-r1)\n(9/24) Installing gcc (12.2.1_git20220924-r4)\n(10/24) Installing musl-dev (1.2.3-r4)\n(11/24) Installing libc-dev (0.7.2-r3)\n(12/24) Installing g++ (12.2.1_git20220924-r4)\n(13/24) Installing make (4.3-r1)\n(14/24) Installing libbz2 (1.0.8-r4)\n(15/24) Installing libexpat (2.5.0-r0)\n(16/24) Installing libffi (3.4.4-r0)\n(17/24) Installing gdbm (1.23-r0)\n(18/24) Installing xz-libs (5.2.9-r0)\n(19/24) Installing mpdecimal (2.5.1-r1)\n(20/24) Installing ncurses-terminfo-base (6.3_p20221119-r0)\n(21/24) Installing ncurses-libs (6.3_p20221119-r0)\n(22/24) Installing readline (8.2.0-r0)\n(23/24) Installing sqlite-libs (3.40.0-r0)\n(24/24) Installing python3 (3.10.9-r1)\nExecuting busybox-1.35.0-r29.trigger\nOK: 287 MiB in 41 packages\nRemoving intermediate container 3f5ad11321a1\n ---> 1f7b7879a513\nStep 4/16 : COPY package.json package.json Makefile tsconfig.json ./\n ---> d617fb975349\nStep 5/16 : COPY assets assets\n ---> d67719e8e68e\nStep 6/16 : COPY templates templates\n ---> 52e780112de3\nStep 7/16 : COPY schemas schemas\n ---> cc9dadd237c7\nStep 8/16 : COPY src src\n ---> 53524bcc6c18\nStep 9/16 : RUN npm i --legacy-peer-deps --environment=dev && npx tsc && npm prune --production && rm -r src/\n ---> Running in 67ea9cc767d8\n\u001b[91mnpm WARN deprecated @npmcli/move-file@1.1.2: This functionality has been moved to @npmcli/fs\n\u001b[0m\nadded 612 packages, and audited 613 packages in 1m\n\n65 packages are looking for funding\n  run `npm fund` for details\n\n1 high severity vulnerability\n\nSome issues need review, and may require choosing\na different dependency.\n\nRun `npm audit` for details.\n\u001b[91mnpm notice \nnpm notice New major version of npm available! 8.19.3 -> 9.2.0\nnpm notice Changelog: <https://github.com/npm/cli/releases/tag/v9.2.0>\nnpm \u001b[0m\u001b[91mnotice Run `npm install -g npm@9.2.0` to update!\nnpm notice \n\u001b[0m\u001b[91mnpm\u001b[0m\u001b[91m WARN config production Use `--omit=dev` instead.\n\u001b[0m\nup to date, audited 306 packages in 2s\n\n17 packages are looking for funding\n  run `npm fund` for details\n\n1 high severity vulnerability\n\nSome issues need review, and may require choosing\na different dependency.\n\nRun `npm audit` for details.\nRemoving intermediate container 67ea9cc767d8\n ---> a42b017cf40b\nStep 10/16 : FROM node:16-alpine\n ---> 610c0494e820\nStep 11/16 : LABEL org.opencontainers.image.source https://github.com/curveball/a12n-server\n ---> Running in 88b00386d7d7\nRemoving intermediate container 88b00386d7d7\n ---> 8215bb6e9ff9\nStep 12/16 : EXPOSE 8531\n ---> Running in 98030bc58f6d\nRemoving intermediate container 98030bc58f6d\n ---> a9a45b165022\nStep 13/16 : WORKDIR /opt/app\n ---> Running in b1fd12369bc9\nRemoving intermediate container b1fd12369bc9\n ---> bc526458ec76\nStep 14/16 : RUN apk --no-cache add curl\n ---> Running in c300bc8fd198\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/community/x86_64/APKINDEX.tar.gz\n(1/5) Installing ca-certificates (20220614-r3)\n(2/5) Installing brotli-libs (1.0.9-r9)\n(3/5) Installing nghttp2-libs (1.51.0-r0)\n(4/5) Installing libcurl (7.87.0-r0)\n(5/5) Installing curl (7.87.0-r0)\nExecuting busybox-1.35.0-r29.trigger\nExecuting ca-certificates-20220614-r3.trigger\nOK: 12 MiB in 22 packages\nRemoving intermediate container c300bc8fd198\n ---> 694c05075254\nStep 15/16 : COPY --from=build-stage /opt/app .\n ---> 88e867827830\nStep 16/16 : CMD node dist/app.js\n ---> Running in 7b6949eea395\nRemoving intermediate container 7b6949eea395\n ---> 128d0ed606e4\nSuccessfully built 128d0ed606e4\nSuccessfully tagged a12n-server:latest\n","stderr":"","imageSize":287326285},"repair":{"violations":[{"name":"npmCacheCleanAfterInstall","position":{"start":14,"end":14,"columnStart":4,"columnEnd":46}},{"name":"apkAddUseNoCache","position":{"start":5,"end":5,"columnStart":4,"columnEnd":41}}],"repairedDockerfile":"# Stage 1: build\nFROM node:16-alpine as build-stage\nWORKDIR /opt/app\n\n# Needed for building @vscode/sqlite3 package\nRUN apk add --no-cache python3 make gcc musl-dev g++\n\nCOPY package.json package.json Makefile tsconfig.json ./\nCOPY assets assets\nCOPY templates templates\nCOPY schemas schemas\nCOPY src src\n\n# --legacy-peer-deps should be removed when all dependencies are marked as stable\nRUN npm i --legacy-peer-deps --environment=dev && npx tsc && npm prune --production && rm -r src/\n\n# Stage 2: run!\nFROM node:16-alpine\nLABEL org.opencontainers.image.source https://github.com/curveball/a12n-server\n\n\nEXPOSE 8531\nWORKDIR /opt/app\nRUN apk --no-cache add curl\n\nCOPY --from=build-stage /opt/app .\nCMD node dist/app.js\n"},"repairedBuild":{"startTimestamp":1672254078585,"endTimestamp":1672254202954,"error":null,"stdout":"Sending build context to Docker daemon  1.608MB\r\r\nStep 1/16 : FROM node:16-alpine as build-stage\n ---> 610c0494e820\nStep 2/16 : WORKDIR /opt/app\n ---> Running in 82841da4785e\nRemoving intermediate container 82841da4785e\n ---> 848b157b8d50\nStep 3/16 : RUN apk add --no-cache python3 make gcc musl-dev g++\n ---> Running in 2e1ba91cc2fe\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/community/x86_64/APKINDEX.tar.gz\n(1/24) Installing libstdc++-dev (12.2.1_git20220924-r4)\n(2/24) Installing binutils (2.39-r2)\n(3/24) Installing libgomp (12.2.1_git20220924-r4)\n(4/24) Installing libatomic (12.2.1_git20220924-r4)\n(5/24) Installing gmp (6.2.1-r2)\n(6/24) Installing isl25 (0.25-r0)\n(7/24) Installing mpfr4 (4.1.0-r0)\n(8/24) Installing mpc1 (1.2.1-r1)\n(9/24) Installing gcc (12.2.1_git20220924-r4)\n(10/24) Installing musl-dev (1.2.3-r4)\n(11/24) Installing libc-dev (0.7.2-r3)\n(12/24) Installing g++ (12.2.1_git20220924-r4)\n(13/24) Installing make (4.3-r1)\n(14/24) Installing libbz2 (1.0.8-r4)\n(15/24) Installing libexpat (2.5.0-r0)\n(16/24) Installing libffi (3.4.4-r0)\n(17/24) Installing gdbm (1.23-r0)\n(18/24) Installing xz-libs (5.2.9-r0)\n(19/24) Installing mpdecimal (2.5.1-r1)\n(20/24) Installing ncurses-terminfo-base (6.3_p20221119-r0)\n(21/24) Installing ncurses-libs (6.3_p20221119-r0)\n(22/24) Installing readline (8.2.0-r0)\n(23/24) Installing sqlite-libs (3.40.0-r0)\n(24/24) Installing python3 (3.10.9-r1)\nExecuting busybox-1.35.0-r29.trigger\nOK: 287 MiB in 41 packages\nRemoving intermediate container 2e1ba91cc2fe\n ---> 3a2d75738443\nStep 4/16 : COPY package.json package.json Makefile tsconfig.json ./\n ---> 9517b99a3fd2\nStep 5/16 : COPY assets assets\n ---> 505e47b8a78b\nStep 6/16 : COPY templates templates\n ---> 62fec19ec9a2\nStep 7/16 : COPY schemas schemas\n ---> 28b7afdc4422\nStep 8/16 : COPY src src\n ---> 4460afea9251\nStep 9/16 : RUN npm i --legacy-peer-deps --environment=dev && npx tsc && npm prune --production && rm -r src/\n ---> Running in a2270c4381d4\n\u001b[91mnpm WARN deprecated @npmcli/move-file@1.1.2: This functionality has been moved to @npmcli/fs\n\u001b[0m\nadded 612 packages, and audited 613 packages in 29s\n\n65 packages are looking for funding\n  run `npm fund` for details\n\n1 high severity vulnerability\n\nSome issues need review, and may require choosing\na different dependency.\n\nRun `npm audit` for details.\n\u001b[91mnpm notice \nnpm notice New major version of npm available! 8.19.3 -> 9.2.0\nnpm notice Changelog: <https://github.com/npm/cli/releases/tag/v9.2.0>\nnpm\u001b[0m\u001b[91m notice Run `npm install -g npm@9.2.0` to update!\nnpm notice \n\u001b[0m\u001b[91mnpm\u001b[0m\u001b[91m WARN config production Use `--omit=dev` instead.\n\u001b[0m\nup to date, audited 306 packages in 3s\n\n17 packages are looking for funding\n  run `npm fund` for details\n\n1 high severity vulnerability\n\nSome issues need review, and may require choosing\na different dependency.\n\nRun `npm audit` for details.\nRemoving intermediate container a2270c4381d4\n ---> 90fd467dd92f\nStep 10/16 : FROM node:16-alpine\n ---> 610c0494e820\nStep 11/16 : LABEL org.opencontainers.image.source https://github.com/curveball/a12n-server\n ---> Running in 1a5653234ec6\nRemoving intermediate container 1a5653234ec6\n ---> ffbdc56b2d88\nStep 12/16 : EXPOSE 8531\n ---> Running in d53dd15dd59a\nRemoving intermediate container d53dd15dd59a\n ---> f489adfd6bd7\nStep 13/16 : WORKDIR /opt/app\n ---> Running in 7606ae20525f\nRemoving intermediate container 7606ae20525f\n ---> cfe40144fa2d\nStep 14/16 : RUN apk --no-cache add curl\n ---> Running in a40a9c7314c2\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/main/x86_64/APKINDEX.tar.gz\nfetch https://dl-cdn.alpinelinux.org/alpine/v3.17/community/x86_64/APKINDEX.tar.gz\n(1/5) Installing ca-certificates (20220614-r3)\n(2/5) Installing brotli-libs (1.0.9-r9)\n(3/5) Installing nghttp2-libs (1.51.0-r0)\n(4/5) Installing libcurl (7.87.0-r0)\n(5/5) Installing curl (7.87.0-r0)\nExecuting busybox-1.35.0-r29.trigger\nExecuting ca-certificates-20220614-r3.trigger\nOK: 12 MiB in 22 packages\nRemoving intermediate container a40a9c7314c2\n ---> b4d0a93d2144\nStep 15/16 : COPY --from=build-stage /opt/app .\n ---> cd5be4962eed\nStep 16/16 : CMD node dist/app.js\n ---> Running in 5fe9d28dfce1\nRemoving intermediate container 5fe9d28dfce1\n ---> 7fb01b893b75\nSuccessfully built 7fb01b893b75\nSuccessfully tagged a12n-server:latest\n","stderr":"","imageSize":287326285},"endTime":1672254203488}