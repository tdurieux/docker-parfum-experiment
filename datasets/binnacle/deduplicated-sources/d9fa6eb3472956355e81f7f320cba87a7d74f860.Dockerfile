FROM ansibleplaybookbundle/apb-base  
# MAINTAINER {{ $MAINTAINER }}  
LABEL "com.redhat.apb.spec"=\  
"dmVyc2lvbjogMS4wCm5hbWU6IHB5emlwLWRlbW8tZGItYXBiCmRlc2NyaXB0aW9uOiBQeXRob24g\  
WmlwIERlbW8gRGF0YWJhc2UgQVBCIEltcGxlbWVudGF0aW9uCmJpbmRhYmxlOiBUcnVlCmFzeW5j\  
OiBvcHRpb25hbAptZXRhZGF0YToKICBkb2N1bWVudGF0aW9uVXJsOiBodHRwczovL2dpdGh1Yi5j\  
b20vZnVzb3IvYXBiLWV4YW1wbGVzL3RyZWUvbWFzdGVyL3B5emlwLWRlbW8tZGItYXBiCiAgZGVw\  
ZW5kZW5jaWVzOiBbJ2RvY2tlci5pby9mYWJpYW52Zi9wb3N0Z3Jlc3FsOnBvc3RnaXMnXQogIGRp\  
c3BsYXlOYW1lOiBQeXppcCBEZW1vIERhdGFiYXNlIChBUEIpCiAgbG9uZ0Rlc2NyaXB0aW9uOiBB\  
IGRhdGFiYXNlIHdpdGggR0lTIHN1cHBvcnQgYW5kIHNlZWRlZCBkYXRhIGZvciBhIGRlbW9uc3Ry\  
YXRpb24gcHl0aG9uIHdlYmFwcCwgaHR0cHM6Ly9naXRodWIuY29tL2Z1c29yL3B5LXppcC1kZW1v\  
CiAgcHJvdmlkZXJEaXNwbGF5TmFtZTogIlJlZCBIYXQsIEluYy4iCnBsYW5zOgogIC0gbmFtZTog\  
ZGVmYXVsdAogICAgZGVzY3JpcHRpb246IFRoaXMgcGxhbiBkZXBsb3lzIGEgREIgdG8gYmUgdXNl\  
ZCB3aXRoIHRoZSBweXppcC1kZW1vIEFQQgogICAgZnJlZTogVHJ1ZQogICAgbWV0YWRhdGE6CiAg\  
ICAgIGRpc3BsYXlOYW1lOiBEZWZhdWx0CiAgICAgIGNvc3Q6ICQwLjAwCiAgICBwYXJhbWV0ZXJz\  
OgogICAgICAtIG5hbWU6IGRhdGFiYXNlX25hbWUKICAgICAgICBkZWZhdWx0OiBhZG1pbgogICAg\  
ICAgIHR5cGU6IHN0cmluZwogICAgICAgIHRpdGxlOiBEYXRhYmFzZSBOYW1lCiAgICAgICAgcmVx\  
dWlyZWQ6IFRydWUKICAgICAgLSBuYW1lOiBkYXRhYmFzZV9wYXNzd29yZAogICAgICAgIGRlZmF1\  
bHQ6IGFkbWluCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgZGVzY3JpcHRpb246IEEgcmFu\  
ZG9tIGFscGhhbnVtZXJpYyBzdHJpbmcgaWYgbGVmdCBibGFuawogICAgICAgIHRpdGxlOiBEYXRh\  
YmFzZSBQYXNzd29yZAogICAgICAtIG5hbWU6IGRhdGFiYXNlX3VzZXIKICAgICAgICBkZWZhdWx0\  
OiBhZG1pbgogICAgICAgIHRpdGxlOiBEYXRhYmFzZSBVc2VyCiAgICAgICAgdHlwZTogc3RyaW5n\  
CiAgICAgICAgbWF4bGVuZ3RoOiA2MwogICAgICAgIHJlcXVpcmVkOiBUcnVlCg=="  
  
COPY roles /opt/ansible/roles  
COPY playbooks /opt/apb/actions  
RUN chmod -R g=u /opt/{ansible,apb}  
  
RUN yum install -y postgresql && yum clean all  
  
USER apb  

