FROM ansibleplaybookbundle/apb-base:canary  
  
LABEL "com.redhat.apb.spec"=\  
"dmVyc2lvbjogMS4wCm5hbWU6IG1lZGlhd2lraS1hcGIKZGVzY3JpcHRpb246IE1lZGlhd2lraSBh\  
cGIgaW1wbGVtZW50YXRpb24KYmluZGFibGU6IEZhbHNlCmFzeW5jOiBvcHRpb25hbAptZXRhZGF0\  
YToKICBkb2N1bWVudGF0aW9uVXJsOiBodHRwczovL3d3dy5tZWRpYXdpa2kub3JnL3dpa2kvRG9j\  
dW1lbnRhdGlvbgogIGxvbmdEZXNjcmlwdGlvbjogQW4gYXBiIHRoYXQgZGVwbG95cyBNZWRpYXdp\  
a2kKICBkZXBlbmRlbmNpZXM6IFsnZG9ja2VyLmlvL2Fuc2libGVwbGF5Ym9va2J1bmRsZS9tZWRp\  
YXdpa2k6bGF0ZXN0J10KICBkaXNwbGF5TmFtZTogTWVkaWF3aWtpIChBUEIpCiAgY29uc29sZS5v\  
cGVuc2hpZnQuaW8vaWNvbkNsYXNzOiBpY29uLW1lZGlhd2lraQogIHByb3ZpZGVyRGlzcGxheU5h\  
bWU6ICJSZWQgSGF0LCBJbmMuIgpwbGFuczoKICAtIG5hbWU6IGRlZmF1bHQKICAgIGRlc2NyaXB0\  
aW9uOiBBbiBBUEIgdGhhdCBkZXBsb3lzIE1lZGlhV2lraQogICAgZnJlZTogVHJ1ZQogICAgbWV0\  
YWRhdGE6CiAgICAgIGRpc3BsYXlOYW1lOiBEZWZhdWx0CiAgICAgIGxvbmdEZXNjcmlwdGlvbjoK\  
ICAgICAgICBUaGlzIHBsYW4gZGVwbG95cyBhIHNpbmdsZSBtZWRpYXdpa2kgaW5zdGFuY2Ugd2l0\  
aG91dCBhIERCCiAgICAgIGNvc3Q6ICQwLjAwCiAgICBwYXJhbWV0ZXJzOgogICAgICAtIG5hbWU6\  
IG1lZGlhd2lraV9kYl9zY2hlbWEKICAgICAgICBkZWZhdWx0OiBtZWRpYXdpa2kKICAgICAgICB0\  
eXBlOiBzdHJpbmcKICAgICAgICB0aXRsZTogTWVkaWF3aWtpIERCIFNjaGVtYQogICAgICAgIHBh\  
dHRlcm46ICJeW2EtekEtWl9dW2EtekEtWjAtOV9dKiQiCiAgICAgICAgcmVxdWlyZWQ6IFRydWUK\  
ICAgICAgLSBuYW1lOiBtZWRpYXdpa2lfc2l0ZV9uYW1lCiAgICAgICAgZGVmYXVsdDogTWVkaWFX\  
aWtpCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgdGl0bGU6IE1lZGlhd2lraSBTaXRlIE5h\  
bWUKICAgICAgICBwYXR0ZXJuOiAiXlthLXpBLVpdKyQiCiAgICAgICAgcmVxdWlyZWQ6IFRydWUK\  
ICAgICAgICB1cGRhdGFibGU6IFRydWUKICAgICAgLSBuYW1lOiBtZWRpYXdpa2lfc2l0ZV9sYW5n\  
CiAgICAgICAgZGVmYXVsdDogZW4KICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICB0aXRsZTog\  
TWVkaWF3aWtpIFNpdGUgTGFuZ3VhZ2UKICAgICAgICBwYXR0ZXJuOiAiXlthLXpdezIsM30kIgog\  
ICAgICAgIHJlcXVpcmVkOiBUcnVlCiAgICAgIC0gbmFtZTogbWVkaWF3aWtpX2FkbWluX3VzZXIK\  
ICAgICAgICBkZWZhdWx0OiBhZG1pbgogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIHRpdGxl\  
OiBNZWRpYXdpa2kgQWRtaW4gVXNlciAoQ2Fubm90IGJlIHNhbWUgYXMgQWRtaW4gVXNlciBQYXNz\  
d29yZCkKICAgICAgICByZXF1aXJlZDogVHJ1ZQogICAgICAtIG5hbWU6IG1lZGlhd2lraV9hZG1p\  
bl9wYXNzCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgdGl0bGU6IE1lZGlhd2lraSBBZG1p\  
biBVc2VyIFBhc3N3b3JkCiAgICAgICAgcmVxdWlyZWQ6IFRydWUKICAgICAgICBkaXNwbGF5X3R5\  
cGU6IHBhc3N3b3JkCiAgICAgIC0gbmFtZTogbWVkaWF3aWtpX3ZvbHVtZV9zaXplCiAgICAgICAg\  
dHlwZTogZW51bQogICAgICAgIGRlZmF1bHQ6ICcxR2knCiAgICAgICAgZW51bTogWycxR2knLCAn\  
NUdpJywgJzEwR2knXQogICAgICAgIHRpdGxlOiBNZWRpYVdpa2kgVm9sdW1lIFNpemUKICAgICAg\  
ICByZXF1aXJlZDogdHJ1ZQo="  
  
ADD playbooks /opt/apb/actions  
  
# Add our role into the ansible roles dir  
ADD . /opt/ansible/roles/mediawiki-apb  
  
RUN chmod -R g=u /opt/{ansible,apb}  
  
USER apb  

