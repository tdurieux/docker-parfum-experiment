FROM ansibleplaybookbundle/apb-base  
  
LABEL "com.redhat.apb.spec"=\  
"LS0tCnZlcnNpb246IDEuMApuYW1lOiBtc3NxbC1hcGIKZGVzY3JpcHRpb246IERlcGxveW1lbnQg\  
b2YgTWljcm9zb2Z0IFNRTCBTZXJ2ZXIgb24gTGludXgKYmluZGFibGU6IHRydWUKYXN5bmM6IG9w\  
dGlvbmFsCm1ldGFkYXRhOgogIGRpc3BsYXlOYW1lOiBNaWNyb3NvZnQgU1FMIFNlcnZlciBvbiBM\  
aW51eAogIGltYWdlVXJsOgogICAgaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL2Fu\  
c2libGVwbGF5Ym9va2J1bmRsZS9tc3NxbC1hcGIvbWFzdGVyL2RvY3MvaW1nL3NxbC1zZXJ2ZXIu\  
cG5nCiAgZG9jdW1lbnRhdGlvblVybDoKICAgIGh0dHBzOi8vZG9jcy5taWNyb3NvZnQuY29tL2Vu\  
LXVzL3NxbC9saW51eC9zcWwtc2VydmVyLWxpbnV4LW92ZXJ2aWV3CiAgZGVwZW5kZW5jaWVzOiBb\  
J3JlZ2lzdHJ5LmNlbnRvcy5vcmcvbWljcm9zb2Z0L21zc3FsLXNlcnZlci1saW51eCddCnRhZ3M6\  
CiAgLSBkYXRhYmFzZQogIC0gbXNzcWwKcGxhbnM6CiAgLSBuYW1lOiBlcGhlbWVyYWwKICAgIGRl\  
c2NyaXB0aW9uOiBUaGlzIHBsYW4gZGVwbG95cyBhbiBlcGhlbWVyYWwgTWljcm9zb2Z0IFNRTCBT\  
ZXJ2ZXIgb24gTGludXgKICAgIGZyZWU6IHRydWUKICAgIGRlZmF1bHQ6IHRydWUKICAgIG1ldGFk\  
YXRhOgogICAgICBkaXNwbGF5TmFtZTogRXBoZW1lcmFsIGluc3RhbGxhdGlvbgogICAgICBsb25n\  
RGVzY3JpcHRpb246CiAgICAgICAgVGhpcyBwbGFuIHdpbGwgZGVwbG95IGEgc3RhbmRhbG9uZSBN\  
aWNyb3NvZnQgU1FMIFNlcnZlciBvbiBMaW51eAogICAgICAgIHVzaW5nIGVwaGVtZXJhbCBzdG9y\  
YWdlCiAgICBwYXJhbWV0ZXJzOgogICAgICAtIG5hbWU6IEFDQ0VQVF9FVUxBCiAgICAgICAgdGl0\  
bGU6IEFjY2VwdCB0aGUgRW5kLVVzZXIgTGljZW5zaW5nIEFncmVlbWVudAogICAgICAgIHR5cGU6\  
IGJvb2xlYW4KICAgICAgICByZXF1aXJlZDogdHJ1ZQogICAgICAgIGRlZmF1bHQ6IGZhbHNlCiAg\  
ICAgICAgZGVzY3JpcHRpb246IGh0dHA6Ly9nby5taWNyb3NvZnQuY29tL2Z3bGluay8/TGlua0lk\  
PTc0NjM4OAogICAgICAgIGRpc3BsYXlfZ3JvdXA6IFJlcXVpcmVkIC0gRVVMQQogICAgICAtIG5h\  
bWU6IE1TU1FMX1BBU1NXT1JECiAgICAgICAgcmVxdWlyZWQ6IHRydWUKICAgICAgICBkZWZhdWx0\  
OiAiSGVsbG8xMjMhIgogICAgICAgIHBhdHRlcm46ICJeKD86KD86W2Etel0rLipbQS1aXSsuKihc\  
XGR8XFxXKSsuKilcCiAgICAgICAgICB8KD86W0EtWl0rLipbYS16XSsuKihcXGR8XFxXKSsuKilc\  
CiAgICAgICAgICB8KD86KFxcZHxcXFcpKy4qW2Etel0uKltBLVpdLiopfCg/OihcXGR8XFxXKSsu\  
KltBLVpdKy4qW2Etel0rLiopXAogICAgICAgICAgfCg/OltBLVpdKy4qKFxcZHxcXFcpKy4qW2Et\  
el0rLiopfCg/OlthLXpdKy4qKFxcZHxcXFcpKy4qW0EtWl0rLiopXAogICAgICAgICAgfCg/Olxc\  
ZCsuKlxcVysuKihbQS1aXXxbYS16XSkrLiopfCg/OlxcVysuKlxcZCsuKihbQS1aXXxbYS16XSkr\  
LiopXAogICAgICAgICAgfCg/OihbQS1aXXxbYS16XSkrLipcXGQrLipcXFcrLiopfCg/OihbQS1a\  
XXxbYS16XSkrLipcXFcrLipcXGQrLiopXAogICAgICAgICAgfCg/OlxcVysuKihbQS1aXXxbYS16\  
XSkrLipcXGQrLiopfCg/OlxcZCsuKihbQS1aXXxbYS16XSkrLipcXFcrLiopKSQiCiAgICAgICAg\  
dHlwZTogc3RyaW5nCiAgICAgICAgZGlzcGxheV90eXBlOiBwYXNzd29yZAogICAgICAgIHRpdGxl\  
OiAiRGF0YWJhc2UgQWRtaW4gKFNBKSBQYXNzd29yZCIKICAgICAgICBkZXNjcmlwdGlvbjoKICAg\  
ICAgICAgICJUaGUgcGFzc3dvcmQgbXVzdCBiZSBhdCBsZWFzdCA4IGNoYXJhY3RlcnMgbG9uZyBh\  
bmQgY29udGFpbgogICAgICAgICAgY2hhcmFjdGVycyBmcm9tIHRocmVlIG9mIHRoZSBmb2xsb3dp\  
bmcgZm91ciBzZXRzOiBVcHBlcmNhc2UKICAgICAgICAgIGxldHRlcnMsIExvd2VyY2FzZSBsZXR0\  
ZXJzLCBCYXNlIDEwIGRpZ2l0cywgYW5kIFN5bWJvbHMiCiAgICAgICAgZGlzcGxheV9ncm91cDog\  
TWljcm9zb2Z0IFNRTCBDb25maWcKICAgICAgICBtaW5fbGVuZ3RoOiA4CiAgICAgICAgbWF4X2xl\  
bmd0aDogMTI4CiAgICAgIC0gbmFtZTogTVNTUUxfREFUQUJBU0UKICAgICAgICByZXF1aXJlZDog\  
dHJ1ZQogICAgICAgIGRlZmF1bHQ6IFRlc3REQgogICAgICAgIHBhdHRlcm46ICJeW2EtekEtWjAt\  
OV8tXSokIgogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIHRpdGxlOiBNaWNyb3NvZnQgU1FM\  
IERhdGFiYXNlIE5hbWUKICAgICAgICBkaXNwbGF5X2dyb3VwOiBNaWNyb3NvZnQgU1FMIENvbmZp\  
ZwogICAgICAtIG5hbWU6IE1TU1FMX0FHRU5UX0VOQUJMRUQKICAgICAgICB0aXRsZTogRW5hYmxl\  
IFNRTCBTZXJ2ZXIgQWdlbnQKICAgICAgICB0eXBlOiBib29sZWFuCiAgICAgICAgcmVxdWlyZWQ6\  
IHRydWUKICAgICAgICBkZWZhdWx0OiBmYWxzZQogICAgICAgIGRpc3BsYXlfZ3JvdXA6IE1pY3Jv\  
c29mdCBTUUwgQ29uZmlnCiAgICAgIC0gbmFtZTogTVNTUUxfUElECiAgICAgICAgcmVxdWlyZWQ6\  
IHRydWUKICAgICAgICB0eXBlOiBlbnVtCiAgICAgICAgZW51bTogWydEZXZlbG9wZXInLCAnRXZh\  
bHVhdGlvbiddCiAgICAgICAgZGVmYXVsdDogRGV2ZWxvcGVyCiAgICAgICAgdGl0bGU6IFNRTCBT\  
ZXJ2ZXIgRWRpdGlvbgogICAgICAgIGRpc3BsYXlfZ3JvdXA6IE1pY3Jvc29mdCBTUUwgQ29uZmln\  
CiAgICAgIC0gbmFtZTogTVNTUUxfTE9DQUxfSVMKICAgICAgICB0aXRsZTogVXNlIGV4aXN0aW5n\  
IG1zc3FsLXNlcnZlci1saW51eCBpbWFnZXN0cmVhbSBpbiBwcm9qZWN0CiAgICAgICAgdHlwZTog\  
Ym9vbGVhbgogICAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICAgICAgZGVmYXVsdDogZmFsc2UKICAg\  
ICAgICBkaXNwbGF5X2dyb3VwOiBNaWNyb3NvZnQgU1FMIENvbmZpZwogICAgICAtIG5hbWU6IE1T\  
U1FMX0xDSUQKICAgICAgICB0aXRsZTogTGFuZ3VhZ2UgSUQKICAgICAgICB0eXBlOiBpbnRlZ2Vy\  
CiAgICAgICAgcmVxdWlyZWQ6IHRydWUKICAgICAgICBkZWZhdWx0OiAxMDMzCiAgICAgICAgZGVz\  
Y3JpcHRpb246IGUuZy4sIDEwMzMgaXMgRW5nbGlzaCAoVVMpLCAxMDM2IGlzIEZyZW5jaAogICAg\  
ICAgIG1pbl9sZW5ndGg6IDQKICAgICAgICBtYXhfbGVuZ3RoOiA0CiAgICAgICAgZGlzcGxheV9n\  
cm91cDogTWljcm9zb2Z0IFNRTCBDb25maWcKICAgICAgLSBuYW1lOiBNU1NRTF9JTUFHRV9QVUxM\  
CiAgICAgICAgdGl0bGU6ICJEZXBsb3ltZW50Q29uZmlnIEltYWdlIFB1bGwgUG9saWN5IgogICAg\  
ICAgIHR5cGU6IGVudW0KICAgICAgICBlbnVtOiBbJ0Fsd2F5cycsICdJZk5vdFByZXNlbnQnLCAn\  
TmV2ZXInXQogICAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICAgICAgZGVmYXVsdDogSWZOb3RQcmVz\  
ZW50CiAgICAgICAgZGlzcGxheV9ncm91cDogTWljcm9zb2Z0IFNRTCBDb25maWcKICAgICAgLSBu\  
YW1lOiBNU1NRTF9NRU1PUllfTElNSVQKICAgICAgICByZXF1aXJlZDogdHJ1ZQogICAgICAgIGRl\  
ZmF1bHQ6IDMKICAgICAgICB0eXBlOiBpbnRlZ2VyCiAgICAgICAgdGl0bGU6CiAgICAgICAgICBN\  
YXhpbXVtIGFtb3VudCBvZiBtZW1vcnkgdGhlIGNvbnRhaW5lciBjYW4gdXNlIChpbiBHQikgZWcg\  
MUdCIDJHQgogICAgICAgIGRpc3BsYXlfZ3JvdXA6IEVudmlyb25tZW50IFNpemluZwogICAgICAt\  
IG5hbWU6IE1TU1FMX01FTU9SWV9SRVFVRVNUCiAgICAgICAgcmVxdWlyZWQ6IHRydWUKICAgICAg\  
ICBkZWZhdWx0OiAyCiAgICAgICAgdHlwZTogaW50ZWdlcgogICAgICAgIHRpdGxlOgogICAgICAg\  
ICAgUmVxdWVzdGVkIGFtb3VudCBvZiBtZW1vcnkgZm9yIHRoZSBjb250YWluZXIgdG8gc3RhcnQg\  
KGluIEdCKQogICAgICAgICAgZWcgMUdCIDJHQgogICAgICAgIGRpc3BsYXlfZ3JvdXA6IEVudmly\  
b25tZW50IFNpemluZwoKICAtIG5hbWU6IHBlcnNpc3RlbnQKICAgIGRlc2NyaXB0aW9uOiBUaGlz\  
IHBsYW4gZGVwbG95cyBhIHBlcnNpc3RlbnQgTWljcm9zb2Z0IFNRTCBTZXJ2ZXIgb24gTGludXgK\  
ICAgIGZyZWU6IHRydWUKICAgIG1ldGFkYXRhOgogICAgICBkaXNwbGF5TmFtZTogUGVyc2lzdGVu\  
dCBpbnN0YWxsYXRpb24KICAgICAgbG9uZ0Rlc2NyaXB0aW9uOgogICAgICAgIFRoaXMgcGxhbiB3\  
aWxsIGRlcGxveSBhIHN0YW5kYWxvbmUgTWljcm9zb2Z0IFNRTCBTZXJ2ZXIgb24gTGludXgKICAg\  
ICAgICB1c2luZyBwZXJzaXN0ZW50IHN0b3JhZ2UKICAgIHBhcmFtZXRlcnM6CiAgICAgIC0gbmFt\  
ZTogQUNDRVBUX0VVTEEKICAgICAgICB0aXRsZTogQWNjZXB0IHRoZSBFbmQtVXNlciBMaWNlbnNp\  
bmcgQWdyZWVtZW50CiAgICAgICAgdHlwZTogYm9vbGVhbgogICAgICAgIHJlcXVpcmVkOiB0cnVl\  
CiAgICAgICAgZGVmYXVsdDogZmFsc2UKICAgICAgICBkZXNjcmlwdGlvbjogaHR0cDovL2dvLm1p\  
Y3Jvc29mdC5jb20vZndsaW5rLz9MaW5rSWQ9NzQ2Mzg4CiAgICAgICAgZGlzcGxheV9ncm91cDog\  
UmVxdWlyZWQgLSBFVUxBCiAgICAgIC0gbmFtZTogTVNTUUxfUEFTU1dPUkQKICAgICAgICByZXF1\  
aXJlZDogdHJ1ZQogICAgICAgIGRlZmF1bHQ6ICJIZWxsbzEyMyEiCiAgICAgICAgcGF0dGVybjog\  
Il4oPzooPzpbYS16XSsuKltBLVpdKy4qKFxcZHxcXFcpKy4qKVwKICAgICAgICAgIHwoPzpbQS1a\  
XSsuKlthLXpdKy4qKFxcZHxcXFcpKy4qKVwKICAgICAgICAgIHwoPzooXFxkfFxcVykrLipbYS16\  
XS4qW0EtWl0uKil8KD86KFxcZHxcXFcpKy4qW0EtWl0rLipbYS16XSsuKilcCiAgICAgICAgICB8\  
KD86W0EtWl0rLiooXFxkfFxcVykrLipbYS16XSsuKil8KD86W2Etel0rLiooXFxkfFxcVykrLipb\  
QS1aXSsuKilcCiAgICAgICAgICB8KD86XFxkKy4qXFxXKy4qKFtBLVpdfFthLXpdKSsuKil8KD86\  
XFxXKy4qXFxkKy4qKFtBLVpdfFthLXpdKSsuKilcCiAgICAgICAgICB8KD86KFtBLVpdfFthLXpd\  
KSsuKlxcZCsuKlxcVysuKil8KD86KFtBLVpdfFthLXpdKSsuKlxcVysuKlxcZCsuKilcCiAgICAg\  
ICAgICB8KD86XFxXKy4qKFtBLVpdfFthLXpdKSsuKlxcZCsuKil8KD86XFxkKy4qKFtBLVpdfFth\  
LXpdKSsuKlxcVysuKikpJCIKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICBkaXNwbGF5X3R5\  
cGU6IHBhc3N3b3JkCiAgICAgICAgdGl0bGU6ICJEYXRhYmFzZSBBZG1pbiAoU0EpIFBhc3N3b3Jk\  
IgogICAgICAgIGRlc2NyaXB0aW9uOgogICAgICAgICAgIlRoZSBwYXNzd29yZCBtdXN0IGJlIGF0\  
IGxlYXN0IDggY2hhcmFjdGVycyBsb25nIGFuZCBjb250YWluCiAgICAgICAgICBjaGFyYWN0ZXJz\  
IGZyb20gdGhyZWUgb2YgdGhlIGZvbGxvd2luZyBmb3VyIHNldHM6IFVwcGVyY2FzZQogICAgICAg\  
ICAgbGV0dGVycywgTG93ZXJjYXNlIGxldHRlcnMsIEJhc2UgMTAgZGlnaXRzLCBhbmQgU3ltYm9s\  
cyIKICAgICAgICBkaXNwbGF5X2dyb3VwOiBNaWNyb3NvZnQgU1FMIENvbmZpZwogICAgICAgIG1p\  
bl9sZW5ndGg6IDgKICAgICAgICBtYXhfbGVuZ3RoOiAxMjgKICAgICAgLSBuYW1lOiBNU1NRTF9E\  
QVRBQkFTRQogICAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICAgICAgZGVmYXVsdDogVGVzdERCCiAg\  
ICAgICAgcGF0dGVybjogIl5bYS16QS1aMC05Xy1dKiQiCiAgICAgICAgdHlwZTogc3RyaW5nCiAg\  
ICAgICAgdGl0bGU6IE1pY3Jvc29mdCBTUUwgRGF0YWJhc2UgTmFtZQogICAgICAgIGRpc3BsYXlf\  
Z3JvdXA6IE1pY3Jvc29mdCBTUUwgQ29uZmlnCiAgICAgIC0gbmFtZTogTVNTUUxfQUdFTlRfRU5B\  
QkxFRAogICAgICAgIHRpdGxlOiBFbmFibGUgU1FMIFNlcnZlciBBZ2VudAogICAgICAgIHR5cGU6\  
IGJvb2xlYW4KICAgICAgICByZXF1aXJlZDogdHJ1ZQogICAgICAgIGRlZmF1bHQ6IGZhbHNlCiAg\  
ICAgICAgZGlzcGxheV9ncm91cDogTWljcm9zb2Z0IFNRTCBDb25maWcKICAgICAgLSBuYW1lOiBN\  
U1NRTF9QSUQKICAgICAgICByZXF1aXJlZDogdHJ1ZQogICAgICAgIHR5cGU6IGVudW0KICAgICAg\  
ICBlbnVtOiBbJ0RldmVsb3BlcicsICdFdmFsdWF0aW9uJ10KICAgICAgICBkZWZhdWx0OiBEZXZl\  
bG9wZXIKICAgICAgICB0aXRsZTogU1FMIFNlcnZlciBFZGl0aW9uCiAgICAgICAgZGlzcGxheV9n\  
cm91cDogTWljcm9zb2Z0IFNRTCBDb25maWcKICAgICAgLSBuYW1lOiBNU1NRTF9MT0NBTF9JUwog\  
ICAgICAgIHRpdGxlOiBVc2UgZXhpc3RpbmcgbXNzcWwtc2VydmVyLWxpbnV4IGltYWdlc3RyZWFt\  
IGluIHByb2plY3QKICAgICAgICB0eXBlOiBib29sZWFuCiAgICAgICAgcmVxdWlyZWQ6IHRydWUK\  
ICAgICAgICBkZWZhdWx0OiBmYWxzZQogICAgICAgIGRpc3BsYXlfZ3JvdXA6IE1pY3Jvc29mdCBT\  
UUwgQ29uZmlnCiAgICAgIC0gbmFtZTogTVNTUUxfTENJRAogICAgICAgIHRpdGxlOiBMYW5ndWFn\  
ZSBJRAogICAgICAgIHR5cGU6IGludGVnZXIKICAgICAgICByZXF1aXJlZDogdHJ1ZQogICAgICAg\  
IGRlZmF1bHQ6IDEwMzMKICAgICAgICBkZXNjcmlwdGlvbjogZS5nLiwgMTAzMyBpcyBFbmdsaXNo\  
IChVUyksIDEwMzYgaXMgRnJlbmNoCiAgICAgICAgbWluX2xlbmd0aDogNAogICAgICAgIG1heF9s\  
ZW5ndGg6IDQKICAgICAgICBkaXNwbGF5X2dyb3VwOiBNaWNyb3NvZnQgU1FMIENvbmZpZwogICAg\  
ICAtIG5hbWU6IE1TU1FMX0lNQUdFX1BVTEwKICAgICAgICB0aXRsZTogIkRlcGxveW1lbnRDb25m\  
aWcgSW1hZ2UgUHVsbCBQb2xpY3kiCiAgICAgICAgdHlwZTogZW51bQogICAgICAgIGVudW06IFsn\  
QWx3YXlzJywgJ0lmTm90UHJlc2VudCcsICdOZXZlciddCiAgICAgICAgcmVxdWlyZWQ6IHRydWUK\  
ICAgICAgICBkZWZhdWx0OiBJZk5vdFByZXNlbnQKICAgICAgICBkaXNwbGF5X2dyb3VwOiBNaWNy\  
b3NvZnQgU1FMIENvbmZpZwogICAgICAtIG5hbWU6IE1TU1FMX0RBVEFfU1RPUkFHRV9TSVpFCiAg\  
ICAgICAgcmVxdWlyZWQ6IHRydWUKICAgICAgICBkZWZhdWx0OiAxCiAgICAgICAgdHlwZTogaW50\  
ZWdlcgogICAgICAgIHRpdGxlOiBQZXJzaXN0ZW50IHZvbHVtZSBzaXplIGZvciBkYiBkYXRhIChp\  
biBHQikgZWcgMUdCIDJHQgogICAgICAgIGRpc3BsYXlfZ3JvdXA6IEVudmlyb25tZW50IFNpemlu\  
ZwogICAgICAtIG5hbWU6IE1TU1FMX01FTU9SWV9MSU1JVAogICAgICAgIHJlcXVpcmVkOiB0cnVl\  
CiAgICAgICAgZGVmYXVsdDogMwogICAgICAgIHR5cGU6IGludGVnZXIKICAgICAgICB0aXRsZToK\  
ICAgICAgICAgIE1heGltdW0gYW1vdW50IG9mIG1lbW9yeSB0aGUgY29udGFpbmVyIGNhbiB1c2Ug\  
KGluIEdCKSBlZyAxR0IgMkdCCiAgICAgICAgZGlzcGxheV9ncm91cDogRW52aXJvbm1lbnQgU2l6\  
aW5nCiAgICAgIC0gbmFtZTogTVNTUUxfTUVNT1JZX1JFUVVFU1QKICAgICAgICByZXF1aXJlZDog\  
dHJ1ZQogICAgICAgIGRlZmF1bHQ6IDIKICAgICAgICB0eXBlOiBpbnRlZ2VyCiAgICAgICAgdGl0\  
bGU6CiAgICAgICAgICBSZXF1ZXN0ZWQgYW1vdW50IG9mIG1lbW9yeSBmb3IgdGhlIGNvbnRhaW5l\  
ciB0byBzdGFydCAoaW4gR0IpCiAgICAgICAgICBlZyAxR0IgMkdCCiAgICAgICAgZGlzcGxheV9n\  
cm91cDogRW52aXJvbm1lbnQgU2l6aW5nCg=="  
  
COPY playbooks /opt/apb/actions  
COPY roles /opt/ansible/roles  
RUN chown -R apb:0 /opt/{ansible,apb} && \  
chmod -R g=u /opt/{ansible,apb}  
USER apb  
ENV ANSIBLE_PIPELINING=True \  
ANSIBLE_CALLBACK_WHITELIST=profile_tasks  

