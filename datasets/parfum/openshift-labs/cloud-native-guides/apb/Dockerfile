FROM ansibleplaybookbundle/apb-base:release-1.3

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogJzEuMC4wJwpuYW1lOiBjbG91ZC1uYXRpdmUtd29ya3Nob3AtYXBiCmRlc2NyaXB0\
aW9uOiBBUEIgdG8gZGVwbG95IHJlcXVpcmVkIGluZnJhIGNvbXBvbmVudHMgZm9yIENsb3VkLU5h\
dGl2ZSBXb3Jrc2hvcHMgb24gYW4gT3BlblNoaWZ0IGNsdXN0ZXIKYmluZGFibGU6IEZhbHNlCmFz\
eW5jOiBvcHRpb25hbAp0YWdzOgotIHdvcmtzaG9wCi0gY2xvdWQtbmF0aXZlCm1ldGFkYXRhOgog\
IGRlcGVuZGVuY2llczogW10KICBkaXNwbGF5TmFtZTogIkNsb3VkLU5hdGl2ZSBXb3Jrc2hvcCAo\
Q29kZVJlYWR5KSBJbnN0YWxsZXIiCiAgbG9uZ0Rlc2NyaXB0aW9uOiAiUmVxdWlyZWQgY29tcG9u\
ZW50cyAoQ29kZVJlYWR5IFdvcmtzcGFjZXMsIE5leHVzLCBHb2dzLCBXb3Jrc2hvcHBlcikiCiAg\
Y29uc29sZS5vcGVuc2hpZnQuaW8vaWNvbkNsYXNzOiAicGZpY29uIHBmaWNvbi1zZXJ2aWNlcyIK\
ICBwcm92aWRlckRpc3BsYXlOYW1lOiAiUmVkIEhhdCwgSW5jLiIKcGxhbnM6CiAgLSBuYW1lOiBk\
ZWZhdWx0CiAgICBkZXNjcmlwdGlvbjogVGhpcyBkZWZhdWx0IHBsYW4gZGVwbG95cyBjbG91ZC1u\
YXRpdmUtd29ya3Nob3AKICAgIGZyZWU6IFRydWUKICAgIG1ldGFkYXRhOiB7fQogICAgcGFyYW1l\
dGVyczoKICAgIC0gbmFtZTogb3BlbnNoaWZ0X3VzZXIKICAgICAgdGl0bGU6IFVzZXJuYW1lCiAg\
ICAgIGRlc2NyaXB0aW9uOiBVc2VyIGlzIHJlcXVpcmVkIGZvciBjcmVhdGluZyBwcm9qZWN0IGFk\
bWluIHJlc291cmNlcwogICAgICB0eXBlOiBzdHJpbmcKICAgICAgcmVxdWlyZWQ6IHRydWUKICAg\
ICAgZGlzcGxheV9ncm91cDogT3BlblNoaWZ0IE1hc3RlcgogICAgLSBuYW1lOiBvcGVuc2hpZnRf\
cGFzc3dvcmQKICAgICAgdGl0bGU6IFBhc3N3b3JkCiAgICAgIGRlc2NyaXB0aW9uOiBQYXNzd29y\
ZCBpcyByZXF1aXJlZCBmb3IgY3JlYXRpbmcgcHJvamVjdCBhZG1pbiByZXNvdXJjZXMKICAgICAg\
dHlwZTogc3RyaW5nCiAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICAgIGRpc3BsYXlfdHlwZTogcGFz\
c3dvcmQKICAgICAgZGlzcGxheV9ncm91cDogT3BlblNoaWZ0IE1hc3RlcgogICAgLSBuYW1lOiB1\
c2VyX2NvdW50CiAgICAgIHRpdGxlOiBOdW1iZXIgb2YgUGFydGljaXBhbnRzCiAgICAgIGRlc2Ny\
aXB0aW9uOiBUaGUgbnVtYmVyIG9mIHBhcnRpY2lwYW50cwogICAgICB0eXBlOiBudW1iZXIKICAg\
ICAgcmVxdWlyZWQ6IHRydWUKICAgICAgZGVmYXVsdDogNTAKICAgICAgZGlzcGxheV90eXBlOiBu\
dW1iZXIKICAgICAgZGlzcGxheV9ncm91cDogTGFicyAmIEd1aWRlcwogICAgLSBuYW1lOiBvcGVu\
c2hpZnRfbWFzdGVyX3VybAogICAgICB0aXRsZTogT3BlblNoaWZ0IE1hc3RlciBVUkwKICAgICAg\
ZGVzY3JpcHRpb246IFRoZSBhZGRyZXNzIHRvIE9wZW5TaGlmdCBtYXN0ZXIgVVJMIHRvIGJlIGRp\
c3BsYXllZCBpbiB0aGUgbGFiIGd1aWRlIHRvIHBhcnRpY2lwYW50cwogICAgICB0eXBlOiBzdHJp\
bmcKICAgICAgcmVxdWlyZWQ6IHRydWUKICAgICAgZGlzcGxheV90eXBlOiBzdHJpbmcKICAgICAg\
ZGlzcGxheV9ncm91cDogTGFicyAmIEd1aWRlcwogICAgLSBuYW1lOiBvcGVuc2hpZnRfdXNlcl9w\
YXNzd29yZAogICAgICB0aXRsZTogT3BlblNoaWZ0IFVzZXIgUGFzc3dvcmQKICAgICAgZGVzY3Jp\
cHRpb246IFRoZSBPcGVuU2hpZnQgcGFzc3dvcmQgZm9yIHBhcnRpY2lwYW50cyB0byBiZSBkaXNw\
bGF5ZWQgaW4gdGhlIGxhYiBndWlkZSB0byBwYXJ0aWNpcGFudHMKICAgICAgdHlwZTogc3RyaW5n\
CiAgICAgIGRlZmF1bHQ6ICJvcGVuc2hpZnQiCiAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICAgIGRp\
c3BsYXlfdHlwZTogc3RyaW5nCiAgICAgIGRpc3BsYXlfZ3JvdXA6IExhYnMgJiBHdWlkZXMKICAg\
IC0gbmFtZTogZ2l0X3JlcG9zaXRvcnlfZ3VpZGVfcGF0aAogICAgICB0aXRsZTogR2l0IFJlcG9z\
aXRvcnkgR3VpZGUgUGF0aAogICAgICBkZXNjcmlwdGlvbjogVGhlIFBhdGggb2YgdGhlIHJlcG9z\
aXRvcnkgd2l0aCB0aGUgbGFiIGd1aWRlIGZvciBwYXJ0aWNpcGFudHMgPGdpdGh1Yl9hY2NvdW50\
Pi88Z2l0aHViX3Byb2plY3Q+CiAgICAgIHR5cGU6IHN0cmluZwogICAgICBkZWZhdWx0OiAib3Bl\
bnNoaWZ0LWxhYnMvY2xvdWQtbmF0aXZlLWd1aWRlcyIKICAgICAgcmVxdWlyZWQ6IHRydWUKICAg\
ICAgZGlzcGxheV90eXBlOiBzdHJpbmcKICAgICAgZGlzcGxheV9ncm91cDogTGFicyAmIEd1aWRl\
cwogICAgLSBuYW1lOiBnaXRfcmVwb3NpdG9yeV9ndWlkZV9yZWZlcmVuY2UKICAgICAgdGl0bGU6\
IEdpdCBSZXBvc2l0b3J5IEd1aWRlIFJlZmVyZW5jZQogICAgICBkZXNjcmlwdGlvbjogU2V0IHRo\
aXMgdG8gYSBicmFuY2ggbmFtZSwgdGFnIG9yIG90aGVyIHJlZiBvZiB5b3VyIHJlcG9zaXRvcnkg\
aWYgeW91IGFyZSBub3QgdXNpbmcgdGhlIGRlZmF1bHQgYnJhbmNoLgogICAgICB0eXBlOiBzdHJp\
bmcKICAgICAgZGVmYXVsdDogIm9jcC0zLjExIgogICAgICByZXF1aXJlZDogdHJ1ZQogICAgICBk\
aXNwbGF5X3R5cGU6IHN0cmluZwogICAgICBkaXNwbGF5X2dyb3VwOiBMYWJzICYgR3VpZGVzCiAg\
ICAtIG5hbWU6IGd1aWRlX25hbWUKICAgICAgdGl0bGU6IEd1aWRlIE5hbWUKICAgICAgZGVzY3Jp\
cHRpb246IFNldCB0aGUgbmFtZSBvZiB0aGUgZ3VpZGUgZm9yIF9jbG91ZC1uYXRpdmUtd29ya3No\
b3AtPGd1aWRlX25hbWU+LnltbAogICAgICB0eXBlOiBzdHJpbmcKICAgICAgZGVmYXVsdDogImNv\
ZGVyZWFkeSIKICAgICAgcmVxdWlyZWQ6IHRydWUKICAgICAgZGlzcGxheV90eXBlOiBzdHJpbmcK\
ICAgICAgZGlzcGxheV9ncm91cDogTGFicyAmIEd1aWRlcwogICAgLSBuYW1lOiBnaXRfcmVwb3Np\
dG9yeV9sYWJfcGF0aAogICAgICB0aXRsZTogR2l0IFJlcG9zaXRvcnkgTGFiIFBhdGgKICAgICAg\
ZGVzY3JpcHRpb246IFRoZSBQYXRoIG9mIHRoZSByZXBvc2l0b3J5IHdpdGggdGhlIGxhYiBmb3Ig\
cGFydGljaXBhbnRzIDxnaXRodWJfYWNjb3VudD4vPGdpdGh1Yl9wcm9qZWN0PgogICAgICB0eXBl\
OiBzdHJpbmcKICAgICAgZGVmYXVsdDogIm9wZW5zaGlmdC1sYWJzL2Nsb3VkLW5hdGl2ZS1sYWJz\
IgogICAgICByZXF1aXJlZDogdHJ1ZQogICAgICBkaXNwbGF5X3R5cGU6IHN0cmluZwogICAgICBk\
aXNwbGF5X2dyb3VwOiBMYWJzICYgR3VpZGVzCiAgICAtIG5hbWU6IGdpdF9yZXBvc2l0b3J5X2xh\
Yl9yZWZlcmVuY2UKICAgICAgdGl0bGU6IEdpdCBSZXBvc2l0b3J5IExhYiBSZWZlcmVuY2UKICAg\
ICAgZGVzY3JpcHRpb246IFNldCB0aGlzIHRvIGEgYnJhbmNoIG5hbWUsIHRhZyBvciBvdGhlciBy\
ZWYgb2YgeW91ciByZXBvc2l0b3J5IGlmIHlvdSBhcmUgbm90IHVzaW5nIHRoZSBkZWZhdWx0IGJy\
YW5jaC4KICAgICAgdHlwZTogc3RyaW5nCiAgICAgIGRlZmF1bHQ6ICJvY3AtMy4xMSIKICAgICAg\
cmVxdWlyZWQ6IHRydWUKICAgICAgZGlzcGxheV90eXBlOiBzdHJpbmcKICAgICAgZGlzcGxheV9n\
cm91cDogTGFicyAmIEd1aWRlcwogICAgLSBuYW1lOiBpbmZyYXN2Y3NfYWRtX3VzZXIKICAgICAg\
dGl0bGU6IEluZnJhIFNlcnZpY2VzIEFkbWluIFVzZXIKICAgICAgZGVzY3JpcHRpb246IEFkbWlu\
IHVzZXIgZm9yIGluZnJhc3RydWN0dXJlIHNlcnZpY2VzIChHb2dzLCBOZXh1cywgLi4uKQogICAg\
ICB0eXBlOiBzdHJpbmcKICAgICAgZGVmYXVsdDogImFkbWludXNlciIKICAgICAgcmVxdWlyZWQ6\
IHRydWUKICAgICAgZGlzcGxheV90eXBlOiB0ZXh0CiAgICAgIGRpc3BsYXlfZ3JvdXA6IFdvcmtz\
aG9wIEluZnJhIFNlcnZpY2VzCiAgICAtIG5hbWU6IGluZnJhc3Zjc19hZG1fcHdkCiAgICAgIHRp\
dGxlOiBJbmZyYSBTZXJ2aWNlcyBBZG1pbiBQYXNzd29yZAogICAgICBkZXNjcmlwdGlvbjogQWRt\
aW4gcGFzc3dvcmQgZm9yIGluZnJhc3RydWN0dXJlIHNlcnZpY2VzIChHb2dzLCBOZXh1cywgLi4u\
KQogICAgICB0eXBlOiBzdHJpbmcKICAgICAgZGVmYXVsdDogImFkbWlucHdkIgogICAgICByZXF1\
aXJlZDogdHJ1ZQogICAgICBkaXNwbGF5X3R5cGU6IHRleHQKICAgICAgZGlzcGxheV9ncm91cDog\
V29ya3Nob3AgSW5mcmEgU2VydmljZXMKICAgICAg"


COPY playbooks /opt/apb/project
ADD requirements.yml /opt/apb/project/requirements.yml
RUN ansible-galaxy install -r /opt/apb/project/requirements.yml -f
RUN chmod -R g=u /opt/{ansible,apb}
USER apb
