FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IGFsZXJ0bWFuYWdlci10b3dlci1icmlkZ2UtYXBiCmRlc2NyaXB0\
aW9uOiBCcmlkZ2UgQXBwbGljYXRpb24gYmV0d2VlbiBBbGVydE1hbmFnZXIgYW5kIEFuc2libGUg\
VG93ZXIKYmluZGFibGU6IEZhbHNlCmFzeW5jOiBvcHRpb25hbAptZXRhZGF0YToKICBkaXNwbGF5\
TmFtZTogQWxlcnRNYW5hZ2VyIEFuc2libGUgVG93ZXIgQnJpZGdlCiAgY29uc29sZS5vcGVuc2hp\
ZnQuaW8vaWNvbkNsYXNzOiBpY29uLWFuc2libGUKcGxhbnM6CiAgLSBuYW1lOiBkZWZhdWx0CiAg\
ICBkZXNjcmlwdGlvbjogVGhpcyBkZWZhdWx0IHBsYW4gZGVwbG95cyBhbGVydG1hbmFnZXItdG93\
ZXItYnJpZGdlCiAgICBmcmVlOiBUcnVlCiAgICBtZXRhZGF0YToKICAgICAgZGlzcGxheU5hbWU6\
IERlZmF1bHQKICAgIHBhcmFtZXRlcnM6CiAgICAgIC0gbmFtZTogIlRPV0VSX0hPU1QiCiAgICAg\
ICAgdGl0bGU6IEFuc2libGUgVG93ZXIgSG9zdG5hbWUKICAgICAgICByZXF1aXJlZDogdHJ1ZQog\
ICAgICAgIHR5cGU6IHN0cmluZwoKICAgICAgLSBuYW1lOiAiVE9XRVJfVVNFUiIKICAgICAgICB0\
aXRsZTogVXNlciB3aXRoIHBlcm1pc3Npb25zIG9uIFRvd2VyCiAgICAgICAgcmVxdWlyZWQ6IHRy\
dWUKICAgICAgICBkZWZhdWx0OiBhZG1pbgogICAgICAgIHR5cGU6IHN0cmluZwoKICAgICAgLSBu\
YW1lOiAiVE9XRVJfUEFTU1dPUkQiCiAgICAgICAgdGl0bGU6IFBhc3N3b3JkIGZvciB1c2VyIHdp\
dGggcGVybWlzc2lvbnMgb24gVG93ZXIKICAgICAgICByZXF1aXJlZDogdHJ1ZQogICAgICAgIGRl\
ZmF1bHQ6IHBhc3N3b3JkCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgZGlzcGxheV90eXBl\
OiBwYXNzd29yZAoKICAgICAgLSBuYW1lOiAiVE9XRVJfSk9CX1RFTVBMQVRFIgogICAgICAgIHRp\
dGxlOiBBbnNpYmxlIFRvd2VyIEpvYiBUZW1wbGF0ZSB0byB1c2UKICAgICAgICByZXF1aXJlZDog\
dHJ1ZQogICAgICAgIGRlZmF1bHQ6ICIyLVNjYWxldXBfT3BlblNoaWZ0X29uX0FXUyIKICAgICAg\
ICB0eXBlOiBzdHJpbmcKCiAgICAgIC0gbmFtZTogR0lUX1VSTAogICAgICAgIHRpdGxlOiBHaXQg\
UmVwb3NpdG9yeQogICAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICAgICAgZGVmYXVsdDogaHR0cHM6\
Ly9naXRodWIuY29tL3NhYnJlMTA0MS9tYW5hZ2luZy1vY3AtaW5zdGFsbC1iZXlvbmQKICAgICAg\
ICB0eXBlOiBzdHJpbmcKCiAgICAgIC0gbmFtZTogR0lUX1JFRgogICAgICAgIHRpdGxlOiBHaXQg\
QnJhbmNoCiAgICAgICAgcmVxdWlyZWQ6IHRydWUKICAgICAgICBkZWZhdWx0OiBzdW1taXQyMDE4\
CiAgICAgICAgdHlwZTogc3RyaW5nCgogICAgICAtIG5hbWU6IENPTlRFWFRfRElSCiAgICAgICAg\
dGl0bGU6IERpcmVjdG9yeSBvZiB0aGUgZ2l0IHJlcG8gdGhhdCB0aGUgY29kZSBpcyBpbgogICAg\
ICAgIHJlcXVpcmVkOiB0cnVlCiAgICAgICAgZGVmYXVsdDogYWxlcnRtYW5hZ2VyLXRvd2VyLWJy\
aWRnZQogICAgICAgIHR5cGU6IHN0cmluZwoKICAgICAgLSBuYW1lOiBOQU1FU1BBQ0UKICAgICAg\
ICB0aXRsZTogT0NQIG5hbWVzcGFjZSB0byBkZXBsb3kgdGhlIEFsZXJ0TWFuZ2VyIEJyaWRnZQog\
ICAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICAgICAgZGVmYXVsdDogb3BlbnNoaWZ0LW1ldHJpY3MK\
ICAgICAgICB0eXBlOiBzdHJpbmcK"

COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
RUN chmod -R g=u /opt/{ansible,apb}

USER apb
